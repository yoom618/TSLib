Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6870022
	speed: 0.2350s/iter; left time: 9681.5447s
	iters: 200, epoch: 1 | loss: 0.0571429
	speed: 0.2088s/iter; left time: 8583.1547s
	iters: 300, epoch: 1 | loss: 0.0716702
	speed: 0.2278s/iter; left time: 9338.0269s
	iters: 400, epoch: 1 | loss: 0.0002997
	speed: 0.2070s/iter; left time: 8465.2525s
Epoch: 1 cost time: 90.51541876792908
Epoch: 1, Steps: 413 | Train Loss: 0.395 Vali Loss: 0.966 Vali Acc: 0.787 Test Loss: 0.966 Test Acc: 0.787
Validation loss decreased (inf --> -0.786712).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0580884
	speed: 0.4572s/iter; left time: 18647.1242s
	iters: 200, epoch: 2 | loss: 0.0017172
	speed: 0.1875s/iter; left time: 7629.8104s
	iters: 300, epoch: 2 | loss: 1.4381324
	speed: 0.1799s/iter; left time: 7302.3196s
	iters: 400, epoch: 2 | loss: 0.1731893
	speed: 0.1802s/iter; left time: 7296.1280s
Epoch: 2 cost time: 78.85586977005005
Epoch: 2, Steps: 413 | Train Loss: 0.297 Vali Loss: 0.411 Vali Acc: 0.950 Test Loss: 0.411 Test Acc: 0.950
Validation loss decreased (-0.786712 --> -0.949973).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1048465
	speed: 0.4022s/iter; left time: 16239.3618s
	iters: 200, epoch: 3 | loss: 0.2064104
	speed: 0.1792s/iter; left time: 7218.1371s
	iters: 300, epoch: 3 | loss: 0.0291164
	speed: 0.1787s/iter; left time: 7179.3763s
	iters: 400, epoch: 3 | loss: 0.0995830
	speed: 0.1717s/iter; left time: 6879.1109s
Epoch: 3 cost time: 73.07631945610046
Epoch: 3, Steps: 413 | Train Loss: 0.361 Vali Loss: 0.452 Vali Acc: 0.951 Test Loss: 0.452 Test Acc: 0.951
Validation loss decreased (-0.949973 --> -0.950882).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.4532s/iter; left time: 18110.2007s
	iters: 200, epoch: 4 | loss: 0.0060091
	speed: 0.1924s/iter; left time: 7669.0400s
	iters: 300, epoch: 4 | loss: 1.8179432
	speed: 0.1750s/iter; left time: 6958.5238s
	iters: 400, epoch: 4 | loss: 0.0000029
	speed: 0.1862s/iter; left time: 7386.3708s
Epoch: 4 cost time: 79.90142726898193
Epoch: 4, Steps: 413 | Train Loss: 0.430 Vali Loss: 2.052 Vali Acc: 0.913 Test Loss: 2.052 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0017644
	speed: 0.4157s/iter; left time: 16440.8670s
	iters: 200, epoch: 5 | loss: 0.9977504
	speed: 0.1703s/iter; left time: 6719.3811s
	iters: 300, epoch: 5 | loss: 0.0007926
	speed: 0.1851s/iter; left time: 7282.4858s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.2076s/iter; left time: 8148.8151s
Epoch: 5 cost time: 76.61257672309875
Epoch: 5, Steps: 413 | Train Loss: 0.500 Vali Loss: 0.954 Vali Acc: 0.915 Test Loss: 0.954 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.4444s/iter; left time: 17390.9554s
	iters: 200, epoch: 6 | loss: 0.4427399
	speed: 0.2258s/iter; left time: 8814.2445s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.2287s/iter; left time: 8905.2703s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.2185s/iter; left time: 8486.6777s
Epoch: 6 cost time: 91.0661563873291
Epoch: 6, Steps: 413 | Train Loss: 0.442 Vali Loss: 0.965 Vali Acc: 0.939 Test Loss: 0.965 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000026
	speed: 0.4659s/iter; left time: 18041.5372s
	iters: 200, epoch: 7 | loss: 0.0108557
	speed: 0.2150s/iter; left time: 8305.1684s
	iters: 300, epoch: 7 | loss: 0.0950378
	speed: 0.2313s/iter; left time: 8910.3369s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.1846s/iter; left time: 7092.6597s
Epoch: 7 cost time: 87.091721534729
Epoch: 7, Steps: 413 | Train Loss: 0.440 Vali Loss: 1.807 Vali Acc: 0.936 Test Loss: 1.807 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.9370828
	speed: 0.4228s/iter; left time: 16195.5969s
	iters: 200, epoch: 8 | loss: 1.5254070
	speed: 0.1993s/iter; left time: 7616.9824s
	iters: 300, epoch: 8 | loss: 1.0371704
	speed: 0.2011s/iter; left time: 7664.9448s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.1966s/iter; left time: 7472.4382s
Epoch: 8 cost time: 81.91573071479797
Epoch: 8, Steps: 413 | Train Loss: 0.459 Vali Loss: 2.786 Vali Acc: 0.894 Test Loss: 2.786 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.4280s/iter; left time: 16218.7314s
	iters: 200, epoch: 9 | loss: 5.7491617
	speed: 0.1875s/iter; left time: 7086.7283s
	iters: 300, epoch: 9 | loss: 2.3383262
	speed: 0.1691s/iter; left time: 6375.0759s
	iters: 400, epoch: 9 | loss: 0.0019581
	speed: 0.2029s/iter; left time: 7629.4558s
Epoch: 9 cost time: 78.0518901348114
Epoch: 9, Steps: 413 | Train Loss: 0.578 Vali Loss: 1.520 Vali Acc: 0.955 Test Loss: 1.520 Test Acc: 0.955
Validation loss decreased (-0.950882 --> -0.955419).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.4171s/iter; left time: 15634.3893s
	iters: 200, epoch: 10 | loss: 1.8657608
	speed: 0.2054s/iter; left time: 7677.2271s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.2210s/iter; left time: 8241.2567s
	iters: 400, epoch: 10 | loss: 2.2206578
	speed: 0.2030s/iter; left time: 7546.5368s
Epoch: 10 cost time: 85.170401096344
Epoch: 10, Steps: 413 | Train Loss: 0.530 Vali Loss: 2.366 Vali Acc: 0.850 Test Loss: 2.366 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.4616s/iter; left time: 17111.3714s
	iters: 200, epoch: 11 | loss: 0.0029665
	speed: 0.2328s/iter; left time: 8605.1420s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2314s/iter; left time: 8533.4126s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.2153s/iter; left time: 7916.7221s
Epoch: 11 cost time: 91.43623805046082
Epoch: 11, Steps: 413 | Train Loss: 0.365 Vali Loss: 2.859 Vali Acc: 0.873 Test Loss: 2.859 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1469373
	speed: 0.4283s/iter; left time: 15699.9008s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2208s/iter; left time: 8072.4108s
	iters: 300, epoch: 12 | loss: 1.8435726
	speed: 0.2214s/iter; left time: 8072.9207s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.2096s/iter; left time: 7619.8035s
Epoch: 12 cost time: 87.87535858154297
Epoch: 12, Steps: 413 | Train Loss: 0.541 Vali Loss: 1.452 Vali Acc: 0.959 Test Loss: 1.452 Test Acc: 0.959
Validation loss decreased (-0.955419 --> -0.958603).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000022
	speed: 0.4153s/iter; left time: 15052.9037s
	iters: 200, epoch: 13 | loss: 0.0314356
	speed: 0.2032s/iter; left time: 7346.0427s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1813s/iter; left time: 6534.8467s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1610s/iter; left time: 5788.6054s
Epoch: 13 cost time: 75.65414261817932
Epoch: 13, Steps: 413 | Train Loss: 0.318 Vali Loss: 1.143 Vali Acc: 0.958 Test Loss: 1.143 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 3.2678719
	speed: 0.4501s/iter; left time: 16127.3443s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1999s/iter; left time: 7142.0926s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2032s/iter; left time: 7241.5306s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1862s/iter; left time: 6616.9324s
Epoch: 14 cost time: 83.27742433547974
Epoch: 14, Steps: 413 | Train Loss: 0.303 Vali Loss: 2.431 Vali Acc: 0.948 Test Loss: 2.431 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0053950
	speed: 0.4380s/iter; left time: 15513.6008s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1853s/iter; left time: 6544.5659s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1837s/iter; left time: 6470.7691s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1857s/iter; left time: 6522.2203s
Epoch: 15 cost time: 78.12434244155884
Epoch: 15, Steps: 413 | Train Loss: 0.425 Vali Loss: 1.477 Vali Acc: 0.961 Test Loss: 1.477 Test Acc: 0.961
Validation loss decreased (-0.958603 --> -0.961331).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.4130s/iter; left time: 14456.2409s
	iters: 200, epoch: 16 | loss: 0.0002997
	speed: 0.1731s/iter; left time: 6042.2278s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1765s/iter; left time: 6143.1332s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1851s/iter; left time: 6424.0392s
Epoch: 16 cost time: 75.08189058303833
Epoch: 16, Steps: 413 | Train Loss: 0.303 Vali Loss: 2.251 Vali Acc: 0.940 Test Loss: 2.251 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.4310s/iter; left time: 14911.2676s
	iters: 200, epoch: 17 | loss: 0.0000014
	speed: 0.1892s/iter; left time: 6525.7765s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.2083s/iter; left time: 7165.6816s
	iters: 400, epoch: 17 | loss: 0.0003663
	speed: 0.2357s/iter; left time: 8081.5683s
Epoch: 17 cost time: 86.78644180297852
Epoch: 17, Steps: 413 | Train Loss: 0.288 Vali Loss: 1.010 Vali Acc: 0.967 Test Loss: 1.010 Test Acc: 0.967
Validation loss decreased (-0.961331 --> -0.967248).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.5449s/iter; left time: 18623.1955s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.2366s/iter; left time: 8062.4153s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2540s/iter; left time: 8632.4707s
	iters: 400, epoch: 18 | loss: 0.0665844
	speed: 0.2191s/iter; left time: 7421.6946s
Epoch: 18 cost time: 97.40191173553467
Epoch: 18, Steps: 413 | Train Loss: 0.241 Vali Loss: 1.584 Vali Acc: 0.957 Test Loss: 1.584 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.4728s/iter; left time: 15964.5938s
	iters: 200, epoch: 19 | loss: 0.4103017
	speed: 0.2334s/iter; left time: 7856.6487s
	iters: 300, epoch: 19 | loss: 0.0052157
	speed: 0.2358s/iter; left time: 7915.8859s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.2081s/iter; left time: 6964.7165s
Epoch: 19 cost time: 92.69618535041809
Epoch: 19, Steps: 413 | Train Loss: 0.271 Vali Loss: 1.456 Vali Acc: 0.960 Test Loss: 1.456 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.4738s/iter; left time: 15802.3163s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2392s/iter; left time: 7953.7142s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2295s/iter; left time: 7610.4283s
	iters: 400, epoch: 20 | loss: 0.6506710
	speed: 0.2295s/iter; left time: 7585.7838s
Epoch: 20 cost time: 95.89090394973755
Epoch: 20, Steps: 413 | Train Loss: 0.204 Vali Loss: 1.040 Vali Acc: 0.968 Test Loss: 1.040 Test Acc: 0.968
Validation loss decreased (-0.967248 --> -0.968157).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.4698s/iter; left time: 15476.3298s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2299s/iter; left time: 7550.8601s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.2099s/iter; left time: 6872.5182s
	iters: 400, epoch: 21 | loss: 0.0000455
	speed: 0.1799s/iter; left time: 5870.7630s
Epoch: 21 cost time: 86.453604221344
Epoch: 21, Steps: 413 | Train Loss: 0.323 Vali Loss: 1.313 Vali Acc: 0.936 Test Loss: 1.313 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.4170s/iter; left time: 13565.7018s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.2026s/iter; left time: 6570.1751s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1990s/iter; left time: 6433.2232s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1750s/iter; left time: 5638.9756s
Epoch: 22 cost time: 79.99025869369507
Epoch: 22, Steps: 413 | Train Loss: 0.277 Vali Loss: 1.271 Vali Acc: 0.958 Test Loss: 1.271 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.4195s/iter; left time: 13471.4853s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.1856s/iter; left time: 5941.5537s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1851s/iter; left time: 5906.7843s
	iters: 400, epoch: 23 | loss: 0.0812369
	speed: 0.1997s/iter; left time: 6352.7460s
Epoch: 23 cost time: 80.08683180809021
Epoch: 23, Steps: 413 | Train Loss: 0.149 Vali Loss: 1.609 Vali Acc: 0.958 Test Loss: 1.609 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.1794720
	speed: 0.4797s/iter; left time: 15207.4778s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.2046s/iter; left time: 6465.2411s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2001s/iter; left time: 6303.7259s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.2119s/iter; left time: 6654.6958s
Epoch: 24 cost time: 86.53618955612183
Epoch: 24, Steps: 413 | Train Loss: 0.119 Vali Loss: 1.351 Vali Acc: 0.963 Test Loss: 1.351 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.4598s/iter; left time: 14386.6154s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.1824s/iter; left time: 5689.2888s
	iters: 300, epoch: 25 | loss: 0.2574179
	speed: 0.1977s/iter; left time: 6145.6759s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.2373s/iter; left time: 7353.6552s
Epoch: 25 cost time: 84.4072892665863
Epoch: 25, Steps: 413 | Train Loss: 0.313 Vali Loss: 1.291 Vali Acc: 0.960 Test Loss: 1.291 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.4253s/iter; left time: 13131.3908s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.1983s/iter; left time: 6101.8068s
	iters: 300, epoch: 26 | loss: 0.6590798
	speed: 0.1837s/iter; left time: 5634.2566s
	iters: 400, epoch: 26 | loss: 0.2292450
	speed: 0.1782s/iter; left time: 5448.6869s
Epoch: 26 cost time: 79.6529004573822
Epoch: 26, Steps: 413 | Train Loss: 0.251 Vali Loss: 2.095 Vali Acc: 0.948 Test Loss: 2.095 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.3967074
	speed: 0.3844s/iter; left time: 11711.4382s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.1856s/iter; left time: 5634.7017s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.1757s/iter; left time: 5316.0302s
	iters: 400, epoch: 27 | loss: 3.3393607
	speed: 0.1685s/iter; left time: 5082.3618s
Epoch: 27 cost time: 72.39156317710876
Epoch: 27, Steps: 413 | Train Loss: 0.232 Vali Loss: 1.280 Vali Acc: 0.963 Test Loss: 1.280 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.4213s/iter; left time: 12660.4765s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.1906s/iter; left time: 5707.0140s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.1789s/iter; left time: 5341.1962s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.1946s/iter; left time: 5787.9421s
Epoch: 28 cost time: 79.17841792106628
Epoch: 28, Steps: 413 | Train Loss: 0.422 Vali Loss: 1.253 Vali Acc: 0.957 Test Loss: 1.253 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.4049s/iter; left time: 11998.9814s
	iters: 200, epoch: 29 | loss: 1.1139805
	speed: 0.1877s/iter; left time: 5543.3729s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.1814s/iter; left time: 5339.3817s
	iters: 400, epoch: 29 | loss: 0.0165676
	speed: 0.1787s/iter; left time: 5243.9522s
Epoch: 29 cost time: 75.17979717254639
Epoch: 29, Steps: 413 | Train Loss: 0.278 Vali Loss: 1.139 Vali Acc: 0.949 Test Loss: 1.139 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.4057s/iter; left time: 11856.8033s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.1726s/iter; left time: 5026.7363s
	iters: 300, epoch: 30 | loss: 0.7294107
	speed: 0.1774s/iter; left time: 5147.7898s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.1763s/iter; left time: 5099.2879s
Epoch: 30 cost time: 73.74552822113037
Epoch: 30, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.972 Vali Acc: 0.965 Test Loss: 0.972 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9681673487949067
model parameter : 1180170
model size : 6.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3715042
	speed: 0.1753s/iter; left time: 7221.9513s
	iters: 200, epoch: 1 | loss: 0.0352544
	speed: 0.1252s/iter; left time: 5147.7070s
	iters: 300, epoch: 1 | loss: 0.2576711
	speed: 0.1249s/iter; left time: 5119.8405s
	iters: 400, epoch: 1 | loss: 0.0048620
	speed: 0.1383s/iter; left time: 5657.2159s
Epoch: 1 cost time: 57.933807611465454
Epoch: 1, Steps: 413 | Train Loss: 0.376 Vali Loss: 0.225 Vali Acc: 0.954 Test Loss: 0.225 Test Acc: 0.954
Validation loss decreased (inf --> -0.954068).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1978167
	speed: 0.2917s/iter; left time: 11896.3151s
	iters: 200, epoch: 2 | loss: 0.0612889
	speed: 0.1232s/iter; left time: 5012.2948s
	iters: 300, epoch: 2 | loss: 0.4404565
	speed: 0.1338s/iter; left time: 5429.2564s
	iters: 400, epoch: 2 | loss: 0.3870054
	speed: 0.1247s/iter; left time: 5048.5001s
Epoch: 2 cost time: 52.37402606010437
Epoch: 2, Steps: 413 | Train Loss: 0.210 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2048481
	speed: 0.2997s/iter; left time: 12100.2015s
	iters: 200, epoch: 3 | loss: 0.0000053
	speed: 0.1307s/iter; left time: 5264.5706s
	iters: 300, epoch: 3 | loss: 0.0068828
	speed: 0.1242s/iter; left time: 4989.2797s
	iters: 400, epoch: 3 | loss: 0.0000184
	speed: 0.1250s/iter; left time: 5010.9033s
Epoch: 3 cost time: 52.47348141670227
Epoch: 3, Steps: 413 | Train Loss: 0.270 Vali Loss: 0.765 Vali Acc: 0.945 Test Loss: 0.765 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000006
	speed: 0.3031s/iter; left time: 12113.5156s
	iters: 200, epoch: 4 | loss: 0.1208304
	speed: 0.1237s/iter; left time: 4929.7538s
	iters: 300, epoch: 4 | loss: 0.7204550
	speed: 0.1150s/iter; left time: 4574.5369s
	iters: 400, epoch: 4 | loss: 0.8592325
	speed: 0.1231s/iter; left time: 4883.6891s
Epoch: 4 cost time: 51.04212665557861
Epoch: 4, Steps: 413 | Train Loss: 0.431 Vali Loss: 3.294 Vali Acc: 0.849 Test Loss: 3.294 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.4405045
	speed: 0.2898s/iter; left time: 11461.9363s
	iters: 200, epoch: 5 | loss: 2.7349291
	speed: 0.1252s/iter; left time: 4940.2035s
	iters: 300, epoch: 5 | loss: 0.0005570
	speed: 0.1315s/iter; left time: 5175.9050s
	iters: 400, epoch: 5 | loss: 0.0000205
	speed: 0.1174s/iter; left time: 4607.8350s
Epoch: 5 cost time: 51.20756912231445
Epoch: 5, Steps: 413 | Train Loss: 0.528 Vali Loss: 5.063 Vali Acc: 0.798 Test Loss: 5.063 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0449180
	speed: 0.2960s/iter; left time: 11584.7302s
	iters: 200, epoch: 6 | loss: 0.4375679
	speed: 0.1344s/iter; left time: 5244.6435s
	iters: 300, epoch: 6 | loss: 0.0114253
	speed: 0.1360s/iter; left time: 5296.0995s
	iters: 400, epoch: 6 | loss: 1.8434453
	speed: 0.1318s/iter; left time: 5119.1868s
Epoch: 6 cost time: 55.89205241203308
Epoch: 6, Steps: 413 | Train Loss: 0.531 Vali Loss: 0.828 Vali Acc: 0.935 Test Loss: 0.828 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000002
	speed: 0.3117s/iter; left time: 12071.0558s
	iters: 200, epoch: 7 | loss: 1.4976944
	speed: 0.1203s/iter; left time: 4646.7173s
	iters: 300, epoch: 7 | loss: 0.0000007
	speed: 0.1421s/iter; left time: 5475.5820s
	iters: 400, epoch: 7 | loss: 0.7141306
	speed: 0.1365s/iter; left time: 5245.8173s
Epoch: 7 cost time: 55.00628089904785
Epoch: 7, Steps: 413 | Train Loss: 0.368 Vali Loss: 0.960 Vali Acc: 0.943 Test Loss: 0.960 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.2056339
	speed: 0.3015s/iter; left time: 11550.3427s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1362s/iter; left time: 5205.7276s
	iters: 300, epoch: 8 | loss: 0.0000234
	speed: 0.1673s/iter; left time: 6375.4670s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.1629s/iter; left time: 6191.3152s
Epoch: 8 cost time: 60.60927057266235
Epoch: 8, Steps: 413 | Train Loss: 0.439 Vali Loss: 1.009 Vali Acc: 0.961 Test Loss: 1.009 Test Acc: 0.961
Validation loss decreased (-0.954068 --> -0.960881).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3555s/iter; left time: 13473.7897s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1729s/iter; left time: 6533.2484s
	iters: 300, epoch: 9 | loss: 0.5923720
	speed: 0.1762s/iter; left time: 6640.4157s
	iters: 400, epoch: 9 | loss: 0.0000450
	speed: 0.1793s/iter; left time: 6741.8928s
Epoch: 9 cost time: 71.28157353401184
Epoch: 9, Steps: 413 | Train Loss: 0.375 Vali Loss: 1.252 Vali Acc: 0.940 Test Loss: 1.252 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.4847685
	speed: 0.3954s/iter; left time: 14821.9794s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1438s/iter; left time: 5374.1896s
	iters: 300, epoch: 10 | loss: 1.9824179
	speed: 0.1573s/iter; left time: 5864.4287s
	iters: 400, epoch: 10 | loss: 0.0000359
	speed: 0.1540s/iter; left time: 5727.9406s
Epoch: 10 cost time: 65.55481719970703
Epoch: 10, Steps: 413 | Train Loss: 0.626 Vali Loss: 1.578 Vali Acc: 0.921 Test Loss: 1.578 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2823610
	speed: 0.3581s/iter; left time: 13274.5709s
	iters: 200, epoch: 11 | loss: 1.2909495
	speed: 0.1428s/iter; left time: 5279.0648s
	iters: 300, epoch: 11 | loss: 0.0039200
	speed: 0.1506s/iter; left time: 5553.7066s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1442s/iter; left time: 5304.1410s
Epoch: 11 cost time: 62.186394929885864
Epoch: 11, Steps: 413 | Train Loss: 0.368 Vali Loss: 1.868 Vali Acc: 0.934 Test Loss: 1.868 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1161012
	speed: 0.3321s/iter; left time: 12173.1866s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1413s/iter; left time: 5165.6373s
	iters: 300, epoch: 12 | loss: 0.5802942
	speed: 0.1394s/iter; left time: 5083.8575s
	iters: 400, epoch: 12 | loss: 1.1879427
	speed: 0.1462s/iter; left time: 5314.6084s
Epoch: 12 cost time: 59.93972897529602
Epoch: 12, Steps: 413 | Train Loss: 0.312 Vali Loss: 0.927 Vali Acc: 0.952 Test Loss: 0.927 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3336s/iter; left time: 12089.9844s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1453s/iter; left time: 5253.3337s
	iters: 300, epoch: 13 | loss: 2.0192537
	speed: 0.1451s/iter; left time: 5229.4536s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1319s/iter; left time: 4741.0004s
Epoch: 13 cost time: 58.46343636512756
Epoch: 13, Steps: 413 | Train Loss: 0.386 Vali Loss: 0.906 Vali Acc: 0.950 Test Loss: 0.906 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3016s/iter; left time: 10807.4008s
	iters: 200, epoch: 14 | loss: 0.0056004
	speed: 0.1389s/iter; left time: 4962.1045s
	iters: 300, epoch: 14 | loss: 0.0000008
	speed: 0.1416s/iter; left time: 5045.9617s
	iters: 400, epoch: 14 | loss: 0.1729807
	speed: 0.1410s/iter; left time: 5009.0134s
Epoch: 14 cost time: 57.41035270690918
Epoch: 14, Steps: 413 | Train Loss: 0.287 Vali Loss: 0.850 Vali Acc: 0.961 Test Loss: 0.850 Test Acc: 0.961
Validation loss decreased (-0.960881 --> -0.960883).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3170s/iter; left time: 11228.1340s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1343s/iter; left time: 4743.7149s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1390s/iter; left time: 4894.6144s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1459s/iter; left time: 5124.5580s
Epoch: 15 cost time: 56.92210102081299
Epoch: 15, Steps: 413 | Train Loss: 0.235 Vali Loss: 1.877 Vali Acc: 0.925 Test Loss: 1.877 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.0084038
	speed: 0.3232s/iter; left time: 11315.4582s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1406s/iter; left time: 4907.7444s
	iters: 300, epoch: 16 | loss: 1.3186479
	speed: 0.1453s/iter; left time: 5056.9583s
	iters: 400, epoch: 16 | loss: 0.0000046
	speed: 0.1398s/iter; left time: 4851.5528s
Epoch: 16 cost time: 58.34190487861633
Epoch: 16, Steps: 413 | Train Loss: 0.374 Vali Loss: 1.004 Vali Acc: 0.954 Test Loss: 1.004 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.1132670
	speed: 0.3480s/iter; left time: 12038.8006s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1475s/iter; left time: 5089.2283s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1292s/iter; left time: 4443.3541s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1132s/iter; left time: 3882.1769s
Epoch: 17 cost time: 56.41784739494324
Epoch: 17, Steps: 413 | Train Loss: 0.312 Vali Loss: 1.237 Vali Acc: 0.951 Test Loss: 1.237 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3171s/iter; left time: 10840.1681s
	iters: 200, epoch: 18 | loss: 2.4099891
	speed: 0.1306s/iter; left time: 4452.4643s
	iters: 300, epoch: 18 | loss: 0.0002028
	speed: 0.1365s/iter; left time: 4637.1879s
	iters: 400, epoch: 18 | loss: 0.0000999
	speed: 0.1263s/iter; left time: 4279.9624s
Epoch: 18 cost time: 54.55939722061157
Epoch: 18, Steps: 413 | Train Loss: 0.225 Vali Loss: 0.798 Vali Acc: 0.967 Test Loss: 0.798 Test Acc: 0.967
Validation loss decreased (-0.960883 --> -0.967250).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000009
	speed: 0.2967s/iter; left time: 10018.5928s
	iters: 200, epoch: 19 | loss: 1.3223650
	speed: 0.1073s/iter; left time: 3610.8581s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1015s/iter; left time: 3405.9764s
	iters: 400, epoch: 19 | loss: 3.2809782
	speed: 0.1144s/iter; left time: 3829.3971s
Epoch: 19 cost time: 46.320035457611084
Epoch: 19, Steps: 413 | Train Loss: 0.240 Vali Loss: 1.977 Vali Acc: 0.915 Test Loss: 1.977 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.5279977
	speed: 0.2707s/iter; left time: 9030.4070s
	iters: 200, epoch: 20 | loss: 0.4211923
	speed: 0.1149s/iter; left time: 3821.1600s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.1380s/iter; left time: 4574.4195s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.1208s/iter; left time: 3991.6211s
Epoch: 20 cost time: 50.28418564796448
Epoch: 20, Steps: 413 | Train Loss: 0.279 Vali Loss: 0.971 Vali Acc: 0.956 Test Loss: 0.971 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.3185s/iter; left time: 10492.4367s
	iters: 200, epoch: 21 | loss: 0.0007181
	speed: 0.1363s/iter; left time: 4477.4127s
	iters: 300, epoch: 21 | loss: 0.0000212
	speed: 0.1221s/iter; left time: 3996.4957s
	iters: 400, epoch: 21 | loss: 0.0097320
	speed: 0.1068s/iter; left time: 3486.6703s
Epoch: 21 cost time: 52.33930730819702
Epoch: 21, Steps: 413 | Train Loss: 0.181 Vali Loss: 1.367 Vali Acc: 0.950 Test Loss: 1.367 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.3130s/iter; left time: 10182.5309s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1279s/iter; left time: 4145.9441s
	iters: 300, epoch: 22 | loss: 2.3733773
	speed: 0.1284s/iter; left time: 4150.1986s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1207s/iter; left time: 3889.8599s
Epoch: 22 cost time: 53.00838327407837
Epoch: 22, Steps: 413 | Train Loss: 0.187 Vali Loss: 0.932 Vali Acc: 0.955 Test Loss: 0.932 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.3314143
	speed: 0.2897s/iter; left time: 9303.1226s
	iters: 200, epoch: 23 | loss: 1.3507892
	speed: 0.1304s/iter; left time: 4174.5236s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1271s/iter; left time: 4056.6715s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1172s/iter; left time: 3727.9774s
Epoch: 23 cost time: 51.869078636169434
Epoch: 23, Steps: 413 | Train Loss: 0.230 Vali Loss: 0.913 Vali Acc: 0.957 Test Loss: 0.913 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000001
	speed: 0.2777s/iter; left time: 8805.0505s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.1046s/iter; left time: 3305.0782s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.1182s/iter; left time: 3723.9502s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.1125s/iter; left time: 3533.0278s
Epoch: 24 cost time: 47.147162437438965
Epoch: 24, Steps: 413 | Train Loss: 0.194 Vali Loss: 1.231 Vali Acc: 0.944 Test Loss: 1.231 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 2.8096433
	speed: 0.2737s/iter; left time: 8564.4745s
	iters: 200, epoch: 25 | loss: 0.0000780
	speed: 0.1144s/iter; left time: 3567.8437s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.1077s/iter; left time: 3346.8315s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.1107s/iter; left time: 3428.9606s
Epoch: 25 cost time: 46.17458724975586
Epoch: 25, Steps: 413 | Train Loss: 0.294 Vali Loss: 1.454 Vali Acc: 0.938 Test Loss: 1.454 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.3000s/iter; left time: 9263.7303s
	iters: 200, epoch: 26 | loss: 0.0081529
	speed: 0.1128s/iter; left time: 3472.4876s
	iters: 300, epoch: 26 | loss: 0.0006030
	speed: 0.1024s/iter; left time: 3140.5013s
	iters: 400, epoch: 26 | loss: 0.1495551
	speed: 0.1080s/iter; left time: 3301.8449s
Epoch: 26 cost time: 47.14091682434082
Epoch: 26, Steps: 413 | Train Loss: 0.212 Vali Loss: 0.759 Vali Acc: 0.966 Test Loss: 0.759 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.1069710
	speed: 0.2776s/iter; left time: 8455.3399s
	iters: 200, epoch: 27 | loss: 3.6015444
	speed: 0.1257s/iter; left time: 3815.6378s
	iters: 300, epoch: 27 | loss: 1.6686344
	speed: 0.1294s/iter; left time: 3915.3090s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.1182s/iter; left time: 3565.7487s
Epoch: 27 cost time: 50.67219591140747
Epoch: 27, Steps: 413 | Train Loss: 0.173 Vali Loss: 0.728 Vali Acc: 0.967 Test Loss: 0.728 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2690s/iter; left time: 8084.9485s
	iters: 200, epoch: 28 | loss: 0.0002946
	speed: 0.1193s/iter; left time: 3574.3975s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.1143s/iter; left time: 3411.5171s
	iters: 400, epoch: 28 | loss: 0.0000304
	speed: 0.1140s/iter; left time: 3391.4519s
Epoch: 28 cost time: 47.78087520599365
Epoch: 28, Steps: 413 | Train Loss: 0.161 Vali Loss: 1.243 Vali Acc: 0.943 Test Loss: 1.243 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9672578444747613
model parameter : 914186
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1178860
	speed: 0.1460s/iter; left time: 6016.0944s
	iters: 200, epoch: 1 | loss: 0.3758810
	speed: 0.1174s/iter; left time: 4825.9835s
	iters: 300, epoch: 1 | loss: 0.3062490
	speed: 0.1036s/iter; left time: 4248.6736s
	iters: 400, epoch: 1 | loss: 0.1340119
	speed: 0.1195s/iter; left time: 4887.5254s
Epoch: 1 cost time: 50.47820329666138
Epoch: 1, Steps: 413 | Train Loss: 0.358 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
Validation loss decreased (inf --> -0.959980).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0364036
	speed: 0.2865s/iter; left time: 11685.0852s
	iters: 200, epoch: 2 | loss: 0.6798564
	speed: 0.1239s/iter; left time: 5040.0131s
	iters: 300, epoch: 2 | loss: 0.1192611
	speed: 0.1144s/iter; left time: 4643.8307s
	iters: 400, epoch: 2 | loss: 0.4544117
	speed: 0.1154s/iter; left time: 4671.1879s
Epoch: 2 cost time: 49.893144607543945
Epoch: 2, Steps: 413 | Train Loss: 0.193 Vali Loss: 0.695 Vali Acc: 0.909 Test Loss: 0.695 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000906
	speed: 0.2726s/iter; left time: 11004.9358s
	iters: 200, epoch: 3 | loss: 1.6666033
	speed: 0.1291s/iter; left time: 5200.3517s
	iters: 300, epoch: 3 | loss: 0.0003874
	speed: 0.1230s/iter; left time: 4940.6077s
	iters: 400, epoch: 3 | loss: 0.0013913
	speed: 0.1181s/iter; left time: 4732.6751s
Epoch: 3 cost time: 51.098756551742554
Epoch: 3, Steps: 413 | Train Loss: 0.278 Vali Loss: 0.384 Vali Acc: 0.951 Test Loss: 0.384 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.2729s/iter; left time: 10904.5144s
	iters: 200, epoch: 4 | loss: 0.0000000
	speed: 0.0976s/iter; left time: 3889.3858s
	iters: 300, epoch: 4 | loss: 0.6184400
	speed: 0.1092s/iter; left time: 4343.4410s
	iters: 400, epoch: 4 | loss: 1.2317293
	speed: 0.1123s/iter; left time: 4454.3115s
Epoch: 4 cost time: 44.52329707145691
Epoch: 4, Steps: 413 | Train Loss: 0.266 Vali Loss: 2.014 Vali Acc: 0.808 Test Loss: 2.014 Test Acc: 0.808
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0003533
	speed: 0.2521s/iter; left time: 9969.3405s
	iters: 200, epoch: 5 | loss: 0.0030819
	speed: 0.0928s/iter; left time: 3660.0724s
	iters: 300, epoch: 5 | loss: 1.8006825
	speed: 0.1097s/iter; left time: 4316.4557s
	iters: 400, epoch: 5 | loss: 0.7106256
	speed: 0.1230s/iter; left time: 4828.8483s
Epoch: 5 cost time: 44.40173363685608
Epoch: 5, Steps: 413 | Train Loss: 0.320 Vali Loss: 0.815 Vali Acc: 0.934 Test Loss: 0.815 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.3048114
	speed: 0.2853s/iter; left time: 11164.5459s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.1221s/iter; left time: 4765.6478s
	iters: 300, epoch: 6 | loss: 0.2934238
	speed: 0.1208s/iter; left time: 4703.3682s
	iters: 400, epoch: 6 | loss: 0.0000069
	speed: 0.1201s/iter; left time: 4662.4654s
Epoch: 6 cost time: 49.890430212020874
Epoch: 6, Steps: 413 | Train Loss: 0.335 Vali Loss: 0.623 Vali Acc: 0.955 Test Loss: 0.623 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2874s/iter; left time: 11127.1012s
	iters: 200, epoch: 7 | loss: 0.0177206
	speed: 0.1256s/iter; left time: 4850.7816s
	iters: 300, epoch: 7 | loss: 0.0397279
	speed: 0.1326s/iter; left time: 5107.3422s
	iters: 400, epoch: 7 | loss: 0.1200709
	speed: 0.1439s/iter; left time: 5527.8719s
Epoch: 7 cost time: 55.3716139793396
Epoch: 7, Steps: 413 | Train Loss: 0.347 Vali Loss: 0.972 Vali Acc: 0.933 Test Loss: 0.972 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000505
	speed: 0.2972s/iter; left time: 11386.1267s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1298s/iter; left time: 4958.9724s
	iters: 300, epoch: 8 | loss: 0.5663859
	speed: 0.1381s/iter; left time: 5262.0103s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.1360s/iter; left time: 5170.6536s
Epoch: 8 cost time: 55.1741886138916
Epoch: 8, Steps: 413 | Train Loss: 0.270 Vali Loss: 0.988 Vali Acc: 0.940 Test Loss: 0.988 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0664443
	speed: 0.2981s/iter; left time: 11297.8782s
	iters: 200, epoch: 9 | loss: 0.0803842
	speed: 0.1324s/iter; left time: 5002.8658s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1274s/iter; left time: 4804.0027s
	iters: 400, epoch: 9 | loss: 0.9473236
	speed: 0.1175s/iter; left time: 4416.1786s
Epoch: 9 cost time: 53.0222544670105
Epoch: 9, Steps: 413 | Train Loss: 0.276 Vali Loss: 0.423 Vali Acc: 0.956 Test Loss: 0.423 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.4460647
	speed: 0.2839s/iter; left time: 10643.5704s
	iters: 200, epoch: 10 | loss: 0.1405857
	speed: 0.1345s/iter; left time: 5028.5778s
	iters: 300, epoch: 10 | loss: 0.6050982
	speed: 0.1347s/iter; left time: 5023.8024s
	iters: 400, epoch: 10 | loss: 0.0687430
	speed: 0.1268s/iter; left time: 4715.2896s
Epoch: 10 cost time: 54.10208058357239
Epoch: 10, Steps: 413 | Train Loss: 0.339 Vali Loss: 0.826 Vali Acc: 0.950 Test Loss: 0.826 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.7663331
	speed: 0.3065s/iter; left time: 11363.5336s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1332s/iter; left time: 4923.0574s
	iters: 300, epoch: 11 | loss: 0.0003690
	speed: 0.1231s/iter; left time: 4539.2307s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.1366s/iter; left time: 5022.3964s
Epoch: 11 cost time: 55.18040156364441
Epoch: 11, Steps: 413 | Train Loss: 0.317 Vali Loss: 0.513 Vali Acc: 0.958 Test Loss: 0.513 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.959981809913597
model parameter : 781322
model size : 5.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2680378
	speed: 0.1499s/iter; left time: 6174.1247s
	iters: 200, epoch: 1 | loss: 0.9562940
	speed: 0.1238s/iter; left time: 5090.3170s
	iters: 300, epoch: 1 | loss: 0.1509257
	speed: 0.1251s/iter; left time: 5128.8646s
	iters: 400, epoch: 1 | loss: 0.0687059
	speed: 0.1323s/iter; left time: 5410.7943s
Epoch: 1 cost time: 54.84123659133911
Epoch: 1, Steps: 413 | Train Loss: 0.364 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
Validation loss decreased (inf --> -0.959980).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0011612
	speed: 0.2950s/iter; left time: 12030.7186s
	iters: 200, epoch: 2 | loss: 0.0024869
	speed: 0.1361s/iter; left time: 5539.5631s
	iters: 300, epoch: 2 | loss: 0.1310463
	speed: 0.1298s/iter; left time: 5269.3066s
	iters: 400, epoch: 2 | loss: 0.4760689
	speed: 0.1274s/iter; left time: 5156.2660s
Epoch: 2 cost time: 54.947373151779175
Epoch: 2, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.216 Vali Acc: 0.953 Test Loss: 0.216 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0043309
	speed: 0.3049s/iter; left time: 12309.8240s
	iters: 200, epoch: 3 | loss: 0.2376673
	speed: 0.1134s/iter; left time: 4566.6710s
	iters: 300, epoch: 3 | loss: 0.0379185
	speed: 0.1233s/iter; left time: 4952.6819s
	iters: 400, epoch: 3 | loss: 0.7545134
	speed: 0.1310s/iter; left time: 5251.7305s
Epoch: 3 cost time: 52.254478216171265
Epoch: 3, Steps: 413 | Train Loss: 0.193 Vali Loss: 0.206 Vali Acc: 0.967 Test Loss: 0.206 Test Acc: 0.967
Validation loss decreased (-0.959980 --> -0.966801).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.2654s/iter; left time: 10606.8504s
	iters: 200, epoch: 4 | loss: 0.0000144
	speed: 0.1104s/iter; left time: 4399.4275s
	iters: 300, epoch: 4 | loss: 0.2945094
	speed: 0.1129s/iter; left time: 4490.8320s
	iters: 400, epoch: 4 | loss: 0.1097052
	speed: 0.0877s/iter; left time: 3479.9373s
Epoch: 4 cost time: 43.475406646728516
Epoch: 4, Steps: 413 | Train Loss: 0.212 Vali Loss: 0.616 Vali Acc: 0.945 Test Loss: 0.616 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0164797
	speed: 0.2568s/iter; left time: 10155.4523s
	iters: 200, epoch: 5 | loss: 0.4400045
	speed: 0.1151s/iter; left time: 4541.0307s
	iters: 300, epoch: 5 | loss: 0.0001670
	speed: 0.0939s/iter; left time: 3694.7121s
	iters: 400, epoch: 5 | loss: 0.0000242
	speed: 0.1063s/iter; left time: 4173.7222s
Epoch: 5 cost time: 44.96519088745117
Epoch: 5, Steps: 413 | Train Loss: 0.263 Vali Loss: 0.629 Vali Acc: 0.950 Test Loss: 0.629 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0506496
	speed: 0.2542s/iter; left time: 9949.0062s
	iters: 200, epoch: 6 | loss: 0.4571110
	speed: 0.1006s/iter; left time: 3927.9791s
	iters: 300, epoch: 6 | loss: 0.0003827
	speed: 0.1020s/iter; left time: 3972.8447s
	iters: 400, epoch: 6 | loss: 0.0000001
	speed: 0.1042s/iter; left time: 4048.2695s
Epoch: 6 cost time: 43.24175310134888
Epoch: 6, Steps: 413 | Train Loss: 0.270 Vali Loss: 0.913 Vali Acc: 0.916 Test Loss: 0.913 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.9187122
	speed: 0.2383s/iter; left time: 9228.4271s
	iters: 200, epoch: 7 | loss: 0.0712629
	speed: 0.1017s/iter; left time: 3929.4142s
	iters: 300, epoch: 7 | loss: 0.0000004
	speed: 0.0981s/iter; left time: 3777.2464s
	iters: 400, epoch: 7 | loss: 0.0963449
	speed: 0.0829s/iter; left time: 3186.9848s
Epoch: 7 cost time: 40.06621694564819
Epoch: 7, Steps: 413 | Train Loss: 0.311 Vali Loss: 0.395 Vali Acc: 0.965 Test Loss: 0.395 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2345s/iter; left time: 8984.7540s
	iters: 200, epoch: 8 | loss: 0.0000009
	speed: 0.0985s/iter; left time: 3763.7939s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0806s/iter; left time: 3070.6452s
	iters: 400, epoch: 8 | loss: 0.5970964
	speed: 0.1119s/iter; left time: 4254.0279s
Epoch: 8 cost time: 40.691174030303955
Epoch: 8, Steps: 413 | Train Loss: 0.328 Vali Loss: 1.198 Vali Acc: 0.943 Test Loss: 1.198 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.5027602
	speed: 0.2277s/iter; left time: 8629.3684s
	iters: 200, epoch: 9 | loss: 0.0000002
	speed: 0.0914s/iter; left time: 3453.8726s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1051s/iter; left time: 3962.2472s
	iters: 400, epoch: 9 | loss: 1.1422086
	speed: 0.1012s/iter; left time: 3805.0998s
Epoch: 9 cost time: 40.82168650627136
Epoch: 9, Steps: 413 | Train Loss: 0.340 Vali Loss: 0.827 Vali Acc: 0.938 Test Loss: 0.827 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2454082
	speed: 0.2485s/iter; left time: 9316.0793s
	iters: 200, epoch: 10 | loss: 0.0000005
	speed: 0.1058s/iter; left time: 3954.3632s
	iters: 300, epoch: 10 | loss: 0.0038627
	speed: 0.0982s/iter; left time: 3660.3681s
	iters: 400, epoch: 10 | loss: 0.0000532
	speed: 0.0944s/iter; left time: 3510.0440s
Epoch: 10 cost time: 42.03787088394165
Epoch: 10, Steps: 413 | Train Loss: 0.349 Vali Loss: 1.858 Vali Acc: 0.855 Test Loss: 1.858 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2206s/iter; left time: 8176.6860s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0831s/iter; left time: 3070.9218s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1020s/iter; left time: 3760.3031s
	iters: 400, epoch: 11 | loss: 0.4429701
	speed: 0.1187s/iter; left time: 4365.0566s
Epoch: 11 cost time: 40.900301456451416
Epoch: 11, Steps: 413 | Train Loss: 0.416 Vali Loss: 0.586 Vali Acc: 0.954 Test Loss: 0.586 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0001612
	speed: 0.2473s/iter; left time: 9066.3808s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.1094s/iter; left time: 3998.9365s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1143s/iter; left time: 4166.4403s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0893s/iter; left time: 3247.4372s
Epoch: 12 cost time: 43.32089400291443
Epoch: 12, Steps: 413 | Train Loss: 0.258 Vali Loss: 1.283 Vali Acc: 0.934 Test Loss: 1.283 Test Acc: 0.934
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.4616469
	speed: 0.2555s/iter; left time: 9262.0103s
	iters: 200, epoch: 13 | loss: 0.0076841
	speed: 0.1122s/iter; left time: 4056.1693s
	iters: 300, epoch: 13 | loss: 0.0000020
	speed: 0.1025s/iter; left time: 3693.5181s
	iters: 400, epoch: 13 | loss: 0.0053720
	speed: 0.0933s/iter; left time: 3355.2517s
Epoch: 13 cost time: 44.73715257644653
Epoch: 13, Steps: 413 | Train Loss: 0.363 Vali Loss: 0.645 Vali Acc: 0.960 Test Loss: 0.645 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9668030923146885
model parameter : 698506
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1519151
	speed: 0.1367s/iter; left time: 5631.1257s
	iters: 200, epoch: 1 | loss: 0.0086905
	speed: 0.1166s/iter; left time: 4791.6419s
	iters: 300, epoch: 1 | loss: 0.1745898
	speed: 0.1053s/iter; left time: 4316.3213s
	iters: 400, epoch: 1 | loss: 0.0013171
	speed: 0.0995s/iter; left time: 4067.8796s
Epoch: 1 cost time: 47.31791949272156
Epoch: 1, Steps: 413 | Train Loss: 0.343 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
Validation loss decreased (inf --> -0.955887).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0116404
	speed: 0.2454s/iter; left time: 10010.5324s
	iters: 200, epoch: 2 | loss: 0.0176737
	speed: 0.1017s/iter; left time: 4136.0898s
	iters: 300, epoch: 2 | loss: 0.6564601
	speed: 0.1016s/iter; left time: 4121.9419s
	iters: 400, epoch: 2 | loss: 0.0324628
	speed: 0.1057s/iter; left time: 4279.5727s
Epoch: 2 cost time: 43.4424102306366
Epoch: 2, Steps: 413 | Train Loss: 0.140 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
Validation loss decreased (-0.955887 --> -0.968166).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6427633
	speed: 0.2464s/iter; left time: 9949.6297s
	iters: 200, epoch: 3 | loss: 0.0020588
	speed: 0.1167s/iter; left time: 4701.1814s
	iters: 300, epoch: 3 | loss: 0.3727460
	speed: 0.1195s/iter; left time: 4802.1906s
	iters: 400, epoch: 3 | loss: 0.0131280
	speed: 0.1177s/iter; left time: 4717.5303s
Epoch: 3 cost time: 48.098636627197266
Epoch: 3, Steps: 413 | Train Loss: 0.166 Vali Loss: 0.765 Vali Acc: 0.922 Test Loss: 0.765 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000159
	speed: 0.2294s/iter; left time: 9166.2287s
	iters: 200, epoch: 4 | loss: 0.0180727
	speed: 0.1086s/iter; left time: 4328.1426s
	iters: 300, epoch: 4 | loss: 0.0000036
	speed: 0.1052s/iter; left time: 4183.2796s
	iters: 400, epoch: 4 | loss: 1.1836648
	speed: 0.1054s/iter; left time: 4180.6555s
Epoch: 4 cost time: 43.48134136199951
Epoch: 4, Steps: 413 | Train Loss: 0.180 Vali Loss: 0.208 Vali Acc: 0.965 Test Loss: 0.208 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1139346
	speed: 0.2212s/iter; left time: 8748.4667s
	iters: 200, epoch: 5 | loss: 0.0177235
	speed: 0.1006s/iter; left time: 3969.6377s
	iters: 300, epoch: 5 | loss: 0.1722672
	speed: 0.1020s/iter; left time: 4015.3201s
	iters: 400, epoch: 5 | loss: 0.0000082
	speed: 0.0992s/iter; left time: 3895.4222s
Epoch: 5 cost time: 41.233638286590576
Epoch: 5, Steps: 413 | Train Loss: 0.210 Vali Loss: 0.411 Vali Acc: 0.943 Test Loss: 0.411 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000160
	speed: 0.2196s/iter; left time: 8594.4680s
	iters: 200, epoch: 6 | loss: 0.0006924
	speed: 0.0986s/iter; left time: 3847.3713s
	iters: 300, epoch: 6 | loss: 0.5377384
	speed: 0.1065s/iter; left time: 4147.7782s
	iters: 400, epoch: 6 | loss: 0.0688944
	speed: 0.1015s/iter; left time: 3940.5246s
Epoch: 6 cost time: 41.76279139518738
Epoch: 6, Steps: 413 | Train Loss: 0.244 Vali Loss: 0.454 Vali Acc: 0.959 Test Loss: 0.454 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2319s/iter; left time: 8978.9996s
	iters: 200, epoch: 7 | loss: 0.0053912
	speed: 0.1018s/iter; left time: 3933.2248s
	iters: 300, epoch: 7 | loss: 0.7545981
	speed: 0.0918s/iter; left time: 3537.6218s
	iters: 400, epoch: 7 | loss: 0.0376667
	speed: 0.0982s/iter; left time: 3773.1978s
Epoch: 7 cost time: 41.632062911987305
Epoch: 7, Steps: 413 | Train Loss: 0.238 Vali Loss: 0.313 Vali Acc: 0.968 Test Loss: 0.313 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000016
	speed: 0.2520s/iter; left time: 9653.0666s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1060s/iter; left time: 4050.2876s
	iters: 300, epoch: 8 | loss: 1.6028206
	speed: 0.1125s/iter; left time: 4285.4892s
	iters: 400, epoch: 8 | loss: 0.0618344
	speed: 0.1056s/iter; left time: 4015.4006s
Epoch: 8 cost time: 45.20112729072571
Epoch: 8, Steps: 413 | Train Loss: 0.296 Vali Loss: 0.639 Vali Acc: 0.945 Test Loss: 0.639 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000838
	speed: 0.2178s/iter; left time: 8253.4756s
	iters: 200, epoch: 9 | loss: 0.0454083
	speed: 0.1031s/iter; left time: 3898.7128s
	iters: 300, epoch: 9 | loss: 0.4697087
	speed: 0.0915s/iter; left time: 3450.0605s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0937s/iter; left time: 3521.2998s
Epoch: 9 cost time: 40.388322591781616
Epoch: 9, Steps: 413 | Train Loss: 0.195 Vali Loss: 0.449 Vali Acc: 0.957 Test Loss: 0.449 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0459970
	speed: 0.2174s/iter; left time: 8149.3506s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0946s/iter; left time: 3536.5904s
	iters: 300, epoch: 10 | loss: 0.0394164
	speed: 0.0988s/iter; left time: 3682.1659s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1004s/iter; left time: 3732.0313s
Epoch: 10 cost time: 40.17175269126892
Epoch: 10, Steps: 413 | Train Loss: 0.283 Vali Loss: 0.876 Vali Acc: 0.942 Test Loss: 0.876 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0002297
	speed: 0.2177s/iter; left time: 8071.7958s
	iters: 200, epoch: 11 | loss: 0.1941395
	speed: 0.0887s/iter; left time: 3278.7944s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0977s/iter; left time: 3603.6327s
	iters: 400, epoch: 11 | loss: 0.1872858
	speed: 0.0945s/iter; left time: 3474.2108s
Epoch: 11 cost time: 38.89949297904968
Epoch: 11, Steps: 413 | Train Loss: 0.214 Vali Loss: 0.809 Vali Acc: 0.945 Test Loss: 0.809 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.2185s/iter; left time: 8009.5330s
	iters: 200, epoch: 12 | loss: 0.0024025
	speed: 0.0946s/iter; left time: 3459.8720s
	iters: 300, epoch: 12 | loss: 0.0000444
	speed: 0.1058s/iter; left time: 3855.9452s
	iters: 400, epoch: 12 | loss: 0.8495975
	speed: 0.1051s/iter; left time: 3822.8191s
Epoch: 12 cost time: 42.213698863983154
Epoch: 12, Steps: 413 | Train Loss: 0.355 Vali Loss: 0.576 Vali Acc: 0.965 Test Loss: 0.576 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9681673487949067
model parameter : 615818
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2937137
	speed: 0.1128s/iter; left time: 4648.5171s
	iters: 200, epoch: 1 | loss: 0.0883109
	speed: 0.0881s/iter; left time: 3618.9910s
	iters: 300, epoch: 1 | loss: 0.2632064
	speed: 0.0944s/iter; left time: 3870.0206s
	iters: 400, epoch: 1 | loss: 0.0872317
	speed: 0.1038s/iter; left time: 4244.9503s
Epoch: 1 cost time: 41.17758107185364
Epoch: 1, Steps: 413 | Train Loss: 0.343 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (inf --> -0.969530).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0001910
	speed: 0.2079s/iter; left time: 8480.0667s
	iters: 200, epoch: 2 | loss: 0.2482077
	speed: 0.0922s/iter; left time: 3749.9413s
	iters: 300, epoch: 2 | loss: 0.2761626
	speed: 0.0932s/iter; left time: 3782.8885s
	iters: 400, epoch: 2 | loss: 0.2758110
	speed: 0.0827s/iter; left time: 3347.2332s
Epoch: 2 cost time: 37.07771635055542
Epoch: 2, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0001904
	speed: 0.2164s/iter; left time: 8736.6144s
	iters: 200, epoch: 3 | loss: 0.3928477
	speed: 0.0852s/iter; left time: 3430.2041s
	iters: 300, epoch: 3 | loss: 0.1421334
	speed: 0.0774s/iter; left time: 3109.1002s
	iters: 400, epoch: 3 | loss: 0.3070605
	speed: 0.0797s/iter; left time: 3192.6772s
Epoch: 3 cost time: 34.82806348800659
Epoch: 3, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.221 Vali Acc: 0.956 Test Loss: 0.221 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0015968
	speed: 0.2127s/iter; left time: 8499.9460s
	iters: 200, epoch: 4 | loss: 0.1464995
	speed: 0.0862s/iter; left time: 3435.6595s
	iters: 300, epoch: 4 | loss: 0.0015714
	speed: 0.0911s/iter; left time: 3621.7575s
	iters: 400, epoch: 4 | loss: 0.2772551
	speed: 0.0977s/iter; left time: 3874.3626s
Epoch: 4 cost time: 38.10226368904114
Epoch: 4, Steps: 413 | Train Loss: 0.152 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
Validation loss decreased (-0.969530 --> -0.973623).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4186264
	speed: 0.1970s/iter; left time: 7790.9387s
	iters: 200, epoch: 5 | loss: 0.3342784
	speed: 0.0784s/iter; left time: 3090.8430s
	iters: 300, epoch: 5 | loss: 0.0000301
	speed: 0.0904s/iter; left time: 3558.1624s
	iters: 400, epoch: 5 | loss: 0.0013332
	speed: 0.0797s/iter; left time: 3128.4460s
Epoch: 5 cost time: 33.66336011886597
Epoch: 5, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.258 Vali Acc: 0.940 Test Loss: 0.258 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000937
	speed: 0.2133s/iter; left time: 8346.1003s
	iters: 200, epoch: 6 | loss: 0.0017315
	speed: 0.0867s/iter; left time: 3386.1263s
	iters: 300, epoch: 6 | loss: 0.0001133
	speed: 0.0730s/iter; left time: 2841.3918s
	iters: 400, epoch: 6 | loss: 0.2630505
	speed: 0.0719s/iter; left time: 2790.7469s
Epoch: 6 cost time: 33.58277487754822
Epoch: 6, Steps: 413 | Train Loss: 0.201 Vali Loss: 0.537 Vali Acc: 0.942 Test Loss: 0.537 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000018
	speed: 0.1988s/iter; left time: 7698.7074s
	iters: 200, epoch: 7 | loss: 0.0000410
	speed: 0.0717s/iter; left time: 2769.9687s
	iters: 300, epoch: 7 | loss: 0.0000092
	speed: 0.0697s/iter; left time: 2686.3464s
	iters: 400, epoch: 7 | loss: 0.0001485
	speed: 0.0708s/iter; left time: 2718.6696s
Epoch: 7 cost time: 31.877411365509033
Epoch: 7, Steps: 413 | Train Loss: 0.209 Vali Loss: 0.438 Vali Acc: 0.946 Test Loss: 0.438 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.8816972
	speed: 0.1776s/iter; left time: 6803.5639s
	iters: 200, epoch: 8 | loss: 1.0466024
	speed: 0.0712s/iter; left time: 2721.6956s
	iters: 300, epoch: 8 | loss: 0.0000007
	speed: 0.0817s/iter; left time: 3114.6102s
	iters: 400, epoch: 8 | loss: 0.2793483
	speed: 0.0803s/iter; left time: 3053.3296s
Epoch: 8 cost time: 31.141704559326172
Epoch: 8, Steps: 413 | Train Loss: 0.250 Vali Loss: 0.436 Vali Acc: 0.951 Test Loss: 0.436 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0167838
	speed: 0.1979s/iter; left time: 7499.9136s
	iters: 200, epoch: 9 | loss: 1.6768477
	speed: 0.0732s/iter; left time: 2767.7147s
	iters: 300, epoch: 9 | loss: 0.0000442
	speed: 0.0777s/iter; left time: 2929.0074s
	iters: 400, epoch: 9 | loss: 0.0000012
	speed: 0.0656s/iter; left time: 2466.3457s
Epoch: 9 cost time: 30.38209104537964
Epoch: 9, Steps: 413 | Train Loss: 0.210 Vali Loss: 0.330 Vali Acc: 0.967 Test Loss: 0.330 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.3649972
	speed: 0.1956s/iter; left time: 7333.1038s
	iters: 200, epoch: 10 | loss: 0.0000064
	speed: 0.0895s/iter; left time: 3347.2343s
	iters: 300, epoch: 10 | loss: 0.1709685
	speed: 0.0889s/iter; left time: 3315.2280s
	iters: 400, epoch: 10 | loss: 0.1085626
	speed: 0.0892s/iter; left time: 3317.3515s
Epoch: 10 cost time: 36.82359027862549
Epoch: 10, Steps: 413 | Train Loss: 0.179 Vali Loss: 0.670 Vali Acc: 0.939 Test Loss: 0.670 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2027s/iter; left time: 7515.5378s
	iters: 200, epoch: 11 | loss: 0.7618002
	speed: 0.0687s/iter; left time: 2540.4233s
	iters: 300, epoch: 11 | loss: 0.0015094
	speed: 0.0746s/iter; left time: 2752.0770s
	iters: 400, epoch: 11 | loss: 0.0000068
	speed: 0.0717s/iter; left time: 2637.7507s
Epoch: 11 cost time: 31.02047634124756
Epoch: 11, Steps: 413 | Train Loss: 0.213 Vali Loss: 0.461 Vali Acc: 0.964 Test Loss: 0.461 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1987s/iter; left time: 7285.0537s
	iters: 200, epoch: 12 | loss: 0.0008864
	speed: 0.0777s/iter; left time: 2840.9371s
	iters: 300, epoch: 12 | loss: 0.4728217
	speed: 0.0744s/iter; left time: 2711.4701s
	iters: 400, epoch: 12 | loss: 0.0000190
	speed: 0.0702s/iter; left time: 2552.3286s
Epoch: 12 cost time: 31.811742782592773
Epoch: 12, Steps: 413 | Train Loss: 0.226 Vali Loss: 0.428 Vali Acc: 0.959 Test Loss: 0.428 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000005
	speed: 0.2063s/iter; left time: 7477.6160s
	iters: 200, epoch: 13 | loss: 0.0000508
	speed: 0.0682s/iter; left time: 2464.0834s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0611s/iter; left time: 2203.2840s
	iters: 400, epoch: 13 | loss: 0.0157364
	speed: 0.0671s/iter; left time: 2413.0869s
Epoch: 13 cost time: 29.568888902664185
Epoch: 13, Steps: 413 | Train Loss: 0.231 Vali Loss: 0.645 Vali Acc: 0.941 Test Loss: 0.645 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000388
	speed: 0.2127s/iter; left time: 7621.0284s
	iters: 200, epoch: 14 | loss: 0.0090251
	speed: 0.0895s/iter; left time: 3197.3672s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0925s/iter; left time: 3295.4985s
	iters: 400, epoch: 14 | loss: 0.6105390
	speed: 0.0909s/iter; left time: 3230.4362s
Epoch: 14 cost time: 38.03293466567993
Epoch: 14, Steps: 413 | Train Loss: 0.243 Vali Loss: 1.085 Vali Acc: 0.918 Test Loss: 1.085 Test Acc: 0.918
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9736243747157799
model parameter : 549898
model size : 4.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1636103
	speed: 0.1194s/iter; left time: 4917.9360s
	iters: 200, epoch: 1 | loss: 0.0341375
	speed: 0.1033s/iter; left time: 4246.5613s
	iters: 300, epoch: 1 | loss: 0.0025775
	speed: 0.1076s/iter; left time: 4410.7776s
	iters: 400, epoch: 1 | loss: 0.0371420
	speed: 0.1121s/iter; left time: 4586.5745s
Epoch: 1 cost time: 45.547977447509766
Epoch: 1, Steps: 413 | Train Loss: 0.349 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
Validation loss decreased (inf --> -0.958616).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0015044
	speed: 0.2396s/iter; left time: 9771.2063s
	iters: 200, epoch: 2 | loss: 0.0149522
	speed: 0.1106s/iter; left time: 4499.7143s
	iters: 300, epoch: 2 | loss: 0.0001790
	speed: 0.0944s/iter; left time: 3830.4005s
	iters: 400, epoch: 2 | loss: 0.0002326
	speed: 0.0897s/iter; left time: 3629.8770s
Epoch: 2 cost time: 42.09664273262024
Epoch: 2, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.958616 --> -0.964983).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000285
	speed: 0.2220s/iter; left time: 8962.6961s
	iters: 200, epoch: 3 | loss: 0.0006955
	speed: 0.0893s/iter; left time: 3595.4690s
	iters: 300, epoch: 3 | loss: 0.0393511
	speed: 0.0872s/iter; left time: 3504.3137s
	iters: 400, epoch: 3 | loss: 0.1694724
	speed: 0.0878s/iter; left time: 3517.1749s
Epoch: 3 cost time: 37.64979577064514
Epoch: 3, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.231 Vali Acc: 0.963 Test Loss: 0.231 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1292052
	speed: 0.1919s/iter; left time: 7669.9643s
	iters: 200, epoch: 4 | loss: 0.0002028
	speed: 0.0985s/iter; left time: 3927.5379s
	iters: 300, epoch: 4 | loss: 0.0002570
	speed: 0.1183s/iter; left time: 4703.8749s
	iters: 400, epoch: 4 | loss: 0.2653047
	speed: 0.1111s/iter; left time: 4407.2116s
Epoch: 4 cost time: 43.48203945159912
Epoch: 4, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000490
	speed: 0.2381s/iter; left time: 9416.2308s
	iters: 200, epoch: 5 | loss: 0.0220229
	speed: 0.1038s/iter; left time: 4094.9859s
	iters: 300, epoch: 5 | loss: 0.0506791
	speed: 0.1070s/iter; left time: 4209.3139s
	iters: 400, epoch: 5 | loss: 0.0750402
	speed: 0.1100s/iter; left time: 4318.9798s
Epoch: 5 cost time: 44.53323006629944
Epoch: 5, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.696 Vali Acc: 0.910 Test Loss: 0.696 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0150038
	speed: 0.2107s/iter; left time: 8246.1732s
	iters: 200, epoch: 6 | loss: 0.0000001
	speed: 0.0843s/iter; left time: 3289.6860s
	iters: 300, epoch: 6 | loss: 0.4643449
	speed: 0.1089s/iter; left time: 4239.9535s
	iters: 400, epoch: 6 | loss: 0.0000504
	speed: 0.1161s/iter; left time: 4508.4468s
Epoch: 6 cost time: 40.433709383010864
Epoch: 6, Steps: 413 | Train Loss: 0.170 Vali Loss: 0.500 Vali Acc: 0.930 Test Loss: 0.500 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1200747
	speed: 0.2652s/iter; left time: 10271.0127s
	iters: 200, epoch: 7 | loss: 0.7808309
	speed: 0.1183s/iter; left time: 4568.6680s
	iters: 300, epoch: 7 | loss: 0.1146843
	speed: 0.0961s/iter; left time: 3701.8480s
	iters: 400, epoch: 7 | loss: 0.4586887
	speed: 0.0838s/iter; left time: 3220.3862s
Epoch: 7 cost time: 44.46644186973572
Epoch: 7, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.331 Vali Acc: 0.960 Test Loss: 0.331 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1029271
	speed: 0.2305s/iter; left time: 8830.1137s
	iters: 200, epoch: 8 | loss: 0.5770079
	speed: 0.1047s/iter; left time: 4000.6508s
	iters: 300, epoch: 8 | loss: 0.0479357
	speed: 0.0981s/iter; left time: 3736.8279s
	iters: 400, epoch: 8 | loss: 1.1934441
	speed: 0.1020s/iter; left time: 3877.6469s
Epoch: 8 cost time: 42.954482555389404
Epoch: 8, Steps: 413 | Train Loss: 0.173 Vali Loss: 0.218 Vali Acc: 0.967 Test Loss: 0.218 Test Acc: 0.967
Validation loss decreased (-0.964983 --> -0.967256).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5532416
	speed: 0.2317s/iter; left time: 8781.4385s
	iters: 200, epoch: 9 | loss: 0.0742468
	speed: 0.0871s/iter; left time: 3293.8735s
	iters: 300, epoch: 9 | loss: 2.6431036
	speed: 0.0858s/iter; left time: 3236.0702s
	iters: 400, epoch: 9 | loss: 0.0004120
	speed: 0.1041s/iter; left time: 3915.5501s
Epoch: 9 cost time: 39.71025776863098
Epoch: 9, Steps: 413 | Train Loss: 0.166 Vali Loss: 0.897 Vali Acc: 0.909 Test Loss: 0.897 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0018733
	speed: 0.2327s/iter; left time: 8722.2785s
	iters: 200, epoch: 10 | loss: 0.1227939
	speed: 0.0987s/iter; left time: 3691.4414s
	iters: 300, epoch: 10 | loss: 0.0069971
	speed: 0.0939s/iter; left time: 3501.4992s
	iters: 400, epoch: 10 | loss: 0.0004559
	speed: 0.0969s/iter; left time: 3604.2634s
Epoch: 10 cost time: 41.109419107437134
Epoch: 10, Steps: 413 | Train Loss: 0.175 Vali Loss: 0.330 Vali Acc: 0.958 Test Loss: 0.330 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3991610
	speed: 0.2147s/iter; left time: 7957.4939s
	iters: 200, epoch: 11 | loss: 0.0017678
	speed: 0.0970s/iter; left time: 3587.2470s
	iters: 300, epoch: 11 | loss: 0.0000003
	speed: 0.0964s/iter; left time: 3554.1856s
	iters: 400, epoch: 11 | loss: 0.0000015
	speed: 0.0933s/iter; left time: 3430.7297s
Epoch: 11 cost time: 39.77916407585144
Epoch: 11, Steps: 413 | Train Loss: 0.162 Vali Loss: 0.420 Vali Acc: 0.962 Test Loss: 0.420 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0219718
	speed: 0.2130s/iter; left time: 7806.6526s
	iters: 200, epoch: 12 | loss: 0.8973340
	speed: 0.0897s/iter; left time: 3278.8025s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0848s/iter; left time: 3092.5301s
	iters: 400, epoch: 12 | loss: 0.6978734
	speed: 0.0899s/iter; left time: 3267.7981s
Epoch: 12 cost time: 37.29124927520752
Epoch: 12, Steps: 413 | Train Loss: 0.250 Vali Loss: 0.422 Vali Acc: 0.960 Test Loss: 0.422 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0571346
	speed: 0.2213s/iter; left time: 8020.0262s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0864s/iter; left time: 3121.9521s
	iters: 300, epoch: 13 | loss: 0.0000087
	speed: 0.0802s/iter; left time: 2892.5998s
	iters: 400, epoch: 13 | loss: 1.2831365
	speed: 0.0882s/iter; left time: 3169.4350s
Epoch: 13 cost time: 36.54193139076233
Epoch: 13, Steps: 413 | Train Loss: 0.187 Vali Loss: 0.216 Vali Acc: 0.977 Test Loss: 0.216 Test Acc: 0.977
Validation loss decreased (-0.967256 --> -0.976805).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.1959s/iter; left time: 7018.5602s
	iters: 200, epoch: 14 | loss: 0.0000003
	speed: 0.0884s/iter; left time: 3159.0320s
	iters: 300, epoch: 14 | loss: 0.0000264
	speed: 0.0848s/iter; left time: 3020.4101s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0769s/iter; left time: 2730.6998s
Epoch: 14 cost time: 33.696836948394775
Epoch: 14, Steps: 413 | Train Loss: 0.177 Vali Loss: 0.483 Vali Acc: 0.956 Test Loss: 0.483 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1081090
	speed: 0.1934s/iter; left time: 6851.2714s
	iters: 200, epoch: 15 | loss: 0.0000375
	speed: 0.0694s/iter; left time: 2451.9604s
	iters: 300, epoch: 15 | loss: 0.4747487
	speed: 0.0838s/iter; left time: 2950.9205s
	iters: 400, epoch: 15 | loss: 0.8385001
	speed: 0.0888s/iter; left time: 3120.1249s
Epoch: 15 cost time: 32.89382290840149
Epoch: 15, Steps: 413 | Train Loss: 0.189 Vali Loss: 0.922 Vali Acc: 0.921 Test Loss: 0.922 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0183619
	speed: 0.2223s/iter; left time: 7780.6258s
	iters: 200, epoch: 16 | loss: 0.0000008
	speed: 0.0992s/iter; left time: 3461.4321s
	iters: 300, epoch: 16 | loss: 0.0000183
	speed: 0.0988s/iter; left time: 3438.4317s
	iters: 400, epoch: 16 | loss: 0.0283169
	speed: 0.1042s/iter; left time: 3616.0894s
Epoch: 16 cost time: 41.22915172576904
Epoch: 16, Steps: 413 | Train Loss: 0.210 Vali Loss: 0.470 Vali Acc: 0.951 Test Loss: 0.470 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.2326884
	speed: 0.2377s/iter; left time: 8221.8089s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 2729.2052s
	iters: 300, epoch: 17 | loss: 0.4633505
	speed: 0.0889s/iter; left time: 3057.0578s
	iters: 400, epoch: 17 | loss: 0.0000270
	speed: 0.0871s/iter; left time: 2986.0348s
Epoch: 17 cost time: 38.44211411476135
Epoch: 17, Steps: 413 | Train Loss: 0.188 Vali Loss: 0.420 Vali Acc: 0.960 Test Loss: 0.420 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0001268
	speed: 0.2133s/iter; left time: 7290.9280s
	iters: 200, epoch: 18 | loss: 0.0000014
	speed: 0.0904s/iter; left time: 3079.4388s
	iters: 300, epoch: 18 | loss: 0.0613978
	speed: 0.0813s/iter; left time: 2763.7057s
	iters: 400, epoch: 18 | loss: 0.0000004
	speed: 0.0953s/iter; left time: 3227.9347s
Epoch: 18 cost time: 37.25026297569275
Epoch: 18, Steps: 413 | Train Loss: 0.161 Vali Loss: 0.338 Vali Acc: 0.972 Test Loss: 0.338 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2165s/iter; left time: 7311.3736s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0803s/iter; left time: 2704.8494s
	iters: 300, epoch: 19 | loss: 0.0018206
	speed: 0.0789s/iter; left time: 2649.3698s
	iters: 400, epoch: 19 | loss: 1.6038094
	speed: 0.0785s/iter; left time: 2626.2787s
Epoch: 19 cost time: 34.58698630332947
Epoch: 19, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.950 Vali Acc: 0.905 Test Loss: 0.950 Test Acc: 0.905
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2155s/iter; left time: 7188.5362s
	iters: 200, epoch: 20 | loss: 0.0000154
	speed: 0.0997s/iter; left time: 3316.0544s
	iters: 300, epoch: 20 | loss: 0.0244566
	speed: 0.0902s/iter; left time: 2990.0295s
	iters: 400, epoch: 20 | loss: 0.0007712
	speed: 0.0869s/iter; left time: 2873.8466s
Epoch: 20 cost time: 37.6300265789032
Epoch: 20, Steps: 413 | Train Loss: 0.218 Vali Loss: 0.540 Vali Acc: 0.953 Test Loss: 0.540 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0001527
	speed: 0.2259s/iter; left time: 7441.8862s
	iters: 200, epoch: 21 | loss: 0.1466825
	speed: 0.0856s/iter; left time: 2810.8121s
	iters: 300, epoch: 21 | loss: 0.0000316
	speed: 0.0833s/iter; left time: 2726.8440s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0863s/iter; left time: 2816.0789s
Epoch: 21 cost time: 36.15552520751953
Epoch: 21, Steps: 413 | Train Loss: 0.184 Vali Loss: 0.267 Vali Acc: 0.974 Test Loss: 0.267 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000123
	speed: 0.1956s/iter; left time: 6363.8366s
	iters: 200, epoch: 22 | loss: 0.9132541
	speed: 0.0711s/iter; left time: 2307.0608s
	iters: 300, epoch: 22 | loss: 0.0000970
	speed: 0.0947s/iter; left time: 3060.9707s
	iters: 400, epoch: 22 | loss: 0.0044259
	speed: 0.0870s/iter; left time: 2803.6582s
Epoch: 22 cost time: 34.534475564956665
Epoch: 22, Steps: 413 | Train Loss: 0.140 Vali Loss: 1.081 Vali Acc: 0.915 Test Loss: 1.081 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000001
	speed: 0.2048s/iter; left time: 6577.6664s
	iters: 200, epoch: 23 | loss: 0.0102377
	speed: 0.0868s/iter; left time: 2778.4785s
	iters: 300, epoch: 23 | loss: 0.0145543
	speed: 0.0742s/iter; left time: 2369.2534s
	iters: 400, epoch: 23 | loss: 0.0002316
	speed: 0.0724s/iter; left time: 2302.0578s
Epoch: 23 cost time: 33.30827307701111
Epoch: 23, Steps: 413 | Train Loss: 0.222 Vali Loss: 0.509 Vali Acc: 0.952 Test Loss: 0.509 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9768076398362893
model parameter : 517258
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0003101
	speed: 0.1546s/iter; left time: 6368.3603s
	iters: 200, epoch: 1 | loss: 0.5837001
	speed: 0.1398s/iter; left time: 5744.2133s
	iters: 300, epoch: 1 | loss: 0.7515219
	speed: 0.1323s/iter; left time: 5422.8097s
	iters: 400, epoch: 1 | loss: 0.2127497
	speed: 0.1284s/iter; left time: 5252.1403s
Epoch: 1 cost time: 57.19648337364197
Epoch: 1, Steps: 413 | Train Loss: 0.429 Vali Loss: 0.268 Vali Acc: 0.943 Test Loss: 0.268 Test Acc: 0.943
Validation loss decreased (inf --> -0.943153).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4509578
	speed: 0.3014s/iter; left time: 12294.7156s
	iters: 200, epoch: 2 | loss: 0.0161502
	speed: 0.1161s/iter; left time: 4724.1961s
	iters: 300, epoch: 2 | loss: 0.2206697
	speed: 0.1199s/iter; left time: 4864.9656s
	iters: 400, epoch: 2 | loss: 0.0026553
	speed: 0.1281s/iter; left time: 5186.2249s
Epoch: 2 cost time: 50.62824630737305
Epoch: 2, Steps: 413 | Train Loss: 0.271 Vali Loss: 0.328 Vali Acc: 0.960 Test Loss: 0.328 Test Acc: 0.960
Validation loss decreased (-0.943153 --> -0.959524).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4391709
	speed: 0.2952s/iter; left time: 11919.6571s
	iters: 200, epoch: 3 | loss: 0.0003559
	speed: 0.1235s/iter; left time: 4974.1231s
	iters: 300, epoch: 3 | loss: 0.0000000
	speed: 0.1192s/iter; left time: 4789.6004s
	iters: 400, epoch: 3 | loss: 0.0003254
	speed: 0.1223s/iter; left time: 4902.3412s
Epoch: 3 cost time: 51.00893521308899
Epoch: 3, Steps: 413 | Train Loss: 0.331 Vali Loss: 0.512 Vali Acc: 0.943 Test Loss: 0.512 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.3109s/iter; left time: 12423.3059s
	iters: 200, epoch: 4 | loss: 0.0020337
	speed: 0.1348s/iter; left time: 5375.0529s
	iters: 300, epoch: 4 | loss: 0.6701666
	speed: 0.1446s/iter; left time: 5750.3650s
	iters: 400, epoch: 4 | loss: 1.4084514
	speed: 0.1325s/iter; left time: 5253.5693s
Epoch: 4 cost time: 55.77998185157776
Epoch: 4, Steps: 413 | Train Loss: 0.337 Vali Loss: 0.523 Vali Acc: 0.965 Test Loss: 0.523 Test Acc: 0.965
Validation loss decreased (-0.959524 --> -0.964524).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1006234
	speed: 0.3142s/iter; left time: 12426.3083s
	iters: 200, epoch: 5 | loss: 0.0085677
	speed: 0.1288s/iter; left time: 5079.8064s
	iters: 300, epoch: 5 | loss: 2.5475311
	speed: 0.1329s/iter; left time: 5231.0950s
	iters: 400, epoch: 5 | loss: 0.8766544
	speed: 0.1261s/iter; left time: 4950.3052s
Epoch: 5 cost time: 54.56443905830383
Epoch: 5, Steps: 413 | Train Loss: 0.440 Vali Loss: 1.664 Vali Acc: 0.931 Test Loss: 1.664 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.3038s/iter; left time: 11889.8391s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.1195s/iter; left time: 4664.2781s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.1190s/iter; left time: 4635.2103s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.1194s/iter; left time: 4638.6695s
Epoch: 6 cost time: 50.876747608184814
Epoch: 6, Steps: 413 | Train Loss: 0.475 Vali Loss: 1.810 Vali Acc: 0.910 Test Loss: 1.810 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.3003s/iter; left time: 11628.4104s
	iters: 200, epoch: 7 | loss: 2.2693143
	speed: 0.1151s/iter; left time: 4446.0304s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.1395s/iter; left time: 5374.4645s
	iters: 400, epoch: 7 | loss: 0.0004463
	speed: 0.1453s/iter; left time: 5583.8962s
Epoch: 7 cost time: 54.88758611679077
Epoch: 7, Steps: 413 | Train Loss: 0.538 Vali Loss: 1.718 Vali Acc: 0.939 Test Loss: 1.718 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000015
	speed: 0.3371s/iter; left time: 12913.8677s
	iters: 200, epoch: 8 | loss: 4.4592671
	speed: 0.1350s/iter; left time: 5157.6859s
	iters: 300, epoch: 8 | loss: 0.0002949
	speed: 0.1390s/iter; left time: 5296.7902s
	iters: 400, epoch: 8 | loss: 0.8950649
	speed: 0.1359s/iter; left time: 5165.7366s
Epoch: 8 cost time: 56.95757818222046
Epoch: 8, Steps: 413 | Train Loss: 0.528 Vali Loss: 0.993 Vali Acc: 0.957 Test Loss: 0.993 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000122
	speed: 0.3016s/iter; left time: 11428.5221s
	iters: 200, epoch: 9 | loss: 0.1185398
	speed: 0.1319s/iter; left time: 4986.2643s
	iters: 300, epoch: 9 | loss: 0.0000043
	speed: 0.1326s/iter; left time: 4999.2258s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1347s/iter; left time: 5065.4451s
Epoch: 9 cost time: 54.93042826652527
Epoch: 9, Steps: 413 | Train Loss: 0.370 Vali Loss: 1.647 Vali Acc: 0.945 Test Loss: 1.647 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6735977
	speed: 0.2968s/iter; left time: 11124.3013s
	iters: 200, epoch: 10 | loss: 0.0017323
	speed: 0.1330s/iter; left time: 4972.6390s
	iters: 300, epoch: 10 | loss: 2.1442761
	speed: 0.1294s/iter; left time: 4823.8326s
	iters: 400, epoch: 10 | loss: 0.3640293
	speed: 0.1312s/iter; left time: 4876.7172s
Epoch: 10 cost time: 53.284292459487915
Epoch: 10, Steps: 413 | Train Loss: 0.462 Vali Loss: 2.640 Vali Acc: 0.886 Test Loss: 2.640 Test Acc: 0.886
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0037658
	speed: 0.2915s/iter; left time: 10805.7385s
	iters: 200, epoch: 11 | loss: 0.2365743
	speed: 0.1230s/iter; left time: 4546.4637s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1317s/iter; left time: 4856.4019s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1401s/iter; left time: 5152.8631s
Epoch: 11 cost time: 53.11558771133423
Epoch: 11, Steps: 413 | Train Loss: 0.328 Vali Loss: 1.176 Vali Acc: 0.963 Test Loss: 1.176 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2995s/iter; left time: 10977.3364s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1152s/iter; left time: 4212.1901s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1168s/iter; left time: 4258.6603s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1262s/iter; left time: 4588.4740s
Epoch: 12 cost time: 49.700071811676025
Epoch: 12, Steps: 413 | Train Loss: 0.387 Vali Loss: 1.095 Vali Acc: 0.964 Test Loss: 1.095 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2982s/iter; left time: 10807.6341s
	iters: 200, epoch: 13 | loss: 2.5791795
	speed: 0.1247s/iter; left time: 4506.2802s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1246s/iter; left time: 4490.3714s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1166s/iter; left time: 4191.3328s
Epoch: 13 cost time: 51.31520867347717
Epoch: 13, Steps: 413 | Train Loss: 0.342 Vali Loss: 2.101 Vali Acc: 0.923 Test Loss: 2.101 Test Acc: 0.923
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3050s/iter; left time: 10930.0233s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.1289s/iter; left time: 4604.1871s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1330s/iter; left time: 4737.3954s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1203s/iter; left time: 4273.3121s
Epoch: 14 cost time: 52.47292399406433
Epoch: 14, Steps: 413 | Train Loss: 0.294 Vali Loss: 2.064 Vali Acc: 0.948 Test Loss: 2.064 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9645293315143247
model parameter : 1081482
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1218544
	speed: 0.1427s/iter; left time: 5879.0549s
	iters: 200, epoch: 1 | loss: 0.2550780
	speed: 0.1168s/iter; left time: 4798.7907s
	iters: 300, epoch: 1 | loss: 0.0895361
	speed: 0.1129s/iter; left time: 4629.7819s
	iters: 400, epoch: 1 | loss: 0.1011115
	speed: 0.1285s/iter; left time: 5254.1017s
Epoch: 1 cost time: 51.96508431434631
Epoch: 1, Steps: 413 | Train Loss: 0.371 Vali Loss: 0.260 Vali Acc: 0.954 Test Loss: 0.260 Test Acc: 0.954
Validation loss decreased (inf --> -0.954067).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2619069
	speed: 0.3128s/iter; left time: 12759.5562s
	iters: 200, epoch: 2 | loss: 0.1259553
	speed: 0.1414s/iter; left time: 5751.4562s
	iters: 300, epoch: 2 | loss: 0.0067518
	speed: 0.1505s/iter; left time: 6107.5075s
	iters: 400, epoch: 2 | loss: 0.0195304
	speed: 0.1414s/iter; left time: 5724.1212s
Epoch: 2 cost time: 60.64622688293457
Epoch: 2, Steps: 413 | Train Loss: 0.192 Vali Loss: 0.544 Vali Acc: 0.964 Test Loss: 0.544 Test Acc: 0.964
Validation loss decreased (-0.954067 --> -0.963614).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6932669
	speed: 0.3233s/iter; left time: 13051.4032s
	iters: 200, epoch: 3 | loss: 0.2048516
	speed: 0.1185s/iter; left time: 4772.7315s
	iters: 300, epoch: 3 | loss: 1.4852010
	speed: 0.1333s/iter; left time: 5354.9332s
	iters: 400, epoch: 3 | loss: 0.0000011
	speed: 0.1320s/iter; left time: 5289.6204s
Epoch: 3 cost time: 55.69501829147339
Epoch: 3, Steps: 413 | Train Loss: 0.252 Vali Loss: 0.384 Vali Acc: 0.953 Test Loss: 0.384 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1609953
	speed: 0.2639s/iter; left time: 10547.0579s
	iters: 200, epoch: 4 | loss: 0.0000348
	speed: 0.1044s/iter; left time: 4162.1330s
	iters: 300, epoch: 4 | loss: 0.0029962
	speed: 0.1175s/iter; left time: 4670.8612s
	iters: 400, epoch: 4 | loss: 0.0005524
	speed: 0.1242s/iter; left time: 4925.3989s
Epoch: 4 cost time: 47.5444610118866
Epoch: 4, Steps: 413 | Train Loss: 0.244 Vali Loss: 0.995 Vali Acc: 0.923 Test Loss: 0.995 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0049052
	speed: 0.2748s/iter; left time: 10869.0609s
	iters: 200, epoch: 5 | loss: 0.0000001
	speed: 0.1251s/iter; left time: 4934.9380s
	iters: 300, epoch: 5 | loss: 0.6414778
	speed: 0.0918s/iter; left time: 3611.3759s
	iters: 400, epoch: 5 | loss: 0.0000005
	speed: 0.0908s/iter; left time: 3563.2135s
Epoch: 5 cost time: 44.29259967803955
Epoch: 5, Steps: 413 | Train Loss: 0.323 Vali Loss: 0.740 Vali Acc: 0.950 Test Loss: 0.740 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0013795
	speed: 0.2714s/iter; left time: 10619.9934s
	iters: 200, epoch: 6 | loss: 0.0000025
	speed: 0.1095s/iter; left time: 4276.2515s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.1277s/iter; left time: 4973.5142s
	iters: 400, epoch: 6 | loss: 0.2612029
	speed: 0.1030s/iter; left time: 4000.9645s
Epoch: 6 cost time: 47.86184644699097
Epoch: 6, Steps: 413 | Train Loss: 0.410 Vali Loss: 0.824 Vali Acc: 0.950 Test Loss: 0.824 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0398444
	speed: 0.2443s/iter; left time: 9460.8507s
	iters: 200, epoch: 7 | loss: 1.6299390
	speed: 0.1024s/iter; left time: 3953.1519s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.1253s/iter; left time: 4828.6512s
	iters: 400, epoch: 7 | loss: 0.2982398
	speed: 0.1783s/iter; left time: 6849.8102s
Epoch: 7 cost time: 54.51756978034973
Epoch: 7, Steps: 413 | Train Loss: 0.383 Vali Loss: 1.042 Vali Acc: 0.951 Test Loss: 1.042 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0486941
	speed: 0.3032s/iter; left time: 11616.5045s
	iters: 200, epoch: 8 | loss: 0.0413806
	speed: 0.1231s/iter; left time: 4703.2297s
	iters: 300, epoch: 8 | loss: 0.2632168
	speed: 0.1748s/iter; left time: 6660.4380s
	iters: 400, epoch: 8 | loss: 0.0785676
	speed: 0.1837s/iter; left time: 6983.5899s
Epoch: 8 cost time: 64.36934566497803
Epoch: 8, Steps: 413 | Train Loss: 0.338 Vali Loss: 0.731 Vali Acc: 0.949 Test Loss: 0.731 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.3993520
	speed: 0.3454s/iter; left time: 13089.8920s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1582s/iter; left time: 5978.9913s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.1774s/iter; left time: 6688.3812s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1610s/iter; left time: 6054.8424s
Epoch: 9 cost time: 67.84852337837219
Epoch: 9, Steps: 413 | Train Loss: 0.305 Vali Loss: 0.692 Vali Acc: 0.951 Test Loss: 0.692 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1834319
	speed: 0.3299s/iter; left time: 12366.9778s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1755s/iter; left time: 6559.1814s
	iters: 300, epoch: 10 | loss: 0.6250014
	speed: 0.1717s/iter; left time: 6400.8821s
	iters: 400, epoch: 10 | loss: 2.2243745
	speed: 0.1481s/iter; left time: 5505.3650s
Epoch: 10 cost time: 67.55366778373718
Epoch: 10, Steps: 413 | Train Loss: 0.319 Vali Loss: 0.458 Vali Acc: 0.970 Test Loss: 0.458 Test Acc: 0.970
Validation loss decreased (-0.963614 --> -0.969527).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3341215
	speed: 0.3509s/iter; left time: 13006.9056s
	iters: 200, epoch: 11 | loss: 0.0009966
	speed: 0.1710s/iter; left time: 6321.6695s
	iters: 300, epoch: 11 | loss: 0.4542968
	speed: 0.1455s/iter; left time: 5363.0371s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1501s/iter; left time: 5520.6748s
Epoch: 11 cost time: 65.9994478225708
Epoch: 11, Steps: 413 | Train Loss: 0.350 Vali Loss: 1.874 Vali Acc: 0.913 Test Loss: 1.874 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0417805
	speed: 0.3858s/iter; left time: 14142.5247s
	iters: 200, epoch: 12 | loss: 0.0000409
	speed: 0.1901s/iter; left time: 6950.1454s
	iters: 300, epoch: 12 | loss: 0.0161877
	speed: 0.1935s/iter; left time: 7053.1527s
	iters: 400, epoch: 12 | loss: 0.0434136
	speed: 0.2153s/iter; left time: 7827.9829s
Epoch: 12 cost time: 82.59097027778625
Epoch: 12, Steps: 413 | Train Loss: 0.394 Vali Loss: 1.191 Vali Acc: 0.947 Test Loss: 1.191 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.4238s/iter; left time: 15362.1902s
	iters: 200, epoch: 13 | loss: 0.0019218
	speed: 0.1872s/iter; left time: 6767.1262s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1774s/iter; left time: 6393.3809s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1927s/iter; left time: 6925.5772s
Epoch: 13 cost time: 79.95984959602356
Epoch: 13, Steps: 413 | Train Loss: 0.359 Vali Loss: 1.214 Vali Acc: 0.959 Test Loss: 1.214 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0019052
	speed: 0.3654s/iter; left time: 13093.9494s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1578s/iter; left time: 5636.8752s
	iters: 300, epoch: 14 | loss: 0.7299297
	speed: 0.1876s/iter; left time: 6685.6812s
	iters: 400, epoch: 14 | loss: 0.7197982
	speed: 0.1915s/iter; left time: 6803.0793s
Epoch: 14 cost time: 73.35918545722961
Epoch: 14, Steps: 413 | Train Loss: 0.306 Vali Loss: 0.770 Vali Acc: 0.972 Test Loss: 0.770 Test Acc: 0.972
Validation loss decreased (-0.969527 --> -0.971798).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1596195
	speed: 0.3463s/iter; left time: 12266.2508s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1614s/iter; left time: 5701.9153s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1812s/iter; left time: 6382.7827s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.1642s/iter; left time: 5766.0465s
Epoch: 15 cost time: 69.64736318588257
Epoch: 15, Steps: 413 | Train Loss: 0.359 Vali Loss: 0.971 Vali Acc: 0.966 Test Loss: 0.971 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000004
	speed: 0.3329s/iter; left time: 11651.9681s
	iters: 200, epoch: 16 | loss: 0.7072399
	speed: 0.1840s/iter; left time: 6423.9655s
	iters: 300, epoch: 16 | loss: 0.0003859
	speed: 0.1773s/iter; left time: 6170.2613s
	iters: 400, epoch: 16 | loss: 0.4238088
	speed: 0.1716s/iter; left time: 5956.8710s
Epoch: 16 cost time: 72.14700937271118
Epoch: 16, Steps: 413 | Train Loss: 0.278 Vali Loss: 1.718 Vali Acc: 0.938 Test Loss: 1.718 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3481s/iter; left time: 12043.5400s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1716s/iter; left time: 5919.3290s
	iters: 300, epoch: 17 | loss: 1.7556103
	speed: 0.1641s/iter; left time: 5642.2481s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.1716s/iter; left time: 5886.3258s
Epoch: 17 cost time: 70.72038722038269
Epoch: 17, Steps: 413 | Train Loss: 0.352 Vali Loss: 1.032 Vali Acc: 0.960 Test Loss: 1.032 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.7059193
	speed: 0.3453s/iter; left time: 11802.6042s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1620s/iter; left time: 5520.9148s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1536s/iter; left time: 5219.6455s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1691s/iter; left time: 5729.0852s
Epoch: 18 cost time: 68.28535890579224
Epoch: 18, Steps: 413 | Train Loss: 0.274 Vali Loss: 1.504 Vali Acc: 0.958 Test Loss: 1.504 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.3445s/iter; left time: 11631.8396s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1572s/iter; left time: 5293.6282s
	iters: 300, epoch: 19 | loss: 0.0341585
	speed: 0.1624s/iter; left time: 5452.4913s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1865s/iter; left time: 6242.6922s
Epoch: 19 cost time: 69.33803844451904
Epoch: 19, Steps: 413 | Train Loss: 0.230 Vali Loss: 0.886 Vali Acc: 0.971 Test Loss: 0.886 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2180246
	speed: 0.3485s/iter; left time: 11622.3251s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1646s/iter; left time: 5473.1157s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.1760s/iter; left time: 5836.1660s
	iters: 400, epoch: 20 | loss: 0.0000050
	speed: 0.1442s/iter; left time: 4764.8304s
Epoch: 20 cost time: 66.01291537284851
Epoch: 20, Steps: 413 | Train Loss: 0.530 Vali Loss: 1.297 Vali Acc: 0.955 Test Loss: 1.297 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.3103s/iter; left time: 10222.3009s
	iters: 200, epoch: 21 | loss: 0.2558655
	speed: 0.1735s/iter; left time: 5698.5805s
	iters: 300, epoch: 21 | loss: 2.1224284
	speed: 0.1775s/iter; left time: 5809.9845s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1260s/iter; left time: 4112.7061s
Epoch: 21 cost time: 63.87655568122864
Epoch: 21, Steps: 413 | Train Loss: 0.379 Vali Loss: 1.004 Vali Acc: 0.966 Test Loss: 1.004 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.3242s/iter; left time: 10545.1505s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1681s/iter; left time: 5452.5180s
	iters: 300, epoch: 22 | loss: 1.3346245
	speed: 0.1472s/iter; left time: 4758.2029s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1430s/iter; left time: 4608.9927s
Epoch: 22 cost time: 64.57027220726013
Epoch: 22, Steps: 413 | Train Loss: 0.295 Vali Loss: 1.112 Vali Acc: 0.964 Test Loss: 1.112 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2231947
	speed: 0.3488s/iter; left time: 11200.2395s
	iters: 200, epoch: 23 | loss: 0.2474729
	speed: 0.1574s/iter; left time: 5038.6107s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1309s/iter; left time: 4177.6441s
	iters: 400, epoch: 23 | loss: 0.0000004
	speed: 0.1471s/iter; left time: 4680.0065s
Epoch: 23 cost time: 63.486700773239136
Epoch: 23, Steps: 413 | Train Loss: 0.341 Vali Loss: 0.858 Vali Acc: 0.964 Test Loss: 0.858 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0075672
	speed: 0.3663s/iter; left time: 11612.4110s
	iters: 200, epoch: 24 | loss: 0.0001012
	speed: 0.1661s/iter; left time: 5247.7901s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.1426s/iter; left time: 4491.5453s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.1465s/iter; left time: 4600.0311s
Epoch: 24 cost time: 67.31807136535645
Epoch: 24, Steps: 413 | Train Loss: 0.234 Vali Loss: 1.107 Vali Acc: 0.950 Test Loss: 1.107 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9718053660754888
model parameter : 815498
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1169984
	speed: 0.1575s/iter; left time: 6490.9436s
	iters: 200, epoch: 1 | loss: 1.1648514
	speed: 0.1331s/iter; left time: 5471.8322s
	iters: 300, epoch: 1 | loss: 0.0049434
	speed: 0.1592s/iter; left time: 6528.8565s
	iters: 400, epoch: 1 | loss: 0.0527939
	speed: 0.1459s/iter; left time: 5966.2347s
Epoch: 1 cost time: 61.42012143135071
Epoch: 1, Steps: 413 | Train Loss: 0.353 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (inf --> -0.966802).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0100021
	speed: 0.2820s/iter; left time: 11500.4886s
	iters: 200, epoch: 2 | loss: 0.0200386
	speed: 0.1573s/iter; left time: 6399.4230s
	iters: 300, epoch: 2 | loss: 0.1944202
	speed: 0.1430s/iter; left time: 5802.8313s
	iters: 400, epoch: 2 | loss: 0.0010426
	speed: 0.1279s/iter; left time: 5178.2081s
Epoch: 2 cost time: 58.000577449798584
Epoch: 2, Steps: 413 | Train Loss: 0.192 Vali Loss: 0.253 Vali Acc: 0.949 Test Loss: 0.253 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0001457
	speed: 0.2909s/iter; left time: 11743.4327s
	iters: 200, epoch: 3 | loss: 0.0001099
	speed: 0.1559s/iter; left time: 6279.4521s
	iters: 300, epoch: 3 | loss: 0.0000006
	speed: 0.1366s/iter; left time: 5487.9470s
	iters: 400, epoch: 3 | loss: 0.0000343
	speed: 0.1250s/iter; left time: 5009.5950s
Epoch: 3 cost time: 57.67903113365173
Epoch: 3, Steps: 413 | Train Loss: 0.217 Vali Loss: 0.560 Vali Acc: 0.950 Test Loss: 0.560 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5584010
	speed: 0.2926s/iter; left time: 11694.3994s
	iters: 200, epoch: 4 | loss: 0.6172103
	speed: 0.1436s/iter; left time: 5725.6938s
	iters: 300, epoch: 4 | loss: 0.0880629
	speed: 0.1205s/iter; left time: 4792.8877s
	iters: 400, epoch: 4 | loss: 0.0002497
	speed: 0.1526s/iter; left time: 6054.1628s
Epoch: 4 cost time: 58.634775161743164
Epoch: 4, Steps: 413 | Train Loss: 0.284 Vali Loss: 0.460 Vali Acc: 0.949 Test Loss: 0.460 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0000460
	speed: 0.3369s/iter; left time: 13324.8666s
	iters: 200, epoch: 5 | loss: 0.2510886
	speed: 0.1647s/iter; left time: 6495.8296s
	iters: 300, epoch: 5 | loss: 0.6277915
	speed: 0.1596s/iter; left time: 6279.4679s
	iters: 400, epoch: 5 | loss: 0.4114363
	speed: 0.1612s/iter; left time: 6327.0612s
Epoch: 5 cost time: 68.55422258377075
Epoch: 5, Steps: 413 | Train Loss: 0.230 Vali Loss: 0.658 Vali Acc: 0.952 Test Loss: 0.658 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000327
	speed: 0.3322s/iter; left time: 13000.6350s
	iters: 200, epoch: 6 | loss: 0.0482962
	speed: 0.1527s/iter; left time: 5959.0153s
	iters: 300, epoch: 6 | loss: 0.4972758
	speed: 0.1476s/iter; left time: 5745.3978s
	iters: 400, epoch: 6 | loss: 1.9922546
	speed: 0.1399s/iter; left time: 5431.3995s
Epoch: 6 cost time: 62.28187537193298
Epoch: 6, Steps: 413 | Train Loss: 0.331 Vali Loss: 0.457 Vali Acc: 0.965 Test Loss: 0.457 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0215262
	speed: 0.2847s/iter; left time: 11023.3048s
	iters: 200, epoch: 7 | loss: 0.0048163
	speed: 0.1609s/iter; left time: 6212.7289s
	iters: 300, epoch: 7 | loss: 0.0000002
	speed: 0.1404s/iter; left time: 5409.4832s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.1424s/iter; left time: 5470.4636s
Epoch: 7 cost time: 62.30481171607971
Epoch: 7, Steps: 413 | Train Loss: 0.350 Vali Loss: 1.255 Vali Acc: 0.942 Test Loss: 1.255 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000125
	speed: 0.2985s/iter; left time: 11436.4202s
	iters: 200, epoch: 8 | loss: 0.0466609
	speed: 0.1449s/iter; left time: 5537.3519s
	iters: 300, epoch: 8 | loss: 0.0002732
	speed: 0.1372s/iter; left time: 5230.5849s
	iters: 400, epoch: 8 | loss: 0.1490088
	speed: 0.1375s/iter; left time: 5224.4942s
Epoch: 8 cost time: 58.70094037055969
Epoch: 8, Steps: 413 | Train Loss: 0.358 Vali Loss: 0.447 Vali Acc: 0.971 Test Loss: 0.447 Test Acc: 0.971
Validation loss decreased (-0.966802 --> -0.970891).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2950s/iter; left time: 11180.4566s
	iters: 200, epoch: 9 | loss: 0.0983682
	speed: 0.1464s/iter; left time: 5533.2851s
	iters: 300, epoch: 9 | loss: 0.3640528
	speed: 0.1440s/iter; left time: 5427.9808s
	iters: 400, epoch: 9 | loss: 0.5531296
	speed: 0.1433s/iter; left time: 5386.3665s
Epoch: 9 cost time: 59.984013080596924
Epoch: 9, Steps: 413 | Train Loss: 0.283 Vali Loss: 0.651 Vali Acc: 0.966 Test Loss: 0.651 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0002212
	speed: 0.2847s/iter; left time: 10671.0341s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1416s/iter; left time: 5292.7885s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.1422s/iter; left time: 5302.4548s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1494s/iter; left time: 5555.2351s
Epoch: 10 cost time: 59.533923387527466
Epoch: 10, Steps: 413 | Train Loss: 0.389 Vali Loss: 0.828 Vali Acc: 0.967 Test Loss: 0.828 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0053897
	speed: 0.2971s/iter; left time: 11013.5237s
	iters: 200, epoch: 11 | loss: 1.6962845
	speed: 0.1394s/iter; left time: 5152.5337s
	iters: 300, epoch: 11 | loss: 0.0763578
	speed: 0.1458s/iter; left time: 5374.3946s
	iters: 400, epoch: 11 | loss: 0.0558900
	speed: 0.1399s/iter; left time: 5144.5353s
Epoch: 11 cost time: 59.01182985305786
Epoch: 11, Steps: 413 | Train Loss: 0.385 Vali Loss: 0.698 Vali Acc: 0.960 Test Loss: 0.698 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.0006797
	speed: 0.3116s/iter; left time: 11423.8433s
	iters: 200, epoch: 12 | loss: 0.0002285
	speed: 0.1479s/iter; left time: 5407.9536s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1605s/iter; left time: 5851.7442s
	iters: 400, epoch: 12 | loss: 0.0000272
	speed: 0.1597s/iter; left time: 5807.2697s
Epoch: 12 cost time: 65.10395884513855
Epoch: 12, Steps: 413 | Train Loss: 0.334 Vali Loss: 1.098 Vali Acc: 0.941 Test Loss: 1.098 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 2.1864014
	speed: 0.2940s/iter; left time: 10656.0089s
	iters: 200, epoch: 13 | loss: 0.0003006
	speed: 0.1375s/iter; left time: 4968.4472s
	iters: 300, epoch: 13 | loss: 0.9857810
	speed: 0.1358s/iter; left time: 4894.4674s
	iters: 400, epoch: 13 | loss: 3.0000212
	speed: 0.1313s/iter; left time: 4720.3923s
Epoch: 13 cost time: 55.588929653167725
Epoch: 13, Steps: 413 | Train Loss: 0.345 Vali Loss: 0.679 Vali Acc: 0.968 Test Loss: 0.679 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.2582131
	speed: 0.2819s/iter; left time: 10099.6423s
	iters: 200, epoch: 14 | loss: 0.1235278
	speed: 0.1266s/iter; left time: 4524.6269s
	iters: 300, epoch: 14 | loss: 0.9415879
	speed: 0.1343s/iter; left time: 4785.0028s
	iters: 400, epoch: 14 | loss: 2.6954660
	speed: 0.1263s/iter; left time: 4488.3173s
Epoch: 14 cost time: 53.38657832145691
Epoch: 14, Steps: 413 | Train Loss: 0.232 Vali Loss: 0.613 Vali Acc: 0.970 Test Loss: 0.613 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2844s/iter; left time: 10072.3723s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.1298s/iter; left time: 4584.8949s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1271s/iter; left time: 4476.6715s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.1284s/iter; left time: 4509.3051s
Epoch: 15 cost time: 54.0493369102478
Epoch: 15, Steps: 413 | Train Loss: 0.355 Vali Loss: 0.749 Vali Acc: 0.966 Test Loss: 0.749 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000004
	speed: 0.2555s/iter; left time: 8943.1457s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1044s/iter; left time: 3642.5231s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1082s/iter; left time: 3765.5380s
	iters: 400, epoch: 16 | loss: 2.4340398
	speed: 0.1044s/iter; left time: 3621.9661s
Epoch: 16 cost time: 44.29262351989746
Epoch: 16, Steps: 413 | Train Loss: 0.299 Vali Loss: 0.589 Vali Acc: 0.966 Test Loss: 0.589 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.2668s/iter; left time: 9227.9768s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1244s/iter; left time: 4290.6688s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1041s/iter; left time: 3580.2310s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1025s/iter; left time: 3515.9374s
Epoch: 17 cost time: 47.351534366607666
Epoch: 17, Steps: 413 | Train Loss: 0.201 Vali Loss: 0.656 Vali Acc: 0.963 Test Loss: 0.656 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.5468993
	speed: 0.2514s/iter; left time: 8594.4900s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1105s/iter; left time: 3764.2619s
	iters: 300, epoch: 18 | loss: 0.0000002
	speed: 0.1186s/iter; left time: 4028.9537s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1176s/iter; left time: 3984.4875s
Epoch: 18 cost time: 47.59347081184387
Epoch: 18, Steps: 413 | Train Loss: 0.186 Vali Loss: 0.576 Vali Acc: 0.970 Test Loss: 0.576 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9708958617553434
model parameter : 682634
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3161159
	speed: 0.1230s/iter; left time: 5068.2986s
	iters: 200, epoch: 1 | loss: 0.4905543
	speed: 0.0949s/iter; left time: 3898.5780s
	iters: 300, epoch: 1 | loss: 0.0007436
	speed: 0.0984s/iter; left time: 4033.2520s
	iters: 400, epoch: 1 | loss: 0.0568013
	speed: 0.1057s/iter; left time: 4323.2261s
Epoch: 1 cost time: 43.7392053604126
Epoch: 1, Steps: 413 | Train Loss: 0.351 Vali Loss: 0.198 Vali Acc: 0.960 Test Loss: 0.198 Test Acc: 0.960
Validation loss decreased (inf --> -0.959525).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2853598
	speed: 0.2116s/iter; left time: 8632.7373s
	iters: 200, epoch: 2 | loss: 0.0453320
	speed: 0.0919s/iter; left time: 3738.0992s
	iters: 300, epoch: 2 | loss: 0.0002548
	speed: 0.0936s/iter; left time: 3798.3673s
	iters: 400, epoch: 2 | loss: 0.4458164
	speed: 0.0899s/iter; left time: 3641.2101s
Epoch: 2 cost time: 36.826963901519775
Epoch: 2, Steps: 413 | Train Loss: 0.163 Vali Loss: 0.183 Vali Acc: 0.962 Test Loss: 0.183 Test Acc: 0.962
Validation loss decreased (-0.959525 --> -0.962254).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000010
	speed: 0.2342s/iter; left time: 9455.0198s
	iters: 200, epoch: 3 | loss: 0.0013222
	speed: 0.1003s/iter; left time: 4039.8520s
	iters: 300, epoch: 3 | loss: 0.3028431
	speed: 0.0933s/iter; left time: 3747.2725s
	iters: 400, epoch: 3 | loss: 0.0000083
	speed: 0.0865s/iter; left time: 3467.6463s
Epoch: 3 cost time: 39.498690605163574
Epoch: 3, Steps: 413 | Train Loss: 0.153 Vali Loss: 0.351 Vali Acc: 0.952 Test Loss: 0.351 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0060231
	speed: 0.2532s/iter; left time: 10116.6466s
	iters: 200, epoch: 4 | loss: 0.0000004
	speed: 0.0987s/iter; left time: 3936.0453s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.1023s/iter; left time: 4066.4771s
	iters: 400, epoch: 4 | loss: 1.2488282
	speed: 0.1091s/iter; left time: 4327.4728s
Epoch: 4 cost time: 45.11353397369385
Epoch: 4, Steps: 413 | Train Loss: 0.204 Vali Loss: 0.605 Vali Acc: 0.943 Test Loss: 0.605 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4402611
	speed: 0.2228s/iter; left time: 8810.2234s
	iters: 200, epoch: 5 | loss: 0.0296582
	speed: 0.0952s/iter; left time: 3756.5193s
	iters: 300, epoch: 5 | loss: 0.0009353
	speed: 0.1079s/iter; left time: 4247.2453s
	iters: 400, epoch: 5 | loss: 0.0000001
	speed: 0.1050s/iter; left time: 4122.4028s
Epoch: 5 cost time: 42.98627948760986
Epoch: 5, Steps: 413 | Train Loss: 0.253 Vali Loss: 0.338 Vali Acc: 0.954 Test Loss: 0.338 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0013097
	speed: 0.2455s/iter; left time: 9609.5828s
	iters: 200, epoch: 6 | loss: 0.0000003
	speed: 0.1091s/iter; left time: 4257.7778s
	iters: 300, epoch: 6 | loss: 0.9783407
	speed: 0.1152s/iter; left time: 4486.9173s
	iters: 400, epoch: 6 | loss: 0.0000822
	speed: 0.1037s/iter; left time: 4025.6705s
Epoch: 6 cost time: 44.934255838394165
Epoch: 6, Steps: 413 | Train Loss: 0.221 Vali Loss: 0.691 Vali Acc: 0.945 Test Loss: 0.691 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.5216432
	speed: 0.2643s/iter; left time: 10235.2300s
	iters: 200, epoch: 7 | loss: 0.0138872
	speed: 0.1316s/iter; left time: 5083.3415s
	iters: 300, epoch: 7 | loss: 0.0010424
	speed: 0.1406s/iter; left time: 5418.0606s
	iters: 400, epoch: 7 | loss: 1.0854682
	speed: 0.1475s/iter; left time: 5667.4124s
Epoch: 7 cost time: 56.67390322685242
Epoch: 7, Steps: 413 | Train Loss: 0.248 Vali Loss: 1.011 Vali Acc: 0.892 Test Loss: 1.011 Test Acc: 0.892
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2906s/iter; left time: 11132.4339s
	iters: 200, epoch: 8 | loss: 0.0432605
	speed: 0.1411s/iter; left time: 5390.5048s
	iters: 300, epoch: 8 | loss: 0.0051458
	speed: 0.1229s/iter; left time: 4685.1439s
	iters: 400, epoch: 8 | loss: 0.6880110
	speed: 0.1175s/iter; left time: 4466.4897s
Epoch: 8 cost time: 53.90480971336365
Epoch: 8, Steps: 413 | Train Loss: 0.232 Vali Loss: 0.648 Vali Acc: 0.962 Test Loss: 0.648 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000072
	speed: 0.3102s/iter; left time: 11755.6086s
	iters: 200, epoch: 9 | loss: 0.0024505
	speed: 0.2057s/iter; left time: 7774.9939s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.2074s/iter; left time: 7816.6503s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.2073s/iter; left time: 7794.6531s
Epoch: 9 cost time: 81.3578040599823
Epoch: 9, Steps: 413 | Train Loss: 0.310 Vali Loss: 0.801 Vali Acc: 0.946 Test Loss: 0.801 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0001018
	speed: 0.3921s/iter; left time: 14696.4867s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1973s/iter; left time: 7377.0100s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.1903s/iter; left time: 7096.4466s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1829s/iter; left time: 6800.8974s
Epoch: 10 cost time: 79.13431024551392
Epoch: 10, Steps: 413 | Train Loss: 0.238 Vali Loss: 0.563 Vali Acc: 0.971 Test Loss: 0.563 Test Acc: 0.971
Validation loss decreased (-0.962254 --> -0.970890).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0031931
	speed: 0.3872s/iter; left time: 14354.6087s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2037s/iter; left time: 7530.3105s
	iters: 300, epoch: 11 | loss: 0.0001398
	speed: 0.2164s/iter; left time: 7980.1228s
	iters: 400, epoch: 11 | loss: 0.0000012
	speed: 0.1517s/iter; left time: 5579.1818s
Epoch: 11 cost time: 77.8828980922699
Epoch: 11, Steps: 413 | Train Loss: 0.316 Vali Loss: 0.405 Vali Acc: 0.974 Test Loss: 0.405 Test Acc: 0.974
Validation loss decreased (-0.970890 --> -0.974075).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0009318
	speed: 0.3584s/iter; left time: 13137.3240s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.1870s/iter; left time: 6835.6884s
	iters: 300, epoch: 12 | loss: 0.0000019
	speed: 0.2080s/iter; left time: 7583.7319s
	iters: 400, epoch: 12 | loss: 0.0000079
	speed: 0.2090s/iter; left time: 7599.6102s
Epoch: 12 cost time: 83.35725831985474
Epoch: 12, Steps: 413 | Train Loss: 0.237 Vali Loss: 0.821 Vali Acc: 0.958 Test Loss: 0.821 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.4096s/iter; left time: 14847.1699s
	iters: 200, epoch: 13 | loss: 0.0012961
	speed: 0.1944s/iter; left time: 7026.5166s
	iters: 300, epoch: 13 | loss: 3.3614430
	speed: 0.1463s/iter; left time: 5271.9556s
	iters: 400, epoch: 13 | loss: 0.0000851
	speed: 0.1575s/iter; left time: 5660.6061s
Epoch: 13 cost time: 72.365483045578
Epoch: 13, Steps: 413 | Train Loss: 0.317 Vali Loss: 0.534 Vali Acc: 0.965 Test Loss: 0.534 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3794s/iter; left time: 13593.3384s
	iters: 200, epoch: 14 | loss: 1.5732120
	speed: 0.1928s/iter; left time: 6888.3422s
	iters: 300, epoch: 14 | loss: 1.4855938
	speed: 0.1809s/iter; left time: 6447.5498s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1790s/iter; left time: 6361.6019s
Epoch: 14 cost time: 77.67445468902588
Epoch: 14, Steps: 413 | Train Loss: 0.258 Vali Loss: 0.956 Vali Acc: 0.963 Test Loss: 0.956 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.8617050
	speed: 0.3511s/iter; left time: 12435.0982s
	iters: 200, epoch: 15 | loss: 0.0000434
	speed: 0.1353s/iter; left time: 4778.7673s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1662s/iter; left time: 5852.9426s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1654s/iter; left time: 5807.9516s
Epoch: 15 cost time: 67.14266109466553
Epoch: 15, Steps: 413 | Train Loss: 0.189 Vali Loss: 0.703 Vali Acc: 0.968 Test Loss: 0.703 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0015479
	speed: 0.3677s/iter; left time: 12871.5850s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1726s/iter; left time: 6024.3180s
	iters: 300, epoch: 16 | loss: 0.1127141
	speed: 0.1469s/iter; left time: 5113.3547s
	iters: 400, epoch: 16 | loss: 0.5444263
	speed: 0.1324s/iter; left time: 4595.1724s
Epoch: 16 cost time: 65.30534529685974
Epoch: 16, Steps: 413 | Train Loss: 0.193 Vali Loss: 0.596 Vali Acc: 0.968 Test Loss: 0.596 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0437957
	speed: 0.3531s/iter; left time: 12215.9655s
	iters: 200, epoch: 17 | loss: 0.0000104
	speed: 0.1719s/iter; left time: 5930.4798s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1665s/iter; left time: 5725.6937s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1806s/iter; left time: 6194.0224s
Epoch: 17 cost time: 71.5436806678772
Epoch: 17, Steps: 413 | Train Loss: 0.294 Vali Loss: 0.830 Vali Acc: 0.962 Test Loss: 0.830 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3560s/iter; left time: 12168.8373s
	iters: 200, epoch: 18 | loss: 0.0000009
	speed: 0.1111s/iter; left time: 3786.1346s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1299s/iter; left time: 4412.6275s
	iters: 400, epoch: 18 | loss: 0.0016424
	speed: 0.1504s/iter; left time: 5096.1597s
Epoch: 18 cost time: 58.502020597457886
Epoch: 18, Steps: 413 | Train Loss: 0.283 Vali Loss: 0.694 Vali Acc: 0.964 Test Loss: 0.694 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.3255s/iter; left time: 10991.2719s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1178s/iter; left time: 3965.1209s
	iters: 300, epoch: 19 | loss: 1.1563753
	speed: 0.1286s/iter; left time: 4318.2226s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1465s/iter; left time: 4901.6425s
Epoch: 19 cost time: 56.795162200927734
Epoch: 19, Steps: 413 | Train Loss: 0.253 Vali Loss: 0.758 Vali Acc: 0.958 Test Loss: 0.758 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.3095s/iter; left time: 10323.5557s
	iters: 200, epoch: 20 | loss: 0.0711106
	speed: 0.1220s/iter; left time: 4056.0323s
	iters: 300, epoch: 20 | loss: 0.0000050
	speed: 0.1059s/iter; left time: 3509.7665s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.1851s/iter; left time: 6117.8937s
Epoch: 20 cost time: 59.021857261657715
Epoch: 20, Steps: 413 | Train Loss: 0.195 Vali Loss: 0.676 Vali Acc: 0.970 Test Loss: 0.676 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.4164399
	speed: 0.3419s/iter; left time: 11261.3575s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.1625s/iter; left time: 5336.5768s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1814s/iter; left time: 5939.5960s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1719s/iter; left time: 5612.3734s
Epoch: 21 cost time: 69.71971940994263
Epoch: 21, Steps: 413 | Train Loss: 0.211 Vali Loss: 1.028 Vali Acc: 0.948 Test Loss: 1.028 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9740791268758526
model parameter : 599818
model size : 4.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1044511
	speed: 0.1831s/iter; left time: 7541.8753s
	iters: 200, epoch: 1 | loss: 0.1978731
	speed: 0.1567s/iter; left time: 6438.7334s
	iters: 300, epoch: 1 | loss: 0.0036362
	speed: 0.1611s/iter; left time: 6604.9911s
	iters: 400, epoch: 1 | loss: 0.0004249
	speed: 0.1674s/iter; left time: 6847.6632s
Epoch: 1 cost time: 68.4893159866333
Epoch: 1, Steps: 413 | Train Loss: 0.328 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (inf --> -0.956342).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2137352
	speed: 0.2274s/iter; left time: 9274.4845s
	iters: 200, epoch: 2 | loss: 0.0151143
	speed: 0.1524s/iter; left time: 6199.8262s
	iters: 300, epoch: 2 | loss: 0.0014411
	speed: 0.1711s/iter; left time: 6944.8900s
	iters: 400, epoch: 2 | loss: 0.0729594
	speed: 0.1704s/iter; left time: 6899.2170s
Epoch: 2 cost time: 60.66029667854309
Epoch: 2, Steps: 413 | Train Loss: 0.142 Vali Loss: 0.177 Vali Acc: 0.960 Test Loss: 0.177 Test Acc: 0.960
Validation loss decreased (-0.956342 --> -0.959980).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0012164
	speed: 0.3195s/iter; left time: 12901.2785s
	iters: 200, epoch: 3 | loss: 0.8646317
	speed: 0.1707s/iter; left time: 6874.7600s
	iters: 300, epoch: 3 | loss: 0.0000895
	speed: 0.1520s/iter; left time: 6105.2588s
	iters: 400, epoch: 3 | loss: 0.4104472
	speed: 0.1240s/iter; left time: 4970.1815s
Epoch: 3 cost time: 63.89292335510254
Epoch: 3, Steps: 413 | Train Loss: 0.151 Vali Loss: 0.569 Vali Acc: 0.940 Test Loss: 0.569 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000317
	speed: 0.3113s/iter; left time: 12439.1654s
	iters: 200, epoch: 4 | loss: 0.0004768
	speed: 0.1606s/iter; left time: 6403.2244s
	iters: 300, epoch: 4 | loss: 0.0000001
	speed: 0.1499s/iter; left time: 5958.4697s
	iters: 400, epoch: 4 | loss: 0.3370880
	speed: 0.1481s/iter; left time: 5875.6679s
Epoch: 4 cost time: 63.59695625305176
Epoch: 4, Steps: 413 | Train Loss: 0.183 Vali Loss: 0.383 Vali Acc: 0.962 Test Loss: 0.383 Test Acc: 0.962
Validation loss decreased (-0.959980 --> -0.961797).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0001113
	speed: 0.2428s/iter; left time: 9604.0589s
	iters: 200, epoch: 5 | loss: 0.0000005
	speed: 0.1091s/iter; left time: 4301.9300s
	iters: 300, epoch: 5 | loss: 0.8147072
	speed: 0.1195s/iter; left time: 4700.8869s
	iters: 400, epoch: 5 | loss: 0.0026296
	speed: 0.1211s/iter; left time: 4754.3870s
Epoch: 5 cost time: 45.67231345176697
Epoch: 5, Steps: 413 | Train Loss: 0.168 Vali Loss: 0.499 Vali Acc: 0.950 Test Loss: 0.499 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0013832
	speed: 0.2741s/iter; left time: 10728.5654s
	iters: 200, epoch: 6 | loss: 0.0002969
	speed: 0.1434s/iter; left time: 5596.0820s
	iters: 300, epoch: 6 | loss: 0.9633253
	speed: 0.1154s/iter; left time: 4492.8500s
	iters: 400, epoch: 6 | loss: 0.1483990
	speed: 0.1220s/iter; left time: 4738.0813s
Epoch: 6 cost time: 54.19720673561096
Epoch: 6, Steps: 413 | Train Loss: 0.175 Vali Loss: 0.292 Vali Acc: 0.965 Test Loss: 0.292 Test Acc: 0.965
Validation loss decreased (-0.961797 --> -0.964981).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2838s/iter; left time: 10989.7154s
	iters: 200, epoch: 7 | loss: 0.4965465
	speed: 0.1309s/iter; left time: 5055.7148s
	iters: 300, epoch: 7 | loss: 0.9836171
	speed: 0.1256s/iter; left time: 4837.8949s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.1378s/iter; left time: 5294.3792s
Epoch: 7 cost time: 55.096373319625854
Epoch: 7, Steps: 413 | Train Loss: 0.209 Vali Loss: 0.310 Vali Acc: 0.969 Test Loss: 0.310 Test Acc: 0.969
Validation loss decreased (-0.964981 --> -0.969074).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2382498
	speed: 0.2695s/iter; left time: 10324.6373s
	iters: 200, epoch: 8 | loss: 0.0000958
	speed: 0.1148s/iter; left time: 4387.2539s
	iters: 300, epoch: 8 | loss: 0.2246123
	speed: 0.1343s/iter; left time: 5116.3517s
	iters: 400, epoch: 8 | loss: 0.2877540
	speed: 0.1394s/iter; left time: 5296.7608s
Epoch: 8 cost time: 53.557708740234375
Epoch: 8, Steps: 413 | Train Loss: 0.238 Vali Loss: 0.566 Vali Acc: 0.950 Test Loss: 0.566 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000513
	speed: 0.2689s/iter; left time: 10192.2529s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.1206s/iter; left time: 4556.8911s
	iters: 300, epoch: 9 | loss: 0.6137497
	speed: 0.1254s/iter; left time: 4728.8468s
	iters: 400, epoch: 9 | loss: 0.0922479
	speed: 0.1456s/iter; left time: 5472.7343s
Epoch: 9 cost time: 54.420868158340454
Epoch: 9, Steps: 413 | Train Loss: 0.210 Vali Loss: 0.563 Vali Acc: 0.953 Test Loss: 0.563 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2847s/iter; left time: 10672.3456s
	iters: 200, epoch: 10 | loss: 0.5588599
	speed: 0.1321s/iter; left time: 4940.1482s
	iters: 300, epoch: 10 | loss: 0.3087911
	speed: 0.1189s/iter; left time: 4434.2250s
	iters: 400, epoch: 10 | loss: 2.1524789
	speed: 0.1713s/iter; left time: 6370.5024s
Epoch: 10 cost time: 58.95541286468506
Epoch: 10, Steps: 413 | Train Loss: 0.275 Vali Loss: 0.552 Vali Acc: 0.960 Test Loss: 0.552 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0076080
	speed: 0.3942s/iter; left time: 14613.4644s
	iters: 200, epoch: 11 | loss: 0.6186672
	speed: 0.2010s/iter; left time: 7433.0056s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1963s/iter; left time: 7236.4551s
	iters: 400, epoch: 11 | loss: 0.4779366
	speed: 0.1669s/iter; left time: 6137.2328s
Epoch: 11 cost time: 80.60463976860046
Epoch: 11, Steps: 413 | Train Loss: 0.252 Vali Loss: 0.389 Vali Acc: 0.972 Test Loss: 0.389 Test Acc: 0.972
Validation loss decreased (-0.969074 --> -0.971801).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0031902
	speed: 0.3615s/iter; left time: 13252.1774s
	iters: 200, epoch: 12 | loss: 0.7562362
	speed: 0.1940s/iter; left time: 7093.4895s
	iters: 300, epoch: 12 | loss: 0.0406584
	speed: 0.1940s/iter; left time: 7074.0564s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.2023s/iter; left time: 7356.5004s
Epoch: 12 cost time: 81.38559627532959
Epoch: 12, Steps: 413 | Train Loss: 0.317 Vali Loss: 0.377 Vali Acc: 0.968 Test Loss: 0.377 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9496732
	speed: 0.4000s/iter; left time: 14498.2761s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2093s/iter; left time: 7564.7650s
	iters: 300, epoch: 13 | loss: 0.0001835
	speed: 0.1928s/iter; left time: 6951.0937s
	iters: 400, epoch: 13 | loss: 0.0059833
	speed: 0.1983s/iter; left time: 7127.5628s
Epoch: 13 cost time: 84.20747303962708
Epoch: 13, Steps: 413 | Train Loss: 0.385 Vali Loss: 0.659 Vali Acc: 0.950 Test Loss: 0.659 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7783513
	speed: 0.3247s/iter; left time: 11632.8661s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1988s/iter; left time: 7102.5313s
	iters: 300, epoch: 14 | loss: 0.0004324
	speed: 0.1815s/iter; left time: 6468.9593s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1859s/iter; left time: 6605.4360s
Epoch: 14 cost time: 76.63179755210876
Epoch: 14, Steps: 413 | Train Loss: 0.285 Vali Loss: 0.699 Vali Acc: 0.954 Test Loss: 0.699 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3640s/iter; left time: 12893.6980s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.1981s/iter; left time: 6995.3331s
	iters: 300, epoch: 15 | loss: 0.0001436
	speed: 0.2006s/iter; left time: 7066.6140s
	iters: 400, epoch: 15 | loss: 0.9109099
	speed: 0.1448s/iter; left time: 5083.7437s
Epoch: 15 cost time: 75.75605726242065
Epoch: 15, Steps: 413 | Train Loss: 0.293 Vali Loss: 0.737 Vali Acc: 0.941 Test Loss: 0.737 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000016
	speed: 0.3165s/iter; left time: 11080.8242s
	iters: 200, epoch: 16 | loss: 0.0001938
	speed: 0.1739s/iter; left time: 6069.1218s
	iters: 300, epoch: 16 | loss: 0.1197713
	speed: 0.1596s/iter; left time: 5555.3321s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1709s/iter; left time: 5932.9121s
Epoch: 16 cost time: 70.67211866378784
Epoch: 16, Steps: 413 | Train Loss: 0.254 Vali Loss: 0.345 Vali Acc: 0.976 Test Loss: 0.345 Test Acc: 0.976
Validation loss decreased (-0.971801 --> -0.976349).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000370
	speed: 0.3002s/iter; left time: 10386.1649s
	iters: 200, epoch: 17 | loss: 1.4436033
	speed: 0.1008s/iter; left time: 3477.0313s
	iters: 300, epoch: 17 | loss: 0.0000494
	speed: 0.1378s/iter; left time: 4740.1460s
	iters: 400, epoch: 17 | loss: 0.0000255
	speed: 0.1602s/iter; left time: 5493.1063s
Epoch: 17 cost time: 55.6910400390625
Epoch: 17, Steps: 413 | Train Loss: 0.245 Vali Loss: 0.574 Vali Acc: 0.955 Test Loss: 0.574 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1290464
	speed: 0.2907s/iter; left time: 9935.1478s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1370s/iter; left time: 4670.3363s
	iters: 300, epoch: 18 | loss: 0.0007880
	speed: 0.1260s/iter; left time: 4282.0494s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1416s/iter; left time: 4798.5038s
Epoch: 18 cost time: 57.24497842788696
Epoch: 18, Steps: 413 | Train Loss: 0.205 Vali Loss: 0.832 Vali Acc: 0.940 Test Loss: 0.832 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.3158s/iter; left time: 10662.2768s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1109s/iter; left time: 3732.8549s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1301s/iter; left time: 4368.7126s
	iters: 400, epoch: 19 | loss: 1.7920309
	speed: 0.1268s/iter; left time: 4242.6053s
Epoch: 19 cost time: 54.15846562385559
Epoch: 19, Steps: 413 | Train Loss: 0.217 Vali Loss: 0.448 Vali Acc: 0.968 Test Loss: 0.448 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.5600550
	speed: 0.2988s/iter; left time: 9965.5025s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1436s/iter; left time: 4776.1140s
	iters: 300, epoch: 20 | loss: 1.1096830
	speed: 0.1472s/iter; left time: 4878.9739s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0977s/iter; left time: 3230.2289s
Epoch: 20 cost time: 55.173163175582886
Epoch: 20, Steps: 413 | Train Loss: 0.191 Vali Loss: 0.662 Vali Acc: 0.960 Test Loss: 0.662 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000396
	speed: 0.2577s/iter; left time: 8489.3950s
	iters: 200, epoch: 21 | loss: 0.5664235
	speed: 0.1244s/iter; left time: 4086.6888s
	iters: 300, epoch: 21 | loss: 0.8897578
	speed: 0.1370s/iter; left time: 4485.7599s
	iters: 400, epoch: 21 | loss: 0.0000113
	speed: 0.1379s/iter; left time: 4499.8532s
Epoch: 21 cost time: 56.13432955741882
Epoch: 21, Steps: 413 | Train Loss: 0.225 Vali Loss: 0.789 Vali Acc: 0.946 Test Loss: 0.789 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.6897404
	speed: 0.2648s/iter; left time: 8613.2631s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0976s/iter; left time: 3164.4273s
	iters: 300, epoch: 22 | loss: 0.0000090
	speed: 0.1041s/iter; left time: 3363.9412s
	iters: 400, epoch: 22 | loss: 0.1709266
	speed: 0.1177s/iter; left time: 3792.4266s
Epoch: 22 cost time: 45.51317620277405
Epoch: 22, Steps: 413 | Train Loss: 0.270 Vali Loss: 0.686 Vali Acc: 0.954 Test Loss: 0.686 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.3980792
	speed: 0.2414s/iter; left time: 7751.5384s
	iters: 200, epoch: 23 | loss: 0.3702003
	speed: 0.1178s/iter; left time: 3772.5206s
	iters: 300, epoch: 23 | loss: 0.0067149
	speed: 0.1294s/iter; left time: 4130.3054s
	iters: 400, epoch: 23 | loss: 0.0397106
	speed: 0.1018s/iter; left time: 3237.2055s
Epoch: 23 cost time: 45.935489892959595
Epoch: 23, Steps: 413 | Train Loss: 0.262 Vali Loss: 0.500 Vali Acc: 0.967 Test Loss: 0.500 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.5194122
	speed: 0.3087s/iter; left time: 9786.3132s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.1619s/iter; left time: 5115.8954s
	iters: 300, epoch: 24 | loss: 0.8568546
	speed: 0.1670s/iter; left time: 5260.4688s
	iters: 400, epoch: 24 | loss: 0.0000005
	speed: 0.1582s/iter; left time: 4967.7011s
Epoch: 24 cost time: 68.61163640022278
Epoch: 24, Steps: 413 | Train Loss: 0.196 Vali Loss: 0.388 Vali Acc: 0.969 Test Loss: 0.388 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000476
	speed: 0.3268s/iter; left time: 10226.4343s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.1547s/iter; left time: 4825.7109s
	iters: 300, epoch: 25 | loss: 0.8513704
	speed: 0.1388s/iter; left time: 4314.4890s
	iters: 400, epoch: 25 | loss: 0.0019260
	speed: 0.1506s/iter; left time: 4667.9839s
Epoch: 25 cost time: 63.33648705482483
Epoch: 25, Steps: 413 | Train Loss: 0.147 Vali Loss: 0.341 Vali Acc: 0.973 Test Loss: 0.341 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.7775015
	speed: 0.2988s/iter; left time: 9225.6604s
	iters: 200, epoch: 26 | loss: 0.0000365
	speed: 0.1340s/iter; left time: 4124.2546s
	iters: 300, epoch: 26 | loss: 0.1360885
	speed: 0.0829s/iter; left time: 2544.0430s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0993s/iter; left time: 3035.0211s
Epoch: 26 cost time: 48.24454975128174
Epoch: 26, Steps: 413 | Train Loss: 0.177 Vali Loss: 0.526 Vali Acc: 0.960 Test Loss: 0.526 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 517130
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2810006
	speed: 0.1838s/iter; left time: 7574.6893s
	iters: 200, epoch: 1 | loss: 0.0474959
	speed: 0.1539s/iter; left time: 6323.9597s
	iters: 300, epoch: 1 | loss: 0.1389577
	speed: 0.1448s/iter; left time: 5935.0509s
	iters: 400, epoch: 1 | loss: 0.5145821
	speed: 0.1448s/iter; left time: 5923.1495s
Epoch: 1 cost time: 64.67328333854675
Epoch: 1, Steps: 413 | Train Loss: 0.340 Vali Loss: 0.148 Vali Acc: 0.956 Test Loss: 0.148 Test Acc: 0.956
Validation loss decreased (inf --> -0.956342).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0523627
	speed: 0.2932s/iter; left time: 11958.0296s
	iters: 200, epoch: 2 | loss: 0.5970549
	speed: 0.1106s/iter; left time: 4499.7507s
	iters: 300, epoch: 2 | loss: 0.0009501
	speed: 0.1101s/iter; left time: 4468.3912s
	iters: 400, epoch: 2 | loss: 0.0297034
	speed: 0.1373s/iter; left time: 5560.8175s
Epoch: 2 cost time: 53.52809238433838
Epoch: 2, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.956342 --> -0.964983).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0017758
	speed: 0.2858s/iter; left time: 11540.4165s
	iters: 200, epoch: 3 | loss: 0.0037817
	speed: 0.1614s/iter; left time: 6500.3699s
	iters: 300, epoch: 3 | loss: 0.2691970
	speed: 0.1704s/iter; left time: 6844.3111s
	iters: 400, epoch: 3 | loss: 0.1175885
	speed: 0.1501s/iter; left time: 6016.7806s
Epoch: 3 cost time: 65.58730506896973
Epoch: 3, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.228 Vali Acc: 0.962 Test Loss: 0.228 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8670186
	speed: 0.2756s/iter; left time: 11011.6273s
	iters: 200, epoch: 4 | loss: 0.0000030
	speed: 0.1653s/iter; left time: 6587.6494s
	iters: 300, epoch: 4 | loss: 0.0000198
	speed: 0.1555s/iter; left time: 6183.2389s
	iters: 400, epoch: 4 | loss: 0.0000006
	speed: 0.1625s/iter; left time: 6444.8910s
Epoch: 4 cost time: 64.59814739227295
Epoch: 4, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
Validation loss decreased (-0.964983 --> -0.971804).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3942115
	speed: 0.2808s/iter; left time: 11106.2553s
	iters: 200, epoch: 5 | loss: 0.0001750
	speed: 0.1497s/iter; left time: 5907.2181s
	iters: 300, epoch: 5 | loss: 0.0000022
	speed: 0.1446s/iter; left time: 5689.8032s
	iters: 400, epoch: 5 | loss: 1.1494416
	speed: 0.1391s/iter; left time: 5459.5197s
Epoch: 5 cost time: 59.332510232925415
Epoch: 5, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.262 Vali Acc: 0.960 Test Loss: 0.262 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000226
	speed: 0.2468s/iter; left time: 9658.8955s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.1420s/iter; left time: 5544.8638s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.1284s/iter; left time: 5000.6294s
	iters: 400, epoch: 6 | loss: 0.0000003
	speed: 0.1347s/iter; left time: 5229.6160s
Epoch: 6 cost time: 54.8345582485199
Epoch: 6, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.483 Vali Acc: 0.940 Test Loss: 0.483 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000140
	speed: 0.2349s/iter; left time: 9094.6079s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.1118s/iter; left time: 4317.2156s
	iters: 300, epoch: 7 | loss: 0.0185682
	speed: 0.1305s/iter; left time: 5025.9826s
	iters: 400, epoch: 7 | loss: 0.0002450
	speed: 0.1281s/iter; left time: 4920.5576s
Epoch: 7 cost time: 49.56936025619507
Epoch: 7, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.571 Vali Acc: 0.947 Test Loss: 0.571 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0499800
	speed: 0.2537s/iter; left time: 9719.8057s
	iters: 200, epoch: 8 | loss: 0.5712735
	speed: 0.1255s/iter; left time: 4795.5985s
	iters: 300, epoch: 8 | loss: 0.9909193
	speed: 0.1484s/iter; left time: 5654.8127s
	iters: 400, epoch: 8 | loss: 0.6359461
	speed: 0.1520s/iter; left time: 5778.7526s
Epoch: 8 cost time: 57.64188194274902
Epoch: 8, Steps: 413 | Train Loss: 0.218 Vali Loss: 0.288 Vali Acc: 0.964 Test Loss: 0.288 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.7200926
	speed: 0.2800s/iter; left time: 10610.4926s
	iters: 200, epoch: 9 | loss: 0.0033583
	speed: 0.1124s/iter; left time: 4248.7971s
	iters: 300, epoch: 9 | loss: 0.0000003
	speed: 0.1431s/iter; left time: 5394.0607s
	iters: 400, epoch: 9 | loss: 0.0140311
	speed: 0.1841s/iter; left time: 6921.5418s
Epoch: 9 cost time: 60.85326790809631
Epoch: 9, Steps: 413 | Train Loss: 0.203 Vali Loss: 0.377 Vali Acc: 0.958 Test Loss: 0.377 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000761
	speed: 0.3190s/iter; left time: 11958.2638s
	iters: 200, epoch: 10 | loss: 0.0028260
	speed: 0.1598s/iter; left time: 5973.3227s
	iters: 300, epoch: 10 | loss: 0.0005172
	speed: 0.1767s/iter; left time: 6589.0550s
	iters: 400, epoch: 10 | loss: 0.2390264
	speed: 0.1673s/iter; left time: 6219.7831s
Epoch: 10 cost time: 69.83668541908264
Epoch: 10, Steps: 413 | Train Loss: 0.226 Vali Loss: 0.467 Vali Acc: 0.944 Test Loss: 0.467 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0062490
	speed: 0.2996s/iter; left time: 11106.1038s
	iters: 200, epoch: 11 | loss: 0.1053174
	speed: 0.1675s/iter; left time: 6191.4614s
	iters: 300, epoch: 11 | loss: 0.1371550
	speed: 0.1667s/iter; left time: 6147.1358s
	iters: 400, epoch: 11 | loss: 0.0000059
	speed: 0.1685s/iter; left time: 6195.8694s
Epoch: 11 cost time: 68.96187424659729
Epoch: 11, Steps: 413 | Train Loss: 0.255 Vali Loss: 0.431 Vali Acc: 0.962 Test Loss: 0.431 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1347890
	speed: 0.3073s/iter; left time: 11266.7075s
	iters: 200, epoch: 12 | loss: 0.0044715
	speed: 0.1058s/iter; left time: 3867.1547s
	iters: 300, epoch: 12 | loss: 0.0000034
	speed: 0.1214s/iter; left time: 4426.3932s
	iters: 400, epoch: 12 | loss: 0.0001016
	speed: 0.1389s/iter; left time: 5048.5533s
Epoch: 12 cost time: 54.26539182662964
Epoch: 12, Steps: 413 | Train Loss: 0.211 Vali Loss: 0.375 Vali Acc: 0.965 Test Loss: 0.375 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2905s/iter; left time: 10527.4501s
	iters: 200, epoch: 13 | loss: 0.0864586
	speed: 0.1375s/iter; left time: 4968.6363s
	iters: 300, epoch: 13 | loss: 0.9441187
	speed: 0.1291s/iter; left time: 4654.8553s
	iters: 400, epoch: 13 | loss: 2.7461634
	speed: 0.1309s/iter; left time: 4706.9644s
Epoch: 13 cost time: 56.57186484336853
Epoch: 13, Steps: 413 | Train Loss: 0.266 Vali Loss: 0.474 Vali Acc: 0.952 Test Loss: 0.474 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2094s/iter; left time: 7502.4709s
	iters: 200, epoch: 14 | loss: 0.6503136
	speed: 0.0978s/iter; left time: 3492.8258s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1296s/iter; left time: 4617.5600s
	iters: 400, epoch: 14 | loss: 0.0000028
	speed: 0.1231s/iter; left time: 4373.5198s
Epoch: 14 cost time: 45.49181628227234
Epoch: 14, Steps: 413 | Train Loss: 0.208 Vali Loss: 0.294 Vali Acc: 0.967 Test Loss: 0.294 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9718053660754888
model parameter : 451210
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4000123
	speed: 0.1190s/iter; left time: 4904.9041s
	iters: 200, epoch: 1 | loss: 0.2203620
	speed: 0.0787s/iter; left time: 3235.3489s
	iters: 300, epoch: 1 | loss: 0.4168594
	speed: 0.0839s/iter; left time: 3441.7752s
	iters: 400, epoch: 1 | loss: 0.4595615
	speed: 0.1184s/iter; left time: 4842.3387s
Epoch: 1 cost time: 41.82774877548218
Epoch: 1, Steps: 413 | Train Loss: 0.348 Vali Loss: 0.091 Vali Acc: 0.967 Test Loss: 0.091 Test Acc: 0.967
Validation loss decreased (inf --> -0.966802).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3285440
	speed: 0.2316s/iter; left time: 9447.1884s
	iters: 200, epoch: 2 | loss: 0.2489781
	speed: 0.1084s/iter; left time: 4412.2141s
	iters: 300, epoch: 2 | loss: 0.2629723
	speed: 0.0957s/iter; left time: 3884.2649s
	iters: 400, epoch: 2 | loss: 0.0233039
	speed: 0.0836s/iter; left time: 3386.3679s
Epoch: 2 cost time: 40.17083954811096
Epoch: 2, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.173 Vali Acc: 0.955 Test Loss: 0.173 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0001936
	speed: 0.2106s/iter; left time: 8503.1758s
	iters: 200, epoch: 3 | loss: 0.0119736
	speed: 0.0973s/iter; left time: 3917.5680s
	iters: 300, epoch: 3 | loss: 0.2387073
	speed: 0.1019s/iter; left time: 4095.1758s
	iters: 400, epoch: 3 | loss: 0.0166221
	speed: 0.0921s/iter; left time: 3691.9994s
Epoch: 3 cost time: 41.16529369354248
Epoch: 3, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.198 Vali Acc: 0.959 Test Loss: 0.198 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4368338
	speed: 0.2072s/iter; left time: 8278.7545s
	iters: 200, epoch: 4 | loss: 0.0182894
	speed: 0.0724s/iter; left time: 2885.5072s
	iters: 300, epoch: 4 | loss: 0.0033577
	speed: 0.0783s/iter; left time: 3115.1442s
	iters: 400, epoch: 4 | loss: 0.0020639
	speed: 0.0969s/iter; left time: 3844.4184s
Epoch: 4 cost time: 33.93874478340149
Epoch: 4, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.323 Vali Acc: 0.935 Test Loss: 0.323 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.1188637
	speed: 0.2192s/iter; left time: 8669.9679s
	iters: 200, epoch: 5 | loss: 0.0417455
	speed: 0.0951s/iter; left time: 3752.1084s
	iters: 300, epoch: 5 | loss: 0.0251695
	speed: 0.0767s/iter; left time: 3020.0078s
	iters: 400, epoch: 5 | loss: 0.0000121
	speed: 0.0658s/iter; left time: 2584.2978s
Epoch: 5 cost time: 34.3541624546051
Epoch: 5, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
Validation loss decreased (-0.966802 --> -0.967711).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000034
	speed: 0.2033s/iter; left time: 7954.7931s
	iters: 200, epoch: 6 | loss: 0.0350847
	speed: 0.0907s/iter; left time: 3538.7120s
	iters: 300, epoch: 6 | loss: 0.3250057
	speed: 0.0953s/iter; left time: 3710.9994s
	iters: 400, epoch: 6 | loss: 0.3190725
	speed: 0.0924s/iter; left time: 3588.0059s
Epoch: 6 cost time: 39.00213003158569
Epoch: 6, Steps: 413 | Train Loss: 0.147 Vali Loss: 0.572 Vali Acc: 0.922 Test Loss: 0.572 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5128620
	speed: 0.2056s/iter; left time: 7960.9464s
	iters: 200, epoch: 7 | loss: 0.0000028
	speed: 0.0720s/iter; left time: 2782.0294s
	iters: 300, epoch: 7 | loss: 0.0789360
	speed: 0.1048s/iter; left time: 4035.4493s
	iters: 400, epoch: 7 | loss: 0.5673882
	speed: 0.1245s/iter; left time: 4783.7416s
Epoch: 7 cost time: 39.83995771408081
Epoch: 7, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.326 Vali Acc: 0.970 Test Loss: 0.326 Test Acc: 0.970
Validation loss decreased (-0.967711 --> -0.969528).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.2807s/iter; left time: 10751.7748s
	iters: 200, epoch: 8 | loss: 0.0000013
	speed: 0.1398s/iter; left time: 5342.5262s
	iters: 300, epoch: 8 | loss: 0.2671100
	speed: 0.1300s/iter; left time: 4953.2027s
	iters: 400, epoch: 8 | loss: 0.3961110
	speed: 0.1365s/iter; left time: 5189.3344s
Epoch: 8 cost time: 58.17984104156494
Epoch: 8, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.287 Vali Acc: 0.970 Test Loss: 0.287 Test Acc: 0.970
Validation loss decreased (-0.969528 --> -0.969529).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6899279
	speed: 0.2934s/iter; left time: 11120.2455s
	iters: 200, epoch: 9 | loss: 0.0000052
	speed: 0.1596s/iter; left time: 6033.7367s
	iters: 300, epoch: 9 | loss: 0.0872817
	speed: 0.1578s/iter; left time: 5947.8690s
	iters: 400, epoch: 9 | loss: 0.0000055
	speed: 0.1605s/iter; left time: 6035.8582s
Epoch: 9 cost time: 65.60790610313416
Epoch: 9, Steps: 413 | Train Loss: 0.174 Vali Loss: 0.386 Vali Acc: 0.953 Test Loss: 0.386 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2845s/iter; left time: 10662.5857s
	iters: 200, epoch: 10 | loss: 0.0645076
	speed: 0.1473s/iter; left time: 5507.6746s
	iters: 300, epoch: 10 | loss: 0.0000072
	speed: 0.1304s/iter; left time: 4863.6652s
	iters: 400, epoch: 10 | loss: 0.1420267
	speed: 0.1111s/iter; left time: 4130.9454s
Epoch: 10 cost time: 56.61355972290039
Epoch: 10, Steps: 413 | Train Loss: 0.216 Vali Loss: 0.541 Vali Acc: 0.941 Test Loss: 0.541 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.6407844
	speed: 0.2714s/iter; left time: 10060.1166s
	iters: 200, epoch: 11 | loss: 1.0822474
	speed: 0.1353s/iter; left time: 5001.5539s
	iters: 300, epoch: 11 | loss: 0.0601134
	speed: 0.1402s/iter; left time: 5167.5280s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1316s/iter; left time: 4839.0282s
Epoch: 11 cost time: 56.38599491119385
Epoch: 11, Steps: 413 | Train Loss: 0.199 Vali Loss: 0.272 Vali Acc: 0.974 Test Loss: 0.272 Test Acc: 0.974
Validation loss decreased (-0.969529 --> -0.973622).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0006688
	speed: 0.2581s/iter; left time: 9461.1096s
	iters: 200, epoch: 12 | loss: 0.0000015
	speed: 0.1016s/iter; left time: 3715.5366s
	iters: 300, epoch: 12 | loss: 0.0000784
	speed: 0.0923s/iter; left time: 3366.3646s
	iters: 400, epoch: 12 | loss: 0.0480738
	speed: 0.1337s/iter; left time: 4862.0518s
Epoch: 12 cost time: 48.2209689617157
Epoch: 12, Steps: 413 | Train Loss: 0.157 Vali Loss: 0.342 Vali Acc: 0.967 Test Loss: 0.342 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6550718
	speed: 0.2627s/iter; left time: 9520.4307s
	iters: 200, epoch: 13 | loss: 0.0000006
	speed: 0.1376s/iter; left time: 4973.9782s
	iters: 300, epoch: 13 | loss: 0.0000073
	speed: 0.1418s/iter; left time: 5111.0810s
	iters: 400, epoch: 13 | loss: 0.5344002
	speed: 0.1406s/iter; left time: 5052.3541s
Epoch: 13 cost time: 58.127012729644775
Epoch: 13, Steps: 413 | Train Loss: 0.199 Vali Loss: 0.314 Vali Acc: 0.970 Test Loss: 0.314 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.8280278
	speed: 0.2608s/iter; left time: 9345.6425s
	iters: 200, epoch: 14 | loss: 0.2583851
	speed: 0.1388s/iter; left time: 4959.9025s
	iters: 300, epoch: 14 | loss: 0.0001783
	speed: 0.1358s/iter; left time: 4839.4668s
	iters: 400, epoch: 14 | loss: 0.0766108
	speed: 0.1356s/iter; left time: 4819.3886s
Epoch: 14 cost time: 55.814152002334595
Epoch: 14, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.397 Vali Acc: 0.962 Test Loss: 0.397 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.1503278
	speed: 0.2387s/iter; left time: 8453.8798s
	iters: 200, epoch: 15 | loss: 0.0000044
	speed: 0.1005s/iter; left time: 3550.9159s
	iters: 300, epoch: 15 | loss: 0.0032086
	speed: 0.1268s/iter; left time: 4467.0190s
	iters: 400, epoch: 15 | loss: 0.0000089
	speed: 0.1434s/iter; left time: 5037.5192s
Epoch: 15 cost time: 50.54946851730347
Epoch: 15, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.546 Vali Acc: 0.938 Test Loss: 0.546 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000554
	speed: 0.2719s/iter; left time: 9519.5720s
	iters: 200, epoch: 16 | loss: 0.0000221
	speed: 0.1354s/iter; left time: 4727.1793s
	iters: 300, epoch: 16 | loss: 0.0607834
	speed: 0.1314s/iter; left time: 4572.3227s
	iters: 400, epoch: 16 | loss: 0.0000008
	speed: 0.1111s/iter; left time: 3857.4633s
Epoch: 16 cost time: 53.57346510887146
Epoch: 16, Steps: 413 | Train Loss: 0.151 Vali Loss: 0.366 Vali Acc: 0.968 Test Loss: 0.366 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.7441682
	speed: 0.2467s/iter; left time: 8533.6397s
	iters: 200, epoch: 17 | loss: 1.4157151
	speed: 0.1273s/iter; left time: 4390.7058s
	iters: 300, epoch: 17 | loss: 0.5035587
	speed: 0.1217s/iter; left time: 4186.9273s
	iters: 400, epoch: 17 | loss: 0.0000531
	speed: 0.1140s/iter; left time: 3910.5684s
Epoch: 17 cost time: 50.70480251312256
Epoch: 17, Steps: 413 | Train Loss: 0.165 Vali Loss: 0.414 Vali Acc: 0.965 Test Loss: 0.414 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.6267323
	speed: 0.2208s/iter; left time: 7545.3733s
	iters: 200, epoch: 18 | loss: 0.0390683
	speed: 0.1083s/iter; left time: 3689.8999s
	iters: 300, epoch: 18 | loss: 0.0000002
	speed: 0.1121s/iter; left time: 3810.7688s
	iters: 400, epoch: 18 | loss: 0.0000061
	speed: 0.1099s/iter; left time: 3722.0277s
Epoch: 18 cost time: 44.84164571762085
Epoch: 18, Steps: 413 | Train Loss: 0.192 Vali Loss: 0.277 Vali Acc: 0.972 Test Loss: 0.277 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000002
	speed: 0.2363s/iter; left time: 7977.6732s
	iters: 200, epoch: 19 | loss: 0.5751507
	speed: 0.1058s/iter; left time: 3561.7354s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0956s/iter; left time: 3208.6672s
	iters: 400, epoch: 19 | loss: 0.0017457
	speed: 0.1125s/iter; left time: 3764.0084s
Epoch: 19 cost time: 45.06090497970581
Epoch: 19, Steps: 413 | Train Loss: 0.148 Vali Loss: 0.474 Vali Acc: 0.946 Test Loss: 0.474 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0006249
	speed: 0.2201s/iter; left time: 7342.5919s
	iters: 200, epoch: 20 | loss: 1.1193819
	speed: 0.1127s/iter; left time: 3747.3686s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0813s/iter; left time: 2695.1339s
	iters: 400, epoch: 20 | loss: 0.0000087
	speed: 0.0723s/iter; left time: 2389.8692s
Epoch: 20 cost time: 38.17918515205383
Epoch: 20, Steps: 413 | Train Loss: 0.168 Vali Loss: 0.363 Vali Acc: 0.960 Test Loss: 0.363 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.1253104
	speed: 0.2259s/iter; left time: 7440.4434s
	iters: 200, epoch: 21 | loss: 0.0002462
	speed: 0.1150s/iter; left time: 3777.5171s
	iters: 300, epoch: 21 | loss: 0.0701053
	speed: 0.1047s/iter; left time: 3427.4873s
	iters: 400, epoch: 21 | loss: 0.0002295
	speed: 0.1112s/iter; left time: 3630.9719s
Epoch: 21 cost time: 45.72955513000488
Epoch: 21, Steps: 413 | Train Loss: 0.157 Vali Loss: 0.357 Vali Acc: 0.967 Test Loss: 0.357 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9736243747157799
model parameter : 418570
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6876600
	speed: 0.1461s/iter; left time: 6019.5966s
	iters: 200, epoch: 1 | loss: 0.0409030
	speed: 0.1174s/iter; left time: 4824.4630s
	iters: 300, epoch: 1 | loss: 0.0059642
	speed: 0.0923s/iter; left time: 3786.0300s
	iters: 400, epoch: 1 | loss: 0.0239172
	speed: 0.1004s/iter; left time: 4104.8493s
Epoch: 1 cost time: 46.94981861114502
Epoch: 1, Steps: 413 | Train Loss: 0.419 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
Validation loss decreased (inf --> -0.950430).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0001034
	speed: 0.2913s/iter; left time: 11882.5021s
	iters: 200, epoch: 2 | loss: 0.1480290
	speed: 0.1206s/iter; left time: 4908.4492s
	iters: 300, epoch: 2 | loss: 0.6194893
	speed: 0.1129s/iter; left time: 4580.9943s
	iters: 400, epoch: 2 | loss: 0.0083816
	speed: 0.0985s/iter; left time: 3990.0226s
Epoch: 2 cost time: 46.58192682266235
Epoch: 2, Steps: 413 | Train Loss: 0.257 Vali Loss: 0.277 Vali Acc: 0.961 Test Loss: 0.277 Test Acc: 0.961
Validation loss decreased (-0.950430 --> -0.961343).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000060
	speed: 0.2467s/iter; left time: 9959.7924s
	iters: 200, epoch: 3 | loss: 0.0000000
	speed: 0.1054s/iter; left time: 4243.5033s
	iters: 300, epoch: 3 | loss: 1.3305196
	speed: 0.1127s/iter; left time: 4527.5258s
	iters: 400, epoch: 3 | loss: 0.0123638
	speed: 0.1066s/iter; left time: 4272.2302s
Epoch: 3 cost time: 44.74643921852112
Epoch: 3, Steps: 413 | Train Loss: 0.322 Vali Loss: 1.258 Vali Acc: 0.879 Test Loss: 1.258 Test Acc: 0.879
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1408360
	speed: 0.2581s/iter; left time: 10313.1338s
	iters: 200, epoch: 4 | loss: 0.0000064
	speed: 0.1124s/iter; left time: 4481.4989s
	iters: 300, epoch: 4 | loss: 0.0001125
	speed: 0.1152s/iter; left time: 4582.2922s
	iters: 400, epoch: 4 | loss: 0.1101298
	speed: 0.1102s/iter; left time: 4371.0867s
Epoch: 4 cost time: 45.82690739631653
Epoch: 4, Steps: 413 | Train Loss: 0.346 Vali Loss: 1.326 Vali Acc: 0.915 Test Loss: 1.326 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000002
	speed: 0.2715s/iter; left time: 10737.2465s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0937s/iter; left time: 3695.0461s
	iters: 300, epoch: 5 | loss: 2.2739873
	speed: 0.1037s/iter; left time: 4078.6690s
	iters: 400, epoch: 5 | loss: 0.0268843
	speed: 0.1138s/iter; left time: 4467.2827s
Epoch: 5 cost time: 42.8143036365509
Epoch: 5, Steps: 413 | Train Loss: 0.384 Vali Loss: 2.571 Vali Acc: 0.824 Test Loss: 2.571 Test Acc: 0.824
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0005560
	speed: 0.2790s/iter; left time: 10919.2087s
	iters: 200, epoch: 6 | loss: 0.0000143
	speed: 0.0972s/iter; left time: 3795.2659s
	iters: 300, epoch: 6 | loss: 0.0117658
	speed: 0.1062s/iter; left time: 4134.1932s
	iters: 400, epoch: 6 | loss: 1.9046732
	speed: 0.1145s/iter; left time: 4447.9112s
Epoch: 6 cost time: 44.63054823875427
Epoch: 6, Steps: 413 | Train Loss: 0.397 Vali Loss: 0.758 Vali Acc: 0.950 Test Loss: 0.758 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.5621167
	speed: 0.2744s/iter; left time: 10626.9973s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0969s/iter; left time: 3743.7297s
	iters: 300, epoch: 7 | loss: 0.7623876
	speed: 0.0924s/iter; left time: 3560.7615s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0930s/iter; left time: 3573.9175s
Epoch: 7 cost time: 40.898197650909424
Epoch: 7, Steps: 413 | Train Loss: 0.368 Vali Loss: 1.712 Vali Acc: 0.927 Test Loss: 1.712 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000043
	speed: 0.2675s/iter; left time: 10247.5378s
	iters: 200, epoch: 8 | loss: 0.0221000
	speed: 0.0996s/iter; left time: 3804.0298s
	iters: 300, epoch: 8 | loss: 0.3605305
	speed: 0.0957s/iter; left time: 3647.3672s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0944s/iter; left time: 3589.2639s
Epoch: 8 cost time: 41.62356781959534
Epoch: 8, Steps: 413 | Train Loss: 0.466 Vali Loss: 2.142 Vali Acc: 0.915 Test Loss: 2.142 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2749s/iter; left time: 10417.1955s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1364s/iter; left time: 5155.5180s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1278s/iter; left time: 4816.2082s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1302s/iter; left time: 4894.2556s
Epoch: 9 cost time: 54.918456077575684
Epoch: 9, Steps: 413 | Train Loss: 0.504 Vali Loss: 1.541 Vali Acc: 0.943 Test Loss: 1.541 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.3145s/iter; left time: 11788.6901s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1121s/iter; left time: 4192.4434s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.1131s/iter; left time: 4218.1553s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1302s/iter; left time: 4840.9410s
Epoch: 10 cost time: 50.83614802360535
Epoch: 10, Steps: 413 | Train Loss: 0.398 Vali Loss: 1.217 Vali Acc: 0.966 Test Loss: 1.217 Test Acc: 0.966
Validation loss decreased (-0.961343 --> -0.965881).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000241
	speed: 0.3097s/iter; left time: 11480.1983s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1212s/iter; left time: 4479.5750s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1144s/iter; left time: 4216.3310s
	iters: 400, epoch: 11 | loss: 0.8293029
	speed: 0.1099s/iter; left time: 4040.7193s
Epoch: 11 cost time: 49.42449331283569
Epoch: 11, Steps: 413 | Train Loss: 0.272 Vali Loss: 1.224 Vali Acc: 0.963 Test Loss: 1.224 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2925s/iter; left time: 10721.3265s
	iters: 200, epoch: 12 | loss: 1.6022611
	speed: 0.1193s/iter; left time: 4363.0603s
	iters: 300, epoch: 12 | loss: 1.5409555
	speed: 0.1172s/iter; left time: 4274.6544s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1041s/iter; left time: 3783.2016s
Epoch: 12 cost time: 47.69890880584717
Epoch: 12, Steps: 413 | Train Loss: 0.382 Vali Loss: 1.831 Vali Acc: 0.951 Test Loss: 1.831 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2812s/iter; left time: 10192.4311s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1144s/iter; left time: 4133.3819s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1135s/iter; left time: 4091.0214s
	iters: 400, epoch: 13 | loss: 0.2978122
	speed: 0.1044s/iter; left time: 3753.8381s
Epoch: 13 cost time: 47.069628953933716
Epoch: 13, Steps: 413 | Train Loss: 0.301 Vali Loss: 0.804 Vali Acc: 0.969 Test Loss: 0.804 Test Acc: 0.969
Validation loss decreased (-0.965881 --> -0.969069).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2646s/iter; left time: 9482.7813s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1121s/iter; left time: 4004.8463s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1143s/iter; left time: 4073.2041s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1112s/iter; left time: 3949.4065s
Epoch: 14 cost time: 46.78395342826843
Epoch: 14, Steps: 413 | Train Loss: 0.318 Vali Loss: 0.814 Vali Acc: 0.971 Test Loss: 0.814 Test Acc: 0.971
Validation loss decreased (-0.969069 --> -0.970888).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2591s/iter; left time: 9175.8872s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1111s/iter; left time: 3922.4532s
	iters: 300, epoch: 15 | loss: 1.3562021
	speed: 0.1158s/iter; left time: 4076.8970s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1151s/iter; left time: 4041.0573s
Epoch: 15 cost time: 46.845962047576904
Epoch: 15, Steps: 413 | Train Loss: 0.359 Vali Loss: 1.393 Vali Acc: 0.957 Test Loss: 1.393 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2599s/iter; left time: 9099.6629s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1120s/iter; left time: 3910.1135s
	iters: 300, epoch: 16 | loss: 2.0886295
	speed: 0.1090s/iter; left time: 3792.4712s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1150s/iter; left time: 3990.4744s
Epoch: 16 cost time: 46.27726221084595
Epoch: 16, Steps: 413 | Train Loss: 0.300 Vali Loss: 1.654 Vali Acc: 0.958 Test Loss: 1.654 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000911
	speed: 0.2623s/iter; left time: 9074.6158s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1380s/iter; left time: 4759.2015s
	iters: 300, epoch: 17 | loss: 0.7675689
	speed: 0.1342s/iter; left time: 4616.2854s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1348s/iter; left time: 4623.5466s
Epoch: 17 cost time: 53.90790772438049
Epoch: 17, Steps: 413 | Train Loss: 0.343 Vali Loss: 2.380 Vali Acc: 0.937 Test Loss: 2.380 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3235s/iter; left time: 11058.7645s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1452s/iter; left time: 4949.8069s
	iters: 300, epoch: 18 | loss: 5.1508255
	speed: 0.1287s/iter; left time: 4371.8042s
	iters: 400, epoch: 18 | loss: 1.2975707
	speed: 0.1169s/iter; left time: 3961.2025s
Epoch: 18 cost time: 54.92310619354248
Epoch: 18, Steps: 413 | Train Loss: 0.198 Vali Loss: 1.525 Vali Acc: 0.958 Test Loss: 1.525 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2943s/iter; left time: 9936.9626s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1265s/iter; left time: 4259.1697s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1221s/iter; left time: 4098.6935s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1145s/iter; left time: 3832.2076s
Epoch: 19 cost time: 50.74404501914978
Epoch: 19, Steps: 413 | Train Loss: 0.202 Vali Loss: 1.185 Vali Acc: 0.965 Test Loss: 1.185 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2773s/iter; left time: 9249.2761s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1115s/iter; left time: 3707.5274s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.1379s/iter; left time: 4571.4350s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.1542s/iter; left time: 5096.6044s
Epoch: 20 cost time: 54.66837000846863
Epoch: 20, Steps: 413 | Train Loss: 0.236 Vali Loss: 1.759 Vali Acc: 0.958 Test Loss: 1.759 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.7006167
	speed: 0.3254s/iter; left time: 10718.9888s
	iters: 200, epoch: 21 | loss: 0.0000004
	speed: 0.1403s/iter; left time: 4608.1030s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1453s/iter; left time: 4756.3385s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1480s/iter; left time: 4830.1944s
Epoch: 21 cost time: 59.27162528038025
Epoch: 21, Steps: 413 | Train Loss: 0.145 Vali Loss: 1.313 Vali Acc: 0.961 Test Loss: 1.313 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.3190s/iter; left time: 10376.1911s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1381s/iter; left time: 4479.5335s
	iters: 300, epoch: 22 | loss: 0.0000027
	speed: 0.1412s/iter; left time: 4566.1630s
	iters: 400, epoch: 22 | loss: 1.7652584
	speed: 0.1390s/iter; left time: 4479.1041s
Epoch: 22 cost time: 57.142770290374756
Epoch: 22, Steps: 413 | Train Loss: 0.460 Vali Loss: 1.328 Vali Acc: 0.967 Test Loss: 1.328 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.7197624
	speed: 0.3012s/iter; left time: 9673.4386s
	iters: 200, epoch: 23 | loss: 0.0001149
	speed: 0.1344s/iter; left time: 4302.8549s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1378s/iter; left time: 4399.2566s
	iters: 400, epoch: 23 | loss: 0.0000001
	speed: 0.1410s/iter; left time: 4486.5227s
Epoch: 23 cost time: 56.27901554107666
Epoch: 23, Steps: 413 | Train Loss: 0.178 Vali Loss: 1.712 Vali Acc: 0.951 Test Loss: 1.712 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.1030268
	speed: 0.3077s/iter; left time: 9754.5653s
	iters: 200, epoch: 24 | loss: 0.0000006
	speed: 0.1348s/iter; left time: 4259.8697s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.1466s/iter; left time: 4617.5522s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.1454s/iter; left time: 4564.9263s
Epoch: 24 cost time: 57.835240840911865
Epoch: 24, Steps: 413 | Train Loss: 0.216 Vali Loss: 1.356 Vali Acc: 0.962 Test Loss: 1.356 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9708958617553434
model parameter : 1032138
model size : 6.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9226677
	speed: 0.2164s/iter; left time: 8917.7100s
	iters: 200, epoch: 1 | loss: 0.0033496
	speed: 0.1895s/iter; left time: 7787.5610s
	iters: 300, epoch: 1 | loss: 0.9060687
	speed: 0.1818s/iter; left time: 7455.8567s
	iters: 400, epoch: 1 | loss: 0.0744151
	speed: 0.1788s/iter; left time: 7314.0670s
Epoch: 1 cost time: 79.22346138954163
Epoch: 1, Steps: 413 | Train Loss: 0.374 Vali Loss: 0.784 Vali Acc: 0.844 Test Loss: 0.784 Test Acc: 0.844
Validation loss decreased (inf --> -0.844467).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000616
	speed: 0.3283s/iter; left time: 13390.2066s
	iters: 200, epoch: 2 | loss: 0.1831472
	speed: 0.1531s/iter; left time: 6228.5960s
	iters: 300, epoch: 2 | loss: 0.1366209
	speed: 0.1739s/iter; left time: 7056.8743s
	iters: 400, epoch: 2 | loss: 0.0008629
	speed: 0.1814s/iter; left time: 7343.0719s
Epoch: 2 cost time: 68.53235530853271
Epoch: 2, Steps: 413 | Train Loss: 0.229 Vali Loss: 0.340 Vali Acc: 0.947 Test Loss: 0.340 Test Acc: 0.947
Validation loss decreased (-0.844467 --> -0.947245).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2862075
	speed: 0.3416s/iter; left time: 13790.6827s
	iters: 200, epoch: 3 | loss: 0.0160482
	speed: 0.1447s/iter; left time: 5829.7779s
	iters: 300, epoch: 3 | loss: 0.3091212
	speed: 0.1850s/iter; left time: 7434.2041s
	iters: 400, epoch: 3 | loss: 0.4181975
	speed: 0.1918s/iter; left time: 7686.2490s
Epoch: 3 cost time: 70.24781680107117
Epoch: 3, Steps: 413 | Train Loss: 0.230 Vali Loss: 0.519 Vali Acc: 0.957 Test Loss: 0.519 Test Acc: 0.957
Validation loss decreased (-0.947245 --> -0.956793).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000172
	speed: 0.3509s/iter; left time: 14024.0602s
	iters: 200, epoch: 4 | loss: 0.0000000
	speed: 0.1783s/iter; left time: 7108.5500s
	iters: 300, epoch: 4 | loss: 0.0000132
	speed: 0.1699s/iter; left time: 6755.6025s
	iters: 400, epoch: 4 | loss: 0.0000668
	speed: 0.1728s/iter; left time: 6854.8215s
Epoch: 4 cost time: 71.68725776672363
Epoch: 4, Steps: 413 | Train Loss: 0.274 Vali Loss: 0.695 Vali Acc: 0.950 Test Loss: 0.695 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000002
	speed: 0.3448s/iter; left time: 13637.2996s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.1893s/iter; left time: 7466.8254s
	iters: 300, epoch: 5 | loss: 0.0000096
	speed: 0.1394s/iter; left time: 5486.3078s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.1325s/iter; left time: 5202.2005s
Epoch: 5 cost time: 65.44962954521179
Epoch: 5, Steps: 413 | Train Loss: 0.305 Vali Loss: 0.875 Vali Acc: 0.945 Test Loss: 0.875 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.3351s/iter; left time: 13114.3866s
	iters: 200, epoch: 6 | loss: 0.2374566
	speed: 0.1581s/iter; left time: 6169.7859s
	iters: 300, epoch: 6 | loss: 0.0813895
	speed: 0.1262s/iter; left time: 4913.9826s
	iters: 400, epoch: 6 | loss: 0.0000186
	speed: 0.1342s/iter; left time: 5212.7459s
Epoch: 6 cost time: 60.607659339904785
Epoch: 6, Steps: 413 | Train Loss: 0.374 Vali Loss: 1.175 Vali Acc: 0.952 Test Loss: 1.175 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0029691
	speed: 0.3265s/iter; left time: 12643.1219s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.1447s/iter; left time: 5587.5138s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.1476s/iter; left time: 5684.3027s
	iters: 400, epoch: 7 | loss: 0.0758501
	speed: 0.1665s/iter; left time: 6397.6988s
Epoch: 7 cost time: 65.52708435058594
Epoch: 7, Steps: 413 | Train Loss: 0.339 Vali Loss: 0.546 Vali Acc: 0.953 Test Loss: 0.546 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0030762
	speed: 0.3514s/iter; left time: 13463.8613s
	iters: 200, epoch: 8 | loss: 0.2671920
	speed: 0.1924s/iter; left time: 7351.4671s
	iters: 300, epoch: 8 | loss: 0.7796509
	speed: 0.2132s/iter; left time: 8126.5618s
	iters: 400, epoch: 8 | loss: 1.8122317
	speed: 0.2128s/iter; left time: 8086.8921s
Epoch: 8 cost time: 82.50249981880188
Epoch: 8, Steps: 413 | Train Loss: 0.335 Vali Loss: 0.881 Vali Acc: 0.953 Test Loss: 0.881 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000009
	speed: 0.3593s/iter; left time: 13615.4976s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.1883s/iter; left time: 7115.5499s
	iters: 300, epoch: 9 | loss: 0.1616593
	speed: 0.1962s/iter; left time: 7394.6172s
	iters: 400, epoch: 9 | loss: 1.8984177
	speed: 0.1905s/iter; left time: 7161.9133s
Epoch: 9 cost time: 77.20348858833313
Epoch: 9, Steps: 413 | Train Loss: 0.303 Vali Loss: 0.880 Vali Acc: 0.957 Test Loss: 0.880 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0122437
	speed: 0.3309s/iter; left time: 12403.8847s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1839s/iter; left time: 6873.5633s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.1757s/iter; left time: 6549.4032s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1624s/iter; left time: 6037.2476s
Epoch: 10 cost time: 71.5249125957489
Epoch: 10, Steps: 413 | Train Loss: 0.393 Vali Loss: 0.949 Vali Acc: 0.964 Test Loss: 0.949 Test Acc: 0.964
Validation loss decreased (-0.956793 --> -0.964065).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.3345s/iter; left time: 12398.7820s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1612s/iter; left time: 5957.9220s
	iters: 300, epoch: 11 | loss: 0.0000004
	speed: 0.1578s/iter; left time: 5819.2937s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1576s/iter; left time: 5795.6572s
Epoch: 11 cost time: 66.36989116668701
Epoch: 11, Steps: 413 | Train Loss: 0.404 Vali Loss: 1.184 Vali Acc: 0.958 Test Loss: 1.184 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.3794854
	speed: 0.3269s/iter; left time: 11984.9216s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1459s/iter; left time: 5335.6396s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1496s/iter; left time: 5452.5599s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1606s/iter; left time: 5840.0168s
Epoch: 12 cost time: 64.59618330001831
Epoch: 12, Steps: 413 | Train Loss: 0.308 Vali Loss: 1.742 Vali Acc: 0.936 Test Loss: 1.742 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3244s/iter; left time: 11756.6578s
	iters: 200, epoch: 13 | loss: 7.0194831
	speed: 0.1408s/iter; left time: 5087.5549s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1662s/iter; left time: 5990.5987s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1725s/iter; left time: 6199.7625s
Epoch: 13 cost time: 65.683030128479
Epoch: 13, Steps: 413 | Train Loss: 0.398 Vali Loss: 1.847 Vali Acc: 0.950 Test Loss: 1.847 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3107s/iter; left time: 11133.1058s
	iters: 200, epoch: 14 | loss: 1.8513603
	speed: 0.1817s/iter; left time: 6491.3863s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1975s/iter; left time: 7036.0371s
	iters: 400, epoch: 14 | loss: 0.0000036
	speed: 0.1932s/iter; left time: 6864.2033s
Epoch: 14 cost time: 74.75916767120361
Epoch: 14, Steps: 413 | Train Loss: 0.376 Vali Loss: 1.867 Vali Acc: 0.949 Test Loss: 1.867 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3701s/iter; left time: 13107.2101s
	iters: 200, epoch: 15 | loss: 0.0159622
	speed: 0.1637s/iter; left time: 5781.7931s
	iters: 300, epoch: 15 | loss: 1.7547102
	speed: 0.1717s/iter; left time: 6047.0238s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1729s/iter; left time: 6071.2653s
Epoch: 15 cost time: 72.63201975822449
Epoch: 15, Steps: 413 | Train Loss: 0.465 Vali Loss: 1.127 Vali Acc: 0.963 Test Loss: 1.127 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0279610
	speed: 0.3598s/iter; left time: 12596.3835s
	iters: 200, epoch: 16 | loss: 0.0001042
	speed: 0.1454s/iter; left time: 5075.5739s
	iters: 300, epoch: 16 | loss: 3.7256596
	speed: 0.1460s/iter; left time: 5082.3671s
	iters: 400, epoch: 16 | loss: 0.0000046
	speed: 0.1592s/iter; left time: 5524.6906s
Epoch: 16 cost time: 66.14398312568665
Epoch: 16, Steps: 413 | Train Loss: 0.291 Vali Loss: 1.210 Vali Acc: 0.960 Test Loss: 1.210 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3341s/iter; left time: 11557.0679s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1369s/iter; left time: 4722.3221s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1451s/iter; left time: 4990.5070s
	iters: 400, epoch: 17 | loss: 0.0001013
	speed: 0.1675s/iter; left time: 5743.2627s
Epoch: 17 cost time: 63.890247106552124
Epoch: 17, Steps: 413 | Train Loss: 0.365 Vali Loss: 0.935 Vali Acc: 0.972 Test Loss: 0.935 Test Acc: 0.972
Validation loss decreased (-0.964065 --> -0.972251).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3071s/iter; left time: 10497.0391s
	iters: 200, epoch: 18 | loss: 0.0067068
	speed: 0.1362s/iter; left time: 4642.1286s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1618s/iter; left time: 5496.5467s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1568s/iter; left time: 5311.1270s
Epoch: 18 cost time: 62.203145027160645
Epoch: 18, Steps: 413 | Train Loss: 0.280 Vali Loss: 1.125 Vali Acc: 0.964 Test Loss: 1.125 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.3899831
	speed: 0.2884s/iter; left time: 9739.3046s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1395s/iter; left time: 4695.2507s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1524s/iter; left time: 5114.3627s
	iters: 400, epoch: 19 | loss: 2.8834882
	speed: 0.1437s/iter; left time: 4809.2944s
Epoch: 19 cost time: 59.014076948165894
Epoch: 19, Steps: 413 | Train Loss: 0.382 Vali Loss: 1.461 Vali Acc: 0.953 Test Loss: 1.461 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2946s/iter; left time: 9825.5528s
	iters: 200, epoch: 20 | loss: 1.3057214
	speed: 0.1534s/iter; left time: 5100.6157s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.1396s/iter; left time: 4628.9138s
	iters: 400, epoch: 20 | loss: 0.1203596
	speed: 0.1336s/iter; left time: 4416.6543s
Epoch: 20 cost time: 59.86889600753784
Epoch: 20, Steps: 413 | Train Loss: 0.310 Vali Loss: 1.328 Vali Acc: 0.951 Test Loss: 1.328 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.3048s/iter; left time: 10040.2260s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.1923s/iter; left time: 6314.9217s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1916s/iter; left time: 6273.3762s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1936s/iter; left time: 6317.8088s
Epoch: 21 cost time: 76.04674482345581
Epoch: 21, Steps: 413 | Train Loss: 0.337 Vali Loss: 1.309 Vali Acc: 0.958 Test Loss: 1.309 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0009002
	speed: 0.3840s/iter; left time: 12491.0887s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1821s/iter; left time: 5904.8297s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1836s/iter; left time: 5934.4058s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.2027s/iter; left time: 6531.5426s
Epoch: 22 cost time: 79.42682838439941
Epoch: 22, Steps: 413 | Train Loss: 0.288 Vali Loss: 1.091 Vali Acc: 0.961 Test Loss: 1.091 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000021
	speed: 0.2970s/iter; left time: 9537.4968s
	iters: 200, epoch: 23 | loss: 0.0855883
	speed: 0.1666s/iter; left time: 5334.9872s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1871s/iter; left time: 5972.8006s
	iters: 400, epoch: 23 | loss: 0.0136971
	speed: 0.1971s/iter; left time: 6271.8650s
Epoch: 23 cost time: 70.18802118301392
Epoch: 23, Steps: 413 | Train Loss: 0.165 Vali Loss: 1.561 Vali Acc: 0.942 Test Loss: 1.561 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.3626s/iter; left time: 11496.5327s
	iters: 200, epoch: 24 | loss: 1.7567463
	speed: 0.1608s/iter; left time: 5081.1322s
	iters: 300, epoch: 24 | loss: 0.7130468
	speed: 0.1754s/iter; left time: 5524.5251s
	iters: 400, epoch: 24 | loss: 0.2552146
	speed: 0.1724s/iter; left time: 5415.1837s
Epoch: 24 cost time: 71.61933755874634
Epoch: 24, Steps: 413 | Train Loss: 0.368 Vali Loss: 1.237 Vali Acc: 0.951 Test Loss: 1.237 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 2.6400266
	speed: 0.3342s/iter; left time: 10455.4308s
	iters: 200, epoch: 25 | loss: 0.1765855
	speed: 0.1141s/iter; left time: 3557.3632s
	iters: 300, epoch: 25 | loss: 1.5080249
	speed: 0.1240s/iter; left time: 3854.4340s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.1136s/iter; left time: 3520.0805s
Epoch: 25 cost time: 54.42659306526184
Epoch: 25, Steps: 413 | Train Loss: 0.453 Vali Loss: 0.891 Vali Acc: 0.968 Test Loss: 0.891 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2989s/iter; left time: 9228.6059s
	iters: 200, epoch: 26 | loss: 0.0000007
	speed: 0.1405s/iter; left time: 4323.4761s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.1279s/iter; left time: 3923.3668s
	iters: 400, epoch: 26 | loss: 0.0439497
	speed: 0.1159s/iter; left time: 3545.2013s
Epoch: 26 cost time: 54.282984495162964
Epoch: 26, Steps: 413 | Train Loss: 0.543 Vali Loss: 1.322 Vali Acc: 0.951 Test Loss: 1.322 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000093
	speed: 0.2520s/iter; left time: 7676.3435s
	iters: 200, epoch: 27 | loss: 0.4505944
	speed: 0.1174s/iter; left time: 3565.4393s
	iters: 300, epoch: 27 | loss: 0.3126919
	speed: 0.1505s/iter; left time: 4555.6363s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.1528s/iter; left time: 4608.9210s
Epoch: 27 cost time: 57.10847473144531
Epoch: 27, Steps: 413 | Train Loss: 0.254 Vali Loss: 1.310 Vali Acc: 0.955 Test Loss: 1.310 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9722601182355616
model parameter : 766154
model size : 5.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0731770
	speed: 0.1508s/iter; left time: 6211.9189s
	iters: 200, epoch: 1 | loss: 0.1917995
	speed: 0.1387s/iter; left time: 5700.3269s
	iters: 300, epoch: 1 | loss: 0.3773320
	speed: 0.1272s/iter; left time: 5213.9176s
	iters: 400, epoch: 1 | loss: 0.0000962
	speed: 0.1260s/iter; left time: 5151.9175s
Epoch: 1 cost time: 56.23942446708679
Epoch: 1, Steps: 413 | Train Loss: 0.380 Vali Loss: 0.228 Vali Acc: 0.951 Test Loss: 0.228 Test Acc: 0.951
Validation loss decreased (inf --> -0.950884).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000979
	speed: 0.2771s/iter; left time: 11300.5398s
	iters: 200, epoch: 2 | loss: 0.0000522
	speed: 0.1308s/iter; left time: 5320.5208s
	iters: 300, epoch: 2 | loss: 0.0007391
	speed: 0.1231s/iter; left time: 4996.6818s
	iters: 400, epoch: 2 | loss: 0.0475413
	speed: 0.1626s/iter; left time: 6583.0049s
Epoch: 2 cost time: 58.61323666572571
Epoch: 2, Steps: 413 | Train Loss: 0.182 Vali Loss: 0.375 Vali Acc: 0.950 Test Loss: 0.375 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0106887
	speed: 0.3379s/iter; left time: 13642.1236s
	iters: 200, epoch: 3 | loss: 0.0000007
	speed: 0.1736s/iter; left time: 6991.8367s
	iters: 300, epoch: 3 | loss: 0.4571673
	speed: 0.1757s/iter; left time: 7057.8361s
	iters: 400, epoch: 3 | loss: 1.8163551
	speed: 0.1621s/iter; left time: 6496.1870s
Epoch: 3 cost time: 71.08265256881714
Epoch: 3, Steps: 413 | Train Loss: 0.192 Vali Loss: 0.655 Vali Acc: 0.920 Test Loss: 0.655 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000045
	speed: 0.3389s/iter; left time: 13543.8892s
	iters: 200, epoch: 4 | loss: 0.0111320
	speed: 0.1738s/iter; left time: 6929.6956s
	iters: 300, epoch: 4 | loss: 0.0000010
	speed: 0.1808s/iter; left time: 7188.6227s
	iters: 400, epoch: 4 | loss: 0.0001679
	speed: 0.1665s/iter; left time: 6603.8164s
Epoch: 4 cost time: 72.49737596511841
Epoch: 4, Steps: 413 | Train Loss: 0.221 Vali Loss: 0.392 Vali Acc: 0.965 Test Loss: 0.392 Test Acc: 0.965
Validation loss decreased (-0.950884 --> -0.964980).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2135046
	speed: 0.2683s/iter; left time: 10612.5607s
	iters: 200, epoch: 5 | loss: 2.0941002
	speed: 0.1610s/iter; left time: 6351.3638s
	iters: 300, epoch: 5 | loss: 0.2163725
	speed: 0.1540s/iter; left time: 6061.6450s
	iters: 400, epoch: 5 | loss: 0.0000002
	speed: 0.1525s/iter; left time: 5983.7366s
Epoch: 5 cost time: 62.7475471496582
Epoch: 5, Steps: 413 | Train Loss: 0.307 Vali Loss: 0.529 Vali Acc: 0.961 Test Loss: 0.529 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000318
	speed: 0.3029s/iter; left time: 11856.0455s
	iters: 200, epoch: 6 | loss: 0.0009764
	speed: 0.1287s/iter; left time: 5025.6651s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.1525s/iter; left time: 5936.0220s
	iters: 400, epoch: 6 | loss: 0.0113797
	speed: 0.1567s/iter; left time: 6085.4936s
Epoch: 6 cost time: 61.26891851425171
Epoch: 6, Steps: 413 | Train Loss: 0.292 Vali Loss: 0.614 Vali Acc: 0.962 Test Loss: 0.614 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3651601
	speed: 0.3205s/iter; left time: 12411.7310s
	iters: 200, epoch: 7 | loss: 0.0004642
	speed: 0.1316s/iter; left time: 5081.2182s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.1646s/iter; left time: 6339.1253s
	iters: 400, epoch: 7 | loss: 0.4470868
	speed: 0.1514s/iter; left time: 5817.2580s
Epoch: 7 cost time: 63.31797504425049
Epoch: 7, Steps: 413 | Train Loss: 0.366 Vali Loss: 0.468 Vali Acc: 0.959 Test Loss: 0.468 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0984716
	speed: 0.3362s/iter; left time: 12879.3025s
	iters: 200, epoch: 8 | loss: 0.0018823
	speed: 0.1666s/iter; left time: 6366.5981s
	iters: 300, epoch: 8 | loss: 0.0000012
	speed: 0.1466s/iter; left time: 5585.5052s
	iters: 400, epoch: 8 | loss: 0.0000062
	speed: 0.1515s/iter; left time: 5757.7593s
Epoch: 8 cost time: 66.33745336532593
Epoch: 8, Steps: 413 | Train Loss: 0.303 Vali Loss: 0.544 Vali Acc: 0.961 Test Loss: 0.544 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.3208447
	speed: 0.3026s/iter; left time: 11466.2208s
	iters: 200, epoch: 9 | loss: 0.0000260
	speed: 0.1612s/iter; left time: 6094.2524s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1579s/iter; left time: 5951.1804s
	iters: 400, epoch: 9 | loss: 0.0000003
	speed: 0.1348s/iter; left time: 5068.4589s
Epoch: 9 cost time: 62.35589790344238
Epoch: 9, Steps: 413 | Train Loss: 0.284 Vali Loss: 0.594 Vali Acc: 0.959 Test Loss: 0.594 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000007
	speed: 0.2779s/iter; left time: 10418.0551s
	iters: 200, epoch: 10 | loss: 1.5624365
	speed: 0.1371s/iter; left time: 5123.7524s
	iters: 300, epoch: 10 | loss: 0.0000035
	speed: 0.1332s/iter; left time: 4966.8151s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1289s/iter; left time: 4791.9196s
Epoch: 10 cost time: 55.100173473358154
Epoch: 10, Steps: 413 | Train Loss: 0.252 Vali Loss: 0.688 Vali Acc: 0.960 Test Loss: 0.688 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0512108
	speed: 0.2799s/iter; left time: 10376.0600s
	iters: 200, epoch: 11 | loss: 0.0000004
	speed: 0.1399s/iter; left time: 5173.0973s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1234s/iter; left time: 4549.3001s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1454s/iter; left time: 5346.4950s
Epoch: 11 cost time: 57.38939189910889
Epoch: 11, Steps: 413 | Train Loss: 0.348 Vali Loss: 0.919 Vali Acc: 0.956 Test Loss: 0.919 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.5790974
	speed: 0.3230s/iter; left time: 11841.2620s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1552s/iter; left time: 5672.8269s
	iters: 300, epoch: 12 | loss: 1.9886531
	speed: 0.1694s/iter; left time: 6175.8768s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1656s/iter; left time: 6021.2180s
Epoch: 12 cost time: 68.05891370773315
Epoch: 12, Steps: 413 | Train Loss: 0.287 Vali Loss: 0.792 Vali Acc: 0.953 Test Loss: 0.792 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0001128
	speed: 0.3286s/iter; left time: 11910.5332s
	iters: 200, epoch: 13 | loss: 0.0003976
	speed: 0.1721s/iter; left time: 6221.9191s
	iters: 300, epoch: 13 | loss: 1.5669031
	speed: 0.1718s/iter; left time: 6191.0441s
	iters: 400, epoch: 13 | loss: 0.0000009
	speed: 0.1645s/iter; left time: 5911.7708s
Epoch: 13 cost time: 69.34718251228333
Epoch: 13, Steps: 413 | Train Loss: 0.323 Vali Loss: 1.085 Vali Acc: 0.957 Test Loss: 1.085 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2635s/iter; left time: 9441.3175s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1578s/iter; left time: 5637.0161s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1359s/iter; left time: 4841.8047s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1353s/iter; left time: 4805.8281s
Epoch: 14 cost time: 58.878379344940186
Epoch: 14, Steps: 413 | Train Loss: 0.252 Vali Loss: 1.462 Vali Acc: 0.936 Test Loss: 1.462 Test Acc: 0.936
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9649840836743975
model parameter : 633290
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0234082
	speed: 0.1662s/iter; left time: 6848.9894s
	iters: 200, epoch: 1 | loss: 0.0074542
	speed: 0.1397s/iter; left time: 5743.6857s
	iters: 300, epoch: 1 | loss: 0.0950594
	speed: 0.1089s/iter; left time: 4464.6250s
	iters: 400, epoch: 1 | loss: 0.2411289
	speed: 0.0996s/iter; left time: 4074.0486s
Epoch: 1 cost time: 52.507665395736694
Epoch: 1, Steps: 413 | Train Loss: 0.366 Vali Loss: 0.196 Vali Acc: 0.946 Test Loss: 0.196 Test Acc: 0.946
Validation loss decreased (inf --> -0.945883).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0001514
	speed: 0.2597s/iter; left time: 10590.7251s
	iters: 200, epoch: 2 | loss: 0.0005143
	speed: 0.1169s/iter; left time: 4757.1231s
	iters: 300, epoch: 2 | loss: 0.6560012
	speed: 0.1296s/iter; left time: 5260.8600s
	iters: 400, epoch: 2 | loss: 0.0389863
	speed: 0.1245s/iter; left time: 5039.9113s
Epoch: 2 cost time: 51.90553426742554
Epoch: 2, Steps: 413 | Train Loss: 0.157 Vali Loss: 0.409 Vali Acc: 0.899 Test Loss: 0.409 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1079501
	speed: 0.2199s/iter; left time: 8878.3543s
	iters: 200, epoch: 3 | loss: 0.0000830
	speed: 0.1263s/iter; left time: 5084.7859s
	iters: 300, epoch: 3 | loss: 0.0000027
	speed: 0.1213s/iter; left time: 4873.5293s
	iters: 400, epoch: 3 | loss: 0.3661855
	speed: 0.1085s/iter; left time: 4350.0782s
Epoch: 3 cost time: 46.8117790222168
Epoch: 3, Steps: 413 | Train Loss: 0.154 Vali Loss: 0.329 Vali Acc: 0.958 Test Loss: 0.329 Test Acc: 0.958
Validation loss decreased (-0.945883 --> -0.957705).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0004873
	speed: 0.2510s/iter; left time: 10031.3844s
	iters: 200, epoch: 4 | loss: 0.7412779
	speed: 0.1128s/iter; left time: 4495.3593s
	iters: 300, epoch: 4 | loss: 0.1656221
	speed: 0.0941s/iter; left time: 3742.2675s
	iters: 400, epoch: 4 | loss: 0.0071929
	speed: 0.1055s/iter; left time: 4182.6651s
Epoch: 4 cost time: 45.40890336036682
Epoch: 4, Steps: 413 | Train Loss: 0.236 Vali Loss: 0.322 Vali Acc: 0.958 Test Loss: 0.322 Test Acc: 0.958
Validation loss decreased (-0.957705 --> -0.957705).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7758034
	speed: 0.2415s/iter; left time: 9549.7618s
	iters: 200, epoch: 5 | loss: 0.0132429
	speed: 0.1197s/iter; left time: 4721.9126s
	iters: 300, epoch: 5 | loss: 0.7174165
	speed: 0.1075s/iter; left time: 4228.7783s
	iters: 400, epoch: 5 | loss: 0.0000794
	speed: 0.0958s/iter; left time: 3760.4156s
Epoch: 5 cost time: 45.3713481426239
Epoch: 5, Steps: 413 | Train Loss: 0.211 Vali Loss: 0.259 Vali Acc: 0.969 Test Loss: 0.259 Test Acc: 0.969
Validation loss decreased (-0.957705 --> -0.968620).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3881747
	speed: 0.2424s/iter; left time: 9487.4031s
	iters: 200, epoch: 6 | loss: 0.6986785
	speed: 0.1197s/iter; left time: 4674.5310s
	iters: 300, epoch: 6 | loss: 0.0224142
	speed: 0.0963s/iter; left time: 3749.6492s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.1172s/iter; left time: 4550.4517s
Epoch: 6 cost time: 47.481382846832275
Epoch: 6, Steps: 413 | Train Loss: 0.233 Vali Loss: 0.454 Vali Acc: 0.969 Test Loss: 0.454 Test Acc: 0.969
Validation loss decreased (-0.968620 --> -0.969072).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2912093
	speed: 0.2592s/iter; left time: 10037.5113s
	iters: 200, epoch: 7 | loss: 0.0200504
	speed: 0.1328s/iter; left time: 5128.1415s
	iters: 300, epoch: 7 | loss: 0.6222035
	speed: 0.1268s/iter; left time: 4885.8560s
	iters: 400, epoch: 7 | loss: 1.3899548
	speed: 0.1294s/iter; left time: 4971.6882s
Epoch: 7 cost time: 55.06420683860779
Epoch: 7, Steps: 413 | Train Loss: 0.219 Vali Loss: 2.427 Vali Acc: 0.856 Test Loss: 2.427 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0005850
	speed: 0.3260s/iter; left time: 12488.6115s
	iters: 200, epoch: 8 | loss: 0.0001278
	speed: 0.1664s/iter; left time: 6356.2705s
	iters: 300, epoch: 8 | loss: 0.0000080
	speed: 0.1624s/iter; left time: 6188.5121s
	iters: 400, epoch: 8 | loss: 2.7518680
	speed: 0.1666s/iter; left time: 6332.5160s
Epoch: 8 cost time: 68.50330948829651
Epoch: 8, Steps: 413 | Train Loss: 0.272 Vali Loss: 0.655 Vali Acc: 0.949 Test Loss: 0.655 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1346316
	speed: 0.3132s/iter; left time: 11869.3881s
	iters: 200, epoch: 9 | loss: 0.0000538
	speed: 0.1423s/iter; left time: 5377.6782s
	iters: 300, epoch: 9 | loss: 1.1783208
	speed: 0.1064s/iter; left time: 4009.7532s
	iters: 400, epoch: 9 | loss: 0.0000005
	speed: 0.1412s/iter; left time: 5310.4024s
Epoch: 9 cost time: 57.536012411117554
Epoch: 9, Steps: 413 | Train Loss: 0.262 Vali Loss: 0.795 Vali Acc: 0.956 Test Loss: 0.795 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000044
	speed: 0.2944s/iter; left time: 11036.2004s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1494s/iter; left time: 5586.4479s
	iters: 300, epoch: 10 | loss: 0.0936975
	speed: 0.1584s/iter; left time: 5904.7552s
	iters: 400, epoch: 10 | loss: 0.0000089
	speed: 0.1202s/iter; left time: 4470.5367s
Epoch: 10 cost time: 60.1017963886261
Epoch: 10, Steps: 413 | Train Loss: 0.242 Vali Loss: 0.449 Vali Acc: 0.963 Test Loss: 0.449 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2872s/iter; left time: 10646.9544s
	iters: 200, epoch: 11 | loss: 0.0000210
	speed: 0.1531s/iter; left time: 5659.1515s
	iters: 300, epoch: 11 | loss: 0.0000028
	speed: 0.1467s/iter; left time: 5408.0226s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1527s/iter; left time: 5613.6537s
Epoch: 11 cost time: 62.88885164260864
Epoch: 11, Steps: 413 | Train Loss: 0.287 Vali Loss: 1.030 Vali Acc: 0.923 Test Loss: 1.030 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2662s/iter; left time: 9758.6160s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1483s/iter; left time: 5420.3845s
	iters: 300, epoch: 12 | loss: 0.0005469
	speed: 0.1501s/iter; left time: 5470.6451s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1490s/iter; left time: 5417.1498s
Epoch: 12 cost time: 60.86510109901428
Epoch: 12, Steps: 413 | Train Loss: 0.312 Vali Loss: 1.565 Vali Acc: 0.935 Test Loss: 1.565 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.3977259
	speed: 0.2833s/iter; left time: 10268.5370s
	iters: 200, epoch: 13 | loss: 0.0001417
	speed: 0.1189s/iter; left time: 4298.7400s
	iters: 300, epoch: 13 | loss: 0.5006094
	speed: 0.1349s/iter; left time: 4861.6182s
	iters: 400, epoch: 13 | loss: 0.2354091
	speed: 0.1333s/iter; left time: 4792.0412s
Epoch: 13 cost time: 54.22698426246643
Epoch: 13, Steps: 413 | Train Loss: 0.464 Vali Loss: 0.596 Vali Acc: 0.953 Test Loss: 0.596 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.4981196
	speed: 0.2517s/iter; left time: 9019.8903s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1136s/iter; left time: 4058.9606s
	iters: 300, epoch: 14 | loss: 0.7109478
	speed: 0.1228s/iter; left time: 4375.3763s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1265s/iter; left time: 4496.0592s
Epoch: 14 cost time: 49.85607862472534
Epoch: 14, Steps: 413 | Train Loss: 0.353 Vali Loss: 0.719 Vali Acc: 0.955 Test Loss: 0.719 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.2466s/iter; left time: 8734.3223s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1172s/iter; left time: 4139.2309s
	iters: 300, epoch: 15 | loss: 2.4681308
	speed: 0.1174s/iter; left time: 4135.4855s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.1278s/iter; left time: 4487.3210s
Epoch: 15 cost time: 49.728527784347534
Epoch: 15, Steps: 413 | Train Loss: 0.353 Vali Loss: 0.853 Vali Acc: 0.955 Test Loss: 0.853 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.1370656
	speed: 0.2437s/iter; left time: 8532.3195s
	iters: 200, epoch: 16 | loss: 0.0159370
	speed: 0.1513s/iter; left time: 5280.7248s
	iters: 300, epoch: 16 | loss: 0.0458803
	speed: 0.1769s/iter; left time: 6155.8317s
	iters: 400, epoch: 16 | loss: 0.0000005
	speed: 0.1692s/iter; left time: 5872.4942s
Epoch: 16 cost time: 64.09694027900696
Epoch: 16, Steps: 413 | Train Loss: 0.283 Vali Loss: 0.710 Vali Acc: 0.965 Test Loss: 0.710 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9690768531150523
model parameter : 550474
model size : 4.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1852626
	speed: 0.1681s/iter; left time: 6924.5417s
	iters: 200, epoch: 1 | loss: 0.0462281
	speed: 0.1567s/iter; left time: 6441.2063s
	iters: 300, epoch: 1 | loss: 0.0140051
	speed: 0.1534s/iter; left time: 6287.6917s
	iters: 400, epoch: 1 | loss: 0.0055350
	speed: 0.1556s/iter; left time: 6364.9596s
Epoch: 1 cost time: 65.35723924636841
Epoch: 1, Steps: 413 | Train Loss: 0.339 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (inf --> -0.969985).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0048753
	speed: 0.2601s/iter; left time: 10609.6084s
	iters: 200, epoch: 2 | loss: 0.0033681
	speed: 0.1419s/iter; left time: 5775.2467s
	iters: 300, epoch: 2 | loss: 0.0270587
	speed: 0.1437s/iter; left time: 5832.8218s
	iters: 400, epoch: 2 | loss: 0.0008013
	speed: 0.1467s/iter; left time: 5938.1300s
Epoch: 2 cost time: 58.04629182815552
Epoch: 2, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.180 Vali Acc: 0.965 Test Loss: 0.180 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2028901
	speed: 0.2036s/iter; left time: 8221.6209s
	iters: 200, epoch: 3 | loss: 0.4102041
	speed: 0.1227s/iter; left time: 4943.4549s
	iters: 300, epoch: 3 | loss: 0.0483826
	speed: 0.1222s/iter; left time: 4909.8836s
	iters: 400, epoch: 3 | loss: 0.0064210
	speed: 0.1220s/iter; left time: 4887.2894s
Epoch: 3 cost time: 47.034830808639526
Epoch: 3, Steps: 413 | Train Loss: 0.131 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
Validation loss decreased (-0.969985 --> -0.974532).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0515729
	speed: 0.2306s/iter; left time: 9216.8378s
	iters: 200, epoch: 4 | loss: 0.0283408
	speed: 0.1182s/iter; left time: 4713.2336s
	iters: 300, epoch: 4 | loss: 0.0663915
	speed: 0.1192s/iter; left time: 4737.9432s
	iters: 400, epoch: 4 | loss: 0.0000039
	speed: 0.1141s/iter; left time: 4525.7238s
Epoch: 4 cost time: 47.92571520805359
Epoch: 4, Steps: 413 | Train Loss: 0.140 Vali Loss: 0.348 Vali Acc: 0.950 Test Loss: 0.348 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1583513
	speed: 0.2030s/iter; left time: 8029.9976s
	iters: 200, epoch: 5 | loss: 0.0053852
	speed: 0.1078s/iter; left time: 4251.8671s
	iters: 300, epoch: 5 | loss: 0.0139934
	speed: 0.0948s/iter; left time: 3730.7808s
	iters: 400, epoch: 5 | loss: 0.0000001
	speed: 0.1052s/iter; left time: 4129.4359s
Epoch: 5 cost time: 42.37501788139343
Epoch: 5, Steps: 413 | Train Loss: 0.203 Vali Loss: 0.277 Vali Acc: 0.971 Test Loss: 0.277 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000019
	speed: 0.2235s/iter; left time: 8748.2730s
	iters: 200, epoch: 6 | loss: 2.0432525
	speed: 0.0979s/iter; left time: 3820.8219s
	iters: 300, epoch: 6 | loss: 0.5385942
	speed: 0.0851s/iter; left time: 3313.1093s
	iters: 400, epoch: 6 | loss: 0.0000512
	speed: 0.0858s/iter; left time: 3331.1491s
Epoch: 6 cost time: 39.333916902542114
Epoch: 6, Steps: 413 | Train Loss: 0.163 Vali Loss: 0.348 Vali Acc: 0.960 Test Loss: 0.348 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.8398606
	speed: 0.2268s/iter; left time: 8781.7435s
	iters: 200, epoch: 7 | loss: 0.0103596
	speed: 0.1025s/iter; left time: 3957.6112s
	iters: 300, epoch: 7 | loss: 0.0662883
	speed: 0.1162s/iter; left time: 4474.6964s
	iters: 400, epoch: 7 | loss: 0.0003194
	speed: 0.1146s/iter; left time: 4403.5757s
Epoch: 7 cost time: 45.09402370452881
Epoch: 7, Steps: 413 | Train Loss: 0.149 Vali Loss: 0.763 Vali Acc: 0.929 Test Loss: 0.763 Test Acc: 0.929
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0079998
	speed: 0.2266s/iter; left time: 8681.6676s
	iters: 200, epoch: 8 | loss: 0.0000151
	speed: 0.0885s/iter; left time: 3383.1588s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.1011s/iter; left time: 3854.5129s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.1096s/iter; left time: 4164.3797s
Epoch: 8 cost time: 42.44291162490845
Epoch: 8, Steps: 413 | Train Loss: 0.217 Vali Loss: 0.477 Vali Acc: 0.960 Test Loss: 0.477 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000024
	speed: 0.2100s/iter; left time: 7958.1126s
	iters: 200, epoch: 9 | loss: 0.3528211
	speed: 0.0919s/iter; left time: 3475.4329s
	iters: 300, epoch: 9 | loss: 1.6977104
	speed: 0.0918s/iter; left time: 3461.4420s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0992s/iter; left time: 3729.0577s
Epoch: 9 cost time: 39.96929693222046
Epoch: 9, Steps: 413 | Train Loss: 0.215 Vali Loss: 0.489 Vali Acc: 0.960 Test Loss: 0.489 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1501224
	speed: 0.2182s/iter; left time: 8178.9396s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.0834s/iter; left time: 3118.9061s
	iters: 300, epoch: 10 | loss: 0.0000008
	speed: 0.0791s/iter; left time: 2947.8343s
	iters: 400, epoch: 10 | loss: 0.0161245
	speed: 0.0833s/iter; left time: 3097.2143s
Epoch: 10 cost time: 36.613001108169556
Epoch: 10, Steps: 413 | Train Loss: 0.193 Vali Loss: 0.586 Vali Acc: 0.955 Test Loss: 0.586 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.1912447
	speed: 0.1904s/iter; left time: 7058.1723s
	iters: 200, epoch: 11 | loss: 1.4106492
	speed: 0.0814s/iter; left time: 3007.6339s
	iters: 300, epoch: 11 | loss: 0.0000006
	speed: 0.0541s/iter; left time: 1994.0393s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1093s/iter; left time: 4017.8145s
Epoch: 11 cost time: 34.776105642318726
Epoch: 11, Steps: 413 | Train Loss: 0.277 Vali Loss: 0.623 Vali Acc: 0.963 Test Loss: 0.623 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.7482857
	speed: 0.2381s/iter; left time: 8729.7463s
	iters: 200, epoch: 12 | loss: 0.0000074
	speed: 0.1440s/iter; left time: 5263.7309s
	iters: 300, epoch: 12 | loss: 0.0000009
	speed: 0.1423s/iter; left time: 5189.2059s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1430s/iter; left time: 5199.2281s
Epoch: 12 cost time: 57.7324914932251
Epoch: 12, Steps: 413 | Train Loss: 0.273 Vali Loss: 0.502 Vali Acc: 0.961 Test Loss: 0.502 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000206
	speed: 0.2804s/iter; left time: 10161.6638s
	iters: 200, epoch: 13 | loss: 0.0007931
	speed: 0.1440s/iter; left time: 5205.9175s
	iters: 300, epoch: 13 | loss: 1.4671092
	speed: 0.1501s/iter; left time: 5408.7047s
	iters: 400, epoch: 13 | loss: 0.0090749
	speed: 0.1544s/iter; left time: 5551.5380s
Epoch: 13 cost time: 61.324522972106934
Epoch: 13, Steps: 413 | Train Loss: 0.221 Vali Loss: 0.817 Vali Acc: 0.957 Test Loss: 0.817 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9745338790359254
model parameter : 467786
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0798548
	speed: 0.1265s/iter; left time: 5213.9288s
	iters: 200, epoch: 1 | loss: 0.8569936
	speed: 0.1133s/iter; left time: 4658.7482s
	iters: 300, epoch: 1 | loss: 0.0637489
	speed: 0.1263s/iter; left time: 5179.5064s
	iters: 400, epoch: 1 | loss: 0.0113200
	speed: 0.1285s/iter; left time: 5255.5451s
Epoch: 1 cost time: 51.20876622200012
Epoch: 1, Steps: 413 | Train Loss: 0.344 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
Validation loss decreased (inf --> -0.955433).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0010259
	speed: 0.1676s/iter; left time: 6834.8312s
	iters: 200, epoch: 2 | loss: 0.0364755
	speed: 0.0394s/iter; left time: 1604.8221s
	iters: 300, epoch: 2 | loss: 0.0014215
	speed: 0.0411s/iter; left time: 1668.5693s
	iters: 400, epoch: 2 | loss: 1.0667832
	speed: 0.0507s/iter; left time: 2054.3240s
Epoch: 2 cost time: 19.55929470062256
Epoch: 2, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1928080
	speed: 0.1178s/iter; left time: 4757.4195s
	iters: 200, epoch: 3 | loss: 0.0595039
	speed: 0.1104s/iter; left time: 4447.1827s
	iters: 300, epoch: 3 | loss: 0.0034171
	speed: 0.0987s/iter; left time: 3964.6811s
	iters: 400, epoch: 3 | loss: 0.4541519
	speed: 0.1139s/iter; left time: 4564.3514s
Epoch: 3 cost time: 38.38945126533508
Epoch: 3, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.170 Vali Acc: 0.966 Test Loss: 0.170 Test Acc: 0.966
Validation loss decreased (-0.955433 --> -0.966347).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000100
	speed: 0.2267s/iter; left time: 9060.9779s
	iters: 200, epoch: 4 | loss: 0.1748075
	speed: 0.1062s/iter; left time: 4233.8044s
	iters: 300, epoch: 4 | loss: 0.0223186
	speed: 0.1125s/iter; left time: 4474.7104s
	iters: 400, epoch: 4 | loss: 1.1533680
	speed: 0.1137s/iter; left time: 4507.9191s
Epoch: 4 cost time: 46.42207384109497
Epoch: 4, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.555 Vali Acc: 0.935 Test Loss: 0.555 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000989
	speed: 0.1921s/iter; left time: 7597.1541s
	iters: 200, epoch: 5 | loss: 0.0000183
	speed: 0.1135s/iter; left time: 4479.1587s
	iters: 300, epoch: 5 | loss: 0.7787838
	speed: 0.1162s/iter; left time: 4572.4892s
	iters: 400, epoch: 5 | loss: 0.2776872
	speed: 0.1149s/iter; left time: 4509.4415s
Epoch: 5 cost time: 45.557624101638794
Epoch: 5, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.184 Vali Acc: 0.969 Test Loss: 0.184 Test Acc: 0.969
Validation loss decreased (-0.966347 --> -0.969075).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0336511
	speed: 0.2207s/iter; left time: 8638.9376s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.1009s/iter; left time: 3937.2083s
	iters: 300, epoch: 6 | loss: 0.0000012
	speed: 0.1053s/iter; left time: 4098.3720s
	iters: 400, epoch: 6 | loss: 0.1904694
	speed: 0.0926s/iter; left time: 3597.2385s
Epoch: 6 cost time: 42.97246479988098
Epoch: 6, Steps: 413 | Train Loss: 0.159 Vali Loss: 0.297 Vali Acc: 0.966 Test Loss: 0.297 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0001299
	speed: 0.2151s/iter; left time: 8329.7700s
	iters: 200, epoch: 7 | loss: 0.0007955
	speed: 0.1100s/iter; left time: 4247.1336s
	iters: 300, epoch: 7 | loss: 0.0000512
	speed: 0.1091s/iter; left time: 4201.4393s
	iters: 400, epoch: 7 | loss: 0.0962064
	speed: 0.0970s/iter; left time: 3725.8303s
Epoch: 7 cost time: 44.07765460014343
Epoch: 7, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.355 Vali Acc: 0.963 Test Loss: 0.355 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000002
	speed: 0.2054s/iter; left time: 7869.0928s
	iters: 200, epoch: 8 | loss: 0.6686200
	speed: 0.1027s/iter; left time: 3925.6352s
	iters: 300, epoch: 8 | loss: 0.0257225
	speed: 0.1122s/iter; left time: 4275.1385s
	iters: 400, epoch: 8 | loss: 0.0178598
	speed: 0.1320s/iter; left time: 5018.2716s
Epoch: 8 cost time: 47.07215094566345
Epoch: 8, Steps: 413 | Train Loss: 0.179 Vali Loss: 0.415 Vali Acc: 0.955 Test Loss: 0.415 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000142
	speed: 0.2460s/iter; left time: 9323.4750s
	iters: 200, epoch: 9 | loss: 0.9033622
	speed: 0.1228s/iter; left time: 4639.6566s
	iters: 300, epoch: 9 | loss: 0.0000043
	speed: 0.1259s/iter; left time: 4747.8090s
	iters: 400, epoch: 9 | loss: 0.0000141
	speed: 0.1177s/iter; left time: 4426.7612s
Epoch: 9 cost time: 50.869805574417114
Epoch: 9, Steps: 413 | Train Loss: 0.181 Vali Loss: 0.428 Vali Acc: 0.960 Test Loss: 0.428 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000002
	speed: 0.2391s/iter; left time: 8963.6222s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1111s/iter; left time: 4154.8325s
	iters: 300, epoch: 10 | loss: 0.2431567
	speed: 0.1230s/iter; left time: 4585.9749s
	iters: 400, epoch: 10 | loss: 0.0000093
	speed: 0.1235s/iter; left time: 4592.3372s
Epoch: 10 cost time: 50.61290621757507
Epoch: 10, Steps: 413 | Train Loss: 0.205 Vali Loss: 0.343 Vali Acc: 0.958 Test Loss: 0.343 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.3540681
	speed: 0.2273s/iter; left time: 8424.5496s
	iters: 200, epoch: 11 | loss: 0.0000047
	speed: 0.0829s/iter; left time: 3064.6417s
	iters: 300, epoch: 11 | loss: 0.1841069
	speed: 0.1030s/iter; left time: 3796.2302s
	iters: 400, epoch: 11 | loss: 0.1833585
	speed: 0.0965s/iter; left time: 3546.7331s
Epoch: 11 cost time: 40.014302015304565
Epoch: 11, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.651 Vali Acc: 0.955 Test Loss: 0.651 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000302
	speed: 0.2218s/iter; left time: 8131.3713s
	iters: 200, epoch: 12 | loss: 0.3243083
	speed: 0.0842s/iter; left time: 3078.1720s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 2601.0362s
	iters: 400, epoch: 12 | loss: 0.0023405
	speed: 0.0830s/iter; left time: 3017.2382s
Epoch: 12 cost time: 36.19925236701965
Epoch: 12, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.469 Vali Acc: 0.958 Test Loss: 0.469 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0534606
	speed: 0.2083s/iter; left time: 7550.9118s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0944s/iter; left time: 3412.7306s
	iters: 300, epoch: 13 | loss: 0.0000097
	speed: 0.0889s/iter; left time: 3204.7268s
	iters: 400, epoch: 13 | loss: 0.0000166
	speed: 0.0755s/iter; left time: 2713.5838s
Epoch: 13 cost time: 36.658559799194336
Epoch: 13, Steps: 413 | Train Loss: 0.196 Vali Loss: 0.352 Vali Acc: 0.966 Test Loss: 0.352 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.6973969
	speed: 0.2072s/iter; left time: 7424.8800s
	iters: 200, epoch: 14 | loss: 0.9423643
	speed: 0.0928s/iter; left time: 3316.3437s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 2912.4349s
	iters: 400, epoch: 14 | loss: 0.0000003
	speed: 0.0895s/iter; left time: 3179.4685s
Epoch: 14 cost time: 37.536707162857056
Epoch: 14, Steps: 413 | Train Loss: 0.193 Vali Loss: 0.490 Vali Acc: 0.953 Test Loss: 0.490 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000021
	speed: 0.1928s/iter; left time: 6827.8108s
	iters: 200, epoch: 15 | loss: 0.4250498
	speed: 0.0922s/iter; left time: 3256.3248s
	iters: 300, epoch: 15 | loss: 1.0727209
	speed: 0.0939s/iter; left time: 3305.7630s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0921s/iter; left time: 3233.3114s
Epoch: 15 cost time: 37.472246170043945
Epoch: 15, Steps: 413 | Train Loss: 0.216 Vali Loss: 0.508 Vali Acc: 0.957 Test Loss: 0.508 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9690768531150523
model parameter : 401866
model size : 4.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8328390
	speed: 0.1343s/iter; left time: 5534.2251s
	iters: 200, epoch: 1 | loss: 0.0140212
	speed: 0.1193s/iter; left time: 4901.6832s
	iters: 300, epoch: 1 | loss: 0.2172914
	speed: 0.1179s/iter; left time: 4833.3756s
	iters: 400, epoch: 1 | loss: 0.3150389
	speed: 0.1132s/iter; left time: 4630.6440s
Epoch: 1 cost time: 50.075055837631226
Epoch: 1, Steps: 413 | Train Loss: 0.354 Vali Loss: 0.130 Vali Acc: 0.960 Test Loss: 0.130 Test Acc: 0.960
Validation loss decreased (inf --> -0.959981).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0182015
	speed: 0.2314s/iter; left time: 9439.5726s
	iters: 200, epoch: 2 | loss: 0.4259429
	speed: 0.1141s/iter; left time: 4640.8579s
	iters: 300, epoch: 2 | loss: 0.0222063
	speed: 0.1112s/iter; left time: 4512.7080s
	iters: 400, epoch: 2 | loss: 0.0000173
	speed: 0.1335s/iter; left time: 5407.0725s
Epoch: 2 cost time: 49.28569984436035
Epoch: 2, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.157 Vali Acc: 0.952 Test Loss: 0.157 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0768142
	speed: 0.2683s/iter; left time: 10832.3511s
	iters: 200, epoch: 3 | loss: 0.0618955
	speed: 0.1629s/iter; left time: 6560.8770s
	iters: 300, epoch: 3 | loss: 0.0000094
	speed: 0.1591s/iter; left time: 6391.5211s
	iters: 400, epoch: 3 | loss: 0.5676154
	speed: 0.1366s/iter; left time: 5472.3080s
Epoch: 3 cost time: 63.22514033317566
Epoch: 3, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.206 Vali Acc: 0.960 Test Loss: 0.206 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0048234
	speed: 0.3069s/iter; left time: 12265.5176s
	iters: 200, epoch: 4 | loss: 0.0474934
	speed: 0.1885s/iter; left time: 7514.5446s
	iters: 300, epoch: 4 | loss: 0.0000065
	speed: 0.1582s/iter; left time: 6289.8344s
	iters: 400, epoch: 4 | loss: 0.0000338
	speed: 0.1494s/iter; left time: 5924.5146s
Epoch: 4 cost time: 68.61234903335571
Epoch: 4, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.208 Vali Acc: 0.961 Test Loss: 0.208 Test Acc: 0.961
Validation loss decreased (-0.959981 --> -0.961344).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2122787
	speed: 0.2642s/iter; left time: 10449.9630s
	iters: 200, epoch: 5 | loss: 0.0008798
	speed: 0.1102s/iter; left time: 4347.7647s
	iters: 300, epoch: 5 | loss: 0.0012037
	speed: 0.1375s/iter; left time: 5408.5444s
	iters: 400, epoch: 5 | loss: 0.0039216
	speed: 0.1409s/iter; left time: 5531.4575s
Epoch: 5 cost time: 54.55654168128967
Epoch: 5, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.257 Vali Acc: 0.960 Test Loss: 0.257 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0017403
	speed: 0.2563s/iter; left time: 10029.3667s
	iters: 200, epoch: 6 | loss: 0.0224048
	speed: 0.1189s/iter; left time: 4640.5015s
	iters: 300, epoch: 6 | loss: 0.3097001
	speed: 0.1299s/iter; left time: 5056.2934s
	iters: 400, epoch: 6 | loss: 0.0970994
	speed: 0.1071s/iter; left time: 4159.8159s
Epoch: 6 cost time: 49.56315326690674
Epoch: 6, Steps: 413 | Train Loss: 0.142 Vali Loss: 0.268 Vali Acc: 0.960 Test Loss: 0.268 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000059
	speed: 0.2540s/iter; left time: 9835.4017s
	iters: 200, epoch: 7 | loss: 0.0121194
	speed: 0.1411s/iter; left time: 5449.7929s
	iters: 300, epoch: 7 | loss: 0.4956366
	speed: 0.1338s/iter; left time: 5155.5597s
	iters: 400, epoch: 7 | loss: 0.0000016
	speed: 0.0893s/iter; left time: 3431.6076s
Epoch: 7 cost time: 51.27409791946411
Epoch: 7, Steps: 413 | Train Loss: 0.149 Vali Loss: 0.220 Vali Acc: 0.968 Test Loss: 0.220 Test Acc: 0.968
Validation loss decreased (-0.961344 --> -0.967710).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0426829
	speed: 0.2167s/iter; left time: 8303.6496s
	iters: 200, epoch: 8 | loss: 0.0034029
	speed: 0.0734s/iter; left time: 2806.4459s
	iters: 300, epoch: 8 | loss: 0.1965768
	speed: 0.0775s/iter; left time: 2955.1727s
	iters: 400, epoch: 8 | loss: 0.0048118
	speed: 0.0847s/iter; left time: 3219.4033s
Epoch: 8 cost time: 35.85062551498413
Epoch: 8, Steps: 413 | Train Loss: 0.173 Vali Loss: 0.281 Vali Acc: 0.963 Test Loss: 0.281 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000638
	speed: 0.2065s/iter; left time: 7826.3967s
	iters: 200, epoch: 9 | loss: 0.0000178
	speed: 0.0967s/iter; left time: 3656.0614s
	iters: 300, epoch: 9 | loss: 0.0340227
	speed: 0.0828s/iter; left time: 3123.0148s
	iters: 400, epoch: 9 | loss: 0.1267227
	speed: 0.0894s/iter; left time: 3360.1872s
Epoch: 9 cost time: 37.34029150009155
Epoch: 9, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.293 Vali Acc: 0.973 Test Loss: 0.293 Test Acc: 0.973
Validation loss decreased (-0.967710 --> -0.972712).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3639630
	speed: 0.1847s/iter; left time: 6923.2198s
	iters: 200, epoch: 10 | loss: 1.0337600
	speed: 0.0712s/iter; left time: 2661.1978s
	iters: 300, epoch: 10 | loss: 0.0000073
	speed: 0.0903s/iter; left time: 3367.0377s
	iters: 400, epoch: 10 | loss: 0.0734101
	speed: 0.1040s/iter; left time: 3867.4098s
Epoch: 10 cost time: 35.59759044647217
Epoch: 10, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.423 Vali Acc: 0.953 Test Loss: 0.423 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000441
	speed: 0.2314s/iter; left time: 8576.7418s
	iters: 200, epoch: 11 | loss: 1.1818743
	speed: 0.1085s/iter; left time: 4011.9520s
	iters: 300, epoch: 11 | loss: 0.0000840
	speed: 0.0835s/iter; left time: 3078.5142s
	iters: 400, epoch: 11 | loss: 0.0054143
	speed: 0.0777s/iter; left time: 2856.5580s
Epoch: 11 cost time: 39.15957474708557
Epoch: 11, Steps: 413 | Train Loss: 0.195 Vali Loss: 0.374 Vali Acc: 0.960 Test Loss: 0.374 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.8127653
	speed: 0.2144s/iter; left time: 7858.7319s
	iters: 200, epoch: 12 | loss: 0.0009012
	speed: 0.0765s/iter; left time: 2796.2517s
	iters: 300, epoch: 12 | loss: 0.4080543
	speed: 0.0685s/iter; left time: 2498.7930s
	iters: 400, epoch: 12 | loss: 0.0001636
	speed: 0.0927s/iter; left time: 3369.2592s
Epoch: 12 cost time: 35.254714488983154
Epoch: 12, Steps: 413 | Train Loss: 0.156 Vali Loss: 0.435 Vali Acc: 0.960 Test Loss: 0.435 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2029s/iter; left time: 7352.3551s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0728s/iter; left time: 2632.7153s
	iters: 300, epoch: 13 | loss: 0.0081985
	speed: 0.0956s/iter; left time: 3445.9670s
	iters: 400, epoch: 13 | loss: 0.0000004
	speed: 0.1153s/iter; left time: 4143.6418s
Epoch: 13 cost time: 38.591097593307495
Epoch: 13, Steps: 413 | Train Loss: 0.178 Vali Loss: 0.325 Vali Acc: 0.960 Test Loss: 0.325 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0003747
	speed: 0.2326s/iter; left time: 8335.4112s
	iters: 200, epoch: 14 | loss: 0.0000151
	speed: 0.1176s/iter; left time: 4203.2185s
	iters: 300, epoch: 14 | loss: 0.0000010
	speed: 0.1230s/iter; left time: 4382.0623s
	iters: 400, epoch: 14 | loss: 0.3086286
	speed: 0.1198s/iter; left time: 4256.7901s
Epoch: 14 cost time: 48.78426218032837
Epoch: 14, Steps: 413 | Train Loss: 0.212 Vali Loss: 0.450 Vali Acc: 0.957 Test Loss: 0.450 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.2540289
	speed: 0.2457s/iter; left time: 8703.0000s
	iters: 200, epoch: 15 | loss: 0.0000080
	speed: 0.1094s/iter; left time: 3864.3137s
	iters: 300, epoch: 15 | loss: 0.0246753
	speed: 0.1236s/iter; left time: 4353.6524s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1170s/iter; left time: 4108.1107s
Epoch: 15 cost time: 49.445658922195435
Epoch: 15, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.360 Vali Acc: 0.966 Test Loss: 0.360 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000352
	speed: 0.2687s/iter; left time: 9407.6926s
	iters: 200, epoch: 16 | loss: 0.0004737
	speed: 0.1454s/iter; left time: 5074.7654s
	iters: 300, epoch: 16 | loss: 0.6749216
	speed: 0.1538s/iter; left time: 5354.1322s
	iters: 400, epoch: 16 | loss: 0.0000761
	speed: 0.1433s/iter; left time: 4973.0738s
Epoch: 16 cost time: 61.580238819122314
Epoch: 16, Steps: 413 | Train Loss: 0.192 Vali Loss: 0.582 Vali Acc: 0.948 Test Loss: 0.582 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.5382005
	speed: 0.2715s/iter; left time: 9392.2195s
	iters: 200, epoch: 17 | loss: 0.0001493
	speed: 0.1482s/iter; left time: 5113.4160s
	iters: 300, epoch: 17 | loss: 0.0000408
	speed: 0.1209s/iter; left time: 4157.6576s
	iters: 400, epoch: 17 | loss: 0.0002674
	speed: 0.1091s/iter; left time: 3741.3520s
Epoch: 17 cost time: 54.06532073020935
Epoch: 17, Steps: 413 | Train Loss: 0.169 Vali Loss: 0.337 Vali Acc: 0.967 Test Loss: 0.337 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000026
	speed: 0.2389s/iter; left time: 8166.3084s
	iters: 200, epoch: 18 | loss: 0.2560877
	speed: 0.1310s/iter; left time: 4463.3091s
	iters: 300, epoch: 18 | loss: 0.0003248
	speed: 0.1142s/iter; left time: 3879.8703s
	iters: 400, epoch: 18 | loss: 0.0000045
	speed: 0.1205s/iter; left time: 4083.5486s
Epoch: 18 cost time: 50.49358510971069
Epoch: 18, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.386 Vali Acc: 0.966 Test Loss: 0.386 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000151
	speed: 0.2470s/iter; left time: 8340.2957s
	iters: 200, epoch: 19 | loss: 0.0000086
	speed: 0.1511s/iter; left time: 5087.0435s
	iters: 300, epoch: 19 | loss: 0.0106195
	speed: 0.1255s/iter; left time: 4212.3691s
	iters: 400, epoch: 19 | loss: 0.0001582
	speed: 0.1438s/iter; left time: 4813.9480s
Epoch: 19 cost time: 56.945661544799805
Epoch: 19, Steps: 413 | Train Loss: 0.180 Vali Loss: 0.307 Vali Acc: 0.970 Test Loss: 0.307 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm128_nh16_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9727148703956344
model parameter : 369226
model size : 3.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3082231
	speed: 0.1479s/iter; left time: 6095.3188s
	iters: 200, epoch: 1 | loss: 0.8559532
	speed: 0.1237s/iter; left time: 5084.1392s
	iters: 300, epoch: 1 | loss: 0.3956780
	speed: 0.1129s/iter; left time: 4629.6777s
	iters: 400, epoch: 1 | loss: 0.5700908
	speed: 0.1055s/iter; left time: 4313.8804s
Epoch: 1 cost time: 50.547165870666504
Epoch: 1, Steps: 413 | Train Loss: 0.392 Vali Loss: 0.212 Vali Acc: 0.954 Test Loss: 0.212 Test Acc: 0.954
Validation loss decreased (inf --> -0.954068).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1914713
	speed: 0.2648s/iter; left time: 10800.8167s
	iters: 200, epoch: 2 | loss: 0.0101139
	speed: 0.1085s/iter; left time: 4414.3875s
	iters: 300, epoch: 2 | loss: 0.0006502
	speed: 0.1106s/iter; left time: 4490.1722s
	iters: 400, epoch: 2 | loss: 0.0822911
	speed: 0.1398s/iter; left time: 5658.5126s
Epoch: 2 cost time: 48.1031858921051
Epoch: 2, Steps: 413 | Train Loss: 0.180 Vali Loss: 0.260 Vali Acc: 0.949 Test Loss: 0.260 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0022094
	speed: 0.2890s/iter; left time: 11667.5617s
	iters: 200, epoch: 3 | loss: 0.2644708
	speed: 0.1296s/iter; left time: 5218.6001s
	iters: 300, epoch: 3 | loss: 0.1125970
	speed: 0.1284s/iter; left time: 5160.0946s
	iters: 400, epoch: 3 | loss: 0.3238511
	speed: 0.1314s/iter; left time: 5266.7609s
Epoch: 3 cost time: 52.70916533470154
Epoch: 3, Steps: 413 | Train Loss: 0.197 Vali Loss: 0.293 Vali Acc: 0.965 Test Loss: 0.293 Test Acc: 0.965
Validation loss decreased (-0.954068 --> -0.964526).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000847
	speed: 0.2335s/iter; left time: 9331.9850s
	iters: 200, epoch: 4 | loss: 0.0062143
	speed: 0.1193s/iter; left time: 4756.5682s
	iters: 300, epoch: 4 | loss: 0.0000137
	speed: 0.1121s/iter; left time: 4458.2762s
	iters: 400, epoch: 4 | loss: 0.2529795
	speed: 0.1130s/iter; left time: 4482.9280s
Epoch: 4 cost time: 45.017117738723755
Epoch: 4, Steps: 413 | Train Loss: 0.179 Vali Loss: 0.346 Vali Acc: 0.944 Test Loss: 0.346 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000003
	speed: 0.2617s/iter; left time: 10348.5695s
	iters: 200, epoch: 5 | loss: 0.3979831
	speed: 0.1086s/iter; left time: 4284.8527s
	iters: 300, epoch: 5 | loss: 0.0001563
	speed: 0.0957s/iter; left time: 3764.6182s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0915s/iter; left time: 3592.5991s
Epoch: 5 cost time: 41.92620229721069
Epoch: 5, Steps: 413 | Train Loss: 0.148 Vali Loss: 0.415 Vali Acc: 0.965 Test Loss: 0.415 Test Acc: 0.965
Validation loss decreased (-0.964526 --> -0.964980).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.2364s/iter; left time: 9251.3566s
	iters: 200, epoch: 6 | loss: 0.7760449
	speed: 0.0950s/iter; left time: 3707.3239s
	iters: 300, epoch: 6 | loss: 0.5172541
	speed: 0.0944s/iter; left time: 3677.0861s
	iters: 400, epoch: 6 | loss: 0.0068165
	speed: 0.0975s/iter; left time: 3784.8085s
Epoch: 6 cost time: 39.67054772377014
Epoch: 6, Steps: 413 | Train Loss: 0.186 Vali Loss: 0.326 Vali Acc: 0.961 Test Loss: 0.326 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2530s/iter; left time: 9795.4666s
	iters: 200, epoch: 7 | loss: 0.0002645
	speed: 0.1153s/iter; left time: 4451.4485s
	iters: 300, epoch: 7 | loss: 0.0849806
	speed: 0.1274s/iter; left time: 4908.2084s
	iters: 400, epoch: 7 | loss: 0.0000023
	speed: 0.1265s/iter; left time: 4859.3934s
Epoch: 7 cost time: 49.231574058532715
Epoch: 7, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.655 Vali Acc: 0.950 Test Loss: 0.655 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0033412
	speed: 0.2985s/iter; left time: 11435.8103s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1308s/iter; left time: 4998.6490s
	iters: 300, epoch: 8 | loss: 0.0056959
	speed: 0.1283s/iter; left time: 4887.8204s
	iters: 400, epoch: 8 | loss: 0.0659951
	speed: 0.1133s/iter; left time: 4306.1342s
Epoch: 8 cost time: 52.0054087638855
Epoch: 8, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.785 Vali Acc: 0.950 Test Loss: 0.785 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2720s/iter; left time: 10307.0925s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1240s/iter; left time: 4686.7436s
	iters: 300, epoch: 9 | loss: 0.0000203
	speed: 0.1188s/iter; left time: 4478.9029s
	iters: 400, epoch: 9 | loss: 0.3588037
	speed: 0.1031s/iter; left time: 3877.9638s
Epoch: 9 cost time: 48.20658040046692
Epoch: 9, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.663 Vali Acc: 0.965 Test Loss: 0.663 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0006377
	speed: 0.3171s/iter; left time: 11887.5787s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1407s/iter; left time: 5258.2523s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.1403s/iter; left time: 5231.6381s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1360s/iter; left time: 5056.4018s
Epoch: 10 cost time: 57.85147523880005
Epoch: 10, Steps: 413 | Train Loss: 0.106 Vali Loss: 1.137 Vali Acc: 0.942 Test Loss: 1.137 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.3242s/iter; left time: 12019.1555s
	iters: 200, epoch: 11 | loss: 0.0005013
	speed: 0.1328s/iter; left time: 4909.3248s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1298s/iter; left time: 4787.2825s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1418s/iter; left time: 5214.6919s
Epoch: 11 cost time: 56.589627504348755
Epoch: 11, Steps: 413 | Train Loss: 0.182 Vali Loss: 0.902 Vali Acc: 0.962 Test Loss: 0.902 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000002
	speed: 0.2980s/iter; left time: 10925.2968s
	iters: 200, epoch: 12 | loss: 0.7008110
	speed: 0.1207s/iter; left time: 4411.2717s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.1281s/iter; left time: 4670.2543s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1145s/iter; left time: 4162.2339s
Epoch: 12 cost time: 48.69948983192444
Epoch: 12, Steps: 413 | Train Loss: 0.174 Vali Loss: 0.735 Vali Acc: 0.963 Test Loss: 0.735 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000016
	speed: 0.2911s/iter; left time: 10550.1031s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1174s/iter; left time: 4244.8428s
	iters: 300, epoch: 13 | loss: 0.7578315
	speed: 0.1245s/iter; left time: 4487.9928s
	iters: 400, epoch: 13 | loss: 0.4475650
	speed: 0.1200s/iter; left time: 4312.1665s
Epoch: 13 cost time: 50.03063607215881
Epoch: 13, Steps: 413 | Train Loss: 0.128 Vali Loss: 1.563 Vali Acc: 0.933 Test Loss: 1.563 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2997s/iter; left time: 10737.3885s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1163s/iter; left time: 4154.5882s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1461s/iter; left time: 5204.6805s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1341s/iter; left time: 4765.5893s
Epoch: 14 cost time: 54.871147871017456
Epoch: 14, Steps: 413 | Train Loss: 0.145 Vali Loss: 0.622 Vali Acc: 0.968 Test Loss: 0.622 Test Acc: 0.968
Validation loss decreased (-0.964980 --> -0.968161).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3105s/iter; left time: 10995.9062s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1005s/iter; left time: 3548.6596s
	iters: 300, epoch: 15 | loss: 0.5265464
	speed: 0.1187s/iter; left time: 4179.4227s
	iters: 400, epoch: 15 | loss: 0.4754599
	speed: 0.1170s/iter; left time: 4108.4643s
Epoch: 15 cost time: 48.80446410179138
Epoch: 15, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.583 Vali Acc: 0.970 Test Loss: 0.583 Test Acc: 0.970
Validation loss decreased (-0.968161 --> -0.969981).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2691s/iter; left time: 9420.1160s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1035s/iter; left time: 3614.4424s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1082s/iter; left time: 3766.4351s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1111s/iter; left time: 3855.2871s
Epoch: 16 cost time: 45.384207248687744
Epoch: 16, Steps: 413 | Train Loss: 0.092 Vali Loss: 1.186 Vali Acc: 0.961 Test Loss: 1.186 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2677s/iter; left time: 9260.1364s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0983s/iter; left time: 3390.8861s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1078s/iter; left time: 3706.3388s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1036s/iter; left time: 3553.4298s
Epoch: 17 cost time: 44.093097448349
Epoch: 17, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.632 Vali Acc: 0.969 Test Loss: 0.632 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2553s/iter; left time: 8726.3711s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.1053s/iter; left time: 3587.7459s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1096s/iter; left time: 3724.0824s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0985s/iter; left time: 3338.6263s
Epoch: 18 cost time: 43.350754737854004
Epoch: 18, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.984 Vali Acc: 0.957 Test Loss: 0.984 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2566s/iter; left time: 8664.1126s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1067s/iter; left time: 3592.9824s
	iters: 300, epoch: 19 | loss: 0.0000049
	speed: 0.0969s/iter; left time: 3253.9288s
	iters: 400, epoch: 19 | loss: 0.0000017
	speed: 0.0906s/iter; left time: 3031.3093s
Epoch: 19 cost time: 41.30111074447632
Epoch: 19, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.517 Vali Acc: 0.975 Test Loss: 0.517 Test Acc: 0.975
Validation loss decreased (-0.969981 --> -0.974529).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2368s/iter; left time: 7899.5983s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0969s/iter; left time: 3223.8937s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 2914.5979s
	iters: 400, epoch: 20 | loss: 0.0000438
	speed: 0.1078s/iter; left time: 3561.9994s
Epoch: 20 cost time: 40.270780086517334
Epoch: 20, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.844 Vali Acc: 0.956 Test Loss: 0.844 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2619s/iter; left time: 8627.4296s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.1184s/iter; left time: 3889.3052s
	iters: 300, epoch: 21 | loss: 0.2062620
	speed: 0.1192s/iter; left time: 3901.5095s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1209s/iter; left time: 3946.0467s
Epoch: 21 cost time: 48.80791449546814
Epoch: 21, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.904 Vali Acc: 0.967 Test Loss: 0.904 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.3391s/iter; left time: 11031.1975s
	iters: 200, epoch: 22 | loss: 0.0000395
	speed: 0.1558s/iter; left time: 5050.9353s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1483s/iter; left time: 4794.1106s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1642s/iter; left time: 5292.9056s
Epoch: 22 cost time: 63.38511681556702
Epoch: 22, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.872 Vali Acc: 0.963 Test Loss: 0.872 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.3789s/iter; left time: 12169.6935s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.1725s/iter; left time: 5523.4452s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1311s/iter; left time: 4185.3779s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1957s/iter; left time: 6226.2920s
Epoch: 23 cost time: 70.46203088760376
Epoch: 23, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.675 Vali Acc: 0.974 Test Loss: 0.675 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.3939365
	speed: 0.4215s/iter; left time: 13362.2946s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.1679s/iter; left time: 5305.3674s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.1641s/iter; left time: 5170.4575s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.1807s/iter; left time: 5674.7699s
Epoch: 24 cost time: 71.45392107963562
Epoch: 24, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.856 Vali Acc: 0.966 Test Loss: 0.856 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0281847
	speed: 0.4174s/iter; left time: 13060.1573s
	iters: 200, epoch: 25 | loss: 0.2467215
	speed: 0.1747s/iter; left time: 5447.2692s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.1534s/iter; left time: 4768.8430s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.1650s/iter; left time: 5112.5905s
Epoch: 25 cost time: 69.70984244346619
Epoch: 25, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.680 Vali Acc: 0.972 Test Loss: 0.680 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0011239
	speed: 0.3719s/iter; left time: 11483.7935s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.1598s/iter; left time: 4919.5411s
	iters: 300, epoch: 26 | loss: 0.0185297
	speed: 0.1541s/iter; left time: 4726.8024s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.1658s/iter; left time: 5070.0946s
Epoch: 26 cost time: 65.96451663970947
Epoch: 26, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.668 Vali Acc: 0.968 Test Loss: 0.668 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.3762s/iter; left time: 11460.8384s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.1356s/iter; left time: 4117.0838s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.1444s/iter; left time: 4369.9966s
	iters: 400, epoch: 27 | loss: 0.0000320
	speed: 0.1627s/iter; left time: 4908.4720s
Epoch: 27 cost time: 62.928844690322876
Epoch: 27, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.558 Vali Acc: 0.972 Test Loss: 0.558 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.3546s/iter; left time: 10656.6927s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.1476s/iter; left time: 4419.9865s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.1624s/iter; left time: 4846.6569s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.1640s/iter; left time: 4878.8816s
Epoch: 28 cost time: 63.577152967453
Epoch: 28, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.980 Vali Acc: 0.967 Test Loss: 0.980 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.3753s/iter; left time: 11123.2586s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.1751s/iter; left time: 5171.1307s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.1858s/iter; left time: 5469.9040s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.1888s/iter; left time: 5539.8520s
Epoch: 29 cost time: 74.77942609786987
Epoch: 29, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.625 Vali Acc: 0.975 Test Loss: 0.625 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9745338790359254
model parameter : 541322
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0542056
	speed: 0.1863s/iter; left time: 7676.0971s
	iters: 200, epoch: 1 | loss: 0.2760068
	speed: 0.1887s/iter; left time: 7755.4012s
	iters: 300, epoch: 1 | loss: 0.0038584
	speed: 0.1871s/iter; left time: 7672.1594s
	iters: 400, epoch: 1 | loss: 0.0677471
	speed: 0.1702s/iter; left time: 6961.7135s
Epoch: 1 cost time: 75.98427081108093
Epoch: 1, Steps: 413 | Train Loss: 0.358 Vali Loss: 0.248 Vali Acc: 0.940 Test Loss: 0.248 Test Acc: 0.940
Validation loss decreased (inf --> -0.940425).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0214602
	speed: 0.3431s/iter; left time: 13993.1747s
	iters: 200, epoch: 2 | loss: 0.0286037
	speed: 0.1605s/iter; left time: 6531.4185s
	iters: 300, epoch: 2 | loss: 0.0267195
	speed: 0.1557s/iter; left time: 6321.4200s
	iters: 400, epoch: 2 | loss: 0.4532687
	speed: 0.1874s/iter; left time: 7589.3969s
Epoch: 2 cost time: 69.67290091514587
Epoch: 2, Steps: 413 | Train Loss: 0.168 Vali Loss: 0.264 Vali Acc: 0.953 Test Loss: 0.264 Test Acc: 0.953
Validation loss decreased (-0.940425 --> -0.952703).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000546
	speed: 0.3581s/iter; left time: 14457.0416s
	iters: 200, epoch: 3 | loss: 0.0000009
	speed: 0.1751s/iter; left time: 7052.2176s
	iters: 300, epoch: 3 | loss: 0.0044229
	speed: 0.1614s/iter; left time: 6486.2088s
	iters: 400, epoch: 3 | loss: 0.2964892
	speed: 0.1894s/iter; left time: 7589.1154s
Epoch: 3 cost time: 72.60126113891602
Epoch: 3, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.492 Vali Acc: 0.940 Test Loss: 0.492 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0003201
	speed: 0.3870s/iter; left time: 15463.9116s
	iters: 200, epoch: 4 | loss: 0.0005889
	speed: 0.2212s/iter; left time: 8816.7279s
	iters: 300, epoch: 4 | loss: 0.1651874
	speed: 0.2163s/iter; left time: 8599.7098s
	iters: 400, epoch: 4 | loss: 0.0353490
	speed: 0.2008s/iter; left time: 7963.3924s
Epoch: 4 cost time: 86.32923936843872
Epoch: 4, Steps: 413 | Train Loss: 0.151 Vali Loss: 0.369 Vali Acc: 0.956 Test Loss: 0.369 Test Acc: 0.956
Validation loss decreased (-0.952703 --> -0.956340).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000596
	speed: 0.3909s/iter; left time: 15457.7885s
	iters: 200, epoch: 5 | loss: 0.1359876
	speed: 0.2045s/iter; left time: 8068.2794s
	iters: 300, epoch: 5 | loss: 1.8262964
	speed: 0.1898s/iter; left time: 7469.0989s
	iters: 400, epoch: 5 | loss: 0.0310357
	speed: 0.1956s/iter; left time: 7676.9240s
Epoch: 5 cost time: 83.39584732055664
Epoch: 5, Steps: 413 | Train Loss: 0.173 Vali Loss: 0.359 Vali Acc: 0.958 Test Loss: 0.359 Test Acc: 0.958
Validation loss decreased (-0.956340 --> -0.958159).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0030994
	speed: 0.3831s/iter; left time: 14992.5211s
	iters: 200, epoch: 6 | loss: 0.0000100
	speed: 0.1590s/iter; left time: 6207.8696s
	iters: 300, epoch: 6 | loss: 0.0000005
	speed: 0.1745s/iter; left time: 6796.2122s
	iters: 400, epoch: 6 | loss: 0.0006950
	speed: 0.2041s/iter; left time: 7928.2844s
Epoch: 6 cost time: 76.13129472732544
Epoch: 6, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.528 Vali Acc: 0.942 Test Loss: 0.528 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2217783
	speed: 0.3713s/iter; left time: 14376.6293s
	iters: 200, epoch: 7 | loss: 0.3272119
	speed: 0.1700s/iter; left time: 6564.2463s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.2034s/iter; left time: 7834.0956s
	iters: 400, epoch: 7 | loss: 0.0018471
	speed: 0.2144s/iter; left time: 8237.3195s
Epoch: 7 cost time: 80.36330938339233
Epoch: 7, Steps: 413 | Train Loss: 0.134 Vali Loss: 0.457 Vali Acc: 0.962 Test Loss: 0.457 Test Acc: 0.962
Validation loss decreased (-0.958159 --> -0.961796).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0039356
	speed: 0.4155s/iter; left time: 15917.5134s
	iters: 200, epoch: 8 | loss: 0.2193562
	speed: 0.2273s/iter; left time: 8685.8143s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.2117s/iter; left time: 8066.9616s
	iters: 400, epoch: 8 | loss: 0.0000138
	speed: 0.1531s/iter; left time: 5818.4102s
Epoch: 8 cost time: 84.26074552536011
Epoch: 8, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.440 Vali Acc: 0.960 Test Loss: 0.440 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.4090s/iter; left time: 15501.0490s
	iters: 200, epoch: 9 | loss: 0.0000008
	speed: 0.2066s/iter; left time: 7810.4779s
	iters: 300, epoch: 9 | loss: 0.6947697
	speed: 0.1626s/iter; left time: 6131.1855s
	iters: 400, epoch: 9 | loss: 0.0004100
	speed: 0.2017s/iter; left time: 7582.3661s
Epoch: 9 cost time: 82.13463258743286
Epoch: 9, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.558 Vali Acc: 0.958 Test Loss: 0.558 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1790743
	speed: 0.3876s/iter; left time: 14527.2603s
	iters: 200, epoch: 10 | loss: 0.0000004
	speed: 0.1860s/iter; left time: 6951.8105s
	iters: 300, epoch: 10 | loss: 0.0000016
	speed: 0.1982s/iter; left time: 7389.8046s
	iters: 400, epoch: 10 | loss: 0.8613635
	speed: 0.1883s/iter; left time: 7000.0496s
Epoch: 10 cost time: 79.35875511169434
Epoch: 10, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.604 Vali Acc: 0.951 Test Loss: 0.604 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.3489s/iter; left time: 12934.3914s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1821s/iter; left time: 6733.1315s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1821s/iter; left time: 6715.7362s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1699s/iter; left time: 6247.4531s
Epoch: 11 cost time: 73.63921403884888
Epoch: 11, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.342 Vali Acc: 0.971 Test Loss: 0.342 Test Acc: 0.971
Validation loss decreased (-0.961796 --> -0.970892).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.3388s/iter; left time: 12418.5584s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1810s/iter; left time: 6617.4631s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1313s/iter; left time: 4785.7405s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1231s/iter; left time: 4475.6967s
Epoch: 12 cost time: 64.0507025718689
Epoch: 12, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.513 Vali Acc: 0.961 Test Loss: 0.513 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3663s/iter; left time: 13277.5546s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1714s/iter; left time: 6194.0341s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1649s/iter; left time: 5944.0005s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1928s/iter; left time: 6929.4433s
Epoch: 13 cost time: 74.88838839530945
Epoch: 13, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.568 Vali Acc: 0.954 Test Loss: 0.568 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000123
	speed: 0.3816s/iter; left time: 13674.4868s
	iters: 200, epoch: 14 | loss: 0.1312760
	speed: 0.2393s/iter; left time: 8549.2873s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2373s/iter; left time: 8456.9221s
	iters: 400, epoch: 14 | loss: 0.0000151
	speed: 0.2684s/iter; left time: 9536.3149s
Epoch: 14 cost time: 96.99847674369812
Epoch: 14, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.580 Vali Acc: 0.970 Test Loss: 0.580 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.4586s/iter; left time: 16241.6379s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2505s/iter; left time: 8847.7338s
	iters: 300, epoch: 15 | loss: 0.0044673
	speed: 0.2049s/iter; left time: 7216.6430s
	iters: 400, epoch: 15 | loss: 0.0880920
	speed: 0.1716s/iter; left time: 6026.1627s
Epoch: 15 cost time: 89.83793354034424
Epoch: 15, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.577 Vali Acc: 0.970 Test Loss: 0.577 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.4161s/iter; left time: 14564.5711s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.1942s/iter; left time: 6777.2327s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1452s/iter; left time: 5054.6943s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1851s/iter; left time: 6423.0227s
Epoch: 16 cost time: 76.77063751220703
Epoch: 16, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.480 Vali Acc: 0.972 Test Loss: 0.480 Test Acc: 0.972
Validation loss decreased (-0.970892 --> -0.972255).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3468s/iter; left time: 11996.8866s
	iters: 200, epoch: 17 | loss: 0.0000019
	speed: 0.1506s/iter; left time: 5195.7799s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1929s/iter; left time: 6634.8423s
	iters: 400, epoch: 17 | loss: 0.0000155
	speed: 0.1661s/iter; left time: 5697.2980s
Epoch: 17 cost time: 70.62891554832458
Epoch: 17, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.608 Vali Acc: 0.967 Test Loss: 0.608 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0657244
	speed: 0.3177s/iter; left time: 10857.8141s
	iters: 200, epoch: 18 | loss: 1.3125774
	speed: 0.1761s/iter; left time: 6001.8374s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1746s/iter; left time: 5934.5157s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1614s/iter; left time: 5468.4169s
Epoch: 18 cost time: 69.38537168502808
Epoch: 18, Steps: 413 | Train Loss: 0.093 Vali Loss: 1.026 Vali Acc: 0.947 Test Loss: 1.026 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.3180s/iter; left time: 10736.9650s
	iters: 200, epoch: 19 | loss: 0.3336313
	speed: 0.1579s/iter; left time: 5315.4773s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1621s/iter; left time: 5442.6580s
	iters: 400, epoch: 19 | loss: 0.5754761
	speed: 0.1614s/iter; left time: 5400.2444s
Epoch: 19 cost time: 67.42362260818481
Epoch: 19, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.622 Vali Acc: 0.974 Test Loss: 0.622 Test Acc: 0.974
Validation loss decreased (-0.972255 --> -0.974073).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.3002s/iter; left time: 10012.1334s
	iters: 200, epoch: 20 | loss: 0.0706165
	speed: 0.1807s/iter; left time: 6010.2238s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.1921s/iter; left time: 6369.2341s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.1921s/iter; left time: 6349.3452s
Epoch: 20 cost time: 73.5178816318512
Epoch: 20, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.558 Vali Acc: 0.964 Test Loss: 0.558 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1692527
	speed: 0.3557s/iter; left time: 11716.6427s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.1401s/iter; left time: 4599.7617s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1620s/iter; left time: 5302.8047s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1539s/iter; left time: 5022.5149s
Epoch: 21 cost time: 64.9036934375763
Epoch: 21, Steps: 413 | Train Loss: 0.054 Vali Loss: 1.080 Vali Acc: 0.952 Test Loss: 1.080 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000245
	speed: 0.3150s/iter; left time: 10247.6503s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.1522s/iter; left time: 4936.0906s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1593s/iter; left time: 5151.0521s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1530s/iter; left time: 4931.9107s
Epoch: 22 cost time: 63.988102436065674
Epoch: 22, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.796 Vali Acc: 0.962 Test Loss: 0.796 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2836s/iter; left time: 9107.7247s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.1493s/iter; left time: 4778.5259s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1545s/iter; left time: 4930.8680s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1553s/iter; left time: 4941.7476s
Epoch: 23 cost time: 61.1046576499939
Epoch: 23, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.637 Vali Acc: 0.975 Test Loss: 0.637 Test Acc: 0.975
Validation loss decreased (-0.974073 --> -0.974982).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000309
	speed: 0.2729s/iter; left time: 8652.0238s
	iters: 200, epoch: 24 | loss: 0.0000031
	speed: 0.1306s/iter; left time: 4126.8877s
	iters: 300, epoch: 24 | loss: 0.0000092
	speed: 0.1149s/iter; left time: 3619.9784s
	iters: 400, epoch: 24 | loss: 0.1423822
	speed: 0.0950s/iter; left time: 2983.6110s
Epoch: 24 cost time: 48.790488719940186
Epoch: 24, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.856 Vali Acc: 0.958 Test Loss: 0.856 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000006
	speed: 0.2437s/iter; left time: 7624.3319s
	iters: 200, epoch: 25 | loss: 0.0000002
	speed: 0.1124s/iter; left time: 3504.1663s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.1221s/iter; left time: 3794.7119s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.1136s/iter; left time: 3519.5489s
Epoch: 25 cost time: 47.74739599227905
Epoch: 25, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.667 Vali Acc: 0.965 Test Loss: 0.667 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2534s/iter; left time: 7822.8688s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.1221s/iter; left time: 3758.3741s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.1110s/iter; left time: 3403.5798s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.1131s/iter; left time: 3458.6272s
Epoch: 26 cost time: 48.193243741989136
Epoch: 26, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.701 Vali Acc: 0.970 Test Loss: 0.701 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.3501s/iter; left time: 10664.6212s
	iters: 200, epoch: 27 | loss: 0.0000003
	speed: 0.1675s/iter; left time: 5084.4768s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.1701s/iter; left time: 5148.7073s
	iters: 400, epoch: 27 | loss: 0.4950301
	speed: 0.1700s/iter; left time: 5128.1329s
Epoch: 27 cost time: 71.33779048919678
Epoch: 27, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.986 Vali Acc: 0.957 Test Loss: 0.986 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2613s/iter; left time: 7851.2935s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.1355s/iter; left time: 4056.9267s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.1458s/iter; left time: 4350.9472s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.1381s/iter; left time: 4108.1190s
Epoch: 28 cost time: 54.23588490486145
Epoch: 28, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.693 Vali Acc: 0.970 Test Loss: 0.693 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000005
	speed: 0.2845s/iter; left time: 8430.9304s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.1080s/iter; left time: 3191.0240s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.1537s/iter; left time: 4524.9722s
	iters: 400, epoch: 29 | loss: 0.0000002
	speed: 0.1891s/iter; left time: 5548.3064s
Epoch: 29 cost time: 61.465548038482666
Epoch: 29, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.664 Vali Acc: 0.966 Test Loss: 0.664 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000051
	speed: 0.3670s/iter; left time: 10724.6379s
	iters: 200, epoch: 30 | loss: 1.3645296
	speed: 0.1602s/iter; left time: 4665.9588s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.1694s/iter; left time: 4917.8549s
	iters: 400, epoch: 30 | loss: 0.0467857
	speed: 0.1750s/iter; left time: 5062.1232s
Epoch: 30 cost time: 71.21708917617798
Epoch: 30, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.937 Vali Acc: 0.965 Test Loss: 0.937 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.2124531
	speed: 0.3268s/iter; left time: 9415.8632s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.1760s/iter; left time: 5053.8104s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.1719s/iter; left time: 4919.0117s
	iters: 400, epoch: 31 | loss: 0.0000166
	speed: 0.1608s/iter; left time: 4584.7139s
Epoch: 31 cost time: 69.71550941467285
Epoch: 31, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.324 Vali Acc: 0.976 Test Loss: 0.324 Test Acc: 0.976
Validation loss decreased (-0.974982 --> -0.976350).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.3382s/iter; left time: 9605.1068s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.1615s/iter; left time: 4570.4148s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.1494s/iter; left time: 4213.2736s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.1568s/iter; left time: 4407.1123s
Epoch: 32 cost time: 66.93864631652832
Epoch: 32, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.530 Vali Acc: 0.967 Test Loss: 0.530 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.3160s/iter; left time: 8842.5598s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.1735s/iter; left time: 4838.0969s
	iters: 300, epoch: 33 | loss: 0.0000076
	speed: 0.1729s/iter; left time: 4803.8965s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.1756s/iter; left time: 4860.9712s
Epoch: 33 cost time: 69.96351623535156
Epoch: 33, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.595 Vali Acc: 0.968 Test Loss: 0.595 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.3329s/iter; left time: 9177.4173s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.1675s/iter; left time: 4600.1940s
	iters: 300, epoch: 34 | loss: 0.0000018
	speed: 0.1733s/iter; left time: 4742.4699s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.1662s/iter; left time: 4531.6945s
Epoch: 34 cost time: 68.94122242927551
Epoch: 34, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.594 Vali Acc: 0.972 Test Loss: 0.594 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0088145
	speed: 0.3296s/iter; left time: 8952.5675s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.1606s/iter; left time: 4346.9911s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.1675s/iter; left time: 4514.3136s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.1684s/iter; left time: 4523.5234s
Epoch: 35 cost time: 67.83961343765259
Epoch: 35, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.678 Vali Acc: 0.965 Test Loss: 0.678 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.3143s/iter; left time: 8407.2520s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.1295s/iter; left time: 3450.6353s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.1393s/iter; left time: 3698.0926s
	iters: 400, epoch: 36 | loss: 0.0000281
	speed: 0.1374s/iter; left time: 3633.2859s
Epoch: 36 cost time: 57.66635584831238
Epoch: 36, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.443 Vali Acc: 0.977 Test Loss: 0.443 Test Acc: 0.977
Validation loss decreased (-0.976350 --> -0.976803).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0000041
	speed: 0.2806s/iter; left time: 7388.0193s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.1384s/iter; left time: 3631.5746s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.1098s/iter; left time: 2870.2711s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.1045s/iter; left time: 2721.3869s
Epoch: 37 cost time: 50.144293546676636
Epoch: 37, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.507 Vali Acc: 0.973 Test Loss: 0.507 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2793s/iter; left time: 7239.3243s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.1112s/iter; left time: 2872.0198s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.1057s/iter; left time: 2718.3098s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.1129s/iter; left time: 2892.9343s
Epoch: 38 cost time: 47.41069221496582
Epoch: 38, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.472 Vali Acc: 0.971 Test Loss: 0.472 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.2467s/iter; left time: 6292.9655s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0903s/iter; left time: 2293.5453s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.1256s/iter; left time: 3178.3708s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.1450s/iter; left time: 3653.8102s
Epoch: 39 cost time: 47.95587372779846
Epoch: 39, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.674 Vali Acc: 0.967 Test Loss: 0.674 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.2959s/iter; left time: 7424.6514s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.1175s/iter; left time: 2936.3653s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.1195s/iter; left time: 2974.7631s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.1278s/iter; left time: 3168.0779s
Epoch: 40 cost time: 52.1010217666626
Epoch: 40, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.692 Vali Acc: 0.970 Test Loss: 0.692 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0000001
	speed: 0.2644s/iter; left time: 6526.5003s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.1331s/iter; left time: 3272.4632s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.1474s/iter; left time: 3608.0160s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.1513s/iter; left time: 3688.1500s
Epoch: 41 cost time: 58.06783175468445
Epoch: 41, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.693 Vali Acc: 0.969 Test Loss: 0.693 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.3063s/iter; left time: 7433.6556s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.1356s/iter; left time: 3277.1319s
	iters: 300, epoch: 42 | loss: 0.0066502
	speed: 0.1435s/iter; left time: 3453.1428s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.1359s/iter; left time: 3257.2910s
Epoch: 42 cost time: 58.808926582336426
Epoch: 42, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.408 Vali Acc: 0.975 Test Loss: 0.408 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.2875s/iter; left time: 6858.4106s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.1409s/iter; left time: 3346.2815s
	iters: 300, epoch: 43 | loss: 0.0000000
	speed: 0.1415s/iter; left time: 3347.4226s
	iters: 400, epoch: 43 | loss: 0.3590167
	speed: 0.1355s/iter; left time: 3191.3458s
Epoch: 43 cost time: 57.78394412994385
Epoch: 43, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.576 Vali Acc: 0.975 Test Loss: 0.576 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.2852s/iter; left time: 6684.6674s
	iters: 200, epoch: 44 | loss: 1.9311452
	speed: 0.1165s/iter; left time: 2719.4434s
	iters: 300, epoch: 44 | loss: 1.4140140
	speed: 0.1119s/iter; left time: 2600.6940s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.1211s/iter; left time: 2803.4249s
Epoch: 44 cost time: 50.87893319129944
Epoch: 44, Steps: 413 | Train Loss: 0.060 Vali Loss: 1.109 Vali Acc: 0.942 Test Loss: 1.109 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.0000000
	speed: 0.2793s/iter; left time: 6432.0742s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.1321s/iter; left time: 3028.2394s
	iters: 300, epoch: 45 | loss: 0.0000000
	speed: 0.1477s/iter; left time: 3371.8689s
	iters: 400, epoch: 45 | loss: 0.0000000
	speed: 0.1517s/iter; left time: 3448.8430s
Epoch: 45 cost time: 58.49738097190857
Epoch: 45, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.628 Vali Acc: 0.970 Test Loss: 0.628 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.0000000
	speed: 0.2844s/iter; left time: 6431.8856s
	iters: 200, epoch: 46 | loss: 0.0000000
	speed: 0.1343s/iter; left time: 3024.1636s
	iters: 300, epoch: 46 | loss: 0.0000000
	speed: 0.1398s/iter; left time: 3133.1942s
	iters: 400, epoch: 46 | loss: 0.0000019
	speed: 0.1387s/iter; left time: 3095.4028s
Epoch: 46 cost time: 56.55504536628723
Epoch: 46, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.495 Vali Acc: 0.976 Test Loss: 0.495 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9768076398362893
model parameter : 408330
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5576054
	speed: 0.1620s/iter; left time: 6673.2959s
	iters: 200, epoch: 1 | loss: 0.0373385
	speed: 0.1342s/iter; left time: 5515.7239s
	iters: 300, epoch: 1 | loss: 0.2980179
	speed: 0.1366s/iter; left time: 5600.2065s
	iters: 400, epoch: 1 | loss: 0.2161833
	speed: 0.1025s/iter; left time: 4193.0586s
Epoch: 1 cost time: 55.16686773300171
Epoch: 1, Steps: 413 | Train Loss: 0.341 Vali Loss: 0.195 Vali Acc: 0.946 Test Loss: 0.195 Test Acc: 0.946
Validation loss decreased (inf --> -0.945883).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0121025
	speed: 0.2098s/iter; left time: 8556.9308s
	iters: 200, epoch: 2 | loss: 0.0325004
	speed: 0.0961s/iter; left time: 3910.0144s
	iters: 300, epoch: 2 | loss: 0.0002840
	speed: 0.1007s/iter; left time: 4088.1857s
	iters: 400, epoch: 2 | loss: 0.1342766
	speed: 0.0872s/iter; left time: 3531.6168s
Epoch: 2 cost time: 38.52928924560547
Epoch: 2, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.274 Vali Acc: 0.933 Test Loss: 0.274 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0204773
	speed: 0.2228s/iter; left time: 8996.2108s
	iters: 200, epoch: 3 | loss: 0.0000967
	speed: 0.0896s/iter; left time: 3609.8988s
	iters: 300, epoch: 3 | loss: 0.0000687
	speed: 0.0885s/iter; left time: 3553.8857s
	iters: 400, epoch: 3 | loss: 0.5219955
	speed: 0.0915s/iter; left time: 3665.6144s
Epoch: 3 cost time: 39.076268911361694
Epoch: 3, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.189 Vali Acc: 0.968 Test Loss: 0.189 Test Acc: 0.968
Validation loss decreased (-0.945883 --> -0.968165).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0001550
	speed: 0.2128s/iter; left time: 8504.0673s
	iters: 200, epoch: 4 | loss: 0.0012066
	speed: 0.0954s/iter; left time: 3803.6481s
	iters: 300, epoch: 4 | loss: 0.0222312
	speed: 0.0908s/iter; left time: 3611.6960s
	iters: 400, epoch: 4 | loss: 0.0022782
	speed: 0.1019s/iter; left time: 4043.2025s
Epoch: 4 cost time: 39.78907489776611
Epoch: 4, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.399 Vali Acc: 0.936 Test Loss: 0.399 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0051947
	speed: 0.2257s/iter; left time: 8928.1578s
	iters: 200, epoch: 5 | loss: 0.0071746
	speed: 0.0968s/iter; left time: 3818.2429s
	iters: 300, epoch: 5 | loss: 0.0000089
	speed: 0.0882s/iter; left time: 3469.6673s
	iters: 400, epoch: 5 | loss: 0.0002998
	speed: 0.0788s/iter; left time: 3093.0556s
Epoch: 5 cost time: 38.611154317855835
Epoch: 5, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.321 Vali Acc: 0.966 Test Loss: 0.321 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0597772
	speed: 0.2345s/iter; left time: 9176.7898s
	iters: 200, epoch: 6 | loss: 0.3109174
	speed: 0.1013s/iter; left time: 3956.0041s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0976s/iter; left time: 3801.7098s
	iters: 400, epoch: 6 | loss: 0.2190535
	speed: 0.1000s/iter; left time: 3884.6944s
Epoch: 6 cost time: 42.7438268661499
Epoch: 6, Steps: 413 | Train Loss: 0.114 Vali Loss: 1.066 Vali Acc: 0.912 Test Loss: 1.066 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000004
	speed: 0.2063s/iter; left time: 7988.3515s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0829s/iter; left time: 3202.0618s
	iters: 300, epoch: 7 | loss: 0.0000026
	speed: 0.1348s/iter; left time: 5193.1428s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.1271s/iter; left time: 4885.4437s
Epoch: 7 cost time: 45.8446307182312
Epoch: 7, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.278 Vali Acc: 0.972 Test Loss: 0.278 Test Acc: 0.972
Validation loss decreased (-0.968165 --> -0.971803).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000082
	speed: 0.2520s/iter; left time: 9655.4305s
	iters: 200, epoch: 8 | loss: 0.6470841
	speed: 0.1299s/iter; left time: 4961.9869s
	iters: 300, epoch: 8 | loss: 0.0000012
	speed: 0.1187s/iter; left time: 4525.2388s
	iters: 400, epoch: 8 | loss: 0.0000003
	speed: 0.1237s/iter; left time: 4702.1287s
Epoch: 8 cost time: 51.057987689971924
Epoch: 8, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.391 Vali Acc: 0.970 Test Loss: 0.391 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000308
	speed: 0.2463s/iter; left time: 9334.5600s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1345s/iter; left time: 5085.3096s
	iters: 300, epoch: 9 | loss: 0.0000822
	speed: 0.1320s/iter; left time: 4977.8863s
	iters: 400, epoch: 9 | loss: 0.0006341
	speed: 0.1261s/iter; left time: 4739.2971s
Epoch: 9 cost time: 53.300299644470215
Epoch: 9, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.314 Vali Acc: 0.967 Test Loss: 0.314 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0015086
	speed: 0.2520s/iter; left time: 9446.7551s
	iters: 200, epoch: 10 | loss: 0.0000242
	speed: 0.1385s/iter; left time: 5178.6318s
	iters: 300, epoch: 10 | loss: 0.0000004
	speed: 0.1279s/iter; left time: 4770.0775s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1244s/iter; left time: 4626.6022s
Epoch: 10 cost time: 54.151687145233154
Epoch: 10, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.261 Vali Acc: 0.973 Test Loss: 0.261 Test Acc: 0.973
Validation loss decreased (-0.971803 --> -0.973167).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2482s/iter; left time: 9202.4945s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1250s/iter; left time: 4619.7488s
	iters: 300, epoch: 11 | loss: 0.2561502
	speed: 0.1210s/iter; left time: 4459.9906s
	iters: 400, epoch: 11 | loss: 1.1179081
	speed: 0.1285s/iter; left time: 4723.4554s
Epoch: 11 cost time: 51.99052357673645
Epoch: 11, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.516 Vali Acc: 0.968 Test Loss: 0.516 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000010
	speed: 0.2513s/iter; left time: 9213.3539s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1235s/iter; left time: 4515.4847s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1413s/iter; left time: 5151.8063s
	iters: 400, epoch: 12 | loss: 1.3868051
	speed: 0.1402s/iter; left time: 5098.9474s
Epoch: 12 cost time: 55.1904661655426
Epoch: 12, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.544 Vali Acc: 0.960 Test Loss: 0.544 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2519s/iter; left time: 9131.5802s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1249s/iter; left time: 4514.4591s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1225s/iter; left time: 4414.7299s
	iters: 400, epoch: 13 | loss: 0.0000002
	speed: 0.1265s/iter; left time: 4547.9776s
Epoch: 13 cost time: 50.84998106956482
Epoch: 13, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.495 Vali Acc: 0.960 Test Loss: 0.495 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.2527s/iter; left time: 9055.0892s
	iters: 200, epoch: 14 | loss: 0.5917584
	speed: 0.0979s/iter; left time: 3497.9806s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0825s/iter; left time: 2938.2010s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0929s/iter; left time: 3300.6669s
Epoch: 14 cost time: 41.48300838470459
Epoch: 14, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.591 Vali Acc: 0.961 Test Loss: 0.591 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2001s/iter; left time: 7087.6240s
	iters: 200, epoch: 15 | loss: 0.1473076
	speed: 0.0736s/iter; left time: 2598.4490s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0899s/iter; left time: 3165.0220s
	iters: 400, epoch: 15 | loss: 0.0001613
	speed: 0.0833s/iter; left time: 2925.7174s
Epoch: 15 cost time: 34.80921530723572
Epoch: 15, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.331 Vali Acc: 0.970 Test Loss: 0.331 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000004
	speed: 0.2010s/iter; left time: 7034.6258s
	iters: 200, epoch: 16 | loss: 0.0000013
	speed: 0.1260s/iter; left time: 4398.3564s
	iters: 300, epoch: 16 | loss: 0.0006280
	speed: 0.1062s/iter; left time: 3697.5966s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1095s/iter; left time: 3800.0287s
Epoch: 16 cost time: 44.83711004257202
Epoch: 16, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.372 Vali Acc: 0.971 Test Loss: 0.372 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.2102147
	speed: 0.2503s/iter; left time: 8660.2479s
	iters: 200, epoch: 17 | loss: 0.0000382
	speed: 0.1106s/iter; left time: 3814.8842s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1181s/iter; left time: 4060.6901s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1212s/iter; left time: 4157.7593s
Epoch: 17 cost time: 48.91970109939575
Epoch: 17, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.440 Vali Acc: 0.972 Test Loss: 0.440 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.2158s/iter; left time: 7375.7495s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1177s/iter; left time: 4010.6989s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1157s/iter; left time: 3929.9204s
	iters: 400, epoch: 18 | loss: 0.0000051
	speed: 0.1160s/iter; left time: 3929.4487s
Epoch: 18 cost time: 46.44467830657959
Epoch: 18, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.529 Vali Acc: 0.972 Test Loss: 0.529 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2442s/iter; left time: 8246.9521s
	iters: 200, epoch: 19 | loss: 0.6023147
	speed: 0.1199s/iter; left time: 4037.1051s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1197s/iter; left time: 4016.5603s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1453s/iter; left time: 4863.8703s
Epoch: 19 cost time: 52.43472671508789
Epoch: 19, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.421 Vali Acc: 0.972 Test Loss: 0.421 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.3034s/iter; left time: 10120.9494s
	iters: 200, epoch: 20 | loss: 0.0000049
	speed: 0.1536s/iter; left time: 5106.1606s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.1562s/iter; left time: 5179.0593s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.1318s/iter; left time: 4356.5748s
Epoch: 20 cost time: 63.20190763473511
Epoch: 20, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.465 Vali Acc: 0.976 Test Loss: 0.465 Test Acc: 0.976
Validation loss decreased (-0.973167 --> -0.976348).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2839s/iter; left time: 9350.4016s
	iters: 200, epoch: 21 | loss: 0.0120106
	speed: 0.1505s/iter; left time: 4942.8492s
	iters: 300, epoch: 21 | loss: 0.0000050
	speed: 0.1514s/iter; left time: 4956.7971s
	iters: 400, epoch: 21 | loss: 0.0001189
	speed: 0.1526s/iter; left time: 4979.6200s
Epoch: 21 cost time: 62.335299253463745
Epoch: 21, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.666 Vali Acc: 0.950 Test Loss: 0.666 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2768s/iter; left time: 9004.3317s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1404s/iter; left time: 4552.3914s
	iters: 300, epoch: 22 | loss: 0.0001858
	speed: 0.1485s/iter; left time: 4800.0692s
	iters: 400, epoch: 22 | loss: 0.6523864
	speed: 0.1486s/iter; left time: 4788.8134s
Epoch: 22 cost time: 60.38789439201355
Epoch: 22, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.748 Vali Acc: 0.953 Test Loss: 0.748 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0820813
	speed: 0.2827s/iter; left time: 9080.3348s
	iters: 200, epoch: 23 | loss: 0.0003517
	speed: 0.1497s/iter; left time: 4792.7647s
	iters: 300, epoch: 23 | loss: 1.1480778
	speed: 0.1537s/iter; left time: 4904.3287s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1474s/iter; left time: 4689.7562s
Epoch: 23 cost time: 61.59025239944458
Epoch: 23, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.717 Vali Acc: 0.960 Test Loss: 0.717 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2644s/iter; left time: 8382.2658s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.1374s/iter; left time: 4343.1091s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.1408s/iter; left time: 4436.8122s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.1366s/iter; left time: 4289.1522s
Epoch: 24 cost time: 57.46538805961609
Epoch: 24, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.363 Vali Acc: 0.973 Test Loss: 0.363 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0001367
	speed: 0.2705s/iter; left time: 8464.4737s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.1369s/iter; left time: 4268.2164s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.1348s/iter; left time: 4189.9437s
	iters: 400, epoch: 25 | loss: 0.0000079
	speed: 0.1276s/iter; left time: 3954.2834s
Epoch: 25 cost time: 56.24078297615051
Epoch: 25, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.522 Vali Acc: 0.969 Test Loss: 0.522 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2559s/iter; left time: 7901.2484s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.1274s/iter; left time: 3921.8808s
	iters: 300, epoch: 26 | loss: 0.0000002
	speed: 0.1399s/iter; left time: 4292.6464s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.1391s/iter; left time: 4251.6689s
Epoch: 26 cost time: 55.65192246437073
Epoch: 26, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.616 Vali Acc: 0.966 Test Loss: 0.616 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2354s/iter; left time: 7171.6869s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.1004s/iter; left time: 3049.5554s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0943s/iter; left time: 2852.7704s
	iters: 400, epoch: 27 | loss: 0.0000087
	speed: 0.1023s/iter; left time: 3084.3117s
Epoch: 27 cost time: 42.376002073287964
Epoch: 27, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.246 Vali Acc: 0.977 Test Loss: 0.246 Test Acc: 0.977
Validation loss decreased (-0.976348 --> -0.977260).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2151s/iter; left time: 6464.7941s
	iters: 200, epoch: 28 | loss: 0.0083284
	speed: 0.0860s/iter; left time: 2575.1526s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0804s/iter; left time: 2398.6348s
	iters: 400, epoch: 28 | loss: 0.0988929
	speed: 0.0961s/iter; left time: 2859.0885s
Epoch: 28 cost time: 37.68580627441406
Epoch: 28, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.390 Vali Acc: 0.973 Test Loss: 0.390 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2189s/iter; left time: 6486.6403s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0959s/iter; left time: 2831.7862s
	iters: 300, epoch: 29 | loss: 0.0000008
	speed: 0.0975s/iter; left time: 2871.0771s
	iters: 400, epoch: 29 | loss: 0.0003546
	speed: 0.0913s/iter; left time: 2677.0790s
Epoch: 29 cost time: 40.65769624710083
Epoch: 29, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.507 Vali Acc: 0.973 Test Loss: 0.507 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2297s/iter; left time: 6711.8277s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.1099s/iter; left time: 3200.9451s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0986s/iter; left time: 2861.0032s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.1045s/iter; left time: 3021.9955s
Epoch: 30 cost time: 44.14032220840454
Epoch: 30, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.330 Vali Acc: 0.976 Test Loss: 0.330 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2115s/iter; left time: 6094.5309s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0943s/iter; left time: 2706.2108s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0936s/iter; left time: 2679.1292s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0769s/iter; left time: 2191.9247s
Epoch: 31 cost time: 37.55961894989014
Epoch: 31, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.552 Vali Acc: 0.971 Test Loss: 0.552 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1894s/iter; left time: 5379.7382s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0962s/iter; left time: 2720.9264s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 2567.7748s
	iters: 400, epoch: 32 | loss: 0.0000003
	speed: 0.1189s/iter; left time: 3342.1892s
Epoch: 32 cost time: 41.188079833984375
Epoch: 32, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.434 Vali Acc: 0.970 Test Loss: 0.434 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0000857
	speed: 0.2377s/iter; left time: 6650.9184s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.1170s/iter; left time: 3261.2650s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.1191s/iter; left time: 3309.2989s
	iters: 400, epoch: 33 | loss: 0.0164261
	speed: 0.1149s/iter; left time: 3181.3520s
Epoch: 33 cost time: 49.052955627441406
Epoch: 33, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.581 Vali Acc: 0.975 Test Loss: 0.581 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2452s/iter; left time: 6761.5453s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.1196s/iter; left time: 3285.0820s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.1156s/iter; left time: 3164.6440s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.1169s/iter; left time: 3187.5398s
Epoch: 34 cost time: 49.7931010723114
Epoch: 34, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.653 Vali Acc: 0.966 Test Loss: 0.653 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2313s/iter; left time: 6281.6967s
	iters: 200, epoch: 35 | loss: 0.0000005
	speed: 0.1151s/iter; left time: 3114.2341s
	iters: 300, epoch: 35 | loss: 0.0000052
	speed: 0.1086s/iter; left time: 2928.9263s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.1076s/iter; left time: 2890.7445s
Epoch: 35 cost time: 46.34155774116516
Epoch: 35, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.879 Vali Acc: 0.963 Test Loss: 0.879 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0011513
	speed: 0.2345s/iter; left time: 6272.0336s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.1124s/iter; left time: 2995.2409s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.1102s/iter; left time: 2924.4913s
	iters: 400, epoch: 36 | loss: 0.2683594
	speed: 0.1120s/iter; left time: 2962.5110s
Epoch: 36 cost time: 46.73585391044617
Epoch: 36, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.811 Vali Acc: 0.963 Test Loss: 0.811 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.2234s/iter; left time: 5881.8018s
	iters: 200, epoch: 37 | loss: 0.6591063
	speed: 0.1109s/iter; left time: 2909.0756s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.1081s/iter; left time: 2824.8875s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.1151s/iter; left time: 2995.6909s
Epoch: 37 cost time: 45.8129448890686
Epoch: 37, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.398 Vali Acc: 0.979 Test Loss: 0.398 Test Acc: 0.979
Validation loss decreased (-0.977260 --> -0.979077).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2399s/iter; left time: 6217.4478s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.1168s/iter; left time: 3016.1448s
	iters: 300, epoch: 38 | loss: 0.0000846
	speed: 0.1156s/iter; left time: 2974.3938s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.1253s/iter; left time: 3210.8405s
Epoch: 38 cost time: 49.99467921257019
Epoch: 38, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.500 Vali Acc: 0.969 Test Loss: 0.500 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.0276335
	speed: 0.2531s/iter; left time: 6456.2955s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.1084s/iter; left time: 2754.3636s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0938s/iter; left time: 2373.8563s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0994s/iter; left time: 2506.4358s
Epoch: 39 cost time: 44.415481090545654
Epoch: 39, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.434 Vali Acc: 0.975 Test Loss: 0.434 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.1999s/iter; left time: 5016.3934s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0887s/iter; left time: 2217.8105s
	iters: 300, epoch: 40 | loss: 0.0000252
	speed: 0.0856s/iter; left time: 2131.9811s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0918s/iter; left time: 2276.2165s
Epoch: 40 cost time: 36.819735050201416
Epoch: 40, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.408 Vali Acc: 0.976 Test Loss: 0.408 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.1942s/iter; left time: 4792.6623s
	iters: 200, epoch: 41 | loss: 0.0000001
	speed: 0.0941s/iter; left time: 2313.9044s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0913s/iter; left time: 2233.9708s
	iters: 400, epoch: 41 | loss: 0.5402108
	speed: 0.0819s/iter; left time: 1996.8030s
Epoch: 41 cost time: 36.54173040390015
Epoch: 41, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.391 Vali Acc: 0.975 Test Loss: 0.391 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.1840s/iter; left time: 4465.7202s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 1907.1466s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0752s/iter; left time: 1810.8463s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0801s/iter; left time: 1920.5153s
Epoch: 42 cost time: 32.277878522872925
Epoch: 42, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.491 Vali Acc: 0.975 Test Loss: 0.491 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 43 | loss: 0.0000061
	speed: 0.1904s/iter; left time: 4542.4470s
	iters: 200, epoch: 43 | loss: 0.0000138
	speed: 0.0782s/iter; left time: 1857.5825s
	iters: 300, epoch: 43 | loss: 0.6613352
	speed: 0.0859s/iter; left time: 2032.3096s
	iters: 400, epoch: 43 | loss: 0.3361562
	speed: 0.0852s/iter; left time: 2006.5001s
Epoch: 43 cost time: 34.38367962837219
Epoch: 43, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.387 Vali Acc: 0.978 Test Loss: 0.387 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.2081s/iter; left time: 4877.5570s
	iters: 200, epoch: 44 | loss: 0.0000006
	speed: 0.0860s/iter; left time: 2007.5464s
	iters: 300, epoch: 44 | loss: 0.0055778
	speed: 0.0822s/iter; left time: 1911.6041s
	iters: 400, epoch: 44 | loss: 0.0005306
	speed: 0.0813s/iter; left time: 1881.1924s
Epoch: 44 cost time: 35.45402765274048
Epoch: 44, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.460 Vali Acc: 0.974 Test Loss: 0.460 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 45 | loss: 0.0002679
	speed: 0.2141s/iter; left time: 4930.8466s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.1079s/iter; left time: 2473.9350s
	iters: 300, epoch: 45 | loss: 0.0000000
	speed: 0.1110s/iter; left time: 2534.3178s
	iters: 400, epoch: 45 | loss: 0.0000001
	speed: 0.1105s/iter; left time: 2511.4015s
Epoch: 45 cost time: 45.72421336174011
Epoch: 45, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.448 Vali Acc: 0.974 Test Loss: 0.448 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 46 | loss: 0.0000000
	speed: 0.2459s/iter; left time: 5561.5842s
	iters: 200, epoch: 46 | loss: 0.0000000
	speed: 0.1138s/iter; left time: 2561.7485s
	iters: 300, epoch: 46 | loss: 0.0000000
	speed: 0.1122s/iter; left time: 2514.3288s
	iters: 400, epoch: 46 | loss: 0.0000000
	speed: 0.1196s/iter; left time: 2669.1317s
Epoch: 46 cost time: 48.763630628585815
Epoch: 46, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.442 Vali Acc: 0.968 Test Loss: 0.442 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 47 | loss: 0.0000000
	speed: 0.2344s/iter; left time: 5204.0285s
	iters: 200, epoch: 47 | loss: 0.0000000
	speed: 0.1185s/iter; left time: 2619.4262s
	iters: 300, epoch: 47 | loss: 0.0000000
	speed: 0.1140s/iter; left time: 2508.4735s
	iters: 400, epoch: 47 | loss: 0.0000000
	speed: 0.1286s/iter; left time: 2816.7041s
Epoch: 47 cost time: 50.08267307281494
Epoch: 47, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.474 Vali Acc: 0.975 Test Loss: 0.474 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
model parameter : 341898
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3776232
	speed: 0.1434s/iter; left time: 5908.2202s
	iters: 200, epoch: 1 | loss: 0.0910735
	speed: 0.1253s/iter; left time: 5151.7643s
	iters: 300, epoch: 1 | loss: 0.0172747
	speed: 0.1239s/iter; left time: 5080.9680s
	iters: 400, epoch: 1 | loss: 0.0517879
	speed: 0.1257s/iter; left time: 5139.3838s
Epoch: 1 cost time: 53.54684853553772
Epoch: 1, Steps: 413 | Train Loss: 0.346 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (inf --> -0.948156).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0058255
	speed: 0.2480s/iter; left time: 10114.7976s
	iters: 200, epoch: 2 | loss: 0.0070181
	speed: 0.1188s/iter; left time: 4835.5271s
	iters: 300, epoch: 2 | loss: 0.0036727
	speed: 0.1237s/iter; left time: 5021.3228s
	iters: 400, epoch: 2 | loss: 0.0004233
	speed: 0.1211s/iter; left time: 4903.3456s
Epoch: 2 cost time: 50.65890121459961
Epoch: 2, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
Validation loss decreased (-0.948156 --> -0.970895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0011751
	speed: 0.2401s/iter; left time: 9692.7125s
	iters: 200, epoch: 3 | loss: 0.1531685
	speed: 0.1099s/iter; left time: 4424.6234s
	iters: 300, epoch: 3 | loss: 0.0001950
	speed: 0.1064s/iter; left time: 4273.6009s
	iters: 400, epoch: 3 | loss: 0.0451048
	speed: 0.1125s/iter; left time: 4507.0437s
Epoch: 3 cost time: 46.38677763938904
Epoch: 3, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0004936
	speed: 0.2541s/iter; left time: 10154.4292s
	iters: 200, epoch: 4 | loss: 0.4733269
	speed: 0.1434s/iter; left time: 5717.8023s
	iters: 300, epoch: 4 | loss: 0.6693264
	speed: 0.1264s/iter; left time: 5027.7272s
	iters: 400, epoch: 4 | loss: 0.1805262
	speed: 0.0984s/iter; left time: 3903.0935s
Epoch: 4 cost time: 52.93548822402954
Epoch: 4, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.217 Vali Acc: 0.962 Test Loss: 0.217 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000862
	speed: 0.2348s/iter; left time: 9285.8344s
	iters: 200, epoch: 5 | loss: 0.3492097
	speed: 0.1244s/iter; left time: 4908.3428s
	iters: 300, epoch: 5 | loss: 0.0000001
	speed: 0.0844s/iter; left time: 3319.4029s
	iters: 400, epoch: 5 | loss: 0.0007532
	speed: 0.0862s/iter; left time: 3384.1154s
Epoch: 5 cost time: 42.09243035316467
Epoch: 5, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.112 Vali Acc: 0.985 Test Loss: 0.112 Test Acc: 0.985
Validation loss decreased (-0.970895 --> -0.984537).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2173s/iter; left time: 8503.6563s
	iters: 200, epoch: 6 | loss: 0.0306713
	speed: 0.1149s/iter; left time: 4486.2647s
	iters: 300, epoch: 6 | loss: 0.0407729
	speed: 0.1032s/iter; left time: 4019.2847s
	iters: 400, epoch: 6 | loss: 0.2359533
	speed: 0.1213s/iter; left time: 4709.4244s
Epoch: 6 cost time: 45.27379322052002
Epoch: 6, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000008
	speed: 0.2276s/iter; left time: 8813.5492s
	iters: 200, epoch: 7 | loss: 0.0000003
	speed: 0.0905s/iter; left time: 3496.9044s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0824s/iter; left time: 3172.9612s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0931s/iter; left time: 3576.9556s
Epoch: 7 cost time: 40.15130352973938
Epoch: 7, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.222 Vali Acc: 0.966 Test Loss: 0.222 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0033038
	speed: 0.2268s/iter; left time: 8688.6560s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1130s/iter; left time: 4317.7675s
	iters: 300, epoch: 8 | loss: 0.2139136
	speed: 0.1222s/iter; left time: 4655.1531s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0815s/iter; left time: 3098.5254s
Epoch: 8 cost time: 44.0412483215332
Epoch: 8, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.536 Vali Acc: 0.955 Test Loss: 0.536 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.2188s/iter; left time: 8291.4976s
	iters: 200, epoch: 9 | loss: 0.4591562
	speed: 0.1104s/iter; left time: 4172.5152s
	iters: 300, epoch: 9 | loss: 0.0002660
	speed: 0.1170s/iter; left time: 4409.5320s
	iters: 400, epoch: 9 | loss: 1.2463986
	speed: 0.0992s/iter; left time: 3730.0486s
Epoch: 9 cost time: 44.95838665962219
Epoch: 9, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.509 Vali Acc: 0.943 Test Loss: 0.509 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2209s/iter; left time: 8279.7319s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1374s/iter; left time: 5137.7748s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.1197s/iter; left time: 4462.4250s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1229s/iter; left time: 4568.8186s
Epoch: 10 cost time: 50.440913438797
Epoch: 10, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.416 Vali Acc: 0.970 Test Loss: 0.416 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0020713
	speed: 0.2494s/iter; left time: 9244.5173s
	iters: 200, epoch: 11 | loss: 0.9405225
	speed: 0.1184s/iter; left time: 4376.7506s
	iters: 300, epoch: 11 | loss: 0.0672792
	speed: 0.1295s/iter; left time: 4773.3362s
	iters: 400, epoch: 11 | loss: 0.0133509
	speed: 0.1198s/iter; left time: 4405.4121s
Epoch: 11 cost time: 51.370168685913086
Epoch: 11, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.568 Vali Acc: 0.964 Test Loss: 0.568 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2359s/iter; left time: 8647.7458s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1193s/iter; left time: 4362.4686s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1156s/iter; left time: 4215.4979s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1246s/iter; left time: 4530.8543s
Epoch: 12 cost time: 49.64259457588196
Epoch: 12, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.527 Vali Acc: 0.961 Test Loss: 0.527 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.2513s/iter; left time: 9107.1722s
	iters: 200, epoch: 13 | loss: 0.0001778
	speed: 0.1256s/iter; left time: 4541.1979s
	iters: 300, epoch: 13 | loss: 0.0003599
	speed: 0.1306s/iter; left time: 4706.7216s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1223s/iter; left time: 4395.6451s
Epoch: 13 cost time: 52.94414186477661
Epoch: 13, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.341 Vali Acc: 0.971 Test Loss: 0.341 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2445s/iter; left time: 8759.7441s
	iters: 200, epoch: 14 | loss: 0.0000107
	speed: 0.1260s/iter; left time: 4502.6222s
	iters: 300, epoch: 14 | loss: 0.0000687
	speed: 0.1261s/iter; left time: 4493.8701s
	iters: 400, epoch: 14 | loss: 0.0000086
	speed: 0.1204s/iter; left time: 4278.8895s
Epoch: 14 cost time: 52.15718340873718
Epoch: 14, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.368 Vali Acc: 0.969 Test Loss: 0.368 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000137
	speed: 0.2522s/iter; left time: 8932.4560s
	iters: 200, epoch: 15 | loss: 0.0000203
	speed: 0.1373s/iter; left time: 4849.1985s
	iters: 300, epoch: 15 | loss: 0.3722624
	speed: 0.1469s/iter; left time: 5172.9675s
	iters: 400, epoch: 15 | loss: 0.0035217
	speed: 0.1369s/iter; left time: 4806.5323s
Epoch: 15 cost time: 57.933693170547485
Epoch: 15, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.312 Vali Acc: 0.975 Test Loss: 0.312 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 300490
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3447056
	speed: 0.1458s/iter; left time: 6005.8642s
	iters: 200, epoch: 1 | loss: 0.0166272
	speed: 0.1273s/iter; left time: 5231.1006s
	iters: 300, epoch: 1 | loss: 0.0097173
	speed: 0.1298s/iter; left time: 5319.9932s
	iters: 400, epoch: 1 | loss: 0.0161452
	speed: 0.1291s/iter; left time: 5281.8250s
Epoch: 1 cost time: 54.80003571510315
Epoch: 1, Steps: 413 | Train Loss: 0.352 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
Validation loss decreased (inf --> -0.958616).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0186440
	speed: 0.1658s/iter; left time: 6763.3928s
	iters: 200, epoch: 2 | loss: 0.2928188
	speed: 0.0982s/iter; left time: 3997.1801s
	iters: 300, epoch: 2 | loss: 0.0043968
	speed: 0.0876s/iter; left time: 3556.4226s
	iters: 400, epoch: 2 | loss: 0.0034211
	speed: 0.0865s/iter; left time: 3503.4515s
Epoch: 2 cost time: 35.55780506134033
Epoch: 2, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
Validation loss decreased (-0.958616 --> -0.969075).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4162124
	speed: 0.2051s/iter; left time: 8282.8391s
	iters: 200, epoch: 3 | loss: 0.1766908
	speed: 0.0885s/iter; left time: 3562.3560s
	iters: 300, epoch: 3 | loss: 0.0006430
	speed: 0.0947s/iter; left time: 3805.1433s
	iters: 400, epoch: 3 | loss: 0.0000063
	speed: 0.0788s/iter; left time: 3158.5341s
Epoch: 3 cost time: 36.545045375823975
Epoch: 3, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000107
	speed: 0.1821s/iter; left time: 7275.4441s
	iters: 200, epoch: 4 | loss: 0.2699887
	speed: 0.1104s/iter; left time: 4399.9392s
	iters: 300, epoch: 4 | loss: 0.0001114
	speed: 0.0962s/iter; left time: 3823.9840s
	iters: 400, epoch: 4 | loss: 0.0504188
	speed: 0.1046s/iter; left time: 4147.3945s
Epoch: 4 cost time: 41.11097598075867
Epoch: 4, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1779373
	speed: 0.2031s/iter; left time: 8032.4453s
	iters: 200, epoch: 5 | loss: 0.4012584
	speed: 0.1116s/iter; left time: 4402.2314s
	iters: 300, epoch: 5 | loss: 0.0036880
	speed: 0.0956s/iter; left time: 3761.8214s
	iters: 400, epoch: 5 | loss: 0.0000155
	speed: 0.0955s/iter; left time: 3748.6692s
Epoch: 5 cost time: 41.50016140937805
Epoch: 5, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.186 Vali Acc: 0.971 Test Loss: 0.186 Test Acc: 0.971
Validation loss decreased (-0.969075 --> -0.971349).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0005431
	speed: 0.1867s/iter; left time: 7304.9886s
	iters: 200, epoch: 6 | loss: 0.3474452
	speed: 0.0954s/iter; left time: 3724.6822s
	iters: 300, epoch: 6 | loss: 0.3853759
	speed: 0.0815s/iter; left time: 3172.3536s
	iters: 400, epoch: 6 | loss: 0.0000001
	speed: 0.0792s/iter; left time: 3076.6913s
Epoch: 6 cost time: 35.31923866271973
Epoch: 6, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.265 Vali Acc: 0.960 Test Loss: 0.265 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.7157782
	speed: 0.1758s/iter; left time: 6805.9262s
	iters: 200, epoch: 7 | loss: 0.0000293
	speed: 0.0836s/iter; left time: 3230.4808s
	iters: 300, epoch: 7 | loss: 0.0000009
	speed: 0.0683s/iter; left time: 2629.3547s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 2520.5163s
Epoch: 7 cost time: 31.75916075706482
Epoch: 7, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.348 Vali Acc: 0.959 Test Loss: 0.348 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0854867
	speed: 0.2128s/iter; left time: 8151.8560s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1122s/iter; left time: 4285.5051s
	iters: 300, epoch: 8 | loss: 0.0000377
	speed: 0.1065s/iter; left time: 4059.3039s
	iters: 400, epoch: 8 | loss: 0.0001416
	speed: 0.1060s/iter; left time: 4028.1878s
Epoch: 8 cost time: 44.66173529624939
Epoch: 8, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.262 Vali Acc: 0.969 Test Loss: 0.262 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2148s/iter; left time: 8140.9177s
	iters: 200, epoch: 9 | loss: 0.6847581
	speed: 0.1085s/iter; left time: 4101.9886s
	iters: 300, epoch: 9 | loss: 0.0713574
	speed: 0.0934s/iter; left time: 3522.1127s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1011s/iter; left time: 3801.8960s
Epoch: 9 cost time: 42.428951263427734
Epoch: 9, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.255 Vali Acc: 0.971 Test Loss: 0.255 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0010576
	speed: 0.2092s/iter; left time: 7841.4730s
	iters: 200, epoch: 10 | loss: 0.0000086
	speed: 0.1016s/iter; left time: 3797.1190s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.1075s/iter; left time: 4007.2880s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1051s/iter; left time: 3909.0684s
Epoch: 10 cost time: 43.79739785194397
Epoch: 10, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.177 Vali Acc: 0.974 Test Loss: 0.177 Test Acc: 0.974
Validation loss decreased (-0.971349 --> -0.974077).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000012
	speed: 0.2077s/iter; left time: 7700.0162s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1088s/iter; left time: 4020.9749s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1072s/iter; left time: 3953.2602s
	iters: 400, epoch: 11 | loss: 0.0000028
	speed: 0.1061s/iter; left time: 3902.9555s
Epoch: 11 cost time: 44.581541299819946
Epoch: 11, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.253 Vali Acc: 0.975 Test Loss: 0.253 Test Acc: 0.975
Validation loss decreased (-0.974077 --> -0.974531).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2065s/iter; left time: 7570.0618s
	iters: 200, epoch: 12 | loss: 0.0000012
	speed: 0.1148s/iter; left time: 4197.7189s
	iters: 300, epoch: 12 | loss: 0.0000063
	speed: 0.1043s/iter; left time: 3803.5199s
	iters: 400, epoch: 12 | loss: 0.0001088
	speed: 0.1042s/iter; left time: 3787.1382s
Epoch: 12 cost time: 44.01470875740051
Epoch: 12, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.495 Vali Acc: 0.961 Test Loss: 0.495 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000036
	speed: 0.2403s/iter; left time: 8710.3753s
	iters: 200, epoch: 13 | loss: 0.0214993
	speed: 0.1517s/iter; left time: 5484.8211s
	iters: 300, epoch: 13 | loss: 0.0000002
	speed: 0.1580s/iter; left time: 5694.2913s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1620s/iter; left time: 5821.8789s
Epoch: 13 cost time: 64.079598903656
Epoch: 13, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.789 Vali Acc: 0.946 Test Loss: 0.789 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3054s/iter; left time: 10944.4476s
	iters: 200, epoch: 14 | loss: 0.0000011
	speed: 0.1573s/iter; left time: 5622.2968s
	iters: 300, epoch: 14 | loss: 0.5976574
	speed: 0.1462s/iter; left time: 5210.4373s
	iters: 400, epoch: 14 | loss: 0.0000032
	speed: 0.1684s/iter; left time: 5984.3382s
Epoch: 14 cost time: 64.50046801567078
Epoch: 14, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.463 Vali Acc: 0.947 Test Loss: 0.463 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000004
	speed: 0.2361s/iter; left time: 8361.4717s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1331s/iter; left time: 4699.1984s
	iters: 300, epoch: 15 | loss: 0.0007265
	speed: 0.1175s/iter; left time: 4139.4893s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.1024s/iter; left time: 3596.4762s
Epoch: 15 cost time: 49.95273447036743
Epoch: 15, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.351 Vali Acc: 0.970 Test Loss: 0.351 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2711s/iter; left time: 9490.9048s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1253s/iter; left time: 4374.1439s
	iters: 300, epoch: 16 | loss: 0.0000172
	speed: 0.1167s/iter; left time: 4061.6740s
	iters: 400, epoch: 16 | loss: 0.0000004
	speed: 0.1200s/iter; left time: 4165.5499s
Epoch: 16 cost time: 53.123868465423584
Epoch: 16, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.472 Vali Acc: 0.968 Test Loss: 0.472 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0003826
	speed: 0.2461s/iter; left time: 8514.3384s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1030s/iter; left time: 3551.4640s
	iters: 300, epoch: 17 | loss: 0.0000002
	speed: 0.1097s/iter; left time: 3772.8873s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1279s/iter; left time: 4385.2727s
Epoch: 17 cost time: 48.38823175430298
Epoch: 17, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.320 Vali Acc: 0.971 Test Loss: 0.320 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2369s/iter; left time: 8098.5012s
	iters: 200, epoch: 18 | loss: 0.0001604
	speed: 0.1281s/iter; left time: 4365.3222s
	iters: 300, epoch: 18 | loss: 0.0000028
	speed: 0.1273s/iter; left time: 4325.9142s
	iters: 400, epoch: 18 | loss: 0.0000026
	speed: 0.1177s/iter; left time: 3986.1131s
Epoch: 18 cost time: 51.37403321266174
Epoch: 18, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.268 Vali Acc: 0.973 Test Loss: 0.268 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.6480294
	speed: 0.2560s/iter; left time: 8644.9484s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1498s/iter; left time: 5042.8868s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1188s/iter; left time: 3987.7640s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1212s/iter; left time: 4056.1435s
Epoch: 19 cost time: 55.23784041404724
Epoch: 19, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.332 Vali Acc: 0.972 Test Loss: 0.332 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000256
	speed: 0.2784s/iter; left time: 9284.5056s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1507s/iter; left time: 5010.9806s
	iters: 300, epoch: 20 | loss: 0.3957786
	speed: 0.1561s/iter; left time: 5175.9490s
	iters: 400, epoch: 20 | loss: 0.0000024
	speed: 0.1661s/iter; left time: 5490.9884s
Epoch: 20 cost time: 64.51660490036011
Epoch: 20, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.390 Vali Acc: 0.967 Test Loss: 0.390 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2748s/iter; left time: 9051.8305s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.1530s/iter; left time: 5023.9399s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1566s/iter; left time: 5128.2706s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1244s/iter; left time: 4058.9493s
Epoch: 21 cost time: 59.81671452522278
Epoch: 21, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.512 Vali Acc: 0.961 Test Loss: 0.512 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9745338790359254
model parameter : 259146
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5530659
	speed: 0.0865s/iter; left time: 3562.7237s
	iters: 200, epoch: 1 | loss: 0.4070148
	speed: 0.0570s/iter; left time: 2340.7209s
	iters: 300, epoch: 1 | loss: 0.0834364
	speed: 0.0616s/iter; left time: 2526.7577s
	iters: 400, epoch: 1 | loss: 0.0117798
	speed: 0.0579s/iter; left time: 2367.7420s
Epoch: 1 cost time: 27.18809676170349
Epoch: 1, Steps: 413 | Train Loss: 0.394 Vali Loss: 0.101 Vali Acc: 0.963 Test Loss: 0.101 Test Acc: 0.963
Validation loss decreased (inf --> -0.963164).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0366994
	speed: 0.1728s/iter; left time: 7047.3588s
	iters: 200, epoch: 2 | loss: 0.0118304
	speed: 0.0662s/iter; left time: 2693.4877s
	iters: 300, epoch: 2 | loss: 0.0025209
	speed: 0.0647s/iter; left time: 2624.7725s
	iters: 400, epoch: 2 | loss: 0.1242289
	speed: 0.0652s/iter; left time: 2638.0151s
Epoch: 2 cost time: 27.361005783081055
Epoch: 2, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.137 Vali Acc: 0.956 Test Loss: 0.137 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0288061
	speed: 0.1624s/iter; left time: 6555.7414s
	iters: 200, epoch: 3 | loss: 0.0003036
	speed: 0.0609s/iter; left time: 2453.4834s
	iters: 300, epoch: 3 | loss: 0.6916699
	speed: 0.0625s/iter; left time: 2511.4295s
	iters: 400, epoch: 3 | loss: 0.0027602
	speed: 0.0649s/iter; left time: 2601.6701s
Epoch: 3 cost time: 26.01277184486389
Epoch: 3, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
Validation loss decreased (-0.963164 --> -0.966347).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000259
	speed: 0.1729s/iter; left time: 6907.5294s
	iters: 200, epoch: 4 | loss: 0.0075581
	speed: 0.0583s/iter; left time: 2322.0862s
	iters: 300, epoch: 4 | loss: 0.0438717
	speed: 0.0590s/iter; left time: 2345.5492s
	iters: 400, epoch: 4 | loss: 0.2599426
	speed: 0.0569s/iter; left time: 2256.4532s
Epoch: 4 cost time: 25.204851627349854
Epoch: 4, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.246 Vali Acc: 0.958 Test Loss: 0.246 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0005334
	speed: 0.1819s/iter; left time: 7192.6581s
	iters: 200, epoch: 5 | loss: 0.0001732
	speed: 0.0766s/iter; left time: 3022.0020s
	iters: 300, epoch: 5 | loss: 0.0193719
	speed: 0.0746s/iter; left time: 2936.9169s
	iters: 400, epoch: 5 | loss: 0.0431948
	speed: 0.0778s/iter; left time: 3053.4780s
Epoch: 5 cost time: 31.457993030548096
Epoch: 5, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
Validation loss decreased (-0.966347 --> -0.971804).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000059
	speed: 0.1811s/iter; left time: 7086.3910s
	iters: 200, epoch: 6 | loss: 0.0004827
	speed: 0.0712s/iter; left time: 2777.6304s
	iters: 300, epoch: 6 | loss: 0.0152269
	speed: 0.0561s/iter; left time: 2182.7685s
	iters: 400, epoch: 6 | loss: 0.5937951
	speed: 0.0609s/iter; left time: 2365.7345s
Epoch: 6 cost time: 26.869216918945312
Epoch: 6, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.225 Vali Acc: 0.965 Test Loss: 0.225 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0004545
	speed: 0.1820s/iter; left time: 7047.4320s
	iters: 200, epoch: 7 | loss: 0.0001982
	speed: 0.0661s/iter; left time: 2552.0234s
	iters: 300, epoch: 7 | loss: 0.0000152
	speed: 0.0708s/iter; left time: 2727.7419s
	iters: 400, epoch: 7 | loss: 0.0000014
	speed: 0.0677s/iter; left time: 2600.7918s
Epoch: 7 cost time: 28.843437671661377
Epoch: 7, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
Validation loss decreased (-0.971804 --> -0.974532).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3129817
	speed: 0.1789s/iter; left time: 6852.9798s
	iters: 200, epoch: 8 | loss: 0.0193464
	speed: 0.0741s/iter; left time: 2829.4611s
	iters: 300, epoch: 8 | loss: 1.5015513
	speed: 0.0727s/iter; left time: 2770.6072s
	iters: 400, epoch: 8 | loss: 0.0000025
	speed: 0.0745s/iter; left time: 2831.6848s
Epoch: 8 cost time: 30.652124881744385
Epoch: 8, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.209 Vali Acc: 0.969 Test Loss: 0.209 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0146701
	speed: 0.1619s/iter; left time: 6137.2153s
	iters: 200, epoch: 9 | loss: 0.0000005
	speed: 0.0690s/iter; left time: 2607.4350s
	iters: 300, epoch: 9 | loss: 0.2827956
	speed: 0.0674s/iter; left time: 2542.3725s
	iters: 400, epoch: 9 | loss: 0.1488714
	speed: 0.0704s/iter; left time: 2646.3618s
Epoch: 9 cost time: 27.905365467071533
Epoch: 9, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.189 Vali Acc: 0.970 Test Loss: 0.189 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000380
	speed: 0.1746s/iter; left time: 6543.8033s
	iters: 200, epoch: 10 | loss: 0.0025611
	speed: 0.0613s/iter; left time: 2290.0501s
	iters: 300, epoch: 10 | loss: 0.0001913
	speed: 0.0641s/iter; left time: 2390.4581s
	iters: 400, epoch: 10 | loss: 0.3331599
	speed: 0.0643s/iter; left time: 2389.7656s
Epoch: 10 cost time: 26.917919635772705
Epoch: 10, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.271 Vali Acc: 0.964 Test Loss: 0.271 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000045
	speed: 0.1806s/iter; left time: 6695.4812s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0701s/iter; left time: 2591.2481s
	iters: 300, epoch: 11 | loss: 0.0000215
	speed: 0.0696s/iter; left time: 2567.6201s
	iters: 400, epoch: 11 | loss: 0.0029771
	speed: 0.0654s/iter; left time: 2405.7310s
Epoch: 11 cost time: 28.961162328720093
Epoch: 11, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.260 Vali Acc: 0.968 Test Loss: 0.260 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000760
	speed: 0.1526s/iter; left time: 5595.5428s
	iters: 200, epoch: 12 | loss: 0.0000089
	speed: 0.0522s/iter; left time: 1908.7950s
	iters: 300, epoch: 12 | loss: 0.0000008
	speed: 0.0549s/iter; left time: 2003.0688s
	iters: 400, epoch: 12 | loss: 0.0002561
	speed: 0.0595s/iter; left time: 2163.6254s
Epoch: 12 cost time: 22.997742652893066
Epoch: 12, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.312 Vali Acc: 0.966 Test Loss: 0.312 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1904005
	speed: 0.1710s/iter; left time: 6197.0367s
	iters: 200, epoch: 13 | loss: 0.0000025
	speed: 0.0555s/iter; left time: 2004.3381s
	iters: 300, epoch: 13 | loss: 0.0000281
	speed: 0.0541s/iter; left time: 1949.4692s
	iters: 400, epoch: 13 | loss: 0.0000005
	speed: 0.0587s/iter; left time: 2111.7408s
Epoch: 13 cost time: 24.36724591255188
Epoch: 13, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.403 Vali Acc: 0.965 Test Loss: 0.403 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000002
	speed: 0.1655s/iter; left time: 5928.5005s
	iters: 200, epoch: 14 | loss: 0.0000037
	speed: 0.0650s/iter; left time: 2322.3853s
	iters: 300, epoch: 14 | loss: 0.4287141
	speed: 0.0642s/iter; left time: 2288.6442s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0555s/iter; left time: 1970.5714s
Epoch: 14 cost time: 26.08702850341797
Epoch: 14, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.324 Vali Acc: 0.965 Test Loss: 0.324 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000158
	speed: 0.1564s/iter; left time: 5538.0841s
	iters: 200, epoch: 15 | loss: 0.0009855
	speed: 0.0491s/iter; left time: 1733.6041s
	iters: 300, epoch: 15 | loss: 0.0000020
	speed: 0.0651s/iter; left time: 2291.7049s
	iters: 400, epoch: 15 | loss: 0.0001297
	speed: 0.0655s/iter; left time: 2300.0538s
Epoch: 15 cost time: 24.61890482902527
Epoch: 15, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.249 Vali Acc: 0.970 Test Loss: 0.249 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1628s/iter; left time: 5698.7428s
	iters: 200, epoch: 16 | loss: 0.0009623
	speed: 0.0585s/iter; left time: 2042.6662s
	iters: 300, epoch: 16 | loss: 0.1194755
	speed: 0.0547s/iter; left time: 1904.0834s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 1805.3653s
Epoch: 16 cost time: 23.706239700317383
Epoch: 16, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.286 Vali Acc: 0.970 Test Loss: 0.286 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1490s/iter; left time: 5155.5544s
	iters: 200, epoch: 17 | loss: 0.7176536
	speed: 0.0418s/iter; left time: 1440.3146s
	iters: 300, epoch: 17 | loss: 0.0001434
	speed: 0.0478s/iter; left time: 1644.6786s
	iters: 400, epoch: 17 | loss: 0.0006505
	speed: 0.0434s/iter; left time: 1489.9699s
Epoch: 17 cost time: 19.450486421585083
Epoch: 17, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.371 Vali Acc: 0.960 Test Loss: 0.371 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9745338790359254
model parameter : 226186
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3712116
	speed: 0.0704s/iter; left time: 2902.3273s
	iters: 200, epoch: 1 | loss: 0.2433383
	speed: 0.0449s/iter; left time: 1846.3372s
	iters: 300, epoch: 1 | loss: 0.0454454
	speed: 0.0467s/iter; left time: 1916.1208s
	iters: 400, epoch: 1 | loss: 0.2558630
	speed: 0.0442s/iter; left time: 1805.8858s
Epoch: 1 cost time: 21.397759199142456
Epoch: 1, Steps: 413 | Train Loss: 0.420 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
Validation loss decreased (inf --> -0.962255).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0777680
	speed: 0.1388s/iter; left time: 5660.4875s
	iters: 200, epoch: 2 | loss: 0.0831596
	speed: 0.0487s/iter; left time: 1982.1767s
	iters: 300, epoch: 2 | loss: 0.0430674
	speed: 0.0544s/iter; left time: 2209.4306s
	iters: 400, epoch: 2 | loss: 0.1313090
	speed: 0.0454s/iter; left time: 1838.6392s
Epoch: 2 cost time: 20.75604557991028
Epoch: 2, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1176733
	speed: 0.1372s/iter; left time: 5539.2688s
	iters: 200, epoch: 3 | loss: 0.0028046
	speed: 0.0475s/iter; left time: 1911.2306s
	iters: 300, epoch: 3 | loss: 0.0093769
	speed: 0.0490s/iter; left time: 1967.2515s
	iters: 400, epoch: 3 | loss: 0.0017141
	speed: 0.0459s/iter; left time: 1838.9779s
Epoch: 3 cost time: 20.386541604995728
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
Validation loss decreased (-0.962255 --> -0.971804).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0003270
	speed: 0.1468s/iter; left time: 5864.5709s
	iters: 200, epoch: 4 | loss: 0.0046032
	speed: 0.0531s/iter; left time: 2118.5026s
	iters: 300, epoch: 4 | loss: 0.3711191
	speed: 0.0558s/iter; left time: 2220.1237s
	iters: 400, epoch: 4 | loss: 0.0069305
	speed: 0.0508s/iter; left time: 2016.6178s
Epoch: 4 cost time: 22.41117262840271
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
Validation loss decreased (-0.971804 --> -0.974078).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0125419
	speed: 0.1592s/iter; left time: 6297.5546s
	iters: 200, epoch: 5 | loss: 0.0054205
	speed: 0.0530s/iter; left time: 2090.8353s
	iters: 300, epoch: 5 | loss: 0.0004701
	speed: 0.0515s/iter; left time: 2026.8966s
	iters: 400, epoch: 5 | loss: 0.0028504
	speed: 0.0562s/iter; left time: 2205.8984s
Epoch: 5 cost time: 22.886842727661133
Epoch: 5, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.214 Vali Acc: 0.965 Test Loss: 0.214 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0009562
	speed: 0.1429s/iter; left time: 5593.1603s
	iters: 200, epoch: 6 | loss: 0.1123447
	speed: 0.0551s/iter; left time: 2149.9778s
	iters: 300, epoch: 6 | loss: 0.4344955
	speed: 0.0523s/iter; left time: 2034.5561s
	iters: 400, epoch: 6 | loss: 0.3057294
	speed: 0.0569s/iter; left time: 2209.8860s
Epoch: 6 cost time: 22.566959142684937
Epoch: 6, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0003255
	speed: 0.1621s/iter; left time: 6276.4238s
	iters: 200, epoch: 7 | loss: 0.0000013
	speed: 0.0581s/iter; left time: 2243.9114s
	iters: 300, epoch: 7 | loss: 0.0000346
	speed: 0.0594s/iter; left time: 2286.7960s
	iters: 400, epoch: 7 | loss: 0.0658932
	speed: 0.0608s/iter; left time: 2336.7323s
Epoch: 7 cost time: 25.05135679244995
Epoch: 7, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.192 Vali Acc: 0.969 Test Loss: 0.192 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0027568
	speed: 0.1646s/iter; left time: 6304.9667s
	iters: 200, epoch: 8 | loss: 0.0021881
	speed: 0.0647s/iter; left time: 2470.7543s
	iters: 300, epoch: 8 | loss: 0.0083416
	speed: 0.0627s/iter; left time: 2389.1284s
	iters: 400, epoch: 8 | loss: 0.0000008
	speed: 0.0601s/iter; left time: 2283.7661s
Epoch: 8 cost time: 26.306032180786133
Epoch: 8, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.974078 --> -0.977261).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000089
	speed: 0.1657s/iter; left time: 6278.6369s
	iters: 200, epoch: 9 | loss: 0.0012015
	speed: 0.0589s/iter; left time: 2225.7692s
	iters: 300, epoch: 9 | loss: 0.0789372
	speed: 0.0667s/iter; left time: 2516.2205s
	iters: 400, epoch: 9 | loss: 0.0102264
	speed: 0.0649s/iter; left time: 2438.3338s
Epoch: 9 cost time: 26.66968321800232
Epoch: 9, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.201 Vali Acc: 0.967 Test Loss: 0.201 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0006353
	speed: 0.1536s/iter; left time: 5756.9513s
	iters: 200, epoch: 10 | loss: 0.0002424
	speed: 0.0588s/iter; left time: 2199.6119s
	iters: 300, epoch: 10 | loss: 0.0002498
	speed: 0.0616s/iter; left time: 2295.9605s
	iters: 400, epoch: 10 | loss: 0.0000075
	speed: 0.0625s/iter; left time: 2323.9993s
Epoch: 10 cost time: 25.25238347053528
Epoch: 10, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.228 Vali Acc: 0.970 Test Loss: 0.228 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.1643s/iter; left time: 6091.7865s
	iters: 200, epoch: 11 | loss: 0.0000387
	speed: 0.0620s/iter; left time: 2291.0320s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0624s/iter; left time: 2302.0934s
	iters: 400, epoch: 11 | loss: 0.0028573
	speed: 0.0587s/iter; left time: 2156.7151s
Epoch: 11 cost time: 25.45128297805786
Epoch: 11, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000709
	speed: 0.1610s/iter; left time: 5901.3948s
	iters: 200, epoch: 12 | loss: 0.0000556
	speed: 0.0609s/iter; left time: 2226.1005s
	iters: 300, epoch: 12 | loss: 0.0000022
	speed: 0.0581s/iter; left time: 2119.2441s
	iters: 400, epoch: 12 | loss: 0.0001861
	speed: 0.0601s/iter; left time: 2183.8937s
Epoch: 12 cost time: 25.31742763519287
Epoch: 12, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.184 Vali Acc: 0.978 Test Loss: 0.184 Test Acc: 0.978
Validation loss decreased (-0.977261 --> -0.978170).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000037
	speed: 0.1518s/iter; left time: 5501.0987s
	iters: 200, epoch: 13 | loss: 0.0003049
	speed: 0.0628s/iter; left time: 2271.0305s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0623s/iter; left time: 2244.9185s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0600s/iter; left time: 2156.2033s
Epoch: 13 cost time: 25.497798204421997
Epoch: 13, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.336 Vali Acc: 0.962 Test Loss: 0.336 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0430145
	speed: 0.1602s/iter; left time: 5740.9933s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0599s/iter; left time: 2141.0569s
	iters: 300, epoch: 14 | loss: 0.4525389
	speed: 0.0624s/iter; left time: 2221.9088s
	iters: 400, epoch: 14 | loss: 0.4946852
	speed: 0.0602s/iter; left time: 2139.4952s
Epoch: 14 cost time: 25.008161067962646
Epoch: 14, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.299 Vali Acc: 0.965 Test Loss: 0.299 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0104142
	speed: 0.1691s/iter; left time: 5988.1997s
	iters: 200, epoch: 15 | loss: 0.0300079
	speed: 0.0576s/iter; left time: 2033.1029s
	iters: 300, epoch: 15 | loss: 0.0028982
	speed: 0.0517s/iter; left time: 1822.1248s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 1911.3609s
Epoch: 15 cost time: 24.08248805999756
Epoch: 15, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000001
	speed: 0.1596s/iter; left time: 5586.8364s
	iters: 200, epoch: 16 | loss: 0.0000013
	speed: 0.0603s/iter; left time: 2104.9220s
	iters: 300, epoch: 16 | loss: 0.0004201
	speed: 0.0568s/iter; left time: 1976.3393s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 1901.5151s
Epoch: 16 cost time: 24.230780601501465
Epoch: 16, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000278
	speed: 0.1558s/iter; left time: 5388.9913s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0558s/iter; left time: 1926.0235s
	iters: 300, epoch: 17 | loss: 0.0013211
	speed: 0.0570s/iter; left time: 1958.8936s
	iters: 400, epoch: 17 | loss: 0.9596735
	speed: 0.0610s/iter; left time: 2091.4672s
Epoch: 17 cost time: 24.133984327316284
Epoch: 17, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.268 Vali Acc: 0.971 Test Loss: 0.268 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0654134
	speed: 0.1642s/iter; left time: 5611.0051s
	iters: 200, epoch: 18 | loss: 0.0000028
	speed: 0.0504s/iter; left time: 1717.2876s
	iters: 300, epoch: 18 | loss: 0.0000218
	speed: 0.0495s/iter; left time: 1680.3358s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0529s/iter; left time: 1792.9111s
Epoch: 18 cost time: 22.58751893043518
Epoch: 18, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.190 Vali Acc: 0.972 Test Loss: 0.190 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000041
	speed: 0.1478s/iter; left time: 4990.8895s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0519s/iter; left time: 1748.7361s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 1711.4715s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0484s/iter; left time: 1618.3855s
Epoch: 19 cost time: 21.198046922683716
Epoch: 19, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.281 Vali Acc: 0.971 Test Loss: 0.281 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000210
	speed: 0.1309s/iter; left time: 4365.3044s
	iters: 200, epoch: 20 | loss: 0.0007887
	speed: 0.0435s/iter; left time: 1446.7303s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 1611.2061s
	iters: 400, epoch: 20 | loss: 0.0007976
	speed: 0.0515s/iter; left time: 1701.4250s
Epoch: 20 cost time: 19.458937168121338
Epoch: 20, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.222 Vali Acc: 0.976 Test Loss: 0.222 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0029130
	speed: 0.1425s/iter; left time: 4695.6049s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 1675.2742s
	iters: 300, epoch: 21 | loss: 0.0000101
	speed: 0.0473s/iter; left time: 1547.4180s
	iters: 400, epoch: 21 | loss: 0.0277806
	speed: 0.0448s/iter; left time: 1463.6537s
Epoch: 21 cost time: 20.519432067871094
Epoch: 21, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.268 Vali Acc: 0.971 Test Loss: 0.268 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000008
	speed: 0.1354s/iter; left time: 4403.9932s
	iters: 200, epoch: 22 | loss: 0.0000046
	speed: 0.0458s/iter; left time: 1486.4539s
	iters: 300, epoch: 22 | loss: 0.5483294
	speed: 0.0489s/iter; left time: 1579.7604s
	iters: 400, epoch: 22 | loss: 0.0000024
	speed: 0.0462s/iter; left time: 1490.5193s
Epoch: 22 cost time: 19.629984855651855
Epoch: 22, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.241 Vali Acc: 0.973 Test Loss: 0.241 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 209866
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0775727
	speed: 0.1110s/iter; left time: 4572.8685s
	iters: 200, epoch: 1 | loss: 0.2422114
	speed: 0.0893s/iter; left time: 3669.5595s
	iters: 300, epoch: 1 | loss: 0.1033451
	speed: 0.0954s/iter; left time: 3910.7737s
	iters: 400, epoch: 1 | loss: 0.0082285
	speed: 0.0922s/iter; left time: 3769.6926s
Epoch: 1 cost time: 40.03006172180176
Epoch: 1, Steps: 413 | Train Loss: 0.391 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (inf --> -0.950430).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0237731
	speed: 0.2340s/iter; left time: 9543.9185s
	iters: 200, epoch: 2 | loss: 0.1739615
	speed: 0.0990s/iter; left time: 4027.1435s
	iters: 300, epoch: 2 | loss: 0.1575408
	speed: 0.0925s/iter; left time: 3755.4066s
	iters: 400, epoch: 2 | loss: 0.6687477
	speed: 0.0925s/iter; left time: 3744.6823s
Epoch: 2 cost time: 39.25387716293335
Epoch: 2, Steps: 413 | Train Loss: 0.189 Vali Loss: 0.265 Vali Acc: 0.945 Test Loss: 0.265 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0003140
	speed: 0.2589s/iter; left time: 10451.3001s
	iters: 200, epoch: 3 | loss: 0.3743634
	speed: 0.1025s/iter; left time: 4128.7859s
	iters: 300, epoch: 3 | loss: 0.0155788
	speed: 0.1057s/iter; left time: 4244.6638s
	iters: 400, epoch: 3 | loss: 0.6467139
	speed: 0.1016s/iter; left time: 4071.6370s
Epoch: 3 cost time: 43.857645988464355
Epoch: 3, Steps: 413 | Train Loss: 0.163 Vali Loss: 0.465 Vali Acc: 0.948 Test Loss: 0.465 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000153
	speed: 0.2667s/iter; left time: 10659.7425s
	iters: 200, epoch: 4 | loss: 0.5168502
	speed: 0.0998s/iter; left time: 3977.6598s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.1095s/iter; left time: 4352.7514s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.1103s/iter; left time: 4373.2968s
Epoch: 4 cost time: 44.718698263168335
Epoch: 4, Steps: 413 | Train Loss: 0.167 Vali Loss: 0.496 Vali Acc: 0.957 Test Loss: 0.496 Test Acc: 0.957
Validation loss decreased (-0.950430 --> -0.957248).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.2607s/iter; left time: 10312.0842s
	iters: 200, epoch: 5 | loss: 0.4932443
	speed: 0.1052s/iter; left time: 4149.8339s
	iters: 300, epoch: 5 | loss: 0.1353021
	speed: 0.1048s/iter; left time: 4122.9533s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0975s/iter; left time: 3828.4434s
Epoch: 5 cost time: 42.778619050979614
Epoch: 5, Steps: 413 | Train Loss: 0.177 Vali Loss: 0.707 Vali Acc: 0.953 Test Loss: 0.707 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8260883
	speed: 0.2605s/iter; left time: 10192.9823s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.1038s/iter; left time: 4051.2616s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.1121s/iter; left time: 4363.1128s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.1121s/iter; left time: 4352.3637s
Epoch: 6 cost time: 45.5044891834259
Epoch: 6, Steps: 413 | Train Loss: 0.170 Vali Loss: 0.461 Vali Acc: 0.957 Test Loss: 0.461 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000006
	speed: 0.2598s/iter; left time: 10059.3381s
	iters: 200, epoch: 7 | loss: 0.0000117
	speed: 0.1027s/iter; left time: 3966.6229s
	iters: 300, epoch: 7 | loss: 0.0000126
	speed: 0.1064s/iter; left time: 4098.6549s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.1002s/iter; left time: 3849.9922s
Epoch: 7 cost time: 43.37853217124939
Epoch: 7, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.573 Vali Acc: 0.970 Test Loss: 0.573 Test Acc: 0.970
Validation loss decreased (-0.957248 --> -0.969526).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2558s/iter; left time: 9799.1784s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1114s/iter; left time: 4257.6352s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.1076s/iter; left time: 4099.8832s
	iters: 400, epoch: 8 | loss: 0.0137883
	speed: 0.1080s/iter; left time: 4104.4619s
Epoch: 8 cost time: 45.041990518569946
Epoch: 8, Steps: 413 | Train Loss: 0.173 Vali Loss: 0.386 Vali Acc: 0.971 Test Loss: 0.386 Test Acc: 0.971
Validation loss decreased (-0.969526 --> -0.970892).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2528s/iter; left time: 9581.2221s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.1022s/iter; left time: 3861.1401s
	iters: 300, epoch: 9 | loss: 0.2464558
	speed: 0.1099s/iter; left time: 4143.4192s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0886s/iter; left time: 3330.3991s
Epoch: 9 cost time: 42.06520080566406
Epoch: 9, Steps: 413 | Train Loss: 0.151 Vali Loss: 0.484 Vali Acc: 0.968 Test Loss: 0.484 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0001656
	speed: 0.2411s/iter; left time: 9039.0802s
	iters: 200, epoch: 10 | loss: 0.0001242
	speed: 0.0986s/iter; left time: 3686.4554s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0973s/iter; left time: 3627.7241s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1004s/iter; left time: 3732.9809s
Epoch: 10 cost time: 41.16764688491821
Epoch: 10, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.508 Vali Acc: 0.965 Test Loss: 0.508 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000189
	speed: 0.2312s/iter; left time: 8569.4103s
	iters: 200, epoch: 11 | loss: 0.0004519
	speed: 0.1020s/iter; left time: 3770.9546s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1056s/iter; left time: 3892.4214s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1008s/iter; left time: 3705.0915s
Epoch: 11 cost time: 41.657427072525024
Epoch: 11, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.812 Vali Acc: 0.960 Test Loss: 0.812 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2598s/iter; left time: 9523.0883s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0997s/iter; left time: 3643.3046s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1022s/iter; left time: 3726.3955s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0948s/iter; left time: 3448.1178s
Epoch: 12 cost time: 42.01715803146362
Epoch: 12, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.981 Vali Acc: 0.960 Test Loss: 0.981 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000016
	speed: 0.2307s/iter; left time: 8360.8676s
	iters: 200, epoch: 13 | loss: 0.4347663
	speed: 0.0915s/iter; left time: 3306.5738s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0893s/iter; left time: 3217.7490s
	iters: 400, epoch: 13 | loss: 0.0000015
	speed: 0.0937s/iter; left time: 3367.8126s
Epoch: 13 cost time: 37.59011363983154
Epoch: 13, Steps: 413 | Train Loss: 0.140 Vali Loss: 1.278 Vali Acc: 0.951 Test Loss: 1.278 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2395s/iter; left time: 8580.4077s
	iters: 200, epoch: 14 | loss: 0.1898655
	speed: 0.0858s/iter; left time: 3067.0995s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0977s/iter; left time: 3482.4557s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0988s/iter; left time: 3512.0844s
Epoch: 14 cost time: 39.37021541595459
Epoch: 14, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.921 Vali Acc: 0.953 Test Loss: 0.921 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000017
	speed: 0.2488s/iter; left time: 8811.2712s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1014s/iter; left time: 3579.6217s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0846s/iter; left time: 2977.9407s
	iters: 400, epoch: 15 | loss: 0.0024151
	speed: 0.0942s/iter; left time: 3309.3733s
Epoch: 15 cost time: 39.457804679870605
Epoch: 15, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.597 Vali Acc: 0.967 Test Loss: 0.597 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2290s/iter; left time: 8016.0982s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0946s/iter; left time: 3302.4030s
	iters: 300, epoch: 16 | loss: 0.0000353
	speed: 0.0952s/iter; left time: 3313.9372s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0906s/iter; left time: 3145.0313s
Epoch: 16 cost time: 38.437981367111206
Epoch: 16, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.656 Vali Acc: 0.967 Test Loss: 0.656 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2398s/iter; left time: 8293.8625s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0913s/iter; left time: 3150.7694s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0913s/iter; left time: 3141.4747s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0844s/iter; left time: 2893.5415s
Epoch: 17 cost time: 37.31282925605774
Epoch: 17, Steps: 413 | Train Loss: 0.093 Vali Loss: 1.101 Vali Acc: 0.948 Test Loss: 1.101 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2241s/iter; left time: 7659.7736s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0909s/iter; left time: 3097.4401s
	iters: 300, epoch: 18 | loss: 0.6371810
	speed: 0.0901s/iter; left time: 3062.9219s
	iters: 400, epoch: 18 | loss: 0.0000008
	speed: 0.0841s/iter; left time: 2847.8327s
Epoch: 18 cost time: 36.83818531036377
Epoch: 18, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.905 Vali Acc: 0.951 Test Loss: 0.905 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9708958617553434
model parameter : 491786
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1394659
	speed: 0.1346s/iter; left time: 5547.4830s
	iters: 200, epoch: 1 | loss: 0.1778395
	speed: 0.1183s/iter; left time: 4862.8076s
	iters: 300, epoch: 1 | loss: 0.0001843
	speed: 0.1151s/iter; left time: 4720.6618s
	iters: 400, epoch: 1 | loss: 0.0090166
	speed: 0.1188s/iter; left time: 4858.4695s
Epoch: 1 cost time: 50.2221474647522
Epoch: 1, Steps: 413 | Train Loss: 0.371 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
Validation loss decreased (inf --> -0.951794).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0067625
	speed: 0.2321s/iter; left time: 9468.4844s
	iters: 200, epoch: 2 | loss: 0.4669688
	speed: 0.1171s/iter; left time: 4764.8263s
	iters: 300, epoch: 2 | loss: 0.0055506
	speed: 0.1163s/iter; left time: 4719.7350s
	iters: 400, epoch: 2 | loss: 0.0300605
	speed: 0.1233s/iter; left time: 4993.8284s
Epoch: 2 cost time: 48.91757035255432
Epoch: 2, Steps: 413 | Train Loss: 0.168 Vali Loss: 0.254 Vali Acc: 0.960 Test Loss: 0.254 Test Acc: 0.960
Validation loss decreased (-0.951794 --> -0.959979).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0013533
	speed: 0.2408s/iter; left time: 9722.6797s
	iters: 200, epoch: 3 | loss: 0.0208730
	speed: 0.1204s/iter; left time: 4847.4057s
	iters: 300, epoch: 3 | loss: 0.2570315
	speed: 0.1157s/iter; left time: 4648.2523s
	iters: 400, epoch: 3 | loss: 0.1825498
	speed: 0.1208s/iter; left time: 4840.1320s
Epoch: 3 cost time: 49.55487418174744
Epoch: 3, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.291 Vali Acc: 0.957 Test Loss: 0.291 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3439417
	speed: 0.2402s/iter; left time: 9597.6407s
	iters: 200, epoch: 4 | loss: 0.0000280
	speed: 0.1139s/iter; left time: 4539.8067s
	iters: 300, epoch: 4 | loss: 0.0000001
	speed: 0.1197s/iter; left time: 4761.0154s
	iters: 400, epoch: 4 | loss: 0.0050818
	speed: 0.1204s/iter; left time: 4774.1879s
Epoch: 4 cost time: 49.4504189491272
Epoch: 4, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.250 Vali Acc: 0.966 Test Loss: 0.250 Test Acc: 0.966
Validation loss decreased (-0.959979 --> -0.966346).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000004
	speed: 0.2381s/iter; left time: 9416.1948s
	iters: 200, epoch: 5 | loss: 0.0007084
	speed: 0.1191s/iter; left time: 4699.5538s
	iters: 300, epoch: 5 | loss: 0.0000132
	speed: 0.1166s/iter; left time: 4589.5633s
	iters: 400, epoch: 5 | loss: 0.3511665
	speed: 0.1128s/iter; left time: 4427.9930s
Epoch: 5 cost time: 48.44189977645874
Epoch: 5, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.544 Vali Acc: 0.949 Test Loss: 0.544 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000012
	speed: 0.2394s/iter; left time: 9367.3014s
	iters: 200, epoch: 6 | loss: 0.0000142
	speed: 0.1116s/iter; left time: 4354.8062s
	iters: 300, epoch: 6 | loss: 0.2751015
	speed: 0.1154s/iter; left time: 4492.6429s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.1258s/iter; left time: 4883.7107s
Epoch: 6 cost time: 48.97239112854004
Epoch: 6, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.560 Vali Acc: 0.957 Test Loss: 0.560 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2511s/iter; left time: 9722.2878s
	iters: 200, epoch: 7 | loss: 0.0002245
	speed: 0.1297s/iter; left time: 5010.0323s
	iters: 300, epoch: 7 | loss: 0.0484443
	speed: 0.1055s/iter; left time: 4063.3940s
	iters: 400, epoch: 7 | loss: 0.0050222
	speed: 0.0746s/iter; left time: 2865.1726s
Epoch: 7 cost time: 45.272778272628784
Epoch: 7, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.396 Vali Acc: 0.960 Test Loss: 0.396 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0005501
	speed: 0.2138s/iter; left time: 8190.1523s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0972s/iter; left time: 3713.9676s
	iters: 300, epoch: 8 | loss: 0.0001101
	speed: 0.1071s/iter; left time: 4082.0485s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.1015s/iter; left time: 3859.4363s
Epoch: 8 cost time: 42.831950426101685
Epoch: 8, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.486 Vali Acc: 0.965 Test Loss: 0.486 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2176s/iter; left time: 8247.8340s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.1025s/iter; left time: 3874.3600s
	iters: 300, epoch: 9 | loss: 0.0910922
	speed: 0.1039s/iter; left time: 3915.8250s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1049s/iter; left time: 3943.0529s
Epoch: 9 cost time: 43.62320280075073
Epoch: 9, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.357 Vali Acc: 0.972 Test Loss: 0.357 Test Acc: 0.972
Validation loss decreased (-0.966346 --> -0.971802).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1130155
	speed: 0.2116s/iter; left time: 7930.7113s
	iters: 200, epoch: 10 | loss: 0.4501148
	speed: 0.0921s/iter; left time: 3443.6133s
	iters: 300, epoch: 10 | loss: 0.0008829
	speed: 0.0921s/iter; left time: 3435.3239s
	iters: 400, epoch: 10 | loss: 0.0000008
	speed: 0.0944s/iter; left time: 3511.9368s
Epoch: 10 cost time: 39.09179067611694
Epoch: 10, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.294 Vali Acc: 0.973 Test Loss: 0.294 Test Acc: 0.973
Validation loss decreased (-0.971802 --> -0.973167).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3163022
	speed: 0.2220s/iter; left time: 8230.3489s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1075s/iter; left time: 3974.8814s
	iters: 300, epoch: 11 | loss: 0.0001122
	speed: 0.1058s/iter; left time: 3902.4506s
	iters: 400, epoch: 11 | loss: 0.0000056
	speed: 0.0899s/iter; left time: 3307.0357s
Epoch: 11 cost time: 43.11823010444641
Epoch: 11, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.325 Vali Acc: 0.972 Test Loss: 0.325 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1965s/iter; left time: 7203.0508s
	iters: 200, epoch: 12 | loss: 0.0000007
	speed: 0.0976s/iter; left time: 3566.3224s
	iters: 300, epoch: 12 | loss: 1.1822248
	speed: 0.1017s/iter; left time: 3708.2686s
	iters: 400, epoch: 12 | loss: 0.0045027
	speed: 0.1023s/iter; left time: 3720.7339s
Epoch: 12 cost time: 39.270302057266235
Epoch: 12, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.449 Vali Acc: 0.969 Test Loss: 0.449 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.4963394
	speed: 0.2346s/iter; left time: 8503.1505s
	iters: 200, epoch: 13 | loss: 0.0000004
	speed: 0.1251s/iter; left time: 4520.7384s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1234s/iter; left time: 4448.0377s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1227s/iter; left time: 4409.8326s
Epoch: 13 cost time: 51.29684495925903
Epoch: 13, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.385 Vali Acc: 0.975 Test Loss: 0.385 Test Acc: 0.975
Validation loss decreased (-0.973167 --> -0.975440).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2462s/iter; left time: 8822.7894s
	iters: 200, epoch: 14 | loss: 0.2650869
	speed: 0.1203s/iter; left time: 4299.0948s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1227s/iter; left time: 4373.4971s
	iters: 400, epoch: 14 | loss: 0.4201435
	speed: 0.1173s/iter; left time: 4167.7278s
Epoch: 14 cost time: 50.435248136520386
Epoch: 14, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.427 Vali Acc: 0.968 Test Loss: 0.427 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0078479
	speed: 0.2496s/iter; left time: 8839.4654s
	iters: 200, epoch: 15 | loss: 0.2104204
	speed: 0.1267s/iter; left time: 4474.8256s
	iters: 300, epoch: 15 | loss: 0.5273892
	speed: 0.1249s/iter; left time: 4400.4083s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1154s/iter; left time: 4052.4509s
Epoch: 15 cost time: 51.40448188781738
Epoch: 15, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.396 Vali Acc: 0.971 Test Loss: 0.396 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2402s/iter; left time: 8407.5884s
	iters: 200, epoch: 16 | loss: 0.0000004
	speed: 0.1349s/iter; left time: 4708.7869s
	iters: 300, epoch: 16 | loss: 0.2728237
	speed: 0.1356s/iter; left time: 4719.0473s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1311s/iter; left time: 4551.2233s
Epoch: 16 cost time: 54.54591250419617
Epoch: 16, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.910 Vali Acc: 0.955 Test Loss: 0.910 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2492s/iter; left time: 8618.8799s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1288s/iter; left time: 4444.2832s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1322s/iter; left time: 4546.1865s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1324s/iter; left time: 4541.3431s
Epoch: 17 cost time: 53.753867864608765
Epoch: 17, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.631 Vali Acc: 0.971 Test Loss: 0.631 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2499s/iter; left time: 8541.6856s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1340s/iter; left time: 4566.4728s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1325s/iter; left time: 4503.9816s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1281s/iter; left time: 4340.6160s
Epoch: 18 cost time: 53.90674638748169
Epoch: 18, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.485 Vali Acc: 0.972 Test Loss: 0.485 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2456s/iter; left time: 8292.3181s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1276s/iter; left time: 4294.2736s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1306s/iter; left time: 4385.4962s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1096s/iter; left time: 3666.8475s
Epoch: 19 cost time: 51.294973850250244
Epoch: 19, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.787 Vali Acc: 0.968 Test Loss: 0.787 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2170s/iter; left time: 7238.6614s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0841s/iter; left time: 2795.7179s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0984s/iter; left time: 3263.1247s
	iters: 400, epoch: 20 | loss: 0.0645456
	speed: 0.1002s/iter; left time: 3313.1843s
Epoch: 20 cost time: 40.29915904998779
Epoch: 20, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.468 Vali Acc: 0.978 Test Loss: 0.468 Test Acc: 0.978
Validation loss decreased (-0.975440 --> -0.977712).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2140s/iter; left time: 7050.7034s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.1031s/iter; left time: 3385.1681s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1122s/iter; left time: 3675.0519s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0909s/iter; left time: 2966.1993s
Epoch: 21 cost time: 41.92535901069641
Epoch: 21, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.687 Vali Acc: 0.966 Test Loss: 0.687 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2207s/iter; left time: 7180.3445s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0926s/iter; left time: 3002.3718s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1098s/iter; left time: 3549.5951s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1023s/iter; left time: 3296.1972s
Epoch: 22 cost time: 43.28224515914917
Epoch: 22, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.743 Vali Acc: 0.972 Test Loss: 0.743 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2175s/iter; left time: 6984.3778s
	iters: 200, epoch: 23 | loss: 0.0000007
	speed: 0.0983s/iter; left time: 3146.5399s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0984s/iter; left time: 3140.0551s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0780s/iter; left time: 2481.1046s
Epoch: 23 cost time: 39.08197355270386
Epoch: 23, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.737 Vali Acc: 0.970 Test Loss: 0.737 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2019s/iter; left time: 6401.9723s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0899s/iter; left time: 2842.3604s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0880s/iter; left time: 2771.3466s
	iters: 400, epoch: 24 | loss: 0.5386755
	speed: 0.0962s/iter; left time: 3020.8182s
Epoch: 24 cost time: 38.64051556587219
Epoch: 24, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.613 Vali Acc: 0.972 Test Loss: 0.613 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2191s/iter; left time: 6856.2762s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.1174s/iter; left time: 3660.9436s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.1160s/iter; left time: 3606.5881s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.1099s/iter; left time: 3404.9902s
Epoch: 25 cost time: 47.30357122421265
Epoch: 25, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.511 Vali Acc: 0.973 Test Loss: 0.511 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2305s/iter; left time: 7115.5276s
	iters: 200, epoch: 26 | loss: 0.0023482
	speed: 0.1147s/iter; left time: 3531.4587s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.1190s/iter; left time: 3651.1076s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.1148s/iter; left time: 3510.9093s
Epoch: 26 cost time: 48.09163022041321
Epoch: 26, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.545 Vali Acc: 0.973 Test Loss: 0.545 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2361s/iter; left time: 7191.1941s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.1283s/iter; left time: 3895.6129s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.1268s/iter; left time: 3837.4061s
	iters: 400, epoch: 27 | loss: 3.2489173
	speed: 0.1327s/iter; left time: 4003.2834s
Epoch: 27 cost time: 52.54192519187927
Epoch: 27, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.888 Vali Acc: 0.964 Test Loss: 0.888 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2300s/iter; left time: 6911.1646s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.1151s/iter; left time: 3447.9173s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.1184s/iter; left time: 3533.4001s
	iters: 400, epoch: 28 | loss: 0.1212740
	speed: 0.1187s/iter; left time: 3531.5266s
Epoch: 28 cost time: 48.678606033325195
Epoch: 28, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.571 Vali Acc: 0.970 Test Loss: 0.571 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2185s/iter; left time: 6475.0664s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.1199s/iter; left time: 3541.5585s
	iters: 300, epoch: 29 | loss: 0.0000130
	speed: 0.1159s/iter; left time: 3411.7576s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.1108s/iter; left time: 3249.0849s
Epoch: 29 cost time: 46.783029556274414
Epoch: 29, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.594 Vali Acc: 0.972 Test Loss: 0.594 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2365s/iter; left time: 6911.0668s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.1176s/iter; left time: 3425.8860s
	iters: 300, epoch: 30 | loss: 0.0179078
	speed: 0.1214s/iter; left time: 3522.3134s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.1200s/iter; left time: 3469.7322s
Epoch: 30 cost time: 49.78334927558899
Epoch: 30, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.473 Vali Acc: 0.979 Test Loss: 0.473 Test Acc: 0.979
Validation loss decreased (-0.977712 --> -0.978622).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2335s/iter; left time: 6726.2271s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.1068s/iter; left time: 3066.7216s
	iters: 300, epoch: 31 | loss: 0.0898398
	speed: 0.1147s/iter; left time: 3282.3377s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.1153s/iter; left time: 3287.0710s
Epoch: 31 cost time: 45.956554889678955
Epoch: 31, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.555 Vali Acc: 0.970 Test Loss: 0.555 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1923s/iter; left time: 5461.5957s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0848s/iter; left time: 2399.9569s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0955s/iter; left time: 2694.3053s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0939s/iter; left time: 2639.4758s
Epoch: 32 cost time: 38.61604356765747
Epoch: 32, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.360 Vali Acc: 0.981 Test Loss: 0.360 Test Acc: 0.981
Validation loss decreased (-0.978622 --> -0.980897).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.2468928
	speed: 0.1845s/iter; left time: 5163.4699s
	iters: 200, epoch: 33 | loss: 0.0000094
	speed: 0.0811s/iter; left time: 2261.2723s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 2163.2443s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0758s/iter; left time: 2097.6807s
Epoch: 33 cost time: 33.18241214752197
Epoch: 33, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.577 Vali Acc: 0.978 Test Loss: 0.577 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1735s/iter; left time: 4784.7090s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 2093.2343s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 1892.1633s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 2073.7278s
Epoch: 34 cost time: 30.82921075820923
Epoch: 34, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.655 Vali Acc: 0.974 Test Loss: 0.655 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1856s/iter; left time: 5041.7373s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 2061.9493s
	iters: 300, epoch: 35 | loss: 1.0404822
	speed: 0.0717s/iter; left time: 1933.3751s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 2057.1300s
Epoch: 35 cost time: 32.25677180290222
Epoch: 35, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.549 Vali Acc: 0.971 Test Loss: 0.549 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.1752s/iter; left time: 4686.8302s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0728s/iter; left time: 1939.8012s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0815s/iter; left time: 2162.1761s
	iters: 400, epoch: 36 | loss: 0.0000006
	speed: 0.0747s/iter; left time: 1976.5006s
Epoch: 36 cost time: 31.71039342880249
Epoch: 36, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.714 Vali Acc: 0.973 Test Loss: 0.714 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1788s/iter; left time: 4709.4910s
	iters: 200, epoch: 37 | loss: 0.2756220
	speed: 0.0877s/iter; left time: 2300.0886s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.1104s/iter; left time: 2883.8824s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.1076s/iter; left time: 2801.8128s
Epoch: 37 cost time: 39.83929896354675
Epoch: 37, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.638 Vali Acc: 0.974 Test Loss: 0.638 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2232s/iter; left time: 5784.3112s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.1148s/iter; left time: 2964.9529s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.1177s/iter; left time: 3025.9723s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.1036s/iter; left time: 2654.7531s
Epoch: 38 cost time: 46.75426459312439
Epoch: 38, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.600 Vali Acc: 0.976 Test Loss: 0.600 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.2123s/iter; left time: 5414.3284s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 931.6689s
	iters: 300, epoch: 39 | loss: 0.1067138
	speed: 0.0319s/iter; left time: 807.3779s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1078.9606s
Epoch: 39 cost time: 21.728925704956055
Epoch: 39, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.528 Vali Acc: 0.975 Test Loss: 0.528 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0000012
	speed: 0.1558s/iter; left time: 3909.5422s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0977s/iter; left time: 2443.0428s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.1019s/iter; left time: 2537.1036s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.1171s/iter; left time: 2903.4849s
Epoch: 40 cost time: 41.147440910339355
Epoch: 40, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.645 Vali Acc: 0.971 Test Loss: 0.645 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.2331s/iter; left time: 5752.5435s
	iters: 200, epoch: 41 | loss: 0.0000001
	speed: 0.1075s/iter; left time: 2641.6113s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.1147s/iter; left time: 2807.5021s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0997s/iter; left time: 2430.0426s
Epoch: 41 cost time: 45.56793451309204
Epoch: 41, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.693 Vali Acc: 0.975 Test Loss: 0.693 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.2194s/iter; left time: 5324.1254s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.1099s/iter; left time: 2656.5492s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.1024s/iter; left time: 2463.4947s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.1172s/iter; left time: 2808.6235s
Epoch: 42 cost time: 45.55253481864929
Epoch: 42, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.769 Vali Acc: 0.969 Test Loss: 0.769 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 358794
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1178592
	speed: 0.1208s/iter; left time: 4977.9222s
	iters: 200, epoch: 1 | loss: 0.4295504
	speed: 0.1036s/iter; left time: 4259.0281s
	iters: 300, epoch: 1 | loss: 0.0491611
	speed: 0.1058s/iter; left time: 4337.3453s
	iters: 400, epoch: 1 | loss: 1.4977238
	speed: 0.0932s/iter; left time: 3812.5551s
Epoch: 1 cost time: 43.63047552108765
Epoch: 1, Steps: 413 | Train Loss: 0.373 Vali Loss: 0.122 Vali Acc: 0.960 Test Loss: 0.122 Test Acc: 0.960
Validation loss decreased (inf --> -0.959981).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4912351
	speed: 0.2043s/iter; left time: 8331.5650s
	iters: 200, epoch: 2 | loss: 0.0871648
	speed: 0.1059s/iter; left time: 4308.4350s
	iters: 300, epoch: 2 | loss: 0.0125951
	speed: 0.1028s/iter; left time: 4171.5616s
	iters: 400, epoch: 2 | loss: 0.0631429
	speed: 0.1074s/iter; left time: 4347.5661s
Epoch: 2 cost time: 43.16231107711792
Epoch: 2, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
Validation loss decreased (-0.959981 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000796
	speed: 0.1554s/iter; left time: 6273.4700s
	iters: 200, epoch: 3 | loss: 0.0220521
	speed: 0.0761s/iter; left time: 3062.9915s
	iters: 300, epoch: 3 | loss: 0.0000153
	speed: 0.0665s/iter; left time: 2671.3433s
	iters: 400, epoch: 3 | loss: 0.0004725
	speed: 0.0586s/iter; left time: 2350.2535s
Epoch: 3 cost time: 27.008185148239136
Epoch: 3, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.233 Vali Acc: 0.966 Test Loss: 0.233 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000833
	speed: 0.1603s/iter; left time: 6403.9943s
	iters: 200, epoch: 4 | loss: 0.0072902
	speed: 0.0725s/iter; left time: 2889.3704s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.0706s/iter; left time: 2807.4108s
	iters: 400, epoch: 4 | loss: 0.0963676
	speed: 0.0686s/iter; left time: 2719.4800s
Epoch: 4 cost time: 28.719489574432373
Epoch: 4, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.378 Vali Acc: 0.953 Test Loss: 0.378 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0100451
	speed: 0.1641s/iter; left time: 6488.3439s
	iters: 200, epoch: 5 | loss: 0.0699273
	speed: 0.0690s/iter; left time: 2721.8735s
	iters: 300, epoch: 5 | loss: 0.0000008
	speed: 0.0821s/iter; left time: 3232.3396s
	iters: 400, epoch: 5 | loss: 0.5219249
	speed: 0.0604s/iter; left time: 2369.5850s
Epoch: 5 cost time: 29.605876445770264
Epoch: 5, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.337 Vali Acc: 0.963 Test Loss: 0.337 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.1583s/iter; left time: 6196.7515s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 2418.0533s
	iters: 300, epoch: 6 | loss: 0.7404771
	speed: 0.0733s/iter; left time: 2855.4141s
	iters: 400, epoch: 6 | loss: 0.0939804
	speed: 0.0627s/iter; left time: 2434.3221s
Epoch: 6 cost time: 27.89970350265503
Epoch: 6, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.249 Vali Acc: 0.968 Test Loss: 0.249 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0004115
	speed: 0.1673s/iter; left time: 6478.3287s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 2004.9757s
	iters: 300, epoch: 7 | loss: 0.0879066
	speed: 0.0680s/iter; left time: 2620.3371s
	iters: 400, epoch: 7 | loss: 0.1034696
	speed: 0.1051s/iter; left time: 4036.7251s
Epoch: 7 cost time: 31.548457145690918
Epoch: 7, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.283 Vali Acc: 0.973 Test Loss: 0.283 Test Acc: 0.973
Validation loss decreased (-0.972259 --> -0.973167).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000029
	speed: 0.2092s/iter; left time: 8014.2363s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1006s/iter; left time: 3843.7895s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.1057s/iter; left time: 4029.1617s
	iters: 400, epoch: 8 | loss: 0.0000655
	speed: 0.0942s/iter; left time: 3579.7839s
Epoch: 8 cost time: 42.231684923172
Epoch: 8, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.314 Vali Acc: 0.972 Test Loss: 0.314 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0010772
	speed: 0.2207s/iter; left time: 8362.9268s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.1170s/iter; left time: 4421.2541s
	iters: 300, epoch: 9 | loss: 0.0000033
	speed: 0.1086s/iter; left time: 4093.1371s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1203s/iter; left time: 4522.4915s
Epoch: 9 cost time: 47.06968450546265
Epoch: 9, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.419 Vali Acc: 0.967 Test Loss: 0.419 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.3553013
	speed: 0.2301s/iter; left time: 8625.0267s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1193s/iter; left time: 4458.4017s
	iters: 300, epoch: 10 | loss: 0.1832955
	speed: 0.1250s/iter; left time: 4659.1015s
	iters: 400, epoch: 10 | loss: 0.0000009
	speed: 0.1281s/iter; left time: 4763.7527s
Epoch: 10 cost time: 51.45670008659363
Epoch: 10, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.431 Vali Acc: 0.968 Test Loss: 0.431 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000894
	speed: 0.2434s/iter; left time: 9024.1831s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1204s/iter; left time: 4450.9950s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1288s/iter; left time: 4747.7073s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1260s/iter; left time: 4634.0908s
Epoch: 11 cost time: 52.24798822402954
Epoch: 11, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.306 Vali Acc: 0.972 Test Loss: 0.306 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2397s/iter; left time: 8788.2391s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1247s/iter; left time: 4557.5393s
	iters: 300, epoch: 12 | loss: 0.0061967
	speed: 0.1134s/iter; left time: 4133.3806s
	iters: 400, epoch: 12 | loss: 0.0000006
	speed: 0.1084s/iter; left time: 3940.9467s
Epoch: 12 cost time: 48.44399094581604
Epoch: 12, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.563 Vali Acc: 0.964 Test Loss: 0.563 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000233
	speed: 0.1958s/iter; left time: 7094.9692s
	iters: 200, epoch: 13 | loss: 0.0000638
	speed: 0.0858s/iter; left time: 3101.4103s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0850s/iter; left time: 3064.0971s
	iters: 400, epoch: 13 | loss: 0.2743328
	speed: 0.0963s/iter; left time: 3462.7806s
Epoch: 13 cost time: 37.25793409347534
Epoch: 13, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.384 Vali Acc: 0.974 Test Loss: 0.384 Test Acc: 0.974
Validation loss decreased (-0.973167 --> -0.973621).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1880s/iter; left time: 6736.8732s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 2732.0265s
	iters: 300, epoch: 14 | loss: 0.5160850
	speed: 0.0828s/iter; left time: 2950.8477s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0792s/iter; left time: 2815.1940s
Epoch: 14 cost time: 33.79249691963196
Epoch: 14, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.305 Vali Acc: 0.973 Test Loss: 0.305 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1964s/iter; left time: 6955.8766s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 2351.8853s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 2434.9360s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0889s/iter; left time: 3123.4176s
Epoch: 15 cost time: 32.994346618652344
Epoch: 15, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.549 Vali Acc: 0.973 Test Loss: 0.549 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000061
	speed: 0.1886s/iter; left time: 6601.8678s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0852s/iter; left time: 2973.7065s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0856s/iter; left time: 2978.0033s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0857s/iter; left time: 2975.3730s
Epoch: 16 cost time: 35.42760181427002
Epoch: 16, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.658 Vali Acc: 0.968 Test Loss: 0.658 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000033
	speed: 0.2133s/iter; left time: 7377.2461s
	iters: 200, epoch: 17 | loss: 0.0000197
	speed: 0.1068s/iter; left time: 3685.0978s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1150s/iter; left time: 3955.4534s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1085s/iter; left time: 3721.8994s
Epoch: 17 cost time: 46.77202558517456
Epoch: 17, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.474 Vali Acc: 0.965 Test Loss: 0.474 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2258s/iter; left time: 7716.6930s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.1185s/iter; left time: 4038.3122s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1065s/iter; left time: 3620.0930s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1387s/iter; left time: 4699.2299s
Epoch: 18 cost time: 49.828996658325195
Epoch: 18, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.701 Vali Acc: 0.963 Test Loss: 0.701 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2598s/iter; left time: 8772.2861s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1360s/iter; left time: 4579.2262s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1348s/iter; left time: 4525.6345s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1307s/iter; left time: 4375.1454s
Epoch: 19 cost time: 55.59272217750549
Epoch: 19, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.449 Vali Acc: 0.973 Test Loss: 0.449 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2408s/iter; left time: 8032.4596s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1173s/iter; left time: 3901.0219s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.1199s/iter; left time: 3976.2654s
	iters: 400, epoch: 20 | loss: 0.0004789
	speed: 0.1320s/iter; left time: 4363.7678s
Epoch: 20 cost time: 50.13911747932434
Epoch: 20, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.373 Vali Acc: 0.975 Test Loss: 0.373 Test Acc: 0.975
Validation loss decreased (-0.973621 --> -0.974530).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2479s/iter; left time: 8164.9650s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.1169s/iter; left time: 3838.9734s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1099s/iter; left time: 3596.8266s
	iters: 400, epoch: 21 | loss: 0.3461309
	speed: 0.1232s/iter; left time: 4020.8654s
Epoch: 21 cost time: 49.26635479927063
Epoch: 21, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.855 Vali Acc: 0.957 Test Loss: 0.855 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0001677
	speed: 0.2298s/iter; left time: 7476.3238s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1227s/iter; left time: 3978.6336s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1178s/iter; left time: 3808.5012s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1185s/iter; left time: 3818.5752s
Epoch: 22 cost time: 49.42829942703247
Epoch: 22, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.350 Vali Acc: 0.982 Test Loss: 0.350 Test Acc: 0.982
Validation loss decreased (-0.974530 --> -0.982261).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2451s/iter; left time: 7872.4691s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.1024s/iter; left time: 3277.9933s
	iters: 300, epoch: 23 | loss: 0.3410935
	speed: 0.0931s/iter; left time: 2970.3932s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1065s/iter; left time: 3388.4233s
Epoch: 23 cost time: 43.70051455497742
Epoch: 23, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.439 Vali Acc: 0.970 Test Loss: 0.439 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2365s/iter; left time: 7497.8584s
	iters: 200, epoch: 24 | loss: 0.6514182
	speed: 0.1096s/iter; left time: 3464.4121s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.1029s/iter; left time: 3241.0588s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.1004s/iter; left time: 3154.1239s
Epoch: 24 cost time: 44.077881813049316
Epoch: 24, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.664 Vali Acc: 0.961 Test Loss: 0.664 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2309s/iter; left time: 7223.5095s
	iters: 200, epoch: 25 | loss: 0.3386039
	speed: 0.1122s/iter; left time: 3499.7741s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.1047s/iter; left time: 3255.3473s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.1113s/iter; left time: 3449.9547s
Epoch: 25 cost time: 46.12652349472046
Epoch: 25, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.653 Vali Acc: 0.970 Test Loss: 0.653 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2527s/iter; left time: 7802.7109s
	iters: 200, epoch: 26 | loss: 0.0000001
	speed: 0.1377s/iter; left time: 4238.2440s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.1438s/iter; left time: 4411.0708s
	iters: 400, epoch: 26 | loss: 0.0003411
	speed: 0.1396s/iter; left time: 4267.0487s
Epoch: 26 cost time: 57.78803372383118
Epoch: 26, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.387 Vali Acc: 0.972 Test Loss: 0.387 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2673s/iter; left time: 8143.2480s
	iters: 200, epoch: 27 | loss: 0.0792950
	speed: 0.1230s/iter; left time: 3735.1537s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.1456s/iter; left time: 4406.5696s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.1491s/iter; left time: 4497.7446s
Epoch: 27 cost time: 57.64772152900696
Epoch: 27, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.608 Vali Acc: 0.970 Test Loss: 0.608 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.2262438
	speed: 0.2877s/iter; left time: 8644.6278s
	iters: 200, epoch: 28 | loss: 0.0013942
	speed: 0.1533s/iter; left time: 4591.3211s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.1429s/iter; left time: 4266.2019s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.1443s/iter; left time: 4292.1031s
Epoch: 28 cost time: 60.64042091369629
Epoch: 28, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.326 Vali Acc: 0.980 Test Loss: 0.326 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2627s/iter; left time: 7785.5096s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.1365s/iter; left time: 4033.0863s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.1359s/iter; left time: 4001.0377s
	iters: 400, epoch: 29 | loss: 0.3214398
	speed: 0.1290s/iter; left time: 3785.5841s
Epoch: 29 cost time: 55.78067064285278
Epoch: 29, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.486 Vali Acc: 0.976 Test Loss: 0.486 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2912s/iter; left time: 8510.3022s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.1449s/iter; left time: 4219.0456s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.1333s/iter; left time: 3868.4256s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.1305s/iter; left time: 3775.4856s
Epoch: 30 cost time: 57.99544930458069
Epoch: 30, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.466 Vali Acc: 0.975 Test Loss: 0.466 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2662s/iter; left time: 7669.5009s
	iters: 200, epoch: 31 | loss: 0.0000003
	speed: 0.1297s/iter; left time: 3723.0849s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.1176s/iter; left time: 3365.4529s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0973s/iter; left time: 2773.7760s
Epoch: 31 cost time: 49.651490449905396
Epoch: 31, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.435 Vali Acc: 0.976 Test Loss: 0.435 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2177s/iter; left time: 6182.1561s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.1049s/iter; left time: 2968.4440s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.1067s/iter; left time: 3007.4941s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0937s/iter; left time: 2631.4429s
Epoch: 32 cost time: 42.07222056388855
Epoch: 32, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.457 Vali Acc: 0.977 Test Loss: 0.457 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 292362
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2281555
	speed: 0.0973s/iter; left time: 4007.2880s
	iters: 200, epoch: 1 | loss: 0.1847387
	speed: 0.0866s/iter; left time: 3560.4006s
	iters: 300, epoch: 1 | loss: 0.0275000
	speed: 0.0792s/iter; left time: 3246.2737s
	iters: 400, epoch: 1 | loss: 0.1031681
	speed: 0.0985s/iter; left time: 4029.6831s
Epoch: 1 cost time: 37.38524508476257
Epoch: 1, Steps: 413 | Train Loss: 0.357 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
Validation loss decreased (inf --> -0.959526).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4514672
	speed: 0.1952s/iter; left time: 7962.2233s
	iters: 200, epoch: 2 | loss: 0.2179674
	speed: 0.0824s/iter; left time: 3353.7766s
	iters: 300, epoch: 2 | loss: 1.8355964
	speed: 0.0904s/iter; left time: 3668.1108s
	iters: 400, epoch: 2 | loss: 0.0000835
	speed: 0.0916s/iter; left time: 3708.6827s
Epoch: 2 cost time: 36.78629159927368
Epoch: 2, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.223 Vali Acc: 0.947 Test Loss: 0.223 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3123021
	speed: 0.1847s/iter; left time: 7457.7454s
	iters: 200, epoch: 3 | loss: 0.0000771
	speed: 0.1212s/iter; left time: 4883.3026s
	iters: 300, epoch: 3 | loss: 0.0000132
	speed: 0.1172s/iter; left time: 4708.0104s
	iters: 400, epoch: 3 | loss: 0.9747465
	speed: 0.1149s/iter; left time: 4605.8552s
Epoch: 3 cost time: 45.2866473197937
Epoch: 3, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.211 Vali Acc: 0.959 Test Loss: 0.211 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0012838
	speed: 0.2269s/iter; left time: 9065.8190s
	iters: 200, epoch: 4 | loss: 0.0000352
	speed: 0.1386s/iter; left time: 5524.5860s
	iters: 300, epoch: 4 | loss: 0.0892570
	speed: 0.1394s/iter; left time: 5543.5549s
	iters: 400, epoch: 4 | loss: 0.0311523
	speed: 0.1359s/iter; left time: 5389.4957s
Epoch: 4 cost time: 55.412039041519165
Epoch: 4, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.959526 --> -0.977261).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000303
	speed: 0.2447s/iter; left time: 9675.9295s
	iters: 200, epoch: 5 | loss: 0.0000015
	speed: 0.1187s/iter; left time: 4682.6479s
	iters: 300, epoch: 5 | loss: 0.0000266
	speed: 0.1277s/iter; left time: 5023.5052s
	iters: 400, epoch: 5 | loss: 0.0767724
	speed: 0.1258s/iter; left time: 4936.7917s
Epoch: 5 cost time: 51.67036724090576
Epoch: 5, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.198 Vali Acc: 0.968 Test Loss: 0.198 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0018554
	speed: 0.2341s/iter; left time: 9160.2171s
	iters: 200, epoch: 6 | loss: 0.0002143
	speed: 0.1227s/iter; left time: 4789.8349s
	iters: 300, epoch: 6 | loss: 0.0031893
	speed: 0.1274s/iter; left time: 4960.6386s
	iters: 400, epoch: 6 | loss: 0.0645099
	speed: 0.1286s/iter; left time: 4995.0934s
Epoch: 6 cost time: 51.73412847518921
Epoch: 6, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.141 Vali Acc: 0.978 Test Loss: 0.141 Test Acc: 0.978
Validation loss decreased (-0.977261 --> -0.978170).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2321s/iter; left time: 8986.6966s
	iters: 200, epoch: 7 | loss: 0.2834671
	speed: 0.1237s/iter; left time: 4779.0253s
	iters: 300, epoch: 7 | loss: 0.0000017
	speed: 0.1193s/iter; left time: 4594.4100s
	iters: 400, epoch: 7 | loss: 0.0004662
	speed: 0.1213s/iter; left time: 4661.9599s
Epoch: 7 cost time: 50.44388699531555
Epoch: 7, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.246 Vali Acc: 0.970 Test Loss: 0.246 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000723
	speed: 0.2339s/iter; left time: 8961.0642s
	iters: 200, epoch: 8 | loss: 0.0000002
	speed: 0.1217s/iter; left time: 4649.3788s
	iters: 300, epoch: 8 | loss: 0.0000002
	speed: 0.1198s/iter; left time: 4567.0137s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.0870s/iter; left time: 3305.4236s
Epoch: 8 cost time: 45.99417448043823
Epoch: 8, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.273 Vali Acc: 0.972 Test Loss: 0.273 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2005s/iter; left time: 7597.9569s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1015s/iter; left time: 3835.3486s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0935s/iter; left time: 3523.1674s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0868s/iter; left time: 3265.2542s
Epoch: 9 cost time: 38.56687831878662
Epoch: 9, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2004s/iter; left time: 7510.8133s
	iters: 200, epoch: 10 | loss: 0.0001784
	speed: 0.0639s/iter; left time: 2387.1779s
	iters: 300, epoch: 10 | loss: 0.0000074
	speed: 0.0656s/iter; left time: 2445.2927s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0658s/iter; left time: 2448.0606s
Epoch: 10 cost time: 30.63817024230957
Epoch: 10, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.290 Vali Acc: 0.970 Test Loss: 0.290 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0002337
	speed: 0.1755s/iter; left time: 6505.7147s
	iters: 200, epoch: 11 | loss: 0.0000382
	speed: 0.0873s/iter; left time: 3227.5948s
	iters: 300, epoch: 11 | loss: 0.0013747
	speed: 0.0800s/iter; left time: 2950.5147s
	iters: 400, epoch: 11 | loss: 0.0000005
	speed: 0.0918s/iter; left time: 3374.8882s
Epoch: 11 cost time: 35.38569450378418
Epoch: 11, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.306 Vali Acc: 0.977 Test Loss: 0.306 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1951s/iter; left time: 7151.6527s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1000s/iter; left time: 3656.5723s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1144s/iter; left time: 4169.8066s
	iters: 400, epoch: 12 | loss: 0.0000002
	speed: 0.0958s/iter; left time: 3481.7587s
Epoch: 12 cost time: 42.03625464439392
Epoch: 12, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.419 Vali Acc: 0.964 Test Loss: 0.419 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0008747
	speed: 0.2399s/iter; left time: 8694.9881s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1306s/iter; left time: 4719.9330s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1368s/iter; left time: 4932.1283s
	iters: 400, epoch: 13 | loss: 0.0048552
	speed: 0.1304s/iter; left time: 4687.3188s
Epoch: 13 cost time: 54.71912097930908
Epoch: 13, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.369 Vali Acc: 0.963 Test Loss: 0.369 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2295s/iter; left time: 8221.7585s
	iters: 200, epoch: 14 | loss: 0.0002334
	speed: 0.1244s/iter; left time: 4444.0827s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1160s/iter; left time: 4131.5442s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1204s/iter; left time: 4278.9298s
Epoch: 14 cost time: 50.36608076095581
Epoch: 14, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.365 Vali Acc: 0.973 Test Loss: 0.365 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2141s/iter; left time: 7583.2634s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1165s/iter; left time: 4115.2134s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1156s/iter; left time: 4070.8493s
	iters: 400, epoch: 15 | loss: 0.2975430
	speed: 0.1187s/iter; left time: 4169.9952s
Epoch: 15 cost time: 47.76057457923889
Epoch: 15, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.421 Vali Acc: 0.965 Test Loss: 0.421 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2170s/iter; left time: 7595.1233s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1194s/iter; left time: 4167.8680s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1133s/iter; left time: 3942.4647s
	iters: 400, epoch: 16 | loss: 0.0083608
	speed: 0.1116s/iter; left time: 3873.1626s
Epoch: 16 cost time: 47.17148971557617
Epoch: 16, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.500 Vali Acc: 0.970 Test Loss: 0.500 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 250954
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2902323
	speed: 0.1239s/iter; left time: 5106.4928s
	iters: 200, epoch: 1 | loss: 0.0940258
	speed: 0.1160s/iter; left time: 4767.2698s
	iters: 300, epoch: 1 | loss: 0.1230359
	speed: 0.1101s/iter; left time: 4515.9723s
	iters: 400, epoch: 1 | loss: 0.1167270
	speed: 0.1076s/iter; left time: 4399.3398s
Epoch: 1 cost time: 47.276573181152344
Epoch: 1, Steps: 413 | Train Loss: 0.375 Vali Loss: 0.125 Vali Acc: 0.956 Test Loss: 0.125 Test Acc: 0.956
Validation loss decreased (inf --> -0.956343).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0005432
	speed: 0.1808s/iter; left time: 7373.6758s
	iters: 200, epoch: 2 | loss: 0.3059618
	speed: 0.0888s/iter; left time: 3611.3331s
	iters: 300, epoch: 2 | loss: 0.0033208
	speed: 0.0873s/iter; left time: 3541.8439s
	iters: 400, epoch: 2 | loss: 0.0777507
	speed: 0.0861s/iter; left time: 3485.5217s
Epoch: 2 cost time: 36.024369955062866
Epoch: 2, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.956343 --> -0.965438).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0016518
	speed: 0.1730s/iter; left time: 6983.8256s
	iters: 200, epoch: 3 | loss: 0.0033500
	speed: 0.0874s/iter; left time: 3518.5911s
	iters: 300, epoch: 3 | loss: 0.0000197
	speed: 0.0820s/iter; left time: 3296.0221s
	iters: 400, epoch: 3 | loss: 0.0060261
	speed: 0.0811s/iter; left time: 3251.0379s
Epoch: 3 cost time: 35.04286479949951
Epoch: 3, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
Validation loss decreased (-0.965438 --> -0.975442).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000055
	speed: 0.1672s/iter; left time: 6679.9081s
	iters: 200, epoch: 4 | loss: 0.1238195
	speed: 0.0619s/iter; left time: 2467.6740s
	iters: 300, epoch: 4 | loss: 0.0015324
	speed: 0.0730s/iter; left time: 2903.3648s
	iters: 400, epoch: 4 | loss: 0.0002147
	speed: 0.0886s/iter; left time: 3513.9795s
Epoch: 4 cost time: 31.597373723983765
Epoch: 4, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0338899
	speed: 0.1675s/iter; left time: 6622.7022s
	iters: 200, epoch: 5 | loss: 0.0000173
	speed: 0.0697s/iter; left time: 2749.0868s
	iters: 300, epoch: 5 | loss: 0.0694467
	speed: 0.0920s/iter; left time: 3619.7874s
	iters: 400, epoch: 5 | loss: 0.0000974
	speed: 0.0761s/iter; left time: 2988.2482s
Epoch: 5 cost time: 33.32102632522583
Epoch: 5, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.266 Vali Acc: 0.964 Test Loss: 0.266 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000029
	speed: 0.1796s/iter; left time: 7028.0516s
	iters: 200, epoch: 6 | loss: 0.0000221
	speed: 0.0917s/iter; left time: 3581.0843s
	iters: 300, epoch: 6 | loss: 0.0000058
	speed: 0.0691s/iter; left time: 2690.9337s
	iters: 400, epoch: 6 | loss: 1.1303681
	speed: 0.1136s/iter; left time: 4412.7660s
Epoch: 6 cost time: 37.18099594116211
Epoch: 6, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.217 Vali Acc: 0.967 Test Loss: 0.217 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.4576327
	speed: 0.1986s/iter; left time: 7690.0276s
	iters: 200, epoch: 7 | loss: 0.0172560
	speed: 0.1096s/iter; left time: 4231.8882s
	iters: 300, epoch: 7 | loss: 0.0000110
	speed: 0.1052s/iter; left time: 4053.1371s
	iters: 400, epoch: 7 | loss: 0.3264042
	speed: 0.1107s/iter; left time: 4254.3286s
Epoch: 7 cost time: 44.585811614990234
Epoch: 7, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.206 Vali Acc: 0.970 Test Loss: 0.206 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.2152s/iter; left time: 8244.1680s
	iters: 200, epoch: 8 | loss: 0.0006831
	speed: 0.1024s/iter; left time: 3914.6043s
	iters: 300, epoch: 8 | loss: 0.0000006
	speed: 0.1018s/iter; left time: 3880.1386s
	iters: 400, epoch: 8 | loss: 0.0144465
	speed: 0.1086s/iter; left time: 4128.7663s
Epoch: 8 cost time: 44.5965461730957
Epoch: 8, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.232 Vali Acc: 0.966 Test Loss: 0.232 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2166s/iter; left time: 8208.2014s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1037s/iter; left time: 3919.8852s
	iters: 300, epoch: 9 | loss: 0.0000029
	speed: 0.1049s/iter; left time: 3953.0138s
	iters: 400, epoch: 9 | loss: 0.0000235
	speed: 0.1099s/iter; left time: 4130.4278s
Epoch: 9 cost time: 45.09803080558777
Epoch: 9, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.182 Vali Acc: 0.976 Test Loss: 0.182 Test Acc: 0.976
Validation loss decreased (-0.975442 --> -0.975896).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0017949
	speed: 0.2067s/iter; left time: 7748.8649s
	iters: 200, epoch: 10 | loss: 0.0000066
	speed: 0.1056s/iter; left time: 3947.8235s
	iters: 300, epoch: 10 | loss: 0.0000007
	speed: 0.1041s/iter; left time: 3879.8132s
	iters: 400, epoch: 10 | loss: 0.2216357
	speed: 0.1083s/iter; left time: 4025.9465s
Epoch: 10 cost time: 44.426833152770996
Epoch: 10, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.132 Vali Acc: 0.981 Test Loss: 0.132 Test Acc: 0.981
Validation loss decreased (-0.975896 --> -0.981354).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0039073
	speed: 0.2019s/iter; left time: 7483.9895s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0946s/iter; left time: 3498.0837s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1020s/iter; left time: 3762.4841s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.1074s/iter; left time: 3949.4518s
Epoch: 11 cost time: 42.582982778549194
Epoch: 11, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.400 Vali Acc: 0.953 Test Loss: 0.400 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000007
	speed: 0.1670s/iter; left time: 6123.0145s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0471s/iter; left time: 1720.3371s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1722.8450s
	iters: 400, epoch: 12 | loss: 0.0226422
	speed: 0.0697s/iter; left time: 2535.0262s
Epoch: 12 cost time: 24.04740619659424
Epoch: 12, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.329 Vali Acc: 0.970 Test Loss: 0.329 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1571s/iter; left time: 5694.2854s
	iters: 200, epoch: 13 | loss: 0.0320013
	speed: 0.0618s/iter; left time: 2234.1823s
	iters: 300, epoch: 13 | loss: 0.0013149
	speed: 0.0749s/iter; left time: 2698.5569s
	iters: 400, epoch: 13 | loss: 0.0209457
	speed: 0.0646s/iter; left time: 2321.1279s
Epoch: 13 cost time: 28.45319104194641
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.297 Vali Acc: 0.974 Test Loss: 0.297 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000033
	speed: 0.1492s/iter; left time: 5344.6876s
	iters: 200, epoch: 14 | loss: 0.2156004
	speed: 0.0712s/iter; left time: 2543.9025s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 2253.0327s
	iters: 400, epoch: 14 | loss: 0.0000718
	speed: 0.0641s/iter; left time: 2276.5010s
Epoch: 14 cost time: 27.592965602874756
Epoch: 14, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.186 Vali Acc: 0.979 Test Loss: 0.186 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1659s/iter; left time: 5876.8985s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0755s/iter; left time: 2665.5674s
	iters: 300, epoch: 15 | loss: 0.1873731
	speed: 0.0605s/iter; left time: 2129.8000s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0623s/iter; left time: 2187.6059s
Epoch: 15 cost time: 29.263036727905273
Epoch: 15, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.312 Vali Acc: 0.973 Test Loss: 0.312 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1477s/iter; left time: 5170.7165s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0689s/iter; left time: 2405.7589s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0651s/iter; left time: 2267.0536s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 2544.7723s
Epoch: 16 cost time: 28.283085346221924
Epoch: 16, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.241 Vali Acc: 0.974 Test Loss: 0.241 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1873s/iter; left time: 6477.9222s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0947s/iter; left time: 3266.7733s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0846s/iter; left time: 2909.2988s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0903s/iter; left time: 3097.3284s
Epoch: 17 cost time: 38.54952812194824
Epoch: 17, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.478 Vali Acc: 0.959 Test Loss: 0.478 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000002
	speed: 0.2056s/iter; left time: 7026.1470s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1061s/iter; left time: 3616.8514s
	iters: 300, epoch: 18 | loss: 0.0000107
	speed: 0.1093s/iter; left time: 3713.7042s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1015s/iter; left time: 3439.7755s
Epoch: 18 cost time: 44.22371816635132
Epoch: 18, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.204 Vali Acc: 0.980 Test Loss: 0.204 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.7242852
	speed: 0.2111s/iter; left time: 7129.3246s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1002s/iter; left time: 3373.6015s
	iters: 300, epoch: 19 | loss: 0.0000184
	speed: 0.1077s/iter; left time: 3614.0340s
	iters: 400, epoch: 19 | loss: 0.0026128
	speed: 0.1062s/iter; left time: 3554.0418s
Epoch: 19 cost time: 44.41894817352295
Epoch: 19, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.493 Vali Acc: 0.966 Test Loss: 0.493 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2059s/iter; left time: 6866.7051s
	iters: 200, epoch: 20 | loss: 0.1811382
	speed: 0.1010s/iter; left time: 3357.9152s
	iters: 300, epoch: 20 | loss: 0.0000891
	speed: 0.1055s/iter; left time: 3498.9855s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0984s/iter; left time: 3253.2805s
Epoch: 20 cost time: 43.105992794036865
Epoch: 20, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.192 Vali Acc: 0.976 Test Loss: 0.192 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 209610
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4152001
	speed: 0.0655s/iter; left time: 2699.3510s
	iters: 200, epoch: 1 | loss: 0.0555480
	speed: 0.0504s/iter; left time: 2071.3554s
	iters: 300, epoch: 1 | loss: 0.0782212
	speed: 0.0469s/iter; left time: 1923.5290s
	iters: 400, epoch: 1 | loss: 0.1692994
	speed: 0.0465s/iter; left time: 1902.4679s
Epoch: 1 cost time: 21.60857582092285
Epoch: 1, Steps: 413 | Train Loss: 0.400 Vali Loss: 0.108 Vali Acc: 0.960 Test Loss: 0.108 Test Acc: 0.960
Validation loss decreased (inf --> -0.959981).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0733423
	speed: 0.1319s/iter; left time: 5378.3572s
	iters: 200, epoch: 2 | loss: 0.0104543
	speed: 0.0430s/iter; left time: 1749.3181s
	iters: 300, epoch: 2 | loss: 0.0020493
	speed: 0.0458s/iter; left time: 1859.4209s
	iters: 400, epoch: 2 | loss: 0.0063125
	speed: 0.0473s/iter; left time: 1916.0962s
Epoch: 2 cost time: 18.92953872680664
Epoch: 2, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.959981 --> -0.974533).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1931554
	speed: 0.1326s/iter; left time: 5354.6536s
	iters: 200, epoch: 3 | loss: 0.0061864
	speed: 0.0410s/iter; left time: 1650.2536s
	iters: 300, epoch: 3 | loss: 0.0097762
	speed: 0.0404s/iter; left time: 1621.2606s
	iters: 400, epoch: 3 | loss: 0.3988843
	speed: 0.0415s/iter; left time: 1661.2311s
Epoch: 3 cost time: 17.526191234588623
Epoch: 3, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8847914
	speed: 0.1285s/iter; left time: 5135.4219s
	iters: 200, epoch: 4 | loss: 0.0081086
	speed: 0.0403s/iter; left time: 1605.8638s
	iters: 300, epoch: 4 | loss: 0.0561764
	speed: 0.0433s/iter; left time: 1720.4414s
	iters: 400, epoch: 4 | loss: 0.0007055
	speed: 0.0403s/iter; left time: 1598.5225s
Epoch: 4 cost time: 17.259215116500854
Epoch: 4, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0006860
	speed: 0.1250s/iter; left time: 4942.4066s
	iters: 200, epoch: 5 | loss: 0.0190763
	speed: 0.0417s/iter; left time: 1646.4107s
	iters: 300, epoch: 5 | loss: 0.6235008
	speed: 0.0411s/iter; left time: 1618.6330s
	iters: 400, epoch: 5 | loss: 0.1084104
	speed: 0.0417s/iter; left time: 1634.7333s
Epoch: 5 cost time: 17.227426290512085
Epoch: 5, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.164 Vali Acc: 0.966 Test Loss: 0.164 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0026654
	speed: 0.1286s/iter; left time: 5032.7928s
	iters: 200, epoch: 6 | loss: 0.6976007
	speed: 0.0383s/iter; left time: 1494.5647s
	iters: 300, epoch: 6 | loss: 0.0000386
	speed: 0.0396s/iter; left time: 1542.3652s
	iters: 400, epoch: 6 | loss: 0.0003220
	speed: 0.0408s/iter; left time: 1586.0044s
Epoch: 6 cost time: 16.795836448669434
Epoch: 6, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0005743
	speed: 0.1161s/iter; left time: 4496.0179s
	iters: 200, epoch: 7 | loss: 0.0000038
	speed: 0.0402s/iter; left time: 1552.4823s
	iters: 300, epoch: 7 | loss: 0.0135894
	speed: 0.0461s/iter; left time: 1776.4031s
	iters: 400, epoch: 7 | loss: 0.0000002
	speed: 0.0439s/iter; left time: 1688.6570s
Epoch: 7 cost time: 18.081803798675537
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.205 Vali Acc: 0.969 Test Loss: 0.205 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0001058
	speed: 0.1280s/iter; left time: 4904.3569s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1643.9617s
	iters: 300, epoch: 8 | loss: 0.0001835
	speed: 0.0427s/iter; left time: 1628.7010s
	iters: 400, epoch: 8 | loss: 0.0000391
	speed: 0.0464s/iter; left time: 1762.1912s
Epoch: 8 cost time: 18.383126974105835
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.199 Vali Acc: 0.966 Test Loss: 0.199 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000562
	speed: 0.1200s/iter; left time: 4546.6141s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0440s/iter; left time: 1662.4123s
	iters: 300, epoch: 9 | loss: 0.4750309
	speed: 0.0455s/iter; left time: 1715.8266s
	iters: 400, epoch: 9 | loss: 0.0112633
	speed: 0.0446s/iter; left time: 1676.7185s
Epoch: 9 cost time: 18.225899696350098
Epoch: 9, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.381 Vali Acc: 0.955 Test Loss: 0.381 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0570713
	speed: 0.1335s/iter; left time: 5005.0648s
	iters: 200, epoch: 10 | loss: 0.0000073
	speed: 0.0494s/iter; left time: 1847.9119s
	iters: 300, epoch: 10 | loss: 0.0839463
	speed: 0.0476s/iter; left time: 1775.2972s
	iters: 400, epoch: 10 | loss: 0.0001168
	speed: 0.0546s/iter; left time: 2031.2783s
Epoch: 10 cost time: 21.264867067337036
Epoch: 10, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0184970
	speed: 0.1389s/iter; left time: 5150.8029s
	iters: 200, epoch: 11 | loss: 0.0000396
	speed: 0.0522s/iter; left time: 1931.2222s
	iters: 300, epoch: 11 | loss: 0.0000763
	speed: 0.0471s/iter; left time: 1736.6959s
	iters: 400, epoch: 11 | loss: 0.0000068
	speed: 0.0461s/iter; left time: 1694.9897s
Epoch: 11 cost time: 20.539463758468628
Epoch: 11, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.203 Vali Acc: 0.971 Test Loss: 0.203 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1328s/iter; left time: 4869.7507s
	iters: 200, epoch: 12 | loss: 0.0000058
	speed: 0.0456s/iter; left time: 1666.0930s
	iters: 300, epoch: 12 | loss: 0.2860194
	speed: 0.0480s/iter; left time: 1750.8363s
	iters: 400, epoch: 12 | loss: 0.0000340
	speed: 0.0511s/iter; left time: 1859.0586s
Epoch: 12 cost time: 20.210472583770752
Epoch: 12, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.179 Vali Acc: 0.973 Test Loss: 0.179 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9745338790359254
model parameter : 176650
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2636743
	speed: 0.0625s/iter; left time: 2573.2221s
	iters: 200, epoch: 1 | loss: 0.0611314
	speed: 0.0439s/iter; left time: 1804.6252s
	iters: 300, epoch: 1 | loss: 0.0405718
	speed: 0.0431s/iter; left time: 1768.0773s
	iters: 400, epoch: 1 | loss: 0.0156536
	speed: 0.0427s/iter; left time: 1747.0687s
Epoch: 1 cost time: 19.92719316482544
Epoch: 1, Steps: 413 | Train Loss: 0.428 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
Validation loss decreased (inf --> -0.968621).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4497938
	speed: 0.1365s/iter; left time: 5568.6440s
	iters: 200, epoch: 2 | loss: 0.0209966
	speed: 0.0451s/iter; left time: 1834.9543s
	iters: 300, epoch: 2 | loss: 0.0012458
	speed: 0.0473s/iter; left time: 1919.5132s
	iters: 400, epoch: 2 | loss: 0.3007214
	speed: 0.0467s/iter; left time: 1891.6059s
Epoch: 2 cost time: 19.569018363952637
Epoch: 2, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.119 Vali Acc: 0.963 Test Loss: 0.119 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0250581
	speed: 0.1328s/iter; left time: 5361.3745s
	iters: 200, epoch: 3 | loss: 0.0083322
	speed: 0.0440s/iter; left time: 1773.2939s
	iters: 300, epoch: 3 | loss: 0.0047412
	speed: 0.0426s/iter; left time: 1713.1762s
	iters: 400, epoch: 3 | loss: 0.0023542
	speed: 0.0441s/iter; left time: 1768.6814s
Epoch: 3 cost time: 18.842927932739258
Epoch: 3, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.968621 --> -0.969531).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0003645
	speed: 0.1325s/iter; left time: 5296.0981s
	iters: 200, epoch: 4 | loss: 0.1176677
	speed: 0.0467s/iter; left time: 1859.5963s
	iters: 300, epoch: 4 | loss: 0.0017786
	speed: 0.0463s/iter; left time: 1839.3568s
	iters: 400, epoch: 4 | loss: 0.5082535
	speed: 0.0450s/iter; left time: 1783.1155s
Epoch: 4 cost time: 19.376099109649658
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0054347
	speed: 0.1254s/iter; left time: 4958.7843s
	iters: 200, epoch: 5 | loss: 0.0060742
	speed: 0.0385s/iter; left time: 1517.2678s
	iters: 300, epoch: 5 | loss: 0.2455062
	speed: 0.0420s/iter; left time: 1654.5973s
	iters: 400, epoch: 5 | loss: 0.0847960
	speed: 0.0443s/iter; left time: 1738.1837s
Epoch: 5 cost time: 17.505696535110474
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.969531 --> -0.976352).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000043
	speed: 0.1284s/iter; left time: 5026.0091s
	iters: 200, epoch: 6 | loss: 0.0000565
	speed: 0.0473s/iter; left time: 1848.1689s
	iters: 300, epoch: 6 | loss: 0.0000877
	speed: 0.0437s/iter; left time: 1702.0166s
	iters: 400, epoch: 6 | loss: 0.8467074
	speed: 0.0446s/iter; left time: 1730.7127s
Epoch: 6 cost time: 19.056212663650513
Epoch: 6, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.976352 --> -0.977261).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0415584
	speed: 0.1193s/iter; left time: 4617.9154s
	iters: 200, epoch: 7 | loss: 0.0001362
	speed: 0.0349s/iter; left time: 1348.1205s
	iters: 300, epoch: 7 | loss: 0.0002765
	speed: 0.0384s/iter; left time: 1477.4788s
	iters: 400, epoch: 7 | loss: 0.1197668
	speed: 0.0387s/iter; left time: 1487.8962s
Epoch: 7 cost time: 16.151492834091187
Epoch: 7, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.175 Vali Acc: 0.970 Test Loss: 0.175 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.1236s/iter; left time: 4736.6798s
	iters: 200, epoch: 8 | loss: 0.0878937
	speed: 0.0408s/iter; left time: 1558.8179s
	iters: 300, epoch: 8 | loss: 0.0000025
	speed: 0.0392s/iter; left time: 1495.7889s
	iters: 400, epoch: 8 | loss: 0.0141825
	speed: 0.0391s/iter; left time: 1484.4161s
Epoch: 8 cost time: 16.9136803150177
Epoch: 8, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.276 Vali Acc: 0.962 Test Loss: 0.276 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0157645
	speed: 0.1235s/iter; left time: 4681.5973s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0404s/iter; left time: 1528.5258s
	iters: 300, epoch: 9 | loss: 0.0000021
	speed: 0.0414s/iter; left time: 1561.9049s
	iters: 400, epoch: 9 | loss: 0.0514743
	speed: 0.0404s/iter; left time: 1518.5267s
Epoch: 9 cost time: 17.265586853027344
Epoch: 9, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0346315
	speed: 0.1315s/iter; left time: 4930.3985s
	iters: 200, epoch: 10 | loss: 0.0038193
	speed: 0.0409s/iter; left time: 1527.7126s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 1431.0753s
	iters: 400, epoch: 10 | loss: 0.0000197
	speed: 0.0353s/iter; left time: 1313.8951s
Epoch: 10 cost time: 16.829362869262695
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.176 Vali Acc: 0.974 Test Loss: 0.176 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0010617
	speed: 0.1286s/iter; left time: 4767.1407s
	iters: 200, epoch: 11 | loss: 0.0000008
	speed: 0.0411s/iter; left time: 1520.1536s
	iters: 300, epoch: 11 | loss: 0.2665343
	speed: 0.0435s/iter; left time: 1602.6362s
	iters: 400, epoch: 11 | loss: 0.0600847
	speed: 0.0431s/iter; left time: 1583.1541s
Epoch: 11 cost time: 17.912738800048828
Epoch: 11, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000130
	speed: 0.1264s/iter; left time: 4633.4019s
	iters: 200, epoch: 12 | loss: 0.0001259
	speed: 0.0403s/iter; left time: 1473.9917s
	iters: 300, epoch: 12 | loss: 0.0000337
	speed: 0.0428s/iter; left time: 1559.6009s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0409s/iter; left time: 1488.3848s
Epoch: 12 cost time: 17.573437690734863
Epoch: 12, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000034
	speed: 0.1228s/iter; left time: 4449.4601s
	iters: 200, epoch: 13 | loss: 0.0004243
	speed: 0.0438s/iter; left time: 1582.0728s
	iters: 300, epoch: 13 | loss: 0.0000008
	speed: 0.0425s/iter; left time: 1530.2077s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 1456.2695s
Epoch: 13 cost time: 17.663649320602417
Epoch: 13, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
Validation loss decreased (-0.977261 --> -0.977716).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2191243
	speed: 0.1243s/iter; left time: 4452.6223s
	iters: 200, epoch: 14 | loss: 0.0021458
	speed: 0.0473s/iter; left time: 1691.3447s
	iters: 300, epoch: 14 | loss: 0.0000043
	speed: 0.0465s/iter; left time: 1657.8299s
	iters: 400, epoch: 14 | loss: 0.0000027
	speed: 0.0499s/iter; left time: 1772.9955s
Epoch: 14 cost time: 19.319167375564575
Epoch: 14, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.276 Vali Acc: 0.967 Test Loss: 0.276 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000055
	speed: 0.1358s/iter; left time: 4809.4931s
	iters: 200, epoch: 15 | loss: 0.0341324
	speed: 0.0458s/iter; left time: 1618.8234s
	iters: 300, epoch: 15 | loss: 0.0001525
	speed: 0.0440s/iter; left time: 1551.1128s
	iters: 400, epoch: 15 | loss: 0.0000105
	speed: 0.0457s/iter; left time: 1604.3709s
Epoch: 15 cost time: 19.3947594165802
Epoch: 15, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1751370
	speed: 0.1300s/iter; left time: 4550.0662s
	iters: 200, epoch: 16 | loss: 0.0000003
	speed: 0.0465s/iter; left time: 1622.6158s
	iters: 300, epoch: 16 | loss: 0.0003381
	speed: 0.0480s/iter; left time: 1671.1592s
	iters: 400, epoch: 16 | loss: 0.0667285
	speed: 0.0474s/iter; left time: 1644.5451s
Epoch: 16 cost time: 20.00570821762085
Epoch: 16, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.175 Vali Acc: 0.978 Test Loss: 0.175 Test Acc: 0.978
Validation loss decreased (-0.977716 --> -0.978170).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000005
	speed: 0.1372s/iter; left time: 4745.1379s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 1614.9570s
	iters: 300, epoch: 17 | loss: 0.0025013
	speed: 0.0460s/iter; left time: 1583.6961s
	iters: 400, epoch: 17 | loss: 0.0000020
	speed: 0.0459s/iter; left time: 1573.7075s
Epoch: 17 cost time: 19.92463994026184
Epoch: 17, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.185 Vali Acc: 0.973 Test Loss: 0.185 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0001940
	speed: 0.1285s/iter; left time: 4391.7725s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0442s/iter; left time: 1505.4871s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 1564.5422s
	iters: 400, epoch: 18 | loss: 0.6759825
	speed: 0.0441s/iter; left time: 1495.1210s
Epoch: 18 cost time: 18.939341068267822
Epoch: 18, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.266 Vali Acc: 0.972 Test Loss: 0.266 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1196211
	speed: 0.1354s/iter; left time: 4573.0604s
	iters: 200, epoch: 19 | loss: 0.0000005
	speed: 0.0448s/iter; left time: 1509.3652s
	iters: 300, epoch: 19 | loss: 0.0862687
	speed: 0.0471s/iter; left time: 1579.6923s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0458s/iter; left time: 1533.0336s
Epoch: 19 cost time: 19.56299138069153
Epoch: 19, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.312 Vali Acc: 0.964 Test Loss: 0.312 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000015
	speed: 0.1356s/iter; left time: 4521.4277s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 1525.9744s
	iters: 300, epoch: 20 | loss: 0.0000007
	speed: 0.0454s/iter; left time: 1505.9915s
	iters: 400, epoch: 20 | loss: 0.0000010
	speed: 0.0448s/iter; left time: 1480.8707s
Epoch: 20 cost time: 19.42621350288391
Epoch: 20, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000418
	speed: 0.1293s/iter; left time: 4259.8278s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 1384.5623s
	iters: 300, epoch: 21 | loss: 0.0345526
	speed: 0.0462s/iter; left time: 1511.6859s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1514.0577s
Epoch: 21 cost time: 18.972999572753906
Epoch: 21, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0002386
	speed: 0.1371s/iter; left time: 4460.9701s
	iters: 200, epoch: 22 | loss: 0.6357178
	speed: 0.0458s/iter; left time: 1484.8788s
	iters: 300, epoch: 22 | loss: 0.0000111
	speed: 0.0441s/iter; left time: 1424.0903s
	iters: 400, epoch: 22 | loss: 0.0019673
	speed: 0.0442s/iter; left time: 1424.1400s
Epoch: 22 cost time: 19.002278089523315
Epoch: 22, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000077
	speed: 0.1332s/iter; left time: 4278.1370s
	iters: 200, epoch: 23 | loss: 0.0020954
	speed: 0.0447s/iter; left time: 1432.0674s
	iters: 300, epoch: 23 | loss: 0.0012864
	speed: 0.0456s/iter; left time: 1455.5595s
	iters: 400, epoch: 23 | loss: 0.0000002
	speed: 0.0459s/iter; left time: 1459.7437s
Epoch: 23 cost time: 19.13959765434265
Epoch: 23, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.207 Vali Acc: 0.980 Test Loss: 0.207 Test Acc: 0.980
Validation loss decreased (-0.978170 --> -0.979534).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1307s/iter; left time: 4144.8903s
	iters: 200, epoch: 24 | loss: 0.0085770
	speed: 0.0363s/iter; left time: 1148.3036s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 1163.3388s
	iters: 400, epoch: 24 | loss: 0.0002981
	speed: 0.0384s/iter; left time: 1206.5270s
Epoch: 24 cost time: 16.782902717590332
Epoch: 24, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.213 Vali Acc: 0.976 Test Loss: 0.213 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1151s/iter; left time: 3600.4797s
	iters: 200, epoch: 25 | loss: 0.3344124
	speed: 0.0410s/iter; left time: 1277.7930s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 1264.4400s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1212.6824s
Epoch: 25 cost time: 16.84650945663452
Epoch: 25, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.223 Vali Acc: 0.978 Test Loss: 0.223 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000001
	speed: 0.1220s/iter; left time: 3765.8013s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0386s/iter; left time: 1188.4682s
	iters: 300, epoch: 26 | loss: 0.0130152
	speed: 0.0408s/iter; left time: 1251.4220s
	iters: 400, epoch: 26 | loss: 0.6031111
	speed: 0.0382s/iter; left time: 1168.4467s
Epoch: 26 cost time: 16.937944889068604
Epoch: 26, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.191 Vali Acc: 0.979 Test Loss: 0.191 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000001
	speed: 0.1184s/iter; left time: 3606.3136s
	iters: 200, epoch: 27 | loss: 0.3530538
	speed: 0.0399s/iter; left time: 1211.6746s
	iters: 300, epoch: 27 | loss: 0.0000111
	speed: 0.0411s/iter; left time: 1244.9905s
	iters: 400, epoch: 27 | loss: 0.0007766
	speed: 0.0376s/iter; left time: 1135.2632s
Epoch: 27 cost time: 16.838042974472046
Epoch: 27, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.249 Vali Acc: 0.974 Test Loss: 0.249 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0039975
	speed: 0.1224s/iter; left time: 3676.6862s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 1175.1725s
	iters: 300, epoch: 28 | loss: 0.0000006
	speed: 0.0378s/iter; left time: 1127.4258s
	iters: 400, epoch: 28 | loss: 0.0000004
	speed: 0.0418s/iter; left time: 1242.2839s
Epoch: 28 cost time: 16.8051700592041
Epoch: 28, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.429 Vali Acc: 0.960 Test Loss: 0.429 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000083
	speed: 0.1254s/iter; left time: 3715.0250s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0399s/iter; left time: 1177.3148s
	iters: 300, epoch: 29 | loss: 0.0000001
	speed: 0.0369s/iter; left time: 1085.7986s
	iters: 400, epoch: 29 | loss: 0.0130527
	speed: 0.0399s/iter; left time: 1169.6625s
Epoch: 29 cost time: 16.541516065597534
Epoch: 29, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.253 Vali Acc: 0.970 Test Loss: 0.253 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1258s/iter; left time: 3677.3907s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0399s/iter; left time: 1161.8887s
	iters: 300, epoch: 30 | loss: 1.0140280
	speed: 0.0427s/iter; left time: 1238.8322s
	iters: 400, epoch: 30 | loss: 0.0001507
	speed: 0.0395s/iter; left time: 1141.5693s
Epoch: 30 cost time: 17.119570016860962
Epoch: 30, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.358 Vali Acc: 0.962 Test Loss: 0.358 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000812
	speed: 0.1321s/iter; left time: 3805.4592s
	iters: 200, epoch: 31 | loss: 0.1335193
	speed: 0.0380s/iter; left time: 1089.6446s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1349.5115s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 1235.9159s
Epoch: 31 cost time: 18.05741310119629
Epoch: 31, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.307 Vali Acc: 0.968 Test Loss: 0.307 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1237s/iter; left time: 3512.2403s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 1232.4394s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 1357.5295s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 1198.5755s
Epoch: 32 cost time: 18.906811714172363
Epoch: 32, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.253 Vali Acc: 0.973 Test Loss: 0.253 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1211s/iter; left time: 3389.2959s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 1173.6784s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 1198.0271s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 1207.9961s
Epoch: 33 cost time: 18.067902088165283
Epoch: 33, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.182 Vali Acc: 0.980 Test Loss: 0.182 Test Acc: 0.980
Validation loss decreased (-0.979534 --> -0.979989).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1231s/iter; left time: 3395.0208s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 1201.5437s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 1178.9259s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0434s/iter; left time: 1183.4549s
Epoch: 34 cost time: 18.126824378967285
Epoch: 34, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.185 Vali Acc: 0.979 Test Loss: 0.185 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0000004
	speed: 0.1253s/iter; left time: 3402.0356s
	iters: 200, epoch: 35 | loss: 0.0000001
	speed: 0.0431s/iter; left time: 1166.5549s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 1116.7485s
	iters: 400, epoch: 35 | loss: 0.0473749
	speed: 0.0452s/iter; left time: 1214.6007s
Epoch: 35 cost time: 18.239195346832275
Epoch: 35, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.223 Vali Acc: 0.976 Test Loss: 0.223 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0692790
	speed: 0.1229s/iter; left time: 3285.7571s
	iters: 200, epoch: 36 | loss: 0.0001230
	speed: 0.0424s/iter; left time: 1129.6566s
	iters: 300, epoch: 36 | loss: 0.0001288
	speed: 0.0409s/iter; left time: 1085.3024s
	iters: 400, epoch: 36 | loss: 0.0004857
	speed: 0.0405s/iter; left time: 1070.4366s
Epoch: 36 cost time: 17.570698976516724
Epoch: 36, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.213 Vali Acc: 0.981 Test Loss: 0.213 Test Acc: 0.981
Validation loss decreased (-0.979989 --> -0.980898).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1315s/iter; left time: 3461.6097s
	iters: 200, epoch: 37 | loss: 0.0000498
	speed: 0.0414s/iter; left time: 1086.3907s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 1150.4490s
	iters: 400, epoch: 37 | loss: 0.0000006
	speed: 0.0428s/iter; left time: 1113.7383s
Epoch: 37 cost time: 18.05486798286438
Epoch: 37, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.336 Vali Acc: 0.973 Test Loss: 0.336 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.1345s/iter; left time: 3485.5057s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 1045.3491s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 1074.9910s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0401s/iter; left time: 1026.7631s
Epoch: 38 cost time: 17.629661083221436
Epoch: 38, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.310 Vali Acc: 0.970 Test Loss: 0.310 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.1259s/iter; left time: 3210.7190s
	iters: 200, epoch: 39 | loss: 0.0000156
	speed: 0.0412s/iter; left time: 1046.4180s
	iters: 300, epoch: 39 | loss: 0.0000015
	speed: 0.0433s/iter; left time: 1096.8876s
	iters: 400, epoch: 39 | loss: 0.0000001
	speed: 0.0422s/iter; left time: 1064.1395s
Epoch: 39 cost time: 17.929872512817383
Epoch: 39, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.328 Vali Acc: 0.970 Test Loss: 0.328 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0000002
	speed: 0.1290s/iter; left time: 3235.9477s
	iters: 200, epoch: 40 | loss: 0.0327763
	speed: 0.0411s/iter; left time: 1026.0061s
	iters: 300, epoch: 40 | loss: 0.0096366
	speed: 0.0406s/iter; left time: 1010.7288s
	iters: 400, epoch: 40 | loss: 0.0000001
	speed: 0.0394s/iter; left time: 977.7257s
Epoch: 40 cost time: 17.45866060256958
Epoch: 40, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.308 Vali Acc: 0.969 Test Loss: 0.308 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.1150s/iter; left time: 2838.3898s
	iters: 200, epoch: 41 | loss: 0.0000036
	speed: 0.0369s/iter; left time: 907.3431s
	iters: 300, epoch: 41 | loss: 0.1384527
	speed: 0.0359s/iter; left time: 878.0849s
	iters: 400, epoch: 41 | loss: 0.0011983
	speed: 0.0362s/iter; left time: 882.7289s
Epoch: 41 cost time: 15.389256000518799
Epoch: 41, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.391 Vali Acc: 0.969 Test Loss: 0.391 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0002071
	speed: 0.1194s/iter; left time: 2896.7317s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.0378s/iter; left time: 913.3542s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0345s/iter; left time: 830.1177s
	iters: 400, epoch: 42 | loss: 0.0000002
	speed: 0.0364s/iter; left time: 872.6141s
Epoch: 42 cost time: 15.728179693222046
Epoch: 42, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.363 Vali Acc: 0.971 Test Loss: 0.363 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.1145s/iter; left time: 2732.3324s
	iters: 200, epoch: 43 | loss: 0.0000001
	speed: 0.0372s/iter; left time: 883.2549s
	iters: 300, epoch: 43 | loss: 0.0000000
	speed: 0.0372s/iter; left time: 880.6513s
	iters: 400, epoch: 43 | loss: 0.0000000
	speed: 0.0360s/iter; left time: 849.0609s
Epoch: 43 cost time: 15.616053104400635
Epoch: 43, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.1151s/iter; left time: 2697.1829s
	iters: 200, epoch: 44 | loss: 0.0000075
	speed: 0.0374s/iter; left time: 873.0109s
	iters: 300, epoch: 44 | loss: 0.0000011
	speed: 0.0326s/iter; left time: 758.3257s
	iters: 400, epoch: 44 | loss: 0.0014643
	speed: 0.0368s/iter; left time: 852.0027s
Epoch: 44 cost time: 15.536206245422363
Epoch: 44, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.285 Vali Acc: 0.970 Test Loss: 0.285 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.0000000
	speed: 0.1168s/iter; left time: 2690.3647s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 854.4454s
	iters: 300, epoch: 45 | loss: 0.0000828
	speed: 0.0359s/iter; left time: 819.2991s
	iters: 400, epoch: 45 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 799.8485s
Epoch: 45 cost time: 15.644125938415527
Epoch: 45, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.253 Vali Acc: 0.980 Test Loss: 0.253 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.0000216
	speed: 0.1151s/iter; left time: 2602.1300s
	iters: 200, epoch: 46 | loss: 0.0000005
	speed: 0.0363s/iter; left time: 817.3314s
	iters: 300, epoch: 46 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 766.4324s
	iters: 400, epoch: 46 | loss: 0.0000005
	speed: 0.0341s/iter; left time: 760.3033s
Epoch: 46 cost time: 14.929619312286377
Epoch: 46, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.305 Vali Acc: 0.971 Test Loss: 0.305 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 160330
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2395700
	speed: 0.1464s/iter; left time: 6031.1073s
	iters: 200, epoch: 1 | loss: 0.1072604
	speed: 0.1252s/iter; left time: 5144.2120s
	iters: 300, epoch: 1 | loss: 0.7463654
	speed: 0.1198s/iter; left time: 4912.6580s
	iters: 400, epoch: 1 | loss: 0.0016062
	speed: 0.1222s/iter; left time: 4999.6849s
Epoch: 1 cost time: 53.043726205825806
Epoch: 1, Steps: 413 | Train Loss: 0.397 Vali Loss: 0.233 Vali Acc: 0.951 Test Loss: 0.233 Test Acc: 0.951
Validation loss decreased (inf --> -0.950884).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0353216
	speed: 0.2465s/iter; left time: 10053.2189s
	iters: 200, epoch: 2 | loss: 0.0102848
	speed: 0.1162s/iter; left time: 4727.3916s
	iters: 300, epoch: 2 | loss: 0.0066715
	speed: 0.1232s/iter; left time: 4999.3399s
	iters: 400, epoch: 2 | loss: 0.0000006
	speed: 0.1240s/iter; left time: 5018.5835s
Epoch: 2 cost time: 50.20397663116455
Epoch: 2, Steps: 413 | Train Loss: 0.185 Vali Loss: 0.162 Vali Acc: 0.965 Test Loss: 0.162 Test Acc: 0.965
Validation loss decreased (-0.950884 --> -0.965437).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000008
	speed: 0.2458s/iter; left time: 9923.6067s
	iters: 200, epoch: 3 | loss: 0.0000124
	speed: 0.1342s/iter; left time: 5405.7327s
	iters: 300, epoch: 3 | loss: 0.0005170
	speed: 0.1410s/iter; left time: 5665.6634s
	iters: 400, epoch: 3 | loss: 0.0000619
	speed: 0.1446s/iter; left time: 5796.7339s
Epoch: 3 cost time: 55.89335560798645
Epoch: 3, Steps: 413 | Train Loss: 0.176 Vali Loss: 0.472 Vali Acc: 0.956 Test Loss: 0.472 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000005
	speed: 0.2521s/iter; left time: 10073.9384s
	iters: 200, epoch: 4 | loss: 0.8093134
	speed: 0.1238s/iter; left time: 4934.9617s
	iters: 300, epoch: 4 | loss: 0.0386722
	speed: 0.1285s/iter; left time: 5111.3162s
	iters: 400, epoch: 4 | loss: 0.0314835
	speed: 0.1292s/iter; left time: 5125.1981s
Epoch: 4 cost time: 51.873639822006226
Epoch: 4, Steps: 413 | Train Loss: 0.168 Vali Loss: 0.539 Vali Acc: 0.942 Test Loss: 0.539 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.2514s/iter; left time: 9943.2080s
	iters: 200, epoch: 5 | loss: 0.0000411
	speed: 0.1276s/iter; left time: 5031.9574s
	iters: 300, epoch: 5 | loss: 0.0260641
	speed: 0.0966s/iter; left time: 3803.0558s
	iters: 400, epoch: 5 | loss: 0.0034563
	speed: 0.0911s/iter; left time: 3576.1913s
Epoch: 5 cost time: 45.20231866836548
Epoch: 5, Steps: 413 | Train Loss: 0.131 Vali Loss: 0.483 Vali Acc: 0.959 Test Loss: 0.483 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1282591
	speed: 0.2025s/iter; left time: 7924.8100s
	iters: 200, epoch: 6 | loss: 0.0000005
	speed: 0.0872s/iter; left time: 3404.1916s
	iters: 300, epoch: 6 | loss: 0.0068592
	speed: 0.0932s/iter; left time: 3627.1402s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.1012s/iter; left time: 3930.2500s
Epoch: 6 cost time: 38.52641201019287
Epoch: 6, Steps: 413 | Train Loss: 0.156 Vali Loss: 0.567 Vali Acc: 0.948 Test Loss: 0.567 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2108s/iter; left time: 8164.5152s
	iters: 200, epoch: 7 | loss: 0.1397843
	speed: 0.0894s/iter; left time: 3454.0348s
	iters: 300, epoch: 7 | loss: 0.0000032
	speed: 0.0982s/iter; left time: 3781.0779s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0979s/iter; left time: 3763.1324s
Epoch: 7 cost time: 40.338037967681885
Epoch: 7, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.712 Vali Acc: 0.958 Test Loss: 0.712 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1198772
	speed: 0.2178s/iter; left time: 8342.2131s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0924s/iter; left time: 3530.7482s
	iters: 300, epoch: 8 | loss: 0.0015630
	speed: 0.0887s/iter; left time: 3378.4862s
	iters: 400, epoch: 8 | loss: 0.6995552
	speed: 0.0930s/iter; left time: 3533.6548s
Epoch: 8 cost time: 38.95724940299988
Epoch: 8, Steps: 413 | Train Loss: 0.136 Vali Loss: 1.330 Vali Acc: 0.911 Test Loss: 1.330 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000004
	speed: 0.2124s/iter; left time: 8049.4135s
	iters: 200, epoch: 9 | loss: 0.0000496
	speed: 0.1268s/iter; left time: 4791.3808s
	iters: 300, epoch: 9 | loss: 0.0021113
	speed: 0.1306s/iter; left time: 4924.2420s
	iters: 400, epoch: 9 | loss: 0.0142071
	speed: 0.1219s/iter; left time: 4584.7473s
Epoch: 9 cost time: 50.20570135116577
Epoch: 9, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.653 Vali Acc: 0.964 Test Loss: 0.653 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2647s/iter; left time: 9920.3684s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1234s/iter; left time: 4614.6008s
	iters: 300, epoch: 10 | loss: 0.1207827
	speed: 0.1316s/iter; left time: 4907.2981s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1223s/iter; left time: 4549.1566s
Epoch: 10 cost time: 52.709683656692505
Epoch: 10, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.704 Vali Acc: 0.966 Test Loss: 0.704 Test Acc: 0.966
Validation loss decreased (-0.965437 --> -0.965887).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2696s/iter; left time: 9995.8791s
	iters: 200, epoch: 11 | loss: 0.0000685
	speed: 0.1249s/iter; left time: 4618.5966s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1299s/iter; left time: 4791.2612s
	iters: 400, epoch: 11 | loss: 0.0357966
	speed: 0.1290s/iter; left time: 4742.7319s
Epoch: 11 cost time: 54.3229284286499
Epoch: 11, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.604 Vali Acc: 0.962 Test Loss: 0.604 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.4816902
	speed: 0.2643s/iter; left time: 9688.2012s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1311s/iter; left time: 4793.2131s
	iters: 300, epoch: 12 | loss: 0.5664856
	speed: 0.1277s/iter; left time: 4656.4737s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1294s/iter; left time: 4704.9557s
Epoch: 12 cost time: 54.126545906066895
Epoch: 12, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.495 Vali Acc: 0.972 Test Loss: 0.495 Test Acc: 0.972
Validation loss decreased (-0.965887 --> -0.972255).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0083188
	speed: 0.2628s/iter; left time: 9524.2181s
	iters: 200, epoch: 13 | loss: 0.0000002
	speed: 0.1249s/iter; left time: 4513.8081s
	iters: 300, epoch: 13 | loss: 1.3551083
	speed: 0.1225s/iter; left time: 4416.7239s
	iters: 400, epoch: 13 | loss: 0.4172465
	speed: 0.0897s/iter; left time: 3225.6021s
Epoch: 13 cost time: 48.361953020095825
Epoch: 13, Steps: 413 | Train Loss: 0.153 Vali Loss: 0.538 Vali Acc: 0.969 Test Loss: 0.538 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2006s/iter; left time: 7186.8684s
	iters: 200, epoch: 14 | loss: 0.0001780
	speed: 0.0822s/iter; left time: 2936.2945s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0967s/iter; left time: 3446.3414s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0946s/iter; left time: 3362.0392s
Epoch: 14 cost time: 37.81032347679138
Epoch: 14, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.777 Vali Acc: 0.964 Test Loss: 0.777 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2084s/iter; left time: 7379.6499s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0857s/iter; left time: 3026.5244s
	iters: 300, epoch: 15 | loss: 0.1021049
	speed: 0.0939s/iter; left time: 3307.2983s
	iters: 400, epoch: 15 | loss: 0.4920880
	speed: 0.0958s/iter; left time: 3363.4358s
Epoch: 15 cost time: 38.7737603187561
Epoch: 15, Steps: 413 | Train Loss: 0.124 Vali Loss: 1.314 Vali Acc: 0.941 Test Loss: 1.314 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000348
	speed: 0.2148s/iter; left time: 7519.2022s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0965s/iter; left time: 3367.4290s
	iters: 300, epoch: 16 | loss: 2.9956548
	speed: 0.0970s/iter; left time: 3375.3606s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1069s/iter; left time: 3711.1660s
Epoch: 16 cost time: 41.38069701194763
Epoch: 16, Steps: 413 | Train Loss: 0.098 Vali Loss: 1.204 Vali Acc: 0.956 Test Loss: 1.204 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2083s/iter; left time: 7204.6921s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1085s/iter; left time: 3742.7187s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1290s/iter; left time: 4435.2730s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1222s/iter; left time: 4189.8887s
Epoch: 17 cost time: 47.28895449638367
Epoch: 17, Steps: 413 | Train Loss: 0.084 Vali Loss: 1.029 Vali Acc: 0.958 Test Loss: 1.029 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000658
	speed: 0.2598s/iter; left time: 8879.1258s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1316s/iter; left time: 4484.6589s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1250s/iter; left time: 4247.4047s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1310s/iter; left time: 4439.1266s
Epoch: 18 cost time: 54.01308035850525
Epoch: 18, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.696 Vali Acc: 0.971 Test Loss: 0.696 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2532s/iter; left time: 8549.7444s
	iters: 200, epoch: 19 | loss: 0.6805232
	speed: 0.1236s/iter; left time: 4160.5190s
	iters: 300, epoch: 19 | loss: 0.8673428
	speed: 0.1246s/iter; left time: 4181.2153s
	iters: 400, epoch: 19 | loss: 0.0000219
	speed: 0.1496s/iter; left time: 5008.0445s
Epoch: 19 cost time: 54.503814935684204
Epoch: 19, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.873 Vali Acc: 0.967 Test Loss: 0.873 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2853s/iter; left time: 9514.3908s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1484s/iter; left time: 4935.5867s
	iters: 300, epoch: 20 | loss: 0.0000001
	speed: 0.1225s/iter; left time: 4061.9070s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.1319s/iter; left time: 4361.2047s
Epoch: 20 cost time: 56.62279415130615
Epoch: 20, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.973 Vali Acc: 0.960 Test Loss: 0.973 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2559s/iter; left time: 8428.7255s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.1319s/iter; left time: 4332.2340s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1228s/iter; left time: 4020.7417s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.1242s/iter; left time: 4054.8864s
Epoch: 21 cost time: 51.48322606086731
Epoch: 21, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.995 Vali Acc: 0.964 Test Loss: 0.995 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2109s/iter; left time: 6859.3156s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0775s/iter; left time: 2513.9103s
	iters: 300, epoch: 22 | loss: 0.5006019
	speed: 0.0878s/iter; left time: 2839.1016s
	iters: 400, epoch: 22 | loss: 0.0009163
	speed: 0.0762s/iter; left time: 2457.1869s
Epoch: 22 cost time: 35.57379913330078
Epoch: 22, Steps: 413 | Train Loss: 0.070 Vali Loss: 1.354 Vali Acc: 0.950 Test Loss: 1.354 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9722601182355616
model parameter : 467018
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3915127
	speed: 0.0906s/iter; left time: 3734.6806s
	iters: 200, epoch: 1 | loss: 0.9641899
	speed: 0.0563s/iter; left time: 2313.5318s
	iters: 300, epoch: 1 | loss: 1.0126586
	speed: 0.0889s/iter; left time: 3645.5607s
	iters: 400, epoch: 1 | loss: 0.7268534
	speed: 0.0650s/iter; left time: 2657.1973s
Epoch: 1 cost time: 31.362682819366455
Epoch: 1, Steps: 413 | Train Loss: 0.353 Vali Loss: 0.217 Vali Acc: 0.956 Test Loss: 0.217 Test Acc: 0.956
Validation loss decreased (inf --> -0.956342).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0021741
	speed: 0.1594s/iter; left time: 6503.6433s
	iters: 200, epoch: 2 | loss: 1.1872798
	speed: 0.0809s/iter; left time: 3292.5482s
	iters: 300, epoch: 2 | loss: 0.0072146
	speed: 0.0818s/iter; left time: 3319.5019s
	iters: 400, epoch: 2 | loss: 0.0812394
	speed: 0.0784s/iter; left time: 3175.9128s
Epoch: 2 cost time: 31.798845529556274
Epoch: 2, Steps: 413 | Train Loss: 0.145 Vali Loss: 0.223 Vali Acc: 0.963 Test Loss: 0.223 Test Acc: 0.963
Validation loss decreased (-0.956342 --> -0.962708).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0008872
	speed: 0.1765s/iter; left time: 7127.0075s
	iters: 200, epoch: 3 | loss: 0.2829799
	speed: 0.0823s/iter; left time: 3314.8225s
	iters: 300, epoch: 3 | loss: 0.0002701
	speed: 0.0929s/iter; left time: 3732.5027s
	iters: 400, epoch: 3 | loss: 0.0000025
	speed: 0.1107s/iter; left time: 4438.0742s
Epoch: 3 cost time: 38.45669078826904
Epoch: 3, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.320 Vali Acc: 0.959 Test Loss: 0.320 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0996049
	speed: 0.2070s/iter; left time: 8272.0928s
	iters: 200, epoch: 4 | loss: 0.0000477
	speed: 0.0948s/iter; left time: 3779.9201s
	iters: 300, epoch: 4 | loss: 0.0001366
	speed: 0.1073s/iter; left time: 4265.8273s
	iters: 400, epoch: 4 | loss: 0.0000319
	speed: 0.1145s/iter; left time: 4542.8087s
Epoch: 4 cost time: 43.607937812805176
Epoch: 4, Steps: 413 | Train Loss: 0.149 Vali Loss: 0.333 Vali Acc: 0.958 Test Loss: 0.333 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3283978
	speed: 0.2395s/iter; left time: 9473.0363s
	iters: 200, epoch: 5 | loss: 0.9304195
	speed: 0.1182s/iter; left time: 4662.0449s
	iters: 300, epoch: 5 | loss: 0.0000002
	speed: 0.1315s/iter; left time: 5173.3933s
	iters: 400, epoch: 5 | loss: 0.0005956
	speed: 0.1122s/iter; left time: 4402.2606s
Epoch: 5 cost time: 51.15530610084534
Epoch: 5, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.281 Vali Acc: 0.971 Test Loss: 0.281 Test Acc: 0.971
Validation loss decreased (-0.962708 --> -0.970893).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4059678
	speed: 0.2362s/iter; left time: 9243.9074s
	iters: 200, epoch: 6 | loss: 0.0014261
	speed: 0.1098s/iter; left time: 4285.8006s
	iters: 300, epoch: 6 | loss: 0.0056213
	speed: 0.1298s/iter; left time: 5052.8829s
	iters: 400, epoch: 6 | loss: 0.0762257
	speed: 0.1149s/iter; left time: 4461.2815s
Epoch: 6 cost time: 49.25512218475342
Epoch: 6, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.361 Vali Acc: 0.970 Test Loss: 0.361 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0011771
	speed: 0.2352s/iter; left time: 9108.0243s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.1222s/iter; left time: 4720.2213s
	iters: 300, epoch: 7 | loss: 0.0088274
	speed: 0.1230s/iter; left time: 4738.0194s
	iters: 400, epoch: 7 | loss: 0.0106200
	speed: 0.1063s/iter; left time: 4085.5423s
Epoch: 7 cost time: 49.00493884086609
Epoch: 7, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.497 Vali Acc: 0.959 Test Loss: 0.497 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000069
	speed: 0.2349s/iter; left time: 8997.5891s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1273s/iter; left time: 4865.9092s
	iters: 300, epoch: 8 | loss: 0.0000458
	speed: 0.1247s/iter; left time: 4753.5032s
	iters: 400, epoch: 8 | loss: 0.0020368
	speed: 0.1190s/iter; left time: 4523.3320s
Epoch: 8 cost time: 50.112952709198
Epoch: 8, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.349 Vali Acc: 0.971 Test Loss: 0.349 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2245861
	speed: 0.2054s/iter; left time: 7784.8977s
	iters: 200, epoch: 9 | loss: 0.0000036
	speed: 0.1035s/iter; left time: 3910.3166s
	iters: 300, epoch: 9 | loss: 0.7746395
	speed: 0.1016s/iter; left time: 3830.1315s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0866s/iter; left time: 3257.2678s
Epoch: 9 cost time: 40.36397337913513
Epoch: 9, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.520 Vali Acc: 0.961 Test Loss: 0.520 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0008990
	speed: 0.2026s/iter; left time: 7595.9038s
	iters: 200, epoch: 10 | loss: 0.4519703
	speed: 0.0960s/iter; left time: 3589.9063s
	iters: 300, epoch: 10 | loss: 0.4208432
	speed: 0.1114s/iter; left time: 4155.0285s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0754s/iter; left time: 2801.9909s
Epoch: 10 cost time: 38.68626093864441
Epoch: 10, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.570 Vali Acc: 0.961 Test Loss: 0.570 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2093s/iter; left time: 7760.0632s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0881s/iter; left time: 3257.9829s
	iters: 300, epoch: 11 | loss: 0.1384176
	speed: 0.1105s/iter; left time: 4073.8130s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0864s/iter; left time: 3178.7473s
Epoch: 11 cost time: 40.31824326515198
Epoch: 11, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.677 Vali Acc: 0.962 Test Loss: 0.677 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2081s/iter; left time: 7626.9353s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0835s/iter; left time: 3051.0656s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1108s/iter; left time: 4038.4207s
	iters: 400, epoch: 12 | loss: 0.0004434
	speed: 0.1099s/iter; left time: 3996.3166s
Epoch: 12 cost time: 42.899994134902954
Epoch: 12, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.657 Vali Acc: 0.966 Test Loss: 0.657 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2610s/iter; left time: 9458.9627s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1197s/iter; left time: 4328.0514s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1147s/iter; left time: 4133.8933s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1199s/iter; left time: 4311.3459s
Epoch: 13 cost time: 51.509087562561035
Epoch: 13, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.685 Vali Acc: 0.963 Test Loss: 0.685 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000706
	speed: 0.2435s/iter; left time: 8726.5302s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1152s/iter; left time: 4117.1036s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1277s/iter; left time: 4550.2986s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1162s/iter; left time: 4128.9009s
Epoch: 14 cost time: 50.640384674072266
Epoch: 14, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.511 Vali Acc: 0.971 Test Loss: 0.511 Test Acc: 0.971
Validation loss decreased (-0.970893 --> -0.971346).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0003331
	speed: 0.2464s/iter; left time: 8726.6491s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1212s/iter; left time: 4278.9147s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1365s/iter; left time: 4807.5084s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1176s/iter; left time: 4131.2416s
Epoch: 15 cost time: 51.9717116355896
Epoch: 15, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.724 Vali Acc: 0.964 Test Loss: 0.724 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2440s/iter; left time: 8540.1946s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1273s/iter; left time: 4444.6941s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1316s/iter; left time: 4580.2103s
	iters: 400, epoch: 16 | loss: 0.5556836
	speed: 0.1196s/iter; left time: 4151.4263s
Epoch: 16 cost time: 52.241753578186035
Epoch: 16, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.635 Vali Acc: 0.959 Test Loss: 0.635 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000306
	speed: 0.2428s/iter; left time: 8400.5925s
	iters: 200, epoch: 17 | loss: 1.3141274
	speed: 0.1202s/iter; left time: 4145.4914s
	iters: 300, epoch: 17 | loss: 0.0003088
	speed: 0.0951s/iter; left time: 3270.8431s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1055s/iter; left time: 3618.0960s
Epoch: 17 cost time: 45.61872839927673
Epoch: 17, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.707 Vali Acc: 0.959 Test Loss: 0.707 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1829s/iter; left time: 6251.1436s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0714s/iter; left time: 2434.4172s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 2656.5174s
	iters: 400, epoch: 18 | loss: 0.2154378
	speed: 0.0810s/iter; left time: 2745.0016s
Epoch: 18 cost time: 32.24435305595398
Epoch: 18, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.643 Vali Acc: 0.965 Test Loss: 0.643 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1631s/iter; left time: 5505.7782s
	iters: 200, epoch: 19 | loss: 1.2390629
	speed: 0.0689s/iter; left time: 2318.8487s
	iters: 300, epoch: 19 | loss: 0.7487690
	speed: 0.0697s/iter; left time: 2338.4709s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0697s/iter; left time: 2331.0033s
Epoch: 19 cost time: 28.954451322555542
Epoch: 19, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.488 Vali Acc: 0.971 Test Loss: 0.488 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1663s/iter; left time: 5546.2052s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0633s/iter; left time: 2104.5305s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0737s/iter; left time: 2441.9750s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0764s/iter; left time: 2525.4404s
Epoch: 20 cost time: 30.00410485267639
Epoch: 20, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.516 Vali Acc: 0.966 Test Loss: 0.516 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.3841607
	speed: 0.1639s/iter; left time: 5397.6450s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0756s/iter; left time: 2482.4084s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2545.9526s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0721s/iter; left time: 2352.4368s
Epoch: 21 cost time: 31.28131651878357
Epoch: 21, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.614 Vali Acc: 0.966 Test Loss: 0.614 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1685s/iter; left time: 5481.6510s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0755s/iter; left time: 2448.5752s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1058s/iter; left time: 3420.1118s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1049s/iter; left time: 3379.2583s
Epoch: 22 cost time: 38.31910014152527
Epoch: 22, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.721 Vali Acc: 0.966 Test Loss: 0.721 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2015s/iter; left time: 6469.7412s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.1023s/iter; left time: 3274.9775s
	iters: 300, epoch: 23 | loss: 0.1681368
	speed: 0.1034s/iter; left time: 3298.4933s
	iters: 400, epoch: 23 | loss: 0.0000002
	speed: 0.0997s/iter; left time: 3172.4541s
Epoch: 23 cost time: 42.313530921936035
Epoch: 23, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.363 Vali Acc: 0.980 Test Loss: 0.363 Test Acc: 0.980
Validation loss decreased (-0.971346 --> -0.979987).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2040s/iter; left time: 6468.4715s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.1018s/iter; left time: 3218.4199s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.1018s/iter; left time: 3205.6823s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0983s/iter; left time: 3085.6031s
Epoch: 24 cost time: 42.03153729438782
Epoch: 24, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.724 Vali Acc: 0.965 Test Loss: 0.724 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000558
	speed: 0.1996s/iter; left time: 6244.3243s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.1013s/iter; left time: 3158.4222s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.1002s/iter; left time: 3114.2291s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.1017s/iter; left time: 3151.8613s
Epoch: 25 cost time: 42.120370388031006
Epoch: 25, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.712 Vali Acc: 0.968 Test Loss: 0.712 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000001
	speed: 0.1903s/iter; left time: 5875.2995s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0944s/iter; left time: 2904.8051s
	iters: 300, epoch: 26 | loss: 0.4005223
	speed: 0.0996s/iter; left time: 3054.1939s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.0978s/iter; left time: 2988.8508s
Epoch: 26 cost time: 40.0880913734436
Epoch: 26, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.562 Vali Acc: 0.971 Test Loss: 0.562 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1976s/iter; left time: 6019.9332s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.1003s/iter; left time: 3045.1717s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0971s/iter; left time: 2938.4049s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 2096.9614s
Epoch: 27 cost time: 37.86040258407593
Epoch: 27, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.659 Vali Acc: 0.968 Test Loss: 0.659 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1572s/iter; left time: 4724.4146s
	iters: 200, epoch: 28 | loss: 0.0000058
	speed: 0.0732s/iter; left time: 2193.7002s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0715s/iter; left time: 2133.5438s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 2122.6392s
Epoch: 28 cost time: 29.73122477531433
Epoch: 28, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.640 Vali Acc: 0.973 Test Loss: 0.640 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1639s/iter; left time: 4858.6083s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 2039.8503s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0696s/iter; left time: 2049.1917s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0636s/iter; left time: 1865.5673s
Epoch: 29 cost time: 29.15209412574768
Epoch: 29, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.396 Vali Acc: 0.980 Test Loss: 0.396 Test Acc: 0.980
Validation loss decreased (-0.979987 --> -0.980442).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1495s/iter; left time: 4369.0052s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0727s/iter; left time: 2116.4588s
	iters: 300, epoch: 30 | loss: 0.0000002
	speed: 0.0737s/iter; left time: 2138.9565s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0749s/iter; left time: 2166.2328s
Epoch: 30 cost time: 29.708056926727295
Epoch: 30, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.611 Vali Acc: 0.974 Test Loss: 0.611 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1662s/iter; left time: 4789.1669s
	iters: 200, epoch: 31 | loss: 0.0066173
	speed: 0.0711s/iter; left time: 2042.7753s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0674s/iter; left time: 1929.0989s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 1716.6526s
Epoch: 31 cost time: 29.003392457962036
Epoch: 31, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.549 Vali Acc: 0.976 Test Loss: 0.549 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0208488
	speed: 0.2109s/iter; left time: 5988.2619s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.1156s/iter; left time: 3271.2666s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.1148s/iter; left time: 3236.8815s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.1141s/iter; left time: 3206.0896s
Epoch: 32 cost time: 47.468419313430786
Epoch: 32, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.473 Vali Acc: 0.971 Test Loss: 0.473 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0007551
	speed: 0.2249s/iter; left time: 6293.7904s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0977s/iter; left time: 2723.9125s
	iters: 300, epoch: 33 | loss: 0.0000029
	speed: 0.1047s/iter; left time: 2908.9291s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.1042s/iter; left time: 2885.5111s
Epoch: 33 cost time: 43.73215961456299
Epoch: 33, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.548 Vali Acc: 0.968 Test Loss: 0.548 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2062s/iter; left time: 5684.8900s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0974s/iter; left time: 2675.2047s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0992s/iter; left time: 2715.0187s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.1058s/iter; left time: 2885.4866s
Epoch: 34 cost time: 42.318968772888184
Epoch: 34, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.459 Vali Acc: 0.972 Test Loss: 0.459 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2080s/iter; left time: 5648.5281s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.1035s/iter; left time: 2800.8158s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.1029s/iter; left time: 2773.2831s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.1043s/iter; left time: 2801.8321s
Epoch: 35 cost time: 42.73885202407837
Epoch: 35, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.682 Vali Acc: 0.960 Test Loss: 0.682 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2110s/iter; left time: 5644.6239s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.1035s/iter; left time: 2756.8958s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.1018s/iter; left time: 2703.3749s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.1002s/iter; left time: 2650.2987s
Epoch: 36 cost time: 42.644455909729004
Epoch: 36, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.656 Vali Acc: 0.968 Test Loss: 0.656 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1858s/iter; left time: 4893.3749s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0715s/iter; left time: 1875.4920s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0775s/iter; left time: 2025.0056s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0843s/iter; left time: 2194.2707s
Epoch: 37 cost time: 32.85368347167969
Epoch: 37, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.612 Vali Acc: 0.972 Test Loss: 0.612 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.1820s/iter; left time: 4718.7148s
	iters: 200, epoch: 38 | loss: 0.0000096
	speed: 0.0872s/iter; left time: 2250.2633s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 1987.8844s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0701s/iter; left time: 1795.6302s
Epoch: 38 cost time: 33.53999853134155
Epoch: 38, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.540 Vali Acc: 0.970 Test Loss: 0.540 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.1645s/iter; left time: 4195.6857s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0735s/iter; left time: 1867.7453s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0847s/iter; left time: 2143.3639s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0865s/iter; left time: 2179.8027s
Epoch: 39 cost time: 32.91111636161804
Epoch: 39, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.482 Vali Acc: 0.975 Test Loss: 0.482 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 334026
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0615423
	speed: 0.0908s/iter; left time: 3742.7127s
	iters: 200, epoch: 1 | loss: 0.1655915
	speed: 0.0850s/iter; left time: 3494.2035s
	iters: 300, epoch: 1 | loss: 0.4421007
	speed: 0.0648s/iter; left time: 2655.0328s
	iters: 400, epoch: 1 | loss: 0.6809772
	speed: 0.1021s/iter; left time: 4175.9255s
Epoch: 1 cost time: 35.63106346130371
Epoch: 1, Steps: 413 | Train Loss: 0.377 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
Validation loss decreased (inf --> -0.924508).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0002229
	speed: 0.1975s/iter; left time: 8055.1596s
	iters: 200, epoch: 2 | loss: 0.1619448
	speed: 0.1049s/iter; left time: 4268.6976s
	iters: 300, epoch: 2 | loss: 0.0464095
	speed: 0.1029s/iter; left time: 4177.6528s
	iters: 400, epoch: 2 | loss: 0.5686046
	speed: 0.1051s/iter; left time: 4254.9252s
Epoch: 2 cost time: 43.252134799957275
Epoch: 2, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.924508 --> -0.957706).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0090824
	speed: 0.1970s/iter; left time: 7954.9020s
	iters: 200, epoch: 3 | loss: 0.0050786
	speed: 0.0900s/iter; left time: 3622.8678s
	iters: 300, epoch: 3 | loss: 0.0014043
	speed: 0.0920s/iter; left time: 3697.0880s
	iters: 400, epoch: 3 | loss: 0.6151793
	speed: 0.0983s/iter; left time: 3940.0240s
Epoch: 3 cost time: 39.553956508636475
Epoch: 3, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.228 Vali Acc: 0.961 Test Loss: 0.228 Test Acc: 0.961
Validation loss decreased (-0.957706 --> -0.960889).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0002379
	speed: 0.1966s/iter; left time: 7857.5028s
	iters: 200, epoch: 4 | loss: 0.0001415
	speed: 0.0987s/iter; left time: 3933.2103s
	iters: 300, epoch: 4 | loss: 0.0000026
	speed: 0.1007s/iter; left time: 4002.5400s
	iters: 400, epoch: 4 | loss: 0.6696104
	speed: 0.0958s/iter; left time: 3799.4436s
Epoch: 4 cost time: 41.092238426208496
Epoch: 4, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.311 Vali Acc: 0.963 Test Loss: 0.311 Test Acc: 0.963
Validation loss decreased (-0.960889 --> -0.963162).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000007
	speed: 0.1955s/iter; left time: 7730.5235s
	iters: 200, epoch: 5 | loss: 0.0000017
	speed: 0.0985s/iter; left time: 3887.0763s
	iters: 300, epoch: 5 | loss: 0.1585782
	speed: 0.1048s/iter; left time: 4123.5385s
	iters: 400, epoch: 5 | loss: 0.0026351
	speed: 0.0968s/iter; left time: 3801.2035s
Epoch: 5 cost time: 41.603710412979126
Epoch: 5, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.366 Vali Acc: 0.961 Test Loss: 0.366 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0001177
	speed: 0.1933s/iter; left time: 7565.7977s
	iters: 200, epoch: 6 | loss: 0.0048887
	speed: 0.1008s/iter; left time: 3935.9986s
	iters: 300, epoch: 6 | loss: 0.6941060
	speed: 0.0963s/iter; left time: 3749.5454s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.1011s/iter; left time: 3927.0496s
Epoch: 6 cost time: 41.53101944923401
Epoch: 6, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.178 Vali Acc: 0.979 Test Loss: 0.178 Test Acc: 0.979
Validation loss decreased (-0.963162 --> -0.978625).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0004251
	speed: 0.1589s/iter; left time: 6151.1852s
	iters: 200, epoch: 7 | loss: 0.0000012
	speed: 0.0723s/iter; left time: 2793.2837s
	iters: 300, epoch: 7 | loss: 0.7988649
	speed: 0.0750s/iter; left time: 2887.8831s
	iters: 400, epoch: 7 | loss: 0.0000004
	speed: 0.0797s/iter; left time: 3063.5475s
Epoch: 7 cost time: 31.014525413513184
Epoch: 7, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.420 Vali Acc: 0.960 Test Loss: 0.420 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1658s/iter; left time: 6350.6233s
	iters: 200, epoch: 8 | loss: 0.1486254
	speed: 0.0760s/iter; left time: 2903.9836s
	iters: 300, epoch: 8 | loss: 0.5003037
	speed: 0.0741s/iter; left time: 2825.5873s
	iters: 400, epoch: 8 | loss: 0.0002138
	speed: 0.0685s/iter; left time: 2602.7323s
Epoch: 8 cost time: 31.196202754974365
Epoch: 8, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.468 Vali Acc: 0.964 Test Loss: 0.468 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1492s/iter; left time: 5655.5314s
	iters: 200, epoch: 9 | loss: 0.0000056
	speed: 0.0646s/iter; left time: 2442.2318s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0657s/iter; left time: 2477.1837s
	iters: 400, epoch: 9 | loss: 0.0000098
	speed: 0.0673s/iter; left time: 2531.7716s
Epoch: 9 cost time: 27.42544388771057
Epoch: 9, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.367 Vali Acc: 0.968 Test Loss: 0.367 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1513s/iter; left time: 5672.9861s
	iters: 200, epoch: 10 | loss: 0.0134948
	speed: 0.0731s/iter; left time: 2731.6811s
	iters: 300, epoch: 10 | loss: 0.8256357
	speed: 0.0616s/iter; left time: 2297.6006s
	iters: 400, epoch: 10 | loss: 0.0922453
	speed: 0.0577s/iter; left time: 2145.8728s
Epoch: 10 cost time: 27.065452814102173
Epoch: 10, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.343 Vali Acc: 0.968 Test Loss: 0.343 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1497s/iter; left time: 5549.9837s
	iters: 200, epoch: 11 | loss: 0.7593051
	speed: 0.0432s/iter; left time: 1597.8479s
	iters: 300, epoch: 11 | loss: 0.9426531
	speed: 0.0280s/iter; left time: 1033.2658s
	iters: 400, epoch: 11 | loss: 0.0588445
	speed: 0.0569s/iter; left time: 2092.4417s
Epoch: 11 cost time: 20.814453601837158
Epoch: 11, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.243 Vali Acc: 0.974 Test Loss: 0.243 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000007
	speed: 0.1799s/iter; left time: 6595.2076s
	iters: 200, epoch: 12 | loss: 0.0000003
	speed: 0.0854s/iter; left time: 3122.8197s
	iters: 300, epoch: 12 | loss: 0.0017845
	speed: 0.0908s/iter; left time: 3312.0222s
	iters: 400, epoch: 12 | loss: 0.1374316
	speed: 0.0877s/iter; left time: 3189.0006s
Epoch: 12 cost time: 36.978585720062256
Epoch: 12, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.373 Vali Acc: 0.967 Test Loss: 0.373 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000003
	speed: 0.1677s/iter; left time: 6079.2572s
	iters: 200, epoch: 13 | loss: 0.1980675
	speed: 0.0302s/iter; left time: 1092.9473s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 1045.6539s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 1136.0134s
Epoch: 13 cost time: 17.769986391067505
Epoch: 13, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.547 Vali Acc: 0.963 Test Loss: 0.547 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0824s/iter; left time: 2954.1181s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 982.2989s
	iters: 300, epoch: 14 | loss: 0.2347237
	speed: 0.0270s/iter; left time: 963.5770s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 1944.5443s
Epoch: 14 cost time: 15.330705404281616
Epoch: 14, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.550 Vali Acc: 0.965 Test Loss: 0.550 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.2579033
	speed: 0.1854s/iter; left time: 6566.8167s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0971s/iter; left time: 3429.3030s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0974s/iter; left time: 3430.7331s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0910s/iter; left time: 3196.2919s
Epoch: 15 cost time: 39.71743607521057
Epoch: 15, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.448 Vali Acc: 0.963 Test Loss: 0.448 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000038
	speed: 0.1998s/iter; left time: 6995.4243s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1050s/iter; left time: 3665.0514s
	iters: 300, epoch: 16 | loss: 0.0000062
	speed: 0.1064s/iter; left time: 3704.9862s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1055s/iter; left time: 3660.9143s
Epoch: 16 cost time: 44.245505571365356
Epoch: 16, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.748 Vali Acc: 0.960 Test Loss: 0.748 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9786266484765803
model parameter : 267594
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4904954
	speed: 0.1224s/iter; left time: 5041.2726s
	iters: 200, epoch: 1 | loss: 0.1171931
	speed: 0.1025s/iter; left time: 4211.8525s
	iters: 300, epoch: 1 | loss: 0.0388012
	speed: 0.0932s/iter; left time: 3820.6456s
	iters: 400, epoch: 1 | loss: 0.0007370
	speed: 0.0953s/iter; left time: 3896.8266s
Epoch: 1 cost time: 42.5760235786438
Epoch: 1, Steps: 413 | Train Loss: 0.366 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (inf --> -0.969531).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0259587
	speed: 0.1843s/iter; left time: 7515.2968s
	iters: 200, epoch: 2 | loss: 0.0209906
	speed: 0.0926s/iter; left time: 3767.2494s
	iters: 300, epoch: 2 | loss: 0.0521723
	speed: 0.0948s/iter; left time: 3846.1704s
	iters: 400, epoch: 2 | loss: 0.0059242
	speed: 0.0967s/iter; left time: 3916.8140s
Epoch: 2 cost time: 39.43281960487366
Epoch: 2, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.969531 --> -0.972714).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0018761
	speed: 0.1580s/iter; left time: 6379.1108s
	iters: 200, epoch: 3 | loss: 0.0001100
	speed: 0.0602s/iter; left time: 2424.5918s
	iters: 300, epoch: 3 | loss: 0.2079077
	speed: 0.0703s/iter; left time: 2825.5011s
	iters: 400, epoch: 3 | loss: 0.0003987
	speed: 0.0578s/iter; left time: 2314.9158s
Epoch: 3 cost time: 27.111615657806396
Epoch: 3, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0045727
	speed: 0.1381s/iter; left time: 5519.2469s
	iters: 200, epoch: 4 | loss: 0.0055487
	speed: 0.0465s/iter; left time: 1852.0527s
	iters: 300, epoch: 4 | loss: 0.0001422
	speed: 0.0549s/iter; left time: 2181.0989s
	iters: 400, epoch: 4 | loss: 0.0000332
	speed: 0.0544s/iter; left time: 2156.3834s
Epoch: 4 cost time: 22.211324214935303
Epoch: 4, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000047
	speed: 0.1259s/iter; left time: 4977.7713s
	iters: 200, epoch: 5 | loss: 0.0000314
	speed: 0.0597s/iter; left time: 2354.5587s
	iters: 300, epoch: 5 | loss: 0.0000163
	speed: 0.0626s/iter; left time: 2463.4144s
	iters: 400, epoch: 5 | loss: 0.0000326
	speed: 0.0488s/iter; left time: 1916.6871s
Epoch: 5 cost time: 22.3483145236969
Epoch: 5, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.201 Vali Acc: 0.967 Test Loss: 0.201 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.8537860
	speed: 0.1437s/iter; left time: 5622.8332s
	iters: 200, epoch: 6 | loss: 0.0008126
	speed: 0.0582s/iter; left time: 2272.0085s
	iters: 300, epoch: 6 | loss: 0.0166785
	speed: 0.0584s/iter; left time: 2274.3237s
	iters: 400, epoch: 6 | loss: 0.1266847
	speed: 0.0694s/iter; left time: 2697.0080s
Epoch: 6 cost time: 25.839713096618652
Epoch: 6, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.203 Vali Acc: 0.971 Test Loss: 0.203 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000009
	speed: 0.1492s/iter; left time: 5776.3472s
	iters: 200, epoch: 7 | loss: 0.0169658
	speed: 0.0835s/iter; left time: 3223.8924s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.1010s/iter; left time: 3891.6678s
	iters: 400, epoch: 7 | loss: 0.0019730
	speed: 0.0923s/iter; left time: 3547.7376s
Epoch: 7 cost time: 35.58786082267761
Epoch: 7, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.227 Vali Acc: 0.972 Test Loss: 0.227 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000893
	speed: 0.1809s/iter; left time: 6930.8690s
	iters: 200, epoch: 8 | loss: 0.0428066
	speed: 0.0990s/iter; left time: 3781.0017s
	iters: 300, epoch: 8 | loss: 0.0220339
	speed: 0.0960s/iter; left time: 3656.9368s
	iters: 400, epoch: 8 | loss: 0.0000135
	speed: 0.1013s/iter; left time: 3848.7939s
Epoch: 8 cost time: 40.63342046737671
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.253 Vali Acc: 0.962 Test Loss: 0.253 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000237
	speed: 0.1903s/iter; left time: 7213.5763s
	iters: 200, epoch: 9 | loss: 0.0000156
	speed: 0.0909s/iter; left time: 3435.1585s
	iters: 300, epoch: 9 | loss: 0.0000269
	speed: 0.0981s/iter; left time: 3698.8547s
	iters: 400, epoch: 9 | loss: 0.0000018
	speed: 0.0955s/iter; left time: 3592.2814s
Epoch: 9 cost time: 40.147167682647705
Epoch: 9, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.315 Vali Acc: 0.967 Test Loss: 0.315 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.3499249
	speed: 0.1845s/iter; left time: 6917.5196s
	iters: 200, epoch: 10 | loss: 0.0002670
	speed: 0.0918s/iter; left time: 3432.8354s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0874s/iter; left time: 3258.1565s
	iters: 400, epoch: 10 | loss: 0.5593351
	speed: 0.0944s/iter; left time: 3509.0314s
Epoch: 10 cost time: 38.13554263114929
Epoch: 10, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
Validation loss decreased (-0.972714 --> -0.974987).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1843s/iter; left time: 6833.7521s
	iters: 200, epoch: 11 | loss: 0.0003224
	speed: 0.0905s/iter; left time: 3344.5169s
	iters: 300, epoch: 11 | loss: 0.3582025
	speed: 0.0860s/iter; left time: 3170.5267s
	iters: 400, epoch: 11 | loss: 0.0003577
	speed: 0.0944s/iter; left time: 3470.5490s
Epoch: 11 cost time: 37.81688928604126
Epoch: 11, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.344 Vali Acc: 0.970 Test Loss: 0.344 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1232866
	speed: 0.1483s/iter; left time: 5434.6892s
	iters: 200, epoch: 12 | loss: 0.0000024
	speed: 0.0463s/iter; left time: 1693.8798s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0508s/iter; left time: 1852.0585s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0704s/iter; left time: 2558.7024s
Epoch: 12 cost time: 23.896795988082886
Epoch: 12, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.369 Vali Acc: 0.971 Test Loss: 0.369 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.1378s/iter; left time: 4994.8046s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 2483.8507s
	iters: 300, epoch: 13 | loss: 0.0000060
	speed: 0.0511s/iter; left time: 1841.8734s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0608s/iter; left time: 2185.5239s
Epoch: 13 cost time: 24.967509984970093
Epoch: 13, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.454 Vali Acc: 0.972 Test Loss: 0.454 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1183s/iter; left time: 4238.6476s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0629s/iter; left time: 2247.6127s
	iters: 300, epoch: 14 | loss: 0.7490286
	speed: 0.0575s/iter; left time: 2048.7457s
	iters: 400, epoch: 14 | loss: 0.0000052
	speed: 0.0557s/iter; left time: 1978.4284s
Epoch: 14 cost time: 22.73117995262146
Epoch: 14, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.462 Vali Acc: 0.964 Test Loss: 0.462 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1271s/iter; left time: 4500.4829s
	iters: 200, epoch: 15 | loss: 0.0007427
	speed: 0.0499s/iter; left time: 1763.7930s
	iters: 300, epoch: 15 | loss: 0.0000104
	speed: 0.0540s/iter; left time: 1903.3512s
	iters: 400, epoch: 15 | loss: 0.0000036
	speed: 0.0650s/iter; left time: 2282.9275s
Epoch: 15 cost time: 22.91976237297058
Epoch: 15, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.329 Vali Acc: 0.967 Test Loss: 0.329 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0501391
	speed: 0.1459s/iter; left time: 5105.6710s
	iters: 200, epoch: 16 | loss: 0.0012336
	speed: 0.0889s/iter; left time: 3104.6065s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0903s/iter; left time: 3143.8184s
	iters: 400, epoch: 16 | loss: 0.1040722
	speed: 0.0905s/iter; left time: 3142.0561s
Epoch: 16 cost time: 35.01465916633606
Epoch: 16, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.309 Vali Acc: 0.974 Test Loss: 0.309 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1776s/iter; left time: 6143.9686s
	iters: 200, epoch: 17 | loss: 0.0005964
	speed: 0.0898s/iter; left time: 3098.5322s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0877s/iter; left time: 3017.4589s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0865s/iter; left time: 2967.2968s
Epoch: 17 cost time: 36.98179244995117
Epoch: 17, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.449 Vali Acc: 0.974 Test Loss: 0.449 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.1794s/iter; left time: 6132.3668s
	iters: 200, epoch: 18 | loss: 0.0002487
	speed: 0.0932s/iter; left time: 3176.2119s
	iters: 300, epoch: 18 | loss: 0.0000016
	speed: 0.0905s/iter; left time: 3076.8649s
	iters: 400, epoch: 18 | loss: 0.0843292
	speed: 0.0935s/iter; left time: 3167.8387s
Epoch: 18 cost time: 38.336825370788574
Epoch: 18, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.397 Vali Acc: 0.976 Test Loss: 0.397 Test Acc: 0.976
Validation loss decreased (-0.974987 --> -0.976349).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1794s/iter; left time: 6056.8056s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0883s/iter; left time: 2972.2616s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0887s/iter; left time: 2978.0936s
	iters: 400, epoch: 19 | loss: 0.5903787
	speed: 0.0882s/iter; left time: 2952.0094s
Epoch: 19 cost time: 37.06671977043152
Epoch: 19, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.498 Vali Acc: 0.975 Test Loss: 0.498 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1702s/iter; left time: 5675.8815s
	iters: 200, epoch: 20 | loss: 0.0000010
	speed: 0.0913s/iter; left time: 3036.8813s
	iters: 300, epoch: 20 | loss: 0.0016999
	speed: 0.0810s/iter; left time: 2685.0042s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0890s/iter; left time: 2940.7852s
Epoch: 20 cost time: 35.816845178604126
Epoch: 20, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.466 Vali Acc: 0.973 Test Loss: 0.466 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.6018475
	speed: 0.1386s/iter; left time: 4565.4009s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 1894.4218s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0529s/iter; left time: 1731.5322s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 1476.6680s
Epoch: 21 cost time: 22.183931350708008
Epoch: 21, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.313 Vali Acc: 0.977 Test Loss: 0.313 Test Acc: 0.977
Validation loss decreased (-0.976349 --> -0.976805).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000010
	speed: 0.1272s/iter; left time: 4137.0125s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 1515.1119s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 2016.7281s
	iters: 400, epoch: 22 | loss: 0.0004956
	speed: 0.0492s/iter; left time: 1584.1195s
Epoch: 22 cost time: 21.814828157424927
Epoch: 22, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.398 Vali Acc: 0.977 Test Loss: 0.398 Test Acc: 0.977
Validation loss decreased (-0.976805 --> -0.977258).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1356s/iter; left time: 4356.1066s
	iters: 200, epoch: 23 | loss: 0.0000179
	speed: 0.0440s/iter; left time: 1409.5620s
	iters: 300, epoch: 23 | loss: 0.0000055
	speed: 0.0512s/iter; left time: 1633.9460s
	iters: 400, epoch: 23 | loss: 0.0004631
	speed: 0.0616s/iter; left time: 1958.7228s
Epoch: 23 cost time: 22.637626886367798
Epoch: 23, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.529 Vali Acc: 0.972 Test Loss: 0.529 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1421s/iter; left time: 4504.6991s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 2172.4616s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 1894.4956s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0801s/iter; left time: 2516.4759s
Epoch: 24 cost time: 28.37737274169922
Epoch: 24, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.450 Vali Acc: 0.974 Test Loss: 0.450 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1882s/iter; left time: 5889.9813s
	iters: 200, epoch: 25 | loss: 1.4407520
	speed: 0.0942s/iter; left time: 2938.9762s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0973s/iter; left time: 3023.8079s
	iters: 400, epoch: 25 | loss: 0.0000066
	speed: 0.1024s/iter; left time: 3171.8148s
Epoch: 25 cost time: 40.9710955619812
Epoch: 25, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.485 Vali Acc: 0.975 Test Loss: 0.485 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1969s/iter; left time: 6078.0007s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0999s/iter; left time: 3074.0799s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0926s/iter; left time: 2840.9843s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.1042s/iter; left time: 3187.1837s
Epoch: 26 cost time: 41.61029601097107
Epoch: 26, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.498 Vali Acc: 0.974 Test Loss: 0.498 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000825
	speed: 0.1964s/iter; left time: 5983.7215s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.1031s/iter; left time: 3131.5884s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.1000s/iter; left time: 3027.6147s
	iters: 400, epoch: 27 | loss: 0.0000075
	speed: 0.0969s/iter; left time: 2922.8931s
Epoch: 27 cost time: 41.727633237838745
Epoch: 27, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.390 Vali Acc: 0.970 Test Loss: 0.390 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1716s/iter; left time: 5155.5861s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0930s/iter; left time: 2785.2370s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0933s/iter; left time: 2783.7947s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0957s/iter; left time: 2845.7765s
Epoch: 28 cost time: 38.429004192352295
Epoch: 28, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.500 Vali Acc: 0.976 Test Loss: 0.500 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000037
	speed: 0.1855s/iter; left time: 5498.6339s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0902s/iter; left time: 2663.6008s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0862s/iter; left time: 2537.0507s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0647s/iter; left time: 1898.8633s
Epoch: 29 cost time: 34.692362546920776
Epoch: 29, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.465 Vali Acc: 0.977 Test Loss: 0.465 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1437s/iter; left time: 4199.1460s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 1646.1358s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0599s/iter; left time: 1738.9973s
	iters: 400, epoch: 30 | loss: 0.0000001
	speed: 0.0596s/iter; left time: 1723.9823s
Epoch: 30 cost time: 24.89509129524231
Epoch: 30, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.295 Vali Acc: 0.977 Test Loss: 0.295 Test Acc: 0.977
Validation loss decreased (-0.977258 --> -0.977259).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1303s/iter; left time: 3754.1903s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0589s/iter; left time: 1690.2207s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 1405.1211s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 1063.7354s
Epoch: 31 cost time: 20.369048357009888
Epoch: 31, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.405 Vali Acc: 0.977 Test Loss: 0.405 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1337s/iter; left time: 3797.2230s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 1506.1736s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0605s/iter; left time: 1706.8598s
	iters: 400, epoch: 32 | loss: 0.0018137
	speed: 0.0566s/iter; left time: 1590.0466s
Epoch: 32 cost time: 23.713120460510254
Epoch: 32, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.328 Vali Acc: 0.976 Test Loss: 0.328 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1445s/iter; left time: 4044.2280s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0638s/iter; left time: 1779.8167s
	iters: 300, epoch: 33 | loss: 0.0000006
	speed: 0.0489s/iter; left time: 1358.2861s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 1524.8960s
Epoch: 33 cost time: 23.539082288742065
Epoch: 33, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.311 Vali Acc: 0.978 Test Loss: 0.311 Test Acc: 0.978
Validation loss decreased (-0.977259 --> -0.977714).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1754s/iter; left time: 4835.2555s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0941s/iter; left time: 2585.0079s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0980s/iter; left time: 2682.0081s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0989s/iter; left time: 2697.7445s
Epoch: 34 cost time: 39.86358571052551
Epoch: 34, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.402 Vali Acc: 0.975 Test Loss: 0.402 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1862s/iter; left time: 5056.0273s
	iters: 200, epoch: 35 | loss: 0.0277879
	speed: 0.0928s/iter; left time: 2511.7241s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0985s/iter; left time: 2654.3795s
	iters: 400, epoch: 35 | loss: 0.0022256
	speed: 0.0962s/iter; left time: 2583.8810s
Epoch: 35 cost time: 40.269972801208496
Epoch: 35, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.545 Vali Acc: 0.976 Test Loss: 0.545 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.1891s/iter; left time: 5057.8674s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0974s/iter; left time: 2595.4424s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 2417.6506s
	iters: 400, epoch: 36 | loss: 0.0006661
	speed: 0.0976s/iter; left time: 2579.9858s
Epoch: 36 cost time: 39.95036554336548
Epoch: 36, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.511 Vali Acc: 0.974 Test Loss: 0.511 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1861s/iter; left time: 4900.2680s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0926s/iter; left time: 2429.2248s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0959s/iter; left time: 2504.9251s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0939s/iter; left time: 2445.4650s
Epoch: 37 cost time: 39.4781551361084
Epoch: 37, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.511 Vali Acc: 0.973 Test Loss: 0.511 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.1666s/iter; left time: 4318.2550s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0835s/iter; left time: 2156.2583s
	iters: 300, epoch: 38 | loss: 0.2900144
	speed: 0.0830s/iter; left time: 2134.1791s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 1070.3913s
Epoch: 38 cost time: 29.719856023788452
Epoch: 38, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.849 Vali Acc: 0.958 Test Loss: 0.849 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.1220s/iter; left time: 3113.1040s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0552s/iter; left time: 1403.5345s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 1271.7846s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0599s/iter; left time: 1508.6635s
Epoch: 39 cost time: 22.15061092376709
Epoch: 39, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.574 Vali Acc: 0.970 Test Loss: 0.574 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.1446s/iter; left time: 3628.4561s
	iters: 200, epoch: 40 | loss: 0.0000664
	speed: 0.0498s/iter; left time: 1243.8283s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 1185.2643s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 1320.4401s
Epoch: 40 cost time: 22.80550241470337
Epoch: 40, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.546 Vali Acc: 0.974 Test Loss: 0.546 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.1400s/iter; left time: 3456.4005s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 1432.9602s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 1292.0704s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0539s/iter; left time: 1314.6005s
Epoch: 41 cost time: 23.312286376953125
Epoch: 41, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.342 Vali Acc: 0.978 Test Loss: 0.342 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 0.0000074
	speed: 0.1293s/iter; left time: 3138.8837s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 1192.3234s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 1446.8369s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0495s/iter; left time: 1185.5755s
Epoch: 42 cost time: 21.6910502910614
Epoch: 42, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.417 Vali Acc: 0.979 Test Loss: 0.417 Test Acc: 0.979
Validation loss decreased (-0.977714 --> -0.979077).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.1686s/iter; left time: 4022.5449s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 2124.5479s
	iters: 300, epoch: 43 | loss: 0.0000000
	speed: 0.0893s/iter; left time: 2112.7578s
	iters: 400, epoch: 43 | loss: 0.0000000
	speed: 0.0863s/iter; left time: 2033.0170s
Epoch: 43 cost time: 36.8383424282074
Epoch: 43, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.429 Vali Acc: 0.975 Test Loss: 0.429 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 0.0031806
	speed: 0.1793s/iter; left time: 4203.8544s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.0946s/iter; left time: 2207.1086s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.0860s/iter; left time: 1999.7757s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.0950s/iter; left time: 2199.2861s
Epoch: 44 cost time: 37.8483247756958
Epoch: 44, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.431 Vali Acc: 0.977 Test Loss: 0.431 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 0.0000000
	speed: 0.1704s/iter; left time: 3925.2496s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.0897s/iter; left time: 2056.4040s
	iters: 300, epoch: 45 | loss: 0.8067872
	speed: 0.0921s/iter; left time: 2103.0246s
	iters: 400, epoch: 45 | loss: 0.1482361
	speed: 0.0926s/iter; left time: 2103.7028s
Epoch: 45 cost time: 37.10313558578491
Epoch: 45, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.423 Vali Acc: 0.976 Test Loss: 0.423 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 0.0000000
	speed: 0.1797s/iter; left time: 4065.0752s
	iters: 200, epoch: 46 | loss: 0.0000000
	speed: 0.0940s/iter; left time: 2116.1338s
	iters: 300, epoch: 46 | loss: 0.0000000
	speed: 0.0848s/iter; left time: 1900.3923s
	iters: 400, epoch: 46 | loss: 0.0000000
	speed: 0.0918s/iter; left time: 2048.5891s
Epoch: 46 cost time: 37.648743867874146
Epoch: 46, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.318 Vali Acc: 0.977 Test Loss: 0.318 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 47 | loss: 0.0000000
	speed: 0.1739s/iter; left time: 3862.1315s
	iters: 200, epoch: 47 | loss: 0.0000000
	speed: 0.0908s/iter; left time: 2008.0205s
	iters: 300, epoch: 47 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 1798.6301s
	iters: 400, epoch: 47 | loss: 0.0000000
	speed: 0.0554s/iter; left time: 1212.5599s
Epoch: 47 cost time: 32.921530961990356
Epoch: 47, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.405 Vali Acc: 0.972 Test Loss: 0.405 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 48 | loss: 0.0000000
	speed: 0.1411s/iter; left time: 3075.3024s
	iters: 200, epoch: 48 | loss: 0.0000000
	speed: 0.0536s/iter; left time: 1162.8910s
	iters: 300, epoch: 48 | loss: 0.0000000
	speed: 0.0466s/iter; left time: 1005.9871s
	iters: 400, epoch: 48 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 1027.6049s
Epoch: 48 cost time: 21.475195169448853
Epoch: 48, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.449 Vali Acc: 0.973 Test Loss: 0.449 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 49 | loss: 0.0000000
	speed: 0.1300s/iter; left time: 2780.0464s
	iters: 200, epoch: 49 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 972.9396s
	iters: 300, epoch: 49 | loss: 0.0869479
	speed: 0.0539s/iter; left time: 1141.6478s
	iters: 400, epoch: 49 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 993.8842s
Epoch: 49 cost time: 20.46306610107422
Epoch: 49, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.495 Vali Acc: 0.977 Test Loss: 0.495 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 50 | loss: 0.0000000
	speed: 0.1417s/iter; left time: 2970.7531s
	iters: 200, epoch: 50 | loss: 0.0000000
	speed: 0.0455s/iter; left time: 949.5146s
	iters: 300, epoch: 50 | loss: 0.0000000
	speed: 0.0471s/iter; left time: 978.3927s
	iters: 400, epoch: 50 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 1234.3538s
Epoch: 50 cost time: 22.51228928565979
Epoch: 50, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.380 Vali Acc: 0.975 Test Loss: 0.380 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 51 | loss: 0.0000000
	speed: 0.1369s/iter; left time: 2813.8228s
	iters: 200, epoch: 51 | loss: 0.0000000
	speed: 0.0603s/iter; left time: 1233.4820s
	iters: 300, epoch: 51 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 1058.6204s
	iters: 400, epoch: 51 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 982.2640s
Epoch: 51 cost time: 22.920188188552856
Epoch: 51, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.477 Vali Acc: 0.972 Test Loss: 0.477 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 52 | loss: 0.0000000
	speed: 0.1583s/iter; left time: 3188.8011s
	iters: 200, epoch: 52 | loss: 0.0000000
	speed: 0.0957s/iter; left time: 1917.8153s
	iters: 300, epoch: 52 | loss: 0.0000000
	speed: 0.0930s/iter; left time: 1853.6607s
	iters: 400, epoch: 52 | loss: 0.0000000
	speed: 0.0882s/iter; left time: 1748.8673s
Epoch: 52 cost time: 37.345396995544434
Epoch: 52, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.362 Vali Acc: 0.977 Test Loss: 0.362 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
model parameter : 226186
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1949481
	speed: 0.1179s/iter; left time: 4856.6846s
	iters: 200, epoch: 1 | loss: 0.0611561
	speed: 0.1150s/iter; left time: 4725.6180s
	iters: 300, epoch: 1 | loss: 0.5631821
	speed: 0.1083s/iter; left time: 4438.4020s
	iters: 400, epoch: 1 | loss: 0.0093415
	speed: 0.1101s/iter; left time: 4502.1543s
Epoch: 1 cost time: 46.76206564903259
Epoch: 1, Steps: 413 | Train Loss: 0.364 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (inf --> -0.956797).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3398008
	speed: 0.1921s/iter; left time: 7833.3539s
	iters: 200, epoch: 2 | loss: 0.0166502
	speed: 0.1145s/iter; left time: 4660.0262s
	iters: 300, epoch: 2 | loss: 0.5145425
	speed: 0.0983s/iter; left time: 3990.1127s
	iters: 400, epoch: 2 | loss: 0.0005707
	speed: 0.0945s/iter; left time: 3826.4066s
Epoch: 2 cost time: 42.37354326248169
Epoch: 2, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0237637
	speed: 0.1828s/iter; left time: 7381.2295s
	iters: 200, epoch: 3 | loss: 0.0078600
	speed: 0.1087s/iter; left time: 4378.9466s
	iters: 300, epoch: 3 | loss: 0.0098770
	speed: 0.1074s/iter; left time: 4314.8551s
	iters: 400, epoch: 3 | loss: 0.0178624
	speed: 0.1027s/iter; left time: 4116.0162s
Epoch: 3 cost time: 43.315794706344604
Epoch: 3, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
Validation loss decreased (-0.956797 --> -0.969075).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0010559
	speed: 0.1864s/iter; left time: 7448.5712s
	iters: 200, epoch: 4 | loss: 0.0000060
	speed: 0.1088s/iter; left time: 4336.2596s
	iters: 300, epoch: 4 | loss: 0.1810885
	speed: 0.0752s/iter; left time: 2991.5429s
	iters: 400, epoch: 4 | loss: 0.0007452
	speed: 0.0601s/iter; left time: 2383.2956s
Epoch: 4 cost time: 35.222317695617676
Epoch: 4, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.231 Vali Acc: 0.962 Test Loss: 0.231 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5137374
	speed: 0.1566s/iter; left time: 6194.7246s
	iters: 200, epoch: 5 | loss: 0.0093421
	speed: 0.0590s/iter; left time: 2327.7644s
	iters: 300, epoch: 5 | loss: 0.0001599
	speed: 0.0702s/iter; left time: 2762.7943s
	iters: 400, epoch: 5 | loss: 0.3132035
	speed: 0.0735s/iter; left time: 2884.0482s
Epoch: 5 cost time: 28.657803058624268
Epoch: 5, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
Validation loss decreased (-0.969075 --> -0.969985).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000494
	speed: 0.1343s/iter; left time: 5255.6199s
	iters: 200, epoch: 6 | loss: 0.0014248
	speed: 0.0873s/iter; left time: 3409.4124s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1806.4396s
	iters: 400, epoch: 6 | loss: 0.0000003
	speed: 0.0548s/iter; left time: 2129.0146s
Epoch: 6 cost time: 25.503523349761963
Epoch: 6, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.211 Vali Acc: 0.971 Test Loss: 0.211 Test Acc: 0.971
Validation loss decreased (-0.969985 --> -0.970894).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1458s/iter; left time: 5644.3265s
	iters: 200, epoch: 7 | loss: 0.0000014
	speed: 0.0613s/iter; left time: 2368.2798s
	iters: 300, epoch: 7 | loss: 0.0001129
	speed: 0.0603s/iter; left time: 2323.4652s
	iters: 400, epoch: 7 | loss: 0.0002052
	speed: 0.0810s/iter; left time: 3111.9193s
Epoch: 7 cost time: 27.502849340438843
Epoch: 7, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.152 Vali Acc: 0.976 Test Loss: 0.152 Test Acc: 0.976
Validation loss decreased (-0.970894 --> -0.976351).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0019916
	speed: 0.1520s/iter; left time: 5824.0925s
	iters: 200, epoch: 8 | loss: 0.0000218
	speed: 0.0823s/iter; left time: 3144.1594s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0531s/iter; left time: 2024.8811s
	iters: 400, epoch: 8 | loss: 0.2972434
	speed: 0.0907s/iter; left time: 3448.5618s
Epoch: 8 cost time: 31.301810264587402
Epoch: 8, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.310 Vali Acc: 0.971 Test Loss: 0.310 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000015
	speed: 0.1882s/iter; left time: 7133.5203s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1104s/iter; left time: 4171.3607s
	iters: 300, epoch: 9 | loss: 0.0000106
	speed: 0.1094s/iter; left time: 4123.6023s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1026s/iter; left time: 3859.2994s
Epoch: 9 cost time: 43.63061714172363
Epoch: 9, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.259 Vali Acc: 0.967 Test Loss: 0.259 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0063137
	speed: 0.1915s/iter; left time: 7180.0068s
	iters: 200, epoch: 10 | loss: 0.0007345
	speed: 0.1091s/iter; left time: 4079.7451s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.1063s/iter; left time: 3963.5742s
	iters: 400, epoch: 10 | loss: 0.0866503
	speed: 0.1035s/iter; left time: 3849.0095s
Epoch: 10 cost time: 43.85564160346985
Epoch: 10, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.526 Vali Acc: 0.952 Test Loss: 0.526 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1927s/iter; left time: 7144.1589s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1042s/iter; left time: 3853.0039s
	iters: 300, epoch: 11 | loss: 0.0000004
	speed: 0.1039s/iter; left time: 3831.3836s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0976s/iter; left time: 3589.3732s
Epoch: 11 cost time: 42.10955095291138
Epoch: 11, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.141 Vali Acc: 0.980 Test Loss: 0.141 Test Acc: 0.980
Validation loss decreased (-0.976351 --> -0.979989).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0079419
	speed: 0.1818s/iter; left time: 6665.0976s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1013s/iter; left time: 3702.8866s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1029s/iter; left time: 3752.7447s
	iters: 400, epoch: 12 | loss: 0.0000957
	speed: 0.0908s/iter; left time: 3300.1388s
Epoch: 12 cost time: 40.078017234802246
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.297 Vali Acc: 0.978 Test Loss: 0.297 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1828s/iter; left time: 6624.5134s
	iters: 200, epoch: 13 | loss: 0.0010848
	speed: 0.1012s/iter; left time: 3656.1536s
	iters: 300, epoch: 13 | loss: 0.0000002
	speed: 0.1033s/iter; left time: 3723.7053s
	iters: 400, epoch: 13 | loss: 0.0000177
	speed: 0.0495s/iter; left time: 1779.8068s
Epoch: 13 cost time: 35.957167625427246
Epoch: 13, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.280 Vali Acc: 0.966 Test Loss: 0.280 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000003
	speed: 0.1716s/iter; left time: 6147.4097s
	iters: 200, epoch: 14 | loss: 0.0000181
	speed: 0.0520s/iter; left time: 1859.7784s
	iters: 300, epoch: 14 | loss: 0.0004450
	speed: 0.0619s/iter; left time: 2204.0975s
	iters: 400, epoch: 14 | loss: 0.0000371
	speed: 0.0630s/iter; left time: 2239.5467s
Epoch: 14 cost time: 26.986366033554077
Epoch: 14, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.275 Vali Acc: 0.973 Test Loss: 0.275 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1222s/iter; left time: 4326.7465s
	iters: 200, epoch: 15 | loss: 0.0000007
	speed: 0.0503s/iter; left time: 1774.8069s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0605s/iter; left time: 2131.5573s
	iters: 400, epoch: 15 | loss: 0.4263548
	speed: 0.0490s/iter; left time: 1722.5464s
Epoch: 15 cost time: 21.66378664970398
Epoch: 15, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1309s/iter; left time: 4583.7809s
	iters: 200, epoch: 16 | loss: 0.0000008
	speed: 0.0654s/iter; left time: 2284.4621s
	iters: 300, epoch: 16 | loss: 0.0000003
	speed: 0.0532s/iter; left time: 1852.6377s
	iters: 400, epoch: 16 | loss: 0.0000037
	speed: 0.0527s/iter; left time: 1829.7054s
Epoch: 16 cost time: 23.823376893997192
Epoch: 16, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.258 Vali Acc: 0.974 Test Loss: 0.258 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000047
	speed: 0.1381s/iter; left time: 4777.8353s
	iters: 200, epoch: 17 | loss: 0.0000035
	speed: 0.0544s/iter; left time: 1875.8494s
	iters: 300, epoch: 17 | loss: 0.6581443
	speed: 0.0496s/iter; left time: 1707.3534s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0614s/iter; left time: 2105.3969s
Epoch: 17 cost time: 24.430098295211792
Epoch: 17, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.246 Vali Acc: 0.978 Test Loss: 0.246 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1714s/iter; left time: 5858.6661s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0825s/iter; left time: 2812.1300s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0883s/iter; left time: 3000.2121s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0874s/iter; left time: 2962.3944s
Epoch: 18 cost time: 35.97304892539978
Epoch: 18, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.361 Vali Acc: 0.972 Test Loss: 0.361 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0006826
	speed: 0.1668s/iter; left time: 5633.4286s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0850s/iter; left time: 2860.7305s
	iters: 300, epoch: 19 | loss: 0.0000017
	speed: 0.0897s/iter; left time: 3011.1677s
	iters: 400, epoch: 19 | loss: 0.0024150
	speed: 0.0876s/iter; left time: 2931.4741s
Epoch: 19 cost time: 36.514140605926514
Epoch: 19, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.235 Vali Acc: 0.977 Test Loss: 0.235 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1659s/iter; left time: 5532.0925s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0849s/iter; left time: 2824.2370s
	iters: 300, epoch: 20 | loss: 0.0000002
	speed: 0.0909s/iter; left time: 3013.5166s
	iters: 400, epoch: 20 | loss: 0.0000199
	speed: 0.0866s/iter; left time: 2861.7270s
Epoch: 20 cost time: 36.46271634101868
Epoch: 20, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.270 Vali Acc: 0.976 Test Loss: 0.270 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1656s/iter; left time: 5453.5109s
	iters: 200, epoch: 21 | loss: 0.0000156
	speed: 0.0857s/iter; left time: 2813.0058s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0862s/iter; left time: 2823.0061s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0838s/iter; left time: 2735.8859s
Epoch: 21 cost time: 35.51366329193115
Epoch: 21, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.361 Vali Acc: 0.978 Test Loss: 0.361 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 184842
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3245976
	speed: 0.0558s/iter; left time: 2300.1304s
	iters: 200, epoch: 1 | loss: 0.2115411
	speed: 0.0399s/iter; left time: 1638.5863s
	iters: 300, epoch: 1 | loss: 0.0980833
	speed: 0.0310s/iter; left time: 1269.3457s
	iters: 400, epoch: 1 | loss: 0.0332107
	speed: 0.0312s/iter; left time: 1275.4307s
Epoch: 1 cost time: 16.319024801254272
Epoch: 1, Steps: 413 | Train Loss: 0.414 Vali Loss: 0.102 Vali Acc: 0.967 Test Loss: 0.102 Test Acc: 0.967
Validation loss decreased (inf --> -0.967257).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0292890
	speed: 0.1092s/iter; left time: 4454.1547s
	iters: 200, epoch: 2 | loss: 0.0338298
	speed: 0.0342s/iter; left time: 1391.9508s
	iters: 300, epoch: 2 | loss: 0.0391271
	speed: 0.0353s/iter; left time: 1433.0306s
	iters: 400, epoch: 2 | loss: 0.0079153
	speed: 0.0347s/iter; left time: 1403.7343s
Epoch: 2 cost time: 14.6808340549469
Epoch: 2, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0560644
	speed: 0.1071s/iter; left time: 4326.1523s
	iters: 200, epoch: 3 | loss: 0.0023662
	speed: 0.0360s/iter; left time: 1448.3139s
	iters: 300, epoch: 3 | loss: 0.7283562
	speed: 0.0359s/iter; left time: 1442.0480s
	iters: 400, epoch: 3 | loss: 0.0689549
	speed: 0.0339s/iter; left time: 1356.7398s
Epoch: 3 cost time: 14.625932931900024
Epoch: 3, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000463
	speed: 0.1105s/iter; left time: 4416.5140s
	iters: 200, epoch: 4 | loss: 0.0203381
	speed: 0.0314s/iter; left time: 1252.3280s
	iters: 300, epoch: 4 | loss: 0.0024964
	speed: 0.0340s/iter; left time: 1351.6414s
	iters: 400, epoch: 4 | loss: 0.0000096
	speed: 0.0353s/iter; left time: 1400.4142s
Epoch: 4 cost time: 14.361852407455444
Epoch: 4, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0006097
	speed: 0.1077s/iter; left time: 4259.4031s
	iters: 200, epoch: 5 | loss: 0.0010596
	speed: 0.0356s/iter; left time: 1403.7787s
	iters: 300, epoch: 5 | loss: 0.0059813
	speed: 0.0374s/iter; left time: 1469.7088s
	iters: 400, epoch: 5 | loss: 0.3397796
	speed: 0.0369s/iter; left time: 1447.6078s
Epoch: 5 cost time: 15.25139594078064
Epoch: 5, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.167 Vali Acc: 0.968 Test Loss: 0.167 Test Acc: 0.968
Validation loss decreased (-0.967257 --> -0.968166).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1317635
	speed: 0.1096s/iter; left time: 4288.3848s
	iters: 200, epoch: 6 | loss: 0.0002050
	speed: 0.0370s/iter; left time: 1444.2443s
	iters: 300, epoch: 6 | loss: 0.0000034
	speed: 0.0382s/iter; left time: 1488.8174s
	iters: 400, epoch: 6 | loss: 0.1617341
	speed: 0.0376s/iter; left time: 1461.4927s
Epoch: 6 cost time: 15.975927591323853
Epoch: 6, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0002215
	speed: 0.1173s/iter; left time: 4541.7740s
	iters: 200, epoch: 7 | loss: 0.0000433
	speed: 0.0413s/iter; left time: 1596.1071s
	iters: 300, epoch: 7 | loss: 0.0057102
	speed: 0.0419s/iter; left time: 1615.1486s
	iters: 400, epoch: 7 | loss: 0.0000002
	speed: 0.0421s/iter; left time: 1618.2606s
Epoch: 7 cost time: 17.592243671417236
Epoch: 7, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
Validation loss decreased (-0.968166 --> -0.968620).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0021440
	speed: 0.1153s/iter; left time: 4417.4562s
	iters: 200, epoch: 8 | loss: 0.0004067
	speed: 0.0439s/iter; left time: 1675.5784s
	iters: 300, epoch: 8 | loss: 0.0017693
	speed: 0.0423s/iter; left time: 1610.9723s
	iters: 400, epoch: 8 | loss: 0.0000010
	speed: 0.0415s/iter; left time: 1578.7421s
Epoch: 8 cost time: 17.93549656867981
Epoch: 8, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.296 Vali Acc: 0.956 Test Loss: 0.296 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6173085
	speed: 0.1131s/iter; left time: 4285.6457s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0423s/iter; left time: 1597.5589s
	iters: 300, epoch: 9 | loss: 0.2009080
	speed: 0.0413s/iter; left time: 1556.7259s
	iters: 400, epoch: 9 | loss: 0.0017129
	speed: 0.0423s/iter; left time: 1589.4948s
Epoch: 9 cost time: 17.612244129180908
Epoch: 9, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.968620 --> -0.977261).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000723
	speed: 0.1195s/iter; left time: 4478.2855s
	iters: 200, epoch: 10 | loss: 0.0000004
	speed: 0.0420s/iter; left time: 1568.9016s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0405s/iter; left time: 1511.7237s
	iters: 400, epoch: 10 | loss: 0.2394841
	speed: 0.0419s/iter; left time: 1557.2927s
Epoch: 10 cost time: 17.540816068649292
Epoch: 10, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.325 Vali Acc: 0.964 Test Loss: 0.325 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1183s/iter; left time: 4386.5742s
	iters: 200, epoch: 11 | loss: 0.2357873
	speed: 0.0417s/iter; left time: 1539.9812s
	iters: 300, epoch: 11 | loss: 0.0000078
	speed: 0.0415s/iter; left time: 1529.6099s
	iters: 400, epoch: 11 | loss: 0.4190919
	speed: 0.0414s/iter; left time: 1522.2966s
Epoch: 11 cost time: 17.649210214614868
Epoch: 11, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.2656590
	speed: 0.1218s/iter; left time: 4465.3713s
	iters: 200, epoch: 12 | loss: 0.0000011
	speed: 0.0410s/iter; left time: 1500.0668s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 1480.7839s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0420s/iter; left time: 1528.3373s
Epoch: 12 cost time: 17.55840015411377
Epoch: 12, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.136 Vali Acc: 0.984 Test Loss: 0.136 Test Acc: 0.984
Validation loss decreased (-0.977261 --> -0.984082).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.3940669
	speed: 0.1179s/iter; left time: 4274.1927s
	iters: 200, epoch: 13 | loss: 0.0000016
	speed: 0.0406s/iter; left time: 1466.0583s
	iters: 300, epoch: 13 | loss: 0.0000447
	speed: 0.0407s/iter; left time: 1468.7324s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0392s/iter; left time: 1407.5077s
Epoch: 13 cost time: 17.192456483840942
Epoch: 13, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.247 Vali Acc: 0.968 Test Loss: 0.247 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0007008
	speed: 0.1144s/iter; left time: 4098.6687s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 1354.3650s
	iters: 300, epoch: 14 | loss: 0.0000059
	speed: 0.0401s/iter; left time: 1427.9143s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 1546.5766s
Epoch: 14 cost time: 17.007981777191162
Epoch: 14, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.160 Vali Acc: 0.976 Test Loss: 0.160 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1200s/iter; left time: 4251.3190s
	iters: 200, epoch: 15 | loss: 0.0009535
	speed: 0.0413s/iter; left time: 1459.1028s
	iters: 300, epoch: 15 | loss: 0.0000562
	speed: 0.0406s/iter; left time: 1429.1306s
	iters: 400, epoch: 15 | loss: 0.0000087
	speed: 0.0400s/iter; left time: 1404.5688s
Epoch: 15 cost time: 17.12672233581543
Epoch: 15, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.197 Vali Acc: 0.980 Test Loss: 0.197 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000013
	speed: 0.1071s/iter; left time: 3748.0007s
	iters: 200, epoch: 16 | loss: 0.0000014
	speed: 0.0358s/iter; left time: 1250.1964s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0349s/iter; left time: 1215.8058s
	iters: 400, epoch: 16 | loss: 0.0239253
	speed: 0.0374s/iter; left time: 1297.6930s
Epoch: 16 cost time: 15.406407594680786
Epoch: 16, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.271 Vali Acc: 0.971 Test Loss: 0.271 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000008
	speed: 0.1127s/iter; left time: 3897.6476s
	iters: 200, epoch: 17 | loss: 0.0000041
	speed: 0.0365s/iter; left time: 1257.6339s
	iters: 300, epoch: 17 | loss: 0.5397316
	speed: 0.0351s/iter; left time: 1208.8758s
	iters: 400, epoch: 17 | loss: 0.0000025
	speed: 0.0380s/iter; left time: 1303.0423s
Epoch: 17 cost time: 15.670504093170166
Epoch: 17, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.315 Vali Acc: 0.969 Test Loss: 0.315 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1147s/iter; left time: 3921.9578s
	iters: 200, epoch: 18 | loss: 0.0000079
	speed: 0.0377s/iter; left time: 1285.4823s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 1305.4614s
	iters: 400, epoch: 18 | loss: 0.0013531
	speed: 0.0343s/iter; left time: 1161.6007s
Epoch: 18 cost time: 15.486545085906982
Epoch: 18, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.299 Vali Acc: 0.967 Test Loss: 0.299 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0036321
	speed: 0.1178s/iter; left time: 3977.6291s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 1193.8454s
	iters: 300, epoch: 19 | loss: 0.0000007
	speed: 0.0370s/iter; left time: 1240.5933s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 1286.4349s
Epoch: 19 cost time: 15.996476650238037
Epoch: 19, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0063537
	speed: 0.1110s/iter; left time: 3703.7950s
	iters: 200, epoch: 20 | loss: 0.0013082
	speed: 0.0386s/iter; left time: 1282.5416s
	iters: 300, epoch: 20 | loss: 0.0050045
	speed: 0.0375s/iter; left time: 1243.0951s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 1216.8457s
Epoch: 20 cost time: 15.831995964050293
Epoch: 20, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.246 Vali Acc: 0.978 Test Loss: 0.246 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1146s/iter; left time: 3775.3527s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 1078.9935s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0399s/iter; left time: 1306.8592s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1396.0725s
Epoch: 21 cost time: 16.210116147994995
Epoch: 21, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.238 Vali Acc: 0.979 Test Loss: 0.238 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0001897
	speed: 0.1262s/iter; left time: 4104.5653s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1394.6771s
	iters: 300, epoch: 22 | loss: 0.0011338
	speed: 0.0416s/iter; left time: 1345.2915s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 1335.6458s
Epoch: 22 cost time: 18.188451766967773
Epoch: 22, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.245 Vali Acc: 0.974 Test Loss: 0.245 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 151882
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5365355
	speed: 0.0573s/iter; left time: 2359.8824s
	iters: 200, epoch: 1 | loss: 0.4268549
	speed: 0.0424s/iter; left time: 1743.1791s
	iters: 300, epoch: 1 | loss: 0.0738251
	speed: 0.0418s/iter; left time: 1712.0977s
	iters: 400, epoch: 1 | loss: 0.3300755
	speed: 0.0398s/iter; left time: 1626.8841s
Epoch: 1 cost time: 18.708802461624146
Epoch: 1, Steps: 413 | Train Loss: 0.422 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
Validation loss decreased (inf --> -0.967712).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0573411
	speed: 0.1173s/iter; left time: 4784.9737s
	iters: 200, epoch: 2 | loss: 0.0240479
	speed: 0.0398s/iter; left time: 1619.1658s
	iters: 300, epoch: 2 | loss: 0.0032984
	speed: 0.0431s/iter; left time: 1748.7624s
	iters: 400, epoch: 2 | loss: 0.4904809
	speed: 0.0410s/iter; left time: 1661.4291s
Epoch: 2 cost time: 17.425766706466675
Epoch: 2, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
Validation loss decreased (-0.967712 --> -0.975443).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0043921
	speed: 0.1175s/iter; left time: 4743.2252s
	iters: 200, epoch: 3 | loss: 0.3063357
	speed: 0.0416s/iter; left time: 1673.7781s
	iters: 300, epoch: 3 | loss: 0.0010979
	speed: 0.0409s/iter; left time: 1642.2536s
	iters: 400, epoch: 3 | loss: 0.0074744
	speed: 0.0404s/iter; left time: 1619.8591s
Epoch: 3 cost time: 17.5768461227417
Epoch: 3, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0006610
	speed: 0.1054s/iter; left time: 4211.4123s
	iters: 200, epoch: 4 | loss: 0.0031037
	speed: 0.0393s/iter; left time: 1565.4226s
	iters: 300, epoch: 4 | loss: 0.0235729
	speed: 0.0411s/iter; left time: 1636.1761s
	iters: 400, epoch: 4 | loss: 0.0000205
	speed: 0.0400s/iter; left time: 1588.3085s
Epoch: 4 cost time: 16.633800268173218
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000377
	speed: 0.1092s/iter; left time: 4317.9391s
	iters: 200, epoch: 5 | loss: 0.0155377
	speed: 0.0387s/iter; left time: 1526.2166s
	iters: 300, epoch: 5 | loss: 0.0000291
	speed: 0.0384s/iter; left time: 1512.7844s
	iters: 400, epoch: 5 | loss: 0.0003858
	speed: 0.0398s/iter; left time: 1562.0037s
Epoch: 5 cost time: 16.583600521087646
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0002247
	speed: 0.1142s/iter; left time: 4470.2166s
	iters: 200, epoch: 6 | loss: 0.0000144
	speed: 0.0400s/iter; left time: 1559.5957s
	iters: 300, epoch: 6 | loss: 0.0004350
	speed: 0.0397s/iter; left time: 1544.6014s
	iters: 400, epoch: 6 | loss: 0.0000630
	speed: 0.0376s/iter; left time: 1460.9808s
Epoch: 6 cost time: 16.49501395225525
Epoch: 6, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000260
	speed: 0.1146s/iter; left time: 4437.9265s
	iters: 200, epoch: 7 | loss: 0.0179165
	speed: 0.0383s/iter; left time: 1480.3372s
	iters: 300, epoch: 7 | loss: 0.0000010
	speed: 0.0350s/iter; left time: 1348.0097s
	iters: 400, epoch: 7 | loss: 0.0152985
	speed: 0.0322s/iter; left time: 1236.7704s
Epoch: 7 cost time: 15.115047454833984
Epoch: 7, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.174 Vali Acc: 0.970 Test Loss: 0.174 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0001036
	speed: 0.1071s/iter; left time: 4101.9392s
	iters: 200, epoch: 8 | loss: 0.0364267
	speed: 0.0340s/iter; left time: 1300.9087s
	iters: 300, epoch: 8 | loss: 0.0060621
	speed: 0.0334s/iter; left time: 1271.0675s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0315s/iter; left time: 1196.1307s
Epoch: 8 cost time: 14.027466535568237
Epoch: 8, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.254 Vali Acc: 0.966 Test Loss: 0.254 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000056
	speed: 0.1045s/iter; left time: 3959.1904s
	iters: 200, epoch: 9 | loss: 0.0134792
	speed: 0.0341s/iter; left time: 1287.1195s
	iters: 300, epoch: 9 | loss: 0.0000032
	speed: 0.0346s/iter; left time: 1305.2040s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0361s/iter; left time: 1359.1128s
Epoch: 9 cost time: 14.525432348251343
Epoch: 9, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0227801
	speed: 0.1039s/iter; left time: 3894.9025s
	iters: 200, epoch: 10 | loss: 0.0000278
	speed: 0.0332s/iter; left time: 1239.9421s
	iters: 300, epoch: 10 | loss: 0.0078662
	speed: 0.0312s/iter; left time: 1163.5539s
	iters: 400, epoch: 10 | loss: 0.0515477
	speed: 0.0334s/iter; left time: 1242.9565s
Epoch: 10 cost time: 13.709890127182007
Epoch: 10, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
Validation loss decreased (-0.975443 --> -0.976806).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000048
	speed: 0.1053s/iter; left time: 3904.8960s
	iters: 200, epoch: 11 | loss: 0.0000019
	speed: 0.0326s/iter; left time: 1206.2156s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 1226.7779s
	iters: 400, epoch: 11 | loss: 0.0000221
	speed: 0.0343s/iter; left time: 1260.2349s
Epoch: 11 cost time: 14.095037460327148
Epoch: 11, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.185 Vali Acc: 0.971 Test Loss: 0.185 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0044514
	speed: 0.1028s/iter; left time: 3767.5546s
	iters: 200, epoch: 12 | loss: 0.0000004
	speed: 0.0359s/iter; left time: 1313.4704s
	iters: 300, epoch: 12 | loss: 0.1744897
	speed: 0.0331s/iter; left time: 1205.0757s
	iters: 400, epoch: 12 | loss: 0.3806364
	speed: 0.0332s/iter; left time: 1208.6742s
Epoch: 12 cost time: 14.50374960899353
Epoch: 12, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000544
	speed: 0.1009s/iter; left time: 3656.8980s
	iters: 200, epoch: 13 | loss: 0.0000029
	speed: 0.0313s/iter; left time: 1130.9177s
	iters: 300, epoch: 13 | loss: 0.0000011
	speed: 0.0389s/iter; left time: 1402.5842s
	iters: 400, epoch: 13 | loss: 0.0016615
	speed: 0.0410s/iter; left time: 1475.1509s
Epoch: 13 cost time: 15.276614904403687
Epoch: 13, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.133 Vali Acc: 0.979 Test Loss: 0.133 Test Acc: 0.979
Validation loss decreased (-0.976806 --> -0.979080).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1140s/iter; left time: 4083.7690s
	iters: 200, epoch: 14 | loss: 0.0000383
	speed: 0.0407s/iter; left time: 1455.9028s
	iters: 300, epoch: 14 | loss: 0.0000005
	speed: 0.0388s/iter; left time: 1380.8740s
	iters: 400, epoch: 14 | loss: 0.0000069
	speed: 0.0385s/iter; left time: 1366.5441s
Epoch: 14 cost time: 16.650549173355103
Epoch: 14, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.298 Vali Acc: 0.966 Test Loss: 0.298 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000004
	speed: 0.1093s/iter; left time: 3871.4679s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0382s/iter; left time: 1350.3966s
	iters: 300, epoch: 15 | loss: 0.0513772
	speed: 0.0409s/iter; left time: 1440.1355s
	iters: 400, epoch: 15 | loss: 0.0053695
	speed: 0.0409s/iter; left time: 1434.6396s
Epoch: 15 cost time: 16.767712354660034
Epoch: 15, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.217 Vali Acc: 0.972 Test Loss: 0.217 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1170s/iter; left time: 4094.1936s
	iters: 200, epoch: 16 | loss: 0.0151420
	speed: 0.0395s/iter; left time: 1380.3798s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 1431.2183s
	iters: 400, epoch: 16 | loss: 0.0000040
	speed: 0.0406s/iter; left time: 1409.3313s
Epoch: 16 cost time: 17.216297149658203
Epoch: 16, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.242 Vali Acc: 0.969 Test Loss: 0.242 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.1160s/iter; left time: 4013.4709s
	iters: 200, epoch: 17 | loss: 0.0009401
	speed: 0.0407s/iter; left time: 1405.0776s
	iters: 300, epoch: 17 | loss: 0.3202064
	speed: 0.0406s/iter; left time: 1397.6605s
	iters: 400, epoch: 17 | loss: 0.0000043
	speed: 0.0388s/iter; left time: 1329.0257s
Epoch: 17 cost time: 17.038613080978394
Epoch: 17, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.197 Vali Acc: 0.977 Test Loss: 0.197 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.1118s/iter; left time: 3819.8948s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 1326.9060s
	iters: 300, epoch: 18 | loss: 0.0000006
	speed: 0.0389s/iter; left time: 1322.5820s
	iters: 400, epoch: 18 | loss: 0.0001820
	speed: 0.0411s/iter; left time: 1393.2372s
Epoch: 18 cost time: 16.73763680458069
Epoch: 18, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.241 Vali Acc: 0.974 Test Loss: 0.241 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000002
	speed: 0.1126s/iter; left time: 3801.6745s
	iters: 200, epoch: 19 | loss: 0.0000036
	speed: 0.0414s/iter; left time: 1392.4697s
	iters: 300, epoch: 19 | loss: 0.2282851
	speed: 0.0396s/iter; left time: 1328.0601s
	iters: 400, epoch: 19 | loss: 0.3930455
	speed: 0.0396s/iter; left time: 1324.6424s
Epoch: 19 cost time: 16.964601278305054
Epoch: 19, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.197 Vali Acc: 0.976 Test Loss: 0.197 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1077s/iter; left time: 3590.6947s
	iters: 200, epoch: 20 | loss: 0.0007613
	speed: 0.0388s/iter; left time: 1290.5674s
	iters: 300, epoch: 20 | loss: 0.0000597
	speed: 0.0387s/iter; left time: 1282.2680s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 1304.5263s
Epoch: 20 cost time: 16.55985164642334
Epoch: 20, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.280 Vali Acc: 0.978 Test Loss: 0.280 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000564
	speed: 0.1125s/iter; left time: 3707.4915s
	iters: 200, epoch: 21 | loss: 0.0005643
	speed: 0.0396s/iter; left time: 1300.5356s
	iters: 300, epoch: 21 | loss: 0.0000294
	speed: 0.0386s/iter; left time: 1263.6317s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0376s/iter; left time: 1228.6622s
Epoch: 21 cost time: 16.489776372909546
Epoch: 21, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.180 Vali Acc: 0.978 Test Loss: 0.180 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000005
	speed: 0.0963s/iter; left time: 3133.4110s
	iters: 200, epoch: 22 | loss: 0.0000034
	speed: 0.0332s/iter; left time: 1076.4260s
	iters: 300, epoch: 22 | loss: 0.0000003
	speed: 0.0304s/iter; left time: 981.7027s
	iters: 400, epoch: 22 | loss: 0.0004511
	speed: 0.0317s/iter; left time: 1020.3100s
Epoch: 22 cost time: 13.408539772033691
Epoch: 22, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.260 Vali Acc: 0.968 Test Loss: 0.260 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.9569190
	speed: 0.1057s/iter; left time: 3394.0618s
	iters: 200, epoch: 23 | loss: 0.0000028
	speed: 0.0329s/iter; left time: 1053.2588s
	iters: 300, epoch: 23 | loss: 0.0277173
	speed: 0.0345s/iter; left time: 1101.6093s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0312s/iter; left time: 993.9888s
Epoch: 23 cost time: 13.972302675247192
Epoch: 23, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm64_nh16_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
model parameter : 135562
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1364406
	speed: 0.0603s/iter; left time: 2482.8241s
	iters: 200, epoch: 1 | loss: 0.1802565
	speed: 0.0434s/iter; left time: 1782.1517s
	iters: 300, epoch: 1 | loss: 0.0364822
	speed: 0.0455s/iter; left time: 1864.4320s
	iters: 400, epoch: 1 | loss: 0.0393283
	speed: 0.0450s/iter; left time: 1839.3746s
Epoch: 1 cost time: 20.088387727737427
Epoch: 1, Steps: 413 | Train Loss: 0.366 Vali Loss: 0.224 Vali Acc: 0.947 Test Loss: 0.224 Test Acc: 0.947
Validation loss decreased (inf --> -0.947247).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0250837
	speed: 0.1298s/iter; left time: 5292.9173s
	iters: 200, epoch: 2 | loss: 0.2770855
	speed: 0.0442s/iter; left time: 1796.6386s
	iters: 300, epoch: 2 | loss: 0.0003957
	speed: 0.0470s/iter; left time: 1908.7881s
	iters: 400, epoch: 2 | loss: 0.0000022
	speed: 0.0459s/iter; left time: 1857.9558s
Epoch: 2 cost time: 19.275588512420654
Epoch: 2, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
Validation loss decreased (-0.947247 --> -0.964982).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5508753
	speed: 0.1350s/iter; left time: 5449.7712s
	iters: 200, epoch: 3 | loss: 0.0305119
	speed: 0.0464s/iter; left time: 1866.8541s
	iters: 300, epoch: 3 | loss: 0.0252145
	speed: 0.0452s/iter; left time: 1816.7981s
	iters: 400, epoch: 3 | loss: 0.0033929
	speed: 0.0438s/iter; left time: 1756.5879s
Epoch: 3 cost time: 19.45429301261902
Epoch: 3, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.196 Vali Acc: 0.960 Test Loss: 0.196 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000032
	speed: 0.1414s/iter; left time: 5648.9005s
	iters: 200, epoch: 4 | loss: 0.0013859
	speed: 0.0535s/iter; left time: 2132.8449s
	iters: 300, epoch: 4 | loss: 0.1964260
	speed: 0.0545s/iter; left time: 2166.9777s
	iters: 400, epoch: 4 | loss: 0.0002684
	speed: 0.0565s/iter; left time: 2242.6357s
Epoch: 4 cost time: 23.139058351516724
Epoch: 4, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.252 Vali Acc: 0.948 Test Loss: 0.252 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000088
	speed: 0.1427s/iter; left time: 5644.5497s
	iters: 200, epoch: 5 | loss: 0.3013712
	speed: 0.0574s/iter; left time: 2265.6181s
	iters: 300, epoch: 5 | loss: 0.0024917
	speed: 0.0542s/iter; left time: 2132.6596s
	iters: 400, epoch: 5 | loss: 0.2391434
	speed: 0.0532s/iter; left time: 2088.8789s
Epoch: 5 cost time: 23.059430360794067
Epoch: 5, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.247 Vali Acc: 0.962 Test Loss: 0.247 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0251460
	speed: 0.1392s/iter; left time: 5447.9609s
	iters: 200, epoch: 6 | loss: 0.0027220
	speed: 0.0529s/iter; left time: 2065.8676s
	iters: 300, epoch: 6 | loss: 0.0003812
	speed: 0.0551s/iter; left time: 2144.3870s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 2138.6905s
Epoch: 6 cost time: 22.85856342315674
Epoch: 6, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.294 Vali Acc: 0.967 Test Loss: 0.294 Test Acc: 0.967
Validation loss decreased (-0.964982 --> -0.967255).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0003820
	speed: 0.1427s/iter; left time: 5525.5700s
	iters: 200, epoch: 7 | loss: 0.0034630
	speed: 0.0549s/iter; left time: 2119.3687s
	iters: 300, epoch: 7 | loss: 0.0007510
	speed: 0.0556s/iter; left time: 2141.9377s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0535s/iter; left time: 2055.4512s
Epoch: 7 cost time: 22.996274948120117
Epoch: 7, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.365 Vali Acc: 0.956 Test Loss: 0.365 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1429s/iter; left time: 5473.3775s
	iters: 200, epoch: 8 | loss: 0.2217582
	speed: 0.0518s/iter; left time: 1980.5850s
	iters: 300, epoch: 8 | loss: 0.4772096
	speed: 0.0514s/iter; left time: 1958.7445s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 2076.1133s
Epoch: 8 cost time: 22.39487361907959
Epoch: 8, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.548 Vali Acc: 0.958 Test Loss: 0.548 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000074
	speed: 0.1382s/iter; left time: 5237.5341s
	iters: 200, epoch: 9 | loss: 0.0038601
	speed: 0.0546s/iter; left time: 2063.4931s
	iters: 300, epoch: 9 | loss: 0.2206662
	speed: 0.0532s/iter; left time: 2004.1974s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0513s/iter; left time: 1930.3627s
Epoch: 9 cost time: 22.33114743232727
Epoch: 9, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.258 Vali Acc: 0.972 Test Loss: 0.258 Test Acc: 0.972
Validation loss decreased (-0.967255 --> -0.971803).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000013
	speed: 0.1353s/iter; left time: 5072.7576s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0540s/iter; left time: 2020.3026s
	iters: 300, epoch: 10 | loss: 0.0000076
	speed: 0.0522s/iter; left time: 1946.8302s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 1874.2439s
Epoch: 10 cost time: 21.926331758499146
Epoch: 10, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.306 Vali Acc: 0.972 Test Loss: 0.306 Test Acc: 0.972
Validation loss decreased (-0.971803 --> -0.972257).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000088
	speed: 0.1368s/iter; left time: 5071.5871s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0502s/iter; left time: 1856.3684s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 1881.0691s
	iters: 400, epoch: 11 | loss: 0.0108595
	speed: 0.0551s/iter; left time: 2027.8418s
Epoch: 11 cost time: 21.984318256378174
Epoch: 11, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.431 Vali Acc: 0.960 Test Loss: 0.431 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1274s/iter; left time: 4670.3024s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0484s/iter; left time: 1769.5170s
	iters: 300, epoch: 12 | loss: 0.0468540
	speed: 0.0468s/iter; left time: 1706.1132s
	iters: 400, epoch: 12 | loss: 0.0000049
	speed: 0.0445s/iter; left time: 1617.3379s
Epoch: 12 cost time: 19.170844078063965
Epoch: 12, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.412 Vali Acc: 0.965 Test Loss: 0.412 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1227s/iter; left time: 4446.2741s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 1700.5519s
	iters: 300, epoch: 13 | loss: 0.0047667
	speed: 0.0452s/iter; left time: 1629.1025s
	iters: 400, epoch: 13 | loss: 0.0000016
	speed: 0.0419s/iter; left time: 1506.5190s
Epoch: 13 cost time: 19.16001033782959
Epoch: 13, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.341 Vali Acc: 0.965 Test Loss: 0.341 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000085
	speed: 0.1230s/iter; left time: 4406.7833s
	iters: 200, epoch: 14 | loss: 0.0000063
	speed: 0.0431s/iter; left time: 1540.6902s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1744.7711s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1676.1992s
Epoch: 14 cost time: 19.490933418273926
Epoch: 14, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.561 Vali Acc: 0.964 Test Loss: 0.561 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1261s/iter; left time: 4465.4396s
	iters: 200, epoch: 15 | loss: 0.0000478
	speed: 0.0482s/iter; left time: 1702.9308s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1508.2916s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 1575.6674s
Epoch: 15 cost time: 19.268203735351562
Epoch: 15, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.510 Vali Acc: 0.966 Test Loss: 0.510 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1233s/iter; left time: 4317.1849s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0474s/iter; left time: 1655.7337s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 1546.9340s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 1671.8011s
Epoch: 16 cost time: 19.666163444519043
Epoch: 16, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.261 Vali Acc: 0.975 Test Loss: 0.261 Test Acc: 0.975
Validation loss decreased (-0.972257 --> -0.974531).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0013497
	speed: 0.1217s/iter; left time: 4208.5114s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0463s/iter; left time: 1598.6845s
	iters: 300, epoch: 17 | loss: 0.0007348
	speed: 0.0498s/iter; left time: 1712.9046s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0417s/iter; left time: 1428.3912s
Epoch: 17 cost time: 19.207218170166016
Epoch: 17, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.399 Vali Acc: 0.968 Test Loss: 0.399 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1444s/iter; left time: 4936.6299s
	iters: 200, epoch: 18 | loss: 0.0514179
	speed: 0.0543s/iter; left time: 1852.0981s
	iters: 300, epoch: 18 | loss: 0.0000528
	speed: 0.0545s/iter; left time: 1852.7353s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0534s/iter; left time: 1810.5437s
Epoch: 18 cost time: 23.190316200256348
Epoch: 18, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.384 Vali Acc: 0.972 Test Loss: 0.384 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1425s/iter; left time: 4811.6945s
	iters: 200, epoch: 19 | loss: 0.2310967
	speed: 0.0529s/iter; left time: 1780.8414s
	iters: 300, epoch: 19 | loss: 0.0000052
	speed: 0.0543s/iter; left time: 1823.0395s
	iters: 400, epoch: 19 | loss: 0.0067566
	speed: 0.0555s/iter; left time: 1856.9350s
Epoch: 19 cost time: 22.950439453125
Epoch: 19, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.492 Vali Acc: 0.969 Test Loss: 0.492 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1460s/iter; left time: 4869.4760s
	iters: 200, epoch: 20 | loss: 0.0000083
	speed: 0.0564s/iter; left time: 1876.7960s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 1769.9179s
	iters: 400, epoch: 20 | loss: 0.1903877
	speed: 0.0563s/iter; left time: 1859.6306s
Epoch: 20 cost time: 23.42118525505066
Epoch: 20, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.492 Vali Acc: 0.965 Test Loss: 0.492 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000025
	speed: 0.1382s/iter; left time: 4551.4508s
	iters: 200, epoch: 21 | loss: 0.2402827
	speed: 0.0558s/iter; left time: 1833.0933s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.0564s/iter; left time: 1847.7952s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 1725.0398s
Epoch: 21 cost time: 22.96833086013794
Epoch: 21, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.464 Vali Acc: 0.973 Test Loss: 0.464 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1361s/iter; left time: 4425.8537s
	iters: 200, epoch: 22 | loss: 0.0000005
	speed: 0.0518s/iter; left time: 1680.5811s
	iters: 300, epoch: 22 | loss: 0.0004501
	speed: 0.0530s/iter; left time: 1713.2788s
	iters: 400, epoch: 22 | loss: 0.0001789
	speed: 0.0506s/iter; left time: 1629.1955s
Epoch: 22 cost time: 21.837255239486694
Epoch: 22, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.485 Vali Acc: 0.971 Test Loss: 0.485 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000034
	speed: 0.1381s/iter; left time: 4435.1429s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0508s/iter; left time: 1626.4590s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 1659.6355s
	iters: 400, epoch: 23 | loss: 0.0131427
	speed: 0.0483s/iter; left time: 1536.0657s
Epoch: 23 cost time: 21.422544717788696
Epoch: 23, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.440 Vali Acc: 0.975 Test Loss: 0.440 Test Acc: 0.975
Validation loss decreased (-0.974531 --> -0.975439).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1298s/iter; left time: 4114.2821s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 1639.3036s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 1548.6680s
	iters: 400, epoch: 24 | loss: 0.0051280
	speed: 0.0497s/iter; left time: 1562.1583s
Epoch: 24 cost time: 21.14215111732483
Epoch: 24, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.351 Vali Acc: 0.975 Test Loss: 0.351 Test Acc: 0.975
Validation loss decreased (-0.975439 --> -0.975440).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000047
	speed: 0.1328s/iter; left time: 4154.2178s
	iters: 200, epoch: 25 | loss: 0.1494032
	speed: 0.0507s/iter; left time: 1580.3610s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 1554.9124s
	iters: 400, epoch: 25 | loss: 0.0045705
	speed: 0.0509s/iter; left time: 1577.4776s
Epoch: 25 cost time: 21.195383310317993
Epoch: 25, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.385 Vali Acc: 0.970 Test Loss: 0.385 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1236s/iter; left time: 3816.8889s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1318.1257s
	iters: 300, epoch: 26 | loss: 0.0000024
	speed: 0.0464s/iter; left time: 1424.3118s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 1324.7513s
Epoch: 26 cost time: 18.25487756729126
Epoch: 26, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.437 Vali Acc: 0.970 Test Loss: 0.437 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1297s/iter; left time: 3951.1590s
	iters: 200, epoch: 27 | loss: 0.0000777
	speed: 0.0445s/iter; left time: 1350.2327s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 1340.8687s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0446s/iter; left time: 1345.4038s
Epoch: 27 cost time: 19.04224443435669
Epoch: 27, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.420 Vali Acc: 0.972 Test Loss: 0.420 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000002
	speed: 0.1220s/iter; left time: 3664.7461s
	iters: 200, epoch: 28 | loss: 0.0063078
	speed: 0.0442s/iter; left time: 1324.3925s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0423s/iter; left time: 1261.2308s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 1298.0097s
Epoch: 28 cost time: 18.347055673599243
Epoch: 28, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.570 Vali Acc: 0.964 Test Loss: 0.570 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1181s/iter; left time: 3500.8822s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 1436.7319s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0497s/iter; left time: 1463.2705s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0466s/iter; left time: 1367.9415s
Epoch: 29 cost time: 20.145143747329712
Epoch: 29, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.642 Vali Acc: 0.966 Test Loss: 0.642 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1337s/iter; left time: 3905.8746s
	iters: 200, epoch: 30 | loss: 0.0000004
	speed: 0.0443s/iter; left time: 1289.6956s
	iters: 300, epoch: 30 | loss: 0.0000002
	speed: 0.0480s/iter; left time: 1393.5093s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 1372.0801s
Epoch: 30 cost time: 20.19913911819458
Epoch: 30, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.580 Vali Acc: 0.966 Test Loss: 0.580 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1315s/iter; left time: 3789.0326s
	iters: 200, epoch: 31 | loss: 0.0058870
	speed: 0.0465s/iter; left time: 1334.6250s
	iters: 300, epoch: 31 | loss: 0.0001776
	speed: 0.0445s/iter; left time: 1271.8834s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 1550.4486s
Epoch: 31 cost time: 20.788943767547607
Epoch: 31, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.573 Vali Acc: 0.963 Test Loss: 0.573 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0000008
	speed: 0.1444s/iter; left time: 4100.9565s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 1574.6636s
	iters: 300, epoch: 32 | loss: 0.0000016
	speed: 0.0522s/iter; left time: 1473.2446s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 1479.2768s
Epoch: 32 cost time: 22.764368534088135
Epoch: 32, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.615 Vali Acc: 0.964 Test Loss: 0.615 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1421s/iter; left time: 3975.4871s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 1478.4777s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0550s/iter; left time: 1527.6913s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0542s/iter; left time: 1500.2480s
Epoch: 33 cost time: 22.604650020599365
Epoch: 33, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.415 Vali Acc: 0.974 Test Loss: 0.415 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0000003
	speed: 0.1392s/iter; left time: 3837.4857s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0531s/iter; left time: 1457.5112s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 1426.1134s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 1410.0677s
Epoch: 34 cost time: 22.101771593093872
Epoch: 34, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.529 Vali Acc: 0.972 Test Loss: 0.529 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 258762
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6083556
	speed: 0.1012s/iter; left time: 4168.0932s
	iters: 200, epoch: 1 | loss: 0.0472729
	speed: 0.0760s/iter; left time: 3124.9207s
	iters: 300, epoch: 1 | loss: 0.0873199
	speed: 0.0776s/iter; left time: 3179.9662s
	iters: 400, epoch: 1 | loss: 0.0080384
	speed: 0.0814s/iter; left time: 3328.8704s
Epoch: 1 cost time: 34.74308776855469
Epoch: 1, Steps: 413 | Train Loss: 0.352 Vali Loss: 0.129 Vali Acc: 0.956 Test Loss: 0.129 Test Acc: 0.956
Validation loss decreased (inf --> -0.956342).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0221854
	speed: 0.1679s/iter; left time: 6849.7926s
	iters: 200, epoch: 2 | loss: 0.0007554
	speed: 0.0872s/iter; left time: 3546.4813s
	iters: 300, epoch: 2 | loss: 0.0788616
	speed: 0.0828s/iter; left time: 3361.9511s
	iters: 400, epoch: 2 | loss: 0.0011614
	speed: 0.0846s/iter; left time: 3426.8676s
Epoch: 2 cost time: 35.395620584487915
Epoch: 2, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.956342 --> -0.969985).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0369669
	speed: 0.1705s/iter; left time: 6883.8253s
	iters: 200, epoch: 3 | loss: 0.0053187
	speed: 0.0585s/iter; left time: 2357.6573s
	iters: 300, epoch: 3 | loss: 0.0032916
	speed: 0.0520s/iter; left time: 2089.8974s
	iters: 400, epoch: 3 | loss: 0.1052560
	speed: 0.0444s/iter; left time: 1778.3379s
Epoch: 3 cost time: 25.093389987945557
Epoch: 3, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.181 Vali Acc: 0.961 Test Loss: 0.181 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0002900
	speed: 0.1282s/iter; left time: 5121.1488s
	iters: 200, epoch: 4 | loss: 0.0000096
	speed: 0.0475s/iter; left time: 1893.5352s
	iters: 300, epoch: 4 | loss: 0.3000304
	speed: 0.0593s/iter; left time: 2358.3905s
	iters: 400, epoch: 4 | loss: 0.0063439
	speed: 0.0444s/iter; left time: 1759.3028s
Epoch: 4 cost time: 20.96790623664856
Epoch: 4, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.199 Vali Acc: 0.965 Test Loss: 0.199 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0073693
	speed: 0.1335s/iter; left time: 5279.7121s
	iters: 200, epoch: 5 | loss: 0.0141873
	speed: 0.0433s/iter; left time: 1710.0010s
	iters: 300, epoch: 5 | loss: 0.0000018
	speed: 0.0424s/iter; left time: 1668.5507s
	iters: 400, epoch: 5 | loss: 0.0015130
	speed: 0.0536s/iter; left time: 2103.6788s
Epoch: 5 cost time: 20.460819721221924
Epoch: 5, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.298 Vali Acc: 0.953 Test Loss: 0.298 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000258
	speed: 0.1249s/iter; left time: 4889.8081s
	iters: 200, epoch: 6 | loss: 0.0002849
	speed: 0.0490s/iter; left time: 1914.3412s
	iters: 300, epoch: 6 | loss: 0.0621671
	speed: 0.0563s/iter; left time: 2191.7457s
	iters: 400, epoch: 6 | loss: 0.0011567
	speed: 0.0484s/iter; left time: 1878.1009s
Epoch: 6 cost time: 20.90554165840149
Epoch: 6, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.322 Vali Acc: 0.956 Test Loss: 0.322 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000662
	speed: 0.1243s/iter; left time: 4813.3216s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 1647.0268s
	iters: 300, epoch: 7 | loss: 0.5010276
	speed: 0.0481s/iter; left time: 1854.5821s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 2065.6128s
Epoch: 7 cost time: 21.004616260528564
Epoch: 7, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0006150
	speed: 0.1661s/iter; left time: 6362.4633s
	iters: 200, epoch: 8 | loss: 0.0000320
	speed: 0.0812s/iter; left time: 3101.0997s
	iters: 300, epoch: 8 | loss: 0.0177472
	speed: 0.0836s/iter; left time: 3187.7004s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0866s/iter; left time: 3291.6018s
Epoch: 8 cost time: 34.85487699508667
Epoch: 8, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.279 Vali Acc: 0.963 Test Loss: 0.279 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000013
	speed: 0.1680s/iter; left time: 6364.9731s
	iters: 200, epoch: 9 | loss: 0.0000162
	speed: 0.0853s/iter; left time: 3225.6207s
	iters: 300, epoch: 9 | loss: 0.4142714
	speed: 0.0848s/iter; left time: 3195.2430s
	iters: 400, epoch: 9 | loss: 0.0000003
	speed: 0.0832s/iter; left time: 3128.9231s
Epoch: 9 cost time: 35.1522901058197
Epoch: 9, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.250 Vali Acc: 0.963 Test Loss: 0.250 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000008
	speed: 0.1643s/iter; left time: 6157.4077s
	iters: 200, epoch: 10 | loss: 0.0314632
	speed: 0.0836s/iter; left time: 3126.5116s
	iters: 300, epoch: 10 | loss: 0.0000002
	speed: 0.0761s/iter; left time: 2837.6835s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0829s/iter; left time: 3082.3971s
Epoch: 10 cost time: 33.68176007270813
Epoch: 10, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.410 Vali Acc: 0.965 Test Loss: 0.410 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000008
	speed: 0.1707s/iter; left time: 6328.6894s
	iters: 200, epoch: 11 | loss: 0.0000050
	speed: 0.0792s/iter; left time: 2927.0955s
	iters: 300, epoch: 11 | loss: 0.0000003
	speed: 0.0808s/iter; left time: 2979.0804s
	iters: 400, epoch: 11 | loss: 0.2180700
	speed: 0.0819s/iter; left time: 3011.0005s
Epoch: 11 cost time: 33.90896916389465
Epoch: 11, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.410 Vali Acc: 0.960 Test Loss: 0.410 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1702s/iter; left time: 6237.3898s
	iters: 200, epoch: 12 | loss: 0.0000443
	speed: 0.0781s/iter; left time: 2854.3330s
	iters: 300, epoch: 12 | loss: 0.0000008
	speed: 0.0476s/iter; left time: 1735.5648s
	iters: 400, epoch: 12 | loss: 0.0000092
	speed: 0.0516s/iter; left time: 1877.0860s
Epoch: 12 cost time: 27.20084810256958
Epoch: 12, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.421 Vali Acc: 0.956 Test Loss: 0.421 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9699863574351978
model parameter : 192266
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2486857
	speed: 0.0679s/iter; left time: 2799.4991s
	iters: 200, epoch: 1 | loss: 0.0165245
	speed: 0.0471s/iter; left time: 1934.9813s
	iters: 300, epoch: 1 | loss: 0.0104158
	speed: 0.0508s/iter; left time: 2084.3732s
	iters: 400, epoch: 1 | loss: 0.0809780
	speed: 0.0474s/iter; left time: 1937.0235s
Epoch: 1 cost time: 22.009788990020752
Epoch: 1, Steps: 413 | Train Loss: 0.394 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
Validation loss decreased (inf --> -0.964528).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0023770
	speed: 0.1147s/iter; left time: 4678.9432s
	iters: 200, epoch: 2 | loss: 0.0079777
	speed: 0.0487s/iter; left time: 1981.0942s
	iters: 300, epoch: 2 | loss: 0.0179867
	speed: 0.0542s/iter; left time: 2201.5614s
	iters: 400, epoch: 2 | loss: 0.0004763
	speed: 0.0421s/iter; left time: 1706.0083s
Epoch: 2 cost time: 20.035404920578003
Epoch: 2, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1705623
	speed: 0.1240s/iter; left time: 5007.6148s
	iters: 200, epoch: 3 | loss: 0.0008350
	speed: 0.0407s/iter; left time: 1638.5079s
	iters: 300, epoch: 3 | loss: 0.0138141
	speed: 0.0503s/iter; left time: 2019.6542s
	iters: 400, epoch: 3 | loss: 0.0000008
	speed: 0.0482s/iter; left time: 1930.2825s
Epoch: 3 cost time: 20.07809805870056
Epoch: 3, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
Validation loss decreased (-0.964528 --> -0.967257).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4321180
	speed: 0.1362s/iter; left time: 5442.6028s
	iters: 200, epoch: 4 | loss: 0.0000190
	speed: 0.0862s/iter; left time: 3435.0491s
	iters: 300, epoch: 4 | loss: 0.1754660
	speed: 0.0786s/iter; left time: 3126.8603s
	iters: 400, epoch: 4 | loss: 0.1938588
	speed: 0.0862s/iter; left time: 3418.4462s
Epoch: 4 cost time: 32.533628940582275
Epoch: 4, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000412
	speed: 0.1632s/iter; left time: 6452.7562s
	iters: 200, epoch: 5 | loss: 0.0075597
	speed: 0.0807s/iter; left time: 3185.2772s
	iters: 300, epoch: 5 | loss: 0.2347554
	speed: 0.0818s/iter; left time: 3218.9341s
	iters: 400, epoch: 5 | loss: 0.0142710
	speed: 0.0823s/iter; left time: 3231.4795s
Epoch: 5 cost time: 34.20835852622986
Epoch: 5, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.295 Vali Acc: 0.964 Test Loss: 0.295 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000065
	speed: 0.1644s/iter; left time: 6432.1164s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0819s/iter; left time: 3198.9544s
	iters: 300, epoch: 6 | loss: 0.0166023
	speed: 0.0860s/iter; left time: 3348.2355s
	iters: 400, epoch: 6 | loss: 0.1530699
	speed: 0.0831s/iter; left time: 3228.8023s
Epoch: 6 cost time: 35.11494445800781
Epoch: 6, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.223 Vali Acc: 0.965 Test Loss: 0.223 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0008784
	speed: 0.1589s/iter; left time: 6154.2276s
	iters: 200, epoch: 7 | loss: 0.0202567
	speed: 0.0836s/iter; left time: 3228.5717s
	iters: 300, epoch: 7 | loss: 0.0000038
	speed: 0.0764s/iter; left time: 2942.2944s
	iters: 400, epoch: 7 | loss: 0.0000009
	speed: 0.0793s/iter; left time: 3045.2534s
Epoch: 7 cost time: 33.43782162666321
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
Validation loss decreased (-0.967257 --> -0.970439).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000138
	speed: 0.1648s/iter; left time: 6312.0128s
	iters: 200, epoch: 8 | loss: 0.0002993
	speed: 0.0824s/iter; left time: 3149.8663s
	iters: 300, epoch: 8 | loss: 0.0037880
	speed: 0.0815s/iter; left time: 3107.3648s
	iters: 400, epoch: 8 | loss: 0.0107619
	speed: 0.0821s/iter; left time: 3122.4514s
Epoch: 8 cost time: 34.23871636390686
Epoch: 8, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.239 Vali Acc: 0.963 Test Loss: 0.239 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1412764
	speed: 0.1288s/iter; left time: 4882.7469s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1851.7361s
	iters: 300, epoch: 9 | loss: 0.0000140
	speed: 0.0447s/iter; left time: 1684.0201s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0395s/iter; left time: 1486.5462s
Epoch: 9 cost time: 19.46461796760559
Epoch: 9, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.308 Vali Acc: 0.963 Test Loss: 0.308 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000028
	speed: 0.1159s/iter; left time: 4345.8887s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 1662.5345s
	iters: 300, epoch: 10 | loss: 0.0000033
	speed: 0.0533s/iter; left time: 1987.3044s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0451s/iter; left time: 1676.8119s
Epoch: 10 cost time: 19.584012985229492
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.152 Vali Acc: 0.980 Test Loss: 0.152 Test Acc: 0.980
Validation loss decreased (-0.970439 --> -0.979535).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1166s/iter; left time: 4321.9857s
	iters: 200, epoch: 11 | loss: 0.0000019
	speed: 0.0484s/iter; left time: 1788.8533s
	iters: 300, epoch: 11 | loss: 0.0660883
	speed: 0.0461s/iter; left time: 1700.5661s
	iters: 400, epoch: 11 | loss: 0.0000172
	speed: 0.0420s/iter; left time: 1544.6175s
Epoch: 11 cost time: 18.664769411087036
Epoch: 11, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.349 Vali Acc: 0.960 Test Loss: 0.349 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1205s/iter; left time: 4416.3545s
	iters: 200, epoch: 12 | loss: 0.0000036
	speed: 0.0439s/iter; left time: 1603.5520s
	iters: 300, epoch: 12 | loss: 0.0000009
	speed: 0.0562s/iter; left time: 2050.0067s
	iters: 400, epoch: 12 | loss: 0.0014407
	speed: 0.0451s/iter; left time: 1640.0283s
Epoch: 12 cost time: 20.35646152496338
Epoch: 12, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.246 Vali Acc: 0.976 Test Loss: 0.246 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1162s/iter; left time: 4211.8420s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 1776.5388s
	iters: 300, epoch: 13 | loss: 0.0000013
	speed: 0.0816s/iter; left time: 2939.5250s
	iters: 400, epoch: 13 | loss: 0.0000019
	speed: 0.0863s/iter; left time: 3100.2708s
Epoch: 13 cost time: 28.16546654701233
Epoch: 13, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.227 Vali Acc: 0.971 Test Loss: 0.227 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1604s/iter; left time: 5747.5859s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0759s/iter; left time: 2711.3466s
	iters: 300, epoch: 14 | loss: 0.0111129
	speed: 0.0840s/iter; left time: 2994.0533s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0838s/iter; left time: 2977.2471s
Epoch: 14 cost time: 34.038068771362305
Epoch: 14, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.279 Vali Acc: 0.971 Test Loss: 0.279 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000076
	speed: 0.1635s/iter; left time: 5789.7850s
	iters: 200, epoch: 15 | loss: 0.1962177
	speed: 0.0825s/iter; left time: 2915.5064s
	iters: 300, epoch: 15 | loss: 0.0002403
	speed: 0.0871s/iter; left time: 3065.9887s
	iters: 400, epoch: 15 | loss: 0.0000004
	speed: 0.0812s/iter; left time: 2853.4102s
Epoch: 15 cost time: 35.08119297027588
Epoch: 15, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.276 Vali Acc: 0.970 Test Loss: 0.276 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1506825
	speed: 0.1533s/iter; left time: 5368.0398s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0900s/iter; left time: 3142.7518s
	iters: 300, epoch: 16 | loss: 0.2514348
	speed: 0.0834s/iter; left time: 2901.5111s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0853s/iter; left time: 2962.0610s
Epoch: 16 cost time: 35.30671000480652
Epoch: 16, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.295 Vali Acc: 0.979 Test Loss: 0.295 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1558s/iter; left time: 5388.9510s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0857s/iter; left time: 2954.3784s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 2843.3690s
	iters: 400, epoch: 17 | loss: 0.0000069
	speed: 0.0836s/iter; left time: 2866.1064s
Epoch: 17 cost time: 34.66167902946472
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.266 Vali Acc: 0.974 Test Loss: 0.266 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1592s/iter; left time: 5441.9766s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 1807.7497s
	iters: 300, epoch: 18 | loss: 0.0000016
	speed: 0.0490s/iter; left time: 1664.7557s
	iters: 400, epoch: 18 | loss: 0.2311753
	speed: 0.0486s/iter; left time: 1646.5380s
Epoch: 18 cost time: 24.359129428863525
Epoch: 18, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.432 Vali Acc: 0.962 Test Loss: 0.432 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1956344
	speed: 0.1173s/iter; left time: 3961.1076s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 1692.7959s
	iters: 300, epoch: 19 | loss: 0.0857441
	speed: 0.0392s/iter; left time: 1316.3987s
	iters: 400, epoch: 19 | loss: 0.0000139
	speed: 0.0446s/iter; left time: 1493.7173s
Epoch: 19 cost time: 19.17462658882141
Epoch: 19, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.292 Vali Acc: 0.975 Test Loss: 0.292 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1209s/iter; left time: 4033.3082s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0456s/iter; left time: 1515.4341s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0408s/iter; left time: 1353.7720s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0475s/iter; left time: 1569.5981s
Epoch: 20 cost time: 19.390182733535767
Epoch: 20, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.299 Vali Acc: 0.978 Test Loss: 0.299 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 159050
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3827453
	speed: 0.0549s/iter; left time: 2261.0506s
	iters: 200, epoch: 1 | loss: 0.0429726
	speed: 0.0380s/iter; left time: 1562.2496s
	iters: 300, epoch: 1 | loss: 0.0243043
	speed: 0.0347s/iter; left time: 1424.6076s
	iters: 400, epoch: 1 | loss: 0.0063804
	speed: 0.0330s/iter; left time: 1347.7897s
Epoch: 1 cost time: 16.592129945755005
Epoch: 1, Steps: 413 | Train Loss: 0.403 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
Validation loss decreased (inf --> -0.953614).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2291602
	speed: 0.0990s/iter; left time: 4038.3966s
	iters: 200, epoch: 2 | loss: 0.0279446
	speed: 0.0322s/iter; left time: 1308.9007s
	iters: 300, epoch: 2 | loss: 0.1495930
	speed: 0.0271s/iter; left time: 1100.7699s
	iters: 400, epoch: 2 | loss: 0.0449202
	speed: 0.0366s/iter; left time: 1481.6310s
Epoch: 2 cost time: 13.830252170562744
Epoch: 2, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.953614 --> -0.961800).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0012657
	speed: 0.1025s/iter; left time: 4139.3671s
	iters: 200, epoch: 3 | loss: 0.0012298
	speed: 0.0372s/iter; left time: 1499.8612s
	iters: 300, epoch: 3 | loss: 0.0009112
	speed: 0.0350s/iter; left time: 1405.6444s
	iters: 400, epoch: 3 | loss: 0.0002931
	speed: 0.0375s/iter; left time: 1503.6139s
Epoch: 3 cost time: 15.432663679122925
Epoch: 3, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
Validation loss decreased (-0.961800 --> -0.967256).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0058509
	speed: 0.1065s/iter; left time: 4257.8996s
	iters: 200, epoch: 4 | loss: 0.1817146
	speed: 0.0363s/iter; left time: 1445.9039s
	iters: 300, epoch: 4 | loss: 0.1381656
	speed: 0.0391s/iter; left time: 1556.1579s
	iters: 400, epoch: 4 | loss: 0.0005871
	speed: 0.0363s/iter; left time: 1438.7248s
Epoch: 4 cost time: 15.590396881103516
Epoch: 4, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.967256 --> -0.970440).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000694
	speed: 0.0814s/iter; left time: 3218.9110s
	iters: 200, epoch: 5 | loss: 0.0000071
	speed: 0.0232s/iter; left time: 914.7354s
	iters: 300, epoch: 5 | loss: 0.3373593
	speed: 0.0221s/iter; left time: 870.8086s
	iters: 400, epoch: 5 | loss: 0.0874733
	speed: 0.0214s/iter; left time: 839.6881s
Epoch: 5 cost time: 9.498724460601807
Epoch: 5, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
Validation loss decreased (-0.970440 --> -0.976352).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0031690
	speed: 0.0745s/iter; left time: 2916.7160s
	iters: 200, epoch: 6 | loss: 0.2910302
	speed: 0.0226s/iter; left time: 883.6615s
	iters: 300, epoch: 6 | loss: 0.0001917
	speed: 0.0340s/iter; left time: 1323.4898s
	iters: 400, epoch: 6 | loss: 0.0000696
	speed: 0.0391s/iter; left time: 1520.0799s
Epoch: 6 cost time: 12.689819812774658
Epoch: 6, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.283 Vali Acc: 0.951 Test Loss: 0.283 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0434285
	speed: 0.1026s/iter; left time: 3974.6589s
	iters: 200, epoch: 7 | loss: 0.0004727
	speed: 0.0387s/iter; left time: 1495.3533s
	iters: 300, epoch: 7 | loss: 0.0157075
	speed: 0.0396s/iter; left time: 1525.2618s
	iters: 400, epoch: 7 | loss: 0.0370096
	speed: 0.0419s/iter; left time: 1608.2143s
Epoch: 7 cost time: 16.68714666366577
Epoch: 7, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.966 Test Loss: 0.163 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000971
	speed: 0.1091s/iter; left time: 4179.1919s
	iters: 200, epoch: 8 | loss: 0.0025838
	speed: 0.0411s/iter; left time: 1571.3115s
	iters: 300, epoch: 8 | loss: 0.0003820
	speed: 0.0400s/iter; left time: 1523.6932s
	iters: 400, epoch: 8 | loss: 0.0149358
	speed: 0.0393s/iter; left time: 1494.5118s
Epoch: 8 cost time: 16.95066213607788
Epoch: 8, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.203 Vali Acc: 0.968 Test Loss: 0.203 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0029240
	speed: 0.1060s/iter; left time: 4016.5148s
	iters: 200, epoch: 9 | loss: 0.3807286
	speed: 0.0403s/iter; left time: 1523.0437s
	iters: 300, epoch: 9 | loss: 0.1811770
	speed: 0.0402s/iter; left time: 1516.0452s
	iters: 400, epoch: 9 | loss: 0.0000082
	speed: 0.0383s/iter; left time: 1441.3851s
Epoch: 9 cost time: 16.771155834197998
Epoch: 9, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.216 Vali Acc: 0.971 Test Loss: 0.216 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0015540
	speed: 0.1043s/iter; left time: 3908.1331s
	iters: 200, epoch: 10 | loss: 0.0000836
	speed: 0.0375s/iter; left time: 1401.9772s
	iters: 300, epoch: 10 | loss: 0.0004981
	speed: 0.0374s/iter; left time: 1393.8212s
	iters: 400, epoch: 10 | loss: 0.0000010
	speed: 0.0375s/iter; left time: 1396.1710s
Epoch: 10 cost time: 16.071231603622437
Epoch: 10, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.976352 --> -0.976806).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.1047s/iter; left time: 3881.7525s
	iters: 200, epoch: 11 | loss: 0.0000363
	speed: 0.0384s/iter; left time: 1419.4614s
	iters: 300, epoch: 11 | loss: 0.1858243
	speed: 0.0396s/iter; left time: 1459.7384s
	iters: 400, epoch: 11 | loss: 0.0000223
	speed: 0.0386s/iter; left time: 1418.9522s
Epoch: 11 cost time: 16.29221272468567
Epoch: 11, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.190 Vali Acc: 0.970 Test Loss: 0.190 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000012
	speed: 0.1097s/iter; left time: 4023.0580s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1429.8722s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0382s/iter; left time: 1394.1248s
	iters: 400, epoch: 12 | loss: 0.0002215
	speed: 0.0386s/iter; left time: 1404.8971s
Epoch: 12 cost time: 16.27910017967224
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.309 Vali Acc: 0.960 Test Loss: 0.309 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0002518
	speed: 0.1091s/iter; left time: 3954.6653s
	iters: 200, epoch: 13 | loss: 0.0000070
	speed: 0.0385s/iter; left time: 1392.2731s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 1280.2039s
	iters: 400, epoch: 13 | loss: 0.0000009
	speed: 0.0362s/iter; left time: 1299.6765s
Epoch: 13 cost time: 15.743208408355713
Epoch: 13, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1062s/iter; left time: 3806.0036s
	iters: 200, epoch: 14 | loss: 0.0000012
	speed: 0.0283s/iter; left time: 1012.6436s
	iters: 300, epoch: 14 | loss: 0.0000034
	speed: 0.0293s/iter; left time: 1042.2662s
	iters: 400, epoch: 14 | loss: 0.0875862
	speed: 0.0298s/iter; left time: 1059.7518s
Epoch: 14 cost time: 13.249727249145508
Epoch: 14, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.167 Vali Acc: 0.980 Test Loss: 0.167 Test Acc: 0.980
Validation loss decreased (-0.976806 --> -0.979989).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0975s/iter; left time: 3453.7645s
	iters: 200, epoch: 15 | loss: 0.0104911
	speed: 0.0287s/iter; left time: 1012.4157s
	iters: 300, epoch: 15 | loss: 0.0002291
	speed: 0.0291s/iter; left time: 1024.7168s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0296s/iter; left time: 1039.6357s
Epoch: 15 cost time: 12.518966436386108
Epoch: 15, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.218 Vali Acc: 0.977 Test Loss: 0.218 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0936s/iter; left time: 3277.1299s
	iters: 200, epoch: 16 | loss: 0.0002997
	speed: 0.0286s/iter; left time: 997.5160s
	iters: 300, epoch: 16 | loss: 0.0000057
	speed: 0.0272s/iter; left time: 945.1283s
	iters: 400, epoch: 16 | loss: 0.0836022
	speed: 0.0304s/iter; left time: 1055.5031s
Epoch: 16 cost time: 12.314959287643433
Epoch: 16, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0980s/iter; left time: 3390.9518s
	iters: 200, epoch: 17 | loss: 0.0000078
	speed: 0.0311s/iter; left time: 1072.0304s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0323s/iter; left time: 1109.8307s
	iters: 400, epoch: 17 | loss: 0.0002244
	speed: 0.0296s/iter; left time: 1014.0730s
Epoch: 17 cost time: 13.040315866470337
Epoch: 17, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.278 Vali Acc: 0.972 Test Loss: 0.278 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000031
	speed: 0.0983s/iter; left time: 3361.3295s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 1026.3474s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0295s/iter; left time: 1001.5982s
	iters: 400, epoch: 18 | loss: 0.0180256
	speed: 0.0296s/iter; left time: 1002.3979s
Epoch: 18 cost time: 12.88215947151184
Epoch: 18, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.258 Vali Acc: 0.971 Test Loss: 0.258 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0299921
	speed: 0.1040s/iter; left time: 3513.2539s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 1292.6577s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0393s/iter; left time: 1319.9995s
	iters: 400, epoch: 19 | loss: 0.0000007
	speed: 0.0377s/iter; left time: 1262.3512s
Epoch: 19 cost time: 16.412617444992065
Epoch: 19, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.318 Vali Acc: 0.974 Test Loss: 0.318 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1075s/iter; left time: 3584.4022s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0366s/iter; left time: 1216.9654s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0393s/iter; left time: 1301.3780s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 1282.4402s
Epoch: 20 cost time: 16.07465696334839
Epoch: 20, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.249 Vali Acc: 0.977 Test Loss: 0.249 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0001233
	speed: 0.1014s/iter; left time: 3340.5683s
	iters: 200, epoch: 21 | loss: 0.0000088
	speed: 0.0395s/iter; left time: 1296.1102s
	iters: 300, epoch: 21 | loss: 0.0000109
	speed: 0.0416s/iter; left time: 1362.0512s
	iters: 400, epoch: 21 | loss: 0.0000499
	speed: 0.0410s/iter; left time: 1336.9252s
Epoch: 21 cost time: 16.610880851745605
Epoch: 21, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.245 Vali Acc: 0.974 Test Loss: 0.245 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1101s/iter; left time: 3581.3209s
	iters: 200, epoch: 22 | loss: 0.0000002
	speed: 0.0433s/iter; left time: 1403.4141s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0429s/iter; left time: 1387.8097s
	iters: 400, epoch: 22 | loss: 0.0000004
	speed: 0.0432s/iter; left time: 1390.8280s
Epoch: 22 cost time: 17.935453414916992
Epoch: 22, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.309 Vali Acc: 0.970 Test Loss: 0.309 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000001
	speed: 0.1145s/iter; left time: 3677.4831s
	iters: 200, epoch: 23 | loss: 0.0000001
	speed: 0.0433s/iter; left time: 1384.7126s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 1292.0440s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 1389.2037s
Epoch: 23 cost time: 17.851003646850586
Epoch: 23, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.276 Vali Acc: 0.971 Test Loss: 0.276 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000302
	speed: 0.1142s/iter; left time: 3620.7146s
	iters: 200, epoch: 24 | loss: 0.0000215
	speed: 0.0403s/iter; left time: 1274.8646s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0429s/iter; left time: 1350.4181s
	iters: 400, epoch: 24 | loss: 0.0032987
	speed: 0.0419s/iter; left time: 1315.5445s
Epoch: 24 cost time: 17.470085859298706
Epoch: 24, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.363 Vali Acc: 0.970 Test Loss: 0.363 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 138346
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3035625
	speed: 0.0565s/iter; left time: 2329.0466s
	iters: 200, epoch: 1 | loss: 0.2725964
	speed: 0.0391s/iter; left time: 1607.5439s
	iters: 300, epoch: 1 | loss: 0.1412857
	speed: 0.0405s/iter; left time: 1662.1091s
	iters: 400, epoch: 1 | loss: 0.0163914
	speed: 0.0437s/iter; left time: 1785.5525s
Epoch: 1 cost time: 18.52267360687256
Epoch: 1, Steps: 413 | Train Loss: 0.450 Vali Loss: 0.075 Vali Acc: 0.971 Test Loss: 0.075 Test Acc: 0.971
Validation loss decreased (inf --> -0.970895).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0103532
	speed: 0.1042s/iter; left time: 4249.8690s
	iters: 200, epoch: 2 | loss: 0.3353780
	speed: 0.0321s/iter; left time: 1307.8774s
	iters: 300, epoch: 2 | loss: 0.1790531
	speed: 0.0314s/iter; left time: 1273.5363s
	iters: 400, epoch: 2 | loss: 0.0042824
	speed: 0.0302s/iter; left time: 1222.0909s
Epoch: 2 cost time: 13.494158267974854
Epoch: 2, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.088 Vali Acc: 0.966 Test Loss: 0.088 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0007878
	speed: 0.1054s/iter; left time: 4253.9604s
	iters: 200, epoch: 3 | loss: 0.0044239
	speed: 0.0297s/iter; left time: 1196.8907s
	iters: 300, epoch: 3 | loss: 0.0256150
	speed: 0.0312s/iter; left time: 1255.1170s
	iters: 400, epoch: 3 | loss: 0.0005986
	speed: 0.0323s/iter; left time: 1293.9269s
Epoch: 3 cost time: 13.24230694770813
Epoch: 3, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.970895 --> -0.972714).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0152085
	speed: 0.1054s/iter; left time: 4212.9596s
	iters: 200, epoch: 4 | loss: 0.0025370
	speed: 0.0292s/iter; left time: 1162.3701s
	iters: 300, epoch: 4 | loss: 0.0518053
	speed: 0.0298s/iter; left time: 1186.0991s
	iters: 400, epoch: 4 | loss: 0.0122789
	speed: 0.0306s/iter; left time: 1215.3386s
Epoch: 4 cost time: 13.043120384216309
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.972714 --> -0.975897).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0243089
	speed: 0.1035s/iter; left time: 4093.0802s
	iters: 200, epoch: 5 | loss: 0.3405901
	speed: 0.0312s/iter; left time: 1232.5965s
	iters: 300, epoch: 5 | loss: 0.0465949
	speed: 0.0307s/iter; left time: 1208.1360s
	iters: 400, epoch: 5 | loss: 0.0012834
	speed: 0.0305s/iter; left time: 1196.1374s
Epoch: 5 cost time: 13.138561964035034
Epoch: 5, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0031033
	speed: 0.0947s/iter; left time: 3704.9575s
	iters: 200, epoch: 6 | loss: 0.0001538
	speed: 0.0332s/iter; left time: 1296.0544s
	iters: 300, epoch: 6 | loss: 0.0308418
	speed: 0.0322s/iter; left time: 1254.3749s
	iters: 400, epoch: 6 | loss: 0.0043815
	speed: 0.0312s/iter; left time: 1211.6004s
Epoch: 6 cost time: 13.18880319595337
Epoch: 6, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.975897 --> -0.978626).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0011892
	speed: 0.1133s/iter; left time: 4386.6325s
	iters: 200, epoch: 7 | loss: 0.5611746
	speed: 0.0398s/iter; left time: 1536.0058s
	iters: 300, epoch: 7 | loss: 0.0000189
	speed: 0.0405s/iter; left time: 1560.0320s
	iters: 400, epoch: 7 | loss: 0.0003604
	speed: 0.0417s/iter; left time: 1603.0374s
Epoch: 7 cost time: 17.380849361419678
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0010579
	speed: 0.1154s/iter; left time: 4420.6239s
	iters: 200, epoch: 8 | loss: 0.0000398
	speed: 0.0401s/iter; left time: 1533.9931s
	iters: 300, epoch: 8 | loss: 0.0080410
	speed: 0.0408s/iter; left time: 1555.1278s
	iters: 400, epoch: 8 | loss: 0.0000109
	speed: 0.0387s/iter; left time: 1470.2295s
Epoch: 8 cost time: 16.83396053314209
Epoch: 8, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0051219
	speed: 0.1113s/iter; left time: 4219.1240s
	iters: 200, epoch: 9 | loss: 0.0005021
	speed: 0.0423s/iter; left time: 1597.6297s
	iters: 300, epoch: 9 | loss: 0.0028116
	speed: 0.0411s/iter; left time: 1548.8742s
	iters: 400, epoch: 9 | loss: 0.4203685
	speed: 0.0415s/iter; left time: 1561.2676s
Epoch: 9 cost time: 17.683760404586792
Epoch: 9, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0009504
	speed: 0.1093s/iter; left time: 4097.9851s
	iters: 200, epoch: 10 | loss: 0.0000558
	speed: 0.0414s/iter; left time: 1546.6762s
	iters: 300, epoch: 10 | loss: 0.0001800
	speed: 0.0454s/iter; left time: 1692.3772s
	iters: 400, epoch: 10 | loss: 0.0001388
	speed: 0.0451s/iter; left time: 1676.8034s
Epoch: 10 cost time: 18.240076065063477
Epoch: 10, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.241 Vali Acc: 0.958 Test Loss: 0.241 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000004
	speed: 0.1088s/iter; left time: 4031.5451s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1581.8799s
	iters: 300, epoch: 11 | loss: 0.0597750
	speed: 0.0438s/iter; left time: 1616.6630s
	iters: 400, epoch: 11 | loss: 0.1831257
	speed: 0.0431s/iter; left time: 1583.1806s
Epoch: 11 cost time: 18.004133224487305
Epoch: 11, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.214 Vali Acc: 0.964 Test Loss: 0.214 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000027
	speed: 0.1207s/iter; left time: 4424.6568s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0430s/iter; left time: 1573.6690s
	iters: 300, epoch: 12 | loss: 0.0543525
	speed: 0.0421s/iter; left time: 1536.3197s
	iters: 400, epoch: 12 | loss: 0.0002211
	speed: 0.0440s/iter; left time: 1600.1302s
Epoch: 12 cost time: 18.476075649261475
Epoch: 12, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.189 Vali Acc: 0.968 Test Loss: 0.189 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000012
	speed: 0.1093s/iter; left time: 3963.1221s
	iters: 200, epoch: 13 | loss: 0.2102134
	speed: 0.0453s/iter; left time: 1637.0597s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 1625.4446s
	iters: 400, epoch: 13 | loss: 0.1004800
	speed: 0.0434s/iter; left time: 1560.1624s
Epoch: 13 cost time: 18.46407985687256
Epoch: 13, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.228 Vali Acc: 0.966 Test Loss: 0.228 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000004
	speed: 0.1116s/iter; left time: 3997.2955s
	iters: 200, epoch: 14 | loss: 0.0000101
	speed: 0.0429s/iter; left time: 1533.0223s
	iters: 300, epoch: 14 | loss: 0.0010404
	speed: 0.0419s/iter; left time: 1494.2743s
	iters: 400, epoch: 14 | loss: 0.0509401
	speed: 0.0467s/iter; left time: 1659.8409s
Epoch: 14 cost time: 18.189635038375854
Epoch: 14, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.181 Vali Acc: 0.973 Test Loss: 0.181 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000325
	speed: 0.1067s/iter; left time: 3780.0949s
	iters: 200, epoch: 15 | loss: 0.0000002
	speed: 0.0343s/iter; left time: 1213.0620s
	iters: 300, epoch: 15 | loss: 0.0000390
	speed: 0.0329s/iter; left time: 1158.3334s
	iters: 400, epoch: 15 | loss: 0.1137171
	speed: 0.0308s/iter; left time: 1083.1145s
Epoch: 15 cost time: 14.083480834960938
Epoch: 15, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.283 Vali Acc: 0.965 Test Loss: 0.283 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0708502
	speed: 0.1023s/iter; left time: 3581.0458s
	iters: 200, epoch: 16 | loss: 0.0001756
	speed: 0.0302s/iter; left time: 1055.4335s
	iters: 300, epoch: 16 | loss: 0.0002902
	speed: 0.0337s/iter; left time: 1171.7097s
	iters: 400, epoch: 16 | loss: 0.0211337
	speed: 0.0325s/iter; left time: 1127.5266s
Epoch: 16 cost time: 13.67064380645752
Epoch: 16, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.183 Vali Acc: 0.974 Test Loss: 0.183 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9786266484765803
model parameter : 117674
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5415839
	speed: 0.0525s/iter; left time: 2162.2750s
	iters: 200, epoch: 1 | loss: 0.4154786
	speed: 0.0312s/iter; left time: 1283.0834s
	iters: 300, epoch: 1 | loss: 0.0506111
	speed: 0.0336s/iter; left time: 1376.8080s
	iters: 400, epoch: 1 | loss: 0.0484897
	speed: 0.0324s/iter; left time: 1326.1387s
Epoch: 1 cost time: 15.471708059310913
Epoch: 1, Steps: 413 | Train Loss: 0.485 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
Validation loss decreased (inf --> -0.954069).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0473823
	speed: 0.1005s/iter; left time: 4099.7212s
	iters: 200, epoch: 2 | loss: 0.0812834
	speed: 0.0341s/iter; left time: 1387.7563s
	iters: 300, epoch: 2 | loss: 0.0821884
	speed: 0.0319s/iter; left time: 1295.3990s
	iters: 400, epoch: 2 | loss: 0.0052954
	speed: 0.0328s/iter; left time: 1328.0227s
Epoch: 2 cost time: 13.816398620605469
Epoch: 2, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.073 Vali Acc: 0.974 Test Loss: 0.073 Test Acc: 0.974
Validation loss decreased (-0.954069 --> -0.974078).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0112835
	speed: 0.1075s/iter; left time: 4341.4689s
	iters: 200, epoch: 3 | loss: 0.0001591
	speed: 0.0402s/iter; left time: 1619.2795s
	iters: 300, epoch: 3 | loss: 0.0095116
	speed: 0.0394s/iter; left time: 1582.7334s
	iters: 400, epoch: 3 | loss: 0.0002962
	speed: 0.0421s/iter; left time: 1688.5104s
Epoch: 3 cost time: 17.15580916404724
Epoch: 3, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.064 Vali Acc: 0.976 Test Loss: 0.064 Test Acc: 0.976
Validation loss decreased (-0.974078 --> -0.976352).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0672726
	speed: 0.1182s/iter; left time: 4724.7043s
	iters: 200, epoch: 4 | loss: 0.0701999
	speed: 0.0415s/iter; left time: 1655.9791s
	iters: 300, epoch: 4 | loss: 0.0038188
	speed: 0.0401s/iter; left time: 1596.0471s
	iters: 400, epoch: 4 | loss: 0.0015736
	speed: 0.0406s/iter; left time: 1609.5350s
Epoch: 4 cost time: 17.237083435058594
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0336992
	speed: 0.1155s/iter; left time: 4566.0065s
	iters: 200, epoch: 5 | loss: 0.0000789
	speed: 0.0414s/iter; left time: 1633.6293s
	iters: 300, epoch: 5 | loss: 0.0208784
	speed: 0.0389s/iter; left time: 1531.0374s
	iters: 400, epoch: 5 | loss: 0.0022596
	speed: 0.0390s/iter; left time: 1532.0668s
Epoch: 5 cost time: 16.914535522460938
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0556292
	speed: 0.1108s/iter; left time: 4336.2412s
	iters: 200, epoch: 6 | loss: 0.0040945
	speed: 0.0423s/iter; left time: 1649.9986s
	iters: 300, epoch: 6 | loss: 0.0008792
	speed: 0.0424s/iter; left time: 1651.8693s
	iters: 400, epoch: 6 | loss: 0.0903856
	speed: 0.0410s/iter; left time: 1591.8958s
Epoch: 6 cost time: 17.53884983062744
Epoch: 6, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0069849
	speed: 0.1111s/iter; left time: 4301.5580s
	iters: 200, epoch: 7 | loss: 0.0032441
	speed: 0.0412s/iter; left time: 1590.1469s
	iters: 300, epoch: 7 | loss: 0.0032247
	speed: 0.0425s/iter; left time: 1639.0384s
	iters: 400, epoch: 7 | loss: 0.0009227
	speed: 0.0412s/iter; left time: 1582.2395s
Epoch: 7 cost time: 17.421278715133667
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976352 --> -0.976807).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0024676
	speed: 0.1146s/iter; left time: 4389.1054s
	iters: 200, epoch: 8 | loss: 0.2777094
	speed: 0.0408s/iter; left time: 1559.9245s
	iters: 300, epoch: 8 | loss: 0.0000186
	speed: 0.0403s/iter; left time: 1536.3325s
	iters: 400, epoch: 8 | loss: 0.0152320
	speed: 0.0419s/iter; left time: 1591.4576s
Epoch: 8 cost time: 17.2964186668396
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0063525
	speed: 0.1203s/iter; left time: 4558.8090s
	iters: 200, epoch: 9 | loss: 0.0000283
	speed: 0.0417s/iter; left time: 1575.8600s
	iters: 300, epoch: 9 | loss: 0.0000198
	speed: 0.0400s/iter; left time: 1506.6695s
	iters: 400, epoch: 9 | loss: 0.0002477
	speed: 0.0341s/iter; left time: 1283.6277s
Epoch: 9 cost time: 16.69513702392578
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000234
	speed: 0.1000s/iter; left time: 3747.6847s
	iters: 200, epoch: 10 | loss: 0.0040266
	speed: 0.0377s/iter; left time: 1410.6632s
	iters: 300, epoch: 10 | loss: 0.0786605
	speed: 0.0382s/iter; left time: 1423.5253s
	iters: 400, epoch: 10 | loss: 0.0002066
	speed: 0.0295s/iter; left time: 1097.6230s
Epoch: 10 cost time: 14.953150510787964
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.239 Vali Acc: 0.956 Test Loss: 0.239 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000034
	speed: 0.1004s/iter; left time: 3722.2351s
	iters: 200, epoch: 11 | loss: 0.0000102
	speed: 0.0279s/iter; left time: 1032.8712s
	iters: 300, epoch: 11 | loss: 0.0000065
	speed: 0.0293s/iter; left time: 1081.7234s
	iters: 400, epoch: 11 | loss: 0.0000005
	speed: 0.0289s/iter; left time: 1061.2080s
Epoch: 11 cost time: 12.375745058059692
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0008803
	speed: 0.0948s/iter; left time: 3473.4494s
	iters: 200, epoch: 12 | loss: 0.0000251
	speed: 0.0299s/iter; left time: 1093.5810s
	iters: 300, epoch: 12 | loss: 0.0000707
	speed: 0.0285s/iter; left time: 1038.0478s
	iters: 400, epoch: 12 | loss: 0.5125575
	speed: 0.0287s/iter; left time: 1044.3261s
Epoch: 12 cost time: 12.406796932220459
Epoch: 12, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000012
	speed: 0.0917s/iter; left time: 3324.3381s
	iters: 200, epoch: 13 | loss: 0.0002230
	speed: 0.0287s/iter; left time: 1036.6471s
	iters: 300, epoch: 13 | loss: 0.0002767
	speed: 0.0282s/iter; left time: 1018.2086s
	iters: 400, epoch: 13 | loss: 0.0000679
	speed: 0.0288s/iter; left time: 1036.4117s
Epoch: 13 cost time: 12.235542297363281
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1005226
	speed: 0.0983s/iter; left time: 3520.6479s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0296s/iter; left time: 1057.7449s
	iters: 300, epoch: 14 | loss: 0.0000033
	speed: 0.0297s/iter; left time: 1059.6595s
	iters: 400, epoch: 14 | loss: 0.0001102
	speed: 0.0281s/iter; left time: 999.2157s
Epoch: 14 cost time: 12.56787371635437
Epoch: 14, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
Validation loss decreased (-0.976807 --> -0.977261).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000010
	speed: 0.0970s/iter; left time: 3434.1817s
	iters: 200, epoch: 15 | loss: 0.0000007
	speed: 0.0332s/iter; left time: 1171.2150s
	iters: 300, epoch: 15 | loss: 0.0004310
	speed: 0.0373s/iter; left time: 1313.8824s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 1297.0615s
Epoch: 15 cost time: 14.551110982894897
Epoch: 15, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000032
	speed: 0.1079s/iter; left time: 3778.8544s
	iters: 200, epoch: 16 | loss: 0.0013618
	speed: 0.0364s/iter; left time: 1271.4056s
	iters: 300, epoch: 16 | loss: 0.0000021
	speed: 0.0367s/iter; left time: 1276.8512s
	iters: 400, epoch: 16 | loss: 0.0002085
	speed: 0.0372s/iter; left time: 1289.5092s
Epoch: 16 cost time: 15.582741498947144
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.977261 --> -0.979535).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000064
	speed: 0.1083s/iter; left time: 3747.3308s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0372s/iter; left time: 1281.8861s
	iters: 300, epoch: 17 | loss: 0.0000011
	speed: 0.0379s/iter; left time: 1303.8833s
	iters: 400, epoch: 17 | loss: 0.0220025
	speed: 0.0371s/iter; left time: 1270.7032s
Epoch: 17 cost time: 15.739264488220215
Epoch: 17, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000003
	speed: 0.1080s/iter; left time: 3691.2836s
	iters: 200, epoch: 18 | loss: 0.2284232
	speed: 0.0365s/iter; left time: 1243.1364s
	iters: 300, epoch: 18 | loss: 0.0001375
	speed: 0.0366s/iter; left time: 1245.3309s
	iters: 400, epoch: 18 | loss: 0.0000047
	speed: 0.0374s/iter; left time: 1266.8606s
Epoch: 18 cost time: 15.710559129714966
Epoch: 18, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1114s/iter; left time: 3762.6591s
	iters: 200, epoch: 19 | loss: 0.5778648
	speed: 0.0369s/iter; left time: 1241.5111s
	iters: 300, epoch: 19 | loss: 0.0366951
	speed: 0.0371s/iter; left time: 1246.7212s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0358s/iter; left time: 1198.5254s
Epoch: 19 cost time: 15.551959991455078
Epoch: 19, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.152 Vali Acc: 0.978 Test Loss: 0.152 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0016999
	speed: 0.1117s/iter; left time: 3725.8010s
	iters: 200, epoch: 20 | loss: 0.0005925
	speed: 0.0359s/iter; left time: 1192.9674s
	iters: 300, epoch: 20 | loss: 0.0944556
	speed: 0.0388s/iter; left time: 1285.0363s
	iters: 400, epoch: 20 | loss: 0.0198824
	speed: 0.0373s/iter; left time: 1232.3879s
Epoch: 20 cost time: 15.729405641555786
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.124 Vali Acc: 0.981 Test Loss: 0.124 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.980899).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000013
	speed: 0.1095s/iter; left time: 3606.4521s
	iters: 200, epoch: 21 | loss: 0.0000007
	speed: 0.0376s/iter; left time: 1234.1092s
	iters: 300, epoch: 21 | loss: 0.4708052
	speed: 0.0371s/iter; left time: 1213.5282s
	iters: 400, epoch: 21 | loss: 0.0004307
	speed: 0.0366s/iter; left time: 1195.8740s
Epoch: 21 cost time: 15.830766439437866
Epoch: 21, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.0996s/iter; left time: 3240.0940s
	iters: 200, epoch: 22 | loss: 0.0000009
	speed: 0.0371s/iter; left time: 1202.4003s
	iters: 300, epoch: 22 | loss: 0.0000004
	speed: 0.0383s/iter; left time: 1239.2319s
	iters: 400, epoch: 22 | loss: 0.0080566
	speed: 0.0301s/iter; left time: 969.8698s
Epoch: 22 cost time: 14.802563190460205
Epoch: 22, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.152 Vali Acc: 0.978 Test Loss: 0.152 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0915s/iter; left time: 2937.7527s
	iters: 200, epoch: 23 | loss: 0.0000019
	speed: 0.0289s/iter; left time: 926.6591s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 895.7658s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 908.2893s
Epoch: 23 cost time: 12.185160160064697
Epoch: 23, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 2887.7485s
	iters: 200, epoch: 24 | loss: 0.0002008
	speed: 0.0270s/iter; left time: 854.5400s
	iters: 300, epoch: 24 | loss: 0.0000122
	speed: 0.0273s/iter; left time: 859.7444s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 853.0278s
Epoch: 24 cost time: 11.643590450286865
Epoch: 24, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000174
	speed: 0.0947s/iter; left time: 2962.3846s
	iters: 200, epoch: 25 | loss: 0.0000063
	speed: 0.0282s/iter; left time: 879.1966s
	iters: 300, epoch: 25 | loss: 0.0005932
	speed: 0.0284s/iter; left time: 884.1141s
	iters: 400, epoch: 25 | loss: 0.0000553
	speed: 0.0287s/iter; left time: 887.9668s
Epoch: 25 cost time: 12.06076169013977
Epoch: 25, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000124
	speed: 0.0964s/iter; left time: 2975.4342s
	iters: 200, epoch: 26 | loss: 0.0000005
	speed: 0.0278s/iter; left time: 856.0535s
	iters: 300, epoch: 26 | loss: 0.0419554
	speed: 0.0289s/iter; left time: 885.0166s
	iters: 400, epoch: 26 | loss: 0.0000040
	speed: 0.0282s/iter; left time: 861.5130s
Epoch: 26 cost time: 12.123754024505615
Epoch: 26, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.245 Vali Acc: 0.969 Test Loss: 0.245 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0004549
	speed: 0.0975s/iter; left time: 2969.9429s
	iters: 200, epoch: 27 | loss: 0.0000001
	speed: 0.0355s/iter; left time: 1077.3645s
	iters: 300, epoch: 27 | loss: 0.4671996
	speed: 0.0364s/iter; left time: 1100.7559s
	iters: 400, epoch: 27 | loss: 0.0128613
	speed: 0.0380s/iter; left time: 1145.8867s
Epoch: 27 cost time: 14.630746126174927
Epoch: 27, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000002
	speed: 0.1059s/iter; left time: 3183.1096s
	iters: 200, epoch: 28 | loss: 0.0000001
	speed: 0.0389s/iter; left time: 1164.5455s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 1103.6894s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 1111.7369s
Epoch: 28 cost time: 15.936547994613647
Epoch: 28, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.160 Vali Acc: 0.979 Test Loss: 0.160 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000022
	speed: 0.1048s/iter; left time: 3106.7130s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0396s/iter; left time: 1170.6281s
	iters: 300, epoch: 29 | loss: 0.0072265
	speed: 0.0397s/iter; left time: 1167.9687s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 1127.2256s
Epoch: 29 cost time: 16.30111026763916
Epoch: 29, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0024212
	speed: 0.1054s/iter; left time: 3080.5584s
	iters: 200, epoch: 30 | loss: 0.0000007
	speed: 0.0378s/iter; left time: 1102.3063s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 1081.5860s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1130.8577s
Epoch: 30 cost time: 16.08662986755371
Epoch: 30, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.338 Vali Acc: 0.966 Test Loss: 0.338 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 101194
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5809547
	speed: 0.0553s/iter; left time: 2279.9505s
	iters: 200, epoch: 1 | loss: 0.2109376
	speed: 0.0373s/iter; left time: 1532.1709s
	iters: 300, epoch: 1 | loss: 0.1871074
	speed: 0.0381s/iter; left time: 1562.2257s
	iters: 400, epoch: 1 | loss: 0.0382945
	speed: 0.0375s/iter; left time: 1533.8228s
Epoch: 1 cost time: 17.334635019302368
Epoch: 1, Steps: 413 | Train Loss: 0.536 Vali Loss: 0.118 Vali Acc: 0.955 Test Loss: 0.118 Test Acc: 0.955
Validation loss decreased (inf --> -0.954978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1426219
	speed: 0.0979s/iter; left time: 3992.5779s
	iters: 200, epoch: 2 | loss: 0.0320819
	speed: 0.0373s/iter; left time: 1516.0436s
	iters: 300, epoch: 2 | loss: 0.2537635
	speed: 0.0372s/iter; left time: 1507.9375s
	iters: 400, epoch: 2 | loss: 0.0150846
	speed: 0.0377s/iter; left time: 1525.7861s
Epoch: 2 cost time: 15.72637939453125
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.954978 --> -0.977716).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0303990
	speed: 0.1074s/iter; left time: 4337.8548s
	iters: 200, epoch: 3 | loss: 0.0755160
	speed: 0.0381s/iter; left time: 1532.9047s
	iters: 300, epoch: 3 | loss: 0.0043273
	speed: 0.0367s/iter; left time: 1475.2443s
	iters: 400, epoch: 3 | loss: 0.0509980
	speed: 0.0362s/iter; left time: 1451.9695s
Epoch: 3 cost time: 15.694207668304443
Epoch: 3, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.117 Vali Acc: 0.961 Test Loss: 0.117 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0117469
	speed: 0.1014s/iter; left time: 4052.5292s
	iters: 200, epoch: 4 | loss: 0.0660648
	speed: 0.0277s/iter; left time: 1105.9462s
	iters: 300, epoch: 4 | loss: 0.0310713
	speed: 0.0293s/iter; left time: 1166.7723s
	iters: 400, epoch: 4 | loss: 0.0771141
	speed: 0.0310s/iter; left time: 1231.2597s
Epoch: 4 cost time: 12.74518632888794
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0024686
	speed: 0.0958s/iter; left time: 3789.8833s
	iters: 200, epoch: 5 | loss: 0.0002104
	speed: 0.0301s/iter; left time: 1187.7044s
	iters: 300, epoch: 5 | loss: 0.0060560
	speed: 0.0293s/iter; left time: 1151.2759s
	iters: 400, epoch: 5 | loss: 0.0033223
	speed: 0.0283s/iter; left time: 1109.2066s
Epoch: 5 cost time: 12.375418186187744
Epoch: 5, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0035069
	speed: 0.0965s/iter; left time: 3777.0235s
	iters: 200, epoch: 6 | loss: 0.0000512
	speed: 0.0272s/iter; left time: 1063.1111s
	iters: 300, epoch: 6 | loss: 0.0782696
	speed: 0.0272s/iter; left time: 1059.7037s
	iters: 400, epoch: 6 | loss: 0.0481213
	speed: 0.0289s/iter; left time: 1123.3994s
Epoch: 6 cost time: 11.93502402305603
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000116
	speed: 0.0931s/iter; left time: 3603.5384s
	iters: 200, epoch: 7 | loss: 0.3816268
	speed: 0.0296s/iter; left time: 1143.1747s
	iters: 300, epoch: 7 | loss: 0.0007899
	speed: 0.0270s/iter; left time: 1041.6743s
	iters: 400, epoch: 7 | loss: 0.0011656
	speed: 0.0291s/iter; left time: 1116.9752s
Epoch: 7 cost time: 12.262523651123047
Epoch: 7, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000163
	speed: 0.0938s/iter; left time: 3593.3989s
	iters: 200, epoch: 8 | loss: 0.0000488
	speed: 0.0282s/iter; left time: 1079.4172s
	iters: 300, epoch: 8 | loss: 0.0004018
	speed: 0.0288s/iter; left time: 1097.4247s
	iters: 400, epoch: 8 | loss: 0.0004150
	speed: 0.0292s/iter; left time: 1108.6075s
Epoch: 8 cost time: 12.377485752105713
Epoch: 8, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.176 Vali Acc: 0.965 Test Loss: 0.176 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0023175
	speed: 0.0955s/iter; left time: 3618.2395s
	iters: 200, epoch: 9 | loss: 0.0011799
	speed: 0.0336s/iter; left time: 1269.0684s
	iters: 300, epoch: 9 | loss: 0.0000162
	speed: 0.0354s/iter; left time: 1335.8516s
	iters: 400, epoch: 9 | loss: 0.0004741
	speed: 0.0356s/iter; left time: 1339.2790s
Epoch: 9 cost time: 14.644536256790161
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0101852
	speed: 0.1020s/iter; left time: 3823.9796s
	iters: 200, epoch: 10 | loss: 0.0055374
	speed: 0.0368s/iter; left time: 1376.0443s
	iters: 300, epoch: 10 | loss: 0.0035871
	speed: 0.0356s/iter; left time: 1327.2231s
	iters: 400, epoch: 10 | loss: 0.0000103
	speed: 0.0356s/iter; left time: 1322.4753s
Epoch: 10 cost time: 15.221242427825928
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000076
	speed: 0.1034s/iter; left time: 3833.9947s
	iters: 200, epoch: 11 | loss: 0.0014853
	speed: 0.0363s/iter; left time: 1343.1872s
	iters: 300, epoch: 11 | loss: 0.0037701
	speed: 0.0366s/iter; left time: 1350.2062s
	iters: 400, epoch: 11 | loss: 0.0007856
	speed: 0.0367s/iter; left time: 1349.3713s
Epoch: 11 cost time: 15.329077005386353
Epoch: 11, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0532058
	speed: 0.1092s/iter; left time: 4002.1948s
	iters: 200, epoch: 12 | loss: 0.0036925
	speed: 0.0399s/iter; left time: 1456.9830s
	iters: 300, epoch: 12 | loss: 0.0000644
	speed: 0.0387s/iter; left time: 1409.4440s
	iters: 400, epoch: 12 | loss: 0.0011826
	speed: 0.0390s/iter; left time: 1416.5903s
Epoch: 12 cost time: 16.71454644203186
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 93034
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0442237
	speed: 0.0632s/iter; left time: 2602.9244s
	iters: 200, epoch: 1 | loss: 0.0126641
	speed: 0.0492s/iter; left time: 2023.4382s
	iters: 300, epoch: 1 | loss: 0.1822333
	speed: 0.0506s/iter; left time: 2075.5065s
	iters: 400, epoch: 1 | loss: 0.4436717
	speed: 0.0516s/iter; left time: 2110.6139s
Epoch: 1 cost time: 22.133788585662842
Epoch: 1, Steps: 413 | Train Loss: 0.376 Vali Loss: 0.201 Vali Acc: 0.945 Test Loss: 0.201 Test Acc: 0.945
Validation loss decreased (inf --> -0.945428).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0435609
	speed: 0.1287s/iter; left time: 5247.5148s
	iters: 200, epoch: 2 | loss: 0.1721216
	speed: 0.0525s/iter; left time: 2138.0875s
	iters: 300, epoch: 2 | loss: 0.0007410
	speed: 0.0502s/iter; left time: 2039.1867s
	iters: 400, epoch: 2 | loss: 0.5056831
	speed: 0.0484s/iter; left time: 1958.5572s
Epoch: 2 cost time: 21.09730863571167
Epoch: 2, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.165 Vali Acc: 0.965 Test Loss: 0.165 Test Acc: 0.965
Validation loss decreased (-0.945428 --> -0.964528).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000490
	speed: 0.1261s/iter; left time: 5091.9098s
	iters: 200, epoch: 3 | loss: 0.0000004
	speed: 0.0483s/iter; left time: 1946.1653s
	iters: 300, epoch: 3 | loss: 0.0000111
	speed: 0.0512s/iter; left time: 2055.2163s
	iters: 400, epoch: 3 | loss: 0.0016491
	speed: 0.0508s/iter; left time: 2036.9037s
Epoch: 3 cost time: 20.722913026809692
Epoch: 3, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.398 Vali Acc: 0.944 Test Loss: 0.398 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0001670
	speed: 0.1105s/iter; left time: 4414.2750s
	iters: 200, epoch: 4 | loss: 0.0000760
	speed: 0.0413s/iter; left time: 1645.1431s
	iters: 300, epoch: 4 | loss: 0.5655285
	speed: 0.0396s/iter; left time: 1572.9765s
	iters: 400, epoch: 4 | loss: 0.0120266
	speed: 0.0369s/iter; left time: 1463.2486s
Epoch: 4 cost time: 16.739647388458252
Epoch: 4, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.226 Vali Acc: 0.962 Test Loss: 0.226 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1590195
	speed: 0.1076s/iter; left time: 4256.4978s
	iters: 200, epoch: 5 | loss: 0.0000049
	speed: 0.0375s/iter; left time: 1477.8876s
	iters: 300, epoch: 5 | loss: 0.0071631
	speed: 0.0384s/iter; left time: 1511.5971s
	iters: 400, epoch: 5 | loss: 0.0001971
	speed: 0.0397s/iter; left time: 1559.2115s
Epoch: 5 cost time: 16.294955015182495
Epoch: 5, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.382 Vali Acc: 0.953 Test Loss: 0.382 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0004933
	speed: 0.1034s/iter; left time: 4046.6557s
	iters: 200, epoch: 6 | loss: 0.0879944
	speed: 0.0394s/iter; left time: 1538.9885s
	iters: 300, epoch: 6 | loss: 0.2600368
	speed: 0.0391s/iter; left time: 1521.0053s
	iters: 400, epoch: 6 | loss: 0.0000001
	speed: 0.0371s/iter; left time: 1439.0628s
Epoch: 6 cost time: 15.59505033493042
Epoch: 6, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.316 Vali Acc: 0.962 Test Loss: 0.316 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000011
	speed: 0.1100s/iter; left time: 4259.4282s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 1417.7210s
	iters: 300, epoch: 7 | loss: 0.1451784
	speed: 0.0375s/iter; left time: 1445.6180s
	iters: 400, epoch: 7 | loss: 0.0357447
	speed: 0.0395s/iter; left time: 1516.1889s
Epoch: 7 cost time: 16.037657499313354
Epoch: 7, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.219 Vali Acc: 0.964 Test Loss: 0.219 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1143s/iter; left time: 4377.7498s
	iters: 200, epoch: 8 | loss: 0.5975772
	speed: 0.0399s/iter; left time: 1522.7312s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 1403.3496s
	iters: 400, epoch: 8 | loss: 0.0000014
	speed: 0.0379s/iter; left time: 1440.2004s
Epoch: 8 cost time: 16.316636085510254
Epoch: 8, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.347 Vali Acc: 0.965 Test Loss: 0.347 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000152
	speed: 0.1203s/iter; left time: 4558.8710s
	iters: 200, epoch: 9 | loss: 0.0000002
	speed: 0.0433s/iter; left time: 1637.1480s
	iters: 300, epoch: 9 | loss: 0.0145005
	speed: 0.0459s/iter; left time: 1729.4499s
	iters: 400, epoch: 9 | loss: 0.0144874
	speed: 0.0471s/iter; left time: 1769.2342s
Epoch: 9 cost time: 18.91661024093628
Epoch: 9, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.459 Vali Acc: 0.956 Test Loss: 0.459 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000017
	speed: 0.1271s/iter; left time: 4764.5214s
	iters: 200, epoch: 10 | loss: 0.0000006
	speed: 0.0486s/iter; left time: 1818.0173s
	iters: 300, epoch: 10 | loss: 0.0000095
	speed: 0.0466s/iter; left time: 1735.7747s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 1678.0599s
Epoch: 10 cost time: 19.77590250968933
Epoch: 10, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.478 Vali Acc: 0.959 Test Loss: 0.478 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1244s/iter; left time: 4610.4262s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 1695.2786s
	iters: 300, epoch: 11 | loss: 0.7664332
	speed: 0.0488s/iter; left time: 1798.8604s
	iters: 400, epoch: 11 | loss: 0.0000122
	speed: 0.0469s/iter; left time: 1725.8433s
Epoch: 11 cost time: 19.805574893951416
Epoch: 11, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.321 Vali Acc: 0.971 Test Loss: 0.321 Test Acc: 0.971
Validation loss decreased (-0.964528 --> -0.971347).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1259s/iter; left time: 4615.1644s
	iters: 200, epoch: 12 | loss: 0.0000022
	speed: 0.0480s/iter; left time: 1754.3858s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 1711.1322s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 1849.9117s
Epoch: 12 cost time: 20.510387659072876
Epoch: 12, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.282 Vali Acc: 0.971 Test Loss: 0.282 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000043
	speed: 0.1233s/iter; left time: 4467.6622s
	iters: 200, epoch: 13 | loss: 0.0002049
	speed: 0.0493s/iter; left time: 1781.4970s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0479s/iter; left time: 1727.4594s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1742.7622s
Epoch: 13 cost time: 20.28348183631897
Epoch: 13, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.446 Vali Acc: 0.962 Test Loss: 0.446 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7782948
	speed: 0.1276s/iter; left time: 4573.8022s
	iters: 200, epoch: 14 | loss: 0.1375983
	speed: 0.0503s/iter; left time: 1795.5488s
	iters: 300, epoch: 14 | loss: 0.0000005
	speed: 0.0515s/iter; left time: 1836.3126s
	iters: 400, epoch: 14 | loss: 0.0019652
	speed: 0.0503s/iter; left time: 1788.4751s
Epoch: 14 cost time: 21.21578025817871
Epoch: 14, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.404 Vali Acc: 0.968 Test Loss: 0.404 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.5519939
	speed: 0.1336s/iter; left time: 4731.3775s
	iters: 200, epoch: 15 | loss: 0.0244722
	speed: 0.0502s/iter; left time: 1772.3902s
	iters: 300, epoch: 15 | loss: 0.5403106
	speed: 0.0495s/iter; left time: 1741.9795s
	iters: 400, epoch: 15 | loss: 0.0000025
	speed: 0.0506s/iter; left time: 1778.2901s
Epoch: 15 cost time: 21.214213848114014
Epoch: 15, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.441 Vali Acc: 0.967 Test Loss: 0.441 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0358696
	speed: 0.1278s/iter; left time: 4475.2935s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 1250.7360s
	iters: 300, epoch: 16 | loss: 0.0000081
	speed: 0.0403s/iter; left time: 1403.7752s
	iters: 400, epoch: 16 | loss: 0.0000014
	speed: 0.0372s/iter; left time: 1289.4454s
Epoch: 16 cost time: 17.049079656600952
Epoch: 16, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.368 Vali Acc: 0.974 Test Loss: 0.368 Test Acc: 0.974
Validation loss decreased (-0.971347 --> -0.973621).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1142s/iter; left time: 3950.3964s
	iters: 200, epoch: 17 | loss: 0.5361286
	speed: 0.0346s/iter; left time: 1192.0998s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 1309.2911s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 1302.2108s
Epoch: 17 cost time: 15.622498989105225
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.496 Vali Acc: 0.970 Test Loss: 0.496 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1099s/iter; left time: 3756.0380s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 1285.1414s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 1216.4885s
	iters: 400, epoch: 18 | loss: 0.0000247
	speed: 0.0327s/iter; left time: 1109.2709s
Epoch: 18 cost time: 15.369018316268921
Epoch: 18, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.362 Vali Acc: 0.973 Test Loss: 0.362 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1115s/iter; left time: 3765.0001s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 1260.8313s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 1284.1734s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 1240.9422s
Epoch: 19 cost time: 15.722307682037354
Epoch: 19, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.428 Vali Acc: 0.970 Test Loss: 0.428 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1130s/iter; left time: 3770.1382s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0347s/iter; left time: 1153.2477s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 1160.8904s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 1218.5050s
Epoch: 20 cost time: 15.108113050460815
Epoch: 20, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.627 Vali Acc: 0.970 Test Loss: 0.627 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0030552
	speed: 0.1184s/iter; left time: 3900.2077s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1591.4460s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 1534.6174s
	iters: 400, epoch: 21 | loss: 0.8657059
	speed: 0.0470s/iter; left time: 1533.1121s
Epoch: 21 cost time: 19.927818298339844
Epoch: 21, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.485 Vali Acc: 0.966 Test Loss: 0.485 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1260s/iter; left time: 4097.4767s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 1521.1467s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 1544.4042s
	iters: 400, epoch: 22 | loss: 0.0075130
	speed: 0.0478s/iter; left time: 1540.7048s
Epoch: 22 cost time: 20.06240940093994
Epoch: 22, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.493 Vali Acc: 0.968 Test Loss: 0.493 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000212
	speed: 0.1262s/iter; left time: 4052.5617s
	iters: 200, epoch: 23 | loss: 0.6697969
	speed: 0.0433s/iter; left time: 1385.6704s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 1409.8869s
	iters: 400, epoch: 23 | loss: 0.0000052
	speed: 0.0468s/iter; left time: 1489.2039s
Epoch: 23 cost time: 19.19286274909973
Epoch: 23, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.482 Vali Acc: 0.971 Test Loss: 0.482 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000015
	speed: 0.1252s/iter; left time: 3967.6086s
	iters: 200, epoch: 24 | loss: 0.0000027
	speed: 0.0481s/iter; left time: 1520.1299s
	iters: 300, epoch: 24 | loss: 0.0360958
	speed: 0.0480s/iter; left time: 1512.3320s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0475s/iter; left time: 1491.0116s
Epoch: 24 cost time: 20.150108337402344
Epoch: 24, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.758 Vali Acc: 0.955 Test Loss: 0.758 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000012
	speed: 0.1286s/iter; left time: 4023.0118s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1513.1031s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1508.8140s
	iters: 400, epoch: 25 | loss: 0.0000008
	speed: 0.0503s/iter; left time: 1558.2449s
Epoch: 25 cost time: 20.753285884857178
Epoch: 25, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.755 Vali Acc: 0.961 Test Loss: 0.755 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0001715
	speed: 0.1277s/iter; left time: 3944.0154s
	iters: 200, epoch: 26 | loss: 0.0001419
	speed: 0.0494s/iter; left time: 1520.1535s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 1454.2203s
	iters: 400, epoch: 26 | loss: 0.3594690
	speed: 0.0451s/iter; left time: 1378.0879s
Epoch: 26 cost time: 20.095438718795776
Epoch: 26, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.471 Vali Acc: 0.970 Test Loss: 0.471 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9736243747157799
model parameter : 233802
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4594371
	speed: 0.0983s/iter; left time: 4050.1873s
	iters: 200, epoch: 1 | loss: 0.0333929
	speed: 0.0850s/iter; left time: 3494.6035s
	iters: 300, epoch: 1 | loss: 0.0470143
	speed: 0.0500s/iter; left time: 2048.1334s
	iters: 400, epoch: 1 | loss: 0.0205877
	speed: 0.0515s/iter; left time: 2107.8170s
Epoch: 1 cost time: 29.104209423065186
Epoch: 1, Steps: 413 | Train Loss: 0.348 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
Validation loss decreased (inf --> -0.954069).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0758941
	speed: 0.1289s/iter; left time: 5257.3352s
	iters: 200, epoch: 2 | loss: 0.2149238
	speed: 0.0413s/iter; left time: 1681.3927s
	iters: 300, epoch: 2 | loss: 0.0011070
	speed: 0.0491s/iter; left time: 1990.9527s
	iters: 400, epoch: 2 | loss: 0.0048933
	speed: 0.0555s/iter; left time: 2248.8208s
Epoch: 2 cost time: 21.194475173950195
Epoch: 2, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.147 Vali Acc: 0.956 Test Loss: 0.147 Test Acc: 0.956
Validation loss decreased (-0.954069 --> -0.956342).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5337086
	speed: 0.1142s/iter; left time: 4608.8504s
	iters: 200, epoch: 3 | loss: 0.0073922
	speed: 0.0497s/iter; left time: 2003.1238s
	iters: 300, epoch: 3 | loss: 0.0171351
	speed: 0.0612s/iter; left time: 2456.8059s
	iters: 400, epoch: 3 | loss: 0.3116129
	speed: 0.0505s/iter; left time: 2022.7578s
Epoch: 3 cost time: 21.11839771270752
Epoch: 3, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
Validation loss decreased (-0.956342 --> -0.969075).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1023656
	speed: 0.1237s/iter; left time: 4942.1758s
	iters: 200, epoch: 4 | loss: 0.0002264
	speed: 0.0579s/iter; left time: 2308.6506s
	iters: 300, epoch: 4 | loss: 0.0017351
	speed: 0.0387s/iter; left time: 1536.9062s
	iters: 400, epoch: 4 | loss: 0.0000207
	speed: 0.0341s/iter; left time: 1352.6238s
Epoch: 4 cost time: 18.85654592514038
Epoch: 4, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0017461
	speed: 0.1569s/iter; left time: 6204.6070s
	iters: 200, epoch: 5 | loss: 0.2531546
	speed: 0.0815s/iter; left time: 3215.1653s
	iters: 300, epoch: 5 | loss: 0.0025208
	speed: 0.0796s/iter; left time: 3132.8654s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0816s/iter; left time: 3203.9319s
Epoch: 5 cost time: 33.73337483406067
Epoch: 5, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.230 Vali Acc: 0.961 Test Loss: 0.230 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0022685
	speed: 0.1630s/iter; left time: 6377.8690s
	iters: 200, epoch: 6 | loss: 0.0072912
	speed: 0.0816s/iter; left time: 3186.5608s
	iters: 300, epoch: 6 | loss: 0.0000033
	speed: 0.0790s/iter; left time: 3074.5479s
	iters: 400, epoch: 6 | loss: 0.0000116
	speed: 0.0815s/iter; left time: 3166.5732s
Epoch: 6 cost time: 33.48033857345581
Epoch: 6, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.326 Vali Acc: 0.953 Test Loss: 0.326 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0091157
	speed: 0.1651s/iter; left time: 6391.6671s
	iters: 200, epoch: 7 | loss: 0.0045278
	speed: 0.0768s/iter; left time: 2968.0005s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0739s/iter; left time: 2846.8194s
	iters: 400, epoch: 7 | loss: 0.0000015
	speed: 0.0716s/iter; left time: 2751.3039s
Epoch: 7 cost time: 31.870685577392578
Epoch: 7, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.342 Vali Acc: 0.959 Test Loss: 0.342 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.5434012
	speed: 0.1593s/iter; left time: 6103.0787s
	iters: 200, epoch: 8 | loss: 0.0904357
	speed: 0.0847s/iter; left time: 3236.3874s
	iters: 300, epoch: 8 | loss: 0.0033249
	speed: 0.0816s/iter; left time: 3108.6872s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0837s/iter; left time: 3181.9879s
Epoch: 8 cost time: 34.387145042419434
Epoch: 8, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.410 Vali Acc: 0.958 Test Loss: 0.410 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0005803
	speed: 0.1230s/iter; left time: 4660.4960s
	iters: 200, epoch: 9 | loss: 0.0566658
	speed: 0.0464s/iter; left time: 1754.0147s
	iters: 300, epoch: 9 | loss: 0.0135824
	speed: 0.0517s/iter; left time: 1947.9416s
	iters: 400, epoch: 9 | loss: 0.0000002
	speed: 0.0466s/iter; left time: 1753.6089s
Epoch: 9 cost time: 20.26099944114685
Epoch: 9, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.304 Vali Acc: 0.969 Test Loss: 0.304 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000048
	speed: 0.1134s/iter; left time: 4251.3679s
	iters: 200, epoch: 10 | loss: 0.1207887
	speed: 0.0469s/iter; left time: 1752.9145s
	iters: 300, epoch: 10 | loss: 0.0004123
	speed: 0.0456s/iter; left time: 1701.8476s
	iters: 400, epoch: 10 | loss: 0.0001532
	speed: 0.0391s/iter; left time: 1455.4359s
Epoch: 10 cost time: 18.167593002319336
Epoch: 10, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.254 Vali Acc: 0.970 Test Loss: 0.254 Test Acc: 0.970
Validation loss decreased (-0.969075 --> -0.970439).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000012
	speed: 0.1226s/iter; left time: 4546.6194s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 1765.1843s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0411s/iter; left time: 1516.8301s
	iters: 400, epoch: 11 | loss: 0.0000180
	speed: 0.0428s/iter; left time: 1573.0502s
Epoch: 11 cost time: 18.822919130325317
Epoch: 11, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.346 Vali Acc: 0.965 Test Loss: 0.346 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0001675
	speed: 0.1246s/iter; left time: 4568.1631s
	iters: 200, epoch: 12 | loss: 0.0000024
	speed: 0.0397s/iter; left time: 1451.0876s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0526s/iter; left time: 1918.5336s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0832s/iter; left time: 3024.8464s
Epoch: 12 cost time: 24.204731225967407
Epoch: 12, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.333 Vali Acc: 0.973 Test Loss: 0.333 Test Acc: 0.973
Validation loss decreased (-0.970439 --> -0.973166).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000008
	speed: 0.1607s/iter; left time: 5824.3474s
	iters: 200, epoch: 13 | loss: 0.0001147
	speed: 0.0814s/iter; left time: 2941.4817s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0810s/iter; left time: 2918.2336s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0837s/iter; left time: 3007.5053s
Epoch: 13 cost time: 34.27963161468506
Epoch: 13, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.426 Vali Acc: 0.963 Test Loss: 0.426 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1598s/iter; left time: 5725.7171s
	iters: 200, epoch: 14 | loss: 1.9376857
	speed: 0.0749s/iter; left time: 2674.9155s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0833s/iter; left time: 2967.9216s
	iters: 400, epoch: 14 | loss: 0.1297286
	speed: 0.0827s/iter; left time: 2937.0733s
Epoch: 14 cost time: 33.58228015899658
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.354 Vali Acc: 0.969 Test Loss: 0.354 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1640s/iter; left time: 5806.9793s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0870s/iter; left time: 3073.3471s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0842s/iter; left time: 2963.7005s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0735s/iter; left time: 2580.0860s
Epoch: 15 cost time: 34.1225426197052
Epoch: 15, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.458 Vali Acc: 0.962 Test Loss: 0.458 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0004184
	speed: 0.1654s/iter; left time: 5789.7085s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0845s/iter; left time: 2950.0572s
	iters: 300, epoch: 16 | loss: 0.0000004
	speed: 0.0845s/iter; left time: 2940.2483s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 1532.2339s
Epoch: 16 cost time: 30.494407415390015
Epoch: 16, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.400 Vali Acc: 0.969 Test Loss: 0.400 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1175s/iter; left time: 4063.3851s
	iters: 200, epoch: 17 | loss: 0.0000015
	speed: 0.0484s/iter; left time: 1669.3431s
	iters: 300, epoch: 17 | loss: 0.0000004
	speed: 0.0456s/iter; left time: 1567.8671s
	iters: 400, epoch: 17 | loss: 0.0001005
	speed: 0.0393s/iter; left time: 1348.1214s
Epoch: 17 cost time: 18.011523723602295
Epoch: 17, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.317 Vali Acc: 0.972 Test Loss: 0.317 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0672763
	speed: 0.1304s/iter; left time: 4456.7080s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0539s/iter; left time: 1835.3023s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0345s/iter; left time: 1173.2880s
	iters: 400, epoch: 18 | loss: 0.0000002
	speed: 0.0511s/iter; left time: 1729.6857s
Epoch: 18 cost time: 20.114356756210327
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.333 Vali Acc: 0.975 Test Loss: 0.333 Test Acc: 0.975
Validation loss decreased (-0.973166 --> -0.975440).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000285
	speed: 0.1273s/iter; left time: 4299.1655s
	iters: 200, epoch: 19 | loss: 0.0007809
	speed: 0.0362s/iter; left time: 1219.5454s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1535.8454s
	iters: 400, epoch: 19 | loss: 0.0000382
	speed: 0.0482s/iter; left time: 1614.5146s
Epoch: 19 cost time: 19.312474966049194
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.442 Vali Acc: 0.970 Test Loss: 0.442 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.3636060
	speed: 0.1070s/iter; left time: 3567.6022s
	iters: 200, epoch: 20 | loss: 0.0000444
	speed: 0.0820s/iter; left time: 2727.0689s
	iters: 300, epoch: 20 | loss: 0.0000007
	speed: 0.0866s/iter; left time: 2872.5034s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0838s/iter; left time: 2768.8134s
Epoch: 20 cost time: 30.175838708877563
Epoch: 20, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.417 Vali Acc: 0.973 Test Loss: 0.417 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0003575
	speed: 0.1693s/iter; left time: 5577.3127s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0882s/iter; left time: 2897.3917s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0809s/iter; left time: 2648.2661s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0854s/iter; left time: 2788.3518s
Epoch: 21 cost time: 35.610509395599365
Epoch: 21, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.324 Vali Acc: 0.973 Test Loss: 0.324 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1649s/iter; left time: 5362.7711s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0824s/iter; left time: 2672.0801s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0799s/iter; left time: 2582.7851s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0774s/iter; left time: 2493.8105s
Epoch: 22 cost time: 33.892425537109375
Epoch: 22, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.309 Vali Acc: 0.973 Test Loss: 0.309 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1659s/iter; left time: 5329.1745s
	iters: 200, epoch: 23 | loss: 0.1805079
	speed: 0.0803s/iter; left time: 2570.1870s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.0780s/iter; left time: 2488.8386s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0812s/iter; left time: 2582.3925s
Epoch: 23 cost time: 33.76745796203613
Epoch: 23, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.352 Vali Acc: 0.971 Test Loss: 0.352 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000704
	speed: 0.1602s/iter; left time: 5077.3320s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0783s/iter; left time: 2475.3956s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 1221.0840s
	iters: 400, epoch: 24 | loss: 0.0000001
	speed: 0.0373s/iter; left time: 1169.7796s
Epoch: 24 cost time: 24.06107234954834
Epoch: 24, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.368 Vali Acc: 0.973 Test Loss: 0.368 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0002893
	speed: 0.1017s/iter; left time: 3181.4345s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 1183.6863s
	iters: 300, epoch: 25 | loss: 0.0000026
	speed: 0.0432s/iter; left time: 1341.7841s
	iters: 400, epoch: 25 | loss: 0.0075236
	speed: 0.0338s/iter; left time: 1048.0359s
Epoch: 25 cost time: 15.768314123153687
Epoch: 25, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.426 Vali Acc: 0.967 Test Loss: 0.426 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000015
	speed: 0.1093s/iter; left time: 3375.0477s
	iters: 200, epoch: 26 | loss: 0.0000014
	speed: 0.0418s/iter; left time: 1287.4645s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 1601.9686s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 1541.1596s
Epoch: 26 cost time: 19.65816640853882
Epoch: 26, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.358 Vali Acc: 0.979 Test Loss: 0.358 Test Acc: 0.979
Validation loss decreased (-0.975440 --> -0.978623).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1205s/iter; left time: 3670.9698s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 1252.6550s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 1364.7729s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1528.1203s
Epoch: 27 cost time: 19.593909978866577
Epoch: 27, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1593s/iter; left time: 4787.5112s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0848s/iter; left time: 2538.8064s
	iters: 300, epoch: 28 | loss: 0.0000001
	speed: 0.0847s/iter; left time: 2527.0607s
	iters: 400, epoch: 28 | loss: 0.0001282
	speed: 0.0819s/iter; left time: 2436.1272s
Epoch: 28 cost time: 35.15146207809448
Epoch: 28, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.369 Vali Acc: 0.971 Test Loss: 0.369 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1613s/iter; left time: 4780.3865s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0793s/iter; left time: 2343.0584s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0895s/iter; left time: 2634.4699s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0897s/iter; left time: 2632.4941s
Epoch: 29 cost time: 35.632649660110474
Epoch: 29, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.351 Vali Acc: 0.978 Test Loss: 0.351 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1737s/iter; left time: 5076.3227s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0897s/iter; left time: 2612.6004s
	iters: 300, epoch: 30 | loss: 0.0002555
	speed: 0.0961s/iter; left time: 2788.8504s
	iters: 400, epoch: 30 | loss: 0.1295055
	speed: 0.0905s/iter; left time: 2617.2158s
Epoch: 30 cost time: 38.506165742874146
Epoch: 30, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.532 Vali Acc: 0.971 Test Loss: 0.532 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1743s/iter; left time: 5020.6693s
	iters: 200, epoch: 31 | loss: 0.0098037
	speed: 0.0962s/iter; left time: 2762.5947s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0912s/iter; left time: 2608.0390s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0964s/iter; left time: 2748.0581s
Epoch: 31 cost time: 39.01365780830383
Epoch: 31, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.564 Vali Acc: 0.968 Test Loss: 0.564 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1778s/iter; left time: 5050.4105s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 1239.5825s
	iters: 300, epoch: 32 | loss: 0.0000005
	speed: 0.0459s/iter; left time: 1294.1527s
	iters: 400, epoch: 32 | loss: 0.0000005
	speed: 0.0620s/iter; left time: 1742.1573s
Epoch: 32 cost time: 25.568461656570435
Epoch: 32, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.424 Vali Acc: 0.970 Test Loss: 0.424 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0016342
	speed: 0.1386s/iter; left time: 3879.9015s
	iters: 200, epoch: 33 | loss: 0.0000012
	speed: 0.0483s/iter; left time: 1347.2037s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0447s/iter; left time: 1240.9321s
	iters: 400, epoch: 33 | loss: 0.0000014
	speed: 0.0578s/iter; left time: 1599.0792s
Epoch: 33 cost time: 22.3054416179657
Epoch: 33, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.367 Vali Acc: 0.972 Test Loss: 0.367 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1267s/iter; left time: 3492.4773s
	iters: 200, epoch: 34 | loss: 0.0000002
	speed: 0.0515s/iter; left time: 1415.4964s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 1439.6294s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1289.5390s
Epoch: 34 cost time: 21.16763925552368
Epoch: 34, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.539 Vali Acc: 0.970 Test Loss: 0.539 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0002101
	speed: 0.1252s/iter; left time: 3399.4512s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 1124.1131s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 1548.6298s
	iters: 400, epoch: 35 | loss: 0.0000097
	speed: 0.0619s/iter; left time: 1662.4141s
Epoch: 35 cost time: 22.743976593017578
Epoch: 35, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.447 Vali Acc: 0.970 Test Loss: 0.447 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.1703s/iter; left time: 4553.6344s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 2318.1641s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0912s/iter; left time: 2420.1788s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0927s/iter; left time: 2450.9061s
Epoch: 36 cost time: 37.69605040550232
Epoch: 36, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.402 Vali Acc: 0.974 Test Loss: 0.402 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9786266484765803
model parameter : 167306
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3312373
	speed: 0.1026s/iter; left time: 4225.9508s
	iters: 200, epoch: 1 | loss: 0.2832187
	speed: 0.0857s/iter; left time: 3522.0926s
	iters: 300, epoch: 1 | loss: 0.3130706
	speed: 0.0783s/iter; left time: 3209.9748s
	iters: 400, epoch: 1 | loss: 0.0112576
	speed: 0.0836s/iter; left time: 3420.4897s
Epoch: 1 cost time: 36.15699791908264
Epoch: 1, Steps: 413 | Train Loss: 0.393 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
Validation loss decreased (inf --> -0.950431).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0016650
	speed: 0.1580s/iter; left time: 6443.5925s
	iters: 200, epoch: 2 | loss: 0.2803301
	speed: 0.0822s/iter; left time: 3344.5523s
	iters: 300, epoch: 2 | loss: 0.0040411
	speed: 0.0727s/iter; left time: 2951.4385s
	iters: 400, epoch: 2 | loss: 0.1176741
	speed: 0.0725s/iter; left time: 2934.1896s
Epoch: 2 cost time: 32.53722929954529
Epoch: 2, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.259 Vali Acc: 0.946 Test Loss: 0.259 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0009894
	speed: 0.1492s/iter; left time: 6024.3275s
	iters: 200, epoch: 3 | loss: 0.0292245
	speed: 0.0828s/iter; left time: 3333.7111s
	iters: 300, epoch: 3 | loss: 0.0015761
	speed: 0.0797s/iter; left time: 3201.1990s
	iters: 400, epoch: 3 | loss: 0.0034977
	speed: 0.0523s/iter; left time: 2095.1207s
Epoch: 3 cost time: 30.55115056037903
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.950431 --> -0.969985).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0460643
	speed: 0.1020s/iter; left time: 4075.3612s
	iters: 200, epoch: 4 | loss: 0.0000191
	speed: 0.0473s/iter; left time: 1887.2130s
	iters: 300, epoch: 4 | loss: 0.0004573
	speed: 0.0491s/iter; left time: 1951.0684s
	iters: 400, epoch: 4 | loss: 0.0071033
	speed: 0.0383s/iter; left time: 1518.4128s
Epoch: 4 cost time: 17.87791085243225
Epoch: 4, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.154 Vali Acc: 0.974 Test Loss: 0.154 Test Acc: 0.974
Validation loss decreased (-0.969985 --> -0.973623).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000368
	speed: 0.1052s/iter; left time: 4159.7400s
	iters: 200, epoch: 5 | loss: 0.0002987
	speed: 0.0385s/iter; left time: 1520.7021s
	iters: 300, epoch: 5 | loss: 0.0002500
	speed: 0.0392s/iter; left time: 1541.3948s
	iters: 400, epoch: 5 | loss: 0.0001552
	speed: 0.0475s/iter; left time: 1863.8028s
Epoch: 5 cost time: 17.967724084854126
Epoch: 5, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000020
	speed: 0.1049s/iter; left time: 4104.6543s
	iters: 200, epoch: 6 | loss: 0.0000022
	speed: 0.0505s/iter; left time: 1970.4232s
	iters: 300, epoch: 6 | loss: 0.0003322
	speed: 0.0434s/iter; left time: 1690.2721s
	iters: 400, epoch: 6 | loss: 0.0286925
	speed: 0.0404s/iter; left time: 1567.0438s
Epoch: 6 cost time: 18.40510630607605
Epoch: 6, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.198 Vali Acc: 0.971 Test Loss: 0.198 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.0957s/iter; left time: 3705.0856s
	iters: 200, epoch: 7 | loss: 0.0003295
	speed: 0.0503s/iter; left time: 1943.4783s
	iters: 300, epoch: 7 | loss: 0.0005890
	speed: 0.0715s/iter; left time: 2755.3158s
	iters: 400, epoch: 7 | loss: 0.0000151
	speed: 0.0673s/iter; left time: 2586.4820s
Epoch: 7 cost time: 23.849071979522705
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.243 Vali Acc: 0.965 Test Loss: 0.243 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0001337
	speed: 0.1452s/iter; left time: 5560.9495s
	iters: 200, epoch: 8 | loss: 0.1228923
	speed: 0.0800s/iter; left time: 3058.1547s
	iters: 300, epoch: 8 | loss: 0.0005695
	speed: 0.0757s/iter; left time: 2886.6927s
	iters: 400, epoch: 8 | loss: 0.0176985
	speed: 0.0800s/iter; left time: 3040.7218s
Epoch: 8 cost time: 32.45664596557617
Epoch: 8, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.245 Vali Acc: 0.968 Test Loss: 0.245 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000002
	speed: 0.1513s/iter; left time: 5735.3367s
	iters: 200, epoch: 9 | loss: 0.0004761
	speed: 0.0786s/iter; left time: 2972.5682s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2934.2849s
	iters: 400, epoch: 9 | loss: 0.0000169
	speed: 0.0822s/iter; left time: 3090.3206s
Epoch: 9 cost time: 32.87223792076111
Epoch: 9, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.264 Vali Acc: 0.967 Test Loss: 0.264 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0025521
	speed: 0.1518s/iter; left time: 5691.1196s
	iters: 200, epoch: 10 | loss: 0.0004207
	speed: 0.0762s/iter; left time: 2847.8599s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0808s/iter; left time: 3013.2900s
	iters: 400, epoch: 10 | loss: 0.0000006
	speed: 0.0807s/iter; left time: 3001.5486s
Epoch: 10 cost time: 33.46258902549744
Epoch: 10, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.213 Vali Acc: 0.963 Test Loss: 0.213 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000050
	speed: 0.1523s/iter; left time: 5646.7595s
	iters: 200, epoch: 11 | loss: 0.0004717
	speed: 0.0838s/iter; left time: 3097.7452s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0746s/iter; left time: 2749.6750s
	iters: 400, epoch: 11 | loss: 0.0831517
	speed: 0.0515s/iter; left time: 1895.4333s
Epoch: 11 cost time: 30.145915269851685
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.973623 --> -0.975442).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000183
	speed: 0.1130s/iter; left time: 4140.7053s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 2013.3926s
	iters: 300, epoch: 12 | loss: 0.0000019
	speed: 0.0530s/iter; left time: 1931.9943s
	iters: 400, epoch: 12 | loss: 0.0009585
	speed: 0.0383s/iter; left time: 1391.6941s
Epoch: 12 cost time: 20.299450397491455
Epoch: 12, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.168 Vali Acc: 0.978 Test Loss: 0.168 Test Acc: 0.978
Validation loss decreased (-0.975442 --> -0.978170).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0016261
	speed: 0.1002s/iter; left time: 3630.3204s
	iters: 200, epoch: 13 | loss: 0.0000003
	speed: 0.0369s/iter; left time: 1333.2185s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 1695.2422s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 1751.6856s
Epoch: 13 cost time: 17.750138521194458
Epoch: 13, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1155s/iter; left time: 4140.1678s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 1256.4588s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0366s/iter; left time: 1305.8698s
	iters: 400, epoch: 14 | loss: 0.0000055
	speed: 0.0450s/iter; left time: 1598.8255s
Epoch: 14 cost time: 17.191473484039307
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.187 Vali Acc: 0.977 Test Loss: 0.187 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1410s/iter; left time: 4995.6060s
	iters: 200, epoch: 15 | loss: 0.0000002
	speed: 0.0824s/iter; left time: 2908.6585s
	iters: 300, epoch: 15 | loss: 0.0000424
	speed: 0.0797s/iter; left time: 2808.6133s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0805s/iter; left time: 2826.3743s
Epoch: 15 cost time: 33.352458238601685
Epoch: 15, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.155 Vali Acc: 0.978 Test Loss: 0.155 Test Acc: 0.978
Validation loss decreased (-0.978170 --> -0.978170).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1582s/iter; left time: 5536.7448s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 2885.2760s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0832s/iter; left time: 2897.0193s
	iters: 400, epoch: 16 | loss: 0.0000725
	speed: 0.0835s/iter; left time: 2899.6324s
Epoch: 16 cost time: 34.418906927108765
Epoch: 16, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1573s/iter; left time: 5440.5726s
	iters: 200, epoch: 17 | loss: 0.0001512
	speed: 0.0817s/iter; left time: 2819.4429s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0836s/iter; left time: 2876.8382s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0828s/iter; left time: 2840.3589s
Epoch: 17 cost time: 34.5435688495636
Epoch: 17, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.222 Vali Acc: 0.975 Test Loss: 0.222 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000003
	speed: 0.1530s/iter; left time: 5228.4090s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0830s/iter; left time: 2829.1389s
	iters: 300, epoch: 18 | loss: 0.0077459
	speed: 0.0792s/iter; left time: 2690.7760s
	iters: 400, epoch: 18 | loss: 0.1255320
	speed: 0.0825s/iter; left time: 2796.5807s
Epoch: 18 cost time: 33.9752516746521
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.243 Vali Acc: 0.976 Test Loss: 0.243 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0002479
	speed: 0.1574s/iter; left time: 5316.5993s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 1352.1936s
	iters: 300, epoch: 19 | loss: 0.3171958
	speed: 0.0378s/iter; left time: 1269.9622s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 1498.4190s
Epoch: 19 cost time: 21.305429458618164
Epoch: 19, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.304 Vali Acc: 0.972 Test Loss: 0.304 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1088s/iter; left time: 3628.3639s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 1529.3773s
	iters: 300, epoch: 20 | loss: 0.0000357
	speed: 0.0405s/iter; left time: 1342.5014s
	iters: 400, epoch: 20 | loss: 0.2574686
	speed: 0.0446s/iter; left time: 1475.5585s
Epoch: 20 cost time: 18.693872690200806
Epoch: 20, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.369 Vali Acc: 0.969 Test Loss: 0.369 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0059346
	speed: 0.1065s/iter; left time: 3508.7501s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 1660.2253s
	iters: 300, epoch: 21 | loss: 0.7641259
	speed: 0.0472s/iter; left time: 1545.8529s
	iters: 400, epoch: 21 | loss: 0.0000034
	speed: 0.0388s/iter; left time: 1265.5122s
Epoch: 21 cost time: 18.508092403411865
Epoch: 21, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.381 Vali Acc: 0.966 Test Loss: 0.381 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1149s/iter; left time: 3736.8959s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 1559.3115s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 1556.9972s
	iters: 400, epoch: 22 | loss: 0.0000001
	speed: 0.0685s/iter; left time: 2206.5534s
Epoch: 22 cost time: 23.08768343925476
Epoch: 22, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.388 Vali Acc: 0.968 Test Loss: 0.388 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0525334
	speed: 0.1550s/iter; left time: 4977.2787s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0807s/iter; left time: 2584.0024s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0833s/iter; left time: 2656.9286s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 2517.5238s
Epoch: 23 cost time: 34.025237798690796
Epoch: 23, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.338 Vali Acc: 0.972 Test Loss: 0.338 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1422s/iter; left time: 4507.5680s
	iters: 200, epoch: 24 | loss: 0.0009708
	speed: 0.0761s/iter; left time: 2404.6512s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 2414.4916s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0775s/iter; left time: 2434.5438s
Epoch: 24 cost time: 31.956366777420044
Epoch: 24, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.378 Vali Acc: 0.972 Test Loss: 0.378 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0327409
	speed: 0.1499s/iter; left time: 4688.7218s
	iters: 200, epoch: 25 | loss: 0.0000001
	speed: 0.0770s/iter; left time: 2402.6597s
	iters: 300, epoch: 25 | loss: 0.0000019
	speed: 0.0745s/iter; left time: 2315.3109s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0701s/iter; left time: 2171.5904s
Epoch: 25 cost time: 31.11578679084778
Epoch: 25, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.289 Vali Acc: 0.975 Test Loss: 0.289 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 134090
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4060237
	speed: 0.0524s/iter; left time: 2158.4595s
	iters: 200, epoch: 1 | loss: 0.0358076
	speed: 0.0379s/iter; left time: 1556.4497s
	iters: 300, epoch: 1 | loss: 0.0198681
	speed: 0.0369s/iter; left time: 1514.3181s
	iters: 400, epoch: 1 | loss: 0.2631042
	speed: 0.0363s/iter; left time: 1484.0826s
Epoch: 1 cost time: 16.89980983734131
Epoch: 1, Steps: 413 | Train Loss: 0.428 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
Validation loss decreased (inf --> -0.958616).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3243473
	speed: 0.0966s/iter; left time: 3938.1304s
	iters: 200, epoch: 2 | loss: 0.0107454
	speed: 0.0293s/iter; left time: 1192.0822s
	iters: 300, epoch: 2 | loss: 0.0518395
	speed: 0.0290s/iter; left time: 1177.8975s
	iters: 400, epoch: 2 | loss: 0.0158686
	speed: 0.0293s/iter; left time: 1186.0757s
Epoch: 2 cost time: 12.493806838989258
Epoch: 2, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
Validation loss decreased (-0.958616 --> -0.964528).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0932155
	speed: 0.0929s/iter; left time: 3752.3482s
	iters: 200, epoch: 3 | loss: 0.0123895
	speed: 0.0283s/iter; left time: 1139.3277s
	iters: 300, epoch: 3 | loss: 0.0193567
	speed: 0.0284s/iter; left time: 1140.8468s
	iters: 400, epoch: 3 | loss: 0.0001058
	speed: 0.0284s/iter; left time: 1139.5121s
Epoch: 3 cost time: 12.243060111999512
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.964528 --> -0.969985).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0011196
	speed: 0.0882s/iter; left time: 3526.3514s
	iters: 200, epoch: 4 | loss: 0.0463510
	speed: 0.0285s/iter; left time: 1137.3877s
	iters: 300, epoch: 4 | loss: 0.0513835
	speed: 0.0289s/iter; left time: 1150.9902s
	iters: 400, epoch: 4 | loss: 0.0013542
	speed: 0.0302s/iter; left time: 1196.2268s
Epoch: 4 cost time: 12.475316524505615
Epoch: 4, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.194 Vali Acc: 0.960 Test Loss: 0.194 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0003815
	speed: 0.0938s/iter; left time: 3710.9771s
	iters: 200, epoch: 5 | loss: 0.0000025
	speed: 0.0295s/iter; left time: 1164.3714s
	iters: 300, epoch: 5 | loss: 0.4766276
	speed: 0.0303s/iter; left time: 1193.7556s
	iters: 400, epoch: 5 | loss: 0.0704878
	speed: 0.0279s/iter; left time: 1093.4588s
Epoch: 5 cost time: 12.332695007324219
Epoch: 5, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0024869
	speed: 0.0898s/iter; left time: 3514.8793s
	iters: 200, epoch: 6 | loss: 0.0091467
	speed: 0.0312s/iter; left time: 1217.6204s
	iters: 300, epoch: 6 | loss: 0.6502579
	speed: 0.0351s/iter; left time: 1364.9010s
	iters: 400, epoch: 6 | loss: 0.0000063
	speed: 0.0384s/iter; left time: 1492.6248s
Epoch: 6 cost time: 13.958316802978516
Epoch: 6, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
Validation loss decreased (-0.969985 --> -0.973623).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000021
	speed: 0.1038s/iter; left time: 4019.7050s
	iters: 200, epoch: 7 | loss: 0.0000161
	speed: 0.0396s/iter; left time: 1530.5295s
	iters: 300, epoch: 7 | loss: 0.0296422
	speed: 0.0377s/iter; left time: 1451.9390s
	iters: 400, epoch: 7 | loss: 0.0104463
	speed: 0.0371s/iter; left time: 1424.8536s
Epoch: 7 cost time: 16.09167194366455
Epoch: 7, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.973623 --> -0.974987).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000240
	speed: 0.0995s/iter; left time: 3810.3928s
	iters: 200, epoch: 8 | loss: 0.1812314
	speed: 0.0365s/iter; left time: 1394.2897s
	iters: 300, epoch: 8 | loss: 0.0000778
	speed: 0.0399s/iter; left time: 1519.9776s
	iters: 400, epoch: 8 | loss: 0.0000327
	speed: 0.0375s/iter; left time: 1424.4919s
Epoch: 8 cost time: 15.954846382141113
Epoch: 8, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000372
	speed: 0.1042s/iter; left time: 3948.7425s
	iters: 200, epoch: 9 | loss: 0.0000070
	speed: 0.0386s/iter; left time: 1460.6900s
	iters: 300, epoch: 9 | loss: 0.0000547
	speed: 0.0378s/iter; left time: 1424.3328s
	iters: 400, epoch: 9 | loss: 0.0717427
	speed: 0.0387s/iter; left time: 1453.6392s
Epoch: 9 cost time: 15.988098859786987
Epoch: 9, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.158 Vali Acc: 0.978 Test Loss: 0.158 Test Acc: 0.978
Validation loss decreased (-0.974987 --> -0.977716).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1085s/iter; left time: 4066.8744s
	iters: 200, epoch: 10 | loss: 0.0026321
	speed: 0.0372s/iter; left time: 1388.9644s
	iters: 300, epoch: 10 | loss: 0.0394146
	speed: 0.0375s/iter; left time: 1396.5947s
	iters: 400, epoch: 10 | loss: 0.0000122
	speed: 0.0395s/iter; left time: 1467.7266s
Epoch: 10 cost time: 16.31331706047058
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1068s/iter; left time: 3957.9916s
	iters: 200, epoch: 11 | loss: 0.0000036
	speed: 0.0383s/iter; left time: 1417.7826s
	iters: 300, epoch: 11 | loss: 0.0011706
	speed: 0.0361s/iter; left time: 1330.3133s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0372s/iter; left time: 1368.6101s
Epoch: 11 cost time: 15.899179935455322
Epoch: 11, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.220 Vali Acc: 0.967 Test Loss: 0.220 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0016163
	speed: 0.0993s/iter; left time: 3640.1707s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0396s/iter; left time: 1447.7599s
	iters: 300, epoch: 12 | loss: 0.0000006
	speed: 0.0378s/iter; left time: 1378.8087s
	iters: 400, epoch: 12 | loss: 0.0000002
	speed: 0.0377s/iter; left time: 1372.5141s
Epoch: 12 cost time: 15.966591835021973
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.219 Vali Acc: 0.974 Test Loss: 0.219 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0128859
	speed: 0.1009s/iter; left time: 3658.6496s
	iters: 200, epoch: 13 | loss: 0.0000004
	speed: 0.0371s/iter; left time: 1341.3409s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 1419.6890s
	iters: 400, epoch: 13 | loss: 0.0000051
	speed: 0.0356s/iter; left time: 1280.1967s
Epoch: 13 cost time: 15.782092571258545
Epoch: 13, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.134 Vali Acc: 0.979 Test Loss: 0.134 Test Acc: 0.979
Validation loss decreased (-0.977716 --> -0.979080).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.4345563
	speed: 0.0949s/iter; left time: 3400.2884s
	iters: 200, epoch: 14 | loss: 0.0001725
	speed: 0.0284s/iter; left time: 1013.0523s
	iters: 300, epoch: 14 | loss: 0.0000017
	speed: 0.0271s/iter; left time: 964.3069s
	iters: 400, epoch: 14 | loss: 0.0000004
	speed: 0.0283s/iter; left time: 1004.2652s
Epoch: 14 cost time: 11.971422910690308
Epoch: 14, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.0920s/iter; left time: 3259.8287s
	iters: 200, epoch: 15 | loss: 0.0003850
	speed: 0.0277s/iter; left time: 978.7632s
	iters: 300, epoch: 15 | loss: 0.0045791
	speed: 0.0272s/iter; left time: 958.1374s
	iters: 400, epoch: 15 | loss: 0.0000412
	speed: 0.0277s/iter; left time: 972.8805s
Epoch: 15 cost time: 11.832128524780273
Epoch: 15, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.978 Test Loss: 0.158 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1375987
	speed: 0.0945s/iter; left time: 3308.3646s
	iters: 200, epoch: 16 | loss: 0.1496970
	speed: 0.0255s/iter; left time: 888.6139s
	iters: 300, epoch: 16 | loss: 0.0014127
	speed: 0.0287s/iter; left time: 999.1781s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0307s/iter; left time: 1064.7618s
Epoch: 16 cost time: 12.2490873336792
Epoch: 16, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.129 Vali Acc: 0.982 Test Loss: 0.129 Test Acc: 0.982
Validation loss decreased (-0.979080 --> -0.982263).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0070155
	speed: 0.0974s/iter; left time: 3371.0580s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 924.9669s
	iters: 300, epoch: 17 | loss: 0.1489771
	speed: 0.0255s/iter; left time: 877.9455s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 924.8234s
Epoch: 17 cost time: 11.48311996459961
Epoch: 17, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1165975
	speed: 0.0940s/iter; left time: 3211.3141s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 970.4379s
	iters: 300, epoch: 18 | loss: 0.0000137
	speed: 0.0274s/iter; left time: 931.6080s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0322s/iter; left time: 1091.0334s
Epoch: 18 cost time: 12.454506635665894
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.391 Vali Acc: 0.970 Test Loss: 0.391 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 0.1018s/iter; left time: 3438.9742s
	iters: 200, epoch: 19 | loss: 0.0000591
	speed: 0.0349s/iter; left time: 1175.1975s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 1148.6331s
	iters: 400, epoch: 19 | loss: 0.2364179
	speed: 0.0335s/iter; left time: 1120.0058s
Epoch: 19 cost time: 14.544891357421875
Epoch: 19, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.378 Vali Acc: 0.965 Test Loss: 0.378 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.1198s/iter; left time: 3995.5795s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 1453.0630s
	iters: 300, epoch: 20 | loss: 0.0000051
	speed: 0.0426s/iter; left time: 1411.3950s
	iters: 400, epoch: 20 | loss: 0.0000244
	speed: 0.0445s/iter; left time: 1470.5199s
Epoch: 20 cost time: 18.65117907524109
Epoch: 20, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.244 Vali Acc: 0.973 Test Loss: 0.244 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0216837
	speed: 0.1207s/iter; left time: 3974.8043s
	iters: 200, epoch: 21 | loss: 0.0005276
	speed: 0.0422s/iter; left time: 1384.7723s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 1397.1900s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 1501.2888s
Epoch: 21 cost time: 19.007152795791626
Epoch: 21, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.238 Vali Acc: 0.978 Test Loss: 0.238 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1185s/iter; left time: 3853.5219s
	iters: 200, epoch: 22 | loss: 0.0000052
	speed: 0.0436s/iter; left time: 1412.3583s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0424s/iter; left time: 1369.4633s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1562.7870s
Epoch: 22 cost time: 18.93981099128723
Epoch: 22, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.255 Vali Acc: 0.976 Test Loss: 0.255 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.2247532
	speed: 0.1177s/iter; left time: 3778.9266s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0434s/iter; left time: 1389.3643s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 1417.5526s
	iters: 400, epoch: 23 | loss: 0.0000012
	speed: 0.0476s/iter; left time: 1515.1817s
Epoch: 23 cost time: 18.937528133392334
Epoch: 23, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.390 Vali Acc: 0.968 Test Loss: 0.390 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.1534353
	speed: 0.1137s/iter; left time: 3603.4657s
	iters: 200, epoch: 24 | loss: 0.2021185
	speed: 0.0443s/iter; left time: 1399.3648s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 1515.9154s
	iters: 400, epoch: 24 | loss: 0.0000001
	speed: 0.0462s/iter; left time: 1449.6868s
Epoch: 24 cost time: 18.97606325149536
Epoch: 24, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.410 Vali Acc: 0.966 Test Loss: 0.410 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000002
	speed: 0.1148s/iter; left time: 3592.7329s
	iters: 200, epoch: 25 | loss: 0.0000131
	speed: 0.0445s/iter; left time: 1387.0009s
	iters: 300, epoch: 25 | loss: 0.1078514
	speed: 0.0472s/iter; left time: 1468.0712s
	iters: 400, epoch: 25 | loss: 0.9707694
	speed: 0.0451s/iter; left time: 1398.8831s
Epoch: 25 cost time: 18.886002779006958
Epoch: 25, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.317 Vali Acc: 0.974 Test Loss: 0.317 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1145s/iter; left time: 3534.6325s
	iters: 200, epoch: 26 | loss: 0.0179102
	speed: 0.0464s/iter; left time: 1429.0174s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 1499.0367s
	iters: 400, epoch: 26 | loss: 0.0015980
	speed: 0.0422s/iter; left time: 1291.5848s
Epoch: 26 cost time: 19.07495403289795
Epoch: 26, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.236 Vali Acc: 0.974 Test Loss: 0.236 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 113386
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1798369
	speed: 0.0500s/iter; left time: 2058.7565s
	iters: 200, epoch: 1 | loss: 0.0366650
	speed: 0.0372s/iter; left time: 1529.0283s
	iters: 300, epoch: 1 | loss: 0.0754562
	speed: 0.0390s/iter; left time: 1597.5631s
	iters: 400, epoch: 1 | loss: 0.0193837
	speed: 0.0303s/iter; left time: 1239.4147s
Epoch: 1 cost time: 16.124887228012085
Epoch: 1, Steps: 413 | Train Loss: 0.462 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
Validation loss decreased (inf --> -0.961800).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0704203
	speed: 0.1078s/iter; left time: 4395.8000s
	iters: 200, epoch: 2 | loss: 0.2481045
	speed: 0.0348s/iter; left time: 1416.1489s
	iters: 300, epoch: 2 | loss: 0.6050856
	speed: 0.0323s/iter; left time: 1312.3482s
	iters: 400, epoch: 2 | loss: 0.0198705
	speed: 0.0318s/iter; left time: 1286.7239s
Epoch: 2 cost time: 14.236549377441406
Epoch: 2, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.113 Vali Acc: 0.963 Test Loss: 0.113 Test Acc: 0.963
Validation loss decreased (-0.961800 --> -0.963164).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0564210
	speed: 0.1072s/iter; left time: 4329.5234s
	iters: 200, epoch: 3 | loss: 0.0102304
	speed: 0.0378s/iter; left time: 1520.9402s
	iters: 300, epoch: 3 | loss: 0.1292811
	speed: 0.0302s/iter; left time: 1211.7358s
	iters: 400, epoch: 3 | loss: 0.4167268
	speed: 0.0317s/iter; left time: 1270.4627s
Epoch: 3 cost time: 14.620054960250854
Epoch: 3, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0203326
	speed: 0.1044s/iter; left time: 4170.6360s
	iters: 200, epoch: 4 | loss: 0.0008553
	speed: 0.0343s/iter; left time: 1367.6122s
	iters: 300, epoch: 4 | loss: 0.0000289
	speed: 0.0297s/iter; left time: 1180.1441s
	iters: 400, epoch: 4 | loss: 0.0683003
	speed: 0.0293s/iter; left time: 1160.6119s
Epoch: 4 cost time: 13.808348178863525
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.110 Vali Acc: 0.966 Test Loss: 0.110 Test Acc: 0.966
Validation loss decreased (-0.963164 --> -0.965892).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0033697
	speed: 0.1101s/iter; left time: 4352.9431s
	iters: 200, epoch: 5 | loss: 0.1203740
	speed: 0.0394s/iter; left time: 1553.3222s
	iters: 300, epoch: 5 | loss: 0.2077526
	speed: 0.0414s/iter; left time: 1627.8743s
	iters: 400, epoch: 5 | loss: 0.0000634
	speed: 0.0438s/iter; left time: 1719.8575s
Epoch: 5 cost time: 17.82360291481018
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.965892 --> -0.973168).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000441
	speed: 0.1187s/iter; left time: 4646.8012s
	iters: 200, epoch: 6 | loss: 0.0001039
	speed: 0.0422s/iter; left time: 1647.4062s
	iters: 300, epoch: 6 | loss: 0.0042497
	speed: 0.0432s/iter; left time: 1681.0329s
	iters: 400, epoch: 6 | loss: 0.0002078
	speed: 0.0435s/iter; left time: 1688.7553s
Epoch: 6 cost time: 18.39836359024048
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.973168 --> -0.976352).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0056626
	speed: 0.1211s/iter; left time: 4690.4698s
	iters: 200, epoch: 7 | loss: 0.0000085
	speed: 0.0439s/iter; left time: 1695.7614s
	iters: 300, epoch: 7 | loss: 0.0002188
	speed: 0.0457s/iter; left time: 1759.8577s
	iters: 400, epoch: 7 | loss: 0.0000200
	speed: 0.0495s/iter; left time: 1903.1955s
Epoch: 7 cost time: 19.302523612976074
Epoch: 7, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0232631
	speed: 0.1234s/iter; left time: 4726.5902s
	iters: 200, epoch: 8 | loss: 0.0000031
	speed: 0.0450s/iter; left time: 1721.1403s
	iters: 300, epoch: 8 | loss: 0.4255829
	speed: 0.0503s/iter; left time: 1917.4276s
	iters: 400, epoch: 8 | loss: 0.0000035
	speed: 0.0493s/iter; left time: 1874.1493s
Epoch: 8 cost time: 20.085579872131348
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0254334
	speed: 0.1196s/iter; left time: 4530.7023s
	iters: 200, epoch: 9 | loss: 0.0000007
	speed: 0.0470s/iter; left time: 1777.3136s
	iters: 300, epoch: 9 | loss: 0.2427157
	speed: 0.0502s/iter; left time: 1892.9905s
	iters: 400, epoch: 9 | loss: 0.0003452
	speed: 0.0493s/iter; left time: 1854.0210s
Epoch: 9 cost time: 20.02208423614502
Epoch: 9, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.976352 --> -0.979990).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000012
	speed: 0.1201s/iter; left time: 4503.3624s
	iters: 200, epoch: 10 | loss: 0.0000978
	speed: 0.0502s/iter; left time: 1874.9508s
	iters: 300, epoch: 10 | loss: 0.0000039
	speed: 0.0492s/iter; left time: 1833.6598s
	iters: 400, epoch: 10 | loss: 0.0587304
	speed: 0.0472s/iter; left time: 1755.6681s
Epoch: 10 cost time: 20.0616295337677
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000602
	speed: 0.1229s/iter; left time: 4554.8505s
	iters: 200, epoch: 11 | loss: 0.0001262
	speed: 0.0505s/iter; left time: 1866.7796s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 1842.0106s
	iters: 400, epoch: 11 | loss: 0.0031519
	speed: 0.0452s/iter; left time: 1663.0550s
Epoch: 11 cost time: 20.187936544418335
Epoch: 11, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.171 Vali Acc: 0.966 Test Loss: 0.171 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000686
	speed: 0.1257s/iter; left time: 4608.9621s
	iters: 200, epoch: 12 | loss: 0.0000286
	speed: 0.0506s/iter; left time: 1851.1759s
	iters: 300, epoch: 12 | loss: 0.0000016
	speed: 0.0472s/iter; left time: 1719.5380s
	iters: 400, epoch: 12 | loss: 0.0000056
	speed: 0.0470s/iter; left time: 1708.0781s
Epoch: 12 cost time: 20.387765169143677
Epoch: 12, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0516718
	speed: 0.1230s/iter; left time: 4459.8685s
	iters: 200, epoch: 13 | loss: 0.0000099
	speed: 0.0502s/iter; left time: 1815.1313s
	iters: 300, epoch: 13 | loss: 0.0000002
	speed: 0.0334s/iter; left time: 1205.4450s
	iters: 400, epoch: 13 | loss: 0.0000019
	speed: 0.0349s/iter; left time: 1253.8117s
Epoch: 13 cost time: 17.649185180664062
Epoch: 13, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.277 Vali Acc: 0.959 Test Loss: 0.277 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000111
	speed: 0.1135s/iter; left time: 4066.4606s
	iters: 200, epoch: 14 | loss: 0.0000003
	speed: 0.0391s/iter; left time: 1395.6543s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0368s/iter; left time: 1311.2647s
	iters: 400, epoch: 14 | loss: 0.0000005
	speed: 0.0339s/iter; left time: 1206.2654s
Epoch: 14 cost time: 16.13784623146057
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.140 Vali Acc: 0.976 Test Loss: 0.140 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000019
	speed: 0.1140s/iter; left time: 4036.5918s
	iters: 200, epoch: 15 | loss: 0.0000359
	speed: 0.0350s/iter; left time: 1236.6397s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 1228.3188s
	iters: 400, epoch: 15 | loss: 0.0036768
	speed: 0.0344s/iter; left time: 1206.9521s
Epoch: 15 cost time: 15.557475566864014
Epoch: 15, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.159 Vali Acc: 0.980 Test Loss: 0.159 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1086s/iter; left time: 3801.9739s
	iters: 200, epoch: 16 | loss: 0.0401649
	speed: 0.0355s/iter; left time: 1238.5119s
	iters: 300, epoch: 16 | loss: 0.0011169
	speed: 0.0340s/iter; left time: 1181.7977s
	iters: 400, epoch: 16 | loss: 0.0007058
	speed: 0.0377s/iter; left time: 1308.7578s
Epoch: 16 cost time: 14.806243419647217
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.198 Vali Acc: 0.977 Test Loss: 0.198 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0087607
	speed: 0.1028s/iter; left time: 3555.2512s
	iters: 200, epoch: 17 | loss: 0.0000011
	speed: 0.0289s/iter; left time: 997.8315s
	iters: 300, epoch: 17 | loss: 0.0006394
	speed: 0.0277s/iter; left time: 951.0356s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0358s/iter; left time: 1226.4322s
Epoch: 17 cost time: 13.07783842086792
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1015s/iter; left time: 3467.9963s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 1132.7368s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0346s/iter; left time: 1176.6406s
	iters: 400, epoch: 18 | loss: 0.0000010
	speed: 0.0369s/iter; left time: 1251.1453s
Epoch: 18 cost time: 14.73195481300354
Epoch: 18, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.208 Vali Acc: 0.972 Test Loss: 0.208 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000030
	speed: 0.1148s/iter; left time: 3877.0504s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 1419.6362s
	iters: 300, epoch: 19 | loss: 0.0004955
	speed: 0.0439s/iter; left time: 1474.5587s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 1199.9297s
Epoch: 19 cost time: 17.124783515930176
Epoch: 19, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.250 Vali Acc: 0.976 Test Loss: 0.250 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 92714
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3972939
	speed: 0.0545s/iter; left time: 2245.3847s
	iters: 200, epoch: 1 | loss: 0.1540433
	speed: 0.0395s/iter; left time: 1624.1639s
	iters: 300, epoch: 1 | loss: 0.1909529
	speed: 0.0410s/iter; left time: 1682.6689s
	iters: 400, epoch: 1 | loss: 0.3071139
	speed: 0.0411s/iter; left time: 1680.7471s
Epoch: 1 cost time: 18.227253198623657
Epoch: 1, Steps: 413 | Train Loss: 0.495 Vali Loss: 0.113 Vali Acc: 0.964 Test Loss: 0.113 Test Acc: 0.964
Validation loss decreased (inf --> -0.964073).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0294371
	speed: 0.1110s/iter; left time: 4526.3880s
	iters: 200, epoch: 2 | loss: 0.0103994
	speed: 0.0423s/iter; left time: 1722.0612s
	iters: 300, epoch: 2 | loss: 0.0375139
	speed: 0.0407s/iter; left time: 1652.3696s
	iters: 400, epoch: 2 | loss: 0.0226719
	speed: 0.0413s/iter; left time: 1672.9950s
Epoch: 2 cost time: 17.54134964942932
Epoch: 2, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.071 Vali Acc: 0.971 Test Loss: 0.071 Test Acc: 0.971
Validation loss decreased (-0.964073 --> -0.971350).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0008600
	speed: 0.1120s/iter; left time: 4520.7555s
	iters: 200, epoch: 3 | loss: 0.0106247
	speed: 0.0403s/iter; left time: 1621.1835s
	iters: 300, epoch: 3 | loss: 0.0002412
	speed: 0.0395s/iter; left time: 1586.4541s
	iters: 400, epoch: 3 | loss: 0.0054747
	speed: 0.0423s/iter; left time: 1695.5155s
Epoch: 3 cost time: 17.31443428993225
Epoch: 3, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0006140
	speed: 0.1112s/iter; left time: 4441.9501s
	iters: 200, epoch: 4 | loss: 0.0098724
	speed: 0.0399s/iter; left time: 1590.3828s
	iters: 300, epoch: 4 | loss: 0.0017978
	speed: 0.0426s/iter; left time: 1693.9739s
	iters: 400, epoch: 4 | loss: 0.1958984
	speed: 0.0425s/iter; left time: 1683.7147s
Epoch: 4 cost time: 17.44821810722351
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0001495
	speed: 0.1104s/iter; left time: 4364.7788s
	iters: 200, epoch: 5 | loss: 0.0002968
	speed: 0.0422s/iter; left time: 1663.4309s
	iters: 300, epoch: 5 | loss: 0.0955279
	speed: 0.0422s/iter; left time: 1659.8150s
	iters: 400, epoch: 5 | loss: 0.0008716
	speed: 0.0394s/iter; left time: 1546.5442s
Epoch: 5 cost time: 17.429468870162964
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0834839
	speed: 0.1085s/iter; left time: 4246.8594s
	iters: 200, epoch: 6 | loss: 0.0011476
	speed: 0.0384s/iter; left time: 1498.7590s
	iters: 300, epoch: 6 | loss: 0.0001150
	speed: 0.0388s/iter; left time: 1510.6922s
	iters: 400, epoch: 6 | loss: 0.0000623
	speed: 0.0404s/iter; left time: 1570.5274s
Epoch: 6 cost time: 16.61003589630127
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.971350 --> -0.972714).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2715216
	speed: 0.0953s/iter; left time: 3690.6927s
	iters: 200, epoch: 7 | loss: 0.0001959
	speed: 0.0297s/iter; left time: 1147.5355s
	iters: 300, epoch: 7 | loss: 0.0000441
	speed: 0.0305s/iter; left time: 1176.6447s
	iters: 400, epoch: 7 | loss: 0.0007716
	speed: 0.0322s/iter; left time: 1236.3135s
Epoch: 7 cost time: 12.844297885894775
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0007097
	speed: 0.0928s/iter; left time: 3553.2569s
	iters: 200, epoch: 8 | loss: 0.0020657
	speed: 0.0297s/iter; left time: 1133.2658s
	iters: 300, epoch: 8 | loss: 0.0268700
	speed: 0.0326s/iter; left time: 1240.7409s
	iters: 400, epoch: 8 | loss: 0.0000062
	speed: 0.0324s/iter; left time: 1231.0075s
Epoch: 8 cost time: 13.099289417266846
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.972714 --> -0.975442).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0002175
	speed: 0.0999s/iter; left time: 3785.6148s
	iters: 200, epoch: 9 | loss: 0.0030564
	speed: 0.0333s/iter; left time: 1257.9000s
	iters: 300, epoch: 9 | loss: 0.0044772
	speed: 0.0268s/iter; left time: 1011.8317s
	iters: 400, epoch: 9 | loss: 0.0010155
	speed: 0.0297s/iter; left time: 1116.1051s
Epoch: 9 cost time: 12.805985927581787
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000753
	speed: 0.0962s/iter; left time: 3606.1477s
	iters: 200, epoch: 10 | loss: 0.1387010
	speed: 0.0308s/iter; left time: 1150.0540s
	iters: 300, epoch: 10 | loss: 0.1236174
	speed: 0.0302s/iter; left time: 1124.2964s
	iters: 400, epoch: 10 | loss: 0.0000365
	speed: 0.0289s/iter; left time: 1074.5057s
Epoch: 10 cost time: 12.755673170089722
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0001991
	speed: 0.0964s/iter; left time: 3574.6219s
	iters: 200, epoch: 11 | loss: 0.0000002
	speed: 0.0291s/iter; left time: 1074.6743s
	iters: 300, epoch: 11 | loss: 0.0000050
	speed: 0.0291s/iter; left time: 1071.4264s
	iters: 400, epoch: 11 | loss: 0.0214396
	speed: 0.0307s/iter; left time: 1129.6690s
Epoch: 11 cost time: 12.669711351394653
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.975442 --> -0.979535).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2618481
	speed: 0.0966s/iter; left time: 3540.2930s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0359s/iter; left time: 1312.9481s
	iters: 300, epoch: 12 | loss: 0.0000024
	speed: 0.0380s/iter; left time: 1387.1290s
	iters: 400, epoch: 12 | loss: 0.0000004
	speed: 0.0414s/iter; left time: 1504.5798s
Epoch: 12 cost time: 16.104851722717285
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.168 Vali Acc: 0.971 Test Loss: 0.168 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0002184
	speed: 0.1080s/iter; left time: 3913.4183s
	iters: 200, epoch: 13 | loss: 0.3406988
	speed: 0.0413s/iter; left time: 1494.0926s
	iters: 300, epoch: 13 | loss: 0.0000172
	speed: 0.0415s/iter; left time: 1494.1434s
	iters: 400, epoch: 13 | loss: 0.0000450
	speed: 0.0385s/iter; left time: 1383.7011s
Epoch: 13 cost time: 16.767133951187134
Epoch: 13, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000328
	speed: 0.1115s/iter; left time: 3994.2895s
	iters: 200, epoch: 14 | loss: 0.0000461
	speed: 0.0390s/iter; left time: 1392.8679s
	iters: 300, epoch: 14 | loss: 0.0000023
	speed: 0.0358s/iter; left time: 1275.7876s
	iters: 400, epoch: 14 | loss: 0.0000200
	speed: 0.0377s/iter; left time: 1338.5085s
Epoch: 14 cost time: 16.155925035476685
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000706
	speed: 0.1084s/iter; left time: 3837.7263s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 1359.1004s
	iters: 300, epoch: 15 | loss: 0.0000604
	speed: 0.0382s/iter; left time: 1346.0463s
	iters: 400, epoch: 15 | loss: 0.0000101
	speed: 0.0403s/iter; left time: 1413.7753s
Epoch: 15 cost time: 16.45257806777954
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.197 Vali Acc: 0.972 Test Loss: 0.197 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000211
	speed: 0.1067s/iter; left time: 3736.8121s
	iters: 200, epoch: 16 | loss: 0.0067001
	speed: 0.0386s/iter; left time: 1345.9031s
	iters: 300, epoch: 16 | loss: 0.0000782
	speed: 0.0427s/iter; left time: 1485.8272s
	iters: 400, epoch: 16 | loss: 0.0000002
	speed: 0.0420s/iter; left time: 1457.0529s
Epoch: 16 cost time: 17.04027009010315
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.189 Vali Acc: 0.974 Test Loss: 0.189 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000105
	speed: 0.1076s/iter; left time: 3723.2122s
	iters: 200, epoch: 17 | loss: 0.0000292
	speed: 0.0426s/iter; left time: 1470.8006s
	iters: 300, epoch: 17 | loss: 0.0000267
	speed: 0.0409s/iter; left time: 1405.2028s
	iters: 400, epoch: 17 | loss: 0.0000096
	speed: 0.0401s/iter; left time: 1374.8599s
Epoch: 17 cost time: 17.05221438407898
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
Validation loss decreased (-0.979535 --> -0.982264).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000003
	speed: 0.1101s/iter; left time: 3763.5804s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.0398s/iter; left time: 1357.8430s
	iters: 300, epoch: 18 | loss: 0.0000069
	speed: 0.0397s/iter; left time: 1349.4594s
	iters: 400, epoch: 18 | loss: 0.0018795
	speed: 0.0391s/iter; left time: 1323.3749s
Epoch: 18 cost time: 17.083296298980713
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000015
	speed: 0.1094s/iter; left time: 3692.7932s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0403s/iter; left time: 1355.9241s
	iters: 300, epoch: 19 | loss: 0.5448701
	speed: 0.0395s/iter; left time: 1327.2237s
	iters: 400, epoch: 19 | loss: 0.0001594
	speed: 0.0425s/iter; left time: 1422.4956s
Epoch: 19 cost time: 16.984203577041626
Epoch: 19, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.144 Vali Acc: 0.978 Test Loss: 0.144 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0012417
	speed: 0.0905s/iter; left time: 3019.3465s
	iters: 200, epoch: 20 | loss: 0.0000510
	speed: 0.0295s/iter; left time: 979.9606s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0313s/iter; left time: 1038.7436s
	iters: 400, epoch: 20 | loss: 0.0193582
	speed: 0.0337s/iter; left time: 1115.1681s
Epoch: 20 cost time: 12.985044240951538
Epoch: 20, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.186 Vali Acc: 0.976 Test Loss: 0.186 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000455
	speed: 0.0980s/iter; left time: 3229.7923s
	iters: 200, epoch: 21 | loss: 0.3727258
	speed: 0.0331s/iter; left time: 1086.2779s
	iters: 300, epoch: 21 | loss: 0.0000007
	speed: 0.0339s/iter; left time: 1110.9331s
	iters: 400, epoch: 21 | loss: 0.0007350
	speed: 0.0292s/iter; left time: 951.8319s
Epoch: 21 cost time: 13.534815549850464
Epoch: 21, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0008903
	speed: 0.0972s/iter; left time: 3162.1768s
	iters: 200, epoch: 22 | loss: 0.0000018
	speed: 0.0312s/iter; left time: 1010.4741s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.0300s/iter; left time: 969.3141s
	iters: 400, epoch: 22 | loss: 0.0000006
	speed: 0.0291s/iter; left time: 939.1381s
Epoch: 22 cost time: 12.85932993888855
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.974 Test Loss: 0.193 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000120
	speed: 0.0929s/iter; left time: 2982.4933s
	iters: 200, epoch: 23 | loss: 0.2438729
	speed: 0.0283s/iter; left time: 907.5427s
	iters: 300, epoch: 23 | loss: 0.0000086
	speed: 0.0282s/iter; left time: 899.1500s
	iters: 400, epoch: 23 | loss: 0.0000168
	speed: 0.0286s/iter; left time: 910.1007s
Epoch: 23 cost time: 12.35176944732666
Epoch: 23, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000241
	speed: 0.0931s/iter; left time: 2952.8570s
	iters: 200, epoch: 24 | loss: 0.0004239
	speed: 0.0266s/iter; left time: 840.5774s
	iters: 300, epoch: 24 | loss: 0.0004722
	speed: 0.0271s/iter; left time: 853.1027s
	iters: 400, epoch: 24 | loss: 0.0000017
	speed: 0.0357s/iter; left time: 1121.6110s
Epoch: 24 cost time: 12.622173309326172
Epoch: 24, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.978 Test Loss: 0.166 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000057
	speed: 0.1025s/iter; left time: 3206.5044s
	iters: 200, epoch: 25 | loss: 0.0000179
	speed: 0.0363s/iter; left time: 1133.5952s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 1166.4281s
	iters: 400, epoch: 25 | loss: 0.0000043
	speed: 0.0400s/iter; left time: 1238.4547s
Epoch: 25 cost time: 15.916072845458984
Epoch: 25, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.190 Vali Acc: 0.979 Test Loss: 0.190 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000001
	speed: 0.1051s/iter; left time: 3245.8638s
	iters: 200, epoch: 26 | loss: 0.0006027
	speed: 0.0382s/iter; left time: 1175.6656s
	iters: 300, epoch: 26 | loss: 0.0001363
	speed: 0.0392s/iter; left time: 1203.6765s
	iters: 400, epoch: 26 | loss: 0.0000002
	speed: 0.0366s/iter; left time: 1119.3837s
Epoch: 26 cost time: 15.8898766040802
Epoch: 26, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.974 Test Loss: 0.161 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000047
	speed: 0.1100s/iter; left time: 3350.5337s
	iters: 200, epoch: 27 | loss: 0.0000644
	speed: 0.0387s/iter; left time: 1176.2436s
	iters: 300, epoch: 27 | loss: 0.3519323
	speed: 0.0373s/iter; left time: 1128.9117s
	iters: 400, epoch: 27 | loss: 0.0001353
	speed: 0.0370s/iter; left time: 1116.3095s
Epoch: 27 cost time: 16.0772066116333
Epoch: 27, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.161 Vali Acc: 0.980 Test Loss: 0.161 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 76234
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7923683
	speed: 0.0539s/iter; left time: 2222.2586s
	iters: 200, epoch: 1 | loss: 0.3452423
	speed: 0.0364s/iter; left time: 1497.9554s
	iters: 300, epoch: 1 | loss: 0.0336706
	speed: 0.0360s/iter; left time: 1477.0891s
	iters: 400, epoch: 1 | loss: 0.0428196
	speed: 0.0362s/iter; left time: 1479.3301s
Epoch: 1 cost time: 16.823793411254883
Epoch: 1, Steps: 413 | Train Loss: 0.588 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3006155
	speed: 0.1052s/iter; left time: 4292.7226s
	iters: 200, epoch: 2 | loss: 0.0126463
	speed: 0.0365s/iter; left time: 1485.7528s
	iters: 300, epoch: 2 | loss: 0.0046687
	speed: 0.0387s/iter; left time: 1569.8592s
	iters: 400, epoch: 2 | loss: 0.1131823
	speed: 0.0381s/iter; left time: 1544.2225s
Epoch: 2 cost time: 15.886298894882202
Epoch: 2, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.067 Vali Acc: 0.975 Test Loss: 0.067 Test Acc: 0.975
Validation loss decreased (-0.957252 --> -0.974988).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0053415
	speed: 0.1073s/iter; left time: 4331.3173s
	iters: 200, epoch: 3 | loss: 0.0067452
	speed: 0.0393s/iter; left time: 1584.0757s
	iters: 300, epoch: 3 | loss: 0.1963155
	speed: 0.0381s/iter; left time: 1529.9896s
	iters: 400, epoch: 3 | loss: 0.0008118
	speed: 0.0381s/iter; left time: 1526.8636s
Epoch: 3 cost time: 16.07973861694336
Epoch: 3, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0014837
	speed: 0.1038s/iter; left time: 4150.0506s
	iters: 200, epoch: 4 | loss: 0.0013976
	speed: 0.0392s/iter; left time: 1563.2151s
	iters: 300, epoch: 4 | loss: 0.0211252
	speed: 0.0370s/iter; left time: 1470.5126s
	iters: 400, epoch: 4 | loss: 0.0052371
	speed: 0.0279s/iter; left time: 1106.8720s
Epoch: 4 cost time: 15.095494508743286
Epoch: 4, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.055 Vali Acc: 0.981 Test Loss: 0.055 Test Acc: 0.981
Validation loss decreased (-0.974988 --> -0.980900).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0451477
	speed: 0.0947s/iter; left time: 3744.5539s
	iters: 200, epoch: 5 | loss: 0.0001775
	speed: 0.0284s/iter; left time: 1119.3630s
	iters: 300, epoch: 5 | loss: 0.1508536
	speed: 0.0294s/iter; left time: 1156.4490s
	iters: 400, epoch: 5 | loss: 0.0010213
	speed: 0.0292s/iter; left time: 1144.3289s
Epoch: 5 cost time: 12.450073957443237
Epoch: 5, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.093 Vali Acc: 0.972 Test Loss: 0.093 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0004241
	speed: 0.0944s/iter; left time: 3694.2385s
	iters: 200, epoch: 6 | loss: 0.0024830
	speed: 0.0293s/iter; left time: 1145.0100s
	iters: 300, epoch: 6 | loss: 0.0168172
	speed: 0.0302s/iter; left time: 1176.2011s
	iters: 400, epoch: 6 | loss: 0.0056448
	speed: 0.0297s/iter; left time: 1154.5102s
Epoch: 6 cost time: 12.638219833374023
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0004137
	speed: 0.0945s/iter; left time: 3660.2620s
	iters: 200, epoch: 7 | loss: 0.0008206
	speed: 0.0314s/iter; left time: 1214.3108s
	iters: 300, epoch: 7 | loss: 0.0036910
	speed: 0.0299s/iter; left time: 1151.3465s
	iters: 400, epoch: 7 | loss: 0.0000012
	speed: 0.0288s/iter; left time: 1106.4260s
Epoch: 7 cost time: 12.66990327835083
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0024561
	speed: 0.0990s/iter; left time: 3792.1984s
	iters: 200, epoch: 8 | loss: 0.0145332
	speed: 0.0289s/iter; left time: 1103.8891s
	iters: 300, epoch: 8 | loss: 0.0027183
	speed: 0.0273s/iter; left time: 1042.0082s
	iters: 400, epoch: 8 | loss: 0.0009487
	speed: 0.0276s/iter; left time: 1050.4769s
Epoch: 8 cost time: 12.182099342346191
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0010409
	speed: 0.0872s/iter; left time: 3304.5990s
	iters: 200, epoch: 9 | loss: 0.0005696
	speed: 0.0335s/iter; left time: 1266.2807s
	iters: 300, epoch: 9 | loss: 0.1980408
	speed: 0.0337s/iter; left time: 1271.8919s
	iters: 400, epoch: 9 | loss: 0.0004616
	speed: 0.0350s/iter; left time: 1315.8909s
Epoch: 9 cost time: 13.482764482498169
Epoch: 9, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0112507
	speed: 0.0965s/iter; left time: 3615.4913s
	iters: 200, epoch: 10 | loss: 0.0000002
	speed: 0.0332s/iter; left time: 1239.4346s
	iters: 300, epoch: 10 | loss: 0.1152641
	speed: 0.0348s/iter; left time: 1298.6494s
	iters: 400, epoch: 10 | loss: 0.0000046
	speed: 0.0356s/iter; left time: 1324.5760s
Epoch: 10 cost time: 14.448214292526245
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000009
	speed: 0.0758s/iter; left time: 2809.2733s
	iters: 200, epoch: 11 | loss: 0.0007147
	speed: 0.0195s/iter; left time: 721.8057s
	iters: 300, epoch: 11 | loss: 0.0000261
	speed: 0.0219s/iter; left time: 805.8854s
	iters: 400, epoch: 11 | loss: 0.0079954
	speed: 0.0226s/iter; left time: 832.7595s
Epoch: 11 cost time: 9.18171238899231
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0191432
	speed: 0.0656s/iter; left time: 2404.7040s
	iters: 200, epoch: 12 | loss: 0.0000004
	speed: 0.0246s/iter; left time: 899.3113s
	iters: 300, epoch: 12 | loss: 0.0000066
	speed: 0.0304s/iter; left time: 1109.0285s
	iters: 400, epoch: 12 | loss: 0.0005623
	speed: 0.0360s/iter; left time: 1308.5998s
Epoch: 12 cost time: 12.105641603469849
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0037554
	speed: 0.0963s/iter; left time: 3489.3868s
	iters: 200, epoch: 13 | loss: 0.0005106
	speed: 0.0337s/iter; left time: 1219.3964s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 1263.5009s
	iters: 400, epoch: 13 | loss: 0.0000511
	speed: 0.0300s/iter; left time: 1079.9207s
Epoch: 13 cost time: 14.068848133087158
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.979 Test Loss: 0.126 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000025
	speed: 0.0970s/iter; left time: 3475.8818s
	iters: 200, epoch: 14 | loss: 0.0009661
	speed: 0.0341s/iter; left time: 1218.1906s
	iters: 300, epoch: 14 | loss: 0.0000177
	speed: 0.0315s/iter; left time: 1121.6260s
	iters: 400, epoch: 14 | loss: 0.0414510
	speed: 0.0313s/iter; left time: 1110.8850s
Epoch: 14 cost time: 13.646247863769531
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 68074
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1616845
	speed: 0.0838s/iter; left time: 3452.9517s
	iters: 200, epoch: 1 | loss: 0.0248584
	speed: 0.0659s/iter; left time: 2708.5103s
	iters: 300, epoch: 1 | loss: 0.0057731
	speed: 0.0714s/iter; left time: 2927.4390s
	iters: 400, epoch: 1 | loss: 1.3130896
	speed: 0.0680s/iter; left time: 2780.8766s
Epoch: 1 cost time: 30.045490026474
Epoch: 1, Steps: 413 | Train Loss: 0.387 Vali Loss: 0.226 Vali Acc: 0.938 Test Loss: 0.226 Test Acc: 0.938
Validation loss decreased (inf --> -0.937697).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0026652
	speed: 0.1463s/iter; left time: 5965.7896s
	iters: 200, epoch: 2 | loss: 0.0123071
	speed: 0.0792s/iter; left time: 3222.7867s
	iters: 300, epoch: 2 | loss: 0.0012395
	speed: 0.0694s/iter; left time: 2817.1254s
	iters: 400, epoch: 2 | loss: 0.0000025
	speed: 0.0774s/iter; left time: 3131.9034s
Epoch: 2 cost time: 30.86347246170044
Epoch: 2, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
Validation loss decreased (-0.937697 --> -0.963163).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0577523
	speed: 0.1566s/iter; left time: 6324.6514s
	iters: 200, epoch: 3 | loss: 0.0000005
	speed: 0.0740s/iter; left time: 2980.4753s
	iters: 300, epoch: 3 | loss: 0.3124552
	speed: 0.0511s/iter; left time: 2054.0906s
	iters: 400, epoch: 3 | loss: 0.1278706
	speed: 0.0564s/iter; left time: 2259.3063s
Epoch: 3 cost time: 26.711646556854248
Epoch: 3, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.234 Vali Acc: 0.955 Test Loss: 0.234 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000027
	speed: 0.1251s/iter; left time: 4999.2217s
	iters: 200, epoch: 4 | loss: 0.0000010
	speed: 0.0514s/iter; left time: 2047.4733s
	iters: 300, epoch: 4 | loss: 0.0043171
	speed: 0.0506s/iter; left time: 2011.0919s
	iters: 400, epoch: 4 | loss: 0.5352301
	speed: 0.0555s/iter; left time: 2200.0759s
Epoch: 4 cost time: 22.596868991851807
Epoch: 4, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.236 Vali Acc: 0.968 Test Loss: 0.236 Test Acc: 0.968
Validation loss decreased (-0.963163 --> -0.967710).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0023813
	speed: 0.1239s/iter; left time: 4899.7483s
	iters: 200, epoch: 5 | loss: 0.0000237
	speed: 0.0483s/iter; left time: 1906.3100s
	iters: 300, epoch: 5 | loss: 0.0001618
	speed: 0.0427s/iter; left time: 1682.1090s
	iters: 400, epoch: 5 | loss: 0.0057719
	speed: 0.0531s/iter; left time: 2083.7312s
Epoch: 5 cost time: 20.98177218437195
Epoch: 5, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.232 Vali Acc: 0.966 Test Loss: 0.232 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.1444s/iter; left time: 5652.9681s
	iters: 200, epoch: 6 | loss: 0.0172144
	speed: 0.0773s/iter; left time: 3016.3793s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0741s/iter; left time: 2886.9456s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0781s/iter; left time: 3032.6769s
Epoch: 6 cost time: 31.818809509277344
Epoch: 6, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.302 Vali Acc: 0.964 Test Loss: 0.302 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1522s/iter; left time: 5892.4086s
	iters: 200, epoch: 7 | loss: 0.0000550
	speed: 0.0723s/iter; left time: 2793.1719s
	iters: 300, epoch: 7 | loss: 0.0015754
	speed: 0.0800s/iter; left time: 3081.3930s
	iters: 400, epoch: 7 | loss: 0.0000184
	speed: 0.0672s/iter; left time: 2583.6276s
Epoch: 7 cost time: 31.028682708740234
Epoch: 7, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.473 Vali Acc: 0.960 Test Loss: 0.473 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.8518921
	speed: 0.1399s/iter; left time: 5358.5737s
	iters: 200, epoch: 8 | loss: 0.2240634
	speed: 0.0773s/iter; left time: 2952.9340s
	iters: 300, epoch: 8 | loss: 0.0106505
	speed: 0.0737s/iter; left time: 2807.4623s
	iters: 400, epoch: 8 | loss: 0.0000009
	speed: 0.0775s/iter; left time: 2947.5383s
Epoch: 8 cost time: 31.14086937904358
Epoch: 8, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.226 Vali Acc: 0.972 Test Loss: 0.226 Test Acc: 0.972
Validation loss decreased (-0.967710 --> -0.972258).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1449s/iter; left time: 5491.4805s
	iters: 200, epoch: 9 | loss: 0.6597617
	speed: 0.0689s/iter; left time: 2603.6471s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0737s/iter; left time: 2777.1842s
	iters: 400, epoch: 9 | loss: 0.0038069
	speed: 0.0778s/iter; left time: 2924.9945s
Epoch: 9 cost time: 30.209310054779053
Epoch: 9, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.331 Vali Acc: 0.968 Test Loss: 0.331 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0160104
	speed: 0.1546s/iter; left time: 5795.8102s
	iters: 200, epoch: 10 | loss: 0.0003008
	speed: 0.0500s/iter; left time: 1868.5501s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 1862.8264s
	iters: 400, epoch: 10 | loss: 0.0000237
	speed: 0.0453s/iter; left time: 1683.1572s
Epoch: 10 cost time: 23.113710403442383
Epoch: 10, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.327 Vali Acc: 0.969 Test Loss: 0.327 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1128s/iter; left time: 4179.8621s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 1903.5970s
	iters: 300, epoch: 11 | loss: 0.6381472
	speed: 0.0353s/iter; left time: 1301.1116s
	iters: 400, epoch: 11 | loss: 0.0000004
	speed: 0.0377s/iter; left time: 1387.8557s
Epoch: 11 cost time: 17.792646169662476
Epoch: 11, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.460 Vali Acc: 0.964 Test Loss: 0.460 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000018
	speed: 0.1144s/iter; left time: 4194.3946s
	iters: 200, epoch: 12 | loss: 0.0000126
	speed: 0.0425s/iter; left time: 1552.2389s
	iters: 300, epoch: 12 | loss: 0.0000017
	speed: 0.0463s/iter; left time: 1686.4606s
	iters: 400, epoch: 12 | loss: 0.0009170
	speed: 0.0396s/iter; left time: 1439.2026s
Epoch: 12 cost time: 18.169822692871094
Epoch: 12, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.397 Vali Acc: 0.972 Test Loss: 0.397 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1297s/iter; left time: 4702.7187s
	iters: 200, epoch: 13 | loss: 0.0000713
	speed: 0.0741s/iter; left time: 2677.2034s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0743s/iter; left time: 2677.2901s
	iters: 400, epoch: 13 | loss: 0.0000624
	speed: 0.0667s/iter; left time: 2397.1789s
Epoch: 13 cost time: 28.91908597946167
Epoch: 13, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.370 Vali Acc: 0.969 Test Loss: 0.370 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0003643
	speed: 0.1416s/iter; left time: 5072.2713s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0780s/iter; left time: 2787.1494s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 2735.8546s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0781s/iter; left time: 2773.6742s
Epoch: 14 cost time: 31.525411367416382
Epoch: 14, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.383 Vali Acc: 0.969 Test Loss: 0.383 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1508s/iter; left time: 5341.8106s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 2690.7328s
	iters: 300, epoch: 15 | loss: 0.3359432
	speed: 0.0771s/iter; left time: 2716.2585s
	iters: 400, epoch: 15 | loss: 0.0000002
	speed: 0.0667s/iter; left time: 2344.1194s
Epoch: 15 cost time: 31.00158190727234
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.509 Vali Acc: 0.961 Test Loss: 0.509 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.4082166
	speed: 0.1485s/iter; left time: 5198.7231s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 2449.1322s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0748s/iter; left time: 2604.9381s
	iters: 400, epoch: 16 | loss: 0.1627077
	speed: 0.0715s/iter; left time: 2482.6445s
Epoch: 16 cost time: 30.658515453338623
Epoch: 16, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.813 Vali Acc: 0.956 Test Loss: 0.813 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000064
	speed: 0.1399s/iter; left time: 4838.0575s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0734s/iter; left time: 2532.6142s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 2414.2281s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0354s/iter; left time: 1214.2676s
Epoch: 17 cost time: 25.885987520217896
Epoch: 17, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.408 Vali Acc: 0.971 Test Loss: 0.408 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.1004s/iter; left time: 3431.3160s
	iters: 200, epoch: 18 | loss: 0.1536558
	speed: 0.0355s/iter; left time: 1209.3291s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 1307.4585s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 1363.8721s
Epoch: 18 cost time: 15.828648805618286
Epoch: 18, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.414 Vali Acc: 0.971 Test Loss: 0.414 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9722601182355616
model parameter : 221322
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0936198
	speed: 0.0575s/iter; left time: 2368.0625s
	iters: 200, epoch: 1 | loss: 0.0199402
	speed: 0.0366s/iter; left time: 1504.3571s
	iters: 300, epoch: 1 | loss: 0.0427182
	speed: 0.0397s/iter; left time: 1629.3763s
	iters: 400, epoch: 1 | loss: 0.0865832
	speed: 0.0332s/iter; left time: 1356.9682s
Epoch: 1 cost time: 17.469364404678345
Epoch: 1, Steps: 413 | Train Loss: 0.357 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
Validation loss decreased (inf --> -0.947702).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2298013
	speed: 0.1305s/iter; left time: 5321.6869s
	iters: 200, epoch: 2 | loss: 0.0005955
	speed: 0.0687s/iter; left time: 2794.7872s
	iters: 300, epoch: 2 | loss: 0.2937061
	speed: 0.0667s/iter; left time: 2707.7772s
	iters: 400, epoch: 2 | loss: 0.0278982
	speed: 0.0641s/iter; left time: 2594.0430s
Epoch: 2 cost time: 27.692254304885864
Epoch: 2, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.246 Vali Acc: 0.949 Test Loss: 0.246 Test Acc: 0.949
Validation loss decreased (-0.947702 --> -0.948611).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0001844
	speed: 0.1325s/iter; left time: 5350.1947s
	iters: 200, epoch: 3 | loss: 0.0005565
	speed: 0.0649s/iter; left time: 2615.0260s
	iters: 300, epoch: 3 | loss: 0.2181977
	speed: 0.0649s/iter; left time: 2605.7281s
	iters: 400, epoch: 3 | loss: 0.0013204
	speed: 0.0673s/iter; left time: 2695.0922s
Epoch: 3 cost time: 27.13362693786621
Epoch: 3, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.266 Vali Acc: 0.949 Test Loss: 0.266 Test Acc: 0.949
Validation loss decreased (-0.948611 --> -0.949065).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0014839
	speed: 0.1401s/iter; left time: 5600.4428s
	iters: 200, epoch: 4 | loss: 0.0001716
	speed: 0.0666s/iter; left time: 2656.1348s
	iters: 300, epoch: 4 | loss: 0.0000156
	speed: 0.0693s/iter; left time: 2756.7915s
	iters: 400, epoch: 4 | loss: 0.0040456
	speed: 0.0720s/iter; left time: 2854.2771s
Epoch: 4 cost time: 28.8791286945343
Epoch: 4, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.194 Vali Acc: 0.969 Test Loss: 0.194 Test Acc: 0.969
Validation loss decreased (-0.949065 --> -0.968620).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000032
	speed: 0.1430s/iter; left time: 5655.4476s
	iters: 200, epoch: 5 | loss: 0.0000252
	speed: 0.0609s/iter; left time: 2404.1091s
	iters: 300, epoch: 5 | loss: 0.0842497
	speed: 0.0695s/iter; left time: 2736.6590s
	iters: 400, epoch: 5 | loss: 0.0368770
	speed: 0.0684s/iter; left time: 2682.9044s
Epoch: 5 cost time: 28.27590537071228
Epoch: 5, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.219 Vali Acc: 0.973 Test Loss: 0.219 Test Acc: 0.973
Validation loss decreased (-0.968620 --> -0.972713).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000010
	speed: 0.1394s/iter; left time: 5455.7088s
	iters: 200, epoch: 6 | loss: 0.0000151
	speed: 0.0427s/iter; left time: 1666.9057s
	iters: 300, epoch: 6 | loss: 0.0000193
	speed: 0.0424s/iter; left time: 1650.7232s
	iters: 400, epoch: 6 | loss: 0.0476647
	speed: 0.0358s/iter; left time: 1389.9621s
Epoch: 6 cost time: 19.710384845733643
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.311 Vali Acc: 0.965 Test Loss: 0.311 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0111612
	speed: 0.1059s/iter; left time: 4100.2880s
	iters: 200, epoch: 7 | loss: 1.1705211
	speed: 0.0413s/iter; left time: 1596.4706s
	iters: 300, epoch: 7 | loss: 0.0009315
	speed: 0.0323s/iter; left time: 1243.9849s
	iters: 400, epoch: 7 | loss: 0.0000151
	speed: 0.0337s/iter; left time: 1295.1320s
Epoch: 7 cost time: 15.622913360595703
Epoch: 7, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.287 Vali Acc: 0.964 Test Loss: 0.287 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000361
	speed: 0.0923s/iter; left time: 3536.3317s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0328s/iter; left time: 1254.3638s
	iters: 300, epoch: 8 | loss: 0.0009075
	speed: 0.0496s/iter; left time: 1890.2010s
	iters: 400, epoch: 8 | loss: 0.0004917
	speed: 0.0437s/iter; left time: 1659.9560s
Epoch: 8 cost time: 16.661344051361084
Epoch: 8, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.348 Vali Acc: 0.955 Test Loss: 0.348 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000835
	speed: 0.1269s/iter; left time: 4808.6982s
	iters: 200, epoch: 9 | loss: 0.1493093
	speed: 0.0724s/iter; left time: 2734.7794s
	iters: 300, epoch: 9 | loss: 0.0000300
	speed: 0.0781s/iter; left time: 2944.3638s
	iters: 400, epoch: 9 | loss: 0.0006256
	speed: 0.0744s/iter; left time: 2796.3565s
Epoch: 9 cost time: 29.692875385284424
Epoch: 9, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.308 Vali Acc: 0.965 Test Loss: 0.308 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.4639379
	speed: 0.1458s/iter; left time: 5463.6398s
	iters: 200, epoch: 10 | loss: 0.0288659
	speed: 0.0771s/iter; left time: 2880.8803s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0742s/iter; left time: 2765.7895s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0715s/iter; left time: 2660.0627s
Epoch: 10 cost time: 30.979572772979736
Epoch: 10, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.335 Vali Acc: 0.965 Test Loss: 0.335 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0220471
	speed: 0.1423s/iter; left time: 5274.7467s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 2306.3727s
	iters: 300, epoch: 11 | loss: 0.0000009
	speed: 0.0639s/iter; left time: 2356.9315s
	iters: 400, epoch: 11 | loss: 0.0000276
	speed: 0.0659s/iter; left time: 2424.1003s
Epoch: 11 cost time: 27.521978616714478
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.348 Vali Acc: 0.963 Test Loss: 0.348 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1392s/iter; left time: 5104.1501s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.0738s/iter; left time: 2699.5988s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 2385.7437s
	iters: 400, epoch: 12 | loss: 0.0000025
	speed: 0.0729s/iter; left time: 2649.6357s
Epoch: 12 cost time: 29.104693174362183
Epoch: 12, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.423 Vali Acc: 0.960 Test Loss: 0.423 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1459s/iter; left time: 5289.1390s
	iters: 200, epoch: 13 | loss: 0.2673471
	speed: 0.0699s/iter; left time: 2527.5365s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0686s/iter; left time: 2471.2695s
	iters: 400, epoch: 13 | loss: 0.0550391
	speed: 0.0502s/iter; left time: 1803.2803s
Epoch: 13 cost time: 26.77176856994629
Epoch: 13, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.458 Vali Acc: 0.962 Test Loss: 0.458 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000020
	speed: 0.1186s/iter; left time: 4250.9287s
	iters: 200, epoch: 14 | loss: 0.0001414
	speed: 0.0435s/iter; left time: 1554.7580s
	iters: 300, epoch: 14 | loss: 0.0000238
	speed: 0.0384s/iter; left time: 1367.7635s
	iters: 400, epoch: 14 | loss: 0.2508168
	speed: 0.0340s/iter; left time: 1207.1978s
Epoch: 14 cost time: 17.56960654258728
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.507 Vali Acc: 0.957 Test Loss: 0.507 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000015
	speed: 0.0934s/iter; left time: 3308.2917s
	iters: 200, epoch: 15 | loss: 0.0003481
	speed: 0.0533s/iter; left time: 1883.1672s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1666.5808s
	iters: 400, epoch: 15 | loss: 0.0018427
	speed: 0.0444s/iter; left time: 1560.0099s
Epoch: 15 cost time: 19.166842222213745
Epoch: 15, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.615 Vali Acc: 0.960 Test Loss: 0.615 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9727148703956344
model parameter : 154826
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4686231
	speed: 0.0817s/iter; left time: 3364.9987s
	iters: 200, epoch: 1 | loss: 0.0728084
	speed: 0.0669s/iter; left time: 2748.1612s
	iters: 300, epoch: 1 | loss: 0.1937398
	speed: 0.0704s/iter; left time: 2886.9575s
	iters: 400, epoch: 1 | loss: 0.0822419
	speed: 0.0661s/iter; left time: 2703.8440s
Epoch: 1 cost time: 29.60677409172058
Epoch: 1, Steps: 413 | Train Loss: 0.399 Vali Loss: 0.200 Vali Acc: 0.945 Test Loss: 0.200 Test Acc: 0.945
Validation loss decreased (inf --> -0.944973).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4526634
	speed: 0.1332s/iter; left time: 5431.7279s
	iters: 200, epoch: 2 | loss: 0.1996085
	speed: 0.0689s/iter; left time: 2803.7973s
	iters: 300, epoch: 2 | loss: 0.0181289
	speed: 0.0682s/iter; left time: 2767.1642s
	iters: 400, epoch: 2 | loss: 0.0062504
	speed: 0.0691s/iter; left time: 2797.9798s
Epoch: 2 cost time: 28.560715913772583
Epoch: 2, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.128 Vali Acc: 0.966 Test Loss: 0.128 Test Acc: 0.966
Validation loss decreased (-0.944973 --> -0.965892).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0008006
	speed: 0.1409s/iter; left time: 5688.6630s
	iters: 200, epoch: 3 | loss: 0.1378848
	speed: 0.0648s/iter; left time: 2610.8884s
	iters: 300, epoch: 3 | loss: 0.0053661
	speed: 0.0686s/iter; left time: 2757.2200s
	iters: 400, epoch: 3 | loss: 0.2065870
	speed: 0.0712s/iter; left time: 2851.4747s
Epoch: 3 cost time: 28.753061294555664
Epoch: 3, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.158 Vali Acc: 0.964 Test Loss: 0.158 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0219312
	speed: 0.1452s/iter; left time: 5802.1487s
	iters: 200, epoch: 4 | loss: 0.0020253
	speed: 0.0671s/iter; left time: 2674.2545s
	iters: 300, epoch: 4 | loss: 0.0003506
	speed: 0.0722s/iter; left time: 2872.4112s
	iters: 400, epoch: 4 | loss: 0.2016459
	speed: 0.0710s/iter; left time: 2817.9476s
Epoch: 4 cost time: 29.66215467453003
Epoch: 4, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.159 Vali Acc: 0.968 Test Loss: 0.159 Test Acc: 0.968
Validation loss decreased (-0.965892 --> -0.967711).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0013098
	speed: 0.1341s/iter; left time: 5303.4661s
	iters: 200, epoch: 5 | loss: 0.0010187
	speed: 0.0356s/iter; left time: 1403.7492s
	iters: 300, epoch: 5 | loss: 0.0004165
	speed: 0.0471s/iter; left time: 1853.9477s
	iters: 400, epoch: 5 | loss: 0.0840531
	speed: 0.0376s/iter; left time: 1477.4493s
Epoch: 5 cost time: 19.42562222480774
Epoch: 5, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.216 Vali Acc: 0.960 Test Loss: 0.216 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0005032
	speed: 0.1003s/iter; left time: 3924.9809s
	iters: 200, epoch: 6 | loss: 0.0000786
	speed: 0.0423s/iter; left time: 1652.6064s
	iters: 300, epoch: 6 | loss: 0.0000008
	speed: 0.0314s/iter; left time: 1223.8541s
	iters: 400, epoch: 6 | loss: 0.0009995
	speed: 0.0282s/iter; left time: 1095.6354s
Epoch: 6 cost time: 14.507132291793823
Epoch: 6, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.250 Vali Acc: 0.961 Test Loss: 0.250 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1704351
	speed: 0.0934s/iter; left time: 3617.7982s
	iters: 200, epoch: 7 | loss: 0.0030165
	speed: 0.0363s/iter; left time: 1400.7946s
	iters: 300, epoch: 7 | loss: 0.0000005
	speed: 0.0361s/iter; left time: 1391.0260s
	iters: 400, epoch: 7 | loss: 0.0000033
	speed: 0.0351s/iter; left time: 1348.7536s
Epoch: 7 cost time: 14.805206060409546
Epoch: 7, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.187 Vali Acc: 0.969 Test Loss: 0.187 Test Acc: 0.969
Validation loss decreased (-0.967711 --> -0.969075).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.0948s/iter; left time: 3631.0911s
	iters: 200, epoch: 8 | loss: 0.0020225
	speed: 0.0366s/iter; left time: 1397.1475s
	iters: 300, epoch: 8 | loss: 0.0000294
	speed: 0.0612s/iter; left time: 2333.7169s
	iters: 400, epoch: 8 | loss: 0.0003110
	speed: 0.0610s/iter; left time: 2320.5055s
Epoch: 8 cost time: 20.325315952301025
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
Validation loss decreased (-0.969075 --> -0.972713).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000003
	speed: 0.1297s/iter; left time: 4914.3341s
	iters: 200, epoch: 9 | loss: 0.0000015
	speed: 0.0727s/iter; left time: 2749.3373s
	iters: 300, epoch: 9 | loss: 0.0998967
	speed: 0.0689s/iter; left time: 2597.7475s
	iters: 400, epoch: 9 | loss: 0.0000016
	speed: 0.0676s/iter; left time: 2541.9460s
Epoch: 9 cost time: 28.339566469192505
Epoch: 9, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.281 Vali Acc: 0.964 Test Loss: 0.281 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0300141
	speed: 0.1394s/iter; left time: 5224.2404s
	iters: 200, epoch: 10 | loss: 0.0010838
	speed: 0.0736s/iter; left time: 2752.3639s
	iters: 300, epoch: 10 | loss: 0.0000022
	speed: 0.0746s/iter; left time: 2782.8777s
	iters: 400, epoch: 10 | loss: 0.0000091
	speed: 0.0757s/iter; left time: 2814.4545s
Epoch: 10 cost time: 30.693605184555054
Epoch: 10, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.224 Vali Acc: 0.969 Test Loss: 0.224 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0023951
	speed: 0.1390s/iter; left time: 5151.8959s
	iters: 200, epoch: 11 | loss: 0.0000054
	speed: 0.0676s/iter; left time: 2499.2342s
	iters: 300, epoch: 11 | loss: 0.0245949
	speed: 0.0726s/iter; left time: 2676.3639s
	iters: 400, epoch: 11 | loss: 0.0000719
	speed: 0.0708s/iter; left time: 2603.7261s
Epoch: 11 cost time: 29.26811671257019
Epoch: 11, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.286 Vali Acc: 0.968 Test Loss: 0.286 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0002613
	speed: 0.1391s/iter; left time: 5100.8995s
	iters: 200, epoch: 12 | loss: 0.0143473
	speed: 0.0714s/iter; left time: 2610.3383s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0699s/iter; left time: 2548.8812s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0682s/iter; left time: 2479.5924s
Epoch: 12 cost time: 29.33203125
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.972713 --> -0.974986).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1020s/iter; left time: 3697.9076s
	iters: 200, epoch: 13 | loss: 0.0000076
	speed: 0.0384s/iter; left time: 1386.8360s
	iters: 300, epoch: 13 | loss: 0.0000115
	speed: 0.0440s/iter; left time: 1585.4836s
	iters: 400, epoch: 13 | loss: 0.0948383
	speed: 0.0368s/iter; left time: 1324.4018s
Epoch: 13 cost time: 16.198126554489136
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.339 Vali Acc: 0.964 Test Loss: 0.339 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0008110
	speed: 0.1078s/iter; left time: 3863.2876s
	iters: 200, epoch: 14 | loss: 0.0001326
	speed: 0.0399s/iter; left time: 1425.7498s
	iters: 300, epoch: 14 | loss: 0.0000017
	speed: 0.0351s/iter; left time: 1252.3223s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0404s/iter; left time: 1434.4816s
Epoch: 14 cost time: 16.96424412727356
Epoch: 14, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.249 Vali Acc: 0.978 Test Loss: 0.249 Test Acc: 0.978
Validation loss decreased (-0.974986 --> -0.977715).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1011s/iter; left time: 3579.1690s
	iters: 200, epoch: 15 | loss: 0.0119731
	speed: 0.0373s/iter; left time: 1315.7440s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 1607.0734s
	iters: 400, epoch: 15 | loss: 0.1601130
	speed: 0.0426s/iter; left time: 1496.2949s
Epoch: 15 cost time: 17.01743984222412
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.233 Vali Acc: 0.973 Test Loss: 0.233 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000003
	speed: 0.1341s/iter; left time: 4692.6503s
	iters: 200, epoch: 16 | loss: 0.0361081
	speed: 0.0720s/iter; left time: 2514.6048s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 2418.5469s
	iters: 400, epoch: 16 | loss: 0.0001504
	speed: 0.0674s/iter; left time: 2339.4335s
Epoch: 16 cost time: 29.16319751739502
Epoch: 16, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.444 Vali Acc: 0.962 Test Loss: 0.444 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000248
	speed: 0.1322s/iter; left time: 4573.6678s
	iters: 200, epoch: 17 | loss: 0.0000066
	speed: 0.0695s/iter; left time: 2396.5659s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 2311.5344s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0658s/iter; left time: 2257.2575s
Epoch: 17 cost time: 27.97246789932251
Epoch: 17, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.503 Vali Acc: 0.959 Test Loss: 0.503 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0020716
	speed: 0.1297s/iter; left time: 4432.6708s
	iters: 200, epoch: 18 | loss: 0.0000024
	speed: 0.0690s/iter; left time: 2353.0953s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0647s/iter; left time: 2198.3443s
	iters: 400, epoch: 18 | loss: 0.0000084
	speed: 0.0570s/iter; left time: 1932.5758s
Epoch: 18 cost time: 26.31399393081665
Epoch: 18, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.294 Vali Acc: 0.968 Test Loss: 0.294 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000267
	speed: 0.1272s/iter; left time: 4294.3081s
	iters: 200, epoch: 19 | loss: 0.0000034
	speed: 0.0635s/iter; left time: 2138.6554s
	iters: 300, epoch: 19 | loss: 0.0001438
	speed: 0.0642s/iter; left time: 2155.6113s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0635s/iter; left time: 2124.2262s
Epoch: 19 cost time: 26.72628903388977
Epoch: 19, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.450 Vali Acc: 0.965 Test Loss: 0.450 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0317836
	speed: 0.1332s/iter; left time: 4443.4055s
	iters: 200, epoch: 20 | loss: 0.0000010
	speed: 0.0640s/iter; left time: 2129.4852s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 1057.8541s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0334s/iter; left time: 1103.7638s
Epoch: 20 cost time: 20.251302480697632
Epoch: 20, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.290 Vali Acc: 0.973 Test Loss: 0.290 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0948s/iter; left time: 3121.4933s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 1274.5003s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 1293.2790s
	iters: 400, epoch: 21 | loss: 0.0000533
	speed: 0.0434s/iter; left time: 1416.5865s
Epoch: 21 cost time: 16.890156269073486
Epoch: 21, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.310 Vali Acc: 0.972 Test Loss: 0.310 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1049s/iter; left time: 3413.3960s
	iters: 200, epoch: 22 | loss: 0.0000278
	speed: 0.0432s/iter; left time: 1399.9944s
	iters: 300, epoch: 22 | loss: 0.0360377
	speed: 0.0330s/iter; left time: 1065.3507s
	iters: 400, epoch: 22 | loss: 1.2213638
	speed: 0.0435s/iter; left time: 1400.4593s
Epoch: 22 cost time: 17.299301624298096
Epoch: 22, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.424 Vali Acc: 0.967 Test Loss: 0.424 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000043
	speed: 0.1045s/iter; left time: 3356.4314s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 2119.0331s
	iters: 300, epoch: 23 | loss: 0.0000108
	speed: 0.0658s/iter; left time: 2098.4297s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0670s/iter; left time: 2132.4570s
Epoch: 23 cost time: 25.39652180671692
Epoch: 23, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.373 Vali Acc: 0.973 Test Loss: 0.373 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000002
	speed: 0.1343s/iter; left time: 4257.2336s
	iters: 200, epoch: 24 | loss: 0.0000002
	speed: 0.0694s/iter; left time: 2193.0084s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0623s/iter; left time: 1961.6246s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0674s/iter; left time: 2115.2919s
Epoch: 24 cost time: 27.691884994506836
Epoch: 24, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.327 Vali Acc: 0.973 Test Loss: 0.327 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 121610
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5970358
	speed: 0.0486s/iter; left time: 2003.9701s
	iters: 200, epoch: 1 | loss: 0.2739718
	speed: 0.0346s/iter; left time: 1422.5928s
	iters: 300, epoch: 1 | loss: 0.0668510
	speed: 0.0366s/iter; left time: 1498.7496s
	iters: 400, epoch: 1 | loss: 0.1114929
	speed: 0.0317s/iter; left time: 1296.2361s
Epoch: 1 cost time: 15.616752624511719
Epoch: 1, Steps: 413 | Train Loss: 0.431 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
Validation loss decreased (inf --> -0.951340).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0249014
	speed: 0.0998s/iter; left time: 4068.9852s
	iters: 200, epoch: 2 | loss: 0.2792177
	speed: 0.0330s/iter; left time: 1341.4910s
	iters: 300, epoch: 2 | loss: 0.1082802
	speed: 0.0349s/iter; left time: 1416.8320s
	iters: 400, epoch: 2 | loss: 0.0665841
	speed: 0.0341s/iter; left time: 1379.2575s
Epoch: 2 cost time: 14.449860334396362
Epoch: 2, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
Validation loss decreased (-0.951340 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0056268
	speed: 0.0972s/iter; left time: 3926.2310s
	iters: 200, epoch: 3 | loss: 0.0047193
	speed: 0.0330s/iter; left time: 1330.2968s
	iters: 300, epoch: 3 | loss: 0.2045371
	speed: 0.0316s/iter; left time: 1269.8136s
	iters: 400, epoch: 3 | loss: 0.0020199
	speed: 0.0338s/iter; left time: 1356.3538s
Epoch: 3 cost time: 14.181884765625
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1364120
	speed: 0.0921s/iter; left time: 3681.5109s
	iters: 200, epoch: 4 | loss: 0.0027776
	speed: 0.0323s/iter; left time: 1288.5498s
	iters: 300, epoch: 4 | loss: 0.0010370
	speed: 0.0362s/iter; left time: 1441.1082s
	iters: 400, epoch: 4 | loss: 0.0015057
	speed: 0.0328s/iter; left time: 1302.1089s
Epoch: 4 cost time: 13.94253945350647
Epoch: 4, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0100003
	speed: 0.0911s/iter; left time: 3603.0605s
	iters: 200, epoch: 5 | loss: 0.0001844
	speed: 0.0276s/iter; left time: 1089.5355s
	iters: 300, epoch: 5 | loss: 0.0000794
	speed: 0.0268s/iter; left time: 1055.5363s
	iters: 400, epoch: 5 | loss: 0.6691865
	speed: 0.0268s/iter; left time: 1053.6396s
Epoch: 5 cost time: 11.62858533859253
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.239 Vali Acc: 0.956 Test Loss: 0.239 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0015858
	speed: 0.0942s/iter; left time: 3686.6434s
	iters: 200, epoch: 6 | loss: 0.0011419
	speed: 0.0274s/iter; left time: 1071.3760s
	iters: 300, epoch: 6 | loss: 0.8023117
	speed: 0.0284s/iter; left time: 1107.3968s
	iters: 400, epoch: 6 | loss: 0.0824210
	speed: 0.0274s/iter; left time: 1064.8516s
Epoch: 6 cost time: 11.958007335662842
Epoch: 6, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0002024
	speed: 0.0892s/iter; left time: 3453.8054s
	iters: 200, epoch: 7 | loss: 0.0074663
	speed: 0.0292s/iter; left time: 1127.6471s
	iters: 300, epoch: 7 | loss: 0.0006274
	speed: 0.0284s/iter; left time: 1093.2154s
	iters: 400, epoch: 7 | loss: 0.0010296
	speed: 0.0271s/iter; left time: 1042.3019s
Epoch: 7 cost time: 11.909576177597046
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.206 Vali Acc: 0.965 Test Loss: 0.206 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000111
	speed: 0.0898s/iter; left time: 3440.7107s
	iters: 200, epoch: 8 | loss: 0.0000873
	speed: 0.0287s/iter; left time: 1097.1450s
	iters: 300, epoch: 8 | loss: 0.0000001
	speed: 0.0344s/iter; left time: 1310.2696s
	iters: 400, epoch: 8 | loss: 0.0000216
	speed: 0.0320s/iter; left time: 1217.2358s
Epoch: 8 cost time: 13.02971887588501
Epoch: 8, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
Validation loss decreased (-0.968621 --> -0.970894).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000002
	speed: 0.0941s/iter; left time: 3567.2278s
	iters: 200, epoch: 9 | loss: 0.0000003
	speed: 0.0319s/iter; left time: 1207.5353s
	iters: 300, epoch: 9 | loss: 0.0038231
	speed: 0.0327s/iter; left time: 1231.6319s
	iters: 400, epoch: 9 | loss: 0.0974858
	speed: 0.0311s/iter; left time: 1168.6215s
Epoch: 9 cost time: 13.48915719985962
Epoch: 9, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
Validation loss decreased (-0.970894 --> -0.972258).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000592
	speed: 0.1011s/iter; left time: 3790.3015s
	iters: 200, epoch: 10 | loss: 0.3495060
	speed: 0.0437s/iter; left time: 1633.3448s
	iters: 300, epoch: 10 | loss: 0.2673948
	speed: 0.0412s/iter; left time: 1534.7516s
	iters: 400, epoch: 10 | loss: 0.0000002
	speed: 0.0376s/iter; left time: 1396.8147s
Epoch: 10 cost time: 17.041395902633667
Epoch: 10, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.179 Vali Acc: 0.979 Test Loss: 0.179 Test Acc: 0.979
Validation loss decreased (-0.972258 --> -0.978625).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1173s/iter; left time: 4347.5725s
	iters: 200, epoch: 11 | loss: 0.0615048
	speed: 0.0412s/iter; left time: 1523.7667s
	iters: 300, epoch: 11 | loss: 0.0682457
	speed: 0.0380s/iter; left time: 1399.7777s
	iters: 400, epoch: 11 | loss: 0.0000002
	speed: 0.0406s/iter; left time: 1492.1022s
Epoch: 11 cost time: 17.634694814682007
Epoch: 11, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0017528
	speed: 0.1120s/iter; left time: 4107.3842s
	iters: 200, epoch: 12 | loss: 0.0000010
	speed: 0.0395s/iter; left time: 1442.8567s
	iters: 300, epoch: 12 | loss: 0.0000009
	speed: 0.0376s/iter; left time: 1369.5436s
	iters: 400, epoch: 12 | loss: 0.0030017
	speed: 0.0461s/iter; left time: 1676.6390s
Epoch: 12 cost time: 17.491108417510986
Epoch: 12, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.242 Vali Acc: 0.965 Test Loss: 0.242 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0011738
	speed: 0.1074s/iter; left time: 3892.7069s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 1471.7215s
	iters: 300, epoch: 13 | loss: 0.0000034
	speed: 0.0466s/iter; left time: 1679.1612s
	iters: 400, epoch: 13 | loss: 0.0000403
	speed: 0.0463s/iter; left time: 1664.0237s
Epoch: 13 cost time: 18.151360750198364
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.162 Vali Acc: 0.981 Test Loss: 0.162 Test Acc: 0.981
Validation loss decreased (-0.978625 --> -0.980899).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.1056s/iter; left time: 3782.6590s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1620.9092s
	iters: 300, epoch: 14 | loss: 0.0000014
	speed: 0.0429s/iter; left time: 1528.2261s
	iters: 400, epoch: 14 | loss: 0.0000060
	speed: 0.0369s/iter; left time: 1310.0728s
Epoch: 14 cost time: 17.11482882499695
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.985 Test Loss: 0.098 Test Acc: 0.985
Validation loss decreased (-0.980899 --> -0.985447).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0200541
	speed: 0.1102s/iter; left time: 3901.7573s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1519.5086s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 1365.1815s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0380s/iter; left time: 1334.0843s
Epoch: 15 cost time: 17.202104330062866
Epoch: 15, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.266 Vali Acc: 0.965 Test Loss: 0.266 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0002092
	speed: 0.1146s/iter; left time: 4010.9340s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.0372s/iter; left time: 1299.8645s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 1072.2165s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 1156.1415s
Epoch: 16 cost time: 15.543533563613892
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.200 Vali Acc: 0.976 Test Loss: 0.200 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0103513
	speed: 0.0997s/iter; left time: 3449.5590s
	iters: 200, epoch: 17 | loss: 0.0000047
	speed: 0.0307s/iter; left time: 1059.2458s
	iters: 300, epoch: 17 | loss: 0.0000002
	speed: 0.0300s/iter; left time: 1031.0270s
	iters: 400, epoch: 17 | loss: 0.0000405
	speed: 0.0362s/iter; left time: 1242.9026s
Epoch: 17 cost time: 13.649778842926025
Epoch: 17, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.172 Vali Acc: 0.979 Test Loss: 0.172 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0959s/iter; left time: 3278.6423s
	iters: 200, epoch: 18 | loss: 0.0000046
	speed: 0.0305s/iter; left time: 1039.4487s
	iters: 300, epoch: 18 | loss: 0.0000004
	speed: 0.0349s/iter; left time: 1185.1512s
	iters: 400, epoch: 18 | loss: 0.0000003
	speed: 0.0348s/iter; left time: 1180.2358s
Epoch: 18 cost time: 13.827841520309448
Epoch: 18, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.236 Vali Acc: 0.972 Test Loss: 0.236 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0968s/iter; left time: 3267.7669s
	iters: 200, epoch: 19 | loss: 0.0000352
	speed: 0.0330s/iter; left time: 1111.5855s
	iters: 300, epoch: 19 | loss: 0.0000041
	speed: 0.0377s/iter; left time: 1264.1966s
	iters: 400, epoch: 19 | loss: 0.0017035
	speed: 0.0339s/iter; left time: 1135.6115s
Epoch: 19 cost time: 14.19984745979309
Epoch: 19, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.292 Vali Acc: 0.978 Test Loss: 0.292 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0004968
	speed: 0.0995s/iter; left time: 3319.5129s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0404s/iter; left time: 1342.4864s
	iters: 300, epoch: 20 | loss: 0.0001287
	speed: 0.0415s/iter; left time: 1375.9494s
	iters: 400, epoch: 20 | loss: 0.0009608
	speed: 0.0395s/iter; left time: 1305.9239s
Epoch: 20 cost time: 16.437546730041504
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.324 Vali Acc: 0.965 Test Loss: 0.324 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000009
	speed: 0.1149s/iter; left time: 3784.8448s
	iters: 200, epoch: 21 | loss: 0.0031050
	speed: 0.0397s/iter; left time: 1304.7774s
	iters: 300, epoch: 21 | loss: 0.6073111
	speed: 0.0363s/iter; left time: 1189.0995s
	iters: 400, epoch: 21 | loss: 0.0000218
	speed: 0.0393s/iter; left time: 1282.8365s
Epoch: 21 cost time: 16.857200384140015
Epoch: 21, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.131 Vali Acc: 0.984 Test Loss: 0.131 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.1109s/iter; left time: 3606.1470s
	iters: 200, epoch: 22 | loss: 0.0000168
	speed: 0.0382s/iter; left time: 1239.1628s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 1189.4098s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0393s/iter; left time: 1266.9726s
Epoch: 22 cost time: 16.59931969642639
Epoch: 22, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.183 Vali Acc: 0.979 Test Loss: 0.183 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0058622
	speed: 0.1087s/iter; left time: 3491.2802s
	iters: 200, epoch: 23 | loss: 0.0000001
	speed: 0.0372s/iter; left time: 1191.6588s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 1297.0657s
	iters: 400, epoch: 23 | loss: 0.0000110
	speed: 0.0440s/iter; left time: 1400.1549s
Epoch: 23 cost time: 16.876123189926147
Epoch: 23, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.274 Vali Acc: 0.979 Test Loss: 0.274 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0232568
	speed: 0.1058s/iter; left time: 3355.5656s
	iters: 200, epoch: 24 | loss: 0.0000002
	speed: 0.0399s/iter; left time: 1260.4125s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 1445.9693s
	iters: 400, epoch: 24 | loss: 0.0000783
	speed: 0.0396s/iter; left time: 1243.9091s
Epoch: 24 cost time: 16.943896770477295
Epoch: 24, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.168 Vali Acc: 0.978 Test Loss: 0.168 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 100906
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2844789
	speed: 0.0553s/iter; left time: 2278.6299s
	iters: 200, epoch: 1 | loss: 0.0625157
	speed: 0.0425s/iter; left time: 1746.8355s
	iters: 300, epoch: 1 | loss: 0.3310999
	speed: 0.0455s/iter; left time: 1863.5360s
	iters: 400, epoch: 1 | loss: 0.2403226
	speed: 0.0419s/iter; left time: 1714.9393s
Epoch: 1 cost time: 19.12136149406433
Epoch: 1, Steps: 413 | Train Loss: 0.473 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (inf --> -0.969531).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0441663
	speed: 0.1100s/iter; left time: 4487.7581s
	iters: 200, epoch: 2 | loss: 0.0073222
	speed: 0.0448s/iter; left time: 1824.0404s
	iters: 300, epoch: 2 | loss: 0.0227005
	speed: 0.0421s/iter; left time: 1708.1123s
	iters: 400, epoch: 2 | loss: 0.1765822
	speed: 0.0380s/iter; left time: 1538.8177s
Epoch: 2 cost time: 17.62181782722473
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.080 Vali Acc: 0.971 Test Loss: 0.080 Test Acc: 0.971
Validation loss decreased (-0.969531 --> -0.970895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0002958
	speed: 0.1161s/iter; left time: 4686.4737s
	iters: 200, epoch: 3 | loss: 0.0487060
	speed: 0.0405s/iter; left time: 1630.5898s
	iters: 300, epoch: 3 | loss: 0.0003597
	speed: 0.0382s/iter; left time: 1533.6706s
	iters: 400, epoch: 3 | loss: 0.0102551
	speed: 0.0385s/iter; left time: 1542.0250s
Epoch: 3 cost time: 17.117613792419434
Epoch: 3, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.970895 --> -0.975897).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0004277
	speed: 0.0860s/iter; left time: 3436.8229s
	iters: 200, epoch: 4 | loss: 0.0011718
	speed: 0.0268s/iter; left time: 1068.9643s
	iters: 300, epoch: 4 | loss: 0.0176273
	speed: 0.0260s/iter; left time: 1033.4142s
	iters: 400, epoch: 4 | loss: 0.1765709
	speed: 0.0270s/iter; left time: 1069.4082s
Epoch: 4 cost time: 11.341793775558472
Epoch: 4, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0002694
	speed: 0.0883s/iter; left time: 3493.5204s
	iters: 200, epoch: 5 | loss: 0.0014631
	speed: 0.0284s/iter; left time: 1119.1831s
	iters: 300, epoch: 5 | loss: 0.0044925
	speed: 0.0288s/iter; left time: 1133.9779s
	iters: 400, epoch: 5 | loss: 0.0031867
	speed: 0.0305s/iter; left time: 1198.1627s
Epoch: 5 cost time: 12.13086199760437
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.206 Vali Acc: 0.962 Test Loss: 0.206 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0006481
	speed: 0.0890s/iter; left time: 3484.9610s
	iters: 200, epoch: 6 | loss: 0.0162469
	speed: 0.0282s/iter; left time: 1099.8484s
	iters: 300, epoch: 6 | loss: 0.0096863
	speed: 0.0304s/iter; left time: 1183.2588s
	iters: 400, epoch: 6 | loss: 0.0000263
	speed: 0.0291s/iter; left time: 1128.6051s
Epoch: 6 cost time: 12.473106622695923
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000082
	speed: 0.0935s/iter; left time: 3619.9937s
	iters: 200, epoch: 7 | loss: 0.0000261
	speed: 0.0324s/iter; left time: 1251.1200s
	iters: 300, epoch: 7 | loss: 0.0320738
	speed: 0.0286s/iter; left time: 1103.1102s
	iters: 400, epoch: 7 | loss: 0.0001821
	speed: 0.0317s/iter; left time: 1219.0902s
Epoch: 7 cost time: 13.020831823348999
Epoch: 7, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000131
	speed: 0.1026s/iter; left time: 3929.8278s
	iters: 200, epoch: 8 | loss: 0.0000185
	speed: 0.0360s/iter; left time: 1374.7168s
	iters: 300, epoch: 8 | loss: 0.0007300
	speed: 0.0352s/iter; left time: 1339.6117s
	iters: 400, epoch: 8 | loss: 0.0015710
	speed: 0.0350s/iter; left time: 1332.1459s
Epoch: 8 cost time: 15.217113256454468
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.975897 --> -0.977261).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0014491
	speed: 0.0993s/iter; left time: 3764.4829s
	iters: 200, epoch: 9 | loss: 0.0037873
	speed: 0.0330s/iter; left time: 1248.1989s
	iters: 300, epoch: 9 | loss: 0.0013203
	speed: 0.0341s/iter; left time: 1286.8125s
	iters: 400, epoch: 9 | loss: 0.0000008
	speed: 0.0380s/iter; left time: 1430.1255s
Epoch: 9 cost time: 14.809890270233154
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.168 Vali Acc: 0.971 Test Loss: 0.168 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2451722
	speed: 0.1016s/iter; left time: 3807.2885s
	iters: 200, epoch: 10 | loss: 0.0005408
	speed: 0.0353s/iter; left time: 1321.2011s
	iters: 300, epoch: 10 | loss: 0.0006040
	speed: 0.0373s/iter; left time: 1392.2138s
	iters: 400, epoch: 10 | loss: 0.0837510
	speed: 0.0368s/iter; left time: 1369.7390s
Epoch: 10 cost time: 15.089822769165039
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000010
	speed: 0.1080s/iter; left time: 4002.2214s
	iters: 200, epoch: 11 | loss: 0.0000004
	speed: 0.0369s/iter; left time: 1363.5235s
	iters: 300, epoch: 11 | loss: 0.0009115
	speed: 0.0354s/iter; left time: 1306.7580s
	iters: 400, epoch: 11 | loss: 0.0000123
	speed: 0.0336s/iter; left time: 1234.9489s
Epoch: 11 cost time: 15.095662117004395
Epoch: 11, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.220 Vali Acc: 0.968 Test Loss: 0.220 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0002072
	speed: 0.1032s/iter; left time: 3783.8966s
	iters: 200, epoch: 12 | loss: 0.0018845
	speed: 0.0346s/iter; left time: 1263.6146s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0343s/iter; left time: 1251.2815s
	iters: 400, epoch: 12 | loss: 0.0000003
	speed: 0.0364s/iter; left time: 1323.8810s
Epoch: 12 cost time: 15.05368685722351
Epoch: 12, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
Validation loss decreased (-0.977261 --> -0.984538).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000013
	speed: 0.0976s/iter; left time: 3536.4379s
	iters: 200, epoch: 13 | loss: 0.0000027
	speed: 0.0350s/iter; left time: 1266.4145s
	iters: 300, epoch: 13 | loss: 0.0000120
	speed: 0.0368s/iter; left time: 1324.7810s
	iters: 400, epoch: 13 | loss: 0.0000123
	speed: 0.0373s/iter; left time: 1339.8546s
Epoch: 13 cost time: 15.165017127990723
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.289 Vali Acc: 0.969 Test Loss: 0.289 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000206
	speed: 0.1035s/iter; left time: 3708.4971s
	iters: 200, epoch: 14 | loss: 0.0129331
	speed: 0.0369s/iter; left time: 1317.4935s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 1334.1623s
	iters: 400, epoch: 14 | loss: 0.0000013
	speed: 0.0353s/iter; left time: 1254.1691s
Epoch: 14 cost time: 15.412575244903564
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1025s/iter; left time: 3629.7133s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 1302.5954s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 1239.6556s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 1089.3554s
Epoch: 15 cost time: 14.79798173904419
Epoch: 15, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.225 Vali Acc: 0.970 Test Loss: 0.225 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0006903
	speed: 0.0884s/iter; left time: 3092.9258s
	iters: 200, epoch: 16 | loss: 0.0187976
	speed: 0.0259s/iter; left time: 902.6673s
	iters: 300, epoch: 16 | loss: 0.0000063
	speed: 0.0254s/iter; left time: 882.8692s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 894.9501s
Epoch: 16 cost time: 11.12429690361023
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0858460
	speed: 0.0864s/iter; left time: 2990.4568s
	iters: 200, epoch: 17 | loss: 0.0000007
	speed: 0.0257s/iter; left time: 884.9569s
	iters: 300, epoch: 17 | loss: 0.2737248
	speed: 0.0244s/iter; left time: 837.5054s
	iters: 400, epoch: 17 | loss: 0.0002625
	speed: 0.0302s/iter; left time: 1036.2432s
Epoch: 17 cost time: 11.513170719146729
Epoch: 17, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.255 Vali Acc: 0.969 Test Loss: 0.255 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0147213
	speed: 0.0895s/iter; left time: 3057.7526s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.0269s/iter; left time: 916.0510s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 898.8348s
	iters: 400, epoch: 18 | loss: 0.0132183
	speed: 0.0270s/iter; left time: 913.3120s
Epoch: 18 cost time: 11.584320306777954
Epoch: 18, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.211 Vali Acc: 0.975 Test Loss: 0.211 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4918232
	speed: 0.0912s/iter; left time: 3080.3252s
	iters: 200, epoch: 19 | loss: 0.0000519
	speed: 0.0292s/iter; left time: 982.3506s
	iters: 300, epoch: 19 | loss: 0.0000003
	speed: 0.0350s/iter; left time: 1173.7982s
	iters: 400, epoch: 19 | loss: 0.5904588
	speed: 0.0355s/iter; left time: 1188.6917s
Epoch: 19 cost time: 13.75009298324585
Epoch: 19, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.269 Vali Acc: 0.971 Test Loss: 0.269 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0997s/iter; left time: 3324.6384s
	iters: 200, epoch: 20 | loss: 0.0001065
	speed: 0.0357s/iter; left time: 1187.2359s
	iters: 300, epoch: 20 | loss: 0.0000001
	speed: 0.0385s/iter; left time: 1277.9792s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0345s/iter; left time: 1141.0392s
Epoch: 20 cost time: 15.255149364471436
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.428 Vali Acc: 0.964 Test Loss: 0.428 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000034
	speed: 0.1013s/iter; left time: 3337.6541s
	iters: 200, epoch: 21 | loss: 0.0000023
	speed: 0.0353s/iter; left time: 1157.9594s
	iters: 300, epoch: 21 | loss: 0.0041202
	speed: 0.0377s/iter; left time: 1234.2626s
	iters: 400, epoch: 21 | loss: 0.0000015
	speed: 0.0386s/iter; left time: 1260.3555s
Epoch: 21 cost time: 15.702877044677734
Epoch: 21, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.312 Vali Acc: 0.968 Test Loss: 0.312 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0999s/iter; left time: 3248.1911s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 1183.4841s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 1243.7972s
	iters: 400, epoch: 22 | loss: 0.0000378
	speed: 0.0391s/iter; left time: 1259.5988s
Epoch: 22 cost time: 15.943963766098022
Epoch: 22, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.978 Test Loss: 0.175 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 80234
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9105996
	speed: 0.0535s/iter; left time: 2203.1852s
	iters: 200, epoch: 1 | loss: 0.5586829
	speed: 0.0367s/iter; left time: 1506.4275s
	iters: 300, epoch: 1 | loss: 0.0213940
	speed: 0.0370s/iter; left time: 1516.4156s
	iters: 400, epoch: 1 | loss: 0.0711071
	speed: 0.0345s/iter; left time: 1412.2789s
Epoch: 1 cost time: 16.70228910446167
Epoch: 1, Steps: 413 | Train Loss: 0.505 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1128226
	speed: 0.0989s/iter; left time: 4033.8987s
	iters: 200, epoch: 2 | loss: 0.2267579
	speed: 0.0343s/iter; left time: 1393.7899s
	iters: 300, epoch: 2 | loss: 0.0008759
	speed: 0.0325s/iter; left time: 1319.0523s
	iters: 400, epoch: 2 | loss: 0.0061100
	speed: 0.0367s/iter; left time: 1485.6293s
Epoch: 2 cost time: 14.698977708816528
Epoch: 2, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.124 Vali Acc: 0.960 Test Loss: 0.124 Test Acc: 0.960
Validation loss decreased (-0.957252 --> -0.959526).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0484638
	speed: 0.1018s/iter; left time: 4109.1760s
	iters: 200, epoch: 3 | loss: 0.0505908
	speed: 0.0344s/iter; left time: 1386.5775s
	iters: 300, epoch: 3 | loss: 0.0032465
	speed: 0.0356s/iter; left time: 1428.5141s
	iters: 400, epoch: 3 | loss: 0.0010399
	speed: 0.0373s/iter; left time: 1494.5703s
Epoch: 3 cost time: 15.155600547790527
Epoch: 3, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
Validation loss decreased (-0.959526 --> -0.971804).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0273317
	speed: 0.0991s/iter; left time: 3959.7431s
	iters: 200, epoch: 4 | loss: 0.0127570
	speed: 0.0358s/iter; left time: 1427.5210s
	iters: 300, epoch: 4 | loss: 0.0277274
	speed: 0.0342s/iter; left time: 1359.2230s
	iters: 400, epoch: 4 | loss: 0.0001520
	speed: 0.0340s/iter; left time: 1347.8571s
Epoch: 4 cost time: 14.62182903289795
Epoch: 4, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0026171
	speed: 0.0938s/iter; left time: 3710.7737s
	iters: 200, epoch: 5 | loss: 0.0078491
	speed: 0.0295s/iter; left time: 1164.9408s
	iters: 300, epoch: 5 | loss: 0.0108359
	speed: 0.0265s/iter; left time: 1042.1996s
	iters: 400, epoch: 5 | loss: 0.0004252
	speed: 0.0275s/iter; left time: 1080.6106s
Epoch: 5 cost time: 11.97043228149414
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.971804 --> -0.973623).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0035415
	speed: 0.0903s/iter; left time: 3534.7074s
	iters: 200, epoch: 6 | loss: 0.0135928
	speed: 0.0275s/iter; left time: 1072.9031s
	iters: 300, epoch: 6 | loss: 0.0013656
	speed: 0.0268s/iter; left time: 1043.7425s
	iters: 400, epoch: 6 | loss: 0.0003343
	speed: 0.0230s/iter; left time: 892.8605s
Epoch: 6 cost time: 11.180051326751709
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
Validation loss decreased (-0.973623 --> -0.974078).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0010134
	speed: 0.0830s/iter; left time: 3215.3678s
	iters: 200, epoch: 7 | loss: 0.0000028
	speed: 0.0287s/iter; left time: 1108.4315s
	iters: 300, epoch: 7 | loss: 0.0392369
	speed: 0.0276s/iter; left time: 1061.8024s
	iters: 400, epoch: 7 | loss: 0.0000028
	speed: 0.0289s/iter; left time: 1109.5185s
Epoch: 7 cost time: 11.812758207321167
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0019916
	speed: 0.0881s/iter; left time: 3376.3040s
	iters: 200, epoch: 8 | loss: 0.1383707
	speed: 0.0277s/iter; left time: 1057.7551s
	iters: 300, epoch: 8 | loss: 0.0003356
	speed: 0.0320s/iter; left time: 1221.1027s
	iters: 400, epoch: 8 | loss: 0.0013724
	speed: 0.0324s/iter; left time: 1230.2933s
Epoch: 8 cost time: 12.75211215019226
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0036307
	speed: 0.1001s/iter; left time: 3795.1819s
	iters: 200, epoch: 9 | loss: 0.0056008
	speed: 0.0352s/iter; left time: 1331.7283s
	iters: 300, epoch: 9 | loss: 0.0000017
	speed: 0.0365s/iter; left time: 1374.1053s
	iters: 400, epoch: 9 | loss: 0.4060934
	speed: 0.0360s/iter; left time: 1353.7280s
Epoch: 9 cost time: 15.224373579025269
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0072492
	speed: 0.0981s/iter; left time: 3678.0773s
	iters: 200, epoch: 10 | loss: 0.0131751
	speed: 0.0326s/iter; left time: 1219.7532s
	iters: 300, epoch: 10 | loss: 0.0000008
	speed: 0.0324s/iter; left time: 1206.4866s
	iters: 400, epoch: 10 | loss: 0.0000010
	speed: 0.0357s/iter; left time: 1328.7707s
Epoch: 10 cost time: 14.40538501739502
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0429882
	speed: 0.0975s/iter; left time: 3614.6615s
	iters: 200, epoch: 11 | loss: 0.0000034
	speed: 0.0354s/iter; left time: 1307.8338s
	iters: 300, epoch: 11 | loss: 0.0001048
	speed: 0.0350s/iter; left time: 1289.3394s
	iters: 400, epoch: 11 | loss: 0.0034869
	speed: 0.0367s/iter; left time: 1348.0367s
Epoch: 11 cost time: 14.970532417297363
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.187 Vali Acc: 0.971 Test Loss: 0.187 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000004
	speed: 0.1012s/iter; left time: 3708.9483s
	iters: 200, epoch: 12 | loss: 0.0000840
	speed: 0.0371s/iter; left time: 1356.5821s
	iters: 300, epoch: 12 | loss: 0.0000008
	speed: 0.0341s/iter; left time: 1244.5527s
	iters: 400, epoch: 12 | loss: 0.0000010
	speed: 0.0332s/iter; left time: 1206.0689s
Epoch: 12 cost time: 14.910703420639038
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
Validation loss decreased (-0.974078 --> -0.976352).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0012824
	speed: 0.1004s/iter; left time: 3637.6459s
	iters: 200, epoch: 13 | loss: 0.0000494
	speed: 0.0368s/iter; left time: 1329.5393s
	iters: 300, epoch: 13 | loss: 0.0000046
	speed: 0.0329s/iter; left time: 1184.8990s
	iters: 400, epoch: 13 | loss: 0.0000008
	speed: 0.0349s/iter; left time: 1254.7111s
Epoch: 13 cost time: 14.786758661270142
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000203
	speed: 0.0974s/iter; left time: 3488.7079s
	iters: 200, epoch: 14 | loss: 0.0000028
	speed: 0.0336s/iter; left time: 1199.3376s
	iters: 300, epoch: 14 | loss: 0.0003057
	speed: 0.0371s/iter; left time: 1320.8290s
	iters: 400, epoch: 14 | loss: 0.0002231
	speed: 0.0356s/iter; left time: 1264.2682s
Epoch: 14 cost time: 14.948749303817749
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000721
	speed: 0.0996s/iter; left time: 3526.8712s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 1231.2641s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0367s/iter; left time: 1293.2198s
	iters: 400, epoch: 15 | loss: 0.0001720
	speed: 0.0363s/iter; left time: 1274.3330s
Epoch: 15 cost time: 14.950850248336792
Epoch: 15, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.218 Vali Acc: 0.968 Test Loss: 0.218 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0022811
	speed: 0.1016s/iter; left time: 3556.4006s
	iters: 200, epoch: 16 | loss: 0.0000288
	speed: 0.0353s/iter; left time: 1232.5493s
	iters: 300, epoch: 16 | loss: 0.0000383
	speed: 0.0299s/iter; left time: 1041.1434s
	iters: 400, epoch: 16 | loss: 0.0153241
	speed: 0.0277s/iter; left time: 960.5573s
Epoch: 16 cost time: 13.869260311126709
Epoch: 16, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
Validation loss decreased (-0.976352 --> -0.977716).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.3148763
	speed: 0.0821s/iter; left time: 2840.9913s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 944.0064s
	iters: 300, epoch: 17 | loss: 0.0325868
	speed: 0.0245s/iter; left time: 841.4885s
	iters: 400, epoch: 17 | loss: 0.0000594
	speed: 0.0248s/iter; left time: 851.6882s
Epoch: 17 cost time: 11.041456937789917
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0856s/iter; left time: 2925.4987s
	iters: 200, epoch: 18 | loss: 0.0000328
	speed: 0.0261s/iter; left time: 888.3932s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0278s/iter; left time: 945.0744s
	iters: 400, epoch: 18 | loss: 0.0000021
	speed: 0.0262s/iter; left time: 886.7929s
Epoch: 18 cost time: 11.43318223953247
Epoch: 18, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0887s/iter; left time: 2995.0895s
	iters: 200, epoch: 19 | loss: 0.0000180
	speed: 0.0261s/iter; left time: 877.5600s
	iters: 300, epoch: 19 | loss: 0.0004294
	speed: 0.0272s/iter; left time: 911.9915s
	iters: 400, epoch: 19 | loss: 0.0000041
	speed: 0.0277s/iter; left time: 926.7927s
Epoch: 19 cost time: 11.544745445251465
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0948s/iter; left time: 3160.6497s
	iters: 200, epoch: 20 | loss: 0.0000003
	speed: 0.0314s/iter; left time: 1042.6260s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 1130.2995s
	iters: 400, epoch: 20 | loss: 0.0000040
	speed: 0.0357s/iter; left time: 1180.3221s
Epoch: 20 cost time: 13.932498216629028
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.204 Vali Acc: 0.973 Test Loss: 0.204 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.1042s/iter; left time: 3431.6497s
	iters: 200, epoch: 21 | loss: 0.0000009
	speed: 0.0360s/iter; left time: 1183.0450s
	iters: 300, epoch: 21 | loss: 0.0000608
	speed: 0.0327s/iter; left time: 1071.9040s
	iters: 400, epoch: 21 | loss: 0.0000414
	speed: 0.0318s/iter; left time: 1036.9976s
Epoch: 21 cost time: 14.418509721755981
Epoch: 21, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.973 Test Loss: 0.189 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0008377
	speed: 0.1002s/iter; left time: 3260.2454s
	iters: 200, epoch: 22 | loss: 0.0002295
	speed: 0.0359s/iter; left time: 1164.7640s
	iters: 300, epoch: 22 | loss: 0.0069140
	speed: 0.0316s/iter; left time: 1022.0294s
	iters: 400, epoch: 22 | loss: 0.0001918
	speed: 0.0318s/iter; left time: 1026.2137s
Epoch: 22 cost time: 14.177692651748657
Epoch: 22, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.242 Vali Acc: 0.969 Test Loss: 0.242 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0051870
	speed: 0.0961s/iter; left time: 3085.2123s
	iters: 200, epoch: 23 | loss: 0.0000005
	speed: 0.0318s/iter; left time: 1016.6797s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 1126.1334s
	iters: 400, epoch: 23 | loss: 0.0000131
	speed: 0.0341s/iter; left time: 1086.0933s
Epoch: 23 cost time: 14.148441314697266
Epoch: 23, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.217 Vali Acc: 0.970 Test Loss: 0.217 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0001347
	speed: 0.0953s/iter; left time: 3021.2273s
	iters: 200, epoch: 24 | loss: 0.0000001
	speed: 0.0312s/iter; left time: 985.0484s
	iters: 300, epoch: 24 | loss: 0.0000146
	speed: 0.0311s/iter; left time: 979.6979s
	iters: 400, epoch: 24 | loss: 0.0000251
	speed: 0.0305s/iter; left time: 957.3458s
Epoch: 24 cost time: 13.116375207901001
Epoch: 24, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.245 Vali Acc: 0.972 Test Loss: 0.245 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0972s/iter; left time: 3041.9149s
	iters: 200, epoch: 25 | loss: 0.2035710
	speed: 0.0351s/iter; left time: 1093.2754s
	iters: 300, epoch: 25 | loss: 0.0000027
	speed: 0.0339s/iter; left time: 1054.1015s
	iters: 400, epoch: 25 | loss: 0.1700064
	speed: 0.0320s/iter; left time: 992.0505s
Epoch: 25 cost time: 14.22953200340271
Epoch: 25, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.186 Vali Acc: 0.974 Test Loss: 0.186 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0969s/iter; left time: 2993.2661s
	iters: 200, epoch: 26 | loss: 0.0000022
	speed: 0.0332s/iter; left time: 1022.0794s
	iters: 300, epoch: 26 | loss: 0.0000002
	speed: 0.0344s/iter; left time: 1055.6399s
	iters: 400, epoch: 26 | loss: 0.0000267
	speed: 0.0329s/iter; left time: 1006.1035s
Epoch: 26 cost time: 14.338290452957153
Epoch: 26, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.228 Vali Acc: 0.971 Test Loss: 0.228 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 63754
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9915246
	speed: 0.0409s/iter; left time: 1683.3976s
	iters: 200, epoch: 1 | loss: 0.0810531
	speed: 0.0262s/iter; left time: 1076.5001s
	iters: 300, epoch: 1 | loss: 0.0970124
	speed: 0.0260s/iter; left time: 1067.7138s
	iters: 400, epoch: 1 | loss: 0.0666302
	speed: 0.0269s/iter; left time: 1098.3329s
Epoch: 1 cost time: 12.433555603027344
Epoch: 1, Steps: 413 | Train Loss: 0.554 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
Validation loss decreased (inf --> -0.962254).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0047566
	speed: 0.0875s/iter; left time: 3570.9553s
	iters: 200, epoch: 2 | loss: 0.4257654
	speed: 0.0261s/iter; left time: 1060.7257s
	iters: 300, epoch: 2 | loss: 0.0893137
	speed: 0.0272s/iter; left time: 1103.7950s
	iters: 400, epoch: 2 | loss: 0.0584289
	speed: 0.0278s/iter; left time: 1126.2509s
Epoch: 2 cost time: 11.525306940078735
Epoch: 2, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
Validation loss decreased (-0.962254 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0048986
	speed: 0.0858s/iter; left time: 3463.8285s
	iters: 200, epoch: 3 | loss: 0.0377083
	speed: 0.0260s/iter; left time: 1048.3836s
	iters: 300, epoch: 3 | loss: 0.0552045
	speed: 0.0267s/iter; left time: 1071.7614s
	iters: 400, epoch: 3 | loss: 0.0260636
	speed: 0.0260s/iter; left time: 1041.4879s
Epoch: 3 cost time: 11.165832281112671
Epoch: 3, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.067 Vali Acc: 0.973 Test Loss: 0.067 Test Acc: 0.973
Validation loss decreased (-0.970440 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0013603
	speed: 0.0888s/iter; left time: 3547.8622s
	iters: 200, epoch: 4 | loss: 0.1301773
	speed: 0.0264s/iter; left time: 1051.0105s
	iters: 300, epoch: 4 | loss: 0.0017998
	speed: 0.0249s/iter; left time: 990.2136s
	iters: 400, epoch: 4 | loss: 0.0002600
	speed: 0.0253s/iter; left time: 1003.7518s
Epoch: 4 cost time: 11.02476954460144
Epoch: 4, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
Validation loss decreased (-0.973169 --> -0.974988).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0001402
	speed: 0.0960s/iter; left time: 3795.9472s
	iters: 200, epoch: 5 | loss: 0.0055317
	speed: 0.0341s/iter; left time: 1343.3189s
	iters: 300, epoch: 5 | loss: 0.1529632
	speed: 0.0309s/iter; left time: 1217.5036s
	iters: 400, epoch: 5 | loss: 0.0000210
	speed: 0.0324s/iter; left time: 1270.7237s
Epoch: 5 cost time: 13.844613552093506
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0200397
	speed: 0.0919s/iter; left time: 3598.2104s
	iters: 200, epoch: 6 | loss: 0.0372104
	speed: 0.0319s/iter; left time: 1246.8057s
	iters: 300, epoch: 6 | loss: 0.0419404
	speed: 0.0360s/iter; left time: 1402.2806s
	iters: 400, epoch: 6 | loss: 0.0092511
	speed: 0.0341s/iter; left time: 1325.7561s
Epoch: 6 cost time: 14.249211311340332
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0047352
	speed: 0.0946s/iter; left time: 3662.7134s
	iters: 200, epoch: 7 | loss: 0.0003732
	speed: 0.0339s/iter; left time: 1307.5814s
	iters: 300, epoch: 7 | loss: 0.0001432
	speed: 0.0360s/iter; left time: 1386.6796s
	iters: 400, epoch: 7 | loss: 0.0079024
	speed: 0.0333s/iter; left time: 1280.6491s
Epoch: 7 cost time: 14.346031904220581
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1264403
	speed: 0.0940s/iter; left time: 3599.5349s
	iters: 200, epoch: 8 | loss: 0.0007604
	speed: 0.0332s/iter; left time: 1268.3167s
	iters: 300, epoch: 8 | loss: 0.0014246
	speed: 0.0308s/iter; left time: 1172.9756s
	iters: 400, epoch: 8 | loss: 0.0033421
	speed: 0.0323s/iter; left time: 1229.2402s
Epoch: 8 cost time: 13.798896789550781
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.974988 --> -0.975897).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0005531
	speed: 0.0966s/iter; left time: 3662.5025s
	iters: 200, epoch: 9 | loss: 0.0099513
	speed: 0.0310s/iter; left time: 1172.7386s
	iters: 300, epoch: 9 | loss: 0.0010148
	speed: 0.0302s/iter; left time: 1137.7992s
	iters: 400, epoch: 9 | loss: 0.0002827
	speed: 0.0312s/iter; left time: 1173.6677s
Epoch: 9 cost time: 13.43783187866211
Epoch: 9, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0003885
	speed: 0.0943s/iter; left time: 3536.2242s
	iters: 200, epoch: 10 | loss: 0.0000102
	speed: 0.0313s/iter; left time: 1169.3849s
	iters: 300, epoch: 10 | loss: 0.0057375
	speed: 0.0314s/iter; left time: 1170.4978s
	iters: 400, epoch: 10 | loss: 0.0014922
	speed: 0.0296s/iter; left time: 1099.6111s
Epoch: 10 cost time: 13.149983406066895
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.975897 --> -0.979990).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0012607
	speed: 0.0895s/iter; left time: 3318.9414s
	iters: 200, epoch: 11 | loss: 0.0073472
	speed: 0.0279s/iter; left time: 1032.2203s
	iters: 300, epoch: 11 | loss: 0.0004459
	speed: 0.0312s/iter; left time: 1152.1116s
	iters: 400, epoch: 11 | loss: 0.0047426
	speed: 0.0305s/iter; left time: 1120.7598s
Epoch: 11 cost time: 12.593541383743286
Epoch: 11, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0001194
	speed: 0.0943s/iter; left time: 3455.2317s
	iters: 200, epoch: 12 | loss: 0.0232833
	speed: 0.0299s/iter; left time: 1093.4950s
	iters: 300, epoch: 12 | loss: 0.0337954
	speed: 0.0260s/iter; left time: 947.3030s
	iters: 400, epoch: 12 | loss: 0.0000110
	speed: 0.0253s/iter; left time: 919.3507s
Epoch: 12 cost time: 11.801366329193115
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0517870
	speed: 0.0922s/iter; left time: 3342.9687s
	iters: 200, epoch: 13 | loss: 0.0058298
	speed: 0.0251s/iter; left time: 907.3215s
	iters: 300, epoch: 13 | loss: 0.0000102
	speed: 0.0268s/iter; left time: 964.5522s
	iters: 400, epoch: 13 | loss: 0.0004239
	speed: 0.0253s/iter; left time: 910.4551s
Epoch: 13 cost time: 11.036761045455933
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.153 Vali Acc: 0.978 Test Loss: 0.153 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000010
	speed: 0.0874s/iter; left time: 3130.8380s
	iters: 200, epoch: 14 | loss: 0.0010758
	speed: 0.0241s/iter; left time: 859.4190s
	iters: 300, epoch: 14 | loss: 0.0004201
	speed: 0.0261s/iter; left time: 928.5403s
	iters: 400, epoch: 14 | loss: 0.0065591
	speed: 0.0259s/iter; left time: 921.4167s
Epoch: 14 cost time: 10.831934928894043
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000302
	speed: 0.0818s/iter; left time: 2899.0118s
	iters: 200, epoch: 15 | loss: 0.0329097
	speed: 0.0254s/iter; left time: 896.3050s
	iters: 300, epoch: 15 | loss: 0.1171392
	speed: 0.0255s/iter; left time: 896.5290s
	iters: 400, epoch: 15 | loss: 0.0128074
	speed: 0.0249s/iter; left time: 873.1003s
Epoch: 15 cost time: 10.84608793258667
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0001444
	speed: 0.0919s/iter; left time: 3216.8830s
	iters: 200, epoch: 16 | loss: 0.0000072
	speed: 0.0307s/iter; left time: 1071.2976s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0333s/iter; left time: 1159.6803s
	iters: 400, epoch: 16 | loss: 0.0000100
	speed: 0.0341s/iter; left time: 1183.5390s
Epoch: 16 cost time: 13.989471912384033
Epoch: 16, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0288495
	speed: 0.0936s/iter; left time: 3238.0265s
	iters: 200, epoch: 17 | loss: 0.0002901
	speed: 0.0321s/iter; left time: 1107.3102s
	iters: 300, epoch: 17 | loss: 0.0000769
	speed: 0.0319s/iter; left time: 1097.0062s
	iters: 400, epoch: 17 | loss: 0.0000126
	speed: 0.0307s/iter; left time: 1054.1883s
Epoch: 17 cost time: 13.55267071723938
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.189 Vali Acc: 0.972 Test Loss: 0.189 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000840
	speed: 0.0974s/iter; left time: 3327.9945s
	iters: 200, epoch: 18 | loss: 0.0088596
	speed: 0.0321s/iter; left time: 1092.4536s
	iters: 300, epoch: 18 | loss: 0.0375777
	speed: 0.0320s/iter; left time: 1086.7411s
	iters: 400, epoch: 18 | loss: 0.0000542
	speed: 0.0297s/iter; left time: 1005.6475s
Epoch: 18 cost time: 13.24567985534668
Epoch: 18, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0019577
	speed: 0.0894s/iter; left time: 3017.2276s
	iters: 200, epoch: 19 | loss: 0.0000325
	speed: 0.0299s/iter; left time: 1007.6610s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0320s/iter; left time: 1075.0023s
	iters: 400, epoch: 19 | loss: 0.0000056
	speed: 0.0309s/iter; left time: 1033.1471s
Epoch: 19 cost time: 13.246509790420532
Epoch: 19, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000072
	speed: 0.0919s/iter; left time: 3065.0417s
	iters: 200, epoch: 20 | loss: 0.0014824
	speed: 0.0305s/iter; left time: 1014.0870s
	iters: 300, epoch: 20 | loss: 0.0000008
	speed: 0.0314s/iter; left time: 1041.9756s
	iters: 400, epoch: 20 | loss: 0.0000003
	speed: 0.0344s/iter; left time: 1138.0671s
Epoch: 20 cost time: 13.479386806488037
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.977 Test Loss: 0.154 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm32_nh4_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 55594
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1404703
	speed: 0.0558s/iter; left time: 2299.2103s
	iters: 200, epoch: 1 | loss: 0.2500756
	speed: 0.0420s/iter; left time: 1727.7094s
	iters: 300, epoch: 1 | loss: 0.0860279
	speed: 0.0451s/iter; left time: 1850.4130s
	iters: 400, epoch: 1 | loss: 0.0024292
	speed: 0.0417s/iter; left time: 1704.2924s
Epoch: 1 cost time: 19.008886575698853
Epoch: 1, Steps: 413 | Train Loss: 0.371 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
Validation loss decreased (inf --> -0.959980).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0412168
	speed: 0.1109s/iter; left time: 4521.3999s
	iters: 200, epoch: 2 | loss: 0.0030797
	speed: 0.0440s/iter; left time: 1790.7592s
	iters: 300, epoch: 2 | loss: 0.0921709
	speed: 0.0451s/iter; left time: 1830.2324s
	iters: 400, epoch: 2 | loss: 0.1319825
	speed: 0.0416s/iter; left time: 1684.0766s
Epoch: 2 cost time: 18.27851366996765
Epoch: 2, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
Validation loss decreased (-0.959980 --> -0.964983).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1404314
	speed: 0.0962s/iter; left time: 3884.7970s
	iters: 200, epoch: 3 | loss: 0.2514486
	speed: 0.0330s/iter; left time: 1330.4903s
	iters: 300, epoch: 3 | loss: 0.1862557
	speed: 0.0356s/iter; left time: 1430.4057s
	iters: 400, epoch: 3 | loss: 0.0006452
	speed: 0.0380s/iter; left time: 1523.1809s
Epoch: 3 cost time: 14.827632427215576
Epoch: 3, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2809827
	speed: 0.0966s/iter; left time: 3861.7834s
	iters: 200, epoch: 4 | loss: 0.0000023
	speed: 0.0338s/iter; left time: 1345.3631s
	iters: 300, epoch: 4 | loss: 0.0009797
	speed: 0.0350s/iter; left time: 1390.3566s
	iters: 400, epoch: 4 | loss: 0.2322348
	speed: 0.0351s/iter; left time: 1392.1785s
Epoch: 4 cost time: 14.368590354919434
Epoch: 4, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.208 Vali Acc: 0.955 Test Loss: 0.208 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0079651
	speed: 0.1041s/iter; left time: 4115.4332s
	iters: 200, epoch: 5 | loss: 0.0018127
	speed: 0.0330s/iter; left time: 1300.0491s
	iters: 300, epoch: 5 | loss: 0.0050694
	speed: 0.0316s/iter; left time: 1244.0334s
	iters: 400, epoch: 5 | loss: 0.0012727
	speed: 0.0318s/iter; left time: 1248.4461s
Epoch: 5 cost time: 14.107953071594238
Epoch: 5, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.187 Vali Acc: 0.969 Test Loss: 0.187 Test Acc: 0.969
Validation loss decreased (-0.964983 --> -0.969075).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1344896
	speed: 0.1001s/iter; left time: 3918.5157s
	iters: 200, epoch: 6 | loss: 0.0048712
	speed: 0.0314s/iter; left time: 1226.3425s
	iters: 300, epoch: 6 | loss: 0.0000235
	speed: 0.0314s/iter; left time: 1223.4923s
	iters: 400, epoch: 6 | loss: 0.0000001
	speed: 0.0306s/iter; left time: 1189.8369s
Epoch: 6 cost time: 13.397280931472778
Epoch: 6, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.248 Vali Acc: 0.959 Test Loss: 0.248 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0011440
	speed: 0.1054s/iter; left time: 4082.9815s
	iters: 200, epoch: 7 | loss: 0.2785417
	speed: 0.0411s/iter; left time: 1587.1816s
	iters: 300, epoch: 7 | loss: 0.0000588
	speed: 0.0425s/iter; left time: 1638.9496s
	iters: 400, epoch: 7 | loss: 0.0000003
	speed: 0.0428s/iter; left time: 1643.2626s
Epoch: 7 cost time: 17.70396065711975
Epoch: 7, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.201 Vali Acc: 0.970 Test Loss: 0.201 Test Acc: 0.970
Validation loss decreased (-0.969075 --> -0.969530).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0004071
	speed: 0.1075s/iter; left time: 4119.8759s
	iters: 200, epoch: 8 | loss: 0.0262913
	speed: 0.0417s/iter; left time: 1593.3763s
	iters: 300, epoch: 8 | loss: 0.0028489
	speed: 0.0453s/iter; left time: 1725.4566s
	iters: 400, epoch: 8 | loss: 0.0066475
	speed: 0.0393s/iter; left time: 1494.4929s
Epoch: 8 cost time: 17.496829986572266
Epoch: 8, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.313 Vali Acc: 0.955 Test Loss: 0.313 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000163
	speed: 0.1093s/iter; left time: 4142.5080s
	iters: 200, epoch: 9 | loss: 0.0000801
	speed: 0.0395s/iter; left time: 1493.5333s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1499.9921s
	iters: 400, epoch: 9 | loss: 0.0000013
	speed: 0.0412s/iter; left time: 1547.4917s
Epoch: 9 cost time: 17.00379753112793
Epoch: 9, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000152
	speed: 0.1104s/iter; left time: 4136.5963s
	iters: 200, epoch: 10 | loss: 0.0000002
	speed: 0.0403s/iter; left time: 1507.1703s
	iters: 300, epoch: 10 | loss: 0.0000084
	speed: 0.0429s/iter; left time: 1598.9496s
	iters: 400, epoch: 10 | loss: 0.0000008
	speed: 0.0445s/iter; left time: 1654.8643s
Epoch: 10 cost time: 17.77932333946228
Epoch: 10, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.232 Vali Acc: 0.963 Test Loss: 0.232 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000416
	speed: 0.1110s/iter; left time: 4115.8655s
	iters: 200, epoch: 11 | loss: 0.0000482
	speed: 0.0427s/iter; left time: 1579.1144s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0415s/iter; left time: 1530.2678s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0439s/iter; left time: 1613.2293s
Epoch: 11 cost time: 17.797333002090454
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.316 Vali Acc: 0.965 Test Loss: 0.316 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0008297
	speed: 0.1135s/iter; left time: 4158.9456s
	iters: 200, epoch: 12 | loss: 0.0000012
	speed: 0.0430s/iter; left time: 1571.5554s
	iters: 300, epoch: 12 | loss: 0.0000119
	speed: 0.0424s/iter; left time: 1545.0460s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 1566.2649s
Epoch: 12 cost time: 18.27420425415039
Epoch: 12, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
Validation loss decreased (-0.969530 --> -0.975442).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1090s/iter; left time: 3951.0798s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1534.4325s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 1517.5384s
	iters: 400, epoch: 13 | loss: 0.0002339
	speed: 0.0436s/iter; left time: 1566.3798s
Epoch: 13 cost time: 17.844759941101074
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.323 Vali Acc: 0.959 Test Loss: 0.323 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0969317
	speed: 0.1117s/iter; left time: 4003.3099s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.0440s/iter; left time: 1573.8231s
	iters: 300, epoch: 14 | loss: 0.0000043
	speed: 0.0412s/iter; left time: 1469.2845s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0296s/iter; left time: 1053.0822s
Epoch: 14 cost time: 16.488050937652588
Epoch: 14, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.253 Vali Acc: 0.968 Test Loss: 0.253 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0978s/iter; left time: 3465.2161s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 1256.4950s
	iters: 300, epoch: 15 | loss: 0.0004008
	speed: 0.0297s/iter; left time: 1044.4646s
	iters: 400, epoch: 15 | loss: 0.5410727
	speed: 0.0286s/iter; left time: 1005.7348s
Epoch: 15 cost time: 13.472533226013184
Epoch: 15, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.260 Vali Acc: 0.973 Test Loss: 0.260 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1215753
	speed: 0.0943s/iter; left time: 3301.9734s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 1082.4591s
	iters: 300, epoch: 16 | loss: 0.0000006
	speed: 0.0310s/iter; left time: 1079.7679s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 1150.0899s
Epoch: 16 cost time: 13.65030813217163
Epoch: 16, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.246 Vali Acc: 0.967 Test Loss: 0.246 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0006459
	speed: 0.0944s/iter; left time: 3265.8384s
	iters: 200, epoch: 17 | loss: 0.0247882
	speed: 0.0317s/iter; left time: 1093.2589s
	iters: 300, epoch: 17 | loss: 0.0000084
	speed: 0.0336s/iter; left time: 1157.2293s
	iters: 400, epoch: 17 | loss: 0.0001317
	speed: 0.0368s/iter; left time: 1260.4712s
Epoch: 17 cost time: 14.06837248802185
Epoch: 17, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.247 Vali Acc: 0.968 Test Loss: 0.247 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000405
	speed: 0.0970s/iter; left time: 3315.8410s
	iters: 200, epoch: 18 | loss: 0.0004165
	speed: 0.0341s/iter; left time: 1161.1191s
	iters: 300, epoch: 18 | loss: 0.0000518
	speed: 0.0374s/iter; left time: 1270.0206s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 1442.7095s
Epoch: 18 cost time: 15.599322319030762
Epoch: 18, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.348 Vali Acc: 0.964 Test Loss: 0.348 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1131s/iter; left time: 3820.4144s
	iters: 200, epoch: 19 | loss: 0.0002381
	speed: 0.0414s/iter; left time: 1394.4685s
	iters: 300, epoch: 19 | loss: 0.0000004
	speed: 0.0403s/iter; left time: 1352.9127s
	iters: 400, epoch: 19 | loss: 0.0000003
	speed: 0.0414s/iter; left time: 1386.4724s
Epoch: 19 cost time: 17.630629062652588
Epoch: 19, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.241 Vali Acc: 0.974 Test Loss: 0.241 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0095041
	speed: 0.1038s/iter; left time: 3462.3522s
	iters: 200, epoch: 20 | loss: 0.0004495
	speed: 0.0398s/iter; left time: 1323.6051s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1297.7364s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1414.4393s
Epoch: 20 cost time: 16.996159315109253
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.273 Vali Acc: 0.968 Test Loss: 0.273 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1726256
	speed: 0.1083s/iter; left time: 3567.3933s
	iters: 200, epoch: 21 | loss: 0.0022779
	speed: 0.0418s/iter; left time: 1372.0564s
	iters: 300, epoch: 21 | loss: 0.0000289
	speed: 0.0412s/iter; left time: 1348.6531s
	iters: 400, epoch: 21 | loss: 0.0000181
	speed: 0.0395s/iter; left time: 1288.3831s
Epoch: 21 cost time: 17.277254343032837
Epoch: 21, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.314 Vali Acc: 0.965 Test Loss: 0.314 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000081
	speed: 0.1089s/iter; left time: 3541.6353s
	iters: 200, epoch: 22 | loss: 0.0010057
	speed: 0.0420s/iter; left time: 1361.9385s
	iters: 300, epoch: 22 | loss: 0.0000003
	speed: 0.0378s/iter; left time: 1221.0307s
	iters: 400, epoch: 22 | loss: 0.0100294
	speed: 0.0379s/iter; left time: 1219.9741s
Epoch: 22 cost time: 16.662684679031372
Epoch: 22, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.304 Vali Acc: 0.967 Test Loss: 0.304 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 126698
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1675404
	speed: 0.0500s/iter; left time: 2058.0336s
	iters: 200, epoch: 1 | loss: 0.1477237
	speed: 0.0340s/iter; left time: 1396.0325s
	iters: 300, epoch: 1 | loss: 0.1192207
	speed: 0.0327s/iter; left time: 1340.2750s
	iters: 400, epoch: 1 | loss: 0.1932013
	speed: 0.0355s/iter; left time: 1452.9879s
Epoch: 1 cost time: 15.742272138595581
Epoch: 1, Steps: 413 | Train Loss: 0.413 Vali Loss: 0.126 Vali Acc: 0.958 Test Loss: 0.126 Test Acc: 0.958
Validation loss decreased (inf --> -0.958162).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5864198
	speed: 0.0984s/iter; left time: 4014.0254s
	iters: 200, epoch: 2 | loss: 0.0627381
	speed: 0.0340s/iter; left time: 1383.2119s
	iters: 300, epoch: 2 | loss: 0.0339799
	speed: 0.0358s/iter; left time: 1452.9972s
	iters: 400, epoch: 2 | loss: 0.0770652
	speed: 0.0344s/iter; left time: 1391.9229s
Epoch: 2 cost time: 14.571197986602783
Epoch: 2, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.082 Vali Acc: 0.972 Test Loss: 0.082 Test Acc: 0.972
Validation loss decreased (-0.958162 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0119766
	speed: 0.0910s/iter; left time: 3674.7351s
	iters: 200, epoch: 3 | loss: 0.0834885
	speed: 0.0237s/iter; left time: 956.2538s
	iters: 300, epoch: 3 | loss: 0.4430555
	speed: 0.0272s/iter; left time: 1093.3701s
	iters: 400, epoch: 3 | loss: 0.0911933
	speed: 0.0285s/iter; left time: 1142.7558s
Epoch: 3 cost time: 11.893746376037598
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0418974
	speed: 0.0935s/iter; left time: 3737.2386s
	iters: 200, epoch: 4 | loss: 0.0020814
	speed: 0.0315s/iter; left time: 1256.4770s
	iters: 300, epoch: 4 | loss: 0.1236887
	speed: 0.0291s/iter; left time: 1157.3342s
	iters: 400, epoch: 4 | loss: 0.2268669
	speed: 0.0276s/iter; left time: 1092.7316s
Epoch: 4 cost time: 12.550905227661133
Epoch: 4, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0495030
	speed: 0.0901s/iter; left time: 3562.7853s
	iters: 200, epoch: 5 | loss: 0.0006834
	speed: 0.0298s/iter; left time: 1173.6522s
	iters: 300, epoch: 5 | loss: 0.0022339
	speed: 0.0273s/iter; left time: 1074.3708s
	iters: 400, epoch: 5 | loss: 0.0000334
	speed: 0.0275s/iter; left time: 1079.8300s
Epoch: 5 cost time: 12.000494956970215
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.224 Vali Acc: 0.963 Test Loss: 0.224 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0040898
	speed: 0.0886s/iter; left time: 3465.8378s
	iters: 200, epoch: 6 | loss: 0.0002489
	speed: 0.0271s/iter; left time: 1059.0345s
	iters: 300, epoch: 6 | loss: 0.0035452
	speed: 0.0268s/iter; left time: 1044.5620s
	iters: 400, epoch: 6 | loss: 0.0011467
	speed: 0.0293s/iter; left time: 1136.2039s
Epoch: 6 cost time: 11.886345386505127
Epoch: 6, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.198 Vali Acc: 0.966 Test Loss: 0.198 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000189
	speed: 0.0938s/iter; left time: 3632.0908s
	iters: 200, epoch: 7 | loss: 0.0002631
	speed: 0.0366s/iter; left time: 1414.5193s
	iters: 300, epoch: 7 | loss: 0.1044044
	speed: 0.0373s/iter; left time: 1437.5227s
	iters: 400, epoch: 7 | loss: 0.0038122
	speed: 0.0363s/iter; left time: 1396.6725s
Epoch: 7 cost time: 15.57571005821228
Epoch: 7, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.290 Vali Acc: 0.948 Test Loss: 0.290 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0009093
	speed: 0.0965s/iter; left time: 3695.1103s
	iters: 200, epoch: 8 | loss: 0.0007143
	speed: 0.0369s/iter; left time: 1411.1618s
	iters: 300, epoch: 8 | loss: 0.0000002
	speed: 0.0368s/iter; left time: 1400.7880s
	iters: 400, epoch: 8 | loss: 0.0046393
	speed: 0.0360s/iter; left time: 1369.6182s
Epoch: 8 cost time: 15.460905313491821
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.174 Vali Acc: 0.965 Test Loss: 0.174 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0353527
	speed: 0.0990s/iter; left time: 3752.7482s
	iters: 200, epoch: 9 | loss: 0.0034362
	speed: 0.0357s/iter; left time: 1348.5712s
	iters: 300, epoch: 9 | loss: 0.0011001
	speed: 0.0365s/iter; left time: 1377.3183s
	iters: 400, epoch: 9 | loss: 0.0010041
	speed: 0.0366s/iter; left time: 1376.8631s
Epoch: 9 cost time: 15.471147537231445
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.351 Vali Acc: 0.949 Test Loss: 0.351 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0009534
	speed: 0.0979s/iter; left time: 3668.0598s
	iters: 200, epoch: 10 | loss: 0.0001309
	speed: 0.0357s/iter; left time: 1333.2256s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 1385.0309s
	iters: 400, epoch: 10 | loss: 0.0000002
	speed: 0.0377s/iter; left time: 1402.0033s
Epoch: 10 cost time: 15.359194040298462
Epoch: 10, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.158 Vali Acc: 0.974 Test Loss: 0.158 Test Acc: 0.974
Validation loss decreased (-0.972259 --> -0.973623).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0074723
	speed: 0.0985s/iter; left time: 3650.7846s
	iters: 200, epoch: 11 | loss: 0.0014338
	speed: 0.0377s/iter; left time: 1393.7896s
	iters: 300, epoch: 11 | loss: 0.0039430
	speed: 0.0372s/iter; left time: 1372.4949s
	iters: 400, epoch: 11 | loss: 0.0001941
	speed: 0.0365s/iter; left time: 1340.7273s
Epoch: 11 cost time: 15.702172040939331
Epoch: 11, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.269 Vali Acc: 0.965 Test Loss: 0.269 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1379483
	speed: 0.1026s/iter; left time: 3760.8942s
	iters: 200, epoch: 12 | loss: 0.0000577
	speed: 0.0378s/iter; left time: 1382.1296s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 1316.2681s
	iters: 400, epoch: 12 | loss: 0.0017153
	speed: 0.0364s/iter; left time: 1325.1288s
Epoch: 12 cost time: 15.55017876625061
Epoch: 12, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.973623 --> -0.974987).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000046
	speed: 0.0989s/iter; left time: 3583.6051s
	iters: 200, epoch: 13 | loss: 0.0000014
	speed: 0.0372s/iter; left time: 1344.2054s
	iters: 300, epoch: 13 | loss: 0.0784441
	speed: 0.0369s/iter; left time: 1331.8137s
	iters: 400, epoch: 13 | loss: 0.0745785
	speed: 0.0372s/iter; left time: 1336.6924s
Epoch: 13 cost time: 15.698937177658081
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.186 Vali Acc: 0.969 Test Loss: 0.186 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.0964s/iter; left time: 3454.3984s
	iters: 200, epoch: 14 | loss: 0.0000198
	speed: 0.0368s/iter; left time: 1313.7712s
	iters: 300, epoch: 14 | loss: 0.0208415
	speed: 0.0378s/iter; left time: 1347.5131s
	iters: 400, epoch: 14 | loss: 0.0323216
	speed: 0.0379s/iter; left time: 1345.2164s
Epoch: 14 cost time: 15.735718727111816
Epoch: 14, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.199 Vali Acc: 0.967 Test Loss: 0.199 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.8503594
	speed: 0.0974s/iter; left time: 3450.6460s
	iters: 200, epoch: 15 | loss: 0.0000139
	speed: 0.0282s/iter; left time: 995.4003s
	iters: 300, epoch: 15 | loss: 0.0020272
	speed: 0.0302s/iter; left time: 1065.2518s
	iters: 400, epoch: 15 | loss: 0.0514811
	speed: 0.0288s/iter; left time: 1011.6402s
Epoch: 15 cost time: 12.985108852386475
Epoch: 15, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.213 Vali Acc: 0.970 Test Loss: 0.213 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1776137
	speed: 0.0922s/iter; left time: 3226.0665s
	iters: 200, epoch: 16 | loss: 0.0000169
	speed: 0.0281s/iter; left time: 980.9812s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 979.2473s
	iters: 400, epoch: 16 | loss: 0.0000226
	speed: 0.0285s/iter; left time: 990.0140s
Epoch: 16 cost time: 12.201221227645874
Epoch: 16, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.211 Vali Acc: 0.975 Test Loss: 0.211 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0076874
	speed: 0.0887s/iter; left time: 3069.9231s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 917.6409s
	iters: 300, epoch: 17 | loss: 0.0000046
	speed: 0.0280s/iter; left time: 962.9379s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0273s/iter; left time: 935.7514s
Epoch: 17 cost time: 11.749032497406006
Epoch: 17, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974987 --> -0.975442).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000017
	speed: 0.0901s/iter; left time: 3080.3477s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0276s/iter; left time: 939.0483s
	iters: 300, epoch: 18 | loss: 0.0015079
	speed: 0.0269s/iter; left time: 914.2707s
	iters: 400, epoch: 18 | loss: 0.0078066
	speed: 0.0283s/iter; left time: 958.5006s
Epoch: 18 cost time: 11.848164319992065
Epoch: 18, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.247 Vali Acc: 0.968 Test Loss: 0.247 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000023
	speed: 0.0914s/iter; left time: 3085.3696s
	iters: 200, epoch: 19 | loss: 0.0007453
	speed: 0.0353s/iter; left time: 1189.8410s
	iters: 300, epoch: 19 | loss: 0.0000011
	speed: 0.0373s/iter; left time: 1251.0470s
	iters: 400, epoch: 19 | loss: 0.0002102
	speed: 0.0376s/iter; left time: 1258.2816s
Epoch: 19 cost time: 14.767156839370728
Epoch: 19, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.275 Vali Acc: 0.973 Test Loss: 0.275 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000005
	speed: 0.1063s/iter; left time: 3544.9477s
	iters: 200, epoch: 20 | loss: 0.0003632
	speed: 0.0376s/iter; left time: 1250.0848s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0363s/iter; left time: 1203.0904s
	iters: 400, epoch: 20 | loss: 0.0633310
	speed: 0.0345s/iter; left time: 1141.7521s
Epoch: 20 cost time: 15.29831838607788
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.244 Vali Acc: 0.970 Test Loss: 0.244 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000027
	speed: 0.1021s/iter; left time: 3362.8729s
	iters: 200, epoch: 21 | loss: 0.0000003
	speed: 0.0354s/iter; left time: 1162.9561s
	iters: 300, epoch: 21 | loss: 0.0000662
	speed: 0.0361s/iter; left time: 1182.4538s
	iters: 400, epoch: 21 | loss: 0.0000014
	speed: 0.0368s/iter; left time: 1201.2200s
Epoch: 21 cost time: 15.405143976211548
Epoch: 21, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.190 Vali Acc: 0.973 Test Loss: 0.190 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000200
	speed: 0.0994s/iter; left time: 3234.0981s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 1144.8788s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 1123.6872s
	iters: 400, epoch: 22 | loss: 0.0081654
	speed: 0.0370s/iter; left time: 1194.0057s
Epoch: 22 cost time: 15.026484489440918
Epoch: 22, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0977s/iter; left time: 3137.2773s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 1180.9739s
	iters: 300, epoch: 23 | loss: 0.0002307
	speed: 0.0374s/iter; left time: 1192.6148s
	iters: 400, epoch: 23 | loss: 0.0065759
	speed: 0.0373s/iter; left time: 1186.3018s
Epoch: 23 cost time: 15.627603530883789
Epoch: 23, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.256 Vali Acc: 0.972 Test Loss: 0.256 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000579
	speed: 0.0968s/iter; left time: 3068.2702s
	iters: 200, epoch: 24 | loss: 0.0000001
	speed: 0.0367s/iter; left time: 1160.8199s
	iters: 300, epoch: 24 | loss: 0.0001970
	speed: 0.0376s/iter; left time: 1183.6048s
	iters: 400, epoch: 24 | loss: 0.0062884
	speed: 0.0359s/iter; left time: 1128.0134s
Epoch: 24 cost time: 15.465219736099243
Epoch: 24, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.337 Vali Acc: 0.966 Test Loss: 0.337 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.1027s/iter; left time: 3213.5086s
	iters: 200, epoch: 25 | loss: 0.0000003
	speed: 0.0327s/iter; left time: 1019.2682s
	iters: 300, epoch: 25 | loss: 0.0000146
	speed: 0.0313s/iter; left time: 972.8689s
	iters: 400, epoch: 25 | loss: 0.0000552
	speed: 0.0319s/iter; left time: 988.8376s
Epoch: 25 cost time: 14.038804769515991
Epoch: 25, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.306 Vali Acc: 0.968 Test Loss: 0.306 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000005
	speed: 0.0980s/iter; left time: 3025.0482s
	iters: 200, epoch: 26 | loss: 0.0013687
	speed: 0.0348s/iter; left time: 1070.5229s
	iters: 300, epoch: 26 | loss: 0.0195320
	speed: 0.0367s/iter; left time: 1125.6705s
	iters: 400, epoch: 26 | loss: 0.0853769
	speed: 0.0374s/iter; left time: 1145.0623s
Epoch: 26 cost time: 15.308880090713501
Epoch: 26, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.261 Vali Acc: 0.975 Test Loss: 0.261 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.0963s/iter; left time: 2934.9122s
	iters: 200, epoch: 27 | loss: 0.0000016
	speed: 0.0272s/iter; left time: 825.2917s
	iters: 300, epoch: 27 | loss: 0.0000001
	speed: 0.0282s/iter; left time: 853.3490s
	iters: 400, epoch: 27 | loss: 0.0002822
	speed: 0.0297s/iter; left time: 896.5042s
Epoch: 27 cost time: 12.487194538116455
Epoch: 27, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.307 Vali Acc: 0.970 Test Loss: 0.307 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 93450
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3178721
	speed: 0.0453s/iter; left time: 1866.8788s
	iters: 200, epoch: 1 | loss: 0.1796060
	speed: 0.0285s/iter; left time: 1171.0348s
	iters: 300, epoch: 1 | loss: 0.1850597
	speed: 0.0282s/iter; left time: 1154.6787s
	iters: 400, epoch: 1 | loss: 0.0593868
	speed: 0.0273s/iter; left time: 1118.3560s
Epoch: 1 cost time: 13.363590717315674
Epoch: 1, Steps: 413 | Train Loss: 0.472 Vali Loss: 0.124 Vali Acc: 0.958 Test Loss: 0.124 Test Acc: 0.958
Validation loss decreased (inf --> -0.957707).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0242624
	speed: 0.0883s/iter; left time: 3600.3172s
	iters: 200, epoch: 2 | loss: 0.1464780
	speed: 0.0275s/iter; left time: 1117.2237s
	iters: 300, epoch: 2 | loss: 0.0177933
	speed: 0.0288s/iter; left time: 1168.1032s
	iters: 400, epoch: 2 | loss: 0.0146348
	speed: 0.0285s/iter; left time: 1153.9155s
Epoch: 2 cost time: 12.118411302566528
Epoch: 2, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
Validation loss decreased (-0.957707 --> -0.964983).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0079104
	speed: 0.0913s/iter; left time: 3686.2786s
	iters: 200, epoch: 3 | loss: 0.1295459
	speed: 0.0338s/iter; left time: 1360.8347s
	iters: 300, epoch: 3 | loss: 0.2206330
	speed: 0.0345s/iter; left time: 1386.0864s
	iters: 400, epoch: 3 | loss: 0.2167924
	speed: 0.0381s/iter; left time: 1525.7020s
Epoch: 3 cost time: 15.144525051116943
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0523092
	speed: 0.0990s/iter; left time: 3954.6721s
	iters: 200, epoch: 4 | loss: 0.0014614
	speed: 0.0358s/iter; left time: 1425.8203s
	iters: 300, epoch: 4 | loss: 0.0040302
	speed: 0.0349s/iter; left time: 1388.7412s
	iters: 400, epoch: 4 | loss: 0.0223489
	speed: 0.0360s/iter; left time: 1428.1823s
Epoch: 4 cost time: 15.057588577270508
Epoch: 4, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
Validation loss decreased (-0.964983 --> -0.973623).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0191187
	speed: 0.0965s/iter; left time: 3817.8254s
	iters: 200, epoch: 5 | loss: 0.0002021
	speed: 0.0363s/iter; left time: 1432.4597s
	iters: 300, epoch: 5 | loss: 0.0006418
	speed: 0.0332s/iter; left time: 1307.1075s
	iters: 400, epoch: 5 | loss: 0.3358018
	speed: 0.0319s/iter; left time: 1251.7512s
Epoch: 5 cost time: 14.344016313552856
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0080297
	speed: 0.0992s/iter; left time: 3880.8093s
	iters: 200, epoch: 6 | loss: 0.0092465
	speed: 0.0346s/iter; left time: 1352.2997s
	iters: 300, epoch: 6 | loss: 0.0042123
	speed: 0.0337s/iter; left time: 1311.9974s
	iters: 400, epoch: 6 | loss: 0.0000910
	speed: 0.0326s/iter; left time: 1264.5713s
Epoch: 6 cost time: 14.414585828781128
Epoch: 6, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0006312
	speed: 0.0974s/iter; left time: 3771.2300s
	iters: 200, epoch: 7 | loss: 0.0078791
	speed: 0.0325s/iter; left time: 1254.8006s
	iters: 300, epoch: 7 | loss: 0.2000847
	speed: 0.0363s/iter; left time: 1398.2232s
	iters: 400, epoch: 7 | loss: 0.0303639
	speed: 0.0338s/iter; left time: 1298.6213s
Epoch: 7 cost time: 14.34317135810852
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0745865
	speed: 0.0983s/iter; left time: 3766.0088s
	iters: 200, epoch: 8 | loss: 0.0006938
	speed: 0.0336s/iter; left time: 1283.6452s
	iters: 300, epoch: 8 | loss: 0.0000014
	speed: 0.0358s/iter; left time: 1364.3299s
	iters: 400, epoch: 8 | loss: 0.0010076
	speed: 0.0347s/iter; left time: 1319.6212s
Epoch: 8 cost time: 14.508924961090088
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.973623 --> -0.980445).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1643831
	speed: 0.1007s/iter; left time: 3816.4326s
	iters: 200, epoch: 9 | loss: 0.0000277
	speed: 0.0345s/iter; left time: 1304.6883s
	iters: 300, epoch: 9 | loss: 0.0000006
	speed: 0.0326s/iter; left time: 1229.8344s
	iters: 400, epoch: 9 | loss: 0.0210954
	speed: 0.0354s/iter; left time: 1330.3372s
Epoch: 9 cost time: 14.612046957015991
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.210 Vali Acc: 0.967 Test Loss: 0.210 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0422918
	speed: 0.1000s/iter; left time: 3748.0393s
	iters: 200, epoch: 10 | loss: 0.0000571
	speed: 0.0342s/iter; left time: 1279.4702s
	iters: 300, epoch: 10 | loss: 0.6469666
	speed: 0.0339s/iter; left time: 1262.4864s
	iters: 400, epoch: 10 | loss: 0.1477360
	speed: 0.0347s/iter; left time: 1290.8944s
Epoch: 10 cost time: 14.53549075126648
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.200 Vali Acc: 0.971 Test Loss: 0.200 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000061
	speed: 0.0913s/iter; left time: 3384.5085s
	iters: 200, epoch: 11 | loss: 0.0001006
	speed: 0.0292s/iter; left time: 1079.2475s
	iters: 300, epoch: 11 | loss: 0.0000026
	speed: 0.0270s/iter; left time: 996.6478s
	iters: 400, epoch: 11 | loss: 0.0719310
	speed: 0.0291s/iter; left time: 1070.5210s
Epoch: 11 cost time: 12.288984537124634
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.182 Vali Acc: 0.971 Test Loss: 0.182 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0009114
	speed: 0.0924s/iter; left time: 3387.0844s
	iters: 200, epoch: 12 | loss: 0.0472375
	speed: 0.0297s/iter; left time: 1086.8131s
	iters: 300, epoch: 12 | loss: 0.0116541
	speed: 0.0293s/iter; left time: 1068.2369s
	iters: 400, epoch: 12 | loss: 0.0340106
	speed: 0.0277s/iter; left time: 1007.0354s
Epoch: 12 cost time: 12.399116516113281
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000219
	speed: 0.0948s/iter; left time: 3435.1689s
	iters: 200, epoch: 13 | loss: 0.0032485
	speed: 0.0283s/iter; left time: 1024.6635s
	iters: 300, epoch: 13 | loss: 0.0815037
	speed: 0.0308s/iter; left time: 1109.7779s
	iters: 400, epoch: 13 | loss: 0.0000018
	speed: 0.0281s/iter; left time: 1011.4510s
Epoch: 13 cost time: 12.487540483474731
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.243 Vali Acc: 0.970 Test Loss: 0.243 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000593
	speed: 0.0957s/iter; left time: 3429.9131s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0268s/iter; left time: 957.8721s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0387s/iter; left time: 1377.8384s
	iters: 400, epoch: 14 | loss: 0.0000124
	speed: 0.0574s/iter; left time: 2038.7022s
Epoch: 14 cost time: 16.354471445083618
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.198 Vali Acc: 0.973 Test Loss: 0.198 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1293s/iter; left time: 4580.0522s
	iters: 200, epoch: 15 | loss: 0.0000011
	speed: 0.0566s/iter; left time: 1998.9827s
	iters: 300, epoch: 15 | loss: 0.0002694
	speed: 0.0527s/iter; left time: 1857.5160s
	iters: 400, epoch: 15 | loss: 0.0000003
	speed: 0.0478s/iter; left time: 1678.3179s
Epoch: 15 cost time: 21.95841670036316
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.232 Vali Acc: 0.970 Test Loss: 0.232 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000017
	speed: 0.1202s/iter; left time: 4206.2053s
	iters: 200, epoch: 16 | loss: 0.0071527
	speed: 0.0282s/iter; left time: 984.7834s
	iters: 300, epoch: 16 | loss: 0.0000012
	speed: 0.0352s/iter; left time: 1224.3994s
	iters: 400, epoch: 16 | loss: 0.2639066
	speed: 0.0374s/iter; left time: 1299.3016s
Epoch: 16 cost time: 14.556380271911621
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.232 Vali Acc: 0.975 Test Loss: 0.232 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0014442
	speed: 0.0982s/iter; left time: 3397.9279s
	iters: 200, epoch: 17 | loss: 0.0014990
	speed: 0.0407s/iter; left time: 1405.4306s
	iters: 300, epoch: 17 | loss: 0.0000004
	speed: 0.0466s/iter; left time: 1602.5010s
	iters: 400, epoch: 17 | loss: 0.0306663
	speed: 0.0554s/iter; left time: 1900.6032s
Epoch: 17 cost time: 19.35501003265381
Epoch: 17, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.209 Vali Acc: 0.974 Test Loss: 0.209 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.2768259
	speed: 0.1269s/iter; left time: 4338.8219s
	iters: 200, epoch: 18 | loss: 0.0000417
	speed: 0.0601s/iter; left time: 2049.1656s
	iters: 300, epoch: 18 | loss: 0.0649531
	speed: 0.0588s/iter; left time: 1999.5790s
	iters: 400, epoch: 18 | loss: 0.0000250
	speed: 0.0460s/iter; left time: 1558.9325s
Epoch: 18 cost time: 21.725955486297607
Epoch: 18, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.274 Vali Acc: 0.967 Test Loss: 0.274 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 76842
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5403456
	speed: 0.0759s/iter; left time: 3127.1967s
	iters: 200, epoch: 1 | loss: 0.2087514
	speed: 0.0497s/iter; left time: 2042.5746s
	iters: 300, epoch: 1 | loss: 0.0281656
	speed: 0.0583s/iter; left time: 2389.5951s
	iters: 400, epoch: 1 | loss: 0.0839871
	speed: 0.0576s/iter; left time: 2356.6606s
Epoch: 1 cost time: 24.92032766342163
Epoch: 1, Steps: 413 | Train Loss: 0.499 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
Validation loss decreased (inf --> -0.961800).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0325373
	speed: 0.1427s/iter; left time: 5821.2293s
	iters: 200, epoch: 2 | loss: 0.0929259
	speed: 0.0593s/iter; left time: 2412.5902s
	iters: 300, epoch: 2 | loss: 0.2073448
	speed: 0.0491s/iter; left time: 1994.5050s
	iters: 400, epoch: 2 | loss: 0.0099182
	speed: 0.0426s/iter; left time: 1724.0314s
Epoch: 2 cost time: 21.91787028312683
Epoch: 2, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.081 Vali Acc: 0.967 Test Loss: 0.081 Test Acc: 0.967
Validation loss decreased (-0.961800 --> -0.967257).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0137751
	speed: 0.1076s/iter; left time: 4342.8678s
	iters: 200, epoch: 3 | loss: 0.2279669
	speed: 0.0386s/iter; left time: 1552.9770s
	iters: 300, epoch: 3 | loss: 0.0106847
	speed: 0.0393s/iter; left time: 1580.2303s
	iters: 400, epoch: 3 | loss: 0.0121527
	speed: 0.0382s/iter; left time: 1529.4190s
Epoch: 3 cost time: 16.203100204467773
Epoch: 3, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
Validation loss decreased (-0.967257 --> -0.969985).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0084060
	speed: 0.1228s/iter; left time: 4906.5419s
	iters: 200, epoch: 4 | loss: 0.0180905
	speed: 0.0400s/iter; left time: 1596.0307s
	iters: 300, epoch: 4 | loss: 0.0163710
	speed: 0.0411s/iter; left time: 1634.7435s
	iters: 400, epoch: 4 | loss: 0.0042593
	speed: 0.0414s/iter; left time: 1640.9644s
Epoch: 4 cost time: 17.534743547439575
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
Validation loss decreased (-0.969985 --> -0.974078).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0094791
	speed: 0.1521s/iter; left time: 6014.2804s
	iters: 200, epoch: 5 | loss: 0.0004400
	speed: 0.0534s/iter; left time: 2106.3705s
	iters: 300, epoch: 5 | loss: 0.0153780
	speed: 0.0587s/iter; left time: 2310.9795s
	iters: 400, epoch: 5 | loss: 0.0105319
	speed: 0.0549s/iter; left time: 2156.1555s
Epoch: 5 cost time: 23.54188299179077
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2056103
	speed: 0.1534s/iter; left time: 6003.9253s
	iters: 200, epoch: 6 | loss: 0.0002255
	speed: 0.0628s/iter; left time: 2449.7651s
	iters: 300, epoch: 6 | loss: 0.0079550
	speed: 0.0649s/iter; left time: 2525.2277s
	iters: 400, epoch: 6 | loss: 0.0000061
	speed: 0.0561s/iter; left time: 2180.3937s
Epoch: 6 cost time: 25.10571265220642
Epoch: 6, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0167411
	speed: 0.1528s/iter; left time: 5916.3299s
	iters: 200, epoch: 7 | loss: 0.0096845
	speed: 0.0561s/iter; left time: 2167.9221s
	iters: 300, epoch: 7 | loss: 0.0004751
	speed: 0.0539s/iter; left time: 2077.6930s
	iters: 400, epoch: 7 | loss: 0.0004239
	speed: 0.0549s/iter; left time: 2108.1943s
Epoch: 7 cost time: 22.851797103881836
Epoch: 7, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.974078 --> -0.976807).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0907282
	speed: 0.1407s/iter; left time: 5391.7789s
	iters: 200, epoch: 8 | loss: 0.0000485
	speed: 0.0573s/iter; left time: 2190.9745s
	iters: 300, epoch: 8 | loss: 0.0000178
	speed: 0.0394s/iter; left time: 1500.8320s
	iters: 400, epoch: 8 | loss: 0.2459259
	speed: 0.0628s/iter; left time: 2385.3387s
Epoch: 8 cost time: 21.810999631881714
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0016963
	speed: 0.1440s/iter; left time: 5455.6037s
	iters: 200, epoch: 9 | loss: 0.0000074
	speed: 0.0593s/iter; left time: 2241.6604s
	iters: 300, epoch: 9 | loss: 0.0034721
	speed: 0.0444s/iter; left time: 1674.9248s
	iters: 400, epoch: 9 | loss: 0.0106235
	speed: 0.0610s/iter; left time: 2294.3408s
Epoch: 9 cost time: 22.375123262405396
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0008344
	speed: 0.1431s/iter; left time: 5362.8963s
	iters: 200, epoch: 10 | loss: 0.0034671
	speed: 0.0503s/iter; left time: 1880.2395s
	iters: 300, epoch: 10 | loss: 0.4112303
	speed: 0.0522s/iter; left time: 1944.6338s
	iters: 400, epoch: 10 | loss: 0.0000022
	speed: 0.0525s/iter; left time: 1953.8311s
Epoch: 10 cost time: 21.543424129486084
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000157
	speed: 0.1474s/iter; left time: 5463.3907s
	iters: 200, epoch: 11 | loss: 0.0000006
	speed: 0.0458s/iter; left time: 1693.7330s
	iters: 300, epoch: 11 | loss: 0.0918842
	speed: 0.0645s/iter; left time: 2378.3367s
	iters: 400, epoch: 11 | loss: 0.0232795
	speed: 0.0572s/iter; left time: 2104.4786s
Epoch: 11 cost time: 23.235422134399414
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0001055
	speed: 0.1569s/iter; left time: 5752.5533s
	iters: 200, epoch: 12 | loss: 0.0008727
	speed: 0.0540s/iter; left time: 1975.6841s
	iters: 300, epoch: 12 | loss: 0.0043400
	speed: 0.0659s/iter; left time: 2401.0124s
	iters: 400, epoch: 12 | loss: 0.0537755
	speed: 0.0591s/iter; left time: 2149.1587s
Epoch: 12 cost time: 25.09295964241028
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0124870
	speed: 0.1355s/iter; left time: 4912.7361s
	iters: 200, epoch: 13 | loss: 0.0022549
	speed: 0.0402s/iter; left time: 1451.5961s
	iters: 300, epoch: 13 | loss: 0.0000730
	speed: 0.0428s/iter; left time: 1543.3276s
	iters: 400, epoch: 13 | loss: 0.0269436
	speed: 0.0445s/iter; left time: 1597.8282s
Epoch: 13 cost time: 17.99172306060791
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000010
	speed: 0.1291s/iter; left time: 4624.9982s
	iters: 200, epoch: 14 | loss: 0.0000089
	speed: 0.0382s/iter; left time: 1364.7265s
	iters: 300, epoch: 14 | loss: 0.0006320
	speed: 0.0381s/iter; left time: 1358.3402s
	iters: 400, epoch: 14 | loss: 0.0000580
	speed: 0.0424s/iter; left time: 1507.1435s
Epoch: 14 cost time: 17.38349151611328
Epoch: 14, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.203 Vali Acc: 0.961 Test Loss: 0.203 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000004
	speed: 0.1535s/iter; left time: 5436.9735s
	iters: 200, epoch: 15 | loss: 0.0002272
	speed: 0.0570s/iter; left time: 2014.7551s
	iters: 300, epoch: 15 | loss: 0.0067267
	speed: 0.0525s/iter; left time: 1849.2487s
	iters: 400, epoch: 15 | loss: 0.0331872
	speed: 0.0515s/iter; left time: 1807.9742s
Epoch: 15 cost time: 22.541837692260742
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1476s/iter; left time: 5165.7545s
	iters: 200, epoch: 16 | loss: 0.0012949
	speed: 0.0534s/iter; left time: 1863.0385s
	iters: 300, epoch: 16 | loss: 0.0035868
	speed: 0.0524s/iter; left time: 1823.3991s
	iters: 400, epoch: 16 | loss: 0.0000022
	speed: 0.0506s/iter; left time: 1756.3886s
Epoch: 16 cost time: 21.67081069946289
Epoch: 16, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.974 Test Loss: 0.139 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0001366
	speed: 0.1452s/iter; left time: 5022.9453s
	iters: 200, epoch: 17 | loss: 0.0000117
	speed: 0.0529s/iter; left time: 1824.4725s
	iters: 300, epoch: 17 | loss: 0.2707622
	speed: 0.0507s/iter; left time: 1744.6012s
	iters: 400, epoch: 17 | loss: 0.0000190
	speed: 0.0554s/iter; left time: 1900.5011s
Epoch: 17 cost time: 21.95365881919861
Epoch: 17, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9768076398362893
model parameter : 66490
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5017982
	speed: 0.0567s/iter; left time: 2337.0242s
	iters: 200, epoch: 1 | loss: 0.2385747
	speed: 0.0407s/iter; left time: 1672.6144s
	iters: 300, epoch: 1 | loss: 0.0770712
	speed: 0.0378s/iter; left time: 1548.9559s
	iters: 400, epoch: 1 | loss: 0.0623174
	speed: 0.0419s/iter; left time: 1714.5075s
Epoch: 1 cost time: 18.32475447654724
Epoch: 1, Steps: 413 | Train Loss: 0.585 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (inf --> -0.967712).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1109461
	speed: 0.1147s/iter; left time: 4679.1613s
	iters: 200, epoch: 2 | loss: 0.0609657
	speed: 0.0298s/iter; left time: 1213.2605s
	iters: 300, epoch: 2 | loss: 0.0820290
	speed: 0.0295s/iter; left time: 1196.4377s
	iters: 400, epoch: 2 | loss: 0.0822525
	speed: 0.0290s/iter; left time: 1172.1809s
Epoch: 2 cost time: 12.89298391342163
Epoch: 2, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.095 Vali Acc: 0.966 Test Loss: 0.095 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0239540
	speed: 0.1018s/iter; left time: 4110.3555s
	iters: 200, epoch: 3 | loss: 0.0071328
	speed: 0.0322s/iter; left time: 1297.5406s
	iters: 300, epoch: 3 | loss: 0.0018235
	speed: 0.0297s/iter; left time: 1193.1408s
	iters: 400, epoch: 3 | loss: 0.0323216
	speed: 0.0300s/iter; left time: 1204.1568s
Epoch: 3 cost time: 13.14637804031372
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
Validation loss decreased (-0.967712 --> -0.974988).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0037580
	speed: 0.1136s/iter; left time: 4540.7567s
	iters: 200, epoch: 4 | loss: 0.0034555
	speed: 0.0432s/iter; left time: 1722.6209s
	iters: 300, epoch: 4 | loss: 0.1576494
	speed: 0.0414s/iter; left time: 1646.3293s
	iters: 400, epoch: 4 | loss: 0.0170787
	speed: 0.0373s/iter; left time: 1480.9569s
Epoch: 4 cost time: 16.65294361114502
Epoch: 4, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.069 Vali Acc: 0.972 Test Loss: 0.069 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0011142
	speed: 0.1281s/iter; left time: 5067.7458s
	iters: 200, epoch: 5 | loss: 0.1850417
	speed: 0.0451s/iter; left time: 1777.2157s
	iters: 300, epoch: 5 | loss: 0.0174696
	speed: 0.0378s/iter; left time: 1486.0890s
	iters: 400, epoch: 5 | loss: 0.0015803
	speed: 0.0390s/iter; left time: 1532.2007s
Epoch: 5 cost time: 17.0616238117218
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0045637
	speed: 0.1276s/iter; left time: 4992.9750s
	iters: 200, epoch: 6 | loss: 0.0016104
	speed: 0.0536s/iter; left time: 2090.6834s
	iters: 300, epoch: 6 | loss: 0.1878735
	speed: 0.0519s/iter; left time: 2021.1960s
	iters: 400, epoch: 6 | loss: 0.0830122
	speed: 0.0469s/iter; left time: 1822.3975s
Epoch: 6 cost time: 20.206661462783813
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.092 Vali Acc: 0.972 Test Loss: 0.092 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0499543
	speed: 0.1394s/iter; left time: 5398.1976s
	iters: 200, epoch: 7 | loss: 0.0045237
	speed: 0.0468s/iter; left time: 1808.8555s
	iters: 300, epoch: 7 | loss: 0.0683073
	speed: 0.0535s/iter; left time: 2059.6640s
	iters: 400, epoch: 7 | loss: 0.0335662
	speed: 0.0498s/iter; left time: 1912.6238s
Epoch: 7 cost time: 20.665887355804443
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0010447
	speed: 0.1160s/iter; left time: 4445.7638s
	iters: 200, epoch: 8 | loss: 0.0061450
	speed: 0.0370s/iter; left time: 1412.9537s
	iters: 300, epoch: 8 | loss: 0.1722450
	speed: 0.0359s/iter; left time: 1368.5609s
	iters: 400, epoch: 8 | loss: 0.0001966
	speed: 0.0416s/iter; left time: 1580.6154s
Epoch: 8 cost time: 16.24410057067871
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0018652
	speed: 0.1225s/iter; left time: 4642.8514s
	iters: 200, epoch: 9 | loss: 0.0373541
	speed: 0.0433s/iter; left time: 1636.9353s
	iters: 300, epoch: 9 | loss: 0.0042400
	speed: 0.0428s/iter; left time: 1611.9845s
	iters: 400, epoch: 9 | loss: 0.0000297
	speed: 0.0411s/iter; left time: 1544.4387s
Epoch: 9 cost time: 18.09518837928772
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.974988 --> -0.978171).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0008079
	speed: 0.1334s/iter; left time: 4999.1844s
	iters: 200, epoch: 10 | loss: 0.0000548
	speed: 0.0501s/iter; left time: 1872.8378s
	iters: 300, epoch: 10 | loss: 0.0020172
	speed: 0.0456s/iter; left time: 1700.2283s
	iters: 400, epoch: 10 | loss: 0.0248111
	speed: 0.0450s/iter; left time: 1674.0502s
Epoch: 10 cost time: 19.816070079803467
Epoch: 10, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000173
	speed: 0.1329s/iter; left time: 4925.7874s
	iters: 200, epoch: 11 | loss: 0.0335759
	speed: 0.0403s/iter; left time: 1490.0230s
	iters: 300, epoch: 11 | loss: 0.0241586
	speed: 0.0401s/iter; left time: 1479.0469s
	iters: 400, epoch: 11 | loss: 0.1452418
	speed: 0.0446s/iter; left time: 1638.5100s
Epoch: 11 cost time: 18.46168541908264
Epoch: 11, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0142379
	speed: 0.1228s/iter; left time: 4502.8544s
	iters: 200, epoch: 12 | loss: 0.0481612
	speed: 0.0406s/iter; left time: 1483.9616s
	iters: 300, epoch: 12 | loss: 0.0025982
	speed: 0.0427s/iter; left time: 1556.3386s
	iters: 400, epoch: 12 | loss: 0.0005700
	speed: 0.0432s/iter; left time: 1570.4322s
Epoch: 12 cost time: 18.08086657524109
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0122947
	speed: 0.1333s/iter; left time: 4831.3371s
	iters: 200, epoch: 13 | loss: 0.0016541
	speed: 0.0495s/iter; left time: 1787.6824s
	iters: 300, epoch: 13 | loss: 0.0000960
	speed: 0.0446s/iter; left time: 1606.9804s
	iters: 400, epoch: 13 | loss: 0.0051380
	speed: 0.0411s/iter; left time: 1475.9971s
Epoch: 13 cost time: 19.061484813690186
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0004534
	speed: 0.1324s/iter; left time: 4745.5920s
	iters: 200, epoch: 14 | loss: 0.0000461
	speed: 0.0392s/iter; left time: 1401.9647s
	iters: 300, epoch: 14 | loss: 0.0000006
	speed: 0.0376s/iter; left time: 1338.6394s
	iters: 400, epoch: 14 | loss: 0.0001719
	speed: 0.0333s/iter; left time: 1183.8303s
Epoch: 14 cost time: 15.891178369522095
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0004027
	speed: 0.1226s/iter; left time: 4340.6462s
	iters: 200, epoch: 15 | loss: 0.0000059
	speed: 0.0347s/iter; left time: 1225.2482s
	iters: 300, epoch: 15 | loss: 0.0033063
	speed: 0.0335s/iter; left time: 1180.2939s
	iters: 400, epoch: 15 | loss: 0.0284801
	speed: 0.0330s/iter; left time: 1157.3661s
Epoch: 15 cost time: 14.825709104537964
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000202
	speed: 0.1045s/iter; left time: 3659.4623s
	iters: 200, epoch: 16 | loss: 0.0020388
	speed: 0.0320s/iter; left time: 1117.4711s
	iters: 300, epoch: 16 | loss: 0.0000321
	speed: 0.0343s/iter; left time: 1194.6025s
	iters: 400, epoch: 16 | loss: 0.0068507
	speed: 0.0308s/iter; left time: 1069.7955s
Epoch: 16 cost time: 13.394935846328735
Epoch: 16, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.966 Test Loss: 0.168 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0084115
	speed: 0.1056s/iter; left time: 3653.7992s
	iters: 200, epoch: 17 | loss: 0.0009805
	speed: 0.0312s/iter; left time: 1074.9783s
	iters: 300, epoch: 17 | loss: 0.0000039
	speed: 0.0368s/iter; left time: 1265.8219s
	iters: 400, epoch: 17 | loss: 0.0060261
	speed: 0.0396s/iter; left time: 1358.8150s
Epoch: 17 cost time: 14.519065856933594
Epoch: 17, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.978171 --> -0.979535).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0003249
	speed: 0.1210s/iter; left time: 4136.3333s
	iters: 200, epoch: 18 | loss: 0.0000743
	speed: 0.0475s/iter; left time: 1617.4188s
	iters: 300, epoch: 18 | loss: 0.0272446
	speed: 0.0465s/iter; left time: 1580.3453s
	iters: 400, epoch: 18 | loss: 0.0111857
	speed: 0.0435s/iter; left time: 1473.1258s
Epoch: 18 cost time: 18.306446075439453
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0018083
	speed: 0.1247s/iter; left time: 4212.1085s
	iters: 200, epoch: 19 | loss: 0.0000087
	speed: 0.0427s/iter; left time: 1436.7047s
	iters: 300, epoch: 19 | loss: 0.0002089
	speed: 0.0439s/iter; left time: 1474.9455s
	iters: 400, epoch: 19 | loss: 0.3480833
	speed: 0.0426s/iter; left time: 1427.3582s
Epoch: 19 cost time: 18.02842926979065
Epoch: 19, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.5261558
	speed: 0.1193s/iter; left time: 3980.5014s
	iters: 200, epoch: 20 | loss: 0.2750283
	speed: 0.0388s/iter; left time: 1289.9323s
	iters: 300, epoch: 20 | loss: 0.0000032
	speed: 0.0356s/iter; left time: 1180.7691s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.0385s/iter; left time: 1271.1190s
Epoch: 20 cost time: 16.292891025543213
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0044610
	speed: 0.1150s/iter; left time: 3786.8821s
	iters: 200, epoch: 21 | loss: 0.0000003
	speed: 0.0597s/iter; left time: 1961.7380s
	iters: 300, epoch: 21 | loss: 0.0001521
	speed: 0.0577s/iter; left time: 1889.7850s
	iters: 400, epoch: 21 | loss: 0.0000766
	speed: 0.0502s/iter; left time: 1638.2935s
Epoch: 21 cost time: 21.620526552200317
Epoch: 21, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.236 Vali Acc: 0.963 Test Loss: 0.236 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000053
	speed: 0.1487s/iter; left time: 4837.4300s
	iters: 200, epoch: 22 | loss: 0.0004015
	speed: 0.0511s/iter; left time: 1657.5275s
	iters: 300, epoch: 22 | loss: 0.0000002
	speed: 0.0648s/iter; left time: 2095.4951s
	iters: 400, epoch: 22 | loss: 0.0001242
	speed: 0.0599s/iter; left time: 1928.8715s
Epoch: 22 cost time: 23.953388452529907
Epoch: 22, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0006327
	speed: 0.1525s/iter; left time: 4896.4758s
	iters: 200, epoch: 23 | loss: 0.0000262
	speed: 0.0530s/iter; left time: 1697.7135s
	iters: 300, epoch: 23 | loss: 0.0102476
	speed: 0.0582s/iter; left time: 1856.1097s
	iters: 400, epoch: 23 | loss: 0.0000001
	speed: 0.0619s/iter; left time: 1969.7656s
Epoch: 23 cost time: 24.52515482902527
Epoch: 23, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000097
	speed: 0.1553s/iter; left time: 4924.0250s
	iters: 200, epoch: 24 | loss: 0.0457996
	speed: 0.0555s/iter; left time: 1753.4130s
	iters: 300, epoch: 24 | loss: 0.0000004
	speed: 0.0466s/iter; left time: 1466.4936s
	iters: 400, epoch: 24 | loss: 0.0000211
	speed: 0.0606s/iter; left time: 1902.7600s
Epoch: 24 cost time: 23.816604375839233
Epoch: 24, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000243
	speed: 0.1481s/iter; left time: 4635.1524s
	iters: 200, epoch: 25 | loss: 0.0001395
	speed: 0.0621s/iter; left time: 1935.4343s
	iters: 300, epoch: 25 | loss: 0.0004540
	speed: 0.0516s/iter; left time: 1605.7076s
	iters: 400, epoch: 25 | loss: 0.0000012
	speed: 0.0582s/iter; left time: 1804.7642s
Epoch: 25 cost time: 24.15014672279358
Epoch: 25, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.2214197
	speed: 0.1427s/iter; left time: 4405.0191s
	iters: 200, epoch: 26 | loss: 0.0000694
	speed: 0.0632s/iter; left time: 1946.5521s
	iters: 300, epoch: 26 | loss: 0.0004545
	speed: 0.0628s/iter; left time: 1926.6623s
	iters: 400, epoch: 26 | loss: 0.0005936
	speed: 0.0463s/iter; left time: 1414.1514s
Epoch: 26 cost time: 22.720333099365234
Epoch: 26, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.1858034
	speed: 0.1413s/iter; left time: 4304.2408s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0401s/iter; left time: 1217.3039s
	iters: 300, epoch: 27 | loss: 0.0023142
	speed: 0.0552s/iter; left time: 1669.6116s
	iters: 400, epoch: 27 | loss: 0.0000235
	speed: 0.0516s/iter; left time: 1555.8749s
Epoch: 27 cost time: 20.211750984191895
Epoch: 27, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.978 Test Loss: 0.161 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 56154
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7128206
	speed: 0.0495s/iter; left time: 2039.2130s
	iters: 200, epoch: 1 | loss: 0.0983528
	speed: 0.0274s/iter; left time: 1125.0360s
	iters: 300, epoch: 1 | loss: 0.1019444
	speed: 0.0311s/iter; left time: 1276.5863s
	iters: 400, epoch: 1 | loss: 0.1323655
	speed: 0.0325s/iter; left time: 1327.7205s
Epoch: 1 cost time: 14.808258056640625
Epoch: 1, Steps: 413 | Train Loss: 0.659 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (inf --> -0.967711).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0565155
	speed: 0.1378s/iter; left time: 5620.0978s
	iters: 200, epoch: 2 | loss: 0.0398479
	speed: 0.0336s/iter; left time: 1367.2564s
	iters: 300, epoch: 2 | loss: 0.1734454
	speed: 0.0474s/iter; left time: 1923.2724s
	iters: 400, epoch: 2 | loss: 0.0789791
	speed: 0.0401s/iter; left time: 1621.8857s
Epoch: 2 cost time: 17.690881490707397
Epoch: 2, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.086 Vali Acc: 0.971 Test Loss: 0.086 Test Acc: 0.971
Validation loss decreased (-0.967711 --> -0.970895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0804537
	speed: 0.1437s/iter; left time: 5802.1022s
	iters: 200, epoch: 3 | loss: 0.2746356
	speed: 0.0382s/iter; left time: 1540.1581s
	iters: 300, epoch: 3 | loss: 0.0286745
	speed: 0.0609s/iter; left time: 2444.8850s
	iters: 400, epoch: 3 | loss: 0.0902912
	speed: 0.0465s/iter; left time: 1862.5598s
Epoch: 3 cost time: 21.223458528518677
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0021137
	speed: 0.1516s/iter; left time: 6058.9558s
	iters: 200, epoch: 4 | loss: 0.0221352
	speed: 0.0492s/iter; left time: 1962.2911s
	iters: 300, epoch: 4 | loss: 0.0100719
	speed: 0.0535s/iter; left time: 2126.3390s
	iters: 400, epoch: 4 | loss: 0.1282640
	speed: 0.0462s/iter; left time: 1833.4822s
Epoch: 4 cost time: 21.62765884399414
Epoch: 4, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.083 Vali Acc: 0.974 Test Loss: 0.083 Test Acc: 0.974
Validation loss decreased (-0.970895 --> -0.973624).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0299401
	speed: 0.1413s/iter; left time: 5589.7484s
	iters: 200, epoch: 5 | loss: 0.0015106
	speed: 0.0447s/iter; left time: 1763.2661s
	iters: 300, epoch: 5 | loss: 0.0049279
	speed: 0.0541s/iter; left time: 2129.3268s
	iters: 400, epoch: 5 | loss: 0.2202975
	speed: 0.0432s/iter; left time: 1695.4668s
Epoch: 5 cost time: 20.679706811904907
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0082517
	speed: 0.1473s/iter; left time: 5763.2617s
	iters: 200, epoch: 6 | loss: 0.0023114
	speed: 0.0436s/iter; left time: 1701.9906s
	iters: 300, epoch: 6 | loss: 0.0010424
	speed: 0.0580s/iter; left time: 2259.1983s
	iters: 400, epoch: 6 | loss: 0.0019008
	speed: 0.0503s/iter; left time: 1954.6714s
Epoch: 6 cost time: 22.17697048187256
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.113 Vali Acc: 0.966 Test Loss: 0.113 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0189734
	speed: 0.1468s/iter; left time: 5684.2590s
	iters: 200, epoch: 7 | loss: 0.2613651
	speed: 0.0487s/iter; left time: 1881.3352s
	iters: 300, epoch: 7 | loss: 0.0110186
	speed: 0.0612s/iter; left time: 2359.3405s
	iters: 400, epoch: 7 | loss: 0.0029843
	speed: 0.0552s/iter; left time: 2121.3198s
Epoch: 7 cost time: 23.16201376914978
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0247005
	speed: 0.1504s/iter; left time: 5761.0811s
	iters: 200, epoch: 8 | loss: 0.0884989
	speed: 0.0590s/iter; left time: 2253.4238s
	iters: 300, epoch: 8 | loss: 0.0026902
	speed: 0.0513s/iter; left time: 1954.7126s
	iters: 400, epoch: 8 | loss: 0.0002847
	speed: 0.0436s/iter; left time: 1657.4475s
Epoch: 8 cost time: 21.98152756690979
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0387673
	speed: 0.1138s/iter; left time: 4314.3654s
	iters: 200, epoch: 9 | loss: 0.0012515
	speed: 0.0346s/iter; left time: 1307.9931s
	iters: 300, epoch: 9 | loss: 0.0037410
	speed: 0.0318s/iter; left time: 1199.6432s
	iters: 400, epoch: 9 | loss: 0.0000391
	speed: 0.0356s/iter; left time: 1338.6785s
Epoch: 9 cost time: 14.758021831512451
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2416704
	speed: 0.1346s/iter; left time: 5046.8858s
	iters: 200, epoch: 10 | loss: 0.0036869
	speed: 0.0508s/iter; left time: 1899.6174s
	iters: 300, epoch: 10 | loss: 0.0000635
	speed: 0.0502s/iter; left time: 1871.1596s
	iters: 400, epoch: 10 | loss: 0.0368898
	speed: 0.0399s/iter; left time: 1485.0647s
Epoch: 10 cost time: 19.9602210521698
Epoch: 10, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0134459
	speed: 0.1326s/iter; left time: 4916.2878s
	iters: 200, epoch: 11 | loss: 0.0008494
	speed: 0.0515s/iter; left time: 1905.2162s
	iters: 300, epoch: 11 | loss: 0.0000580
	speed: 0.0535s/iter; left time: 1974.3748s
	iters: 400, epoch: 11 | loss: 0.0006521
	speed: 0.0471s/iter; left time: 1730.4335s
Epoch: 11 cost time: 20.965511083602905
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0087083
	speed: 0.1221s/iter; left time: 4474.3813s
	iters: 200, epoch: 12 | loss: 0.0050100
	speed: 0.0412s/iter; left time: 1504.7469s
	iters: 300, epoch: 12 | loss: 0.0006873
	speed: 0.0340s/iter; left time: 1240.5616s
	iters: 400, epoch: 12 | loss: 0.0403029
	speed: 0.0302s/iter; left time: 1097.4153s
Epoch: 12 cost time: 14.733941793441772
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000944
	speed: 0.0991s/iter; left time: 3593.3852s
	iters: 200, epoch: 13 | loss: 0.1303343
	speed: 0.0298s/iter; left time: 1076.6344s
	iters: 300, epoch: 13 | loss: 0.0000395
	speed: 0.0286s/iter; left time: 1031.5813s
	iters: 400, epoch: 13 | loss: 0.0000080
	speed: 0.0303s/iter; left time: 1090.7361s
Epoch: 13 cost time: 12.581177473068237
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0005911
	speed: 0.1024s/iter; left time: 3670.2830s
	iters: 200, epoch: 14 | loss: 0.0000876
	speed: 0.0288s/iter; left time: 1027.8248s
	iters: 300, epoch: 14 | loss: 0.0172106
	speed: 0.0287s/iter; left time: 1020.9356s
	iters: 400, epoch: 14 | loss: 0.0000819
	speed: 0.0288s/iter; left time: 1022.8259s
Epoch: 14 cost time: 12.465215682983398
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9736243747157799
model parameter : 47914
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1123778
	speed: 0.0542s/iter; left time: 2231.9497s
	iters: 200, epoch: 1 | loss: 0.3920181
	speed: 0.0482s/iter; left time: 1981.2148s
	iters: 300, epoch: 1 | loss: 0.3009934
	speed: 0.0473s/iter; left time: 1938.0354s
	iters: 400, epoch: 1 | loss: 0.3340718
	speed: 0.0447s/iter; left time: 1828.1753s
Epoch: 1 cost time: 20.20232367515564
Epoch: 1, Steps: 413 | Train Loss: 0.717 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
Validation loss decreased (inf --> -0.945883).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1064680
	speed: 0.1324s/iter; left time: 5401.8794s
	iters: 200, epoch: 2 | loss: 0.1662682
	speed: 0.0478s/iter; left time: 1945.3553s
	iters: 300, epoch: 2 | loss: 0.0475304
	speed: 0.0451s/iter; left time: 1831.4515s
	iters: 400, epoch: 2 | loss: 0.0336219
	speed: 0.0403s/iter; left time: 1631.9551s
Epoch: 2 cost time: 18.663906574249268
Epoch: 2, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.945883 --> -0.969985).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0868450
	speed: 0.1166s/iter; left time: 4707.9180s
	iters: 200, epoch: 3 | loss: 0.0219530
	speed: 0.0362s/iter; left time: 1459.1461s
	iters: 300, epoch: 3 | loss: 0.0091235
	speed: 0.0354s/iter; left time: 1421.4001s
	iters: 400, epoch: 3 | loss: 0.0309360
	speed: 0.0368s/iter; left time: 1474.6982s
Epoch: 3 cost time: 15.429970264434814
Epoch: 3, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.067 Vali Acc: 0.975 Test Loss: 0.067 Test Acc: 0.975
Validation loss decreased (-0.969985 --> -0.975443).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0091812
	speed: 0.1166s/iter; left time: 4659.8969s
	iters: 200, epoch: 4 | loss: 0.0775562
	speed: 0.0352s/iter; left time: 1403.0360s
	iters: 300, epoch: 4 | loss: 0.0093412
	speed: 0.0351s/iter; left time: 1394.8417s
	iters: 400, epoch: 4 | loss: 0.0326195
	speed: 0.0456s/iter; left time: 1809.2632s
Epoch: 4 cost time: 16.177074432373047
Epoch: 4, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
Validation loss decreased (-0.975443 --> -0.976352).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1843422
	speed: 0.1277s/iter; left time: 5050.7964s
	iters: 200, epoch: 5 | loss: 0.0253833
	speed: 0.0406s/iter; left time: 1599.9344s
	iters: 300, epoch: 5 | loss: 0.0023679
	speed: 0.0491s/iter; left time: 1933.8580s
	iters: 400, epoch: 5 | loss: 0.0068254
	speed: 0.0438s/iter; left time: 1719.7875s
Epoch: 5 cost time: 18.394866704940796
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0058881
	speed: 0.1346s/iter; left time: 5267.2444s
	iters: 200, epoch: 6 | loss: 0.0051121
	speed: 0.0423s/iter; left time: 1652.1170s
	iters: 300, epoch: 6 | loss: 0.1978228
	speed: 0.0432s/iter; left time: 1683.6424s
	iters: 400, epoch: 6 | loss: 0.1082920
	speed: 0.0454s/iter; left time: 1762.1049s
Epoch: 6 cost time: 18.641844034194946
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976352 --> -0.977262).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2240295
	speed: 0.1367s/iter; left time: 5293.6899s
	iters: 200, epoch: 7 | loss: 0.1149908
	speed: 0.0445s/iter; left time: 1719.5772s
	iters: 300, epoch: 7 | loss: 0.0101696
	speed: 0.0425s/iter; left time: 1638.2937s
	iters: 400, epoch: 7 | loss: 0.0097909
	speed: 0.0396s/iter; left time: 1520.5732s
Epoch: 7 cost time: 18.56108331680298
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0268061
	speed: 0.1211s/iter; left time: 4638.8641s
	iters: 200, epoch: 8 | loss: 0.0011916
	speed: 0.0377s/iter; left time: 1442.0332s
	iters: 300, epoch: 8 | loss: 0.0008892
	speed: 0.0370s/iter; left time: 1409.7338s
	iters: 400, epoch: 8 | loss: 0.0175408
	speed: 0.0383s/iter; left time: 1457.2409s
Epoch: 8 cost time: 16.107184886932373
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0311751
	speed: 0.1231s/iter; left time: 4666.7075s
	iters: 200, epoch: 9 | loss: 0.0827595
	speed: 0.0377s/iter; left time: 1426.5031s
	iters: 300, epoch: 9 | loss: 0.2292373
	speed: 0.0390s/iter; left time: 1471.4756s
	iters: 400, epoch: 9 | loss: 0.0052146
	speed: 0.0362s/iter; left time: 1360.5149s
Epoch: 9 cost time: 15.427993059158325
Epoch: 9, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0001694
	speed: 0.1222s/iter; left time: 4578.7180s
	iters: 200, epoch: 10 | loss: 0.0003750
	speed: 0.0366s/iter; left time: 1368.8873s
	iters: 300, epoch: 10 | loss: 0.0186088
	speed: 0.0390s/iter; left time: 1453.2403s
	iters: 400, epoch: 10 | loss: 0.0000225
	speed: 0.0355s/iter; left time: 1318.9620s
Epoch: 10 cost time: 15.48740267753601
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.093 Vali Acc: 0.972 Test Loss: 0.093 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0054710
	speed: 0.1144s/iter; left time: 4242.7757s
	iters: 200, epoch: 11 | loss: 0.0392683
	speed: 0.0361s/iter; left time: 1336.3595s
	iters: 300, epoch: 11 | loss: 0.0003674
	speed: 0.0357s/iter; left time: 1317.8724s
	iters: 400, epoch: 11 | loss: 0.0266205
	speed: 0.0344s/iter; left time: 1265.3235s
Epoch: 11 cost time: 15.386030197143555
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0001573
	speed: 0.1184s/iter; left time: 4340.7779s
	iters: 200, epoch: 12 | loss: 0.0002302
	speed: 0.0386s/iter; left time: 1410.3395s
	iters: 300, epoch: 12 | loss: 0.0005570
	speed: 0.0370s/iter; left time: 1350.1704s
	iters: 400, epoch: 12 | loss: 0.0004677
	speed: 0.0367s/iter; left time: 1333.5195s
Epoch: 12 cost time: 16.112807273864746
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.977262 --> -0.980445).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0005304
	speed: 0.1218s/iter; left time: 4414.1574s
	iters: 200, epoch: 13 | loss: 0.0549237
	speed: 0.0385s/iter; left time: 1392.8489s
	iters: 300, epoch: 13 | loss: 0.0005550
	speed: 0.0402s/iter; left time: 1448.6316s
	iters: 400, epoch: 13 | loss: 0.0005729
	speed: 0.0382s/iter; left time: 1372.7719s
Epoch: 13 cost time: 16.853120803833008
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0111853
	speed: 0.1165s/iter; left time: 4173.4760s
	iters: 200, epoch: 14 | loss: 0.0000196
	speed: 0.0371s/iter; left time: 1324.9640s
	iters: 300, epoch: 14 | loss: 0.0129939
	speed: 0.0402s/iter; left time: 1432.5036s
	iters: 400, epoch: 14 | loss: 0.0000827
	speed: 0.0425s/iter; left time: 1511.0707s
Epoch: 14 cost time: 16.799764156341553
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1174627
	speed: 0.1314s/iter; left time: 4653.0568s
	iters: 200, epoch: 15 | loss: 0.0059586
	speed: 0.0414s/iter; left time: 1461.4218s
	iters: 300, epoch: 15 | loss: 0.0279855
	speed: 0.0393s/iter; left time: 1385.0802s
	iters: 400, epoch: 15 | loss: 0.0009182
	speed: 0.0418s/iter; left time: 1468.3220s
Epoch: 15 cost time: 17.864572763442993
Epoch: 15, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0002196
	speed: 0.1330s/iter; left time: 4657.2443s
	iters: 200, epoch: 16 | loss: 0.3598465
	speed: 0.0442s/iter; left time: 1544.4787s
	iters: 300, epoch: 16 | loss: 0.0000377
	speed: 0.0433s/iter; left time: 1505.5366s
	iters: 400, epoch: 16 | loss: 0.0000140
	speed: 0.0394s/iter; left time: 1366.6634s
Epoch: 16 cost time: 18.0462863445282
Epoch: 16, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0008101
	speed: 0.1164s/iter; left time: 4026.4163s
	iters: 200, epoch: 17 | loss: 0.0236925
	speed: 0.0352s/iter; left time: 1213.1866s
	iters: 300, epoch: 17 | loss: 0.0002555
	speed: 0.0402s/iter; left time: 1381.0281s
	iters: 400, epoch: 17 | loss: 0.0000565
	speed: 0.0383s/iter; left time: 1314.7593s
Epoch: 17 cost time: 15.847998142242432
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.3533877
	speed: 0.1571s/iter; left time: 5368.1234s
	iters: 200, epoch: 18 | loss: 0.0000128
	speed: 0.0538s/iter; left time: 1832.5784s
	iters: 300, epoch: 18 | loss: 0.0018498
	speed: 0.0618s/iter; left time: 2100.8869s
	iters: 400, epoch: 18 | loss: 0.0013164
	speed: 0.0553s/iter; left time: 1873.0255s
Epoch: 18 cost time: 23.774274110794067
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0035815
	speed: 0.1578s/iter; left time: 5327.5200s
	iters: 200, epoch: 19 | loss: 0.0000011
	speed: 0.0487s/iter; left time: 1638.9560s
	iters: 300, epoch: 19 | loss: 0.0012020
	speed: 0.0612s/iter; left time: 2055.0415s
	iters: 400, epoch: 19 | loss: 0.0008990
	speed: 0.0582s/iter; left time: 1946.3126s
Epoch: 19 cost time: 24.072221994400024
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0004174
	speed: 0.1527s/iter; left time: 5094.1047s
	iters: 200, epoch: 20 | loss: 0.0003355
	speed: 0.0517s/iter; left time: 1720.4399s
	iters: 300, epoch: 20 | loss: 0.0000158
	speed: 0.0575s/iter; left time: 1906.9983s
	iters: 400, epoch: 20 | loss: 0.0034623
	speed: 0.0655s/iter; left time: 2164.3394s
Epoch: 20 cost time: 24.86439323425293
Epoch: 20, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0032472
	speed: 0.1565s/iter; left time: 5156.5007s
	iters: 200, epoch: 21 | loss: 0.0000038
	speed: 0.0559s/iter; left time: 1837.2070s
	iters: 300, epoch: 21 | loss: 0.0815086
	speed: 0.0475s/iter; left time: 1556.6775s
	iters: 400, epoch: 21 | loss: 0.0382361
	speed: 0.0550s/iter; left time: 1796.1100s
Epoch: 21 cost time: 22.939674139022827
Epoch: 21, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.964 Test Loss: 0.189 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0002933
	speed: 0.1471s/iter; left time: 4786.0904s
	iters: 200, epoch: 22 | loss: 0.0000062
	speed: 0.0510s/iter; left time: 1654.0281s
	iters: 300, epoch: 22 | loss: 0.0002895
	speed: 0.0373s/iter; left time: 1204.3930s
	iters: 400, epoch: 22 | loss: 0.0000234
	speed: 0.0535s/iter; left time: 1725.7077s
Epoch: 22 cost time: 21.21077060699463
Epoch: 22, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 43834
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2452330
	speed: 0.0808s/iter; left time: 3330.5160s
	iters: 200, epoch: 1 | loss: 0.0545616
	speed: 0.0506s/iter; left time: 2080.0773s
	iters: 300, epoch: 1 | loss: 0.2563024
	speed: 0.0629s/iter; left time: 2578.9519s
	iters: 400, epoch: 1 | loss: 0.3730282
	speed: 0.0581s/iter; left time: 2377.6969s
Epoch: 1 cost time: 25.9121036529541
Epoch: 1, Steps: 413 | Train Loss: 0.406 Vali Loss: 0.148 Vali Acc: 0.955 Test Loss: 0.148 Test Acc: 0.955
Validation loss decreased (inf --> -0.954523).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0847907
	speed: 0.1547s/iter; left time: 6308.6741s
	iters: 200, epoch: 2 | loss: 0.1671164
	speed: 0.0445s/iter; left time: 1811.5192s
	iters: 300, epoch: 2 | loss: 0.0003165
	speed: 0.0411s/iter; left time: 1668.7993s
	iters: 400, epoch: 2 | loss: 0.0006548
	speed: 0.0353s/iter; left time: 1429.4919s
Epoch: 2 cost time: 18.558133363723755
Epoch: 2, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.169 Vali Acc: 0.965 Test Loss: 0.169 Test Acc: 0.965
Validation loss decreased (-0.954523 --> -0.964982).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2989210
	speed: 0.1121s/iter; left time: 4526.4707s
	iters: 200, epoch: 3 | loss: 0.0003341
	speed: 0.0404s/iter; left time: 1627.5162s
	iters: 300, epoch: 3 | loss: 0.0202534
	speed: 0.0507s/iter; left time: 2035.9202s
	iters: 400, epoch: 3 | loss: 0.0037900
	speed: 0.0604s/iter; left time: 2418.8240s
Epoch: 3 cost time: 20.124250888824463
Epoch: 3, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
Validation loss decreased (-0.964982 --> -0.966347).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0001265
	speed: 0.1662s/iter; left time: 6641.5816s
	iters: 200, epoch: 4 | loss: 0.0003224
	speed: 0.0557s/iter; left time: 2221.6012s
	iters: 300, epoch: 4 | loss: 0.0365146
	speed: 0.0606s/iter; left time: 2408.2966s
	iters: 400, epoch: 4 | loss: 0.0000075
	speed: 0.0618s/iter; left time: 2452.4103s
Epoch: 4 cost time: 25.495243549346924
Epoch: 4, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
Validation loss decreased (-0.966347 --> -0.970894).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0041715
	speed: 0.1637s/iter; left time: 6472.3083s
	iters: 200, epoch: 5 | loss: 0.0283392
	speed: 0.0540s/iter; left time: 2131.9981s
	iters: 300, epoch: 5 | loss: 0.0000001
	speed: 0.0593s/iter; left time: 2333.7983s
	iters: 400, epoch: 5 | loss: 0.0005898
	speed: 0.0552s/iter; left time: 2165.6206s
Epoch: 5 cost time: 23.894489288330078
Epoch: 5, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.234 Vali Acc: 0.960 Test Loss: 0.234 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0002537
	speed: 0.1614s/iter; left time: 6318.3820s
	iters: 200, epoch: 6 | loss: 0.0031792
	speed: 0.0630s/iter; left time: 2458.5409s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 2130.6650s
	iters: 400, epoch: 6 | loss: 0.0072091
	speed: 0.0633s/iter; left time: 2459.3006s
Epoch: 6 cost time: 24.98113512992859
Epoch: 6, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.211 Vali Acc: 0.971 Test Loss: 0.211 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1673s/iter; left time: 6479.9374s
	iters: 200, epoch: 7 | loss: 0.0156121
	speed: 0.0578s/iter; left time: 2232.3385s
	iters: 300, epoch: 7 | loss: 0.0399228
	speed: 0.0602s/iter; left time: 2319.4084s
	iters: 400, epoch: 7 | loss: 0.0007965
	speed: 0.0479s/iter; left time: 1841.5740s
Epoch: 7 cost time: 24.2407968044281
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.281 Vali Acc: 0.958 Test Loss: 0.281 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0001164
	speed: 0.1271s/iter; left time: 4870.6320s
	iters: 200, epoch: 8 | loss: 0.0001006
	speed: 0.0439s/iter; left time: 1675.6733s
	iters: 300, epoch: 8 | loss: 0.0000082
	speed: 0.0425s/iter; left time: 1618.2216s
	iters: 400, epoch: 8 | loss: 0.0000013
	speed: 0.0566s/iter; left time: 2149.7467s
Epoch: 8 cost time: 19.64907717704773
Epoch: 8, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.205 Vali Acc: 0.966 Test Loss: 0.205 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.5124616
	speed: 0.1506s/iter; left time: 5708.7926s
	iters: 200, epoch: 9 | loss: 0.0479949
	speed: 0.0544s/iter; left time: 2054.9936s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0532s/iter; left time: 2006.8585s
	iters: 400, epoch: 9 | loss: 0.8926150
	speed: 0.0523s/iter; left time: 1967.4828s
Epoch: 9 cost time: 22.292356729507446
Epoch: 9, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.239 Vali Acc: 0.970 Test Loss: 0.239 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000814
	speed: 0.1519s/iter; left time: 5692.2560s
	iters: 200, epoch: 10 | loss: 0.0010081
	speed: 0.0513s/iter; left time: 1917.6311s
	iters: 300, epoch: 10 | loss: 0.0000134
	speed: 0.0548s/iter; left time: 2043.2294s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0556s/iter; left time: 2068.2653s
Epoch: 10 cost time: 22.326114654541016
Epoch: 10, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.254 Vali Acc: 0.965 Test Loss: 0.254 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.3551611
	speed: 0.1243s/iter; left time: 4609.3324s
	iters: 200, epoch: 11 | loss: 0.0891197
	speed: 0.0338s/iter; left time: 1247.8125s
	iters: 300, epoch: 11 | loss: 0.0000856
	speed: 0.0344s/iter; left time: 1267.9159s
	iters: 400, epoch: 11 | loss: 0.0000579
	speed: 0.0340s/iter; left time: 1250.4644s
Epoch: 11 cost time: 14.677482843399048
Epoch: 11, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.343 Vali Acc: 0.955 Test Loss: 0.343 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0050079
	speed: 0.1145s/iter; left time: 4199.0047s
	iters: 200, epoch: 12 | loss: 0.0007880
	speed: 0.0470s/iter; left time: 1718.8477s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 1754.1512s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1721.2309s
Epoch: 12 cost time: 18.923853874206543
Epoch: 12, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.260 Vali Acc: 0.966 Test Loss: 0.260 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000294
	speed: 0.1444s/iter; left time: 5233.9558s
	iters: 200, epoch: 13 | loss: 0.0094524
	speed: 0.0489s/iter; left time: 1765.7747s
	iters: 300, epoch: 13 | loss: 0.0000007
	speed: 0.0384s/iter; left time: 1384.1876s
	iters: 400, epoch: 13 | loss: 0.0000069
	speed: 0.0472s/iter; left time: 1697.5790s
Epoch: 13 cost time: 19.318061351776123
Epoch: 13, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.297 Vali Acc: 0.960 Test Loss: 0.297 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000016
	speed: 0.1293s/iter; left time: 4633.2051s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 1691.9859s
	iters: 300, epoch: 14 | loss: 0.0164033
	speed: 0.0462s/iter; left time: 1646.9131s
	iters: 400, epoch: 14 | loss: 0.0000020
	speed: 0.0421s/iter; left time: 1496.0168s
Epoch: 14 cost time: 18.558263301849365
Epoch: 14, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.269 Vali Acc: 0.967 Test Loss: 0.269 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9708958617553434
model parameter : 114026
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4549195
	speed: 0.0628s/iter; left time: 2587.1064s
	iters: 200, epoch: 1 | loss: 0.0654195
	speed: 0.0482s/iter; left time: 1980.6418s
	iters: 300, epoch: 1 | loss: 0.3255459
	speed: 0.0408s/iter; left time: 1674.3776s
	iters: 400, epoch: 1 | loss: 0.0632064
	speed: 0.0389s/iter; left time: 1590.1540s
Epoch: 1 cost time: 19.635071754455566
Epoch: 1, Steps: 413 | Train Loss: 0.426 Vali Loss: 0.123 Vali Acc: 0.960 Test Loss: 0.123 Test Acc: 0.960
Validation loss decreased (inf --> -0.960435).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2721000
	speed: 0.1051s/iter; left time: 4286.1884s
	iters: 200, epoch: 2 | loss: 0.0209680
	speed: 0.0369s/iter; left time: 1502.1812s
	iters: 300, epoch: 2 | loss: 0.1270492
	speed: 0.0492s/iter; left time: 1997.2837s
	iters: 400, epoch: 2 | loss: 0.0088845
	speed: 0.0528s/iter; left time: 2137.2933s
Epoch: 2 cost time: 18.57494020462036
Epoch: 2, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0246955
	speed: 0.1323s/iter; left time: 5341.5762s
	iters: 200, epoch: 3 | loss: 0.0003402
	speed: 0.0471s/iter; left time: 1896.2036s
	iters: 300, epoch: 3 | loss: 0.0508475
	speed: 0.0491s/iter; left time: 1971.9404s
	iters: 400, epoch: 3 | loss: 0.0123813
	speed: 0.0484s/iter; left time: 1937.9521s
Epoch: 3 cost time: 20.285749435424805
Epoch: 3, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.960435 --> -0.968166).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0577655
	speed: 0.1373s/iter; left time: 5486.2795s
	iters: 200, epoch: 4 | loss: 0.0021365
	speed: 0.0484s/iter; left time: 1930.9468s
	iters: 300, epoch: 4 | loss: 0.0010526
	speed: 0.0462s/iter; left time: 1838.2071s
	iters: 400, epoch: 4 | loss: 0.0001754
	speed: 0.0408s/iter; left time: 1619.8296s
Epoch: 4 cost time: 19.32809615135193
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0025150
	speed: 0.1295s/iter; left time: 5121.2581s
	iters: 200, epoch: 5 | loss: 0.0040999
	speed: 0.0385s/iter; left time: 1517.6877s
	iters: 300, epoch: 5 | loss: 0.0171088
	speed: 0.0364s/iter; left time: 1430.3714s
	iters: 400, epoch: 5 | loss: 0.0025610
	speed: 0.0356s/iter; left time: 1398.5412s
Epoch: 5 cost time: 16.03472089767456
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0009237
	speed: 0.1150s/iter; left time: 4498.9473s
	iters: 200, epoch: 6 | loss: 0.0023698
	speed: 0.0427s/iter; left time: 1667.2811s
	iters: 300, epoch: 6 | loss: 0.0052138
	speed: 0.0431s/iter; left time: 1677.8821s
	iters: 400, epoch: 6 | loss: 0.2098652
	speed: 0.0454s/iter; left time: 1763.9344s
Epoch: 6 cost time: 18.007179021835327
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
Validation loss decreased (-0.968166 --> -0.975897).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0799400
	speed: 0.1294s/iter; left time: 5011.8417s
	iters: 200, epoch: 7 | loss: 0.0000355
	speed: 0.0428s/iter; left time: 1653.4255s
	iters: 300, epoch: 7 | loss: 0.0003970
	speed: 0.0412s/iter; left time: 1586.2403s
	iters: 400, epoch: 7 | loss: 0.0002900
	speed: 0.0435s/iter; left time: 1670.0174s
Epoch: 7 cost time: 18.123969554901123
Epoch: 7, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.170 Vali Acc: 0.963 Test Loss: 0.170 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0011112
	speed: 0.1305s/iter; left time: 5000.8293s
	iters: 200, epoch: 8 | loss: 0.0946328
	speed: 0.0418s/iter; left time: 1598.8829s
	iters: 300, epoch: 8 | loss: 0.0000296
	speed: 0.0394s/iter; left time: 1500.5955s
	iters: 400, epoch: 8 | loss: 0.0001357
	speed: 0.0338s/iter; left time: 1285.5360s
Epoch: 8 cost time: 16.87823724746704
Epoch: 8, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.212 Vali Acc: 0.962 Test Loss: 0.212 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000467
	speed: 0.1133s/iter; left time: 4291.9241s
	iters: 200, epoch: 9 | loss: 0.0015005
	speed: 0.0313s/iter; left time: 1182.9300s
	iters: 300, epoch: 9 | loss: 0.0000004
	speed: 0.0308s/iter; left time: 1162.2022s
	iters: 400, epoch: 9 | loss: 0.0000519
	speed: 0.0321s/iter; left time: 1207.1641s
Epoch: 9 cost time: 13.206048011779785
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.171 Vali Acc: 0.968 Test Loss: 0.171 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000036
	speed: 0.1113s/iter; left time: 4170.9184s
	iters: 200, epoch: 10 | loss: 0.0000022
	speed: 0.0331s/iter; left time: 1238.3638s
	iters: 300, epoch: 10 | loss: 0.0009626
	speed: 0.0354s/iter; left time: 1318.5159s
	iters: 400, epoch: 10 | loss: 0.1162601
	speed: 0.0341s/iter; left time: 1268.4118s
Epoch: 10 cost time: 14.992267608642578
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.313 Vali Acc: 0.960 Test Loss: 0.313 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000624
	speed: 0.1118s/iter; left time: 4145.8266s
	iters: 200, epoch: 11 | loss: 0.0000192
	speed: 0.0355s/iter; left time: 1310.8490s
	iters: 300, epoch: 11 | loss: 0.0098831
	speed: 0.0352s/iter; left time: 1297.3346s
	iters: 400, epoch: 11 | loss: 0.0000013
	speed: 0.0341s/iter; left time: 1253.5644s
Epoch: 11 cost time: 14.817514419555664
Epoch: 11, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.233 Vali Acc: 0.965 Test Loss: 0.233 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.1092s/iter; left time: 4003.9120s
	iters: 200, epoch: 12 | loss: 0.0913239
	speed: 0.0321s/iter; left time: 1174.4183s
	iters: 300, epoch: 12 | loss: 0.0000064
	speed: 0.0419s/iter; left time: 1526.7968s
	iters: 400, epoch: 12 | loss: 0.0000028
	speed: 0.0444s/iter; left time: 1614.5959s
Epoch: 12 cost time: 16.37742590904236
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.305 Vali Acc: 0.960 Test Loss: 0.305 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.1257s/iter; left time: 4555.8841s
	iters: 200, epoch: 13 | loss: 0.0012947
	speed: 0.0430s/iter; left time: 1553.3289s
	iters: 300, epoch: 13 | loss: 0.0032162
	speed: 0.0452s/iter; left time: 1629.5526s
	iters: 400, epoch: 13 | loss: 0.0000218
	speed: 0.0466s/iter; left time: 1674.7108s
Epoch: 13 cost time: 18.993531465530396
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.170 Vali Acc: 0.973 Test Loss: 0.170 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.1207s/iter; left time: 4323.6907s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 1359.2999s
	iters: 300, epoch: 14 | loss: 0.0000195
	speed: 0.0386s/iter; left time: 1375.3738s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 1360.9248s
Epoch: 14 cost time: 16.01055645942688
Epoch: 14, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.305 Vali Acc: 0.961 Test Loss: 0.305 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2401394
	speed: 0.1451s/iter; left time: 5140.2402s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 1846.1778s
	iters: 300, epoch: 15 | loss: 0.0000087
	speed: 0.0610s/iter; left time: 2148.6379s
	iters: 400, epoch: 15 | loss: 0.0000004
	speed: 0.0580s/iter; left time: 2035.4251s
Epoch: 15 cost time: 23.83597469329834
Epoch: 15, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.182 Vali Acc: 0.974 Test Loss: 0.182 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0426186
	speed: 0.1493s/iter; left time: 5227.1652s
	iters: 200, epoch: 16 | loss: 0.0562774
	speed: 0.0518s/iter; left time: 1808.2425s
	iters: 300, epoch: 16 | loss: 0.0045284
	speed: 0.0556s/iter; left time: 1936.8914s
	iters: 400, epoch: 16 | loss: 0.0000002
	speed: 0.0588s/iter; left time: 2041.3701s
Epoch: 16 cost time: 23.975963592529297
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.352 Vali Acc: 0.952 Test Loss: 0.352 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9758981355161437
model parameter : 80778
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3897206
	speed: 0.0771s/iter; left time: 3178.2060s
	iters: 200, epoch: 1 | loss: 0.4933131
	speed: 0.0484s/iter; left time: 1987.9795s
	iters: 300, epoch: 1 | loss: 0.5156670
	speed: 0.0503s/iter; left time: 2060.9831s
	iters: 400, epoch: 1 | loss: 0.1010954
	speed: 0.0592s/iter; left time: 2419.6448s
Epoch: 1 cost time: 24.32442831993103
Epoch: 1, Steps: 413 | Train Loss: 0.492 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
Validation loss decreased (inf --> -0.950885).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0366293
	speed: 0.1472s/iter; left time: 6002.7907s
	iters: 200, epoch: 2 | loss: 0.0190971
	speed: 0.0547s/iter; left time: 2224.5903s
	iters: 300, epoch: 2 | loss: 0.0461222
	speed: 0.0462s/iter; left time: 1874.3656s
	iters: 400, epoch: 2 | loss: 0.0057458
	speed: 0.0576s/iter; left time: 2330.7005s
Epoch: 2 cost time: 22.818097829818726
Epoch: 2, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.102 Vali Acc: 0.967 Test Loss: 0.102 Test Acc: 0.967
Validation loss decreased (-0.950885 --> -0.967257).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0299828
	speed: 0.1438s/iter; left time: 5807.8466s
	iters: 200, epoch: 3 | loss: 0.0008281
	speed: 0.0590s/iter; left time: 2375.5711s
	iters: 300, epoch: 3 | loss: 0.0077050
	speed: 0.0506s/iter; left time: 2033.7202s
	iters: 400, epoch: 3 | loss: 0.0570300
	speed: 0.0542s/iter; left time: 2170.3664s
Epoch: 3 cost time: 22.952675819396973
Epoch: 3, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
Validation loss decreased (-0.967257 --> -0.968166).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0002994
	speed: 0.1407s/iter; left time: 5623.7028s
	iters: 200, epoch: 4 | loss: 0.0907486
	speed: 0.0585s/iter; left time: 2330.4341s
	iters: 300, epoch: 4 | loss: 0.0079157
	speed: 0.0524s/iter; left time: 2081.9608s
	iters: 400, epoch: 4 | loss: 0.0013576
	speed: 0.0496s/iter; left time: 1966.7140s
Epoch: 4 cost time: 22.168045043945312
Epoch: 4, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
Validation loss decreased (-0.968166 --> -0.970895).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0010555
	speed: 0.1330s/iter; left time: 5261.1476s
	iters: 200, epoch: 5 | loss: 0.2658062
	speed: 0.0483s/iter; left time: 1906.1008s
	iters: 300, epoch: 5 | loss: 0.0748323
	speed: 0.0347s/iter; left time: 1365.1674s
	iters: 400, epoch: 5 | loss: 0.0007787
	speed: 0.0452s/iter; left time: 1772.1618s
Epoch: 5 cost time: 18.745484113693237
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
Validation loss decreased (-0.970895 --> -0.973623).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0006833
	speed: 0.1308s/iter; left time: 5118.3791s
	iters: 200, epoch: 6 | loss: 0.0002444
	speed: 0.0487s/iter; left time: 1902.6140s
	iters: 300, epoch: 6 | loss: 0.0029905
	speed: 0.0406s/iter; left time: 1579.0818s
	iters: 400, epoch: 6 | loss: 0.0022959
	speed: 0.0402s/iter; left time: 1559.5715s
Epoch: 6 cost time: 18.169570922851562
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.184 Vali Acc: 0.961 Test Loss: 0.184 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3186491
	speed: 0.1237s/iter; left time: 4789.7468s
	iters: 200, epoch: 7 | loss: 0.0000793
	speed: 0.0332s/iter; left time: 1283.3341s
	iters: 300, epoch: 7 | loss: 0.0000674
	speed: 0.0286s/iter; left time: 1101.4808s
	iters: 400, epoch: 7 | loss: 0.0054121
	speed: 0.0293s/iter; left time: 1126.3644s
Epoch: 7 cost time: 13.536510944366455
Epoch: 7, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000152
	speed: 0.1048s/iter; left time: 4015.6784s
	iters: 200, epoch: 8 | loss: 0.0644898
	speed: 0.0309s/iter; left time: 1179.1181s
	iters: 300, epoch: 8 | loss: 0.0025351
	speed: 0.0395s/iter; left time: 1504.7654s
	iters: 400, epoch: 8 | loss: 0.0179265
	speed: 0.0434s/iter; left time: 1651.4120s
Epoch: 8 cost time: 15.348994970321655
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
Validation loss decreased (-0.973623 --> -0.978171).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0014529
	speed: 0.1304s/iter; left time: 4940.8123s
	iters: 200, epoch: 9 | loss: 0.0000237
	speed: 0.0434s/iter; left time: 1641.3271s
	iters: 300, epoch: 9 | loss: 0.0000284
	speed: 0.0544s/iter; left time: 2051.5453s
	iters: 400, epoch: 9 | loss: 0.0002435
	speed: 0.0421s/iter; left time: 1582.2567s
Epoch: 9 cost time: 20.07031512260437
Epoch: 9, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.153 Vali Acc: 0.971 Test Loss: 0.153 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000904
	speed: 0.1412s/iter; left time: 5293.8826s
	iters: 200, epoch: 10 | loss: 0.0000694
	speed: 0.0501s/iter; left time: 1874.2330s
	iters: 300, epoch: 10 | loss: 0.0023563
	speed: 0.0482s/iter; left time: 1796.0896s
	iters: 400, epoch: 10 | loss: 0.0203815
	speed: 0.0455s/iter; left time: 1691.2258s
Epoch: 10 cost time: 20.856626272201538
Epoch: 10, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0026282
	speed: 0.1372s/iter; left time: 5085.8039s
	iters: 200, epoch: 11 | loss: 0.0000054
	speed: 0.0487s/iter; left time: 1799.2129s
	iters: 300, epoch: 11 | loss: 0.1149734
	speed: 0.0478s/iter; left time: 1762.0477s
	iters: 400, epoch: 11 | loss: 0.0039571
	speed: 0.0504s/iter; left time: 1854.6686s
Epoch: 11 cost time: 20.91590142250061
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000062
	speed: 0.1277s/iter; left time: 4680.7093s
	iters: 200, epoch: 12 | loss: 0.2716140
	speed: 0.0364s/iter; left time: 1332.4341s
	iters: 300, epoch: 12 | loss: 0.0000744
	speed: 0.0340s/iter; left time: 1240.6024s
	iters: 400, epoch: 12 | loss: 0.0001583
	speed: 0.0374s/iter; left time: 1358.3026s
Epoch: 12 cost time: 16.16134476661682
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.123 Vali Acc: 0.979 Test Loss: 0.123 Test Acc: 0.979
Validation loss decreased (-0.978171 --> -0.979080).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.1059s/iter; left time: 3839.1909s
	iters: 200, epoch: 13 | loss: 0.0000059
	speed: 0.0352s/iter; left time: 1273.1505s
	iters: 300, epoch: 13 | loss: 0.0005023
	speed: 0.0350s/iter; left time: 1260.8467s
	iters: 400, epoch: 13 | loss: 0.0000003
	speed: 0.0472s/iter; left time: 1695.6846s
Epoch: 13 cost time: 16.107671976089478
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0331207
	speed: 0.1311s/iter; left time: 4696.1929s
	iters: 200, epoch: 14 | loss: 0.0001749
	speed: 0.0466s/iter; left time: 1665.6989s
	iters: 300, epoch: 14 | loss: 0.0000188
	speed: 0.0443s/iter; left time: 1579.8909s
	iters: 400, epoch: 14 | loss: 0.0155828
	speed: 0.0473s/iter; left time: 1679.7342s
Epoch: 14 cost time: 19.502410650253296
Epoch: 14, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.182 Vali Acc: 0.976 Test Loss: 0.182 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0260099
	speed: 0.1338s/iter; left time: 4739.7466s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0486s/iter; left time: 1716.6864s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 1563.6208s
	iters: 400, epoch: 15 | loss: 0.0002243
	speed: 0.0453s/iter; left time: 1591.2119s
Epoch: 15 cost time: 19.4413800239563
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.184 Vali Acc: 0.970 Test Loss: 0.184 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000073
	speed: 0.1247s/iter; left time: 4364.2887s
	iters: 200, epoch: 16 | loss: 0.0000181
	speed: 0.0433s/iter; left time: 1509.8510s
	iters: 300, epoch: 16 | loss: 0.0002461
	speed: 0.0415s/iter; left time: 1443.2775s
	iters: 400, epoch: 16 | loss: 0.0129880
	speed: 0.0448s/iter; left time: 1554.4081s
Epoch: 16 cost time: 17.96947693824768
Epoch: 16, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.212 Vali Acc: 0.970 Test Loss: 0.212 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000258
	speed: 0.1053s/iter; left time: 3644.0927s
	iters: 200, epoch: 17 | loss: 0.0000073
	speed: 0.0293s/iter; left time: 1010.2133s
	iters: 300, epoch: 17 | loss: 0.0000010
	speed: 0.0296s/iter; left time: 1017.2347s
	iters: 400, epoch: 17 | loss: 0.0756857
	speed: 0.0296s/iter; left time: 1014.0702s
Epoch: 17 cost time: 12.61540961265564
Epoch: 17, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.297 Vali Acc: 0.959 Test Loss: 0.297 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000017
	speed: 0.1184s/iter; left time: 4047.4514s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.0341s/iter; left time: 1160.7284s
	iters: 300, epoch: 18 | loss: 0.1412947
	speed: 0.0399s/iter; left time: 1357.3482s
	iters: 400, epoch: 18 | loss: 0.0000016
	speed: 0.0389s/iter; left time: 1317.6916s
Epoch: 18 cost time: 16.011277198791504
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.972 Test Loss: 0.206 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0189466
	speed: 0.1178s/iter; left time: 3979.0826s
	iters: 200, epoch: 19 | loss: 0.0000006
	speed: 0.0359s/iter; left time: 1208.2536s
	iters: 300, epoch: 19 | loss: 0.0008730
	speed: 0.0355s/iter; left time: 1191.5026s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 1286.2603s
Epoch: 19 cost time: 15.63860535621643
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.271 Vali Acc: 0.969 Test Loss: 0.271 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000010
	speed: 0.1192s/iter; left time: 3975.7388s
	iters: 200, epoch: 20 | loss: 0.0021389
	speed: 0.0402s/iter; left time: 1337.4364s
	iters: 300, epoch: 20 | loss: 0.0001237
	speed: 0.0357s/iter; left time: 1183.8966s
	iters: 400, epoch: 20 | loss: 0.0028434
	speed: 0.0314s/iter; left time: 1037.0625s
Epoch: 20 cost time: 15.256787300109863
Epoch: 20, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.970 Test Loss: 0.195 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000135
	speed: 0.1181s/iter; left time: 3889.0949s
	iters: 200, epoch: 21 | loss: 0.0004892
	speed: 0.0430s/iter; left time: 1413.4021s
	iters: 300, epoch: 21 | loss: 0.1799358
	speed: 0.0458s/iter; left time: 1499.2172s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0453s/iter; left time: 1477.5856s
Epoch: 21 cost time: 18.264235734939575
Epoch: 21, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.214 Vali Acc: 0.970 Test Loss: 0.214 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0037438
	speed: 0.1286s/iter; left time: 4182.3121s
	iters: 200, epoch: 22 | loss: 0.0000454
	speed: 0.0381s/iter; left time: 1235.3787s
	iters: 300, epoch: 22 | loss: 0.4173851
	speed: 0.0441s/iter; left time: 1426.1453s
	iters: 400, epoch: 22 | loss: 0.0047388
	speed: 0.0377s/iter; left time: 1215.8890s
Epoch: 22 cost time: 17.300859212875366
Epoch: 22, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.236 Vali Acc: 0.972 Test Loss: 0.236 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
model parameter : 64170
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6276324
	speed: 0.0630s/iter; left time: 2596.0615s
	iters: 200, epoch: 1 | loss: 0.0472125
	speed: 0.0445s/iter; left time: 1829.6669s
	iters: 300, epoch: 1 | loss: 0.2116992
	speed: 0.0451s/iter; left time: 1851.0030s
	iters: 400, epoch: 1 | loss: 0.0932963
	speed: 0.0440s/iter; left time: 1801.4291s
Epoch: 1 cost time: 20.25228190422058
Epoch: 1, Steps: 413 | Train Loss: 0.512 Vali Loss: 0.116 Vali Acc: 0.961 Test Loss: 0.116 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0176218
	speed: 0.1302s/iter; left time: 5309.8772s
	iters: 200, epoch: 2 | loss: 0.0096409
	speed: 0.0417s/iter; left time: 1694.8924s
	iters: 300, epoch: 2 | loss: 0.1905587
	speed: 0.0412s/iter; left time: 1673.8540s
	iters: 400, epoch: 2 | loss: 0.2273647
	speed: 0.0405s/iter; left time: 1638.6239s
Epoch: 2 cost time: 17.59619903564453
Epoch: 2, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
Validation loss decreased (-0.960890 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1116434
	speed: 0.1222s/iter; left time: 4934.5157s
	iters: 200, epoch: 3 | loss: 0.0044417
	speed: 0.0370s/iter; left time: 1490.9800s
	iters: 300, epoch: 3 | loss: 0.1177786
	speed: 0.0442s/iter; left time: 1774.4792s
	iters: 400, epoch: 3 | loss: 0.0226070
	speed: 0.0430s/iter; left time: 1721.7322s
Epoch: 3 cost time: 17.56578826904297
Epoch: 3, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.107 Vali Acc: 0.964 Test Loss: 0.107 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0003144
	speed: 0.1250s/iter; left time: 4995.2919s
	iters: 200, epoch: 4 | loss: 0.0024053
	speed: 0.0359s/iter; left time: 1430.3258s
	iters: 300, epoch: 4 | loss: 0.0308835
	speed: 0.0363s/iter; left time: 1441.4890s
	iters: 400, epoch: 4 | loss: 0.1176481
	speed: 0.0373s/iter; left time: 1481.3458s
Epoch: 4 cost time: 15.821660041809082
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.114 Vali Acc: 0.960 Test Loss: 0.114 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0941644
	speed: 0.1163s/iter; left time: 4601.3261s
	iters: 200, epoch: 5 | loss: 0.0578836
	speed: 0.0448s/iter; left time: 1768.4721s
	iters: 300, epoch: 5 | loss: 0.0028063
	speed: 0.0439s/iter; left time: 1727.0070s
	iters: 400, epoch: 5 | loss: 0.0014143
	speed: 0.0429s/iter; left time: 1684.0435s
Epoch: 5 cost time: 17.741684198379517
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
Validation loss decreased (-0.968621 --> -0.970895).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0120899
	speed: 0.1093s/iter; left time: 4276.0750s
	iters: 200, epoch: 6 | loss: 0.0022799
	speed: 0.0380s/iter; left time: 1483.7872s
	iters: 300, epoch: 6 | loss: 0.0019937
	speed: 0.0355s/iter; left time: 1381.1184s
	iters: 400, epoch: 6 | loss: 0.1270129
	speed: 0.0349s/iter; left time: 1355.8480s
Epoch: 6 cost time: 14.746588706970215
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.970895 --> -0.973623).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000067
	speed: 0.1053s/iter; left time: 4076.8362s
	iters: 200, epoch: 7 | loss: 0.0002732
	speed: 0.0337s/iter; left time: 1301.6223s
	iters: 300, epoch: 7 | loss: 0.0005501
	speed: 0.0303s/iter; left time: 1166.3128s
	iters: 400, epoch: 7 | loss: 0.0003372
	speed: 0.0331s/iter; left time: 1272.5609s
Epoch: 7 cost time: 13.991107702255249
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0614756
	speed: 0.1144s/iter; left time: 4380.9466s
	iters: 200, epoch: 8 | loss: 0.0000981
	speed: 0.0322s/iter; left time: 1230.1487s
	iters: 300, epoch: 8 | loss: 0.0003233
	speed: 0.0317s/iter; left time: 1208.9623s
	iters: 400, epoch: 8 | loss: 0.0063314
	speed: 0.0350s/iter; left time: 1329.1863s
Epoch: 8 cost time: 14.360223054885864
Epoch: 8, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (-0.973623 --> -0.979081).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0002676
	speed: 0.1058s/iter; left time: 4008.4895s
	iters: 200, epoch: 9 | loss: 0.0002639
	speed: 0.0332s/iter; left time: 1255.0110s
	iters: 300, epoch: 9 | loss: 0.1035946
	speed: 0.0348s/iter; left time: 1311.5155s
	iters: 400, epoch: 9 | loss: 0.0007830
	speed: 0.0349s/iter; left time: 1313.7699s
Epoch: 9 cost time: 13.995945692062378
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0076622
	speed: 0.1169s/iter; left time: 4380.1921s
	iters: 200, epoch: 10 | loss: 0.0130538
	speed: 0.0401s/iter; left time: 1498.5018s
	iters: 300, epoch: 10 | loss: 0.0002363
	speed: 0.0415s/iter; left time: 1547.7740s
	iters: 400, epoch: 10 | loss: 0.3411994
	speed: 0.0408s/iter; left time: 1515.6754s
Epoch: 10 cost time: 17.013723134994507
Epoch: 10, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.979081 --> -0.981354).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000762
	speed: 0.1199s/iter; left time: 4444.5360s
	iters: 200, epoch: 11 | loss: 0.0021652
	speed: 0.0417s/iter; left time: 1541.1641s
	iters: 300, epoch: 11 | loss: 0.0000035
	speed: 0.0349s/iter; left time: 1286.5931s
	iters: 400, epoch: 11 | loss: 0.0018498
	speed: 0.0327s/iter; left time: 1202.4238s
Epoch: 11 cost time: 15.672616958618164
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.213 Vali Acc: 0.965 Test Loss: 0.213 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0001365
	speed: 0.1104s/iter; left time: 4048.4486s
	iters: 200, epoch: 12 | loss: 0.0171261
	speed: 0.0355s/iter; left time: 1299.2297s
	iters: 300, epoch: 12 | loss: 0.0005945
	speed: 0.0423s/iter; left time: 1541.3261s
	iters: 400, epoch: 12 | loss: 0.0006875
	speed: 0.0392s/iter; left time: 1424.0679s
Epoch: 12 cost time: 16.21754264831543
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.1263s/iter; left time: 4576.0269s
	iters: 200, epoch: 13 | loss: 0.0664534
	speed: 0.0396s/iter; left time: 1431.4453s
	iters: 300, epoch: 13 | loss: 0.0006412
	speed: 0.0392s/iter; left time: 1412.4610s
	iters: 400, epoch: 13 | loss: 0.0055197
	speed: 0.0418s/iter; left time: 1503.6409s
Epoch: 13 cost time: 17.082155227661133
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000961
	speed: 0.1251s/iter; left time: 4481.8605s
	iters: 200, epoch: 14 | loss: 0.0002759
	speed: 0.0379s/iter; left time: 1354.2096s
	iters: 300, epoch: 14 | loss: 0.0000002
	speed: 0.0373s/iter; left time: 1330.4134s
	iters: 400, epoch: 14 | loss: 0.0041790
	speed: 0.0372s/iter; left time: 1322.9825s
Epoch: 14 cost time: 16.35520076751709
Epoch: 14, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0130790
	speed: 0.1153s/iter; left time: 4082.3037s
	iters: 200, epoch: 15 | loss: 0.2262272
	speed: 0.0391s/iter; left time: 1380.0489s
	iters: 300, epoch: 15 | loss: 0.0000003
	speed: 0.0439s/iter; left time: 1546.5739s
	iters: 400, epoch: 15 | loss: 0.0004557
	speed: 0.0579s/iter; left time: 2032.3521s
Epoch: 15 cost time: 18.980093717575073
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0008449
	speed: 0.1477s/iter; left time: 5170.3867s
	iters: 200, epoch: 16 | loss: 0.1871559
	speed: 0.0505s/iter; left time: 1761.7974s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 1859.1697s
	iters: 400, epoch: 16 | loss: 0.0000739
	speed: 0.0585s/iter; left time: 2030.5567s
Epoch: 16 cost time: 23.280401468276978
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1478s/iter; left time: 5113.1148s
	iters: 200, epoch: 17 | loss: 0.0913891
	speed: 0.0483s/iter; left time: 1666.9636s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 1957.0577s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 2032.3591s
Epoch: 17 cost time: 23.207666635513306
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000009
	speed: 0.1439s/iter; left time: 4919.5663s
	iters: 200, epoch: 18 | loss: 0.0000082
	speed: 0.0417s/iter; left time: 1419.9996s
	iters: 300, epoch: 18 | loss: 0.0001307
	speed: 0.0555s/iter; left time: 1887.1532s
	iters: 400, epoch: 18 | loss: 0.0000146
	speed: 0.0457s/iter; left time: 1548.4478s
Epoch: 18 cost time: 20.00989842414856
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000311
	speed: 0.1316s/iter; left time: 4443.6756s
	iters: 200, epoch: 19 | loss: 0.0000484
	speed: 0.0396s/iter; left time: 1331.9548s
	iters: 300, epoch: 19 | loss: 0.0000003
	speed: 0.0485s/iter; left time: 1629.5348s
	iters: 400, epoch: 19 | loss: 0.0001606
	speed: 0.0385s/iter; left time: 1287.1546s
Epoch: 19 cost time: 17.754752159118652
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0002475
	speed: 0.1292s/iter; left time: 4308.9846s
	iters: 200, epoch: 20 | loss: 0.0000919
	speed: 0.0394s/iter; left time: 1309.3224s
	iters: 300, epoch: 20 | loss: 0.0033172
	speed: 0.0524s/iter; left time: 1737.2574s
	iters: 400, epoch: 20 | loss: 0.0000002
	speed: 0.0442s/iter; left time: 1461.9959s
Epoch: 20 cost time: 18.869184017181396
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.177 Vali Acc: 0.977 Test Loss: 0.177 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 53818
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7341535
	speed: 0.0491s/iter; left time: 2021.7111s
	iters: 200, epoch: 1 | loss: 0.2954108
	speed: 0.0321s/iter; left time: 1320.5618s
	iters: 300, epoch: 1 | loss: 0.8838395
	speed: 0.0324s/iter; left time: 1330.0683s
	iters: 400, epoch: 1 | loss: 0.2168321
	speed: 0.0333s/iter; left time: 1360.2843s
Epoch: 1 cost time: 15.214539766311646
Epoch: 1, Steps: 413 | Train Loss: 0.604 Vali Loss: 0.138 Vali Acc: 0.953 Test Loss: 0.138 Test Acc: 0.953
Validation loss decreased (inf --> -0.953159).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2001155
	speed: 0.1337s/iter; left time: 5454.4582s
	iters: 200, epoch: 2 | loss: 0.2966536
	speed: 0.0475s/iter; left time: 1934.4080s
	iters: 300, epoch: 2 | loss: 0.0343967
	speed: 0.0432s/iter; left time: 1753.5531s
	iters: 400, epoch: 2 | loss: 0.0345105
	speed: 0.0496s/iter; left time: 2007.0921s
Epoch: 2 cost time: 20.142650842666626
Epoch: 2, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.084 Vali Acc: 0.969 Test Loss: 0.084 Test Acc: 0.969
Validation loss decreased (-0.953159 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1214531
	speed: 0.1369s/iter; left time: 5526.7230s
	iters: 200, epoch: 3 | loss: 0.0301981
	speed: 0.0399s/iter; left time: 1606.3327s
	iters: 300, epoch: 3 | loss: 0.0228646
	speed: 0.0488s/iter; left time: 1960.2807s
	iters: 400, epoch: 3 | loss: 0.0306372
	speed: 0.0485s/iter; left time: 1944.6889s
Epoch: 3 cost time: 19.900129556655884
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.092 Vali Acc: 0.964 Test Loss: 0.092 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0053103
	speed: 0.1264s/iter; left time: 5051.3921s
	iters: 200, epoch: 4 | loss: 0.2383339
	speed: 0.0441s/iter; left time: 1758.5900s
	iters: 300, epoch: 4 | loss: 0.0096948
	speed: 0.0480s/iter; left time: 1907.6592s
	iters: 400, epoch: 4 | loss: 0.0212434
	speed: 0.0382s/iter; left time: 1514.4578s
Epoch: 4 cost time: 18.477843284606934
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.067 Vali Acc: 0.975 Test Loss: 0.067 Test Acc: 0.975
Validation loss decreased (-0.968621 --> -0.974988).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0081116
	speed: 0.1326s/iter; left time: 5242.3831s
	iters: 200, epoch: 5 | loss: 0.0122188
	speed: 0.0501s/iter; left time: 1975.3862s
	iters: 300, epoch: 5 | loss: 0.0259085
	speed: 0.0482s/iter; left time: 1895.3181s
	iters: 400, epoch: 5 | loss: 0.0001839
	speed: 0.0435s/iter; left time: 1709.1297s
Epoch: 5 cost time: 19.413497924804688
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.128 Vali Acc: 0.960 Test Loss: 0.128 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0005782
	speed: 0.1389s/iter; left time: 5437.5299s
	iters: 200, epoch: 6 | loss: 0.2136797
	speed: 0.0510s/iter; left time: 1991.3926s
	iters: 300, epoch: 6 | loss: 0.0405618
	speed: 0.0416s/iter; left time: 1620.5030s
	iters: 400, epoch: 6 | loss: 0.0791079
	speed: 0.0482s/iter; left time: 1870.0573s
Epoch: 6 cost time: 19.713160037994385
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.974988 --> -0.975897).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0171926
	speed: 0.1338s/iter; left time: 5179.2108s
	iters: 200, epoch: 7 | loss: 0.0249487
	speed: 0.0368s/iter; left time: 1421.0572s
	iters: 300, epoch: 7 | loss: 0.1056376
	speed: 0.0337s/iter; left time: 1299.9544s
	iters: 400, epoch: 7 | loss: 0.0013406
	speed: 0.0340s/iter; left time: 1305.6697s
Epoch: 7 cost time: 16.137422561645508
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0049339
	speed: 0.1052s/iter; left time: 4030.8116s
	iters: 200, epoch: 8 | loss: 0.0212653
	speed: 0.0338s/iter; left time: 1292.3902s
	iters: 300, epoch: 8 | loss: 0.0352498
	speed: 0.0362s/iter; left time: 1378.8285s
	iters: 400, epoch: 8 | loss: 0.0536114
	speed: 0.0311s/iter; left time: 1180.6083s
Epoch: 8 cost time: 14.352257013320923
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0023650
	speed: 0.1142s/iter; left time: 4328.6581s
	iters: 200, epoch: 9 | loss: 0.0004775
	speed: 0.0358s/iter; left time: 1354.2682s
	iters: 300, epoch: 9 | loss: 0.0045469
	speed: 0.0406s/iter; left time: 1530.0723s
	iters: 400, epoch: 9 | loss: 0.0027280
	speed: 0.0321s/iter; left time: 1208.4421s
Epoch: 9 cost time: 15.087488889694214
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0001682
	speed: 0.1289s/iter; left time: 4831.3632s
	iters: 200, epoch: 10 | loss: 0.0000040
	speed: 0.0303s/iter; left time: 1133.9493s
	iters: 300, epoch: 10 | loss: 0.0015239
	speed: 0.0403s/iter; left time: 1500.9798s
	iters: 400, epoch: 10 | loss: 0.0112746
	speed: 0.0364s/iter; left time: 1354.9867s
Epoch: 10 cost time: 15.684648036956787
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0013314
	speed: 0.1206s/iter; left time: 4469.1309s
	iters: 200, epoch: 11 | loss: 0.1996790
	speed: 0.0305s/iter; left time: 1126.4040s
	iters: 300, epoch: 11 | loss: 0.0000046
	speed: 0.0289s/iter; left time: 1064.0461s
	iters: 400, epoch: 11 | loss: 0.0007275
	speed: 0.0283s/iter; left time: 1041.6386s
Epoch: 11 cost time: 13.388182878494263
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
Validation loss decreased (-0.975897 --> -0.979081).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0071938
	speed: 0.0960s/iter; left time: 3518.9628s
	iters: 200, epoch: 12 | loss: 0.0141347
	speed: 0.0294s/iter; left time: 1073.4578s
	iters: 300, epoch: 12 | loss: 0.0000094
	speed: 0.0280s/iter; left time: 1022.2142s
	iters: 400, epoch: 12 | loss: 0.0001086
	speed: 0.0375s/iter; left time: 1361.8545s
Epoch: 12 cost time: 13.456550121307373
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000014
	speed: 0.1314s/iter; left time: 4760.9124s
	iters: 200, epoch: 13 | loss: 0.0000278
	speed: 0.0429s/iter; left time: 1550.1792s
	iters: 300, epoch: 13 | loss: 0.0000012
	speed: 0.0391s/iter; left time: 1409.6606s
	iters: 400, epoch: 13 | loss: 0.0000794
	speed: 0.0460s/iter; left time: 1654.8374s
Epoch: 13 cost time: 18.392954111099243
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0015354
	speed: 0.1331s/iter; left time: 4768.3841s
	iters: 200, epoch: 14 | loss: 0.0000275
	speed: 0.0438s/iter; left time: 1564.6003s
	iters: 300, epoch: 14 | loss: 0.0037071
	speed: 0.0420s/iter; left time: 1496.5411s
	iters: 400, epoch: 14 | loss: 0.0015457
	speed: 0.0454s/iter; left time: 1611.4994s
Epoch: 14 cost time: 18.458594799041748
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.3686122
	speed: 0.1345s/iter; left time: 4762.5491s
	iters: 200, epoch: 15 | loss: 0.0485684
	speed: 0.0428s/iter; left time: 1512.8746s
	iters: 300, epoch: 15 | loss: 0.0000450
	speed: 0.0451s/iter; left time: 1590.1155s
	iters: 400, epoch: 15 | loss: 0.0000010
	speed: 0.0434s/iter; left time: 1524.2990s
Epoch: 15 cost time: 18.314342737197876
Epoch: 15, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0502292
	speed: 0.1099s/iter; left time: 3848.4083s
	iters: 200, epoch: 16 | loss: 0.0000537
	speed: 0.0313s/iter; left time: 1091.1545s
	iters: 300, epoch: 16 | loss: 0.1021649
	speed: 0.0329s/iter; left time: 1143.8934s
	iters: 400, epoch: 16 | loss: 0.0672258
	speed: 0.0346s/iter; left time: 1199.8639s
Epoch: 16 cost time: 14.032573461532593
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.152 Vali Acc: 0.971 Test Loss: 0.152 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000008
	speed: 0.1209s/iter; left time: 4183.1247s
	iters: 200, epoch: 17 | loss: 0.0000012
	speed: 0.0401s/iter; left time: 1383.8452s
	iters: 300, epoch: 17 | loss: 0.0503242
	speed: 0.0399s/iter; left time: 1373.9887s
	iters: 400, epoch: 17 | loss: 0.0000434
	speed: 0.0403s/iter; left time: 1381.5155s
Epoch: 17 cost time: 17.035722017288208
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0001119
	speed: 0.1248s/iter; left time: 4265.6580s
	iters: 200, epoch: 18 | loss: 0.0010301
	speed: 0.0407s/iter; left time: 1387.3946s
	iters: 300, epoch: 18 | loss: 0.0000943
	speed: 0.0419s/iter; left time: 1425.2567s
	iters: 400, epoch: 18 | loss: 0.0000251
	speed: 0.0406s/iter; left time: 1375.4218s
Epoch: 18 cost time: 17.12239122390747
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.979535).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0001384
	speed: 0.1255s/iter; left time: 4236.0905s
	iters: 200, epoch: 19 | loss: 0.0000006
	speed: 0.0423s/iter; left time: 1423.2968s
	iters: 300, epoch: 19 | loss: 0.0000070
	speed: 0.0418s/iter; left time: 1403.7936s
	iters: 400, epoch: 19 | loss: 0.0013766
	speed: 0.0379s/iter; left time: 1267.1762s
Epoch: 19 cost time: 17.089455366134644
Epoch: 19, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0005682
	speed: 0.0991s/iter; left time: 3303.8361s
	iters: 200, epoch: 20 | loss: 0.0000399
	speed: 0.0294s/iter; left time: 976.5845s
	iters: 300, epoch: 20 | loss: 0.0011322
	speed: 0.0290s/iter; left time: 963.1005s
	iters: 400, epoch: 20 | loss: 0.0000986
	speed: 0.0279s/iter; left time: 921.7877s
Epoch: 20 cost time: 12.40296483039856
Epoch: 20, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979535 --> -0.979535).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000016
	speed: 0.1124s/iter; left time: 3702.0344s
	iters: 200, epoch: 21 | loss: 0.0004700
	speed: 0.0310s/iter; left time: 1016.4672s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.0324s/iter; left time: 1061.7425s
	iters: 400, epoch: 21 | loss: 0.0018207
	speed: 0.0334s/iter; left time: 1089.4624s
Epoch: 21 cost time: 13.930885314941406
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000015
	speed: 0.1095s/iter; left time: 3560.3387s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0293s/iter; left time: 948.8219s
	iters: 300, epoch: 22 | loss: 0.0000981
	speed: 0.0329s/iter; left time: 1062.1692s
	iters: 400, epoch: 22 | loss: 0.0000027
	speed: 0.0334s/iter; left time: 1077.3885s
Epoch: 22 cost time: 13.610056161880493
Epoch: 22, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.966 Test Loss: 0.199 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.4534421
	speed: 0.1111s/iter; left time: 3569.4983s
	iters: 200, epoch: 23 | loss: 0.0000041
	speed: 0.0296s/iter; left time: 946.8100s
	iters: 300, epoch: 23 | loss: 0.0000231
	speed: 0.0338s/iter; left time: 1079.9304s
	iters: 400, epoch: 23 | loss: 0.0005164
	speed: 0.0309s/iter; left time: 983.8174s
Epoch: 23 cost time: 13.463774919509888
Epoch: 23, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.971 Test Loss: 0.188 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000002
	speed: 0.1174s/iter; left time: 3720.9035s
	iters: 200, epoch: 24 | loss: 0.0190232
	speed: 0.0389s/iter; left time: 1230.1556s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.0393s/iter; left time: 1236.7858s
	iters: 400, epoch: 24 | loss: 0.0000007
	speed: 0.0379s/iter; left time: 1190.9489s
Epoch: 24 cost time: 16.697038412094116
Epoch: 24, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.1152s/iter; left time: 3603.9446s
	iters: 200, epoch: 25 | loss: 0.0000014
	speed: 0.0338s/iter; left time: 1053.3280s
	iters: 300, epoch: 25 | loss: 0.0000028
	speed: 0.0331s/iter; left time: 1028.6377s
	iters: 400, epoch: 25 | loss: 0.0000001
	speed: 0.0337s/iter; left time: 1043.5964s
Epoch: 25 cost time: 14.383209943771362
Epoch: 25, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.169 Vali Acc: 0.974 Test Loss: 0.169 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1180s/iter; left time: 3643.8495s
	iters: 200, epoch: 26 | loss: 0.0000007
	speed: 0.0382s/iter; left time: 1174.5985s
	iters: 300, epoch: 26 | loss: 0.0000007
	speed: 0.0365s/iter; left time: 1120.7269s
	iters: 400, epoch: 26 | loss: 0.0001494
	speed: 0.0369s/iter; left time: 1127.4413s
Epoch: 26 cost time: 15.806942224502563
Epoch: 26, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000011
	speed: 0.1177s/iter; left time: 3586.6776s
	iters: 200, epoch: 27 | loss: 0.0000297
	speed: 0.0359s/iter; left time: 1089.8473s
	iters: 300, epoch: 27 | loss: 0.0000043
	speed: 0.0369s/iter; left time: 1118.0939s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0376s/iter; left time: 1135.3673s
Epoch: 27 cost time: 15.652690172195435
Epoch: 27, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.174 Vali Acc: 0.973 Test Loss: 0.174 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0007212
	speed: 0.1202s/iter; left time: 3610.9896s
	iters: 200, epoch: 28 | loss: 0.0004435
	speed: 0.0391s/iter; left time: 1170.2717s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0401s/iter; left time: 1195.8824s
	iters: 400, epoch: 28 | loss: 0.2879763
	speed: 0.0410s/iter; left time: 1218.3077s
Epoch: 28 cost time: 16.760903120040894
Epoch: 28, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000008
	speed: 0.1117s/iter; left time: 3311.0278s
	iters: 200, epoch: 29 | loss: 0.0000057
	speed: 0.0341s/iter; left time: 1007.8661s
	iters: 300, epoch: 29 | loss: 0.0425886
	speed: 0.0340s/iter; left time: 1002.0298s
	iters: 400, epoch: 29 | loss: 0.0049382
	speed: 0.0336s/iter; left time: 986.3490s
Epoch: 29 cost time: 14.355425834655762
Epoch: 29, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1378s/iter; left time: 4025.9312s
	iters: 200, epoch: 30 | loss: 0.0001654
	speed: 0.0479s/iter; left time: 1393.8727s
	iters: 300, epoch: 30 | loss: 0.0000019
	speed: 0.0561s/iter; left time: 1629.6150s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 1525.4930s
Epoch: 30 cost time: 22.272618293762207
Epoch: 30, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 43482
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7769072
	speed: 0.0643s/iter; left time: 2648.5910s
	iters: 200, epoch: 1 | loss: 0.1916385
	speed: 0.0477s/iter; left time: 1962.3425s
	iters: 300, epoch: 1 | loss: 0.2849020
	speed: 0.0362s/iter; left time: 1484.7373s
	iters: 400, epoch: 1 | loss: 0.2466786
	speed: 0.0444s/iter; left time: 1814.7966s
Epoch: 1 cost time: 20.011685132980347
Epoch: 1, Steps: 413 | Train Loss: 0.635 Vali Loss: 0.138 Vali Acc: 0.955 Test Loss: 0.138 Test Acc: 0.955
Validation loss decreased (inf --> -0.955433).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0558352
	speed: 0.1292s/iter; left time: 5270.4375s
	iters: 200, epoch: 2 | loss: 0.0824823
	speed: 0.0475s/iter; left time: 1933.4947s
	iters: 300, epoch: 2 | loss: 0.0262309
	speed: 0.0346s/iter; left time: 1406.2994s
	iters: 400, epoch: 2 | loss: 0.0354056
	speed: 0.0440s/iter; left time: 1781.9824s
Epoch: 2 cost time: 18.008930444717407
Epoch: 2, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.078 Vali Acc: 0.972 Test Loss: 0.078 Test Acc: 0.972
Validation loss decreased (-0.955433 --> -0.971805).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0644320
	speed: 0.1255s/iter; left time: 5067.0056s
	iters: 200, epoch: 3 | loss: 0.0245983
	speed: 0.0492s/iter; left time: 1979.7352s
	iters: 300, epoch: 3 | loss: 0.0233197
	speed: 0.0370s/iter; left time: 1487.8671s
	iters: 400, epoch: 3 | loss: 0.0092619
	speed: 0.0411s/iter; left time: 1647.1605s
Epoch: 3 cost time: 18.095561981201172
Epoch: 3, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.056 Vali Acc: 0.982 Test Loss: 0.056 Test Acc: 0.982
Validation loss decreased (-0.971805 --> -0.981809).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0483381
	speed: 0.1310s/iter; left time: 5236.5804s
	iters: 200, epoch: 4 | loss: 0.0540197
	speed: 0.0443s/iter; left time: 1766.4881s
	iters: 300, epoch: 4 | loss: 0.0044817
	speed: 0.0362s/iter; left time: 1439.2805s
	iters: 400, epoch: 4 | loss: 0.3282806
	speed: 0.0320s/iter; left time: 1268.8171s
Epoch: 4 cost time: 16.797401428222656
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.061 Vali Acc: 0.979 Test Loss: 0.061 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0009702
	speed: 0.1059s/iter; left time: 4187.8201s
	iters: 200, epoch: 5 | loss: 0.0084875
	speed: 0.0342s/iter; left time: 1349.1827s
	iters: 300, epoch: 5 | loss: 0.0894159
	speed: 0.0330s/iter; left time: 1298.3631s
	iters: 400, epoch: 5 | loss: 0.1213065
	speed: 0.0358s/iter; left time: 1403.9708s
Epoch: 5 cost time: 14.665988445281982
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0125834
	speed: 0.1233s/iter; left time: 4825.0923s
	iters: 200, epoch: 6 | loss: 0.0006070
	speed: 0.0454s/iter; left time: 1770.7972s
	iters: 300, epoch: 6 | loss: 0.0042455
	speed: 0.0393s/iter; left time: 1530.1708s
	iters: 400, epoch: 6 | loss: 0.0029379
	speed: 0.0448s/iter; left time: 1741.5837s
Epoch: 6 cost time: 18.06816267967224
Epoch: 6, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.087 Vali Acc: 0.967 Test Loss: 0.087 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0005686
	speed: 0.1205s/iter; left time: 4666.2120s
	iters: 200, epoch: 7 | loss: 0.0037000
	speed: 0.0389s/iter; left time: 1503.4246s
	iters: 300, epoch: 7 | loss: 0.0077959
	speed: 0.0447s/iter; left time: 1722.7029s
	iters: 400, epoch: 7 | loss: 0.0453794
	speed: 0.0459s/iter; left time: 1762.6908s
Epoch: 7 cost time: 18.451491355895996
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.081 Vali Acc: 0.974 Test Loss: 0.081 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0019604
	speed: 0.1275s/iter; left time: 4882.6141s
	iters: 200, epoch: 8 | loss: 0.0199485
	speed: 0.0431s/iter; left time: 1648.5520s
	iters: 300, epoch: 8 | loss: 0.0661876
	speed: 0.0456s/iter; left time: 1739.2690s
	iters: 400, epoch: 8 | loss: 0.0002223
	speed: 0.0385s/iter; left time: 1462.9715s
Epoch: 8 cost time: 17.8656063079834
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0159247
	speed: 0.1308s/iter; left time: 4955.9030s
	iters: 200, epoch: 9 | loss: 0.0023590
	speed: 0.0436s/iter; left time: 1649.3213s
	iters: 300, epoch: 9 | loss: 0.0001122
	speed: 0.0397s/iter; left time: 1496.3301s
	iters: 400, epoch: 9 | loss: 0.0704896
	speed: 0.0431s/iter; left time: 1620.7275s
Epoch: 9 cost time: 18.13124442100525
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0002211
	speed: 0.1189s/iter; left time: 4456.4074s
	iters: 200, epoch: 10 | loss: 0.0013748
	speed: 0.0430s/iter; left time: 1608.2828s
	iters: 300, epoch: 10 | loss: 0.0003045
	speed: 0.0415s/iter; left time: 1548.0989s
	iters: 400, epoch: 10 | loss: 0.0538331
	speed: 0.0411s/iter; left time: 1527.0628s
Epoch: 10 cost time: 17.14945149421692
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0021788
	speed: 0.1267s/iter; left time: 4696.5920s
	iters: 200, epoch: 11 | loss: 0.0000934
	speed: 0.0355s/iter; left time: 1311.0832s
	iters: 300, epoch: 11 | loss: 0.0000103
	speed: 0.0444s/iter; left time: 1637.1165s
	iters: 400, epoch: 11 | loss: 0.0623281
	speed: 0.0417s/iter; left time: 1534.9809s
Epoch: 11 cost time: 17.738431215286255
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0034040
	speed: 0.1257s/iter; left time: 4607.4523s
	iters: 200, epoch: 12 | loss: 0.0000345
	speed: 0.0452s/iter; left time: 1650.6394s
	iters: 300, epoch: 12 | loss: 0.0000108
	speed: 0.0392s/iter; left time: 1430.1015s
	iters: 400, epoch: 12 | loss: 0.0015395
	speed: 0.0446s/iter; left time: 1622.0479s
Epoch: 12 cost time: 18.032410144805908
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0002344
	speed: 0.1094s/iter; left time: 3965.0755s
	iters: 200, epoch: 13 | loss: 0.0025177
	speed: 0.0266s/iter; left time: 961.7885s
	iters: 300, epoch: 13 | loss: 0.0000856
	speed: 0.0272s/iter; left time: 979.8459s
	iters: 400, epoch: 13 | loss: 0.0005016
	speed: 0.0277s/iter; left time: 995.0302s
Epoch: 13 cost time: 11.498038053512573
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 35242
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1197331
	speed: 0.0531s/iter; left time: 2187.3060s
	iters: 200, epoch: 1 | loss: 0.1935353
	speed: 0.0311s/iter; left time: 1280.1612s
	iters: 300, epoch: 1 | loss: 0.5732825
	speed: 0.0300s/iter; left time: 1227.9861s
	iters: 400, epoch: 1 | loss: 0.2292912
	speed: 0.0372s/iter; left time: 1520.5770s
Epoch: 1 cost time: 15.609188318252563
Epoch: 1, Steps: 413 | Train Loss: 0.744 Vali Loss: 0.153 Vali Acc: 0.955 Test Loss: 0.153 Test Acc: 0.955
Validation loss decreased (inf --> -0.954978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1739345
	speed: 0.1094s/iter; left time: 4461.7301s
	iters: 200, epoch: 2 | loss: 0.0414212
	speed: 0.0327s/iter; left time: 1329.6139s
	iters: 300, epoch: 2 | loss: 0.1334016
	speed: 0.0342s/iter; left time: 1388.1463s
	iters: 400, epoch: 2 | loss: 0.0318237
	speed: 0.0338s/iter; left time: 1369.9884s
Epoch: 2 cost time: 14.349486351013184
Epoch: 2, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0363176
	speed: 0.1097s/iter; left time: 4430.7332s
	iters: 200, epoch: 3 | loss: 0.0439809
	speed: 0.0356s/iter; left time: 1435.2451s
	iters: 300, epoch: 3 | loss: 0.0492847
	speed: 0.0441s/iter; left time: 1771.9379s
	iters: 400, epoch: 3 | loss: 0.0067093
	speed: 0.0425s/iter; left time: 1702.4111s
Epoch: 3 cost time: 16.338343858718872
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.085 Vali Acc: 0.967 Test Loss: 0.085 Test Acc: 0.967
Validation loss decreased (-0.954978 --> -0.967257).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0065889
	speed: 0.1199s/iter; left time: 4791.1812s
	iters: 200, epoch: 4 | loss: 0.0064895
	speed: 0.0390s/iter; left time: 1556.2286s
	iters: 300, epoch: 4 | loss: 0.0101764
	speed: 0.0438s/iter; left time: 1743.3940s
	iters: 400, epoch: 4 | loss: 0.0122928
	speed: 0.0356s/iter; left time: 1413.2624s
Epoch: 4 cost time: 16.754202127456665
Epoch: 4, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0212968
	speed: 0.1082s/iter; left time: 4277.2964s
	iters: 200, epoch: 5 | loss: 0.0032064
	speed: 0.0333s/iter; left time: 1313.9723s
	iters: 300, epoch: 5 | loss: 0.0265893
	speed: 0.0319s/iter; left time: 1256.4375s
	iters: 400, epoch: 5 | loss: 0.0045055
	speed: 0.0330s/iter; left time: 1293.5241s
Epoch: 5 cost time: 14.040756940841675
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.067 Vali Acc: 0.972 Test Loss: 0.067 Test Acc: 0.972
Validation loss decreased (-0.967257 --> -0.972259).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0024311
	speed: 0.1175s/iter; left time: 4598.9030s
	iters: 200, epoch: 6 | loss: 0.0078651
	speed: 0.0424s/iter; left time: 1657.0597s
	iters: 300, epoch: 6 | loss: 0.0137816
	speed: 0.0393s/iter; left time: 1530.6765s
	iters: 400, epoch: 6 | loss: 0.2691805
	speed: 0.0385s/iter; left time: 1495.8399s
Epoch: 6 cost time: 16.917330503463745
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.972259 --> -0.972714).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0615715
	speed: 0.1160s/iter; left time: 4491.5727s
	iters: 200, epoch: 7 | loss: 0.0031221
	speed: 0.0396s/iter; left time: 1528.0907s
	iters: 300, epoch: 7 | loss: 0.2059936
	speed: 0.0460s/iter; left time: 1770.5182s
	iters: 400, epoch: 7 | loss: 0.0226718
	speed: 0.0581s/iter; left time: 2231.8017s
Epoch: 7 cost time: 19.0221529006958
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0113293
	speed: 0.1531s/iter; left time: 5866.6907s
	iters: 200, epoch: 8 | loss: 0.1534248
	speed: 0.0461s/iter; left time: 1761.6196s
	iters: 300, epoch: 8 | loss: 0.0002536
	speed: 0.0525s/iter; left time: 2002.0084s
	iters: 400, epoch: 8 | loss: 0.0630617
	speed: 0.0497s/iter; left time: 1888.4926s
Epoch: 8 cost time: 21.691389799118042
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.961 Test Loss: 0.122 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0024300
	speed: 0.1392s/iter; left time: 5275.4013s
	iters: 200, epoch: 9 | loss: 0.0104014
	speed: 0.0478s/iter; left time: 1806.8967s
	iters: 300, epoch: 9 | loss: 0.0012275
	speed: 0.0485s/iter; left time: 1829.8759s
	iters: 400, epoch: 9 | loss: 0.0000432
	speed: 0.0502s/iter; left time: 1887.7261s
Epoch: 9 cost time: 20.600120067596436
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0064001
	speed: 0.1400s/iter; left time: 5248.4755s
	iters: 200, epoch: 10 | loss: 0.0044392
	speed: 0.0505s/iter; left time: 1886.7104s
	iters: 300, epoch: 10 | loss: 0.0038209
	speed: 0.0545s/iter; left time: 2031.0316s
	iters: 400, epoch: 10 | loss: 0.0034350
	speed: 0.0552s/iter; left time: 2053.6758s
Epoch: 10 cost time: 21.807153463363647
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0131509
	speed: 0.1353s/iter; left time: 5013.8858s
	iters: 200, epoch: 11 | loss: 0.0018208
	speed: 0.0463s/iter; left time: 1712.8362s
	iters: 300, epoch: 11 | loss: 0.0133014
	speed: 0.0383s/iter; left time: 1412.6062s
	iters: 400, epoch: 11 | loss: 0.0006162
	speed: 0.0412s/iter; left time: 1513.9186s
Epoch: 11 cost time: 17.79630470275879
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.972714 --> -0.974533).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0014722
	speed: 0.1318s/iter; left time: 4831.1322s
	iters: 200, epoch: 12 | loss: 0.0007722
	speed: 0.0395s/iter; left time: 1442.4535s
	iters: 300, epoch: 12 | loss: 0.0043628
	speed: 0.0363s/iter; left time: 1323.1588s
	iters: 400, epoch: 12 | loss: 0.0489127
	speed: 0.0358s/iter; left time: 1300.1290s
Epoch: 12 cost time: 16.177663803100586
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000135
	speed: 0.1377s/iter; left time: 4992.2523s
	iters: 200, epoch: 13 | loss: 0.3148769
	speed: 0.0476s/iter; left time: 1719.7619s
	iters: 300, epoch: 13 | loss: 0.0123171
	speed: 0.0444s/iter; left time: 1599.4130s
	iters: 400, epoch: 13 | loss: 0.0009626
	speed: 0.0488s/iter; left time: 1754.6045s
Epoch: 13 cost time: 19.867493867874146
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0347502
	speed: 0.1241s/iter; left time: 4447.5194s
	iters: 200, epoch: 14 | loss: 0.0965329
	speed: 0.0393s/iter; left time: 1405.0349s
	iters: 300, epoch: 14 | loss: 0.0332273
	speed: 0.0491s/iter; left time: 1750.3167s
	iters: 400, epoch: 14 | loss: 0.0003069
	speed: 0.0506s/iter; left time: 1797.6932s
Epoch: 14 cost time: 19.140928506851196
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0004370
	speed: 0.1277s/iter; left time: 4522.0928s
	iters: 200, epoch: 15 | loss: 0.0031257
	speed: 0.0402s/iter; left time: 1418.6157s
	iters: 300, epoch: 15 | loss: 0.1614776
	speed: 0.0382s/iter; left time: 1344.1267s
	iters: 400, epoch: 15 | loss: 0.0000088
	speed: 0.0459s/iter; left time: 1612.0154s
Epoch: 15 cost time: 17.20559787750244
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.974533 --> -0.976352).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000751
	speed: 0.1427s/iter; left time: 4995.0470s
	iters: 200, epoch: 16 | loss: 0.0001903
	speed: 0.0500s/iter; left time: 1746.9172s
	iters: 300, epoch: 16 | loss: 0.0003445
	speed: 0.0441s/iter; left time: 1533.4431s
	iters: 400, epoch: 16 | loss: 0.0520363
	speed: 0.0474s/iter; left time: 1643.6152s
Epoch: 16 cost time: 20.403682231903076
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000288
	speed: 0.1369s/iter; left time: 4737.2566s
	iters: 200, epoch: 17 | loss: 0.0013175
	speed: 0.0541s/iter; left time: 1864.8989s
	iters: 300, epoch: 17 | loss: 0.0000868
	speed: 0.0518s/iter; left time: 1781.5358s
	iters: 400, epoch: 17 | loss: 0.0018594
	speed: 0.0527s/iter; left time: 1805.6182s
Epoch: 17 cost time: 21.691954851150513
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0290153
	speed: 0.1358s/iter; left time: 4642.2121s
	iters: 200, epoch: 18 | loss: 0.0005440
	speed: 0.0475s/iter; left time: 1618.8502s
	iters: 300, epoch: 18 | loss: 0.0281902
	speed: 0.0489s/iter; left time: 1663.1895s
	iters: 400, epoch: 18 | loss: 0.0430924
	speed: 0.0527s/iter; left time: 1784.0463s
Epoch: 18 cost time: 20.645484924316406
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0003972
	speed: 0.1445s/iter; left time: 4877.7496s
	iters: 200, epoch: 19 | loss: 0.0456716
	speed: 0.0456s/iter; left time: 1536.0547s
	iters: 300, epoch: 19 | loss: 0.0089235
	speed: 0.0445s/iter; left time: 1493.0461s
	iters: 400, epoch: 19 | loss: 0.0002334
	speed: 0.0414s/iter; left time: 1385.6439s
Epoch: 19 cost time: 19.205568552017212
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000287
	speed: 0.1546s/iter; left time: 5156.2834s
	iters: 200, epoch: 20 | loss: 0.0379058
	speed: 0.0691s/iter; left time: 2298.7890s
	iters: 300, epoch: 20 | loss: 0.0000894
	speed: 0.0672s/iter; left time: 2228.8142s
	iters: 400, epoch: 20 | loss: 0.0000302
	speed: 0.0624s/iter; left time: 2062.4005s
Epoch: 20 cost time: 27.652660369873047
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000012
	speed: 0.1596s/iter; left time: 5258.3122s
	iters: 200, epoch: 21 | loss: 0.0000003
	speed: 0.0605s/iter; left time: 1986.7948s
	iters: 300, epoch: 21 | loss: 0.0000178
	speed: 0.0553s/iter; left time: 1810.7966s
	iters: 400, epoch: 21 | loss: 0.0000362
	speed: 0.0654s/iter; left time: 2133.6626s
Epoch: 21 cost time: 24.842381238937378
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0007562
	speed: 0.1636s/iter; left time: 5320.4461s
	iters: 200, epoch: 22 | loss: 0.0000002
	speed: 0.0563s/iter; left time: 1827.2767s
	iters: 300, epoch: 22 | loss: 0.0049129
	speed: 0.0533s/iter; left time: 1721.7705s
	iters: 400, epoch: 22 | loss: 0.0000090
	speed: 0.0583s/iter; left time: 1879.6593s
Epoch: 22 cost time: 24.20548677444458
Epoch: 22, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976352 --> -0.976806).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000451
	speed: 0.1580s/iter; left time: 5073.8368s
	iters: 200, epoch: 23 | loss: 0.0335145
	speed: 0.0617s/iter; left time: 1976.8913s
	iters: 300, epoch: 23 | loss: 0.3534684
	speed: 0.0674s/iter; left time: 2151.1935s
	iters: 400, epoch: 23 | loss: 0.0000023
	speed: 0.0597s/iter; left time: 1897.9848s
Epoch: 23 cost time: 26.234066009521484
Epoch: 23, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000367
	speed: 0.1446s/iter; left time: 4582.8002s
	iters: 200, epoch: 24 | loss: 0.0001348
	speed: 0.0415s/iter; left time: 1312.2322s
	iters: 300, epoch: 24 | loss: 0.0009619
	speed: 0.0501s/iter; left time: 1578.9905s
	iters: 400, epoch: 24 | loss: 0.0002161
	speed: 0.0493s/iter; left time: 1547.5084s
Epoch: 24 cost time: 19.922532558441162
Epoch: 24, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0002986
	speed: 0.1332s/iter; left time: 4167.1906s
	iters: 200, epoch: 25 | loss: 0.0000007
	speed: 0.0409s/iter; left time: 1275.3171s
	iters: 300, epoch: 25 | loss: 0.0000123
	speed: 0.0419s/iter; left time: 1302.8783s
	iters: 400, epoch: 25 | loss: 0.0000058
	speed: 0.0436s/iter; left time: 1351.5764s
Epoch: 25 cost time: 17.783913612365723
Epoch: 25, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1377s/iter; left time: 4252.4813s
	iters: 200, epoch: 26 | loss: 0.0000004
	speed: 0.0592s/iter; left time: 1820.4429s
	iters: 300, epoch: 26 | loss: 0.0000035
	speed: 0.0491s/iter; left time: 1506.3881s
	iters: 400, epoch: 26 | loss: 0.0000006
	speed: 0.0442s/iter; left time: 1351.6041s
Epoch: 26 cost time: 21.204954862594604
Epoch: 26, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000585
	speed: 0.1345s/iter; left time: 4096.2784s
	iters: 200, epoch: 27 | loss: 0.0000005
	speed: 0.0550s/iter; left time: 1668.4551s
	iters: 300, epoch: 27 | loss: 0.0019930
	speed: 0.0567s/iter; left time: 1715.6331s
	iters: 400, epoch: 27 | loss: 0.0000771
	speed: 0.0538s/iter; left time: 1623.3945s
Epoch: 27 cost time: 21.882835388183594
Epoch: 27, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0005262
	speed: 0.1417s/iter; left time: 4257.4570s
	iters: 200, epoch: 28 | loss: 0.0000006
	speed: 0.0390s/iter; left time: 1167.0139s
	iters: 300, epoch: 28 | loss: 0.0000032
	speed: 0.0431s/iter; left time: 1285.6230s
	iters: 400, epoch: 28 | loss: 0.0040110
	speed: 0.0506s/iter; left time: 1505.6382s
Epoch: 28 cost time: 19.14214277267456
Epoch: 28, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000002
	speed: 0.1526s/iter; left time: 4523.5371s
	iters: 200, epoch: 29 | loss: 0.0000008
	speed: 0.0567s/iter; left time: 1675.1909s
	iters: 300, epoch: 29 | loss: 0.0000030
	speed: 0.0519s/iter; left time: 1528.3901s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 1355.8637s
Epoch: 29 cost time: 22.314587831497192
Epoch: 29, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000102
	speed: 0.1471s/iter; left time: 4298.5289s
	iters: 200, epoch: 30 | loss: 0.0125720
	speed: 0.0493s/iter; left time: 1435.8018s
	iters: 300, epoch: 30 | loss: 0.0004947
	speed: 0.0496s/iter; left time: 1438.7285s
	iters: 400, epoch: 30 | loss: 0.0000430
	speed: 0.0495s/iter; left time: 1430.9896s
Epoch: 30 cost time: 20.939362287521362
Epoch: 30, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.239 Vali Acc: 0.968 Test Loss: 0.239 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000308
	speed: 0.1287s/iter; left time: 3708.4338s
	iters: 200, epoch: 31 | loss: 0.0003786
	speed: 0.0502s/iter; left time: 1442.6703s
	iters: 300, epoch: 31 | loss: 0.0000070
	speed: 0.0542s/iter; left time: 1550.8225s
	iters: 400, epoch: 31 | loss: 0.0015255
	speed: 0.0594s/iter; left time: 1692.4479s
Epoch: 31 cost time: 22.268908500671387
Epoch: 31, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.971 Test Loss: 0.155 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000315
	speed: 0.1570s/iter; left time: 4458.3717s
	iters: 200, epoch: 32 | loss: 0.0003345
	speed: 0.0518s/iter; left time: 1465.8843s
	iters: 300, epoch: 32 | loss: 0.0008329
	speed: 0.0501s/iter; left time: 1413.4193s
	iters: 400, epoch: 32 | loss: 0.0004105
	speed: 0.0489s/iter; left time: 1374.2751s
Epoch: 32 cost time: 22.270055532455444
Epoch: 32, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9768076398362893
model parameter : 31162
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1845349
	speed: 0.1154s/iter; left time: 4752.7035s
	iters: 200, epoch: 1 | loss: 0.0358218
	speed: 0.1131s/iter; left time: 4647.0257s
	iters: 300, epoch: 1 | loss: 0.0285260
	speed: 0.1383s/iter; left time: 5670.0865s
	iters: 400, epoch: 1 | loss: 0.5398174
	speed: 0.1256s/iter; left time: 5135.3594s
Epoch: 1 cost time: 50.64898109436035
Epoch: 1, Steps: 413 | Train Loss: 0.393 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
Validation loss decreased (inf --> -0.969076).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2103500
	speed: 0.2335s/iter; left time: 9525.9730s
	iters: 200, epoch: 2 | loss: 0.0598079
	speed: 0.1192s/iter; left time: 4851.5651s
	iters: 300, epoch: 2 | loss: 0.1594806
	speed: 0.0962s/iter; left time: 3902.8589s
	iters: 400, epoch: 2 | loss: 0.5234681
	speed: 0.0873s/iter; left time: 3535.8936s
Epoch: 2 cost time: 44.125844955444336
Epoch: 2, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.174 Vali Acc: 0.953 Test Loss: 0.174 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3990128
	speed: 0.2354s/iter; left time: 9506.2432s
	iters: 200, epoch: 3 | loss: 0.0046913
	speed: 0.1029s/iter; left time: 4143.9817s
	iters: 300, epoch: 3 | loss: 0.0133602
	speed: 0.0688s/iter; left time: 2763.3503s
	iters: 400, epoch: 3 | loss: 0.0147609
	speed: 0.0932s/iter; left time: 3735.6318s
Epoch: 3 cost time: 40.98085403442383
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000567
	speed: 0.1609s/iter; left time: 6428.6776s
	iters: 200, epoch: 4 | loss: 0.1199766
	speed: 0.0591s/iter; left time: 2356.6359s
	iters: 300, epoch: 4 | loss: 0.0004478
	speed: 0.0654s/iter; left time: 2601.7313s
	iters: 400, epoch: 4 | loss: 0.2409827
	speed: 0.1110s/iter; left time: 4401.8459s
Epoch: 4 cost time: 30.96676993370056
Epoch: 4, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0007089
	speed: 0.1769s/iter; left time: 6997.1487s
	iters: 200, epoch: 5 | loss: 0.0475183
	speed: 0.0810s/iter; left time: 3193.7162s
	iters: 300, epoch: 5 | loss: 0.0005731
	speed: 0.1144s/iter; left time: 4502.9216s
	iters: 400, epoch: 5 | loss: 0.0000003
	speed: 0.0793s/iter; left time: 3112.8716s
Epoch: 5 cost time: 36.123730182647705
Epoch: 5, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.189 Vali Acc: 0.966 Test Loss: 0.189 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0005301
	speed: 0.1776s/iter; left time: 6951.0245s
	iters: 200, epoch: 6 | loss: 0.0000465
	speed: 0.0814s/iter; left time: 3176.2936s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 2271.9202s
	iters: 400, epoch: 6 | loss: 0.4136678
	speed: 0.0555s/iter; left time: 2154.7253s
Epoch: 6 cost time: 28.348214149475098
Epoch: 6, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.243 Vali Acc: 0.956 Test Loss: 0.243 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000308
	speed: 0.1143s/iter; left time: 4427.1662s
	iters: 200, epoch: 7 | loss: 0.0007626
	speed: 0.0352s/iter; left time: 1361.3348s
	iters: 300, epoch: 7 | loss: 0.0000109
	speed: 0.0392s/iter; left time: 1510.9034s
	iters: 400, epoch: 7 | loss: 0.0000027
	speed: 0.0532s/iter; left time: 2042.4763s
Epoch: 7 cost time: 17.778860569000244
Epoch: 7, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.245 Vali Acc: 0.968 Test Loss: 0.245 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0003973
	speed: 0.1141s/iter; left time: 4372.1175s
	iters: 200, epoch: 8 | loss: 0.0003447
	speed: 0.0639s/iter; left time: 2440.5837s
	iters: 300, epoch: 8 | loss: 0.0012706
	speed: 0.1116s/iter; left time: 4253.6732s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.1225s/iter; left time: 4656.6097s
Epoch: 8 cost time: 36.31538200378418
Epoch: 8, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.250 Vali Acc: 0.972 Test Loss: 0.250 Test Acc: 0.972
Validation loss decreased (-0.969076 --> -0.971803).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0008526
	speed: 0.2131s/iter; left time: 8074.7633s
	iters: 200, epoch: 9 | loss: 0.1760555
	speed: 0.1374s/iter; left time: 5192.1051s
	iters: 300, epoch: 9 | loss: 0.0000029
	speed: 0.1620s/iter; left time: 6106.0975s
	iters: 400, epoch: 9 | loss: 0.0000007
	speed: 0.1418s/iter; left time: 5332.7053s
Epoch: 9 cost time: 57.05090022087097
Epoch: 9, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.243 Vali Acc: 0.971 Test Loss: 0.243 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000265
	speed: 0.2718s/iter; left time: 10186.5221s
	iters: 200, epoch: 10 | loss: 0.0071398
	speed: 0.1485s/iter; left time: 5550.7886s
	iters: 300, epoch: 10 | loss: 0.0000006
	speed: 0.1555s/iter; left time: 5799.2666s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1419s/iter; left time: 5276.1324s
Epoch: 10 cost time: 61.65429401397705
Epoch: 10, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.228 Vali Acc: 0.974 Test Loss: 0.228 Test Acc: 0.974
Validation loss decreased (-0.971803 --> -0.973622).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0006894
	speed: 0.2459s/iter; left time: 9114.8778s
	iters: 200, epoch: 11 | loss: 0.0320916
	speed: 0.1074s/iter; left time: 3971.4164s
	iters: 300, epoch: 11 | loss: 0.1143772
	speed: 0.1374s/iter; left time: 5066.2355s
	iters: 400, epoch: 11 | loss: 0.0000046
	speed: 0.1310s/iter; left time: 4816.9444s
Epoch: 11 cost time: 51.75013709068298
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.164 Vali Acc: 0.979 Test Loss: 0.164 Test Acc: 0.979
Validation loss decreased (-0.973622 --> -0.978625).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000029
	speed: 0.2675s/iter; left time: 9806.8841s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1321s/iter; left time: 4829.0061s
	iters: 300, epoch: 12 | loss: 0.0109675
	speed: 0.1242s/iter; left time: 4528.5035s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.1193s/iter; left time: 4337.8078s
Epoch: 12 cost time: 54.593461990356445
Epoch: 12, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.296 Vali Acc: 0.966 Test Loss: 0.296 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000204
	speed: 0.2521s/iter; left time: 9137.4799s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1313s/iter; left time: 4746.4766s
	iters: 300, epoch: 13 | loss: 0.0002154
	speed: 0.1277s/iter; left time: 4602.5422s
	iters: 400, epoch: 13 | loss: 0.0000757
	speed: 0.1162s/iter; left time: 4175.9877s
Epoch: 13 cost time: 52.9758837223053
Epoch: 13, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.395 Vali Acc: 0.965 Test Loss: 0.395 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000087
	speed: 0.2220s/iter; left time: 7953.0889s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.1255s/iter; left time: 4484.2316s
	iters: 300, epoch: 14 | loss: 0.0001424
	speed: 0.1223s/iter; left time: 4359.4130s
	iters: 400, epoch: 14 | loss: 0.0629314
	speed: 0.1324s/iter; left time: 4703.2894s
Epoch: 14 cost time: 51.96976375579834
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.430 Vali Acc: 0.960 Test Loss: 0.430 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0328744
	speed: 0.2308s/iter; left time: 8175.7927s
	iters: 200, epoch: 15 | loss: 0.0000009
	speed: 0.1174s/iter; left time: 4146.1054s
	iters: 300, epoch: 15 | loss: 0.0000005
	speed: 0.1037s/iter; left time: 3652.6534s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1110s/iter; left time: 3896.6970s
Epoch: 15 cost time: 46.75266647338867
Epoch: 15, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.336 Vali Acc: 0.966 Test Loss: 0.336 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0019678
	speed: 0.2255s/iter; left time: 7893.3915s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1230s/iter; left time: 4292.5382s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1210s/iter; left time: 4213.1856s
	iters: 400, epoch: 16 | loss: 0.0516098
	speed: 0.1107s/iter; left time: 3842.5840s
Epoch: 16 cost time: 49.0921094417572
Epoch: 16, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.326 Vali Acc: 0.969 Test Loss: 0.326 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2074s/iter; left time: 7175.2795s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.1216s/iter; left time: 4195.6001s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.1248s/iter; left time: 4293.4931s
	iters: 400, epoch: 17 | loss: 0.0000188
	speed: 0.1084s/iter; left time: 3718.7230s
Epoch: 17 cost time: 47.727394580841064
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.253 Vali Acc: 0.973 Test Loss: 0.253 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000003
	speed: 0.2219s/iter; left time: 7583.1595s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1072s/iter; left time: 3652.6971s
	iters: 300, epoch: 18 | loss: 0.0000181
	speed: 0.1221s/iter; left time: 4147.3043s
	iters: 400, epoch: 18 | loss: 0.0000027
	speed: 0.1113s/iter; left time: 3772.0962s
Epoch: 18 cost time: 47.43693542480469
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.270 Vali Acc: 0.971 Test Loss: 0.270 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0040073
	speed: 0.2289s/iter; left time: 7730.5473s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1054s/iter; left time: 3549.2350s
	iters: 300, epoch: 19 | loss: 0.0000217
	speed: 0.1094s/iter; left time: 3673.8712s
	iters: 400, epoch: 19 | loss: 0.0262666
	speed: 0.1332s/iter; left time: 4456.9606s
Epoch: 19 cost time: 49.5428946018219
Epoch: 19, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.275 Vali Acc: 0.972 Test Loss: 0.275 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000013
	speed: 0.2651s/iter; left time: 8840.5472s
	iters: 200, epoch: 20 | loss: 0.0000002
	speed: 0.1390s/iter; left time: 4622.2409s
	iters: 300, epoch: 20 | loss: 0.2430831
	speed: 0.1242s/iter; left time: 4117.9173s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.1240s/iter; left time: 4098.0148s
Epoch: 20 cost time: 54.71124768257141
Epoch: 20, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.317 Vali Acc: 0.968 Test Loss: 0.317 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2376s/iter; left time: 7825.1629s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0986s/iter; left time: 3236.9092s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0864s/iter; left time: 2829.7919s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1006s/iter; left time: 3284.0413s
Epoch: 21 cost time: 42.51531410217285
Epoch: 21, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.314 Vali Acc: 0.974 Test Loss: 0.314 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9786266484765803
model parameter : 107690
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4913669
	speed: 0.0674s/iter; left time: 2776.1447s
	iters: 200, epoch: 1 | loss: 0.2498873
	speed: 0.0474s/iter; left time: 1947.4396s
	iters: 300, epoch: 1 | loss: 0.1955943
	speed: 0.0441s/iter; left time: 1807.8302s
	iters: 400, epoch: 1 | loss: 0.0974072
	speed: 0.0445s/iter; left time: 1820.2527s
Epoch: 1 cost time: 21.024454355239868
Epoch: 1, Steps: 413 | Train Loss: 0.423 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
Validation loss decreased (inf --> -0.953614).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1128494
	speed: 0.1402s/iter; left time: 5719.7420s
	iters: 200, epoch: 2 | loss: 0.0177211
	speed: 0.0482s/iter; left time: 1962.1784s
	iters: 300, epoch: 2 | loss: 0.0442448
	speed: 0.0506s/iter; left time: 2055.4222s
	iters: 400, epoch: 2 | loss: 0.4034114
	speed: 0.0509s/iter; left time: 2062.0387s
Epoch: 2 cost time: 21.192790746688843
Epoch: 2, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.128 Vali Acc: 0.961 Test Loss: 0.128 Test Acc: 0.961
Validation loss decreased (-0.953614 --> -0.961345).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0151443
	speed: 0.1429s/iter; left time: 5769.9637s
	iters: 200, epoch: 3 | loss: 0.0186599
	speed: 0.0509s/iter; left time: 2048.1172s
	iters: 300, epoch: 3 | loss: 0.0142975
	speed: 0.0504s/iter; left time: 2023.7376s
	iters: 400, epoch: 3 | loss: 0.0060370
	speed: 0.0533s/iter; left time: 2137.8492s
Epoch: 3 cost time: 21.5955548286438
Epoch: 3, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.198 Vali Acc: 0.947 Test Loss: 0.198 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0002233
	speed: 0.1454s/iter; left time: 5811.6377s
	iters: 200, epoch: 4 | loss: 0.2915309
	speed: 0.0497s/iter; left time: 1979.8557s
	iters: 300, epoch: 4 | loss: 0.0001541
	speed: 0.0485s/iter; left time: 1928.4523s
	iters: 400, epoch: 4 | loss: 0.0008625
	speed: 0.0497s/iter; left time: 1969.2205s
Epoch: 4 cost time: 21.271541357040405
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.961345 --> -0.969985).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0307980
	speed: 0.1466s/iter; left time: 5796.6577s
	iters: 200, epoch: 5 | loss: 0.0383460
	speed: 0.0536s/iter; left time: 2113.5391s
	iters: 300, epoch: 5 | loss: 0.0000005
	speed: 0.0502s/iter; left time: 1973.9800s
	iters: 400, epoch: 5 | loss: 0.0012358
	speed: 0.0531s/iter; left time: 2084.0850s
Epoch: 5 cost time: 22.167521476745605
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0003266
	speed: 0.1461s/iter; left time: 5717.5877s
	iters: 200, epoch: 6 | loss: 0.0000099
	speed: 0.0529s/iter; left time: 2065.2828s
	iters: 300, epoch: 6 | loss: 0.0011078
	speed: 0.0536s/iter; left time: 2088.4853s
	iters: 400, epoch: 6 | loss: 0.0483799
	speed: 0.0512s/iter; left time: 1986.9176s
Epoch: 6 cost time: 21.96890687942505
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.163 Vali Acc: 0.966 Test Loss: 0.163 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000003
	speed: 0.1295s/iter; left time: 5015.5754s
	iters: 200, epoch: 7 | loss: 0.0003075
	speed: 0.0425s/iter; left time: 1642.6226s
	iters: 300, epoch: 7 | loss: 0.0000734
	speed: 0.0462s/iter; left time: 1780.3738s
	iters: 400, epoch: 7 | loss: 0.0160428
	speed: 0.0487s/iter; left time: 1873.0687s
Epoch: 7 cost time: 19.261787176132202
Epoch: 7, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
Validation loss decreased (-0.969985 --> -0.973623).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0008095
	speed: 0.1452s/iter; left time: 5561.8169s
	iters: 200, epoch: 8 | loss: 0.0008344
	speed: 0.0465s/iter; left time: 1775.8058s
	iters: 300, epoch: 8 | loss: 0.0000006
	speed: 0.0486s/iter; left time: 1850.9023s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.0527s/iter; left time: 2002.8505s
Epoch: 8 cost time: 20.9989492893219
Epoch: 8, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.199 Vali Acc: 0.968 Test Loss: 0.199 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0242643
	speed: 0.1377s/iter; left time: 5219.2234s
	iters: 200, epoch: 9 | loss: 0.0000011
	speed: 0.0509s/iter; left time: 1925.1769s
	iters: 300, epoch: 9 | loss: 0.0000669
	speed: 0.0524s/iter; left time: 1974.7799s
	iters: 400, epoch: 9 | loss: 0.0004288
	speed: 0.0516s/iter; left time: 1938.5188s
Epoch: 9 cost time: 21.50452971458435
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.224 Vali Acc: 0.964 Test Loss: 0.224 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1047651
	speed: 0.1396s/iter; left time: 5234.0397s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 1915.0037s
	iters: 300, epoch: 10 | loss: 0.7341745
	speed: 0.0510s/iter; left time: 1900.1579s
	iters: 400, epoch: 10 | loss: 0.0000102
	speed: 0.0518s/iter; left time: 1925.6781s
Epoch: 10 cost time: 21.19846248626709
Epoch: 10, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.191 Vali Acc: 0.969 Test Loss: 0.191 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0004151
	speed: 0.1360s/iter; left time: 5042.5947s
	iters: 200, epoch: 11 | loss: 0.0000004
	speed: 0.0497s/iter; left time: 1838.5544s
	iters: 300, epoch: 11 | loss: 0.0001262
	speed: 0.0550s/iter; left time: 2026.2299s
	iters: 400, epoch: 11 | loss: 0.0000157
	speed: 0.0560s/iter; left time: 2058.8562s
Epoch: 11 cost time: 21.77207326889038
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.217 Vali Acc: 0.969 Test Loss: 0.217 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000025
	speed: 0.1602s/iter; left time: 5871.4317s
	iters: 200, epoch: 12 | loss: 0.0037032
	speed: 0.0536s/iter; left time: 1959.1133s
	iters: 300, epoch: 12 | loss: 0.0123081
	speed: 0.0546s/iter; left time: 1991.5060s
	iters: 400, epoch: 12 | loss: 0.0000104
	speed: 0.0513s/iter; left time: 1866.7741s
Epoch: 12 cost time: 22.44453191757202
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.229 Vali Acc: 0.963 Test Loss: 0.229 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0391550
	speed: 0.1584s/iter; left time: 5741.9114s
	iters: 200, epoch: 13 | loss: 0.0091994
	speed: 0.0579s/iter; left time: 2092.9714s
	iters: 300, epoch: 13 | loss: 0.1362434
	speed: 0.0543s/iter; left time: 1956.8040s
	iters: 400, epoch: 13 | loss: 0.0000159
	speed: 0.0466s/iter; left time: 1673.2609s
Epoch: 13 cost time: 22.767932176589966
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.170 Vali Acc: 0.976 Test Loss: 0.170 Test Acc: 0.976
Validation loss decreased (-0.973623 --> -0.976351).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0085954
	speed: 0.1536s/iter; left time: 5503.3722s
	iters: 200, epoch: 14 | loss: 0.0000281
	speed: 0.0535s/iter; left time: 1912.5392s
	iters: 300, epoch: 14 | loss: 0.0000141
	speed: 0.0516s/iter; left time: 1840.3053s
	iters: 400, epoch: 14 | loss: 0.0000934
	speed: 0.0492s/iter; left time: 1748.4093s
Epoch: 14 cost time: 22.212674379348755
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1529s/iter; left time: 5417.0934s
	iters: 200, epoch: 15 | loss: 0.0001115
	speed: 0.0557s/iter; left time: 1968.6410s
	iters: 300, epoch: 15 | loss: 0.0002261
	speed: 0.0484s/iter; left time: 1703.9728s
	iters: 400, epoch: 15 | loss: 0.0355977
	speed: 0.0489s/iter; left time: 1717.9533s
Epoch: 15 cost time: 21.965850114822388
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.215 Vali Acc: 0.973 Test Loss: 0.215 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0071816
	speed: 0.1434s/iter; left time: 5021.0450s
	iters: 200, epoch: 16 | loss: 0.0017918
	speed: 0.0528s/iter; left time: 1842.1501s
	iters: 300, epoch: 16 | loss: 0.0002910
	speed: 0.0512s/iter; left time: 1781.6813s
	iters: 400, epoch: 16 | loss: 0.0000030
	speed: 0.0472s/iter; left time: 1636.9157s
Epoch: 16 cost time: 21.189453601837158
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.184 Vali Acc: 0.971 Test Loss: 0.184 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000010
	speed: 0.1438s/iter; left time: 4973.4229s
	iters: 200, epoch: 17 | loss: 0.0000052
	speed: 0.0518s/iter; left time: 1788.3537s
	iters: 300, epoch: 17 | loss: 0.0000014
	speed: 0.0533s/iter; left time: 1833.8549s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 1767.5454s
Epoch: 17 cost time: 22.015684843063354
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.233 Vali Acc: 0.970 Test Loss: 0.233 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000010
	speed: 0.1517s/iter; left time: 5183.7003s
	iters: 200, epoch: 18 | loss: 0.0000227
	speed: 0.0521s/iter; left time: 1776.3081s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 1766.4297s
	iters: 400, epoch: 18 | loss: 0.0000002
	speed: 0.0552s/iter; left time: 1870.2352s
Epoch: 18 cost time: 22.820979118347168
Epoch: 18, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.974 Test Loss: 0.216 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0034318
	speed: 0.1511s/iter; left time: 5103.7358s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 1645.6845s
	iters: 300, epoch: 19 | loss: 0.0001419
	speed: 0.0497s/iter; left time: 1669.0249s
	iters: 400, epoch: 19 | loss: 0.0003391
	speed: 0.0495s/iter; left time: 1655.9580s
Epoch: 19 cost time: 20.931316137313843
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.288 Vali Acc: 0.971 Test Loss: 0.288 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0020962
	speed: 0.1404s/iter; left time: 4682.1307s
	iters: 200, epoch: 20 | loss: 0.0000071
	speed: 0.0526s/iter; left time: 1750.6782s
	iters: 300, epoch: 20 | loss: 0.2318891
	speed: 0.0525s/iter; left time: 1739.6111s
	iters: 400, epoch: 20 | loss: 0.0000002
	speed: 0.0535s/iter; left time: 1767.6552s
Epoch: 20 cost time: 22.021273374557495
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.265 Vali Acc: 0.965 Test Loss: 0.265 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1449s/iter; left time: 4772.8607s
	iters: 200, epoch: 21 | loss: 0.0000065
	speed: 0.0525s/iter; left time: 1725.4290s
	iters: 300, epoch: 21 | loss: 0.0058830
	speed: 0.0534s/iter; left time: 1747.6031s
	iters: 400, epoch: 21 | loss: 0.0000006
	speed: 0.0535s/iter; left time: 1747.3992s
Epoch: 21 cost time: 22.291770219802856
Epoch: 21, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.227 Vali Acc: 0.974 Test Loss: 0.227 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0008521
	speed: 0.1427s/iter; left time: 4640.9556s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 1518.0485s
	iters: 300, epoch: 22 | loss: 0.0003380
	speed: 0.0456s/iter; left time: 1472.6976s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0475s/iter; left time: 1531.0311s
Epoch: 22 cost time: 20.16193389892578
Epoch: 22, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.267 Vali Acc: 0.969 Test Loss: 0.267 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000007
	speed: 0.1464s/iter; left time: 4700.3452s
	iters: 200, epoch: 23 | loss: 0.0000049
	speed: 0.0498s/iter; left time: 1594.8355s
	iters: 300, epoch: 23 | loss: 0.0000165
	speed: 0.0514s/iter; left time: 1640.6155s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 1711.9015s
Epoch: 23 cost time: 21.927508115768433
Epoch: 23, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.296 Vali Acc: 0.970 Test Loss: 0.296 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 74442
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4530600
	speed: 0.0669s/iter; left time: 2754.6923s
	iters: 200, epoch: 1 | loss: 0.2188119
	speed: 0.0438s/iter; left time: 1799.8730s
	iters: 300, epoch: 1 | loss: 0.0469784
	speed: 0.0453s/iter; left time: 1858.2689s
	iters: 400, epoch: 1 | loss: 0.1339259
	speed: 0.0508s/iter; left time: 2078.6392s
Epoch: 1 cost time: 21.40627431869507
Epoch: 1, Steps: 413 | Train Loss: 0.510 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
Validation loss decreased (inf --> -0.956797).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0454582
	speed: 0.1497s/iter; left time: 6104.1567s
	iters: 200, epoch: 2 | loss: 0.0054093
	speed: 0.0457s/iter; left time: 1860.2165s
	iters: 300, epoch: 2 | loss: 0.0531529
	speed: 0.0516s/iter; left time: 2095.3812s
	iters: 400, epoch: 2 | loss: 0.0607678
	speed: 0.0611s/iter; left time: 2475.0544s
Epoch: 2 cost time: 21.5695960521698
Epoch: 2, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.118 Vali Acc: 0.960 Test Loss: 0.118 Test Acc: 0.960
Validation loss decreased (-0.956797 --> -0.959981).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0286521
	speed: 0.1682s/iter; left time: 6792.0550s
	iters: 200, epoch: 3 | loss: 0.2805416
	speed: 0.0624s/iter; left time: 2513.4912s
	iters: 300, epoch: 3 | loss: 0.0061486
	speed: 0.0611s/iter; left time: 2454.2706s
	iters: 400, epoch: 3 | loss: 0.0069757
	speed: 0.0613s/iter; left time: 2458.4835s
Epoch: 3 cost time: 25.74872922897339
Epoch: 3, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.959981 --> -0.965438).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0005212
	speed: 0.1731s/iter; left time: 6916.7470s
	iters: 200, epoch: 4 | loss: 0.0067034
	speed: 0.0608s/iter; left time: 2422.5409s
	iters: 300, epoch: 4 | loss: 0.3442548
	speed: 0.0617s/iter; left time: 2452.8481s
	iters: 400, epoch: 4 | loss: 0.1653849
	speed: 0.0613s/iter; left time: 2431.1878s
Epoch: 4 cost time: 25.793506860733032
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0003711
	speed: 0.1740s/iter; left time: 6879.7325s
	iters: 200, epoch: 5 | loss: 0.0057820
	speed: 0.0630s/iter; left time: 2485.1062s
	iters: 300, epoch: 5 | loss: 0.0006186
	speed: 0.0635s/iter; left time: 2498.2193s
	iters: 400, epoch: 5 | loss: 0.0139452
	speed: 0.0595s/iter; left time: 2335.3952s
Epoch: 5 cost time: 25.62524676322937
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.965438 --> -0.975442).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0283705
	speed: 0.1589s/iter; left time: 6217.3591s
	iters: 200, epoch: 6 | loss: 0.0002245
	speed: 0.0673s/iter; left time: 2625.5640s
	iters: 300, epoch: 6 | loss: 0.0178236
	speed: 0.0715s/iter; left time: 2784.2814s
	iters: 400, epoch: 6 | loss: 0.0050765
	speed: 0.0728s/iter; left time: 2828.2939s
Epoch: 6 cost time: 27.758431911468506
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.110 Vali Acc: 0.966 Test Loss: 0.110 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000009
	speed: 0.1717s/iter; left time: 6647.3496s
	iters: 200, epoch: 7 | loss: 0.0008218
	speed: 0.0658s/iter; left time: 2541.6703s
	iters: 300, epoch: 7 | loss: 0.0845778
	speed: 0.0742s/iter; left time: 2857.0571s
	iters: 400, epoch: 7 | loss: 0.4365102
	speed: 0.0729s/iter; left time: 2799.2410s
Epoch: 7 cost time: 29.03156566619873
Epoch: 7, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.174 Vali Acc: 0.970 Test Loss: 0.174 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0006124
	speed: 0.1708s/iter; left time: 6544.8949s
	iters: 200, epoch: 8 | loss: 0.0017370
	speed: 0.0561s/iter; left time: 2144.8540s
	iters: 300, epoch: 8 | loss: 0.0000064
	speed: 0.0578s/iter; left time: 2202.0966s
	iters: 400, epoch: 8 | loss: 0.2271532
	speed: 0.0525s/iter; left time: 1996.2268s
Epoch: 8 cost time: 23.503243923187256
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.218 Vali Acc: 0.959 Test Loss: 0.218 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0028371
	speed: 0.1497s/iter; left time: 5672.4249s
	iters: 200, epoch: 9 | loss: 0.0022072
	speed: 0.0605s/iter; left time: 2287.1298s
	iters: 300, epoch: 9 | loss: 0.0000537
	speed: 0.0604s/iter; left time: 2277.7747s
	iters: 400, epoch: 9 | loss: 0.0000216
	speed: 0.0609s/iter; left time: 2288.6704s
Epoch: 9 cost time: 24.676045656204224
Epoch: 9, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2831483
	speed: 0.1603s/iter; left time: 6007.4488s
	iters: 200, epoch: 10 | loss: 0.0000004
	speed: 0.0600s/iter; left time: 2243.1700s
	iters: 300, epoch: 10 | loss: 0.1579711
	speed: 0.0607s/iter; left time: 2262.5031s
	iters: 400, epoch: 10 | loss: 0.1590692
	speed: 0.0594s/iter; left time: 2207.9080s
Epoch: 10 cost time: 24.96749186515808
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.237 Vali Acc: 0.967 Test Loss: 0.237 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000031
	speed: 0.1542s/iter; left time: 5717.0300s
	iters: 200, epoch: 11 | loss: 0.0000209
	speed: 0.0558s/iter; left time: 2064.6603s
	iters: 300, epoch: 11 | loss: 0.0016032
	speed: 0.0561s/iter; left time: 2067.2106s
	iters: 400, epoch: 11 | loss: 0.0000019
	speed: 0.0571s/iter; left time: 2100.3000s
Epoch: 11 cost time: 23.299967050552368
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.971 Test Loss: 0.212 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0001297
	speed: 0.1384s/iter; left time: 5072.5651s
	iters: 200, epoch: 12 | loss: 0.0000004
	speed: 0.0494s/iter; left time: 1806.4486s
	iters: 300, epoch: 12 | loss: 0.0001121
	speed: 0.0499s/iter; left time: 1820.4662s
	iters: 400, epoch: 12 | loss: 0.0000345
	speed: 0.0525s/iter; left time: 1910.5307s
Epoch: 12 cost time: 21.22160768508911
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.191 Vali Acc: 0.968 Test Loss: 0.191 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0001807
	speed: 0.1538s/iter; left time: 5574.6220s
	iters: 200, epoch: 13 | loss: 0.0406189
	speed: 0.0545s/iter; left time: 1968.5838s
	iters: 300, epoch: 13 | loss: 0.0000012
	speed: 0.0545s/iter; left time: 1964.9279s
	iters: 400, epoch: 13 | loss: 0.0007496
	speed: 0.0529s/iter; left time: 1900.6416s
Epoch: 13 cost time: 22.74976420402527
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.232 Vali Acc: 0.968 Test Loss: 0.232 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000003
	speed: 0.1478s/iter; left time: 5296.0174s
	iters: 200, epoch: 14 | loss: 0.2863231
	speed: 0.0516s/iter; left time: 1843.9198s
	iters: 300, epoch: 14 | loss: 0.0003663
	speed: 0.0501s/iter; left time: 1784.9228s
	iters: 400, epoch: 14 | loss: 0.0000007
	speed: 0.0522s/iter; left time: 1855.6112s
Epoch: 14 cost time: 21.832157135009766
Epoch: 14, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.189 Vali Acc: 0.969 Test Loss: 0.189 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0015068
	speed: 0.1546s/iter; left time: 5476.6807s
	iters: 200, epoch: 15 | loss: 0.0000002
	speed: 0.0460s/iter; left time: 1624.0658s
	iters: 300, epoch: 15 | loss: 0.0015689
	speed: 0.0437s/iter; left time: 1540.5483s
	iters: 400, epoch: 15 | loss: 0.0212669
	speed: 0.0413s/iter; left time: 1448.6675s
Epoch: 15 cost time: 19.513411045074463
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.974 Test Loss: 0.167 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 57834
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7407442
	speed: 0.0700s/iter; left time: 2884.1831s
	iters: 200, epoch: 1 | loss: 0.1995389
	speed: 0.0530s/iter; left time: 2176.7722s
	iters: 300, epoch: 1 | loss: 0.0283881
	speed: 0.0522s/iter; left time: 2139.9844s
	iters: 400, epoch: 1 | loss: 0.1609091
	speed: 0.0494s/iter; left time: 2021.3656s
Epoch: 1 cost time: 23.13732361793518
Epoch: 1, Steps: 413 | Train Loss: 0.533 Vali Loss: 0.158 Vali Acc: 0.947 Test Loss: 0.158 Test Acc: 0.947
Validation loss decreased (inf --> -0.946792).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0625657
	speed: 0.1546s/iter; left time: 6305.9649s
	iters: 200, epoch: 2 | loss: 0.0655877
	speed: 0.0613s/iter; left time: 2493.3069s
	iters: 300, epoch: 2 | loss: 0.0049551
	speed: 0.0556s/iter; left time: 2256.2192s
	iters: 400, epoch: 2 | loss: 0.0878381
	speed: 0.0603s/iter; left time: 2442.0497s
Epoch: 2 cost time: 24.574435234069824
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.093 Vali Acc: 0.964 Test Loss: 0.093 Test Acc: 0.964
Validation loss decreased (-0.946792 --> -0.964074).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2986153
	speed: 0.1710s/iter; left time: 6902.4042s
	iters: 200, epoch: 3 | loss: 0.0127551
	speed: 0.0549s/iter; left time: 2210.1928s
	iters: 300, epoch: 3 | loss: 0.0025289
	speed: 0.0501s/iter; left time: 2012.9183s
	iters: 400, epoch: 3 | loss: 0.0603518
	speed: 0.0499s/iter; left time: 2001.0330s
Epoch: 3 cost time: 22.938992500305176
Epoch: 3, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.083 Vali Acc: 0.971 Test Loss: 0.083 Test Acc: 0.971
Validation loss decreased (-0.964074 --> -0.971350).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0007025
	speed: 0.1474s/iter; left time: 5889.5967s
	iters: 200, epoch: 4 | loss: 0.1864642
	speed: 0.0511s/iter; left time: 2037.9488s
	iters: 300, epoch: 4 | loss: 0.0060808
	speed: 0.0490s/iter; left time: 1949.2920s
	iters: 400, epoch: 4 | loss: 0.1474658
	speed: 0.0488s/iter; left time: 1936.9738s
Epoch: 4 cost time: 21.22013235092163
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0565705
	speed: 0.1442s/iter; left time: 5701.4980s
	iters: 200, epoch: 5 | loss: 0.0052118
	speed: 0.0508s/iter; left time: 2003.8497s
	iters: 300, epoch: 5 | loss: 0.0086497
	speed: 0.0489s/iter; left time: 1924.4364s
	iters: 400, epoch: 5 | loss: 0.0095490
	speed: 0.0505s/iter; left time: 1981.0932s
Epoch: 5 cost time: 21.113136291503906
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0017451
	speed: 0.1494s/iter; left time: 5848.4009s
	iters: 200, epoch: 6 | loss: 0.0033866
	speed: 0.0554s/iter; left time: 2163.2476s
	iters: 300, epoch: 6 | loss: 0.0248747
	speed: 0.0509s/iter; left time: 1979.9288s
	iters: 400, epoch: 6 | loss: 0.0147465
	speed: 0.0380s/iter; left time: 1473.9185s
Epoch: 6 cost time: 20.64941668510437
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.971350 --> -0.977716).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1085689
	speed: 0.1348s/iter; left time: 5221.1744s
	iters: 200, epoch: 7 | loss: 0.0122825
	speed: 0.0454s/iter; left time: 1753.7001s
	iters: 300, epoch: 7 | loss: 0.0001172
	speed: 0.0458s/iter; left time: 1763.8455s
	iters: 400, epoch: 7 | loss: 0.0000742
	speed: 0.0484s/iter; left time: 1860.2391s
Epoch: 7 cost time: 19.510287284851074
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
Validation loss decreased (-0.977716 --> -0.979081).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0075157
	speed: 0.1454s/iter; left time: 5571.1471s
	iters: 200, epoch: 8 | loss: 0.0768396
	speed: 0.0516s/iter; left time: 1971.5036s
	iters: 300, epoch: 8 | loss: 0.6109046
	speed: 0.0492s/iter; left time: 1873.3479s
	iters: 400, epoch: 8 | loss: 0.3437787
	speed: 0.0453s/iter; left time: 1723.4147s
Epoch: 8 cost time: 20.809542417526245
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0007297
	speed: 0.1404s/iter; left time: 5322.5754s
	iters: 200, epoch: 9 | loss: 0.0011904
	speed: 0.0454s/iter; left time: 1716.3988s
	iters: 300, epoch: 9 | loss: 0.0181242
	speed: 0.0495s/iter; left time: 1867.6242s
	iters: 400, epoch: 9 | loss: 0.0004230
	speed: 0.0469s/iter; left time: 1762.2521s
Epoch: 9 cost time: 20.36216139793396
Epoch: 9, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0002176
	speed: 0.1369s/iter; left time: 5130.1615s
	iters: 200, epoch: 10 | loss: 0.0001223
	speed: 0.0546s/iter; left time: 2042.3287s
	iters: 300, epoch: 10 | loss: 0.0000225
	speed: 0.0555s/iter; left time: 2070.6568s
	iters: 400, epoch: 10 | loss: 0.0060675
	speed: 0.0548s/iter; left time: 2035.9784s
Epoch: 10 cost time: 22.504796266555786
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.200 Vali Acc: 0.970 Test Loss: 0.200 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0001484
	speed: 0.1469s/iter; left time: 5446.0439s
	iters: 200, epoch: 11 | loss: 0.0019208
	speed: 0.0485s/iter; left time: 1791.8071s
	iters: 300, epoch: 11 | loss: 0.0000103
	speed: 0.0518s/iter; left time: 1910.7754s
	iters: 400, epoch: 11 | loss: 0.0004071
	speed: 0.0536s/iter; left time: 1971.2740s
Epoch: 11 cost time: 21.443569660186768
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0005073
	speed: 0.1533s/iter; left time: 5620.4122s
	iters: 200, epoch: 12 | loss: 0.0000023
	speed: 0.0429s/iter; left time: 1566.7294s
	iters: 300, epoch: 12 | loss: 0.0002386
	speed: 0.0431s/iter; left time: 1571.0103s
	iters: 400, epoch: 12 | loss: 0.0000006
	speed: 0.0472s/iter; left time: 1717.6516s
Epoch: 12 cost time: 19.3194580078125
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0012857
	speed: 0.1448s/iter; left time: 5248.9911s
	iters: 200, epoch: 13 | loss: 0.1602883
	speed: 0.0472s/iter; left time: 1707.3015s
	iters: 300, epoch: 13 | loss: 0.0000180
	speed: 0.0472s/iter; left time: 1702.9106s
	iters: 400, epoch: 13 | loss: 0.0000449
	speed: 0.0476s/iter; left time: 1711.9669s
Epoch: 13 cost time: 20.257132053375244
Epoch: 13, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000005
	speed: 0.1365s/iter; left time: 4889.3941s
	iters: 200, epoch: 14 | loss: 0.1241038
	speed: 0.0452s/iter; left time: 1613.8488s
	iters: 300, epoch: 14 | loss: 0.0006966
	speed: 0.0476s/iter; left time: 1697.0581s
	iters: 400, epoch: 14 | loss: 0.0000283
	speed: 0.0554s/iter; left time: 1968.8326s
Epoch: 14 cost time: 20.6595299243927
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000190
	speed: 0.1842s/iter; left time: 6524.1150s
	iters: 200, epoch: 15 | loss: 0.0001774
	speed: 0.0740s/iter; left time: 2613.0177s
	iters: 300, epoch: 15 | loss: 0.2612085
	speed: 0.0749s/iter; left time: 2639.3817s
	iters: 400, epoch: 15 | loss: 0.0343570
	speed: 0.0644s/iter; left time: 2263.1959s
Epoch: 15 cost time: 29.085217475891113
Epoch: 15, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.173 Vali Acc: 0.976 Test Loss: 0.173 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1745s/iter; left time: 6109.5020s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.0625s/iter; left time: 2180.8683s
	iters: 300, epoch: 16 | loss: 0.0000146
	speed: 0.0615s/iter; left time: 2140.6853s
	iters: 400, epoch: 16 | loss: 0.0001361
	speed: 0.0589s/iter; left time: 2042.9915s
Epoch: 16 cost time: 25.548975229263306
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.227 Vali Acc: 0.966 Test Loss: 0.227 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0012651
	speed: 0.1748s/iter; left time: 6047.2853s
	iters: 200, epoch: 17 | loss: 0.0011370
	speed: 0.0672s/iter; left time: 2317.0389s
	iters: 300, epoch: 17 | loss: 0.0000502
	speed: 0.0599s/iter; left time: 2058.5385s
	iters: 400, epoch: 17 | loss: 0.0000371
	speed: 0.0680s/iter; left time: 2333.5263s
Epoch: 17 cost time: 27.434671640396118
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
model parameter : 47482
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7485001
	speed: 0.0712s/iter; left time: 2931.4706s
	iters: 200, epoch: 1 | loss: 0.4605988
	speed: 0.0471s/iter; left time: 1935.8800s
	iters: 300, epoch: 1 | loss: 0.1014141
	speed: 0.0458s/iter; left time: 1877.5559s
	iters: 400, epoch: 1 | loss: 0.0388655
	speed: 0.0544s/iter; left time: 2226.5295s
Epoch: 1 cost time: 22.571792364120483
Epoch: 1, Steps: 413 | Train Loss: 0.578 Vali Loss: 0.145 Vali Acc: 0.948 Test Loss: 0.145 Test Acc: 0.948
Validation loss decreased (inf --> -0.947702).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0815101
	speed: 0.1532s/iter; left time: 6246.9536s
	iters: 200, epoch: 2 | loss: 0.0692510
	speed: 0.0605s/iter; left time: 2459.9910s
	iters: 300, epoch: 2 | loss: 0.0271933
	speed: 0.0525s/iter; left time: 2128.9796s
	iters: 400, epoch: 2 | loss: 0.0770209
	speed: 0.0526s/iter; left time: 2131.2293s
Epoch: 2 cost time: 23.240991830825806
Epoch: 2, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.078 Vali Acc: 0.971 Test Loss: 0.078 Test Acc: 0.971
Validation loss decreased (-0.947702 --> -0.970895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0124868
	speed: 0.1517s/iter; left time: 6124.8490s
	iters: 200, epoch: 3 | loss: 0.0153507
	speed: 0.0567s/iter; left time: 2283.6055s
	iters: 300, epoch: 3 | loss: 0.0103419
	speed: 0.0593s/iter; left time: 2384.2249s
	iters: 400, epoch: 3 | loss: 0.1978374
	speed: 0.0543s/iter; left time: 2177.0913s
Epoch: 3 cost time: 23.992429971694946
Epoch: 3, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.095 Vali Acc: 0.969 Test Loss: 0.095 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0016320
	speed: 0.1571s/iter; left time: 6278.9472s
	iters: 200, epoch: 4 | loss: 0.0023171
	speed: 0.0526s/iter; left time: 2098.0636s
	iters: 300, epoch: 4 | loss: 0.0037276
	speed: 0.0495s/iter; left time: 1968.8148s
	iters: 400, epoch: 4 | loss: 0.0241079
	speed: 0.0504s/iter; left time: 1997.5328s
Epoch: 4 cost time: 21.840703010559082
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.121 Vali Acc: 0.960 Test Loss: 0.121 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0002171
	speed: 0.1467s/iter; left time: 5802.7927s
	iters: 200, epoch: 5 | loss: 0.0013768
	speed: 0.0452s/iter; left time: 1784.9980s
	iters: 300, epoch: 5 | loss: 0.0407450
	speed: 0.0507s/iter; left time: 1993.6180s
	iters: 400, epoch: 5 | loss: 0.0502566
	speed: 0.0531s/iter; left time: 2082.5230s
Epoch: 5 cost time: 20.92053747177124
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.970895 --> -0.975442).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0427706
	speed: 0.1496s/iter; left time: 5855.3115s
	iters: 200, epoch: 6 | loss: 0.0006361
	speed: 0.0511s/iter; left time: 1994.0967s
	iters: 300, epoch: 6 | loss: 0.0160891
	speed: 0.0499s/iter; left time: 1943.8615s
	iters: 400, epoch: 6 | loss: 0.0039007
	speed: 0.0497s/iter; left time: 1930.5679s
Epoch: 6 cost time: 21.093575954437256
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0020271
	speed: 0.1484s/iter; left time: 5744.8156s
	iters: 200, epoch: 7 | loss: 0.0096807
	speed: 0.0505s/iter; left time: 1951.7326s
	iters: 300, epoch: 7 | loss: 0.0232705
	speed: 0.0533s/iter; left time: 2053.4353s
	iters: 400, epoch: 7 | loss: 0.0017139
	speed: 0.0518s/iter; left time: 1989.8787s
Epoch: 7 cost time: 21.41750717163086
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000314
	speed: 0.1571s/iter; left time: 6019.7296s
	iters: 200, epoch: 8 | loss: 0.0018511
	speed: 0.0475s/iter; left time: 1816.3741s
	iters: 300, epoch: 8 | loss: 0.0000044
	speed: 0.0444s/iter; left time: 1691.2099s
	iters: 400, epoch: 8 | loss: 0.0110885
	speed: 0.0434s/iter; left time: 1651.3903s
Epoch: 8 cost time: 19.717551946640015
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1233357
	speed: 0.1480s/iter; left time: 5610.1550s
	iters: 200, epoch: 9 | loss: 0.0002070
	speed: 0.0526s/iter; left time: 1986.9357s
	iters: 300, epoch: 9 | loss: 0.0921711
	speed: 0.0481s/iter; left time: 1812.1490s
	iters: 400, epoch: 9 | loss: 0.0000048
	speed: 0.0478s/iter; left time: 1796.7284s
Epoch: 9 cost time: 20.766369342803955
Epoch: 9, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.975442 --> -0.975897).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0001877
	speed: 0.1634s/iter; left time: 6126.7265s
	iters: 200, epoch: 10 | loss: 0.0000809
	speed: 0.0558s/iter; left time: 2086.8562s
	iters: 300, epoch: 10 | loss: 0.0036177
	speed: 0.0567s/iter; left time: 2112.1946s
	iters: 400, epoch: 10 | loss: 0.0052756
	speed: 0.0530s/iter; left time: 1971.3501s
Epoch: 10 cost time: 23.458425521850586
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
Validation loss decreased (-0.975897 --> -0.978626).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000062
	speed: 0.1682s/iter; left time: 6237.0610s
	iters: 200, epoch: 11 | loss: 0.0000021
	speed: 0.0619s/iter; left time: 2288.0103s
	iters: 300, epoch: 11 | loss: 0.0126676
	speed: 0.0615s/iter; left time: 2269.3408s
	iters: 400, epoch: 11 | loss: 0.0063864
	speed: 0.0671s/iter; left time: 2467.1728s
Epoch: 11 cost time: 26.613402605056763
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.978626 --> -0.979990).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000043
	speed: 0.1769s/iter; left time: 6486.1127s
	iters: 200, epoch: 12 | loss: 0.0022012
	speed: 0.0576s/iter; left time: 2104.0007s
	iters: 300, epoch: 12 | loss: 0.0003053
	speed: 0.0496s/iter; left time: 1809.2666s
	iters: 400, epoch: 12 | loss: 0.0005164
	speed: 0.0499s/iter; left time: 1812.5632s
Epoch: 12 cost time: 22.851532697677612
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000031
	speed: 0.1545s/iter; left time: 5598.8747s
	iters: 200, epoch: 13 | loss: 0.0006962
	speed: 0.0513s/iter; left time: 1853.9751s
	iters: 300, epoch: 13 | loss: 0.0048308
	speed: 0.0530s/iter; left time: 1911.4393s
	iters: 400, epoch: 13 | loss: 0.0077427
	speed: 0.0515s/iter; left time: 1850.8461s
Epoch: 13 cost time: 22.119800090789795
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000605
	speed: 0.1488s/iter; left time: 5332.4555s
	iters: 200, epoch: 14 | loss: 0.2418220
	speed: 0.0499s/iter; left time: 1782.0505s
	iters: 300, epoch: 14 | loss: 0.0005844
	speed: 0.0531s/iter; left time: 1893.1456s
	iters: 400, epoch: 14 | loss: 0.0144299
	speed: 0.0517s/iter; left time: 1837.4665s
Epoch: 14 cost time: 21.72776770591736
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0281366
	speed: 0.1538s/iter; left time: 5446.2786s
	iters: 200, epoch: 15 | loss: 0.0004074
	speed: 0.0499s/iter; left time: 1763.0501s
	iters: 300, epoch: 15 | loss: 0.0000355
	speed: 0.0529s/iter; left time: 1864.3725s
	iters: 400, epoch: 15 | loss: 0.0000919
	speed: 0.0523s/iter; left time: 1838.1838s
Epoch: 15 cost time: 21.637546062469482
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000263
	speed: 0.1545s/iter; left time: 5408.8763s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 1670.1750s
	iters: 300, epoch: 16 | loss: 0.0000006
	speed: 0.0450s/iter; left time: 1566.1955s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0482s/iter; left time: 1674.1540s
Epoch: 16 cost time: 20.34154462814331
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.1379236
	speed: 0.1545s/iter; left time: 5344.7591s
	iters: 200, epoch: 17 | loss: 0.3144141
	speed: 0.0519s/iter; left time: 1790.3688s
	iters: 300, epoch: 17 | loss: 0.0001070
	speed: 0.0511s/iter; left time: 1758.8174s
	iters: 400, epoch: 17 | loss: 0.0003128
	speed: 0.0520s/iter; left time: 1784.4717s
Epoch: 17 cost time: 21.71504783630371
Epoch: 17, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000587
	speed: 0.1458s/iter; left time: 4982.4433s
	iters: 200, epoch: 18 | loss: 0.0000013
	speed: 0.0454s/iter; left time: 1546.0898s
	iters: 300, epoch: 18 | loss: 0.0008353
	speed: 0.0478s/iter; left time: 1623.7842s
	iters: 400, epoch: 18 | loss: 0.1384895
	speed: 0.0456s/iter; left time: 1546.1474s
Epoch: 18 cost time: 19.85709857940674
Epoch: 18, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.143 Vali Acc: 0.972 Test Loss: 0.143 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000006
	speed: 0.1348s/iter; left time: 4552.9495s
	iters: 200, epoch: 19 | loss: 0.0003338
	speed: 0.0429s/iter; left time: 1443.6790s
	iters: 300, epoch: 19 | loss: 0.0001273
	speed: 0.0458s/iter; left time: 1538.8144s
	iters: 400, epoch: 19 | loss: 0.0002055
	speed: 0.0510s/iter; left time: 1705.5132s
Epoch: 19 cost time: 19.280627012252808
Epoch: 19, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000011
	speed: 0.1593s/iter; left time: 5313.0374s
	iters: 200, epoch: 20 | loss: 0.0134332
	speed: 0.0525s/iter; left time: 1744.6201s
	iters: 300, epoch: 20 | loss: 0.0000006
	speed: 0.0575s/iter; left time: 1907.9237s
	iters: 400, epoch: 20 | loss: 0.0049693
	speed: 0.0587s/iter; left time: 1939.4412s
Epoch: 20 cost time: 23.450717449188232
Epoch: 20, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000063
	speed: 0.1545s/iter; left time: 5089.2294s
	iters: 200, epoch: 21 | loss: 0.0000041
	speed: 0.0542s/iter; left time: 1779.1308s
	iters: 300, epoch: 21 | loss: 0.0000203
	speed: 0.0517s/iter; left time: 1692.9681s
	iters: 400, epoch: 21 | loss: 0.0000071
	speed: 0.0553s/iter; left time: 1805.1240s
Epoch: 21 cost time: 22.2110755443573
Epoch: 21, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.179 Vali Acc: 0.973 Test Loss: 0.179 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 37146
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9305394
	speed: 0.0642s/iter; left time: 2645.1575s
	iters: 200, epoch: 1 | loss: 0.3670199
	speed: 0.0421s/iter; left time: 1730.1687s
	iters: 300, epoch: 1 | loss: 0.2647270
	speed: 0.0461s/iter; left time: 1890.4780s
	iters: 400, epoch: 1 | loss: 0.1107701
	speed: 0.0472s/iter; left time: 1932.5581s
Epoch: 1 cost time: 20.547590970993042
Epoch: 1, Steps: 413 | Train Loss: 0.695 Vali Loss: 0.137 Vali Acc: 0.961 Test Loss: 0.137 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1316108
	speed: 0.1443s/iter; left time: 5883.8750s
	iters: 200, epoch: 2 | loss: 0.1926732
	speed: 0.0460s/iter; left time: 1873.2416s
	iters: 300, epoch: 2 | loss: 0.0282446
	speed: 0.0490s/iter; left time: 1987.1996s
	iters: 400, epoch: 2 | loss: 0.7956186
	speed: 0.0514s/iter; left time: 2081.3464s
Epoch: 2 cost time: 20.450382709503174
Epoch: 2, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
Validation loss decreased (-0.960890 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1481707
	speed: 0.1582s/iter; left time: 6389.1320s
	iters: 200, epoch: 3 | loss: 0.0863616
	speed: 0.0468s/iter; left time: 1886.7100s
	iters: 300, epoch: 3 | loss: 0.0172595
	speed: 0.0455s/iter; left time: 1827.0290s
	iters: 400, epoch: 3 | loss: 0.0136297
	speed: 0.0448s/iter; left time: 1796.4501s
Epoch: 3 cost time: 19.94903588294983
Epoch: 3, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.091 Vali Acc: 0.969 Test Loss: 0.091 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0048363
	speed: 0.1478s/iter; left time: 5907.0544s
	iters: 200, epoch: 4 | loss: 0.0169398
	speed: 0.0458s/iter; left time: 1824.1046s
	iters: 300, epoch: 4 | loss: 0.0454553
	speed: 0.0424s/iter; left time: 1687.2232s
	iters: 400, epoch: 4 | loss: 0.1067831
	speed: 0.0437s/iter; left time: 1735.0937s
Epoch: 4 cost time: 19.083773374557495
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.970440 --> -0.972714).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0766571
	speed: 0.1641s/iter; left time: 6489.9237s
	iters: 200, epoch: 5 | loss: 0.0335897
	speed: 0.0568s/iter; left time: 2239.6258s
	iters: 300, epoch: 5 | loss: 0.0039928
	speed: 0.0534s/iter; left time: 2099.8626s
	iters: 400, epoch: 5 | loss: 0.0012311
	speed: 0.0543s/iter; left time: 2132.9533s
Epoch: 5 cost time: 23.137651205062866
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.084 Vali Acc: 0.969 Test Loss: 0.084 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0307854
	speed: 0.1593s/iter; left time: 6234.4216s
	iters: 200, epoch: 6 | loss: 0.0014468
	speed: 0.0424s/iter; left time: 1653.2262s
	iters: 300, epoch: 6 | loss: 0.0042211
	speed: 0.0420s/iter; left time: 1634.5619s
	iters: 400, epoch: 6 | loss: 0.0010895
	speed: 0.0418s/iter; left time: 1621.7268s
Epoch: 6 cost time: 19.301340341567993
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.972 Test Loss: 0.086 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0462150
	speed: 0.1357s/iter; left time: 5252.8158s
	iters: 200, epoch: 7 | loss: 0.2515029
	speed: 0.0493s/iter; left time: 1904.4447s
	iters: 300, epoch: 7 | loss: 0.0002289
	speed: 0.0507s/iter; left time: 1952.1458s
	iters: 400, epoch: 7 | loss: 0.0092800
	speed: 0.0494s/iter; left time: 1898.0050s
Epoch: 7 cost time: 20.04085397720337
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.116 Vali Acc: 0.964 Test Loss: 0.116 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0003570
	speed: 0.1387s/iter; left time: 5312.6496s
	iters: 200, epoch: 8 | loss: 0.0032148
	speed: 0.0460s/iter; left time: 1758.1049s
	iters: 300, epoch: 8 | loss: 0.0008375
	speed: 0.0519s/iter; left time: 1977.4520s
	iters: 400, epoch: 8 | loss: 0.0000079
	speed: 0.0494s/iter; left time: 1879.3087s
Epoch: 8 cost time: 20.0373215675354
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0001359
	speed: 0.1391s/iter; left time: 5272.0989s
	iters: 200, epoch: 9 | loss: 0.0044702
	speed: 0.0522s/iter; left time: 1971.4848s
	iters: 300, epoch: 9 | loss: 0.0012211
	speed: 0.0550s/iter; left time: 2071.7792s
	iters: 400, epoch: 9 | loss: 0.0087178
	speed: 0.0580s/iter; left time: 2182.0153s
Epoch: 9 cost time: 22.563154458999634
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1567036
	speed: 0.1724s/iter; left time: 6462.4783s
	iters: 200, epoch: 10 | loss: 0.0012649
	speed: 0.0526s/iter; left time: 1964.8593s
	iters: 300, epoch: 10 | loss: 0.0012553
	speed: 0.0494s/iter; left time: 1843.1234s
	iters: 400, epoch: 10 | loss: 0.0165929
	speed: 0.0453s/iter; left time: 1683.4213s
Epoch: 10 cost time: 22.06823968887329
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0762086
	speed: 0.1490s/iter; left time: 5522.5042s
	iters: 200, epoch: 11 | loss: 0.0009691
	speed: 0.0559s/iter; left time: 2065.0428s
	iters: 300, epoch: 11 | loss: 0.0014294
	speed: 0.0467s/iter; left time: 1721.4818s
	iters: 400, epoch: 11 | loss: 0.0004793
	speed: 0.0440s/iter; left time: 1617.5355s
Epoch: 11 cost time: 20.842504024505615
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0035699
	speed: 0.1468s/iter; left time: 5380.2034s
	iters: 200, epoch: 12 | loss: 0.0045091
	speed: 0.0489s/iter; left time: 1786.9068s
	iters: 300, epoch: 12 | loss: 0.0001729
	speed: 0.0469s/iter; left time: 1708.0730s
	iters: 400, epoch: 12 | loss: 0.0000265
	speed: 0.0444s/iter; left time: 1612.9242s
Epoch: 12 cost time: 19.807456254959106
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0283327
	speed: 0.1501s/iter; left time: 5440.1462s
	iters: 200, epoch: 13 | loss: 0.0009259
	speed: 0.0445s/iter; left time: 1609.1388s
	iters: 300, epoch: 13 | loss: 0.0003231
	speed: 0.0408s/iter; left time: 1470.9762s
	iters: 400, epoch: 13 | loss: 0.0696308
	speed: 0.0456s/iter; left time: 1640.8520s
Epoch: 13 cost time: 19.128607511520386
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000103
	speed: 0.1564s/iter; left time: 5604.2168s
	iters: 200, epoch: 14 | loss: 0.0115188
	speed: 0.0467s/iter; left time: 1670.1215s
	iters: 300, epoch: 14 | loss: 0.0002388
	speed: 0.0459s/iter; left time: 1635.4698s
	iters: 400, epoch: 14 | loss: 0.0003585
	speed: 0.0460s/iter; left time: 1634.2070s
Epoch: 14 cost time: 19.73746967315674
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9727148703956344
model parameter : 28906
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9754938
	speed: 0.0647s/iter; left time: 2664.5575s
	iters: 200, epoch: 1 | loss: 0.3124570
	speed: 0.0442s/iter; left time: 1815.9672s
	iters: 300, epoch: 1 | loss: 0.2720094
	speed: 0.0454s/iter; left time: 1862.8473s
	iters: 400, epoch: 1 | loss: 0.1811502
	speed: 0.0467s/iter; left time: 1908.5166s
Epoch: 1 cost time: 20.812857627868652
Epoch: 1, Steps: 413 | Train Loss: 0.768 Vali Loss: 0.145 Vali Acc: 0.955 Test Loss: 0.145 Test Acc: 0.955
Validation loss decreased (inf --> -0.954978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0529536
	speed: 0.1450s/iter; left time: 5913.3239s
	iters: 200, epoch: 2 | loss: 0.1770313
	speed: 0.0439s/iter; left time: 1787.2393s
	iters: 300, epoch: 2 | loss: 0.0852061
	speed: 0.0448s/iter; left time: 1818.9741s
	iters: 400, epoch: 2 | loss: 0.1943190
	speed: 0.0423s/iter; left time: 1712.5809s
Epoch: 2 cost time: 18.358335494995117
Epoch: 2, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.095 Vali Acc: 0.967 Test Loss: 0.095 Test Acc: 0.967
Validation loss decreased (-0.954978 --> -0.967257).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0138117
	speed: 0.1454s/iter; left time: 5869.6743s
	iters: 200, epoch: 3 | loss: 0.0833487
	speed: 0.0471s/iter; left time: 1896.0798s
	iters: 300, epoch: 3 | loss: 0.0731401
	speed: 0.0474s/iter; left time: 1903.0773s
	iters: 400, epoch: 3 | loss: 0.0164815
	speed: 0.0468s/iter; left time: 1877.3428s
Epoch: 3 cost time: 19.904747009277344
Epoch: 3, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
Validation loss decreased (-0.967257 --> -0.972714).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0593538
	speed: 0.1469s/iter; left time: 5870.9401s
	iters: 200, epoch: 4 | loss: 0.0236799
	speed: 0.0458s/iter; left time: 1827.0055s
	iters: 300, epoch: 4 | loss: 0.0109269
	speed: 0.0440s/iter; left time: 1750.4717s
	iters: 400, epoch: 4 | loss: 0.1224277
	speed: 0.0404s/iter; left time: 1602.7363s
Epoch: 4 cost time: 18.915175199508667
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0248069
	speed: 0.1400s/iter; left time: 5537.3451s
	iters: 200, epoch: 5 | loss: 0.0647134
	speed: 0.0510s/iter; left time: 2010.7311s
	iters: 300, epoch: 5 | loss: 0.0288084
	speed: 0.0525s/iter; left time: 2064.4215s
	iters: 400, epoch: 5 | loss: 0.0775831
	speed: 0.0511s/iter; left time: 2004.4629s
Epoch: 5 cost time: 21.373274564743042
Epoch: 5, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.058 Vali Acc: 0.979 Test Loss: 0.058 Test Acc: 0.979
Validation loss decreased (-0.972714 --> -0.978626).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0341601
	speed: 0.1540s/iter; left time: 6026.4542s
	iters: 200, epoch: 6 | loss: 0.0144486
	speed: 0.0536s/iter; left time: 2092.2244s
	iters: 300, epoch: 6 | loss: 0.0202046
	speed: 0.0507s/iter; left time: 1973.8864s
	iters: 400, epoch: 6 | loss: 0.0193668
	speed: 0.0535s/iter; left time: 2076.1349s
Epoch: 6 cost time: 22.38083529472351
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0024966
	speed: 0.1493s/iter; left time: 5782.6513s
	iters: 200, epoch: 7 | loss: 0.0502220
	speed: 0.0437s/iter; left time: 1686.4418s
	iters: 300, epoch: 7 | loss: 0.0203270
	speed: 0.0416s/iter; left time: 1603.0026s
	iters: 400, epoch: 7 | loss: 0.0044051
	speed: 0.0453s/iter; left time: 1739.0236s
Epoch: 7 cost time: 18.554590463638306
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0020249
	speed: 0.1460s/iter; left time: 5594.7247s
	iters: 200, epoch: 8 | loss: 0.0005393
	speed: 0.0476s/iter; left time: 1819.6554s
	iters: 300, epoch: 8 | loss: 0.0129911
	speed: 0.0478s/iter; left time: 1820.4060s
	iters: 400, epoch: 8 | loss: 0.1419445
	speed: 0.0457s/iter; left time: 1736.5850s
Epoch: 8 cost time: 19.802746057510376
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0001024
	speed: 0.1445s/iter; left time: 5476.2801s
	iters: 200, epoch: 9 | loss: 0.1469730
	speed: 0.0473s/iter; left time: 1787.4919s
	iters: 300, epoch: 9 | loss: 0.0015823
	speed: 0.0486s/iter; left time: 1830.8647s
	iters: 400, epoch: 9 | loss: 0.0015747
	speed: 0.0516s/iter; left time: 1940.1971s
Epoch: 9 cost time: 20.59787082672119
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0001359
	speed: 0.1592s/iter; left time: 5967.8096s
	iters: 200, epoch: 10 | loss: 0.0018686
	speed: 0.0502s/iter; left time: 1875.6539s
	iters: 300, epoch: 10 | loss: 0.0077405
	speed: 0.0521s/iter; left time: 1940.6644s
	iters: 400, epoch: 10 | loss: 0.0053016
	speed: 0.0501s/iter; left time: 1862.7563s
Epoch: 10 cost time: 21.608779907226562
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0026380
	speed: 0.1537s/iter; left time: 5698.7334s
	iters: 200, epoch: 11 | loss: 0.0000888
	speed: 0.0479s/iter; left time: 1772.1589s
	iters: 300, epoch: 11 | loss: 0.0042795
	speed: 0.0476s/iter; left time: 1756.7445s
	iters: 400, epoch: 11 | loss: 0.0001138
	speed: 0.0486s/iter; left time: 1787.5437s
Epoch: 11 cost time: 20.5927951335907
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0005221
	speed: 0.1491s/iter; left time: 5466.9845s
	iters: 200, epoch: 12 | loss: 0.0000530
	speed: 0.0488s/iter; left time: 1785.5346s
	iters: 300, epoch: 12 | loss: 0.0007505
	speed: 0.0480s/iter; left time: 1750.3852s
	iters: 400, epoch: 12 | loss: 0.0003904
	speed: 0.0478s/iter; left time: 1736.2059s
Epoch: 12 cost time: 20.285240173339844
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
Validation loss decreased (-0.978626 --> -0.982264).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0002459
	speed: 0.1437s/iter; left time: 5208.9088s
	iters: 200, epoch: 13 | loss: 0.0018723
	speed: 0.0449s/iter; left time: 1622.2931s
	iters: 300, epoch: 13 | loss: 0.0001899
	speed: 0.0670s/iter; left time: 2416.4080s
	iters: 400, epoch: 13 | loss: 0.0026191
	speed: 0.0663s/iter; left time: 2384.2476s
Epoch: 13 cost time: 23.492422819137573
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000422
	speed: 0.1763s/iter; left time: 6315.9978s
	iters: 200, epoch: 14 | loss: 0.0031679
	speed: 0.0694s/iter; left time: 2479.2818s
	iters: 300, epoch: 14 | loss: 0.0001586
	speed: 0.0729s/iter; left time: 2598.8621s
	iters: 400, epoch: 14 | loss: 0.0025079
	speed: 0.0678s/iter; left time: 2407.5828s
Epoch: 14 cost time: 29.192671537399292
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0109624
	speed: 0.1886s/iter; left time: 6681.0647s
	iters: 200, epoch: 15 | loss: 0.0004249
	speed: 0.0743s/iter; left time: 2624.8168s
	iters: 300, epoch: 15 | loss: 0.0000035
	speed: 0.0599s/iter; left time: 2111.1058s
	iters: 400, epoch: 15 | loss: 0.0000015
	speed: 0.0717s/iter; left time: 2518.3146s
Epoch: 15 cost time: 28.772039651870728
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0139485
	speed: 0.1945s/iter; left time: 6807.1734s
	iters: 200, epoch: 16 | loss: 0.0002219
	speed: 0.0643s/iter; left time: 2244.9006s
	iters: 300, epoch: 16 | loss: 0.0000195
	speed: 0.0687s/iter; left time: 2389.8399s
	iters: 400, epoch: 16 | loss: 0.0005819
	speed: 0.0675s/iter; left time: 2343.0353s
Epoch: 16 cost time: 28.502514600753784
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000037
	speed: 0.1829s/iter; left time: 6325.7475s
	iters: 200, epoch: 17 | loss: 0.0000253
	speed: 0.0623s/iter; left time: 2148.2835s
	iters: 300, epoch: 17 | loss: 0.0000236
	speed: 0.0639s/iter; left time: 2197.5946s
	iters: 400, epoch: 17 | loss: 0.0320200
	speed: 0.0545s/iter; left time: 1869.7325s
Epoch: 17 cost time: 25.581815719604492
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0007345
	speed: 0.1740s/iter; left time: 5945.7903s
	iters: 200, epoch: 18 | loss: 0.0044703
	speed: 0.0672s/iter; left time: 2290.5624s
	iters: 300, epoch: 18 | loss: 0.0000865
	speed: 0.0595s/iter; left time: 2023.2907s
	iters: 400, epoch: 18 | loss: 0.0053640
	speed: 0.0641s/iter; left time: 2170.3828s
Epoch: 18 cost time: 26.42629384994507
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.1787518
	speed: 0.1768s/iter; left time: 5970.4532s
	iters: 200, epoch: 19 | loss: 0.0000210
	speed: 0.0487s/iter; left time: 1637.9626s
	iters: 300, epoch: 19 | loss: 0.0000981
	speed: 0.0543s/iter; left time: 1822.0590s
	iters: 400, epoch: 19 | loss: 0.0000008
	speed: 0.0675s/iter; left time: 2259.1370s
Epoch: 19 cost time: 24.69303870201111
Epoch: 19, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0090527
	speed: 0.1557s/iter; left time: 5192.3049s
	iters: 200, epoch: 20 | loss: 0.2031891
	speed: 0.0472s/iter; left time: 1569.5809s
	iters: 300, epoch: 20 | loss: 0.0475148
	speed: 0.0477s/iter; left time: 1580.9156s
	iters: 400, epoch: 20 | loss: 0.0000011
	speed: 0.0507s/iter; left time: 1676.9685s
Epoch: 20 cost time: 20.592286109924316
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000580
	speed: 0.1647s/iter; left time: 5424.4204s
	iters: 200, epoch: 21 | loss: 0.0000060
	speed: 0.0618s/iter; left time: 2029.3300s
	iters: 300, epoch: 21 | loss: 0.0001549
	speed: 0.0595s/iter; left time: 1947.3317s
	iters: 400, epoch: 21 | loss: 0.0000032
	speed: 0.0508s/iter; left time: 1659.3012s
Epoch: 21 cost time: 23.399438858032227
Epoch: 21, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000113
	speed: 0.1657s/iter; left time: 5391.0699s
	iters: 200, epoch: 22 | loss: 0.0001142
	speed: 0.0601s/iter; left time: 1948.0150s
	iters: 300, epoch: 22 | loss: 0.0229517
	speed: 0.0529s/iter; left time: 1711.6276s
	iters: 400, epoch: 22 | loss: 0.0059778
	speed: 0.0553s/iter; left time: 1781.7411s
Epoch: 22 cost time: 23.65361714363098
Epoch: 22, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el3_dm16_nh4_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 24826
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3395305
	speed: 0.1220s/iter; left time: 5028.0656s
	iters: 200, epoch: 1 | loss: 0.0010588
	speed: 0.0852s/iter; left time: 3502.2055s
	iters: 300, epoch: 1 | loss: 0.0705893
	speed: 0.0931s/iter; left time: 3816.9074s
	iters: 400, epoch: 1 | loss: 0.2968461
	speed: 0.1087s/iter; left time: 4443.9768s
Epoch: 1 cost time: 42.386778354644775
Epoch: 1, Steps: 413 | Train Loss: 0.421 Vali Loss: 0.203 Vali Acc: 0.961 Test Loss: 0.203 Test Acc: 0.961
Validation loss decreased (inf --> -0.960889).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4965792
	speed: 0.2384s/iter; left time: 9724.3600s
	iters: 200, epoch: 2 | loss: 0.9125631
	speed: 0.1099s/iter; left time: 4471.7213s
	iters: 300, epoch: 2 | loss: 0.4484591
	speed: 0.1126s/iter; left time: 4569.2400s
	iters: 400, epoch: 2 | loss: 0.0034296
	speed: 0.1037s/iter; left time: 4197.8236s
Epoch: 2 cost time: 44.9064154624939
Epoch: 2, Steps: 413 | Train Loss: 0.255 Vali Loss: 0.627 Vali Acc: 0.946 Test Loss: 0.627 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000041
	speed: 0.2394s/iter; left time: 9664.1746s
	iters: 200, epoch: 3 | loss: 0.0000000
	speed: 0.0953s/iter; left time: 3836.2541s
	iters: 300, epoch: 3 | loss: 0.0017685
	speed: 0.0845s/iter; left time: 3393.3500s
	iters: 400, epoch: 3 | loss: 0.0008607
	speed: 0.0715s/iter; left time: 2864.0495s
Epoch: 3 cost time: 36.6473605632782
Epoch: 3, Steps: 413 | Train Loss: 0.299 Vali Loss: 0.960 Vali Acc: 0.939 Test Loss: 0.960 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6847114
	speed: 0.2353s/iter; left time: 9401.0827s
	iters: 200, epoch: 4 | loss: 0.0002886
	speed: 0.1012s/iter; left time: 4034.9826s
	iters: 300, epoch: 4 | loss: 0.0038609
	speed: 0.0991s/iter; left time: 3942.2673s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0949s/iter; left time: 3765.6677s
Epoch: 4 cost time: 42.426724433898926
Epoch: 4, Steps: 413 | Train Loss: 0.293 Vali Loss: 0.760 Vali Acc: 0.960 Test Loss: 0.760 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.3413290
	speed: 0.2302s/iter; left time: 9104.9670s
	iters: 200, epoch: 5 | loss: 0.0000001
	speed: 0.1052s/iter; left time: 4151.2553s
	iters: 300, epoch: 5 | loss: 0.0000433
	speed: 0.0950s/iter; left time: 3737.6917s
	iters: 400, epoch: 5 | loss: 0.1821165
	speed: 0.0943s/iter; left time: 3702.1177s
Epoch: 5 cost time: 40.78106164932251
Epoch: 5, Steps: 413 | Train Loss: 0.409 Vali Loss: 0.855 Vali Acc: 0.940 Test Loss: 0.855 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.2538847
	speed: 0.2029s/iter; left time: 7940.6693s
	iters: 200, epoch: 6 | loss: 0.7317801
	speed: 0.0840s/iter; left time: 3278.0002s
	iters: 300, epoch: 6 | loss: 0.0000014
	speed: 0.0955s/iter; left time: 3720.2748s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0993s/iter; left time: 3855.3735s
Epoch: 6 cost time: 37.4292516708374
Epoch: 6, Steps: 413 | Train Loss: 0.343 Vali Loss: 1.491 Vali Acc: 0.937 Test Loss: 1.491 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.8248645
	speed: 0.2595s/iter; left time: 10046.8782s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.1157s/iter; left time: 4467.5017s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.1046s/iter; left time: 4029.2262s
	iters: 400, epoch: 7 | loss: 2.2522192
	speed: 0.0979s/iter; left time: 3760.0382s
Epoch: 7 cost time: 45.07274842262268
Epoch: 7, Steps: 413 | Train Loss: 0.506 Vali Loss: 0.818 Vali Acc: 0.962 Test Loss: 0.818 Test Acc: 0.962
Validation loss decreased (-0.960889 --> -0.961793).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1940532
	speed: 0.2187s/iter; left time: 8379.6863s
	iters: 200, epoch: 8 | loss: 1.7023273
	speed: 0.1133s/iter; left time: 4328.6744s
	iters: 300, epoch: 8 | loss: 1.4874556
	speed: 0.1039s/iter; left time: 3960.2366s
	iters: 400, epoch: 8 | loss: 0.8935702
	speed: 0.0926s/iter; left time: 3521.0908s
Epoch: 8 cost time: 42.557942152023315
Epoch: 8, Steps: 413 | Train Loss: 0.414 Vali Loss: 1.374 Vali Acc: 0.953 Test Loss: 1.374 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000196
	speed: 0.2246s/iter; left time: 8511.3787s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1185s/iter; left time: 4479.6216s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1086s/iter; left time: 4093.7948s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1172s/iter; left time: 4405.4294s
Epoch: 9 cost time: 46.28578019142151
Epoch: 9, Steps: 413 | Train Loss: 0.396 Vali Loss: 1.144 Vali Acc: 0.962 Test Loss: 1.144 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2608s/iter; left time: 9774.2066s
	iters: 200, epoch: 10 | loss: 1.4032823
	speed: 0.1185s/iter; left time: 4431.4342s
	iters: 300, epoch: 10 | loss: 0.6166140
	speed: 0.1134s/iter; left time: 4226.9308s
	iters: 400, epoch: 10 | loss: 0.2373512
	speed: 0.0918s/iter; left time: 3413.9843s
Epoch: 10 cost time: 45.20932054519653
Epoch: 10, Steps: 413 | Train Loss: 0.329 Vali Loss: 1.365 Vali Acc: 0.957 Test Loss: 1.365 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2516s/iter; left time: 9326.8269s
	iters: 200, epoch: 11 | loss: 2.2371764
	speed: 0.1073s/iter; left time: 3967.5397s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1096s/iter; left time: 4040.5079s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1114s/iter; left time: 4095.5643s
Epoch: 11 cost time: 46.15734648704529
Epoch: 11, Steps: 413 | Train Loss: 0.269 Vali Loss: 1.957 Vali Acc: 0.936 Test Loss: 1.957 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2601s/iter; left time: 9533.8948s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1004s/iter; left time: 3669.1913s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0961s/iter; left time: 3503.7102s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1358s/iter; left time: 4937.1634s
Epoch: 12 cost time: 46.409268617630005
Epoch: 12, Steps: 413 | Train Loss: 0.339 Vali Loss: 1.125 Vali Acc: 0.965 Test Loss: 1.125 Test Acc: 0.965
Validation loss decreased (-0.961793 --> -0.964973).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3151s/iter; left time: 11422.3323s
	iters: 200, epoch: 13 | loss: 0.0000067
	speed: 0.1299s/iter; left time: 4697.0262s
	iters: 300, epoch: 13 | loss: 0.5079468
	speed: 0.1282s/iter; left time: 4621.4912s
	iters: 400, epoch: 13 | loss: 4.0844564
	speed: 0.1376s/iter; left time: 4946.5744s
Epoch: 13 cost time: 55.2117018699646
Epoch: 13, Steps: 413 | Train Loss: 0.297 Vali Loss: 0.986 Vali Acc: 0.964 Test Loss: 0.986 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3171s/iter; left time: 11363.1128s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1458s/iter; left time: 5207.9662s
	iters: 300, epoch: 14 | loss: 0.0000003
	speed: 0.1570s/iter; left time: 5595.0707s
	iters: 400, epoch: 14 | loss: 0.0002345
	speed: 0.1704s/iter; left time: 6053.4830s
Epoch: 14 cost time: 63.346450090408325
Epoch: 14, Steps: 413 | Train Loss: 0.248 Vali Loss: 1.287 Vali Acc: 0.959 Test Loss: 1.287 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3658s/iter; left time: 12955.7488s
	iters: 200, epoch: 15 | loss: 0.0847352
	speed: 0.1608s/iter; left time: 5679.7184s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1675s/iter; left time: 5899.4861s
	iters: 400, epoch: 15 | loss: 0.5050696
	speed: 0.1608s/iter; left time: 5648.8680s
Epoch: 15 cost time: 67.62243294715881
Epoch: 15, Steps: 413 | Train Loss: 0.299 Vali Loss: 1.657 Vali Acc: 0.954 Test Loss: 1.657 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.3048s/iter; left time: 10669.8445s
	iters: 200, epoch: 16 | loss: 0.0135083
	speed: 0.1620s/iter; left time: 5655.5111s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1517s/iter; left time: 5281.5054s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1459s/iter; left time: 5063.6424s
Epoch: 16 cost time: 61.769022703170776
Epoch: 16, Steps: 413 | Train Loss: 0.310 Vali Loss: 1.360 Vali Acc: 0.964 Test Loss: 1.360 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3524s/iter; left time: 12189.9357s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1512s/iter; left time: 5214.8527s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1404s/iter; left time: 4829.7165s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1271s/iter; left time: 4360.2425s
Epoch: 17 cost time: 58.866883277893066
Epoch: 17, Steps: 413 | Train Loss: 0.188 Vali Loss: 1.334 Vali Acc: 0.964 Test Loss: 1.334 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3169s/iter; left time: 10832.5669s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1475s/iter; left time: 5027.2514s
	iters: 300, epoch: 18 | loss: 0.1405612
	speed: 0.1467s/iter; left time: 4985.6014s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1341s/iter; left time: 4542.5335s
Epoch: 18 cost time: 59.475095987319946
Epoch: 18, Steps: 413 | Train Loss: 0.230 Vali Loss: 2.377 Vali Acc: 0.934 Test Loss: 2.377 Test Acc: 0.934
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.3519s/iter; left time: 11882.0729s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1348s/iter; left time: 4537.3136s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1246s/iter; left time: 4182.1361s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1339s/iter; left time: 4481.7939s
Epoch: 19 cost time: 56.73115372657776
Epoch: 19, Steps: 413 | Train Loss: 0.176 Vali Loss: 1.671 Vali Acc: 0.962 Test Loss: 1.671 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.3358s/iter; left time: 11199.2461s
	iters: 200, epoch: 20 | loss: 0.0000032
	speed: 0.1403s/iter; left time: 4664.7067s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.1478s/iter; left time: 4900.3280s
	iters: 400, epoch: 20 | loss: 0.0003413
	speed: 0.1608s/iter; left time: 5316.0108s
Epoch: 20 cost time: 60.58896446228027
Epoch: 20, Steps: 413 | Train Loss: 0.181 Vali Loss: 1.629 Vali Acc: 0.961 Test Loss: 1.629 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.3251s/iter; left time: 10708.5656s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.1402s/iter; left time: 4604.0952s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1378s/iter; left time: 4512.3137s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1331s/iter; left time: 4344.1332s
Epoch: 21 cost time: 56.4409077167511
Epoch: 21, Steps: 413 | Train Loss: 0.191 Vali Loss: 1.505 Vali Acc: 0.960 Test Loss: 1.505 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.3045s/iter; left time: 9903.8783s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1462s/iter; left time: 4739.8834s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1372s/iter; left time: 4434.0374s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1343s/iter; left time: 4328.0164s
Epoch: 22 cost time: 56.618630170822144
Epoch: 22, Steps: 413 | Train Loss: 0.290 Vali Loss: 2.393 Vali Acc: 0.947 Test Loss: 2.393 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9649840836743975
model parameter : 1047690
model size : 6.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7399705
	speed: 0.1259s/iter; left time: 5185.2898s
	iters: 200, epoch: 1 | loss: 0.0142249
	speed: 0.0978s/iter; left time: 4021.7280s
	iters: 300, epoch: 1 | loss: 0.0091529
	speed: 0.0898s/iter; left time: 3681.9675s
	iters: 400, epoch: 1 | loss: 0.0151314
	speed: 0.1013s/iter; left time: 4142.5175s
Epoch: 1 cost time: 43.10393238067627
Epoch: 1, Steps: 413 | Train Loss: 0.405 Vali Loss: 0.284 Vali Acc: 0.939 Test Loss: 0.284 Test Acc: 0.939
Validation loss decreased (inf --> -0.938606).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1674348
	speed: 0.2589s/iter; left time: 10561.1097s
	iters: 200, epoch: 2 | loss: 0.4392456
	speed: 0.0797s/iter; left time: 3242.8801s
	iters: 300, epoch: 2 | loss: 0.0024617
	speed: 0.0805s/iter; left time: 3267.9164s
	iters: 400, epoch: 2 | loss: 0.0116680
	speed: 0.0857s/iter; left time: 3468.1372s
Epoch: 2 cost time: 36.22292685508728
Epoch: 2, Steps: 413 | Train Loss: 0.200 Vali Loss: 0.641 Vali Acc: 0.905 Test Loss: 0.641 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0130039
	speed: 0.2600s/iter; left time: 10496.1778s
	iters: 200, epoch: 3 | loss: 0.0000004
	speed: 0.0820s/iter; left time: 3304.5516s
	iters: 300, epoch: 3 | loss: 0.0015678
	speed: 0.0901s/iter; left time: 3620.3295s
	iters: 400, epoch: 3 | loss: 0.0001345
	speed: 0.0900s/iter; left time: 3606.8276s
Epoch: 3 cost time: 38.86601495742798
Epoch: 3, Steps: 413 | Train Loss: 0.261 Vali Loss: 0.274 Vali Acc: 0.961 Test Loss: 0.274 Test Acc: 0.961
Validation loss decreased (-0.938606 --> -0.961343).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3900327
	speed: 0.2638s/iter; left time: 10541.4614s
	iters: 200, epoch: 4 | loss: 0.0000027
	speed: 0.0949s/iter; left time: 3780.9181s
	iters: 300, epoch: 4 | loss: 0.0000796
	speed: 0.0941s/iter; left time: 3743.0870s
	iters: 400, epoch: 4 | loss: 0.1433303
	speed: 0.0926s/iter; left time: 3673.0448s
Epoch: 4 cost time: 40.54502034187317
Epoch: 4, Steps: 413 | Train Loss: 0.276 Vali Loss: 0.626 Vali Acc: 0.960 Test Loss: 0.626 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8598772
	speed: 0.2594s/iter; left time: 10259.2783s
	iters: 200, epoch: 5 | loss: 0.0072660
	speed: 0.0902s/iter; left time: 3557.0017s
	iters: 300, epoch: 5 | loss: 0.0065197
	speed: 0.0870s/iter; left time: 3423.6261s
	iters: 400, epoch: 5 | loss: 0.4203200
	speed: 0.0780s/iter; left time: 3061.7220s
Epoch: 5 cost time: 37.62749719619751
Epoch: 5, Steps: 413 | Train Loss: 0.285 Vali Loss: 0.795 Vali Acc: 0.933 Test Loss: 0.795 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1669901
	speed: 0.2900s/iter; left time: 11349.4013s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.1323s/iter; left time: 5163.3917s
	iters: 300, epoch: 6 | loss: 0.9531947
	speed: 0.1192s/iter; left time: 4639.6484s
	iters: 400, epoch: 6 | loss: 0.2449549
	speed: 0.1251s/iter; left time: 4860.0394s
Epoch: 6 cost time: 53.51531481742859
Epoch: 6, Steps: 413 | Train Loss: 0.299 Vali Loss: 1.026 Vali Acc: 0.917 Test Loss: 1.026 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0035328
	speed: 0.3140s/iter; left time: 12159.9619s
	iters: 200, epoch: 7 | loss: 0.1444439
	speed: 0.1096s/iter; left time: 4232.5354s
	iters: 300, epoch: 7 | loss: 0.0002895
	speed: 0.1098s/iter; left time: 4228.7002s
	iters: 400, epoch: 7 | loss: 0.0048422
	speed: 0.1253s/iter; left time: 4813.7643s
Epoch: 7 cost time: 50.60455250740051
Epoch: 7, Steps: 413 | Train Loss: 0.373 Vali Loss: 0.758 Vali Acc: 0.961 Test Loss: 0.758 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0349433
	speed: 0.2951s/iter; left time: 11306.1369s
	iters: 200, epoch: 8 | loss: 0.0092134
	speed: 0.1102s/iter; left time: 4211.8194s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.1149s/iter; left time: 4379.1047s
	iters: 400, epoch: 8 | loss: 0.5236986
	speed: 0.1099s/iter; left time: 4175.7578s
Epoch: 8 cost time: 47.794299840927124
Epoch: 8, Steps: 413 | Train Loss: 0.355 Vali Loss: 1.939 Vali Acc: 0.863 Test Loss: 1.939 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2784s/iter; left time: 10551.1202s
	iters: 200, epoch: 9 | loss: 0.2656453
	speed: 0.1139s/iter; left time: 4304.7966s
	iters: 300, epoch: 9 | loss: 0.5165743
	speed: 0.1069s/iter; left time: 4030.0909s
	iters: 400, epoch: 9 | loss: 0.6432493
	speed: 0.1107s/iter; left time: 4160.7715s
Epoch: 9 cost time: 45.7393741607666
Epoch: 9, Steps: 413 | Train Loss: 0.305 Vali Loss: 0.606 Vali Acc: 0.960 Test Loss: 0.606 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000037
	speed: 0.2350s/iter; left time: 8808.3543s
	iters: 200, epoch: 10 | loss: 0.0002728
	speed: 0.1009s/iter; left time: 3771.4494s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.1095s/iter; left time: 4081.3987s
	iters: 400, epoch: 10 | loss: 0.9629817
	speed: 0.1148s/iter; left time: 4270.5601s
Epoch: 10 cost time: 43.05080223083496
Epoch: 10, Steps: 413 | Train Loss: 0.289 Vali Loss: 1.409 Vali Acc: 0.935 Test Loss: 1.409 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0007527
	speed: 0.2814s/iter; left time: 10433.1472s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1033s/iter; left time: 3818.0413s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1081s/iter; left time: 3985.5412s
	iters: 400, epoch: 11 | loss: 0.0034664
	speed: 0.1270s/iter; left time: 4671.0422s
Epoch: 11 cost time: 46.79487156867981
Epoch: 11, Steps: 413 | Train Loss: 0.288 Vali Loss: 1.075 Vali Acc: 0.960 Test Loss: 1.075 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2720s/iter; left time: 9970.1486s
	iters: 200, epoch: 12 | loss: 0.0331937
	speed: 0.0750s/iter; left time: 2740.6559s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 2904.4643s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 3312.7417s
Epoch: 12 cost time: 37.247501373291016
Epoch: 12, Steps: 413 | Train Loss: 0.290 Vali Loss: 0.869 Vali Acc: 0.964 Test Loss: 0.869 Test Acc: 0.964
Validation loss decreased (-0.961343 --> -0.964066).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2672s/iter; left time: 9686.1059s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1047s/iter; left time: 3784.2205s
	iters: 300, epoch: 13 | loss: 0.8966526
	speed: 0.1009s/iter; left time: 3636.3755s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1067s/iter; left time: 3835.1374s
Epoch: 13 cost time: 43.34023332595825
Epoch: 13, Steps: 413 | Train Loss: 0.213 Vali Loss: 0.581 Vali Acc: 0.977 Test Loss: 0.581 Test Acc: 0.977
Validation loss decreased (-0.964066 --> -0.977257).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2680s/iter; left time: 9601.9929s
	iters: 200, epoch: 14 | loss: 0.2927456
	speed: 0.0962s/iter; left time: 3437.5291s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0834s/iter; left time: 2970.2902s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0825s/iter; left time: 2932.5570s
Epoch: 14 cost time: 38.334070682525635
Epoch: 14, Steps: 413 | Train Loss: 0.242 Vali Loss: 0.842 Vali Acc: 0.973 Test Loss: 0.842 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2741s/iter; left time: 9706.7973s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1032s/iter; left time: 3645.0052s
	iters: 300, epoch: 15 | loss: 0.6276048
	speed: 0.0978s/iter; left time: 3445.2383s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0990s/iter; left time: 3476.7381s
Epoch: 15 cost time: 42.88296294212341
Epoch: 15, Steps: 413 | Train Loss: 0.274 Vali Loss: 1.008 Vali Acc: 0.963 Test Loss: 1.008 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2712s/iter; left time: 9493.0334s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0974s/iter; left time: 3400.7678s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1048s/iter; left time: 3646.5264s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1170s/iter; left time: 4060.7079s
Epoch: 16 cost time: 44.79415798187256
Epoch: 16, Steps: 413 | Train Loss: 0.194 Vali Loss: 0.769 Vali Acc: 0.972 Test Loss: 0.769 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.6417865
	speed: 0.2787s/iter; left time: 9642.6162s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0994s/iter; left time: 3427.4326s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1007s/iter; left time: 3462.0845s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1126s/iter; left time: 3861.7593s
Epoch: 17 cost time: 43.66359257698059
Epoch: 17, Steps: 413 | Train Loss: 0.225 Vali Loss: 1.436 Vali Acc: 0.954 Test Loss: 1.436 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1992s/iter; left time: 6808.8014s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0804s/iter; left time: 2740.9626s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0877s/iter; left time: 2979.8078s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0909s/iter; left time: 3080.3194s
Epoch: 18 cost time: 34.70036458969116
Epoch: 18, Steps: 413 | Train Loss: 0.167 Vali Loss: 0.680 Vali Acc: 0.977 Test Loss: 0.680 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2353s/iter; left time: 7944.9398s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0952s/iter; left time: 3206.5171s
	iters: 300, epoch: 19 | loss: 0.4560529
	speed: 0.0873s/iter; left time: 2929.2836s
	iters: 400, epoch: 19 | loss: 0.0481297
	speed: 0.0870s/iter; left time: 2912.2940s
Epoch: 19 cost time: 38.703397035598755
Epoch: 19, Steps: 413 | Train Loss: 0.253 Vali Loss: 1.674 Vali Acc: 0.947 Test Loss: 1.674 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2385s/iter; left time: 7953.5074s
	iters: 200, epoch: 20 | loss: 0.0338701
	speed: 0.0850s/iter; left time: 2825.3343s
	iters: 300, epoch: 20 | loss: 0.0000103
	speed: 0.0798s/iter; left time: 2646.0623s
	iters: 400, epoch: 20 | loss: 0.1814632
	speed: 0.0945s/iter; left time: 3123.8000s
Epoch: 20 cost time: 36.767531394958496
Epoch: 20, Steps: 413 | Train Loss: 0.273 Vali Loss: 0.792 Vali Acc: 0.966 Test Loss: 0.792 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2296s/iter; left time: 7563.2369s
	iters: 200, epoch: 21 | loss: 0.0000968
	speed: 0.0781s/iter; left time: 2564.9659s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0840s/iter; left time: 2749.6741s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 2603.6472s
Epoch: 21 cost time: 34.9100661277771
Epoch: 21, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.801 Vali Acc: 0.973 Test Loss: 0.801 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.9969294
	speed: 0.2283s/iter; left time: 7426.3051s
	iters: 200, epoch: 22 | loss: 0.0345995
	speed: 0.0932s/iter; left time: 3021.8424s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0918s/iter; left time: 2968.7220s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0904s/iter; left time: 2914.6287s
Epoch: 22 cost time: 38.180712938308716
Epoch: 22, Steps: 413 | Train Loss: 0.236 Vali Loss: 1.077 Vali Acc: 0.962 Test Loss: 1.077 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2234s/iter; left time: 7175.6336s
	iters: 200, epoch: 23 | loss: 1.1008165
	speed: 0.0860s/iter; left time: 2753.5590s
	iters: 300, epoch: 23 | loss: 0.2472992
	speed: 0.0875s/iter; left time: 2793.3789s
	iters: 400, epoch: 23 | loss: 0.4353703
	speed: 0.0852s/iter; left time: 2712.0135s
Epoch: 23 cost time: 35.75244617462158
Epoch: 23, Steps: 413 | Train Loss: 0.222 Vali Loss: 1.176 Vali Acc: 0.961 Test Loss: 1.176 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.977262391996362
model parameter : 781706
model size : 5.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1704529
	speed: 0.1076s/iter; left time: 4434.6566s
	iters: 200, epoch: 1 | loss: 0.6005409
	speed: 0.0867s/iter; left time: 3561.4449s
	iters: 300, epoch: 1 | loss: 0.0647579
	speed: 0.0874s/iter; left time: 3581.5791s
	iters: 400, epoch: 1 | loss: 0.1481690
	speed: 0.0900s/iter; left time: 3680.7261s
Epoch: 1 cost time: 38.39787244796753
Epoch: 1, Steps: 413 | Train Loss: 0.382 Vali Loss: 0.300 Vali Acc: 0.940 Test Loss: 0.300 Test Acc: 0.940
Validation loss decreased (inf --> -0.939970).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1895786
	speed: 0.2141s/iter; left time: 8734.5573s
	iters: 200, epoch: 2 | loss: 0.1038045
	speed: 0.0737s/iter; left time: 2997.5587s
	iters: 300, epoch: 2 | loss: 0.0001237
	speed: 0.0742s/iter; left time: 3010.0971s
	iters: 400, epoch: 2 | loss: 0.1764016
	speed: 0.0765s/iter; left time: 3097.3388s
Epoch: 2 cost time: 32.20640993118286
Epoch: 2, Steps: 413 | Train Loss: 0.178 Vali Loss: 0.225 Vali Acc: 0.959 Test Loss: 0.225 Test Acc: 0.959
Validation loss decreased (-0.939970 --> -0.958615).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0033246
	speed: 0.2331s/iter; left time: 9412.9878s
	iters: 200, epoch: 3 | loss: 0.3473915
	speed: 0.1076s/iter; left time: 4331.7628s
	iters: 300, epoch: 3 | loss: 0.0153888
	speed: 0.1036s/iter; left time: 4161.4447s
	iters: 400, epoch: 3 | loss: 0.2594070
	speed: 0.1013s/iter; left time: 4060.4307s
Epoch: 3 cost time: 43.10271859169006
Epoch: 3, Steps: 413 | Train Loss: 0.194 Vali Loss: 0.243 Vali Acc: 0.968 Test Loss: 0.243 Test Acc: 0.968
Validation loss decreased (-0.958615 --> -0.967710).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0009690
	speed: 0.2482s/iter; left time: 9918.2976s
	iters: 200, epoch: 4 | loss: 0.0000001
	speed: 0.1011s/iter; left time: 4030.4833s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.0998s/iter; left time: 3967.1750s
	iters: 400, epoch: 4 | loss: 1.6623979
	speed: 0.1147s/iter; left time: 4548.6354s
Epoch: 4 cost time: 43.983925580978394
Epoch: 4, Steps: 413 | Train Loss: 0.233 Vali Loss: 0.421 Vali Acc: 0.954 Test Loss: 0.421 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000206
	speed: 0.2442s/iter; left time: 9658.3323s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.1049s/iter; left time: 4138.6302s
	iters: 300, epoch: 5 | loss: 0.0001137
	speed: 0.1073s/iter; left time: 4220.9056s
	iters: 400, epoch: 5 | loss: 0.0409359
	speed: 0.1011s/iter; left time: 3968.3921s
Epoch: 5 cost time: 43.79691123962402
Epoch: 5, Steps: 413 | Train Loss: 0.232 Vali Loss: 0.485 Vali Acc: 0.949 Test Loss: 0.485 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3828603
	speed: 0.2559s/iter; left time: 10013.7203s
	iters: 200, epoch: 6 | loss: 0.0011883
	speed: 0.1059s/iter; left time: 4132.7438s
	iters: 300, epoch: 6 | loss: 0.2307629
	speed: 0.0994s/iter; left time: 3870.0716s
	iters: 400, epoch: 6 | loss: 0.0000003
	speed: 0.1160s/iter; left time: 4503.1851s
Epoch: 6 cost time: 45.51318693161011
Epoch: 6, Steps: 413 | Train Loss: 0.269 Vali Loss: 0.729 Vali Acc: 0.945 Test Loss: 0.729 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000004
	speed: 0.2865s/iter; left time: 11095.9776s
	iters: 200, epoch: 7 | loss: 0.1658136
	speed: 0.1233s/iter; left time: 4762.5816s
	iters: 300, epoch: 7 | loss: 0.0000190
	speed: 0.1335s/iter; left time: 5144.5409s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.1233s/iter; left time: 4737.2056s
Epoch: 7 cost time: 52.82411813735962
Epoch: 7, Steps: 413 | Train Loss: 0.242 Vali Loss: 0.786 Vali Acc: 0.959 Test Loss: 0.786 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000018
	speed: 0.2658s/iter; left time: 10181.1653s
	iters: 200, epoch: 8 | loss: 0.2404463
	speed: 0.1143s/iter; left time: 4365.7545s
	iters: 300, epoch: 8 | loss: 0.0000164
	speed: 0.1100s/iter; left time: 4191.0518s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.1039s/iter; left time: 3949.4037s
Epoch: 8 cost time: 46.027708768844604
Epoch: 8, Steps: 413 | Train Loss: 0.266 Vali Loss: 0.461 Vali Acc: 0.973 Test Loss: 0.461 Test Acc: 0.973
Validation loss decreased (-0.967710 --> -0.973165).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.7977483
	speed: 0.2389s/iter; left time: 9054.9578s
	iters: 200, epoch: 9 | loss: 0.0000052
	speed: 0.1040s/iter; left time: 3931.4586s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1115s/iter; left time: 4202.4927s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1007s/iter; left time: 3787.1365s
Epoch: 9 cost time: 43.59976816177368
Epoch: 9, Steps: 413 | Train Loss: 0.224 Vali Loss: 0.662 Vali Acc: 0.968 Test Loss: 0.662 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000011
	speed: 0.2288s/iter; left time: 8575.6885s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2907.6400s
	iters: 300, epoch: 10 | loss: 0.2039693
	speed: 0.0688s/iter; left time: 2564.9439s
	iters: 400, epoch: 10 | loss: 0.0143885
	speed: 0.0713s/iter; left time: 2651.6078s
Epoch: 10 cost time: 32.763423681259155
Epoch: 10, Steps: 413 | Train Loss: 0.225 Vali Loss: 0.444 Vali Acc: 0.970 Test Loss: 0.444 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.2083s/iter; left time: 7723.4928s
	iters: 200, epoch: 11 | loss: 0.1030843
	speed: 0.0896s/iter; left time: 3313.7450s
	iters: 300, epoch: 11 | loss: 3.0688922
	speed: 0.0876s/iter; left time: 3230.5086s
	iters: 400, epoch: 11 | loss: 0.0002584
	speed: 0.0879s/iter; left time: 3232.4537s
Epoch: 11 cost time: 37.373923540115356
Epoch: 11, Steps: 413 | Train Loss: 0.304 Vali Loss: 0.706 Vali Acc: 0.950 Test Loss: 0.706 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0473426
	speed: 0.2120s/iter; left time: 7769.7508s
	iters: 200, epoch: 12 | loss: 0.0000457
	speed: 0.0871s/iter; left time: 3183.2681s
	iters: 300, epoch: 12 | loss: 0.0000202
	speed: 0.0869s/iter; left time: 3169.4734s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0863s/iter; left time: 3137.0112s
Epoch: 12 cost time: 36.1329083442688
Epoch: 12, Steps: 413 | Train Loss: 0.230 Vali Loss: 0.843 Vali Acc: 0.961 Test Loss: 0.843 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.3149321
	speed: 0.2133s/iter; left time: 7729.2470s
	iters: 200, epoch: 13 | loss: 0.0336441
	speed: 0.0900s/iter; left time: 3253.3184s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0847s/iter; left time: 3051.8697s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 3273.5302s
Epoch: 13 cost time: 37.20462203025818
Epoch: 13, Steps: 413 | Train Loss: 0.226 Vali Loss: 0.592 Vali Acc: 0.971 Test Loss: 0.592 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000459
	speed: 0.2189s/iter; left time: 7842.5939s
	iters: 200, epoch: 14 | loss: 0.2649027
	speed: 0.0852s/iter; left time: 3043.2734s
	iters: 300, epoch: 14 | loss: 0.0000418
	speed: 0.0703s/iter; left time: 2503.5187s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 2440.2326s
Epoch: 14 cost time: 32.44176959991455
Epoch: 14, Steps: 413 | Train Loss: 0.163 Vali Loss: 0.692 Vali Acc: 0.968 Test Loss: 0.692 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1768s/iter; left time: 6261.1963s
	iters: 200, epoch: 15 | loss: 0.2978399
	speed: 0.0820s/iter; left time: 2896.7578s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 3147.8965s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0856s/iter; left time: 3005.4529s
Epoch: 15 cost time: 33.72398090362549
Epoch: 15, Steps: 413 | Train Loss: 0.187 Vali Loss: 0.832 Vali Acc: 0.962 Test Loss: 0.832 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2308s/iter; left time: 8078.4582s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1018s/iter; left time: 3555.1643s
	iters: 300, epoch: 16 | loss: 0.0000283
	speed: 0.0911s/iter; left time: 3169.9504s
	iters: 400, epoch: 16 | loss: 0.0000008
	speed: 0.0796s/iter; left time: 2762.5159s
Epoch: 16 cost time: 38.39917993545532
Epoch: 16, Steps: 413 | Train Loss: 0.213 Vali Loss: 0.594 Vali Acc: 0.971 Test Loss: 0.594 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000412
	speed: 0.1975s/iter; left time: 6832.7501s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0935s/iter; left time: 3226.1932s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0792s/iter; left time: 2724.2710s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0841s/iter; left time: 2883.6517s
Epoch: 17 cost time: 35.210214138031006
Epoch: 17, Steps: 413 | Train Loss: 0.253 Vali Loss: 1.057 Vali Acc: 0.960 Test Loss: 1.057 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1889s/iter; left time: 6457.5479s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0696s/iter; left time: 2372.4855s
	iters: 300, epoch: 18 | loss: 0.0000002
	speed: 0.0753s/iter; left time: 2558.7304s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0855s/iter; left time: 2896.8191s
Epoch: 18 cost time: 31.52298140525818
Epoch: 18, Steps: 413 | Train Loss: 0.250 Vali Loss: 1.381 Vali Acc: 0.958 Test Loss: 1.381 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9731696225557072
model parameter : 648842
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0459734
	speed: 0.1018s/iter; left time: 4193.0704s
	iters: 200, epoch: 1 | loss: 0.1038709
	speed: 0.0760s/iter; left time: 3123.5606s
	iters: 300, epoch: 1 | loss: 0.6989456
	speed: 0.0731s/iter; left time: 2999.0080s
	iters: 400, epoch: 1 | loss: 0.0227818
	speed: 0.0592s/iter; left time: 2422.7590s
Epoch: 1 cost time: 31.988744020462036
Epoch: 1, Steps: 413 | Train Loss: 0.379 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
Validation loss decreased (inf --> -0.945882).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000967
	speed: 0.1683s/iter; left time: 6864.6799s
	iters: 200, epoch: 2 | loss: 0.0007704
	speed: 0.0690s/iter; left time: 2806.6951s
	iters: 300, epoch: 2 | loss: 0.5628712
	speed: 0.0777s/iter; left time: 3152.0729s
	iters: 400, epoch: 2 | loss: 0.0013957
	speed: 0.0744s/iter; left time: 3011.5574s
Epoch: 2 cost time: 29.87885570526123
Epoch: 2, Steps: 413 | Train Loss: 0.162 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.945882 --> -0.975442).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0068643
	speed: 0.1916s/iter; left time: 7736.4761s
	iters: 200, epoch: 3 | loss: 0.3017696
	speed: 0.0728s/iter; left time: 2930.3408s
	iters: 300, epoch: 3 | loss: 0.1509680
	speed: 0.0745s/iter; left time: 2992.5328s
	iters: 400, epoch: 3 | loss: 0.0093356
	speed: 0.0718s/iter; left time: 2878.6799s
Epoch: 3 cost time: 30.304592847824097
Epoch: 3, Steps: 413 | Train Loss: 0.193 Vali Loss: 0.463 Vali Acc: 0.939 Test Loss: 0.463 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2804496
	speed: 0.1987s/iter; left time: 7938.5726s
	iters: 200, epoch: 4 | loss: 0.0002233
	speed: 0.0847s/iter; left time: 3375.0041s
	iters: 300, epoch: 4 | loss: 1.3044834
	speed: 0.0782s/iter; left time: 3110.9524s
	iters: 400, epoch: 4 | loss: 0.0022348
	speed: 0.0659s/iter; left time: 2615.6707s
Epoch: 4 cost time: 31.678584098815918
Epoch: 4, Steps: 413 | Train Loss: 0.174 Vali Loss: 0.363 Vali Acc: 0.944 Test Loss: 0.363 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0027799
	speed: 0.1706s/iter; left time: 6748.1537s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 2652.2588s
	iters: 300, epoch: 5 | loss: 0.0000016
	speed: 0.0641s/iter; left time: 2521.0213s
	iters: 400, epoch: 5 | loss: 0.0000005
	speed: 0.0611s/iter; left time: 2398.5608s
Epoch: 5 cost time: 26.623363256454468
Epoch: 5, Steps: 413 | Train Loss: 0.213 Vali Loss: 0.544 Vali Acc: 0.963 Test Loss: 0.544 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000010
	speed: 0.1939s/iter; left time: 7587.8360s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0784s/iter; left time: 3060.5793s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0763s/iter; left time: 2971.8710s
	iters: 400, epoch: 6 | loss: 0.0000004
	speed: 0.0764s/iter; left time: 2967.4080s
Epoch: 6 cost time: 33.17961835861206
Epoch: 6, Steps: 413 | Train Loss: 0.230 Vali Loss: 0.465 Vali Acc: 0.939 Test Loss: 0.465 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0786096
	speed: 0.2084s/iter; left time: 8068.6318s
	iters: 200, epoch: 7 | loss: 0.7787408
	speed: 0.0780s/iter; left time: 3011.4061s
	iters: 300, epoch: 7 | loss: 0.4855347
	speed: 0.0768s/iter; left time: 2958.0734s
	iters: 400, epoch: 7 | loss: 0.7508879
	speed: 0.0834s/iter; left time: 3205.0261s
Epoch: 7 cost time: 33.53392672538757
Epoch: 7, Steps: 413 | Train Loss: 0.200 Vali Loss: 0.360 Vali Acc: 0.971 Test Loss: 0.360 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1947s/iter; left time: 7458.9521s
	iters: 200, epoch: 8 | loss: 1.6318535
	speed: 0.0768s/iter; left time: 2933.7704s
	iters: 300, epoch: 8 | loss: 0.5994821
	speed: 0.0786s/iter; left time: 2996.0936s
	iters: 400, epoch: 8 | loss: 0.0313842
	speed: 0.0780s/iter; left time: 2964.2130s
Epoch: 8 cost time: 32.74421548843384
Epoch: 8, Steps: 413 | Train Loss: 0.195 Vali Loss: 0.687 Vali Acc: 0.956 Test Loss: 0.687 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1833s/iter; left time: 6945.6726s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0609s/iter; left time: 2301.8290s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0624s/iter; left time: 2353.2816s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 2608.5803s
Epoch: 9 cost time: 27.39891767501831
Epoch: 9, Steps: 413 | Train Loss: 0.266 Vali Loss: 0.567 Vali Acc: 0.962 Test Loss: 0.567 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000005
	speed: 0.1942s/iter; left time: 7278.4895s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0722s/iter; left time: 2699.0923s
	iters: 300, epoch: 10 | loss: 0.0000588
	speed: 0.0769s/iter; left time: 2868.0792s
	iters: 400, epoch: 10 | loss: 0.4972122
	speed: 0.0717s/iter; left time: 2664.3740s
Epoch: 10 cost time: 31.011868476867676
Epoch: 10, Steps: 413 | Train Loss: 0.217 Vali Loss: 0.736 Vali Acc: 0.965 Test Loss: 0.736 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.8979090
	speed: 0.1795s/iter; left time: 6655.1935s
	iters: 200, epoch: 11 | loss: 0.3237433
	speed: 0.0660s/iter; left time: 2438.2957s
	iters: 300, epoch: 11 | loss: 0.1155511
	speed: 0.0625s/iter; left time: 2303.8429s
	iters: 400, epoch: 11 | loss: 0.7238614
	speed: 0.0649s/iter; left time: 2386.4868s
Epoch: 11 cost time: 27.531840562820435
Epoch: 11, Steps: 413 | Train Loss: 0.235 Vali Loss: 0.667 Vali Acc: 0.952 Test Loss: 0.667 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000058
	speed: 0.2118s/iter; left time: 7763.9319s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0967s/iter; left time: 3533.5492s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0934s/iter; left time: 3405.7078s
	iters: 400, epoch: 12 | loss: 0.0000010
	speed: 0.0944s/iter; left time: 3432.6293s
Epoch: 12 cost time: 38.99798226356506
Epoch: 12, Steps: 413 | Train Loss: 0.277 Vali Loss: 0.421 Vali Acc: 0.965 Test Loss: 0.421 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 566026
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2522719
	speed: 0.1053s/iter; left time: 4337.9396s
	iters: 200, epoch: 1 | loss: 0.1630988
	speed: 0.0851s/iter; left time: 3495.7897s
	iters: 300, epoch: 1 | loss: 0.0815272
	speed: 0.0825s/iter; left time: 3380.6139s
	iters: 400, epoch: 1 | loss: 0.2118451
	speed: 0.0918s/iter; left time: 3755.7957s
Epoch: 1 cost time: 37.87859344482422
Epoch: 1, Steps: 413 | Train Loss: 0.360 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
Validation loss decreased (inf --> -0.935423).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2703335
	speed: 0.2043s/iter; left time: 8331.5043s
	iters: 200, epoch: 2 | loss: 0.6407593
	speed: 0.0946s/iter; left time: 3850.4181s
	iters: 300, epoch: 2 | loss: 0.0055521
	speed: 0.0935s/iter; left time: 3793.6454s
	iters: 400, epoch: 2 | loss: 0.0870830
	speed: 0.0856s/iter; left time: 3467.2367s
Epoch: 2 cost time: 37.97643971443176
Epoch: 2, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.935423 --> -0.967711).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000992
	speed: 0.1572s/iter; left time: 6346.1578s
	iters: 200, epoch: 3 | loss: 0.0019656
	speed: 0.0612s/iter; left time: 2464.2435s
	iters: 300, epoch: 3 | loss: 0.0691405
	speed: 0.0933s/iter; left time: 3749.2009s
	iters: 400, epoch: 3 | loss: 0.1467436
	speed: 0.0967s/iter; left time: 3876.9081s
Epoch: 3 cost time: 33.03859853744507
Epoch: 3, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.369 Vali Acc: 0.957 Test Loss: 0.369 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.4754093
	speed: 0.1979s/iter; left time: 7908.8969s
	iters: 200, epoch: 4 | loss: 0.0000705
	speed: 0.0780s/iter; left time: 3109.9272s
	iters: 300, epoch: 4 | loss: 0.0103973
	speed: 0.0791s/iter; left time: 3146.4045s
	iters: 400, epoch: 4 | loss: 0.2223495
	speed: 0.0871s/iter; left time: 3452.5962s
Epoch: 4 cost time: 34.67769742012024
Epoch: 4, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.539 Vali Acc: 0.935 Test Loss: 0.539 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000037
	speed: 0.1913s/iter; left time: 7564.1474s
	iters: 200, epoch: 5 | loss: 1.1819808
	speed: 0.0879s/iter; left time: 3465.6585s
	iters: 300, epoch: 5 | loss: 0.0973360
	speed: 0.0717s/iter; left time: 2820.9219s
	iters: 400, epoch: 5 | loss: 0.0006156
	speed: 0.0660s/iter; left time: 2591.5428s
Epoch: 5 cost time: 31.63260245323181
Epoch: 5, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.254 Vali Acc: 0.967 Test Loss: 0.254 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.1736s/iter; left time: 6795.8631s
	iters: 200, epoch: 6 | loss: 0.0028748
	speed: 0.0835s/iter; left time: 3258.3454s
	iters: 300, epoch: 6 | loss: 1.9879456
	speed: 0.0867s/iter; left time: 3374.5050s
	iters: 400, epoch: 6 | loss: 0.0000107
	speed: 0.0809s/iter; left time: 3142.6304s
Epoch: 6 cost time: 34.01799249649048
Epoch: 6, Steps: 413 | Train Loss: 0.167 Vali Loss: 0.481 Vali Acc: 0.951 Test Loss: 0.481 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000548
	speed: 0.1878s/iter; left time: 7272.9697s
	iters: 200, epoch: 7 | loss: 0.1753770
	speed: 0.0869s/iter; left time: 3355.1933s
	iters: 300, epoch: 7 | loss: 0.0015315
	speed: 0.0918s/iter; left time: 3535.9330s
	iters: 400, epoch: 7 | loss: 0.0038653
	speed: 0.0821s/iter; left time: 3155.7130s
Epoch: 7 cost time: 35.05595254898071
Epoch: 7, Steps: 413 | Train Loss: 0.197 Vali Loss: 0.294 Vali Acc: 0.974 Test Loss: 0.294 Test Acc: 0.974
Validation loss decreased (-0.967711 --> -0.973621).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2055s/iter; left time: 7871.6481s
	iters: 200, epoch: 8 | loss: 0.0000121
	speed: 0.0702s/iter; left time: 2683.8946s
	iters: 300, epoch: 8 | loss: 1.5290352
	speed: 0.0775s/iter; left time: 2954.6593s
	iters: 400, epoch: 8 | loss: 0.0006199
	speed: 0.0707s/iter; left time: 2686.6482s
Epoch: 8 cost time: 31.858593463897705
Epoch: 8, Steps: 413 | Train Loss: 0.177 Vali Loss: 0.587 Vali Acc: 0.953 Test Loss: 0.587 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0003127
	speed: 0.1933s/iter; left time: 7324.0616s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 2682.4747s
	iters: 300, epoch: 9 | loss: 0.8712718
	speed: 0.0727s/iter; left time: 2741.8248s
	iters: 400, epoch: 9 | loss: 0.0000408
	speed: 0.0793s/iter; left time: 2980.3470s
Epoch: 9 cost time: 32.507343769073486
Epoch: 9, Steps: 413 | Train Loss: 0.229 Vali Loss: 0.423 Vali Acc: 0.962 Test Loss: 0.423 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1867s/iter; left time: 6997.4158s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0748s/iter; left time: 2795.2589s
	iters: 300, epoch: 10 | loss: 0.0000058
	speed: 0.0689s/iter; left time: 2569.6295s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 2288.5805s
Epoch: 10 cost time: 29.72698187828064
Epoch: 10, Steps: 413 | Train Loss: 0.154 Vali Loss: 0.536 Vali Acc: 0.966 Test Loss: 0.536 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1631s/iter; left time: 6044.7334s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0731s/iter; left time: 2703.6962s
	iters: 300, epoch: 11 | loss: 0.4379130
	speed: 0.0718s/iter; left time: 2647.9725s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0608s/iter; left time: 2236.7643s
Epoch: 11 cost time: 28.408119440078735
Epoch: 11, Steps: 413 | Train Loss: 0.186 Vali Loss: 0.689 Vali Acc: 0.963 Test Loss: 0.689 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1705s/iter; left time: 6250.3970s
	iters: 200, epoch: 12 | loss: 0.7626840
	speed: 0.0823s/iter; left time: 3007.7740s
	iters: 300, epoch: 12 | loss: 0.1578920
	speed: 0.0758s/iter; left time: 2763.5680s
	iters: 400, epoch: 12 | loss: 0.9043927
	speed: 0.0767s/iter; left time: 2789.6652s
Epoch: 12 cost time: 31.96345591545105
Epoch: 12, Steps: 413 | Train Loss: 0.171 Vali Loss: 0.383 Vali Acc: 0.969 Test Loss: 0.383 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.3837755
	speed: 0.1745s/iter; left time: 6323.1589s
	iters: 200, epoch: 13 | loss: 0.0003958
	speed: 0.0611s/iter; left time: 2206.7594s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 2043.2402s
	iters: 400, epoch: 13 | loss: 0.1641170
	speed: 0.0568s/iter; left time: 2041.0218s
Epoch: 13 cost time: 24.841145038604736
Epoch: 13, Steps: 413 | Train Loss: 0.172 Vali Loss: 0.370 Vali Acc: 0.982 Test Loss: 0.370 Test Acc: 0.982
Validation loss decreased (-0.973621 --> -0.981806).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1185226
	speed: 0.1751s/iter; left time: 6275.6689s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0728s/iter; left time: 2601.0573s
	iters: 300, epoch: 14 | loss: 0.5983931
	speed: 0.0672s/iter; left time: 2395.7095s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 2057.7278s
Epoch: 14 cost time: 27.95294690132141
Epoch: 14, Steps: 413 | Train Loss: 0.204 Vali Loss: 0.622 Vali Acc: 0.960 Test Loss: 0.622 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1664s/iter; left time: 5892.0934s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0645s/iter; left time: 2278.8770s
	iters: 300, epoch: 15 | loss: 0.0010928
	speed: 0.0541s/iter; left time: 1905.7024s
	iters: 400, epoch: 15 | loss: 0.0000011
	speed: 0.0569s/iter; left time: 1998.6805s
Epoch: 15 cost time: 25.81197428703308
Epoch: 15, Steps: 413 | Train Loss: 0.240 Vali Loss: 0.416 Vali Acc: 0.975 Test Loss: 0.416 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.2425101
	speed: 0.1607s/iter; left time: 5625.2799s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 2130.3663s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 1834.5111s
	iters: 400, epoch: 16 | loss: 0.0000035
	speed: 0.0601s/iter; left time: 2084.2173s
Epoch: 16 cost time: 25.063796520233154
Epoch: 16, Steps: 413 | Train Loss: 0.179 Vali Loss: 0.636 Vali Acc: 0.965 Test Loss: 0.636 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000088
	speed: 0.1787s/iter; left time: 6181.6797s
	iters: 200, epoch: 17 | loss: 0.8906909
	speed: 0.0626s/iter; left time: 2158.4356s
	iters: 300, epoch: 17 | loss: 0.0019635
	speed: 0.0632s/iter; left time: 2172.0952s
	iters: 400, epoch: 17 | loss: 0.3819792
	speed: 0.0652s/iter; left time: 2236.1998s
Epoch: 17 cost time: 27.80640983581543
Epoch: 17, Steps: 413 | Train Loss: 0.185 Vali Loss: 0.517 Vali Acc: 0.960 Test Loss: 0.517 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.0123955
	speed: 0.1624s/iter; left time: 5550.3875s
	iters: 200, epoch: 18 | loss: 0.0000065
	speed: 0.0572s/iter; left time: 1950.4068s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 2120.5527s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 2026.0181s
Epoch: 18 cost time: 25.780036211013794
Epoch: 18, Steps: 413 | Train Loss: 0.215 Vali Loss: 0.585 Vali Acc: 0.970 Test Loss: 0.585 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000979
	speed: 0.1535s/iter; left time: 5181.9187s
	iters: 200, epoch: 19 | loss: 0.0007476
	speed: 0.0587s/iter; left time: 1975.5183s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0741s/iter; left time: 2486.6104s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0873s/iter; left time: 2920.2999s
Epoch: 19 cost time: 28.77411961555481
Epoch: 19, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.571 Vali Acc: 0.966 Test Loss: 0.571 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2137s/iter; left time: 7127.2582s
	iters: 200, epoch: 20 | loss: 0.0105233
	speed: 0.0765s/iter; left time: 2543.4438s
	iters: 300, epoch: 20 | loss: 1.6509514
	speed: 0.0860s/iter; left time: 2852.0879s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0877s/iter; left time: 2898.6799s
Epoch: 20 cost time: 36.36190390586853
Epoch: 20, Steps: 413 | Train Loss: 0.192 Vali Loss: 0.387 Vali Acc: 0.975 Test Loss: 0.387 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.1955s/iter; left time: 6439.1257s
	iters: 200, epoch: 21 | loss: 0.0003550
	speed: 0.0873s/iter; left time: 2866.9755s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0780s/iter; left time: 2553.6340s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0909s/iter; left time: 2967.3497s
Epoch: 21 cost time: 35.205867290496826
Epoch: 21, Steps: 413 | Train Loss: 0.167 Vali Loss: 0.588 Vali Acc: 0.973 Test Loss: 0.588 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1909s/iter; left time: 6210.7014s
	iters: 200, epoch: 22 | loss: 0.0001617
	speed: 0.0891s/iter; left time: 2888.1682s
	iters: 300, epoch: 22 | loss: 0.0001074
	speed: 0.0905s/iter; left time: 2926.7515s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0700s/iter; left time: 2257.3677s
Epoch: 22 cost time: 33.80344200134277
Epoch: 22, Steps: 413 | Train Loss: 0.185 Vali Loss: 0.683 Vali Acc: 0.965 Test Loss: 0.683 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1571s/iter; left time: 5045.1356s
	iters: 200, epoch: 23 | loss: 0.0002036
	speed: 0.0565s/iter; left time: 1809.2286s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0573s/iter; left time: 1827.2562s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0727s/iter; left time: 2314.3073s
Epoch: 23 cost time: 25.464505434036255
Epoch: 23, Steps: 413 | Train Loss: 0.149 Vali Loss: 0.721 Vali Acc: 0.958 Test Loss: 0.721 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 483338
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2636911
	speed: 0.0926s/iter; left time: 3814.3870s
	iters: 200, epoch: 1 | loss: 0.2953608
	speed: 0.0740s/iter; left time: 3040.2659s
	iters: 300, epoch: 1 | loss: 0.0166632
	speed: 0.0667s/iter; left time: 2736.2239s
	iters: 400, epoch: 1 | loss: 0.0028741
	speed: 0.0626s/iter; left time: 2559.0513s
Epoch: 1 cost time: 30.391589879989624
Epoch: 1, Steps: 413 | Train Loss: 0.357 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0027178
	speed: 0.1650s/iter; left time: 6731.3633s
	iters: 200, epoch: 2 | loss: 0.4830977
	speed: 0.0623s/iter; left time: 2533.1976s
	iters: 300, epoch: 2 | loss: 0.0397637
	speed: 0.0565s/iter; left time: 2294.7001s
	iters: 400, epoch: 2 | loss: 0.9646423
	speed: 0.0594s/iter; left time: 2404.9059s
Epoch: 2 cost time: 24.72591257095337
Epoch: 2, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
Validation loss decreased (-0.957252 --> -0.962254).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8949990
	speed: 0.1695s/iter; left time: 6842.9558s
	iters: 200, epoch: 3 | loss: 0.5687443
	speed: 0.0710s/iter; left time: 2858.9624s
	iters: 300, epoch: 3 | loss: 0.0887745
	speed: 0.0712s/iter; left time: 2862.4431s
	iters: 400, epoch: 3 | loss: 0.0191339
	speed: 0.0686s/iter; left time: 2748.8917s
Epoch: 3 cost time: 29.528112173080444
Epoch: 3, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.225 Vali Acc: 0.953 Test Loss: 0.225 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0011153
	speed: 0.1699s/iter; left time: 6788.6863s
	iters: 200, epoch: 4 | loss: 0.0001368
	speed: 0.0586s/iter; left time: 2334.1086s
	iters: 300, epoch: 4 | loss: 0.0000005
	speed: 0.0574s/iter; left time: 2282.1923s
	iters: 400, epoch: 4 | loss: 0.0503760
	speed: 0.0590s/iter; left time: 2339.9692s
Epoch: 4 cost time: 25.63855743408203
Epoch: 4, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.962254 --> -0.969530).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0023102
	speed: 0.1723s/iter; left time: 6813.6770s
	iters: 200, epoch: 5 | loss: 0.0063135
	speed: 0.0735s/iter; left time: 2898.9519s
	iters: 300, epoch: 5 | loss: 0.1057542
	speed: 0.0756s/iter; left time: 2973.0816s
	iters: 400, epoch: 5 | loss: 0.0001344
	speed: 0.0718s/iter; left time: 2817.1348s
Epoch: 5 cost time: 31.10883665084839
Epoch: 5, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.199 Vali Acc: 0.972 Test Loss: 0.199 Test Acc: 0.972
Validation loss decreased (-0.969530 --> -0.971803).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000266
	speed: 0.1783s/iter; left time: 6979.7154s
	iters: 200, epoch: 6 | loss: 0.0067658
	speed: 0.0700s/iter; left time: 2731.4562s
	iters: 300, epoch: 6 | loss: 0.0392414
	speed: 0.0654s/iter; left time: 2547.1628s
	iters: 400, epoch: 6 | loss: 0.0000010
	speed: 0.0618s/iter; left time: 2399.2995s
Epoch: 6 cost time: 27.951838731765747
Epoch: 6, Steps: 413 | Train Loss: 0.156 Vali Loss: 0.279 Vali Acc: 0.965 Test Loss: 0.279 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3499539
	speed: 0.1767s/iter; left time: 6842.1144s
	iters: 200, epoch: 7 | loss: 0.7889023
	speed: 0.0682s/iter; left time: 2633.1682s
	iters: 300, epoch: 7 | loss: 0.0000002
	speed: 0.0686s/iter; left time: 2643.9590s
	iters: 400, epoch: 7 | loss: 0.0000144
	speed: 0.0619s/iter; left time: 2377.0530s
Epoch: 7 cost time: 27.97135090827942
Epoch: 7, Steps: 413 | Train Loss: 0.186 Vali Loss: 0.370 Vali Acc: 0.964 Test Loss: 0.370 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0025422
	speed: 0.1591s/iter; left time: 6096.5957s
	iters: 200, epoch: 8 | loss: 0.7086033
	speed: 0.0548s/iter; left time: 2093.1792s
	iters: 300, epoch: 8 | loss: 0.0000063
	speed: 0.0576s/iter; left time: 2193.3032s
	iters: 400, epoch: 8 | loss: 0.8224736
	speed: 0.0596s/iter; left time: 2267.1429s
Epoch: 8 cost time: 24.32427430152893
Epoch: 8, Steps: 413 | Train Loss: 0.188 Vali Loss: 0.317 Vali Acc: 0.962 Test Loss: 0.317 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000003
	speed: 0.1731s/iter; left time: 6558.3029s
	iters: 200, epoch: 9 | loss: 0.0907186
	speed: 0.0628s/iter; left time: 2374.3889s
	iters: 300, epoch: 9 | loss: 0.0161379
	speed: 0.0629s/iter; left time: 2372.2674s
	iters: 400, epoch: 9 | loss: 1.0886699
	speed: 0.0655s/iter; left time: 2463.4712s
Epoch: 9 cost time: 27.30207347869873
Epoch: 9, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.212 Vali Acc: 0.976 Test Loss: 0.212 Test Acc: 0.976
Validation loss decreased (-0.971803 --> -0.976351).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.1819s/iter; left time: 6818.8601s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.0674s/iter; left time: 2520.2694s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0658s/iter; left time: 2453.7506s
	iters: 400, epoch: 10 | loss: 0.0000292
	speed: 0.0695s/iter; left time: 2584.7051s
Epoch: 10 cost time: 28.683867692947388
Epoch: 10, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.432 Vali Acc: 0.956 Test Loss: 0.432 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0004948
	speed: 0.1708s/iter; left time: 6332.2328s
	iters: 200, epoch: 11 | loss: 0.0117452
	speed: 0.0533s/iter; left time: 1971.0223s
	iters: 300, epoch: 11 | loss: 0.7362064
	speed: 0.0542s/iter; left time: 1996.9940s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 2019.7617s
Epoch: 11 cost time: 23.116474151611328
Epoch: 11, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.352 Vali Acc: 0.964 Test Loss: 0.352 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.2198935
	speed: 0.1770s/iter; left time: 6489.4824s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0614s/iter; left time: 2242.9877s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0669s/iter; left time: 2440.1971s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 2405.3557s
Epoch: 12 cost time: 27.57602620124817
Epoch: 12, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.501 Vali Acc: 0.960 Test Loss: 0.501 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000178
	speed: 0.1828s/iter; left time: 6626.9768s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0644s/iter; left time: 2328.8343s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0637s/iter; left time: 2294.3585s
	iters: 400, epoch: 13 | loss: 0.0148342
	speed: 0.0626s/iter; left time: 2251.3353s
Epoch: 13 cost time: 26.825434684753418
Epoch: 13, Steps: 413 | Train Loss: 0.165 Vali Loss: 0.492 Vali Acc: 0.963 Test Loss: 0.492 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0009624
	speed: 0.1751s/iter; left time: 6272.7405s
	iters: 200, epoch: 14 | loss: 0.0003674
	speed: 0.0596s/iter; left time: 2128.2664s
	iters: 300, epoch: 14 | loss: 0.0000017
	speed: 0.0605s/iter; left time: 2155.8292s
	iters: 400, epoch: 14 | loss: 0.0022149
	speed: 0.0576s/iter; left time: 2048.3817s
Epoch: 14 cost time: 25.53514266014099
Epoch: 14, Steps: 413 | Train Loss: 0.148 Vali Loss: 0.339 Vali Acc: 0.973 Test Loss: 0.339 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.1014977
	speed: 0.1662s/iter; left time: 5888.0425s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 2186.7422s
	iters: 300, epoch: 15 | loss: 0.0004389
	speed: 0.0599s/iter; left time: 2108.1958s
	iters: 400, epoch: 15 | loss: 0.0000004
	speed: 0.0603s/iter; left time: 2117.9857s
Epoch: 15 cost time: 25.668930530548096
Epoch: 15, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.427 Vali Acc: 0.964 Test Loss: 0.427 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0693126
	speed: 0.1704s/iter; left time: 5966.2146s
	iters: 200, epoch: 16 | loss: 0.0662101
	speed: 0.0638s/iter; left time: 2226.5464s
	iters: 300, epoch: 16 | loss: 0.0000006
	speed: 0.0586s/iter; left time: 2038.9338s
	iters: 400, epoch: 16 | loss: 0.0000048
	speed: 0.0576s/iter; left time: 1999.2847s
Epoch: 16 cost time: 25.49491000175476
Epoch: 16, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.545 Vali Acc: 0.946 Test Loss: 0.545 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1801s/iter; left time: 6230.0183s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0636s/iter; left time: 2194.5241s
	iters: 300, epoch: 17 | loss: 0.0170379
	speed: 0.0585s/iter; left time: 2012.6970s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0524s/iter; left time: 1797.3002s
Epoch: 17 cost time: 25.171931266784668
Epoch: 17, Steps: 413 | Train Loss: 0.157 Vali Loss: 0.535 Vali Acc: 0.960 Test Loss: 0.535 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1647s/iter; left time: 5627.9468s
	iters: 200, epoch: 18 | loss: 0.8141054
	speed: 0.0542s/iter; left time: 1847.6848s
	iters: 300, epoch: 18 | loss: 0.0085049
	speed: 0.0538s/iter; left time: 1828.3702s
	iters: 400, epoch: 18 | loss: 0.0000399
	speed: 0.0529s/iter; left time: 1790.8100s
Epoch: 18 cost time: 23.219183921813965
Epoch: 18, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.497 Vali Acc: 0.964 Test Loss: 0.497 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.1167260
	speed: 0.1824s/iter; left time: 6160.3636s
	iters: 200, epoch: 19 | loss: 1.1979315
	speed: 0.0606s/iter; left time: 2040.5044s
	iters: 300, epoch: 19 | loss: 0.0500587
	speed: 0.0626s/iter; left time: 2102.8419s
	iters: 400, epoch: 19 | loss: 0.0147944
	speed: 0.0479s/iter; left time: 1601.7231s
Epoch: 19 cost time: 24.563340663909912
Epoch: 19, Steps: 413 | Train Loss: 0.173 Vali Loss: 0.348 Vali Acc: 0.967 Test Loss: 0.348 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 417418
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3635614
	speed: 0.0859s/iter; left time: 3538.2700s
	iters: 200, epoch: 1 | loss: 0.2222032
	speed: 0.0567s/iter; left time: 2330.3047s
	iters: 300, epoch: 1 | loss: 0.0556173
	speed: 0.0533s/iter; left time: 2184.4975s
	iters: 400, epoch: 1 | loss: 0.0063595
	speed: 0.0519s/iter; left time: 2120.9614s
Epoch: 1 cost time: 25.57357096672058
Epoch: 1, Steps: 413 | Train Loss: 0.353 Vali Loss: 0.112 Vali Acc: 0.961 Test Loss: 0.112 Test Acc: 0.961
Validation loss decreased (inf --> -0.961345).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0099088
	speed: 0.1677s/iter; left time: 6839.3716s
	iters: 200, epoch: 2 | loss: 0.0040239
	speed: 0.0485s/iter; left time: 1971.3938s
	iters: 300, epoch: 2 | loss: 0.1481923
	speed: 0.0469s/iter; left time: 1905.5467s
	iters: 400, epoch: 2 | loss: 0.0030166
	speed: 0.0464s/iter; left time: 1877.7710s
Epoch: 2 cost time: 20.150537967681885
Epoch: 2, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.961345 --> -0.969985).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2464470
	speed: 0.1754s/iter; left time: 7081.2839s
	iters: 200, epoch: 3 | loss: 0.0042436
	speed: 0.0507s/iter; left time: 2040.7928s
	iters: 300, epoch: 3 | loss: 0.0637850
	speed: 0.0496s/iter; left time: 1994.2813s
	iters: 400, epoch: 3 | loss: 0.0363764
	speed: 0.0479s/iter; left time: 1917.7773s
Epoch: 3 cost time: 21.182512998580933
Epoch: 3, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0003401
	speed: 0.1719s/iter; left time: 6868.8645s
	iters: 200, epoch: 4 | loss: 0.0268032
	speed: 0.0520s/iter; left time: 2073.7321s
	iters: 300, epoch: 4 | loss: 0.0000003
	speed: 0.0514s/iter; left time: 2041.8342s
	iters: 400, epoch: 4 | loss: 0.0000335
	speed: 0.0482s/iter; left time: 1912.5554s
Epoch: 4 cost time: 21.063055992126465
Epoch: 4, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.195 Vali Acc: 0.968 Test Loss: 0.195 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0040616
	speed: 0.1890s/iter; left time: 7474.7824s
	iters: 200, epoch: 5 | loss: 0.8027338
	speed: 0.0531s/iter; left time: 2094.0376s
	iters: 300, epoch: 5 | loss: 0.0000340
	speed: 0.0473s/iter; left time: 1860.3417s
	iters: 400, epoch: 5 | loss: 0.0000001
	speed: 0.0430s/iter; left time: 1688.7627s
Epoch: 5 cost time: 20.329116582870483
Epoch: 5, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.283 Vali Acc: 0.969 Test Loss: 0.283 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6458400
	speed: 0.1990s/iter; left time: 7787.0592s
	iters: 200, epoch: 6 | loss: 1.2764357
	speed: 0.0654s/iter; left time: 2551.2544s
	iters: 300, epoch: 6 | loss: 0.0701380
	speed: 0.0625s/iter; left time: 2432.1089s
	iters: 400, epoch: 6 | loss: 0.0334350
	speed: 0.0530s/iter; left time: 2057.4471s
Epoch: 6 cost time: 24.95349907875061
Epoch: 6, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.253 Vali Acc: 0.959 Test Loss: 0.253 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1975016
	speed: 0.2077s/iter; left time: 8042.8330s
	iters: 200, epoch: 7 | loss: 0.1355613
	speed: 0.0496s/iter; left time: 1914.3307s
	iters: 300, epoch: 7 | loss: 0.0000003
	speed: 0.0578s/iter; left time: 2224.7445s
	iters: 400, epoch: 7 | loss: 0.0008675
	speed: 0.0541s/iter; left time: 2079.0430s
Epoch: 7 cost time: 23.63769292831421
Epoch: 7, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.226 Vali Acc: 0.971 Test Loss: 0.226 Test Acc: 0.971
Validation loss decreased (-0.969985 --> -0.970894).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0003291
	speed: 0.2022s/iter; left time: 7747.4052s
	iters: 200, epoch: 8 | loss: 0.0004543
	speed: 0.0537s/iter; left time: 2051.0449s
	iters: 300, epoch: 8 | loss: 0.0003757
	speed: 0.0635s/iter; left time: 2420.2383s
	iters: 400, epoch: 8 | loss: 0.7674389
	speed: 0.0601s/iter; left time: 2285.8014s
Epoch: 8 cost time: 25.428745985031128
Epoch: 8, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.224 Vali Acc: 0.972 Test Loss: 0.224 Test Acc: 0.972
Validation loss decreased (-0.970894 --> -0.972258).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0003998
	speed: 0.1814s/iter; left time: 6873.4004s
	iters: 200, epoch: 9 | loss: 0.0794126
	speed: 0.0524s/iter; left time: 1980.7649s
	iters: 300, epoch: 9 | loss: 0.0206537
	speed: 0.0510s/iter; left time: 1922.4020s
	iters: 400, epoch: 9 | loss: 0.0189393
	speed: 0.0463s/iter; left time: 1741.4332s
Epoch: 9 cost time: 21.081605434417725
Epoch: 9, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.272 Vali Acc: 0.970 Test Loss: 0.272 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000004
	speed: 0.1725s/iter; left time: 6464.6078s
	iters: 200, epoch: 10 | loss: 0.0000338
	speed: 0.0537s/iter; left time: 2006.0908s
	iters: 300, epoch: 10 | loss: 0.1308928
	speed: 0.0503s/iter; left time: 1876.2713s
	iters: 400, epoch: 10 | loss: 0.4888709
	speed: 0.0516s/iter; left time: 1917.2004s
Epoch: 10 cost time: 21.570528984069824
Epoch: 10, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.482 Vali Acc: 0.947 Test Loss: 0.482 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1693s/iter; left time: 6276.3497s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0477s/iter; left time: 1763.0193s
	iters: 300, epoch: 11 | loss: 0.0016663
	speed: 0.0521s/iter; left time: 1919.6181s
	iters: 400, epoch: 11 | loss: 0.0002388
	speed: 0.0576s/iter; left time: 2117.4114s
Epoch: 11 cost time: 21.904155015945435
Epoch: 11, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.349 Vali Acc: 0.954 Test Loss: 0.349 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0020003
	speed: 0.2085s/iter; left time: 7644.9840s
	iters: 200, epoch: 12 | loss: 0.3194530
	speed: 0.0630s/iter; left time: 2302.1721s
	iters: 300, epoch: 12 | loss: 0.0033569
	speed: 0.0658s/iter; left time: 2399.0497s
	iters: 400, epoch: 12 | loss: 0.0503473
	speed: 0.0664s/iter; left time: 2414.4306s
Epoch: 12 cost time: 27.47627854347229
Epoch: 12, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.400 Vali Acc: 0.965 Test Loss: 0.400 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.6335617
	speed: 0.2106s/iter; left time: 7631.5052s
	iters: 200, epoch: 13 | loss: 0.1749092
	speed: 0.0655s/iter; left time: 2368.3287s
	iters: 300, epoch: 13 | loss: 0.5297442
	speed: 0.0621s/iter; left time: 2239.0140s
	iters: 400, epoch: 13 | loss: 0.0000051
	speed: 0.0623s/iter; left time: 2239.7782s
Epoch: 13 cost time: 26.60576868057251
Epoch: 13, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.336 Vali Acc: 0.967 Test Loss: 0.336 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.1759993
	speed: 0.2216s/iter; left time: 7938.8393s
	iters: 200, epoch: 14 | loss: 0.7900910
	speed: 0.0647s/iter; left time: 2311.8757s
	iters: 300, epoch: 14 | loss: 0.0432119
	speed: 0.0637s/iter; left time: 2268.6535s
	iters: 400, epoch: 14 | loss: 0.0000003
	speed: 0.0652s/iter; left time: 2315.0335s
Epoch: 14 cost time: 27.63482427597046
Epoch: 14, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.433 Vali Acc: 0.963 Test Loss: 0.433 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000059
	speed: 0.2217s/iter; left time: 7854.1230s
	iters: 200, epoch: 15 | loss: 0.0123428
	speed: 0.0628s/iter; left time: 2217.2928s
	iters: 300, epoch: 15 | loss: 0.0001313
	speed: 0.0621s/iter; left time: 2188.5087s
	iters: 400, epoch: 15 | loss: 0.0475393
	speed: 0.0569s/iter; left time: 1996.8813s
Epoch: 15 cost time: 26.096507787704468
Epoch: 15, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.639 Vali Acc: 0.959 Test Loss: 0.639 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2026s/iter; left time: 7092.4897s
	iters: 200, epoch: 16 | loss: 0.2942811
	speed: 0.0558s/iter; left time: 1948.6155s
	iters: 300, epoch: 16 | loss: 0.1034256
	speed: 0.0615s/iter; left time: 2141.3340s
	iters: 400, epoch: 16 | loss: 0.0000034
	speed: 0.0611s/iter; left time: 2121.4941s
Epoch: 16 cost time: 24.922348737716675
Epoch: 16, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.389 Vali Acc: 0.965 Test Loss: 0.389 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2087s/iter; left time: 7220.1108s
	iters: 200, epoch: 17 | loss: 0.1669736
	speed: 0.0600s/iter; left time: 2069.7045s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0611s/iter; left time: 2102.3372s
	iters: 400, epoch: 17 | loss: 0.4412448
	speed: 0.0607s/iter; left time: 2083.1600s
Epoch: 17 cost time: 25.61114239692688
Epoch: 17, Steps: 413 | Train Loss: 0.134 Vali Loss: 0.407 Vali Acc: 0.966 Test Loss: 0.407 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0018234
	speed: 0.2066s/iter; left time: 7062.6627s
	iters: 200, epoch: 18 | loss: 0.0011531
	speed: 0.0637s/iter; left time: 2170.4922s
	iters: 300, epoch: 18 | loss: 0.0000008
	speed: 0.0595s/iter; left time: 2021.4655s
	iters: 400, epoch: 18 | loss: 0.0478754
	speed: 0.0602s/iter; left time: 2039.2904s
Epoch: 18 cost time: 25.693382263183594
Epoch: 18, Steps: 413 | Train Loss: 0.149 Vali Loss: 0.419 Vali Acc: 0.969 Test Loss: 0.419 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9722601182355616
model parameter : 384778
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1431202
	speed: 0.1210s/iter; left time: 4987.0435s
	iters: 200, epoch: 1 | loss: 0.0598899
	speed: 0.0863s/iter; left time: 3547.6822s
	iters: 300, epoch: 1 | loss: 0.5662640
	speed: 0.0907s/iter; left time: 3717.8215s
	iters: 400, epoch: 1 | loss: 0.2453882
	speed: 0.0891s/iter; left time: 3645.9763s
Epoch: 1 cost time: 40.033605337142944
Epoch: 1, Steps: 413 | Train Loss: 0.461 Vali Loss: 0.175 Vali Acc: 0.962 Test Loss: 0.175 Test Acc: 0.962
Validation loss decreased (inf --> -0.961799).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000269
	speed: 0.2574s/iter; left time: 10499.6957s
	iters: 200, epoch: 2 | loss: 0.0194522
	speed: 0.0877s/iter; left time: 3568.2228s
	iters: 300, epoch: 2 | loss: 0.0000271
	speed: 0.0761s/iter; left time: 3089.6395s
	iters: 400, epoch: 2 | loss: 1.0608294
	speed: 0.0747s/iter; left time: 3023.4119s
Epoch: 2 cost time: 34.137349128723145
Epoch: 2, Steps: 413 | Train Loss: 0.242 Vali Loss: 0.302 Vali Acc: 0.952 Test Loss: 0.302 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0013873
	speed: 0.2358s/iter; left time: 9521.4295s
	iters: 200, epoch: 3 | loss: 0.0066869
	speed: 0.0792s/iter; left time: 3188.9745s
	iters: 300, epoch: 3 | loss: 0.2348352
	speed: 0.0772s/iter; left time: 3099.8123s
	iters: 400, epoch: 3 | loss: 0.0015030
	speed: 0.0752s/iter; left time: 3012.4254s
Epoch: 3 cost time: 32.596508741378784
Epoch: 3, Steps: 413 | Train Loss: 0.277 Vali Loss: 0.722 Vali Acc: 0.957 Test Loss: 0.722 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1181015
	speed: 0.2486s/iter; left time: 9933.5815s
	iters: 200, epoch: 4 | loss: 0.0041928
	speed: 0.0828s/iter; left time: 3301.2124s
	iters: 300, epoch: 4 | loss: 0.0018648
	speed: 0.0819s/iter; left time: 3254.7356s
	iters: 400, epoch: 4 | loss: 0.0000001
	speed: 0.0794s/iter; left time: 3148.8511s
Epoch: 4 cost time: 34.39737820625305
Epoch: 4, Steps: 413 | Train Loss: 0.382 Vali Loss: 0.734 Vali Acc: 0.923 Test Loss: 0.734 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.5934002
	speed: 0.2441s/iter; left time: 9654.7651s
	iters: 200, epoch: 5 | loss: 1.8402330
	speed: 0.0859s/iter; left time: 3387.2112s
	iters: 300, epoch: 5 | loss: 1.8693433
	speed: 0.0818s/iter; left time: 3217.4758s
	iters: 400, epoch: 5 | loss: 0.0002761
	speed: 0.0776s/iter; left time: 3046.8878s
Epoch: 5 cost time: 34.34863829612732
Epoch: 5, Steps: 413 | Train Loss: 0.382 Vali Loss: 0.541 Vali Acc: 0.965 Test Loss: 0.541 Test Acc: 0.965
Validation loss decreased (-0.961799 --> -0.964524).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2095s/iter; left time: 8198.3051s
	iters: 200, epoch: 6 | loss: 1.1529717
	speed: 0.0700s/iter; left time: 2732.3967s
	iters: 300, epoch: 6 | loss: 0.0001084
	speed: 0.0688s/iter; left time: 2677.9122s
	iters: 400, epoch: 6 | loss: 0.5868682
	speed: 0.0672s/iter; left time: 2609.7956s
Epoch: 6 cost time: 29.138377904891968
Epoch: 6, Steps: 413 | Train Loss: 0.280 Vali Loss: 1.027 Vali Acc: 0.944 Test Loss: 1.027 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2225s/iter; left time: 8614.5497s
	iters: 200, epoch: 7 | loss: 0.0000169
	speed: 0.0734s/iter; left time: 2834.7313s
	iters: 300, epoch: 7 | loss: 1.3520932
	speed: 0.0682s/iter; left time: 2626.9907s
	iters: 400, epoch: 7 | loss: 0.1053766
	speed: 0.0652s/iter; left time: 2505.6998s
Epoch: 7 cost time: 29.403753519058228
Epoch: 7, Steps: 413 | Train Loss: 0.365 Vali Loss: 0.989 Vali Acc: 0.965 Test Loss: 0.989 Test Acc: 0.965
Validation loss decreased (-0.964524 --> -0.964974).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0099107
	speed: 0.2205s/iter; left time: 8446.7177s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0736s/iter; left time: 2814.0176s
	iters: 300, epoch: 8 | loss: 0.0000003
	speed: 0.0725s/iter; left time: 2761.4992s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 2697.1479s
Epoch: 8 cost time: 30.481183528900146
Epoch: 8, Steps: 413 | Train Loss: 0.325 Vali Loss: 0.658 Vali Acc: 0.962 Test Loss: 0.658 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4246895
	speed: 0.1978s/iter; left time: 7497.0805s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0655s/iter; left time: 2474.8380s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0648s/iter; left time: 2442.7352s
	iters: 400, epoch: 9 | loss: 2.9994156
	speed: 0.0658s/iter; left time: 2473.4007s
Epoch: 9 cost time: 27.253081798553467
Epoch: 9, Steps: 413 | Train Loss: 0.312 Vali Loss: 0.981 Vali Acc: 0.952 Test Loss: 0.981 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2066s/iter; left time: 7743.2999s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0685s/iter; left time: 2561.0021s
	iters: 300, epoch: 10 | loss: 0.0000003
	speed: 0.0667s/iter; left time: 2486.7343s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 2461.3766s
Epoch: 10 cost time: 28.20088529586792
Epoch: 10, Steps: 413 | Train Loss: 0.282 Vali Loss: 1.063 Vali Acc: 0.965 Test Loss: 1.063 Test Acc: 0.965
Validation loss decreased (-0.964974 --> -0.965428).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0006687
	speed: 0.2042s/iter; left time: 7570.2503s
	iters: 200, epoch: 11 | loss: 4.5374522
	speed: 0.0680s/iter; left time: 2513.2326s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 2394.4721s
	iters: 400, epoch: 11 | loss: 6.2025499
	speed: 0.0525s/iter; left time: 1929.9832s
Epoch: 11 cost time: 26.5337872505188
Epoch: 11, Steps: 413 | Train Loss: 0.340 Vali Loss: 1.797 Vali Acc: 0.941 Test Loss: 1.797 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000002
	speed: 0.2033s/iter; left time: 7452.6586s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0693s/iter; left time: 2532.4014s
	iters: 300, epoch: 12 | loss: 1.5002863
	speed: 0.0711s/iter; left time: 2593.2466s
	iters: 400, epoch: 12 | loss: 0.0000015
	speed: 0.0649s/iter; left time: 2358.3697s
Epoch: 12 cost time: 28.723350524902344
Epoch: 12, Steps: 413 | Train Loss: 0.311 Vali Loss: 1.588 Vali Acc: 0.950 Test Loss: 1.588 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.8944337
	speed: 0.2052s/iter; left time: 7437.8554s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 2407.0765s
	iters: 300, epoch: 13 | loss: 2.6124547
	speed: 0.0643s/iter; left time: 2319.1809s
	iters: 400, epoch: 13 | loss: 3.1411355
	speed: 0.0622s/iter; left time: 2234.9030s
Epoch: 13 cost time: 27.604721784591675
Epoch: 13, Steps: 413 | Train Loss: 0.249 Vali Loss: 2.063 Vali Acc: 0.938 Test Loss: 2.063 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2083s/iter; left time: 7462.9769s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0647s/iter; left time: 2310.5986s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0616s/iter; left time: 2195.6633s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0618s/iter; left time: 2196.7417s
Epoch: 14 cost time: 26.5163893699646
Epoch: 14, Steps: 413 | Train Loss: 0.276 Vali Loss: 1.219 Vali Acc: 0.958 Test Loss: 1.219 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0008872
	speed: 0.2149s/iter; left time: 7611.7901s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0603s/iter; left time: 2130.4285s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 2087.9623s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0670s/iter; left time: 2354.3598s
Epoch: 15 cost time: 26.331122636795044
Epoch: 15, Steps: 413 | Train Loss: 0.176 Vali Loss: 1.479 Vali Acc: 0.966 Test Loss: 1.479 Test Acc: 0.966
Validation loss decreased (-0.965428 --> -0.965879).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2081s/iter; left time: 7285.8149s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0657s/iter; left time: 2293.3787s
	iters: 300, epoch: 16 | loss: 0.0162701
	speed: 0.0646s/iter; left time: 2247.8066s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 2385.5094s
Epoch: 16 cost time: 27.859317541122437
Epoch: 16, Steps: 413 | Train Loss: 0.206 Vali Loss: 1.220 Vali Acc: 0.971 Test Loss: 1.220 Test Acc: 0.971
Validation loss decreased (-0.965879 --> -0.971338).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2190s/iter; left time: 7576.2811s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0706s/iter; left time: 2436.6690s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0807s/iter; left time: 2775.5131s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0809s/iter; left time: 2773.8875s
Epoch: 17 cost time: 32.222620487213135
Epoch: 17, Steps: 413 | Train Loss: 0.194 Vali Loss: 1.340 Vali Acc: 0.966 Test Loss: 1.340 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2693s/iter; left time: 9205.5783s
	iters: 200, epoch: 18 | loss: 0.0212545
	speed: 0.0897s/iter; left time: 3057.3403s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0897s/iter; left time: 3049.6739s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0953s/iter; left time: 3228.0645s
Epoch: 18 cost time: 38.848734855651855
Epoch: 18, Steps: 413 | Train Loss: 0.214 Vali Loss: 1.869 Vali Acc: 0.960 Test Loss: 1.869 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2893s/iter; left time: 9769.9640s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0866s/iter; left time: 2915.2547s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0897s/iter; left time: 3011.3940s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0987s/iter; left time: 3303.1360s
Epoch: 19 cost time: 39.5567786693573
Epoch: 19, Steps: 413 | Train Loss: 0.207 Vali Loss: 0.911 Vali Acc: 0.974 Test Loss: 0.911 Test Acc: 0.974
Validation loss decreased (-0.971338 --> -0.973615).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2733s/iter; left time: 9114.9143s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 2619.6905s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0814s/iter; left time: 2698.9287s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0809s/iter; left time: 2675.1159s
Epoch: 20 cost time: 35.23572492599487
Epoch: 20, Steps: 413 | Train Loss: 0.168 Vali Loss: 1.249 Vali Acc: 0.968 Test Loss: 1.249 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2272s/iter; left time: 7483.8295s
	iters: 200, epoch: 21 | loss: 0.9093027
	speed: 0.0794s/iter; left time: 2609.0820s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0805s/iter; left time: 2634.1243s
	iters: 400, epoch: 21 | loss: 0.0000398
	speed: 0.0865s/iter; left time: 2824.6437s
Epoch: 21 cost time: 33.899150371551514
Epoch: 21, Steps: 413 | Train Loss: 0.149 Vali Loss: 1.870 Vali Acc: 0.959 Test Loss: 1.870 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.7141163
	speed: 0.2614s/iter; left time: 8502.1576s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0908s/iter; left time: 2943.0645s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0910s/iter; left time: 2943.3355s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0921s/iter; left time: 2966.7040s
Epoch: 22 cost time: 38.976242780685425
Epoch: 22, Steps: 413 | Train Loss: 0.151 Vali Loss: 1.717 Vali Acc: 0.969 Test Loss: 1.717 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2545s/iter; left time: 8172.8230s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 2916.3539s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1010s/iter; left time: 3222.7782s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0924s/iter; left time: 2939.0452s
Epoch: 23 cost time: 39.309536933898926
Epoch: 23, Steps: 413 | Train Loss: 0.179 Vali Loss: 1.850 Vali Acc: 0.964 Test Loss: 1.850 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2556s/iter; left time: 8103.7821s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 2397.3083s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0851s/iter; left time: 2682.0489s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0807s/iter; left time: 2534.0582s
Epoch: 24 cost time: 33.905794620513916
Epoch: 24, Steps: 413 | Train Loss: 0.170 Vali Loss: 1.830 Vali Acc: 0.956 Test Loss: 1.830 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.9888477
	speed: 0.2531s/iter; left time: 7919.2619s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0897s/iter; left time: 2797.4086s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0862s/iter; left time: 2681.1690s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 2687.4321s
Epoch: 25 cost time: 36.89245939254761
Epoch: 25, Steps: 413 | Train Loss: 0.170 Vali Loss: 1.289 Vali Acc: 0.967 Test Loss: 1.289 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2472s/iter; left time: 7633.3044s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0833s/iter; left time: 2562.1854s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0807s/iter; left time: 2476.4657s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2379.3244s
Epoch: 26 cost time: 34.56889533996582
Epoch: 26, Steps: 413 | Train Loss: 0.225 Vali Loss: 2.180 Vali Acc: 0.953 Test Loss: 2.180 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2374s/iter; left time: 7232.4486s
	iters: 200, epoch: 27 | loss: 0.0000008
	speed: 0.0834s/iter; left time: 2533.7757s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0864s/iter; left time: 2615.5676s
	iters: 400, epoch: 27 | loss: 0.0000009
	speed: 0.0863s/iter; left time: 2604.1941s
Epoch: 27 cost time: 35.84950494766235
Epoch: 27, Steps: 413 | Train Loss: 0.193 Vali Loss: 2.132 Vali Acc: 0.951 Test Loss: 2.132 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0001027
	speed: 0.2443s/iter; left time: 7341.1730s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 2368.5068s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 2353.4137s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0815s/iter; left time: 2423.8724s
Epoch: 28 cost time: 33.48455309867859
Epoch: 28, Steps: 413 | Train Loss: 0.177 Vali Loss: 1.459 Vali Acc: 0.959 Test Loss: 1.459 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2887s/iter; left time: 8556.9425s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0986s/iter; left time: 2913.6819s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0900s/iter; left time: 2649.5165s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0933s/iter; left time: 2736.4462s
Epoch: 29 cost time: 40.30793261528015
Epoch: 29, Steps: 413 | Train Loss: 0.174 Vali Loss: 1.801 Vali Acc: 0.963 Test Loss: 1.801 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9736243747157799
model parameter : 981898
model size : 6.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2923962
	speed: 0.1281s/iter; left time: 5277.8894s
	iters: 200, epoch: 1 | loss: 0.3960176
	speed: 0.1096s/iter; left time: 4505.3960s
	iters: 300, epoch: 1 | loss: 0.1314551
	speed: 0.0840s/iter; left time: 3444.6107s
	iters: 400, epoch: 1 | loss: 0.0650707
	speed: 0.0759s/iter; left time: 3103.1416s
Epoch: 1 cost time: 40.69368052482605
Epoch: 1, Steps: 413 | Train Loss: 0.387 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (inf --> -0.944063).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000160
	speed: 0.2434s/iter; left time: 9928.7745s
	iters: 200, epoch: 2 | loss: 0.6130424
	speed: 0.1015s/iter; left time: 4130.9655s
	iters: 300, epoch: 2 | loss: 0.0009356
	speed: 0.0811s/iter; left time: 3290.4069s
	iters: 400, epoch: 2 | loss: 0.7720650
	speed: 0.0712s/iter; left time: 2884.2441s
Epoch: 2 cost time: 36.12384104728699
Epoch: 2, Steps: 413 | Train Loss: 0.215 Vali Loss: 0.228 Vali Acc: 0.965 Test Loss: 0.228 Test Acc: 0.965
Validation loss decreased (-0.944063 --> -0.965437).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3646357
	speed: 0.2459s/iter; left time: 9929.9276s
	iters: 200, epoch: 3 | loss: 0.0000340
	speed: 0.0949s/iter; left time: 3822.3537s
	iters: 300, epoch: 3 | loss: 0.0000104
	speed: 0.0659s/iter; left time: 2649.0597s
	iters: 400, epoch: 3 | loss: 0.0444732
	speed: 0.0710s/iter; left time: 2844.2036s
Epoch: 3 cost time: 34.25544452667236
Epoch: 3, Steps: 413 | Train Loss: 0.215 Vali Loss: 0.427 Vali Acc: 0.943 Test Loss: 0.427 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000097
	speed: 0.2642s/iter; left time: 10557.7819s
	iters: 200, epoch: 4 | loss: 0.1403174
	speed: 0.0889s/iter; left time: 3544.2048s
	iters: 300, epoch: 4 | loss: 0.1473365
	speed: 0.0771s/iter; left time: 3066.0603s
	iters: 400, epoch: 4 | loss: 0.0508417
	speed: 0.0788s/iter; left time: 3126.9031s
Epoch: 4 cost time: 36.666829109191895
Epoch: 4, Steps: 413 | Train Loss: 0.298 Vali Loss: 0.916 Vali Acc: 0.920 Test Loss: 0.916 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0007147
	speed: 0.2579s/iter; left time: 10198.6083s
	iters: 200, epoch: 5 | loss: 0.0000001
	speed: 0.0780s/iter; left time: 3075.3577s
	iters: 300, epoch: 5 | loss: 0.6556860
	speed: 0.0742s/iter; left time: 2918.8291s
	iters: 400, epoch: 5 | loss: 0.0804445
	speed: 0.0660s/iter; left time: 2588.8316s
Epoch: 5 cost time: 33.84392809867859
Epoch: 5, Steps: 413 | Train Loss: 0.301 Vali Loss: 0.685 Vali Acc: 0.947 Test Loss: 0.685 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.2677s/iter; left time: 10476.0350s
	iters: 200, epoch: 6 | loss: 0.0028856
	speed: 0.0769s/iter; left time: 3003.4996s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0743s/iter; left time: 2893.2129s
	iters: 400, epoch: 6 | loss: 0.0000037
	speed: 0.0725s/iter; left time: 2817.0025s
Epoch: 6 cost time: 34.09600305557251
Epoch: 6, Steps: 413 | Train Loss: 0.255 Vali Loss: 0.950 Vali Acc: 0.954 Test Loss: 0.950 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1944717
	speed: 0.2746s/iter; left time: 10632.8100s
	iters: 200, epoch: 7 | loss: 0.8611054
	speed: 0.0723s/iter; left time: 2792.8097s
	iters: 300, epoch: 7 | loss: 0.0000012
	speed: 0.0674s/iter; left time: 2594.7416s
	iters: 400, epoch: 7 | loss: 0.0994062
	speed: 0.0659s/iter; left time: 2532.2036s
Epoch: 7 cost time: 31.914475202560425
Epoch: 7, Steps: 413 | Train Loss: 0.315 Vali Loss: 1.096 Vali Acc: 0.939 Test Loss: 1.096 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0154387
	speed: 0.2630s/iter; left time: 10076.0808s
	iters: 200, epoch: 8 | loss: 0.3779401
	speed: 0.0691s/iter; left time: 2639.9815s
	iters: 300, epoch: 8 | loss: 0.0268545
	speed: 0.0733s/iter; left time: 2792.7163s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0717s/iter; left time: 2724.7930s
Epoch: 8 cost time: 31.976012706756592
Epoch: 8, Steps: 413 | Train Loss: 0.380 Vali Loss: 0.622 Vali Acc: 0.967 Test Loss: 0.622 Test Acc: 0.967
Validation loss decreased (-0.965437 --> -0.967252).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000224
	speed: 0.2641s/iter; left time: 10006.8536s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0657s/iter; left time: 2484.5396s
	iters: 300, epoch: 9 | loss: 0.0242196
	speed: 0.0720s/iter; left time: 2715.2163s
	iters: 400, epoch: 9 | loss: 1.2863722
	speed: 0.0710s/iter; left time: 2668.7973s
Epoch: 9 cost time: 31.225329399108887
Epoch: 9, Steps: 413 | Train Loss: 0.280 Vali Loss: 1.137 Vali Acc: 0.935 Test Loss: 1.137 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.5439599
	speed: 0.2595s/iter; left time: 9727.5075s
	iters: 200, epoch: 10 | loss: 0.0000486
	speed: 0.0676s/iter; left time: 2528.8690s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0730s/iter; left time: 2721.8437s
	iters: 400, epoch: 10 | loss: 1.1490291
	speed: 0.0758s/iter; left time: 2819.3479s
Epoch: 10 cost time: 32.705506563186646
Epoch: 10, Steps: 413 | Train Loss: 0.295 Vali Loss: 0.628 Vali Acc: 0.969 Test Loss: 0.628 Test Acc: 0.969
Validation loss decreased (-0.967252 --> -0.969071).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2709s/iter; left time: 10041.5357s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 2565.7245s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0732s/iter; left time: 2700.7087s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 2817.5270s
Epoch: 11 cost time: 32.86405062675476
Epoch: 11, Steps: 413 | Train Loss: 0.273 Vali Loss: 0.898 Vali Acc: 0.965 Test Loss: 0.898 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2328s/iter; left time: 8533.2689s
	iters: 200, epoch: 12 | loss: 3.0785260
	speed: 0.0742s/iter; left time: 2712.0414s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0828s/iter; left time: 3017.6080s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0832s/iter; left time: 3024.9523s
Epoch: 12 cost time: 32.840142250061035
Epoch: 12, Steps: 413 | Train Loss: 0.211 Vali Loss: 1.130 Vali Acc: 0.951 Test Loss: 1.130 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2724s/iter; left time: 9873.6454s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0837s/iter; left time: 3025.5852s
	iters: 300, epoch: 13 | loss: 4.7447796
	speed: 0.0822s/iter; left time: 2963.7246s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0820s/iter; left time: 2948.2461s
Epoch: 13 cost time: 36.24582576751709
Epoch: 13, Steps: 413 | Train Loss: 0.203 Vali Loss: 0.700 Vali Acc: 0.971 Test Loss: 0.700 Test Acc: 0.971
Validation loss decreased (-0.969071 --> -0.971344).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000257
	speed: 0.2896s/iter; left time: 10377.2185s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0957s/iter; left time: 3420.7353s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0931s/iter; left time: 3315.9764s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0973s/iter; left time: 3456.5086s
Epoch: 14 cost time: 40.86729311943054
Epoch: 14, Steps: 413 | Train Loss: 0.155 Vali Loss: 0.791 Vali Acc: 0.964 Test Loss: 0.791 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2935s/iter; left time: 10395.0114s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0976s/iter; left time: 3447.6294s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0918s/iter; left time: 3232.8278s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0990s/iter; left time: 3477.8920s
Epoch: 15 cost time: 41.48727059364319
Epoch: 15, Steps: 413 | Train Loss: 0.219 Vali Loss: 0.991 Vali Acc: 0.963 Test Loss: 0.991 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0023648
	speed: 0.2996s/iter; left time: 10486.4495s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0919s/iter; left time: 3206.2390s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0854s/iter; left time: 2973.6193s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0903s/iter; left time: 3134.1714s
Epoch: 16 cost time: 39.31546592712402
Epoch: 16, Steps: 413 | Train Loss: 0.140 Vali Loss: 0.853 Vali Acc: 0.963 Test Loss: 0.853 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2808s/iter; left time: 9714.9711s
	iters: 200, epoch: 17 | loss: 0.0029507
	speed: 0.0846s/iter; left time: 2917.1856s
	iters: 300, epoch: 17 | loss: 2.9659703
	speed: 0.0871s/iter; left time: 2996.3405s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0972s/iter; left time: 3333.0214s
Epoch: 17 cost time: 38.57321786880493
Epoch: 17, Steps: 413 | Train Loss: 0.319 Vali Loss: 1.028 Vali Acc: 0.965 Test Loss: 1.028 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 2.5404260
	speed: 0.2710s/iter; left time: 9264.1413s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0857s/iter; left time: 2920.5376s
	iters: 300, epoch: 18 | loss: 0.0000233
	speed: 0.0925s/iter; left time: 3143.0601s
	iters: 400, epoch: 18 | loss: 0.0074703
	speed: 0.1054s/iter; left time: 3571.3950s
Epoch: 18 cost time: 39.45294547080994
Epoch: 18, Steps: 413 | Train Loss: 0.178 Vali Loss: 0.992 Vali Acc: 0.959 Test Loss: 0.992 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2943s/iter; left time: 9938.4751s
	iters: 200, epoch: 19 | loss: 0.0011532
	speed: 0.0975s/iter; left time: 3281.7264s
	iters: 300, epoch: 19 | loss: 1.0621512
	speed: 0.1091s/iter; left time: 3661.6932s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1123s/iter; left time: 3759.0952s
Epoch: 19 cost time: 43.80632209777832
Epoch: 19, Steps: 413 | Train Loss: 0.222 Vali Loss: 1.282 Vali Acc: 0.957 Test Loss: 1.282 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2648s/iter; left time: 8833.4024s
	iters: 200, epoch: 20 | loss: 0.3192621
	speed: 0.0945s/iter; left time: 3143.5769s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.1128s/iter; left time: 3738.5982s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.1092s/iter; left time: 3610.6234s
Epoch: 20 cost time: 42.30434250831604
Epoch: 20, Steps: 413 | Train Loss: 0.230 Vali Loss: 0.671 Vali Acc: 0.978 Test Loss: 0.671 Test Acc: 0.978
Validation loss decreased (-0.971344 --> -0.977710).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2551s/iter; left time: 8401.7561s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0941s/iter; left time: 3090.3738s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1029s/iter; left time: 3368.2958s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0939s/iter; left time: 3065.5777s
Epoch: 21 cost time: 39.81422162055969
Epoch: 21, Steps: 413 | Train Loss: 0.196 Vali Loss: 1.273 Vali Acc: 0.963 Test Loss: 1.273 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2584s/iter; left time: 8404.4921s
	iters: 200, epoch: 22 | loss: 1.1845253
	speed: 0.0894s/iter; left time: 2898.1767s
	iters: 300, epoch: 22 | loss: 0.0000151
	speed: 0.1010s/iter; left time: 3265.8744s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1027s/iter; left time: 3309.5965s
Epoch: 22 cost time: 40.050934076309204
Epoch: 22, Steps: 413 | Train Loss: 0.225 Vali Loss: 1.319 Vali Acc: 0.955 Test Loss: 1.319 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2853s/iter; left time: 9163.2714s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.1028s/iter; left time: 3292.6850s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1149s/iter; left time: 3665.9817s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0923s/iter; left time: 2935.7166s
Epoch: 23 cost time: 42.37056827545166
Epoch: 23, Steps: 413 | Train Loss: 0.187 Vali Loss: 1.241 Vali Acc: 0.969 Test Loss: 1.241 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.5976253
	speed: 0.2593s/iter; left time: 8220.7507s
	iters: 200, epoch: 24 | loss: 0.1029486
	speed: 0.0964s/iter; left time: 3045.0884s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0990s/iter; left time: 3118.5618s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0793s/iter; left time: 2489.7737s
Epoch: 24 cost time: 36.72954320907593
Epoch: 24, Steps: 413 | Train Loss: 0.148 Vali Loss: 0.611 Vali Acc: 0.971 Test Loss: 0.611 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2517s/iter; left time: 7874.1875s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0880s/iter; left time: 2743.8051s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0843s/iter; left time: 2620.5509s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 2153.7648s
Epoch: 25 cost time: 33.203614473342896
Epoch: 25, Steps: 413 | Train Loss: 0.142 Vali Loss: 0.940 Vali Acc: 0.968 Test Loss: 0.940 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.9188647
	speed: 0.2497s/iter; left time: 7709.4045s
	iters: 200, epoch: 26 | loss: 0.0000002
	speed: 0.0753s/iter; left time: 2316.2288s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 2426.5481s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0734s/iter; left time: 2244.8942s
Epoch: 26 cost time: 31.678916692733765
Epoch: 26, Steps: 413 | Train Loss: 0.090 Vali Loss: 1.154 Vali Acc: 0.969 Test Loss: 1.154 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2305s/iter; left time: 7022.4960s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0752s/iter; left time: 2284.0215s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0898s/iter; left time: 2717.8238s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 2615.7391s
Epoch: 27 cost time: 33.803738594055176
Epoch: 27, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.815 Vali Acc: 0.973 Test Loss: 0.815 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2303s/iter; left time: 6920.7842s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0712s/iter; left time: 2131.4310s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0898s/iter; left time: 2681.8986s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0849s/iter; left time: 2524.5108s
Epoch: 28 cost time: 32.90068459510803
Epoch: 28, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.920 Vali Acc: 0.971 Test Loss: 0.920 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2304s/iter; left time: 6827.9006s
	iters: 200, epoch: 29 | loss: 0.0000027
	speed: 0.0614s/iter; left time: 1813.4771s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 2243.0921s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0611s/iter; left time: 1791.1097s
Epoch: 29 cost time: 27.582703351974487
Epoch: 29, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.846 Vali Acc: 0.970 Test Loss: 0.846 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.1760344
	speed: 0.2028s/iter; left time: 5925.6701s
	iters: 200, epoch: 30 | loss: 0.0000017
	speed: 0.0542s/iter; left time: 1577.5491s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 1582.0823s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0558s/iter; left time: 1612.7228s
Epoch: 30 cost time: 23.626234531402588
Epoch: 30, Steps: 413 | Train Loss: 0.140 Vali Loss: 1.392 Vali Acc: 0.962 Test Loss: 1.392 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 715914
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4454513
	speed: 0.0942s/iter; left time: 3882.9092s
	iters: 200, epoch: 1 | loss: 1.2815123
	speed: 0.0628s/iter; left time: 2581.3517s
	iters: 300, epoch: 1 | loss: 0.9426446
	speed: 0.0566s/iter; left time: 2319.9446s
	iters: 400, epoch: 1 | loss: 0.0006037
	speed: 0.0615s/iter; left time: 2513.8871s
Epoch: 1 cost time: 28.383739948272705
Epoch: 1, Steps: 413 | Train Loss: 0.398 Vali Loss: 0.332 Vali Acc: 0.945 Test Loss: 0.332 Test Acc: 0.945
Validation loss decreased (inf --> -0.944517).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0002298
	speed: 0.2078s/iter; left time: 8476.8595s
	iters: 200, epoch: 2 | loss: 0.2888957
	speed: 0.0646s/iter; left time: 2627.4170s
	iters: 300, epoch: 2 | loss: 0.2432524
	speed: 0.0562s/iter; left time: 2279.7424s
	iters: 400, epoch: 2 | loss: 0.0024185
	speed: 0.0593s/iter; left time: 2401.7250s
Epoch: 2 cost time: 26.15623664855957
Epoch: 2, Steps: 413 | Train Loss: 0.190 Vali Loss: 0.281 Vali Acc: 0.956 Test Loss: 0.281 Test Acc: 0.956
Validation loss decreased (-0.944517 --> -0.955886).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000043
	speed: 0.2372s/iter; left time: 9575.3378s
	iters: 200, epoch: 3 | loss: 0.0021047
	speed: 0.0746s/iter; left time: 3002.6928s
	iters: 300, epoch: 3 | loss: 0.0002099
	speed: 0.0809s/iter; left time: 3251.8573s
	iters: 400, epoch: 3 | loss: 0.0069923
	speed: 0.0758s/iter; left time: 3039.2462s
Epoch: 3 cost time: 32.996134996414185
Epoch: 3, Steps: 413 | Train Loss: 0.212 Vali Loss: 0.918 Vali Acc: 0.933 Test Loss: 0.918 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7887124
	speed: 0.2498s/iter; left time: 9983.6379s
	iters: 200, epoch: 4 | loss: 0.0000705
	speed: 0.0808s/iter; left time: 3221.6618s
	iters: 300, epoch: 4 | loss: 0.0270775
	speed: 0.0772s/iter; left time: 3070.5106s
	iters: 400, epoch: 4 | loss: 0.0007882
	speed: 0.0802s/iter; left time: 3180.4909s
Epoch: 4 cost time: 33.82699275016785
Epoch: 4, Steps: 413 | Train Loss: 0.233 Vali Loss: 0.337 Vali Acc: 0.956 Test Loss: 0.337 Test Acc: 0.956
Validation loss decreased (-0.955886 --> -0.956340).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000146
	speed: 0.2527s/iter; left time: 9992.5196s
	iters: 200, epoch: 5 | loss: 0.0000001
	speed: 0.0766s/iter; left time: 3021.8153s
	iters: 300, epoch: 5 | loss: 2.3515177
	speed: 0.0763s/iter; left time: 3000.5344s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0850s/iter; left time: 3337.5090s
Epoch: 5 cost time: 33.48904848098755
Epoch: 5, Steps: 413 | Train Loss: 0.201 Vali Loss: 0.486 Vali Acc: 0.961 Test Loss: 0.486 Test Acc: 0.961
Validation loss decreased (-0.956340 --> -0.960886).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000029
	speed: 0.2486s/iter; left time: 9728.8885s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 3054.4803s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 3181.7563s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0754s/iter; left time: 2929.9589s
Epoch: 6 cost time: 33.22403645515442
Epoch: 6, Steps: 413 | Train Loss: 0.235 Vali Loss: 0.544 Vali Acc: 0.955 Test Loss: 0.544 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2426s/iter; left time: 9392.4982s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0796s/iter; left time: 3076.1888s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 2945.7630s
	iters: 400, epoch: 7 | loss: 0.6898962
	speed: 0.0734s/iter; left time: 2819.6311s
Epoch: 7 cost time: 32.37551403045654
Epoch: 7, Steps: 413 | Train Loss: 0.234 Vali Loss: 0.626 Vali Acc: 0.958 Test Loss: 0.626 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.4504492
	speed: 0.2505s/iter; left time: 9597.3368s
	iters: 200, epoch: 8 | loss: 0.4723593
	speed: 0.0822s/iter; left time: 3140.6596s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 3029.3094s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0776s/iter; left time: 2949.2315s
Epoch: 8 cost time: 34.403666257858276
Epoch: 8, Steps: 413 | Train Loss: 0.147 Vali Loss: 0.794 Vali Acc: 0.953 Test Loss: 0.794 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000367
	speed: 0.2376s/iter; left time: 9003.3760s
	iters: 200, epoch: 9 | loss: 0.0000870
	speed: 0.0758s/iter; left time: 2866.6369s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0776s/iter; left time: 2923.6050s
	iters: 400, epoch: 9 | loss: 0.6620634
	speed: 0.0773s/iter; left time: 2904.7605s
Epoch: 9 cost time: 32.43877363204956
Epoch: 9, Steps: 413 | Train Loss: 0.264 Vali Loss: 0.552 Vali Acc: 0.967 Test Loss: 0.552 Test Acc: 0.967
Validation loss decreased (-0.960886 --> -0.967252).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9409279
	speed: 0.2594s/iter; left time: 9722.2154s
	iters: 200, epoch: 10 | loss: 0.3118557
	speed: 0.0797s/iter; left time: 2981.1793s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0803s/iter; left time: 2993.0603s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0903s/iter; left time: 3358.7693s
Epoch: 10 cost time: 35.221317768096924
Epoch: 10, Steps: 413 | Train Loss: 0.297 Vali Loss: 0.813 Vali Acc: 0.959 Test Loss: 0.813 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.2569s/iter; left time: 9522.0204s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0767s/iter; left time: 2836.7088s
	iters: 300, epoch: 11 | loss: 0.5727278
	speed: 0.0812s/iter; left time: 2993.2385s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 2899.9960s
Epoch: 11 cost time: 32.94391131401062
Epoch: 11, Steps: 413 | Train Loss: 0.270 Vali Loss: 0.873 Vali Acc: 0.949 Test Loss: 0.873 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2439s/iter; left time: 8939.7941s
	iters: 200, epoch: 12 | loss: 1.0100522
	speed: 0.0801s/iter; left time: 2929.1990s
	iters: 300, epoch: 12 | loss: 1.0470372
	speed: 0.0773s/iter; left time: 2819.4648s
	iters: 400, epoch: 12 | loss: 0.5797793
	speed: 0.0738s/iter; left time: 2684.6155s
Epoch: 12 cost time: 32.46435785293579
Epoch: 12, Steps: 413 | Train Loss: 0.230 Vali Loss: 0.507 Vali Acc: 0.970 Test Loss: 0.507 Test Acc: 0.970
Validation loss decreased (-0.967252 --> -0.969527).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2238865
	speed: 0.2393s/iter; left time: 8672.3139s
	iters: 200, epoch: 13 | loss: 1.3829542
	speed: 0.0757s/iter; left time: 2734.8217s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 2626.2348s
	iters: 400, epoch: 13 | loss: 0.0000579
	speed: 0.0703s/iter; left time: 2526.0399s
Epoch: 13 cost time: 31.54932928085327
Epoch: 13, Steps: 413 | Train Loss: 0.239 Vali Loss: 0.640 Vali Acc: 0.971 Test Loss: 0.640 Test Acc: 0.971
Validation loss decreased (-0.969527 --> -0.971344).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0088923
	speed: 0.2332s/iter; left time: 8354.8068s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 2185.2845s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0658s/iter; left time: 2344.8972s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0631s/iter; left time: 2242.5647s
Epoch: 14 cost time: 27.127148628234863
Epoch: 14, Steps: 413 | Train Loss: 0.166 Vali Loss: 0.596 Vali Acc: 0.970 Test Loss: 0.596 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2276s/iter; left time: 8061.7820s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 2013.0146s
	iters: 300, epoch: 15 | loss: 0.6981474
	speed: 0.0589s/iter; left time: 2073.7143s
	iters: 400, epoch: 15 | loss: 0.0026222
	speed: 0.0648s/iter; left time: 2277.2271s
Epoch: 15 cost time: 26.01375412940979
Epoch: 15, Steps: 413 | Train Loss: 0.166 Vali Loss: 0.509 Vali Acc: 0.972 Test Loss: 0.509 Test Acc: 0.972
Validation loss decreased (-0.971344 --> -0.972255).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0027151
	speed: 0.2205s/iter; left time: 7717.1766s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0578s/iter; left time: 2019.2877s
	iters: 300, epoch: 16 | loss: 2.2675333
	speed: 0.0642s/iter; left time: 2233.7316s
	iters: 400, epoch: 16 | loss: 0.0000046
	speed: 0.0696s/iter; left time: 2416.8309s
Epoch: 16 cost time: 26.99011540412903
Epoch: 16, Steps: 413 | Train Loss: 0.193 Vali Loss: 0.938 Vali Acc: 0.958 Test Loss: 0.938 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000012
	speed: 0.2279s/iter; left time: 7882.3198s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0622s/iter; left time: 2146.6080s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0689s/iter; left time: 2368.8507s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0667s/iter; left time: 2287.7503s
Epoch: 17 cost time: 27.655460119247437
Epoch: 17, Steps: 413 | Train Loss: 0.183 Vali Loss: 0.785 Vali Acc: 0.970 Test Loss: 0.785 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2297s/iter; left time: 7850.5067s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 2267.0169s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0680s/iter; left time: 2310.2779s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 2054.1061s
Epoch: 18 cost time: 27.313781023025513
Epoch: 18, Steps: 413 | Train Loss: 0.181 Vali Loss: 0.881 Vali Acc: 0.960 Test Loss: 0.881 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.4385009
	speed: 0.2429s/iter; left time: 8200.4176s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0801s/iter; left time: 2697.5073s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0808s/iter; left time: 2711.7632s
	iters: 400, epoch: 19 | loss: 2.8698292
	speed: 0.0768s/iter; left time: 2571.5755s
Epoch: 19 cost time: 33.858471393585205
Epoch: 19, Steps: 413 | Train Loss: 0.173 Vali Loss: 0.746 Vali Acc: 0.973 Test Loss: 0.746 Test Acc: 0.973
Validation loss decreased (-0.972255 --> -0.972707).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0639676
	speed: 0.2624s/iter; left time: 8751.6669s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0682s/iter; left time: 2266.8479s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0708s/iter; left time: 2347.1269s
	iters: 400, epoch: 20 | loss: 0.6370679
	speed: 0.0691s/iter; left time: 2284.8184s
Epoch: 20 cost time: 30.838037490844727
Epoch: 20, Steps: 413 | Train Loss: 0.173 Vali Loss: 0.936 Vali Acc: 0.964 Test Loss: 0.936 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2508s/iter; left time: 8262.5898s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.0745s/iter; left time: 2445.3836s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0699s/iter; left time: 2288.6062s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 2496.4319s
Epoch: 21 cost time: 31.93778419494629
Epoch: 21, Steps: 413 | Train Loss: 0.181 Vali Loss: 0.618 Vali Acc: 0.974 Test Loss: 0.618 Test Acc: 0.974
Validation loss decreased (-0.972707 --> -0.973618).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0002997
	speed: 0.2362s/iter; left time: 7683.5997s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 1869.6517s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 1934.4226s
	iters: 400, epoch: 22 | loss: 0.7890341
	speed: 0.0721s/iter; left time: 2323.0857s
Epoch: 22 cost time: 27.791123390197754
Epoch: 22, Steps: 413 | Train Loss: 0.204 Vali Loss: 0.722 Vali Acc: 0.963 Test Loss: 0.722 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.9840140
	speed: 0.2332s/iter; left time: 7488.2179s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 1969.6069s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 2216.1908s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0633s/iter; left time: 2013.4228s
Epoch: 23 cost time: 27.628123998641968
Epoch: 23, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.669 Vali Acc: 0.970 Test Loss: 0.669 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.3986574
	speed: 0.2368s/iter; left time: 7506.6882s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0721s/iter; left time: 2278.7876s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0553s/iter; left time: 1742.0314s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 2576.7561s
Epoch: 24 cost time: 29.093653440475464
Epoch: 24, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.662 Vali Acc: 0.970 Test Loss: 0.662 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2852s/iter; left time: 8922.5130s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0929s/iter; left time: 2896.8903s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0843s/iter; left time: 2621.4053s
	iters: 400, epoch: 25 | loss: 0.9087439
	speed: 0.0776s/iter; left time: 2403.9114s
Epoch: 25 cost time: 36.22977137565613
Epoch: 25, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.744 Vali Acc: 0.966 Test Loss: 0.744 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2710s/iter; left time: 8367.6957s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0898s/iter; left time: 2765.2181s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.0820s/iter; left time: 2516.6508s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0860s/iter; left time: 2628.1116s
Epoch: 26 cost time: 36.95215463638306
Epoch: 26, Steps: 413 | Train Loss: 0.139 Vali Loss: 1.134 Vali Acc: 0.957 Test Loss: 1.134 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000001
	speed: 0.2521s/iter; left time: 7678.8510s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 2364.9154s
	iters: 300, epoch: 27 | loss: 0.0000158
	speed: 0.0778s/iter; left time: 2353.0652s
	iters: 400, epoch: 27 | loss: 0.5381800
	speed: 0.0781s/iter; left time: 2355.4054s
Epoch: 27 cost time: 32.95152473449707
Epoch: 27, Steps: 413 | Train Loss: 0.272 Vali Loss: 1.075 Vali Acc: 0.953 Test Loss: 1.075 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000005
	speed: 0.2412s/iter; left time: 7248.2821s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0770s/iter; left time: 2305.7473s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0720s/iter; left time: 2150.6150s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0717s/iter; left time: 2134.0027s
Epoch: 28 cost time: 31.912107467651367
Epoch: 28, Steps: 413 | Train Loss: 0.185 Vali Loss: 0.895 Vali Acc: 0.967 Test Loss: 0.895 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2452s/iter; left time: 7265.8995s
	iters: 200, epoch: 29 | loss: 0.1223675
	speed: 0.0748s/iter; left time: 2210.5669s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 2243.3917s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0712s/iter; left time: 2088.4422s
Epoch: 29 cost time: 31.569039344787598
Epoch: 29, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.827 Vali Acc: 0.969 Test Loss: 0.827 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2360s/iter; left time: 6897.3587s
	iters: 200, epoch: 30 | loss: 2.1958740
	speed: 0.0858s/iter; left time: 2497.9638s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0864s/iter; left time: 2508.2058s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0826s/iter; left time: 2389.2594s
Epoch: 30 cost time: 34.246854066848755
Epoch: 30, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.699 Vali Acc: 0.974 Test Loss: 0.699 Test Acc: 0.974
Validation loss decreased (-0.973618 --> -0.974072).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0000259
	speed: 0.2657s/iter; left time: 7655.2817s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0834s/iter; left time: 2394.3324s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 2262.7272s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0819s/iter; left time: 2334.5856s
Epoch: 31 cost time: 35.24478840827942
Epoch: 31, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.931 Vali Acc: 0.970 Test Loss: 0.931 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2639s/iter; left time: 7494.2353s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 2157.3051s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 2161.2789s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 2233.8518s
Epoch: 32 cost time: 33.54751896858215
Epoch: 32, Steps: 413 | Train Loss: 0.106 Vali Loss: 1.339 Vali Acc: 0.957 Test Loss: 1.339 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2490s/iter; left time: 6967.9141s
	iters: 200, epoch: 33 | loss: 2.0986905
	speed: 0.0810s/iter; left time: 2259.2927s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0799s/iter; left time: 2219.2643s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0802s/iter; left time: 2219.7707s
Epoch: 33 cost time: 34.23606085777283
Epoch: 33, Steps: 413 | Train Loss: 0.126 Vali Loss: 1.655 Vali Acc: 0.951 Test Loss: 1.655 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2721s/iter; left time: 7502.5331s
	iters: 200, epoch: 34 | loss: 2.1525464
	speed: 0.0837s/iter; left time: 2300.3400s
	iters: 300, epoch: 34 | loss: 0.3312264
	speed: 0.0820s/iter; left time: 2244.0065s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 2239.6036s
Epoch: 34 cost time: 36.34086990356445
Epoch: 34, Steps: 413 | Train Loss: 0.145 Vali Loss: 0.817 Vali Acc: 0.963 Test Loss: 0.817 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2743s/iter; left time: 7449.2033s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0835s/iter; left time: 2259.9070s
	iters: 300, epoch: 35 | loss: 0.1581260
	speed: 0.0686s/iter; left time: 1850.6990s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0674s/iter; left time: 1811.6015s
Epoch: 35 cost time: 32.846184730529785
Epoch: 35, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.785 Vali Acc: 0.968 Test Loss: 0.785 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0041585
	speed: 0.2382s/iter; left time: 6372.1899s
	iters: 200, epoch: 36 | loss: 0.0003945
	speed: 0.0670s/iter; left time: 1786.3597s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0616s/iter; left time: 1636.2249s
	iters: 400, epoch: 36 | loss: 0.0000002
	speed: 0.0606s/iter; left time: 1602.9869s
Epoch: 36 cost time: 27.167150497436523
Epoch: 36, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.851 Vali Acc: 0.966 Test Loss: 0.851 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.2335s/iter; left time: 6149.8303s
	iters: 200, epoch: 37 | loss: 0.6004680
	speed: 0.0569s/iter; left time: 1493.6849s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0605s/iter; left time: 1582.0626s
	iters: 400, epoch: 37 | loss: 0.3132757
	speed: 0.0588s/iter; left time: 1530.3093s
Epoch: 37 cost time: 25.966166734695435
Epoch: 37, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.827 Vali Acc: 0.971 Test Loss: 0.827 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2263s/iter; left time: 5866.4403s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 1720.3835s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 1591.0661s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0677s/iter; left time: 1733.9933s
Epoch: 38 cost time: 27.233128547668457
Epoch: 38, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.835 Vali Acc: 0.970 Test Loss: 0.835 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.2587s/iter; left time: 6598.0704s
	iters: 200, epoch: 39 | loss: 0.7266299
	speed: 0.0636s/iter; left time: 1615.6136s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0643s/iter; left time: 1627.3995s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0611s/iter; left time: 1540.0761s
Epoch: 39 cost time: 26.976782083511353
Epoch: 39, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.747 Vali Acc: 0.970 Test Loss: 0.747 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.2407s/iter; left time: 6040.5719s
	iters: 200, epoch: 40 | loss: 0.7628244
	speed: 0.0458s/iter; left time: 1145.5861s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 1486.0437s
	iters: 400, epoch: 40 | loss: 2.0044093
	speed: 0.0569s/iter; left time: 1411.8746s
Epoch: 40 cost time: 24.461100101470947
Epoch: 40, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.747 Vali Acc: 0.968 Test Loss: 0.747 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9740791268758526
model parameter : 583050
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1857291
	speed: 0.0971s/iter; left time: 4001.3244s
	iters: 200, epoch: 1 | loss: 0.4574664
	speed: 0.0566s/iter; left time: 2326.7650s
	iters: 300, epoch: 1 | loss: 0.1784438
	speed: 0.0650s/iter; left time: 2666.2511s
	iters: 400, epoch: 1 | loss: 0.0047393
	speed: 0.0634s/iter; left time: 2591.9804s
Epoch: 1 cost time: 29.45190691947937
Epoch: 1, Steps: 413 | Train Loss: 0.366 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
Validation loss decreased (inf --> -0.955887).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0002945
	speed: 0.2130s/iter; left time: 8686.7809s
	iters: 200, epoch: 2 | loss: 0.0232752
	speed: 0.0635s/iter; left time: 2581.9007s
	iters: 300, epoch: 2 | loss: 0.3353460
	speed: 0.0643s/iter; left time: 2609.2657s
	iters: 400, epoch: 2 | loss: 2.5248091
	speed: 0.0581s/iter; left time: 2353.6183s
Epoch: 2 cost time: 25.618473291397095
Epoch: 2, Steps: 413 | Train Loss: 0.161 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.955887 --> -0.958161).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0197579
	speed: 0.2175s/iter; left time: 8780.2816s
	iters: 200, epoch: 3 | loss: 0.0000085
	speed: 0.0617s/iter; left time: 2485.8221s
	iters: 300, epoch: 3 | loss: 0.0140920
	speed: 0.0577s/iter; left time: 2319.4382s
	iters: 400, epoch: 3 | loss: 0.8752176
	speed: 0.0610s/iter; left time: 2444.5416s
Epoch: 3 cost time: 25.890090942382812
Epoch: 3, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
Validation loss decreased (-0.958161 --> -0.974078).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000013
	speed: 0.2227s/iter; left time: 8899.6530s
	iters: 200, epoch: 4 | loss: 0.0000496
	speed: 0.0600s/iter; left time: 2391.1867s
	iters: 300, epoch: 4 | loss: 0.0842992
	speed: 0.0681s/iter; left time: 2708.7352s
	iters: 400, epoch: 4 | loss: 0.0000017
	speed: 0.0707s/iter; left time: 2804.6265s
Epoch: 4 cost time: 27.76065754890442
Epoch: 4, Steps: 413 | Train Loss: 0.183 Vali Loss: 0.338 Vali Acc: 0.959 Test Loss: 0.338 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0003292
	speed: 0.2383s/iter; left time: 9424.9334s
	iters: 200, epoch: 5 | loss: 0.0000041
	speed: 0.0741s/iter; left time: 2922.2316s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0752s/iter; left time: 2959.3604s
	iters: 400, epoch: 5 | loss: 0.0000333
	speed: 0.0775s/iter; left time: 3040.4367s
Epoch: 5 cost time: 31.344005346298218
Epoch: 5, Steps: 413 | Train Loss: 0.228 Vali Loss: 0.879 Vali Acc: 0.934 Test Loss: 0.879 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0676122
	speed: 0.2435s/iter; left time: 9531.3547s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0809s/iter; left time: 3156.9394s
	iters: 300, epoch: 6 | loss: 0.0013340
	speed: 0.0819s/iter; left time: 3189.0661s
	iters: 400, epoch: 6 | loss: 0.2769653
	speed: 0.0841s/iter; left time: 3266.2387s
Epoch: 6 cost time: 34.10835361480713
Epoch: 6, Steps: 413 | Train Loss: 0.221 Vali Loss: 0.335 Vali Acc: 0.964 Test Loss: 0.335 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000014
	speed: 0.2439s/iter; left time: 9442.8933s
	iters: 200, epoch: 7 | loss: 0.0000315
	speed: 0.0769s/iter; left time: 2969.8754s
	iters: 300, epoch: 7 | loss: 1.4809420
	speed: 0.0732s/iter; left time: 2820.2789s
	iters: 400, epoch: 7 | loss: 0.0015087
	speed: 0.0695s/iter; left time: 2670.0452s
Epoch: 7 cost time: 31.846978902816772
Epoch: 7, Steps: 413 | Train Loss: 0.208 Vali Loss: 0.494 Vali Acc: 0.967 Test Loss: 0.494 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0189967
	speed: 0.2475s/iter; left time: 9480.7930s
	iters: 200, epoch: 8 | loss: 0.6130149
	speed: 0.0717s/iter; left time: 2738.9670s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0824s/iter; left time: 3139.8507s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0804s/iter; left time: 3056.4426s
Epoch: 8 cost time: 33.40906119346619
Epoch: 8, Steps: 413 | Train Loss: 0.248 Vali Loss: 0.589 Vali Acc: 0.971 Test Loss: 0.589 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.6282617
	speed: 0.2394s/iter; left time: 9072.4116s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 3015.1235s
	iters: 300, epoch: 9 | loss: 0.0026997
	speed: 0.0754s/iter; left time: 2842.5229s
	iters: 400, epoch: 9 | loss: 0.1010844
	speed: 0.0704s/iter; left time: 2645.7153s
Epoch: 9 cost time: 31.471568822860718
Epoch: 9, Steps: 413 | Train Loss: 0.176 Vali Loss: 0.383 Vali Acc: 0.970 Test Loss: 0.383 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2400s/iter; left time: 8995.4760s
	iters: 200, epoch: 10 | loss: 0.8767951
	speed: 0.0751s/iter; left time: 2809.3848s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 2948.3121s
	iters: 400, epoch: 10 | loss: 0.0005389
	speed: 0.0774s/iter; left time: 2878.6968s
Epoch: 10 cost time: 32.8900842666626
Epoch: 10, Steps: 413 | Train Loss: 0.188 Vali Loss: 0.445 Vali Acc: 0.973 Test Loss: 0.445 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0058715
	speed: 0.2282s/iter; left time: 8460.1762s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0757s/iter; left time: 2800.2619s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0831s/iter; left time: 3065.1938s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0854s/iter; left time: 3140.7350s
Epoch: 11 cost time: 34.02468204498291
Epoch: 11, Steps: 413 | Train Loss: 0.153 Vali Loss: 0.487 Vali Acc: 0.967 Test Loss: 0.487 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2785s/iter; left time: 10208.5079s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 2889.3553s
	iters: 300, epoch: 12 | loss: 0.0339585
	speed: 0.0834s/iter; left time: 3040.1002s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0893s/iter; left time: 3247.1494s
Epoch: 12 cost time: 36.3201208114624
Epoch: 12, Steps: 413 | Train Loss: 0.192 Vali Loss: 0.635 Vali Acc: 0.964 Test Loss: 0.635 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2740s/iter; left time: 9931.8992s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0939s/iter; left time: 3393.2988s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0851s/iter; left time: 3067.8609s
	iters: 400, epoch: 13 | loss: 0.0003010
	speed: 0.0739s/iter; left time: 2657.1484s
Epoch: 13 cost time: 36.909138679504395
Epoch: 13, Steps: 413 | Train Loss: 0.172 Vali Loss: 0.385 Vali Acc: 0.977 Test Loss: 0.385 Test Acc: 0.977
Validation loss decreased (-0.974078 --> -0.976804).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2479s/iter; left time: 8883.8170s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0700s/iter; left time: 2501.8478s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0677s/iter; left time: 2411.3316s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0718s/iter; left time: 2551.9066s
Epoch: 14 cost time: 30.119388580322266
Epoch: 14, Steps: 413 | Train Loss: 0.215 Vali Loss: 0.652 Vali Acc: 0.957 Test Loss: 0.652 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2247s/iter; left time: 7958.9980s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0620s/iter; left time: 2191.4297s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 2171.5872s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0623s/iter; left time: 2187.3522s
Epoch: 15 cost time: 26.763683557510376
Epoch: 15, Steps: 413 | Train Loss: 0.228 Vali Loss: 0.742 Vali Acc: 0.967 Test Loss: 0.742 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2251s/iter; left time: 7880.7833s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0620s/iter; left time: 2163.8618s
	iters: 300, epoch: 16 | loss: 0.2736825
	speed: 0.0619s/iter; left time: 2155.8317s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 1999.0203s
Epoch: 16 cost time: 26.147185802459717
Epoch: 16, Steps: 413 | Train Loss: 0.179 Vali Loss: 0.573 Vali Acc: 0.973 Test Loss: 0.573 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1224993
	speed: 0.2202s/iter; left time: 7617.7309s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0641s/iter; left time: 2209.6130s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 2250.7470s
	iters: 400, epoch: 17 | loss: 0.0000663
	speed: 0.0621s/iter; left time: 2130.2088s
Epoch: 17 cost time: 26.677154302597046
Epoch: 17, Steps: 413 | Train Loss: 0.198 Vali Loss: 0.505 Vali Acc: 0.970 Test Loss: 0.505 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000006
	speed: 0.1999s/iter; left time: 6831.8980s
	iters: 200, epoch: 18 | loss: 0.0000004
	speed: 0.0550s/iter; left time: 1873.5681s
	iters: 300, epoch: 18 | loss: 0.0000007
	speed: 0.0580s/iter; left time: 1971.6504s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0582s/iter; left time: 1970.4841s
Epoch: 18 cost time: 24.090789794921875
Epoch: 18, Steps: 413 | Train Loss: 0.188 Vali Loss: 0.852 Vali Acc: 0.965 Test Loss: 0.852 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1967s/iter; left time: 6643.3912s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0537s/iter; left time: 1807.2379s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 1840.8377s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 1906.3839s
Epoch: 19 cost time: 23.719849586486816
Epoch: 19, Steps: 413 | Train Loss: 0.165 Vali Loss: 0.627 Vali Acc: 0.972 Test Loss: 0.627 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2156s/iter; left time: 7189.8953s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 2182.8330s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 2053.7945s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 1723.2041s
Epoch: 20 cost time: 25.69191026687622
Epoch: 20, Steps: 413 | Train Loss: 0.226 Vali Loss: 0.494 Vali Acc: 0.977 Test Loss: 0.494 Test Acc: 0.977
Validation loss decreased (-0.976804 --> -0.977257).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2354s/iter; left time: 7755.2460s
	iters: 200, epoch: 21 | loss: 0.0000005
	speed: 0.0625s/iter; left time: 2053.0234s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0627s/iter; left time: 2051.6755s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 1780.8521s
Epoch: 21 cost time: 26.050044298171997
Epoch: 21, Steps: 413 | Train Loss: 0.161 Vali Loss: 0.746 Vali Acc: 0.969 Test Loss: 0.746 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0014180
	speed: 0.2315s/iter; left time: 7531.6446s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0600s/iter; left time: 1946.6564s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 1918.4154s
	iters: 400, epoch: 22 | loss: 0.0000044
	speed: 0.0621s/iter; left time: 2000.2609s
Epoch: 22 cost time: 25.816730499267578
Epoch: 22, Steps: 413 | Train Loss: 0.144 Vali Loss: 1.004 Vali Acc: 0.964 Test Loss: 1.004 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.7335558
	speed: 0.2267s/iter; left time: 7279.2131s
	iters: 200, epoch: 23 | loss: 0.0000223
	speed: 0.0668s/iter; left time: 2140.1855s
	iters: 300, epoch: 23 | loss: 0.0001927
	speed: 0.0630s/iter; left time: 2010.3744s
	iters: 400, epoch: 23 | loss: 0.0000031
	speed: 0.0546s/iter; left time: 1738.6061s
Epoch: 23 cost time: 26.517980813980103
Epoch: 23, Steps: 413 | Train Loss: 0.159 Vali Loss: 0.672 Vali Acc: 0.974 Test Loss: 0.672 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.1907844
	speed: 0.2354s/iter; left time: 7463.1544s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0630s/iter; left time: 1990.3795s
	iters: 300, epoch: 24 | loss: 0.0428999
	speed: 0.0541s/iter; left time: 1702.7849s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 1889.3838s
Epoch: 24 cost time: 25.65683913230896
Epoch: 24, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.559 Vali Acc: 0.976 Test Loss: 0.559 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2373s/iter; left time: 7424.1982s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0587s/iter; left time: 1829.5753s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0513s/iter; left time: 1593.9425s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0552s/iter; left time: 1712.0600s
Epoch: 25 cost time: 24.609755039215088
Epoch: 25, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.915 Vali Acc: 0.972 Test Loss: 0.915 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.3232133
	speed: 0.2296s/iter; left time: 7090.3361s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0677s/iter; left time: 2082.3524s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 2029.7935s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0742s/iter; left time: 2269.6019s
Epoch: 26 cost time: 29.675629138946533
Epoch: 26, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.742 Vali Acc: 0.972 Test Loss: 0.742 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2170s/iter; left time: 6609.1996s
	iters: 200, epoch: 27 | loss: 0.0592358
	speed: 0.0720s/iter; left time: 2186.4949s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0721s/iter; left time: 2182.8043s
	iters: 400, epoch: 27 | loss: 0.6897788
	speed: 0.0768s/iter; left time: 2317.2513s
Epoch: 27 cost time: 30.509754419326782
Epoch: 27, Steps: 413 | Train Loss: 0.172 Vali Loss: 0.733 Vali Acc: 0.973 Test Loss: 0.733 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2378s/iter; left time: 7147.0741s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0701s/iter; left time: 2098.6362s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 2269.4096s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0748s/iter; left time: 2224.2639s
Epoch: 28 cost time: 30.81952404975891
Epoch: 28, Steps: 413 | Train Loss: 0.205 Vali Loss: 0.834 Vali Acc: 0.966 Test Loss: 0.834 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2502s/iter; left time: 7413.7511s
	iters: 200, epoch: 29 | loss: 0.2422349
	speed: 0.0726s/iter; left time: 2144.7663s
	iters: 300, epoch: 29 | loss: 0.0000018
	speed: 0.0734s/iter; left time: 2161.6204s
	iters: 400, epoch: 29 | loss: 0.1931204
	speed: 0.0668s/iter; left time: 1959.4149s
Epoch: 29 cost time: 30.66215181350708
Epoch: 29, Steps: 413 | Train Loss: 0.149 Vali Loss: 1.021 Vali Acc: 0.962 Test Loss: 1.021 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.5463099
	speed: 0.2445s/iter; left time: 7146.2918s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0793s/iter; left time: 2308.3792s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0776s/iter; left time: 2251.1723s
	iters: 400, epoch: 30 | loss: 0.0012330
	speed: 0.0740s/iter; left time: 2141.5970s
Epoch: 30 cost time: 32.39468479156494
Epoch: 30, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.985 Vali Acc: 0.963 Test Loss: 0.985 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.977262391996362
model parameter : 500234
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1450761
	speed: 0.1039s/iter; left time: 4279.7710s
	iters: 200, epoch: 1 | loss: 0.1587716
	speed: 0.0753s/iter; left time: 3094.0981s
	iters: 300, epoch: 1 | loss: 0.3801717
	speed: 0.0745s/iter; left time: 3054.5209s
	iters: 400, epoch: 1 | loss: 0.0003031
	speed: 0.0677s/iter; left time: 2767.6196s
Epoch: 1 cost time: 33.214171409606934
Epoch: 1, Steps: 413 | Train Loss: 0.352 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
Validation loss decreased (inf --> -0.947701).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0001607
	speed: 0.2456s/iter; left time: 10019.5618s
	iters: 200, epoch: 2 | loss: 0.0721691
	speed: 0.0733s/iter; left time: 2983.1081s
	iters: 300, epoch: 2 | loss: 0.0000295
	speed: 0.0690s/iter; left time: 2798.7013s
	iters: 400, epoch: 2 | loss: 0.0689781
	speed: 0.0656s/iter; left time: 2657.8701s
Epoch: 2 cost time: 29.947890996932983
Epoch: 2, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.260 Vali Acc: 0.959 Test Loss: 0.260 Test Acc: 0.959
Validation loss decreased (-0.947701 --> -0.959070).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4279903
	speed: 0.2373s/iter; left time: 9580.5853s
	iters: 200, epoch: 3 | loss: 0.8873834
	speed: 0.0701s/iter; left time: 2821.3447s
	iters: 300, epoch: 3 | loss: 0.0001495
	speed: 0.0669s/iter; left time: 2686.9940s
	iters: 400, epoch: 3 | loss: 0.0000026
	speed: 0.0673s/iter; left time: 2695.5093s
Epoch: 3 cost time: 29.97531509399414
Epoch: 3, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.805 Vali Acc: 0.894 Test Loss: 0.805 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000008
	speed: 0.2078s/iter; left time: 8305.9551s
	iters: 200, epoch: 4 | loss: 0.0167523
	speed: 0.0699s/iter; left time: 2787.8100s
	iters: 300, epoch: 4 | loss: 0.0231061
	speed: 0.0668s/iter; left time: 2655.5840s
	iters: 400, epoch: 4 | loss: 0.0011260
	speed: 0.0718s/iter; left time: 2848.7318s
Epoch: 4 cost time: 29.19832754135132
Epoch: 4, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.297 Vali Acc: 0.970 Test Loss: 0.297 Test Acc: 0.970
Validation loss decreased (-0.959070 --> -0.969529).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000002
	speed: 0.2164s/iter; left time: 8556.7778s
	iters: 200, epoch: 5 | loss: 0.0000002
	speed: 0.0658s/iter; left time: 2595.7413s
	iters: 300, epoch: 5 | loss: 0.6083360
	speed: 0.0653s/iter; left time: 2571.3502s
	iters: 400, epoch: 5 | loss: 0.1629433
	speed: 0.0654s/iter; left time: 2568.5723s
Epoch: 5 cost time: 27.300947427749634
Epoch: 5, Steps: 413 | Train Loss: 0.178 Vali Loss: 0.197 Vali Acc: 0.970 Test Loss: 0.197 Test Acc: 0.970
Validation loss decreased (-0.969529 --> -0.970439).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0699485
	speed: 0.1863s/iter; left time: 7291.4602s
	iters: 200, epoch: 6 | loss: 0.0001013
	speed: 0.0514s/iter; left time: 2007.6494s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0554s/iter; left time: 2157.4835s
	iters: 400, epoch: 6 | loss: 0.0000013
	speed: 0.0589s/iter; left time: 2287.4514s
Epoch: 6 cost time: 22.842170476913452
Epoch: 6, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.556 Vali Acc: 0.950 Test Loss: 0.556 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2012s/iter; left time: 7790.8072s
	iters: 200, epoch: 7 | loss: 0.0572759
	speed: 0.0499s/iter; left time: 1926.0469s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 2055.5403s
	iters: 400, epoch: 7 | loss: 0.0151755
	speed: 0.0651s/iter; left time: 2502.3092s
Epoch: 7 cost time: 24.057030200958252
Epoch: 7, Steps: 413 | Train Loss: 0.165 Vali Loss: 0.302 Vali Acc: 0.972 Test Loss: 0.302 Test Acc: 0.972
Validation loss decreased (-0.970439 --> -0.971802).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0672510
	speed: 0.2043s/iter; left time: 7828.2297s
	iters: 200, epoch: 8 | loss: 1.2310473
	speed: 0.0531s/iter; left time: 2027.4882s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 1987.6913s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.0621s/iter; left time: 2361.6343s
Epoch: 8 cost time: 23.667747020721436
Epoch: 8, Steps: 413 | Train Loss: 0.176 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.971802 --> -0.974986).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1836s/iter; left time: 6956.1734s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0537s/iter; left time: 2029.8791s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0550s/iter; left time: 2074.2657s
	iters: 400, epoch: 9 | loss: 0.0041769
	speed: 0.0531s/iter; left time: 1997.2297s
Epoch: 9 cost time: 22.46590566635132
Epoch: 9, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.256 Vali Acc: 0.977 Test Loss: 0.256 Test Acc: 0.977
Validation loss decreased (-0.974986 --> -0.977260).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0333511
	speed: 0.1822s/iter; left time: 6828.5548s
	iters: 200, epoch: 10 | loss: 0.2484004
	speed: 0.0541s/iter; left time: 2022.0333s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 1931.0902s
	iters: 400, epoch: 10 | loss: 0.0001053
	speed: 0.0532s/iter; left time: 1976.6027s
Epoch: 10 cost time: 22.394824028015137
Epoch: 10, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.455 Vali Acc: 0.967 Test Loss: 0.455 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1869s/iter; left time: 6929.6411s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 1659.9495s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0543s/iter; left time: 2002.8416s
	iters: 400, epoch: 11 | loss: 0.0000016
	speed: 0.0603s/iter; left time: 2216.6290s
Epoch: 11 cost time: 21.951828956604004
Epoch: 11, Steps: 413 | Train Loss: 0.187 Vali Loss: 0.368 Vali Acc: 0.966 Test Loss: 0.368 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0001813
	speed: 0.1949s/iter; left time: 7143.5898s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 1865.1764s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 2117.8360s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 1987.5609s
Epoch: 12 cost time: 23.14264440536499
Epoch: 12, Steps: 413 | Train Loss: 0.134 Vali Loss: 0.550 Vali Acc: 0.965 Test Loss: 0.550 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1769s/iter; left time: 6412.2567s
	iters: 200, epoch: 13 | loss: 0.0000008
	speed: 0.0515s/iter; left time: 1860.6671s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 1919.4141s
	iters: 400, epoch: 13 | loss: 0.0790399
	speed: 0.0542s/iter; left time: 1947.6753s
Epoch: 13 cost time: 22.334325790405273
Epoch: 13, Steps: 413 | Train Loss: 0.147 Vali Loss: 1.070 Vali Acc: 0.943 Test Loss: 1.070 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1769s/iter; left time: 6337.2564s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 1943.2707s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0560s/iter; left time: 1994.3160s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0615s/iter; left time: 2185.7223s
Epoch: 14 cost time: 23.967034578323364
Epoch: 14, Steps: 413 | Train Loss: 0.149 Vali Loss: 0.346 Vali Acc: 0.968 Test Loss: 0.346 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000037
	speed: 0.2063s/iter; left time: 7306.8387s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0613s/iter; left time: 2166.0227s
	iters: 300, epoch: 15 | loss: 0.7788451
	speed: 0.0646s/iter; left time: 2274.0422s
	iters: 400, epoch: 15 | loss: 0.0000012
	speed: 0.0629s/iter; left time: 2208.1928s
Epoch: 15 cost time: 26.130345344543457
Epoch: 15, Steps: 413 | Train Loss: 0.166 Vali Loss: 0.258 Vali Acc: 0.982 Test Loss: 0.258 Test Acc: 0.982
Validation loss decreased (-0.977260 --> -0.981807).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2138s/iter; left time: 7485.2325s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0548s/iter; left time: 1912.2416s
	iters: 300, epoch: 16 | loss: 0.5212959
	speed: 0.0681s/iter; left time: 2371.5245s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0700s/iter; left time: 2428.8983s
Epoch: 16 cost time: 26.984049081802368
Epoch: 16, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.378 Vali Acc: 0.975 Test Loss: 0.378 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2027s/iter; left time: 7012.1653s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0781s/iter; left time: 2692.3883s
	iters: 300, epoch: 17 | loss: 0.0000003
	speed: 0.0729s/iter; left time: 2507.6387s
	iters: 400, epoch: 17 | loss: 0.0000003
	speed: 0.0709s/iter; left time: 2431.0278s
Epoch: 17 cost time: 31.45834708213806
Epoch: 17, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.497 Vali Acc: 0.971 Test Loss: 0.497 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2031s/iter; left time: 6941.6926s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0678s/iter; left time: 2310.2742s
	iters: 300, epoch: 18 | loss: 0.9218723
	speed: 0.0690s/iter; left time: 2344.3396s
	iters: 400, epoch: 18 | loss: 0.9665625
	speed: 0.0699s/iter; left time: 2369.6438s
Epoch: 18 cost time: 28.907614946365356
Epoch: 18, Steps: 413 | Train Loss: 0.202 Vali Loss: 0.615 Vali Acc: 0.967 Test Loss: 0.615 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2160s/iter; left time: 7293.9492s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 2490.4951s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 2383.6051s
	iters: 400, epoch: 19 | loss: 0.7754207
	speed: 0.0662s/iter; left time: 2214.2799s
Epoch: 19 cost time: 29.10642695426941
Epoch: 19, Steps: 413 | Train Loss: 0.167 Vali Loss: 0.540 Vali Acc: 0.969 Test Loss: 0.540 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2329s/iter; left time: 7767.2263s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0744s/iter; left time: 2474.6703s
	iters: 300, epoch: 20 | loss: 0.0000833
	speed: 0.0702s/iter; left time: 2327.7302s
	iters: 400, epoch: 20 | loss: 0.0000074
	speed: 0.0681s/iter; left time: 2252.2913s
Epoch: 20 cost time: 30.780893802642822
Epoch: 20, Steps: 413 | Train Loss: 0.179 Vali Loss: 0.796 Vali Acc: 0.964 Test Loss: 0.796 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1628s/iter; left time: 5363.2775s
	iters: 200, epoch: 21 | loss: 0.0000504
	speed: 0.0320s/iter; left time: 1050.2372s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 1097.7203s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.0315s/iter; left time: 1028.4462s
Epoch: 21 cost time: 13.673397302627563
Epoch: 21, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.482 Vali Acc: 0.972 Test Loss: 0.482 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.8154789
	speed: 0.1475s/iter; left time: 4799.1010s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0334s/iter; left time: 1081.4971s
	iters: 300, epoch: 22 | loss: 0.0021438
	speed: 0.0321s/iter; left time: 1038.4927s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 1066.9457s
Epoch: 22 cost time: 14.134790658950806
Epoch: 22, Steps: 413 | Train Loss: 0.114 Vali Loss: 1.490 Vali Acc: 0.944 Test Loss: 1.490 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1574s/iter; left time: 5054.2498s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0347s/iter; left time: 1109.7287s
	iters: 300, epoch: 23 | loss: 1.1772507
	speed: 0.0369s/iter; left time: 1178.4110s
	iters: 400, epoch: 23 | loss: 0.5391298
	speed: 0.0341s/iter; left time: 1085.7772s
Epoch: 23 cost time: 15.36703872680664
Epoch: 23, Steps: 413 | Train Loss: 0.230 Vali Loss: 0.674 Vali Acc: 0.965 Test Loss: 0.674 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000147
	speed: 0.1527s/iter; left time: 4841.7434s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0326s/iter; left time: 1029.7439s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 994.7973s
	iters: 400, epoch: 24 | loss: 0.0000198
	speed: 0.0346s/iter; left time: 1086.0489s
Epoch: 24 cost time: 14.425832033157349
Epoch: 24, Steps: 413 | Train Loss: 0.228 Vali Loss: 0.575 Vali Acc: 0.972 Test Loss: 0.575 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0013365
	speed: 0.1497s/iter; left time: 4682.9324s
	iters: 200, epoch: 25 | loss: 0.2759335
	speed: 0.0627s/iter; left time: 1955.1554s
	iters: 300, epoch: 25 | loss: 0.0000032
	speed: 0.0591s/iter; left time: 1836.9351s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0608s/iter; left time: 1883.4865s
Epoch: 25 cost time: 24.003575325012207
Epoch: 25, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.759 Vali Acc: 0.961 Test Loss: 0.759 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 417546
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3403208
	speed: 0.1053s/iter; left time: 4337.8869s
	iters: 200, epoch: 1 | loss: 0.0108162
	speed: 0.0706s/iter; left time: 2903.7406s
	iters: 300, epoch: 1 | loss: 0.0963464
	speed: 0.0636s/iter; left time: 2609.1748s
	iters: 400, epoch: 1 | loss: 0.6193531
	speed: 0.0641s/iter; left time: 2619.8450s
Epoch: 1 cost time: 31.416688680648804
Epoch: 1, Steps: 413 | Train Loss: 0.357 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
Validation loss decreased (inf --> -0.973169).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0047043
	speed: 0.2319s/iter; left time: 9457.3154s
	iters: 200, epoch: 2 | loss: 0.4028074
	speed: 0.0624s/iter; left time: 2540.7565s
	iters: 300, epoch: 2 | loss: 0.0006776
	speed: 0.0630s/iter; left time: 2556.7899s
	iters: 400, epoch: 2 | loss: 0.0015344
	speed: 0.0647s/iter; left time: 2617.6239s
Epoch: 2 cost time: 27.398938417434692
Epoch: 2, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0002165
	speed: 0.2241s/iter; left time: 9046.7901s
	iters: 200, epoch: 3 | loss: 0.0000066
	speed: 0.0627s/iter; left time: 2526.9170s
	iters: 300, epoch: 3 | loss: 0.0000123
	speed: 0.0656s/iter; left time: 2633.6833s
	iters: 400, epoch: 3 | loss: 0.0003434
	speed: 0.0708s/iter; left time: 2838.5904s
Epoch: 3 cost time: 28.171729564666748
Epoch: 3, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0392267
	speed: 0.2349s/iter; left time: 9387.0339s
	iters: 200, epoch: 4 | loss: 0.0000017
	speed: 0.0705s/iter; left time: 2810.4491s
	iters: 300, epoch: 4 | loss: 0.0806780
	speed: 0.0684s/iter; left time: 2720.6997s
	iters: 400, epoch: 4 | loss: 0.0008767
	speed: 0.0700s/iter; left time: 2776.0355s
Epoch: 4 cost time: 29.048338174819946
Epoch: 4, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.178 Vali Acc: 0.966 Test Loss: 0.178 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0019642
	speed: 0.2239s/iter; left time: 8855.7206s
	iters: 200, epoch: 5 | loss: 0.4821185
	speed: 0.0716s/iter; left time: 2824.3775s
	iters: 300, epoch: 5 | loss: 0.0045087
	speed: 0.0637s/iter; left time: 2506.0594s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 1874.5322s
Epoch: 5 cost time: 26.099031686782837
Epoch: 5, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.253 Vali Acc: 0.970 Test Loss: 0.253 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2096s/iter; left time: 8201.2271s
	iters: 200, epoch: 6 | loss: 0.0001483
	speed: 0.0504s/iter; left time: 1966.9475s
	iters: 300, epoch: 6 | loss: 0.0240995
	speed: 0.0494s/iter; left time: 1921.7101s
	iters: 400, epoch: 6 | loss: 0.0419931
	speed: 0.0458s/iter; left time: 1779.1579s
Epoch: 6 cost time: 21.231717586517334
Epoch: 6, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.314 Vali Acc: 0.968 Test Loss: 0.314 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.2734005
	speed: 0.1900s/iter; left time: 7357.5509s
	iters: 200, epoch: 7 | loss: 0.0000014
	speed: 0.0443s/iter; left time: 1710.9104s
	iters: 300, epoch: 7 | loss: 0.0004529
	speed: 0.0491s/iter; left time: 1893.3369s
	iters: 400, epoch: 7 | loss: 0.0557883
	speed: 0.0438s/iter; left time: 1682.1525s
Epoch: 7 cost time: 19.532588005065918
Epoch: 7, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.255 Vali Acc: 0.968 Test Loss: 0.255 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000138
	speed: 0.1935s/iter; left time: 7411.7739s
	iters: 200, epoch: 8 | loss: 0.3701808
	speed: 0.0491s/iter; left time: 1875.9433s
	iters: 300, epoch: 8 | loss: 0.2678852
	speed: 0.0482s/iter; left time: 1837.6567s
	iters: 400, epoch: 8 | loss: 0.0000785
	speed: 0.0419s/iter; left time: 1591.9173s
Epoch: 8 cost time: 19.880528211593628
Epoch: 8, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.230 Vali Acc: 0.973 Test Loss: 0.230 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2003s/iter; left time: 7589.0318s
	iters: 200, epoch: 9 | loss: 0.3251591
	speed: 0.0451s/iter; left time: 1704.6872s
	iters: 300, epoch: 9 | loss: 0.5775917
	speed: 0.0468s/iter; left time: 1765.7073s
	iters: 400, epoch: 9 | loss: 0.0235877
	speed: 0.0406s/iter; left time: 1525.0783s
Epoch: 9 cost time: 19.738529205322266
Epoch: 9, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.635 Vali Acc: 0.952 Test Loss: 0.635 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1963s/iter; left time: 7359.9336s
	iters: 200, epoch: 10 | loss: 0.0001927
	speed: 0.0518s/iter; left time: 1936.5376s
	iters: 300, epoch: 10 | loss: 0.1448659
	speed: 0.0494s/iter; left time: 1842.0267s
	iters: 400, epoch: 10 | loss: 0.8108025
	speed: 0.0470s/iter; left time: 1748.9487s
Epoch: 10 cost time: 21.381727933883667
Epoch: 10, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.632 Vali Acc: 0.952 Test Loss: 0.632 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2013s/iter; left time: 7461.1744s
	iters: 200, epoch: 11 | loss: 0.5334648
	speed: 0.0444s/iter; left time: 1640.7282s
	iters: 300, epoch: 11 | loss: 0.0903638
	speed: 0.0452s/iter; left time: 1666.2947s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 1751.6815s
Epoch: 11 cost time: 19.968005657196045
Epoch: 11, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.399 Vali Acc: 0.960 Test Loss: 0.399 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9731696225557072
model parameter : 351626
model size : 3.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0901948
	speed: 0.1013s/iter; left time: 4171.7436s
	iters: 200, epoch: 1 | loss: 0.0061611
	speed: 0.0621s/iter; left time: 2551.7617s
	iters: 300, epoch: 1 | loss: 0.2781944
	speed: 0.0617s/iter; left time: 2530.8411s
	iters: 400, epoch: 1 | loss: 0.0051832
	speed: 0.0655s/iter; left time: 2677.5835s
Epoch: 1 cost time: 30.034593105316162
Epoch: 1, Steps: 413 | Train Loss: 0.352 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
Validation loss decreased (inf --> -0.925418).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0385944
	speed: 0.2174s/iter; left time: 8867.9805s
	iters: 200, epoch: 2 | loss: 0.0013690
	speed: 0.0640s/iter; left time: 2602.0418s
	iters: 300, epoch: 2 | loss: 0.1862187
	speed: 0.0618s/iter; left time: 2508.5388s
	iters: 400, epoch: 2 | loss: 0.0000372
	speed: 0.0672s/iter; left time: 2720.2186s
Epoch: 2 cost time: 27.293139696121216
Epoch: 2, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.925418 --> -0.967711).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2861707
	speed: 0.2185s/iter; left time: 8822.9312s
	iters: 200, epoch: 3 | loss: 0.0065685
	speed: 0.0690s/iter; left time: 2777.4935s
	iters: 300, epoch: 3 | loss: 0.0019169
	speed: 0.0688s/iter; left time: 2765.3226s
	iters: 400, epoch: 3 | loss: 0.0052496
	speed: 0.0625s/iter; left time: 2503.5008s
Epoch: 3 cost time: 27.8540141582489
Epoch: 3, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000296
	speed: 0.2197s/iter; left time: 8779.3104s
	iters: 200, epoch: 4 | loss: 0.0066479
	speed: 0.0687s/iter; left time: 2737.5861s
	iters: 300, epoch: 4 | loss: 0.0000014
	speed: 0.0624s/iter; left time: 2479.2942s
	iters: 400, epoch: 4 | loss: 0.0000093
	speed: 0.0588s/iter; left time: 2332.6171s
Epoch: 4 cost time: 26.790043354034424
Epoch: 4, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.232 Vali Acc: 0.960 Test Loss: 0.232 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000244
	speed: 0.2195s/iter; left time: 8679.9532s
	iters: 200, epoch: 5 | loss: 0.0000280
	speed: 0.0629s/iter; left time: 2481.4772s
	iters: 300, epoch: 5 | loss: 0.4978446
	speed: 0.0649s/iter; left time: 2554.8795s
	iters: 400, epoch: 5 | loss: 0.0012122
	speed: 0.0652s/iter; left time: 2560.2607s
Epoch: 5 cost time: 27.498267889022827
Epoch: 5, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.190 Vali Acc: 0.970 Test Loss: 0.190 Test Acc: 0.970
Validation loss decreased (-0.967711 --> -0.969984).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0022911
	speed: 0.2400s/iter; left time: 9394.3735s
	iters: 200, epoch: 6 | loss: 0.5018803
	speed: 0.0620s/iter; left time: 2419.1186s
	iters: 300, epoch: 6 | loss: 0.3441111
	speed: 0.0558s/iter; left time: 2171.7854s
	iters: 400, epoch: 6 | loss: 0.0004107
	speed: 0.0558s/iter; left time: 2168.4558s
Epoch: 6 cost time: 25.71764588356018
Epoch: 6, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.246 Vali Acc: 0.974 Test Loss: 0.246 Test Acc: 0.974
Validation loss decreased (-0.969984 --> -0.973622).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0002185
	speed: 0.1910s/iter; left time: 7395.4767s
	iters: 200, epoch: 7 | loss: 0.0636045
	speed: 0.0510s/iter; left time: 1968.8924s
	iters: 300, epoch: 7 | loss: 0.2521859
	speed: 0.0482s/iter; left time: 1858.5321s
	iters: 400, epoch: 7 | loss: 0.0008763
	speed: 0.0435s/iter; left time: 1672.2722s
Epoch: 7 cost time: 20.9161958694458
Epoch: 7, Steps: 413 | Train Loss: 0.142 Vali Loss: 0.235 Vali Acc: 0.969 Test Loss: 0.235 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0018304
	speed: 0.1867s/iter; left time: 7152.1632s
	iters: 200, epoch: 8 | loss: 0.1835759
	speed: 0.0488s/iter; left time: 1863.8479s
	iters: 300, epoch: 8 | loss: 0.0000010
	speed: 0.0447s/iter; left time: 1704.2404s
	iters: 400, epoch: 8 | loss: 0.8001158
	speed: 0.0543s/iter; left time: 2064.5445s
Epoch: 8 cost time: 20.977474212646484
Epoch: 8, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.326 Vali Acc: 0.965 Test Loss: 0.326 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000002
	speed: 0.2043s/iter; left time: 7743.0933s
	iters: 200, epoch: 9 | loss: 0.0012726
	speed: 0.0465s/iter; left time: 1756.9880s
	iters: 300, epoch: 9 | loss: 0.0000213
	speed: 0.0466s/iter; left time: 1757.6695s
	iters: 400, epoch: 9 | loss: 0.0080473
	speed: 0.0493s/iter; left time: 1854.3215s
Epoch: 9 cost time: 21.18807601928711
Epoch: 9, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.216 Vali Acc: 0.975 Test Loss: 0.216 Test Acc: 0.975
Validation loss decreased (-0.973622 --> -0.974986).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000094
	speed: 0.2143s/iter; left time: 8033.0080s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1768.8713s
	iters: 300, epoch: 10 | loss: 0.0000048
	speed: 0.0447s/iter; left time: 1665.3956s
	iters: 400, epoch: 10 | loss: 0.3889025
	speed: 0.0488s/iter; left time: 1814.4727s
Epoch: 10 cost time: 20.24536919593811
Epoch: 10, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.296 Vali Acc: 0.971 Test Loss: 0.296 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0515795
	speed: 0.2230s/iter; left time: 8267.1209s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0455s/iter; left time: 1684.0213s
	iters: 300, epoch: 11 | loss: 0.0016972
	speed: 0.0439s/iter; left time: 1619.7944s
	iters: 400, epoch: 11 | loss: 0.0129009
	speed: 0.0474s/iter; left time: 1744.5136s
Epoch: 11 cost time: 20.55722689628601
Epoch: 11, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.247 Vali Acc: 0.972 Test Loss: 0.247 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000068
	speed: 0.2112s/iter; left time: 7743.1928s
	iters: 200, epoch: 12 | loss: 0.3956121
	speed: 0.0507s/iter; left time: 1853.4555s
	iters: 300, epoch: 12 | loss: 1.1995672
	speed: 0.0480s/iter; left time: 1751.5443s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 1669.3821s
Epoch: 12 cost time: 21.76916265487671
Epoch: 12, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.301 Vali Acc: 0.970 Test Loss: 0.301 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0030181
	speed: 0.2030s/iter; left time: 7358.4399s
	iters: 200, epoch: 13 | loss: 0.5804486
	speed: 0.0470s/iter; left time: 1697.4920s
	iters: 300, epoch: 13 | loss: 0.0000004
	speed: 0.0384s/iter; left time: 1385.4009s
	iters: 400, epoch: 13 | loss: 0.0000033
	speed: 0.0488s/iter; left time: 1753.3240s
Epoch: 13 cost time: 20.044905424118042
Epoch: 13, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.260 Vali Acc: 0.972 Test Loss: 0.260 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0005644
	speed: 0.2183s/iter; left time: 7821.9685s
	iters: 200, epoch: 14 | loss: 0.7960053
	speed: 0.0608s/iter; left time: 2171.0200s
	iters: 300, epoch: 14 | loss: 0.0001386
	speed: 0.0584s/iter; left time: 2079.4395s
	iters: 400, epoch: 14 | loss: 0.3584074
	speed: 0.0641s/iter; left time: 2278.5816s
Epoch: 14 cost time: 26.20486307144165
Epoch: 14, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.301 Vali Acc: 0.972 Test Loss: 0.301 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0507118
	speed: 0.2428s/iter; left time: 8601.0717s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0668s/iter; left time: 2361.0575s
	iters: 300, epoch: 15 | loss: 0.0000490
	speed: 0.0645s/iter; left time: 2270.7792s
	iters: 400, epoch: 15 | loss: 0.0200656
	speed: 0.0637s/iter; left time: 2235.4511s
Epoch: 15 cost time: 27.524739503860474
Epoch: 15, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.413 Vali Acc: 0.960 Test Loss: 0.413 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.4372795
	speed: 0.2127s/iter; left time: 7447.0254s
	iters: 200, epoch: 16 | loss: 0.0000015
	speed: 0.0604s/iter; left time: 2108.1047s
	iters: 300, epoch: 16 | loss: 0.0937113
	speed: 0.0631s/iter; left time: 2196.7716s
	iters: 400, epoch: 16 | loss: 0.0000212
	speed: 0.0628s/iter; left time: 2179.2516s
Epoch: 16 cost time: 26.060468912124634
Epoch: 16, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.380 Vali Acc: 0.964 Test Loss: 0.380 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000004
	speed: 0.2195s/iter; left time: 7594.2581s
	iters: 200, epoch: 17 | loss: 0.0000002
	speed: 0.0634s/iter; left time: 2188.4929s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 2147.4873s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 2166.7873s
Epoch: 17 cost time: 26.972509145736694
Epoch: 17, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.445 Vali Acc: 0.964 Test Loss: 0.445 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2241s/iter; left time: 7658.1084s
	iters: 200, epoch: 18 | loss: 0.0000006
	speed: 0.0597s/iter; left time: 2034.3912s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0647s/iter; left time: 2198.1768s
	iters: 400, epoch: 18 | loss: 0.0000189
	speed: 0.0589s/iter; left time: 1994.3758s
Epoch: 18 cost time: 26.241857767105103
Epoch: 18, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.326 Vali Acc: 0.970 Test Loss: 0.326 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2231s/iter; left time: 7534.4724s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 2024.3810s
	iters: 300, epoch: 19 | loss: 0.0000005
	speed: 0.0609s/iter; left time: 2044.8082s
	iters: 400, epoch: 19 | loss: 0.0007024
	speed: 0.0606s/iter; left time: 2028.3258s
Epoch: 19 cost time: 25.301802158355713
Epoch: 19, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.535 Vali Acc: 0.951 Test Loss: 0.535 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9749886311959982
model parameter : 318986
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6390133
	speed: 0.0886s/iter; left time: 3648.7032s
	iters: 200, epoch: 1 | loss: 0.4128595
	speed: 0.0577s/iter; left time: 2373.5437s
	iters: 300, epoch: 1 | loss: 0.5998251
	speed: 0.0558s/iter; left time: 2289.1951s
	iters: 400, epoch: 1 | loss: 0.2878750
	speed: 0.0575s/iter; left time: 2352.3421s
Epoch: 1 cost time: 26.950119256973267
Epoch: 1, Steps: 413 | Train Loss: 0.456 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
Validation loss decreased (inf --> -0.963618).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0007371
	speed: 0.2037s/iter; left time: 8308.7882s
	iters: 200, epoch: 2 | loss: 0.9486187
	speed: 0.0559s/iter; left time: 2274.6054s
	iters: 300, epoch: 2 | loss: 0.1568586
	speed: 0.0589s/iter; left time: 2389.6794s
	iters: 400, epoch: 2 | loss: 0.0098221
	speed: 0.0539s/iter; left time: 2183.4733s
Epoch: 2 cost time: 23.578564167022705
Epoch: 2, Steps: 413 | Train Loss: 0.247 Vali Loss: 0.233 Vali Acc: 0.966 Test Loss: 0.233 Test Acc: 0.966
Validation loss decreased (-0.963618 --> -0.966346).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000964
	speed: 0.2203s/iter; left time: 8894.8258s
	iters: 200, epoch: 3 | loss: 0.5853347
	speed: 0.0515s/iter; left time: 2072.7461s
	iters: 300, epoch: 3 | loss: 0.0000558
	speed: 0.0589s/iter; left time: 2367.8271s
	iters: 400, epoch: 3 | loss: 0.3600106
	speed: 0.0596s/iter; left time: 2387.3653s
Epoch: 3 cost time: 23.766562461853027
Epoch: 3, Steps: 413 | Train Loss: 0.260 Vali Loss: 0.252 Vali Acc: 0.974 Test Loss: 0.252 Test Acc: 0.974
Validation loss decreased (-0.966346 --> -0.973622).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.2264s/iter; left time: 9047.8484s
	iters: 200, epoch: 4 | loss: 0.5800048
	speed: 0.0578s/iter; left time: 2303.3222s
	iters: 300, epoch: 4 | loss: 0.0041002
	speed: 0.0536s/iter; left time: 2132.5254s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0529s/iter; left time: 2098.4370s
Epoch: 4 cost time: 23.68866515159607
Epoch: 4, Steps: 413 | Train Loss: 0.290 Vali Loss: 0.462 Vali Acc: 0.970 Test Loss: 0.462 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000005
	speed: 0.2137s/iter; left time: 8453.4996s
	iters: 200, epoch: 5 | loss: 0.0050397
	speed: 0.0622s/iter; left time: 2452.7206s
	iters: 300, epoch: 5 | loss: 0.0000014
	speed: 0.0624s/iter; left time: 2454.5490s
	iters: 400, epoch: 5 | loss: 0.9596833
	speed: 0.0541s/iter; left time: 2124.9776s
Epoch: 5 cost time: 24.80549120903015
Epoch: 5, Steps: 413 | Train Loss: 0.363 Vali Loss: 0.679 Vali Acc: 0.953 Test Loss: 0.679 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0011728
	speed: 0.2246s/iter; left time: 8788.3688s
	iters: 200, epoch: 6 | loss: 0.0000001
	speed: 0.0585s/iter; left time: 2282.1060s
	iters: 300, epoch: 6 | loss: 0.5188068
	speed: 0.0566s/iter; left time: 2204.9084s
	iters: 400, epoch: 6 | loss: 0.0230686
	speed: 0.0557s/iter; left time: 2163.6494s
Epoch: 6 cost time: 24.184375524520874
Epoch: 6, Steps: 413 | Train Loss: 0.300 Vali Loss: 0.703 Vali Acc: 0.965 Test Loss: 0.703 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2567s/iter; left time: 9940.4647s
	iters: 200, epoch: 7 | loss: 0.0013039
	speed: 0.0743s/iter; left time: 2870.7106s
	iters: 300, epoch: 7 | loss: 4.0534868
	speed: 0.0818s/iter; left time: 3150.3503s
	iters: 400, epoch: 7 | loss: 0.0009983
	speed: 0.0878s/iter; left time: 3372.5955s
Epoch: 7 cost time: 34.24157500267029
Epoch: 7, Steps: 413 | Train Loss: 0.365 Vali Loss: 0.757 Vali Acc: 0.964 Test Loss: 0.757 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.3270s/iter; left time: 12527.0403s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1055s/iter; left time: 4031.1960s
	iters: 300, epoch: 8 | loss: 1.9463015
	speed: 0.1137s/iter; left time: 4334.6147s
	iters: 400, epoch: 8 | loss: 0.0001132
	speed: 0.1064s/iter; left time: 4042.7291s
Epoch: 8 cost time: 44.67240333557129
Epoch: 8, Steps: 413 | Train Loss: 0.314 Vali Loss: 0.611 Vali Acc: 0.965 Test Loss: 0.611 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3080s/iter; left time: 11672.5099s
	iters: 200, epoch: 9 | loss: 0.0098547
	speed: 0.0960s/iter; left time: 3627.0717s
	iters: 300, epoch: 9 | loss: 1.2053633
	speed: 0.1014s/iter; left time: 3820.6596s
	iters: 400, epoch: 9 | loss: 0.0000026
	speed: 0.0907s/iter; left time: 3410.1178s
Epoch: 9 cost time: 39.62398433685303
Epoch: 9, Steps: 413 | Train Loss: 0.291 Vali Loss: 1.318 Vali Acc: 0.957 Test Loss: 1.318 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.7859452
	speed: 0.3253s/iter; left time: 12192.0623s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1032s/iter; left time: 3859.0051s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0934s/iter; left time: 3481.9581s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0950s/iter; left time: 3531.3193s
Epoch: 10 cost time: 41.545186042785645
Epoch: 10, Steps: 413 | Train Loss: 0.408 Vali Loss: 1.023 Vali Acc: 0.963 Test Loss: 1.023 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.3177s/iter; left time: 11776.9982s
	iters: 200, epoch: 11 | loss: 2.1812463
	speed: 0.0944s/iter; left time: 3491.1699s
	iters: 300, epoch: 11 | loss: 0.0000006
	speed: 0.0982s/iter; left time: 3622.1850s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0978s/iter; left time: 3595.5927s
Epoch: 11 cost time: 41.1916823387146
Epoch: 11, Steps: 413 | Train Loss: 0.322 Vali Loss: 0.958 Vali Acc: 0.962 Test Loss: 0.958 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2944s/iter; left time: 10791.0845s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1063s/iter; left time: 3886.8661s
	iters: 300, epoch: 12 | loss: 0.0113645
	speed: 0.0980s/iter; left time: 3572.1689s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0858s/iter; left time: 3121.1990s
Epoch: 12 cost time: 40.17072653770447
Epoch: 12, Steps: 413 | Train Loss: 0.312 Vali Loss: 1.645 Vali Acc: 0.953 Test Loss: 1.645 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3090s/iter; left time: 11199.9189s
	iters: 200, epoch: 13 | loss: 0.0000446
	speed: 0.0902s/iter; left time: 3261.8845s
	iters: 300, epoch: 13 | loss: 1.0036850
	speed: 0.0975s/iter; left time: 3513.9176s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0997s/iter; left time: 3584.2480s
Epoch: 13 cost time: 40.08912372589111
Epoch: 13, Steps: 413 | Train Loss: 0.343 Vali Loss: 1.488 Vali Acc: 0.960 Test Loss: 1.488 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9736243747157799
model parameter : 949002
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0150757
	speed: 0.0957s/iter; left time: 3941.2498s
	iters: 200, epoch: 1 | loss: 0.8087198
	speed: 0.0586s/iter; left time: 2410.3304s
	iters: 300, epoch: 1 | loss: 0.0888038
	speed: 0.0507s/iter; left time: 2080.5171s
	iters: 400, epoch: 1 | loss: 0.0001035
	speed: 0.0605s/iter; left time: 2474.3061s
Epoch: 1 cost time: 27.502755403518677
Epoch: 1, Steps: 413 | Train Loss: 0.405 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
Validation loss decreased (inf --> -0.954978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3089061
	speed: 0.2045s/iter; left time: 8339.6514s
	iters: 200, epoch: 2 | loss: 0.0011735
	speed: 0.0511s/iter; left time: 2077.9553s
	iters: 300, epoch: 2 | loss: 0.7638953
	speed: 0.0488s/iter; left time: 1982.2252s
	iters: 400, epoch: 2 | loss: 0.0000177
	speed: 0.0497s/iter; left time: 2012.1951s
Epoch: 2 cost time: 21.70616602897644
Epoch: 2, Steps: 413 | Train Loss: 0.221 Vali Loss: 0.276 Vali Acc: 0.953 Test Loss: 0.276 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0020385
	speed: 0.2233s/iter; left time: 9017.0563s
	iters: 200, epoch: 3 | loss: 0.0568633
	speed: 0.0463s/iter; left time: 1865.3607s
	iters: 300, epoch: 3 | loss: 0.3415571
	speed: 0.0512s/iter; left time: 2054.9879s
	iters: 400, epoch: 3 | loss: 0.0000086
	speed: 0.0493s/iter; left time: 1973.7356s
Epoch: 3 cost time: 22.210057497024536
Epoch: 3, Steps: 413 | Train Loss: 0.229 Vali Loss: 0.461 Vali Acc: 0.958 Test Loss: 0.461 Test Acc: 0.958
Validation loss decreased (-0.954978 --> -0.957703).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000071
	speed: 0.2218s/iter; left time: 8864.0514s
	iters: 200, epoch: 4 | loss: 0.1777316
	speed: 0.0535s/iter; left time: 2134.2651s
	iters: 300, epoch: 4 | loss: 0.6113811
	speed: 0.0472s/iter; left time: 1878.7313s
	iters: 400, epoch: 4 | loss: 0.3648762
	speed: 0.0522s/iter; left time: 2069.2817s
Epoch: 4 cost time: 21.9805109500885
Epoch: 4, Steps: 413 | Train Loss: 0.242 Vali Loss: 0.420 Vali Acc: 0.955 Test Loss: 0.420 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000045
	speed: 0.2178s/iter; left time: 8613.7950s
	iters: 200, epoch: 5 | loss: 0.0026773
	speed: 0.0564s/iter; left time: 2223.9564s
	iters: 300, epoch: 5 | loss: 0.7498221
	speed: 0.0556s/iter; left time: 2188.3259s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 2184.1986s
Epoch: 5 cost time: 23.141444444656372
Epoch: 5, Steps: 413 | Train Loss: 0.268 Vali Loss: 0.756 Vali Acc: 0.952 Test Loss: 0.756 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6109120
	speed: 0.2086s/iter; left time: 8164.7548s
	iters: 200, epoch: 6 | loss: 0.9528086
	speed: 0.0604s/iter; left time: 2357.8231s
	iters: 300, epoch: 6 | loss: 1.1234531
	speed: 0.0674s/iter; left time: 2624.1419s
	iters: 400, epoch: 6 | loss: 1.0733671
	speed: 0.0563s/iter; left time: 2185.1872s
Epoch: 6 cost time: 25.298969507217407
Epoch: 6, Steps: 413 | Train Loss: 0.272 Vali Loss: 0.683 Vali Acc: 0.957 Test Loss: 0.683 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2203613
	speed: 0.2700s/iter; left time: 10454.4081s
	iters: 200, epoch: 7 | loss: 0.3121576
	speed: 0.0865s/iter; left time: 3340.3675s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0830s/iter; left time: 3196.0864s
	iters: 400, epoch: 7 | loss: 2.8134050
	speed: 0.0710s/iter; left time: 2728.9460s
Epoch: 7 cost time: 35.07489323616028
Epoch: 7, Steps: 413 | Train Loss: 0.287 Vali Loss: 0.534 Vali Acc: 0.963 Test Loss: 0.534 Test Acc: 0.963
Validation loss decreased (-0.957703 --> -0.963160).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2690s/iter; left time: 10304.8007s
	iters: 200, epoch: 8 | loss: 1.9549509
	speed: 0.0826s/iter; left time: 3155.9540s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0805s/iter; left time: 3066.6878s
	iters: 400, epoch: 8 | loss: 0.0602818
	speed: 0.0751s/iter; left time: 2852.8465s
Epoch: 8 cost time: 34.457481145858765
Epoch: 8, Steps: 413 | Train Loss: 0.299 Vali Loss: 0.769 Vali Acc: 0.956 Test Loss: 0.769 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0037783
	speed: 0.2547s/iter; left time: 9652.8233s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0855s/iter; left time: 3232.2710s
	iters: 300, epoch: 9 | loss: 0.2929790
	speed: 0.0866s/iter; left time: 3265.1349s
	iters: 400, epoch: 9 | loss: 0.5932991
	speed: 0.0813s/iter; left time: 3055.5022s
Epoch: 9 cost time: 35.785223960876465
Epoch: 9, Steps: 413 | Train Loss: 0.203 Vali Loss: 0.932 Vali Acc: 0.957 Test Loss: 0.932 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000012
	speed: 0.2507s/iter; left time: 9397.8480s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 2872.4852s
	iters: 300, epoch: 10 | loss: 0.0000006
	speed: 0.0723s/iter; left time: 2694.0024s
	iters: 400, epoch: 10 | loss: 0.5343118
	speed: 0.0745s/iter; left time: 2771.0394s
Epoch: 10 cost time: 31.528732299804688
Epoch: 10, Steps: 413 | Train Loss: 0.186 Vali Loss: 0.618 Vali Acc: 0.966 Test Loss: 0.618 Test Acc: 0.966
Validation loss decreased (-0.963160 --> -0.966342).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2343s/iter; left time: 8686.5669s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0715s/iter; left time: 2642.8101s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 2613.0343s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0693s/iter; left time: 2549.0848s
Epoch: 11 cost time: 30.18043851852417
Epoch: 11, Steps: 413 | Train Loss: 0.201 Vali Loss: 1.021 Vali Acc: 0.958 Test Loss: 1.021 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2553s/iter; left time: 9358.0172s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0698s/iter; left time: 2550.1658s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0720s/iter; left time: 2624.3198s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0730s/iter; left time: 2653.1418s
Epoch: 12 cost time: 30.490033626556396
Epoch: 12, Steps: 413 | Train Loss: 0.301 Vali Loss: 0.773 Vali Acc: 0.970 Test Loss: 0.773 Test Acc: 0.970
Validation loss decreased (-0.966342 --> -0.969979).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0489989
	speed: 0.2264s/iter; left time: 8205.3150s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0621s/iter; left time: 2243.8634s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0660s/iter; left time: 2379.6062s
	iters: 400, epoch: 13 | loss: 0.0000932
	speed: 0.0616s/iter; left time: 2215.0737s
Epoch: 13 cost time: 27.15920066833496
Epoch: 13, Steps: 413 | Train Loss: 0.249 Vali Loss: 1.030 Vali Acc: 0.953 Test Loss: 1.030 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2468s/iter; left time: 8843.8761s
	iters: 200, epoch: 14 | loss: 0.5573400
	speed: 0.0656s/iter; left time: 2344.3038s
	iters: 300, epoch: 14 | loss: 0.0718599
	speed: 0.0670s/iter; left time: 2387.6121s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 2018.8842s
Epoch: 14 cost time: 27.569555521011353
Epoch: 14, Steps: 413 | Train Loss: 0.267 Vali Loss: 1.015 Vali Acc: 0.961 Test Loss: 1.015 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2420s/iter; left time: 8572.4004s
	iters: 200, epoch: 15 | loss: 0.2817834
	speed: 0.0716s/iter; left time: 2527.9788s
	iters: 300, epoch: 15 | loss: 2.4129403
	speed: 0.0619s/iter; left time: 2179.6967s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0537s/iter; left time: 1884.9742s
Epoch: 15 cost time: 27.12540340423584
Epoch: 15, Steps: 413 | Train Loss: 0.247 Vali Loss: 1.161 Vali Acc: 0.965 Test Loss: 1.161 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2956087
	speed: 0.2240s/iter; left time: 7839.7771s
	iters: 200, epoch: 16 | loss: 0.9561243
	speed: 0.0650s/iter; left time: 2269.2960s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0621s/iter; left time: 2161.9138s
	iters: 400, epoch: 16 | loss: 2.1502447
	speed: 0.0521s/iter; left time: 1808.8264s
Epoch: 16 cost time: 24.570905923843384
Epoch: 16, Steps: 413 | Train Loss: 0.194 Vali Loss: 0.856 Vali Acc: 0.971 Test Loss: 0.856 Test Acc: 0.971
Validation loss decreased (-0.969979 --> -0.970887).  Saving model ...
	iters: 100, epoch: 17 | loss: 3.7071137
	speed: 0.2295s/iter; left time: 7940.6592s
	iters: 200, epoch: 17 | loss: 1.4290992
	speed: 0.0595s/iter; left time: 2052.2058s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 2041.0467s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 1811.8921s
Epoch: 17 cost time: 24.524949312210083
Epoch: 17, Steps: 413 | Train Loss: 0.198 Vali Loss: 1.415 Vali Acc: 0.968 Test Loss: 1.415 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2298s/iter; left time: 7855.5179s
	iters: 200, epoch: 18 | loss: 0.0000012
	speed: 0.0485s/iter; left time: 1653.7940s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 1852.5156s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0524s/iter; left time: 1776.3068s
Epoch: 18 cost time: 23.52729296684265
Epoch: 18, Steps: 413 | Train Loss: 0.166 Vali Loss: 0.772 Vali Acc: 0.970 Test Loss: 0.772 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2203s/iter; left time: 7440.3761s
	iters: 200, epoch: 19 | loss: 0.0010311
	speed: 0.0563s/iter; left time: 1894.1095s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 1934.4585s
	iters: 400, epoch: 19 | loss: 1.2894306
	speed: 0.0645s/iter; left time: 2159.4859s
Epoch: 19 cost time: 25.427913665771484
Epoch: 19, Steps: 413 | Train Loss: 0.205 Vali Loss: 1.026 Vali Acc: 0.969 Test Loss: 1.026 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2216s/iter; left time: 7389.8732s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0753s/iter; left time: 2505.4949s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0792s/iter; left time: 2626.9640s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0698s/iter; left time: 2308.3173s
Epoch: 20 cost time: 30.69190287590027
Epoch: 20, Steps: 413 | Train Loss: 0.163 Vali Loss: 1.108 Vali Acc: 0.965 Test Loss: 1.108 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2538s/iter; left time: 8361.5372s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0689s/iter; left time: 2261.9515s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0686s/iter; left time: 2245.0903s
	iters: 400, epoch: 21 | loss: 0.3759028
	speed: 0.0680s/iter; left time: 2221.0752s
Epoch: 21 cost time: 29.478479146957397
Epoch: 21, Steps: 413 | Train Loss: 0.177 Vali Loss: 0.820 Vali Acc: 0.970 Test Loss: 0.820 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2766s/iter; left time: 8998.2954s
	iters: 200, epoch: 22 | loss: 0.6033184
	speed: 0.0995s/iter; left time: 3227.8928s
	iters: 300, epoch: 22 | loss: 0.4636539
	speed: 0.0886s/iter; left time: 2864.3729s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0889s/iter; left time: 2866.4923s
Epoch: 22 cost time: 40.377665996551514
Epoch: 22, Steps: 413 | Train Loss: 0.202 Vali Loss: 1.299 Vali Acc: 0.966 Test Loss: 1.299 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2974s/iter; left time: 9549.6564s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0959s/iter; left time: 3070.6736s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0881s/iter; left time: 2812.6588s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 2897.0435s
Epoch: 23 cost time: 40.56886529922485
Epoch: 23, Steps: 413 | Train Loss: 0.178 Vali Loss: 0.994 Vali Acc: 0.965 Test Loss: 0.994 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2901s/iter; left time: 9195.8416s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0906s/iter; left time: 2864.2575s
	iters: 300, epoch: 24 | loss: 0.0911840
	speed: 0.0880s/iter; left time: 2772.2261s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0912s/iter; left time: 2864.3967s
Epoch: 24 cost time: 39.079797983169556
Epoch: 24, Steps: 413 | Train Loss: 0.245 Vali Loss: 1.119 Vali Acc: 0.965 Test Loss: 1.119 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2696s/iter; left time: 8435.8341s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0880s/iter; left time: 2743.9644s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0866s/iter; left time: 2691.4405s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0861s/iter; left time: 2669.2353s
Epoch: 25 cost time: 37.54005002975464
Epoch: 25, Steps: 413 | Train Loss: 0.188 Vali Loss: 1.315 Vali Acc: 0.965 Test Loss: 1.315 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.4065496
	speed: 0.2722s/iter; left time: 8403.3228s
	iters: 200, epoch: 26 | loss: 1.7057432
	speed: 0.0894s/iter; left time: 2752.4556s
	iters: 300, epoch: 26 | loss: 0.0000527
	speed: 0.0942s/iter; left time: 2888.2057s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.1075s/iter; left time: 3286.3292s
Epoch: 26 cost time: 40.498522996902466
Epoch: 26, Steps: 413 | Train Loss: 0.111 Vali Loss: 1.214 Vali Acc: 0.963 Test Loss: 1.214 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9708958617553434
model parameter : 683018
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4895127
	speed: 0.1008s/iter; left time: 4152.6276s
	iters: 200, epoch: 1 | loss: 0.0464212
	speed: 0.0550s/iter; left time: 2262.5354s
	iters: 300, epoch: 1 | loss: 0.4464519
	speed: 0.0634s/iter; left time: 2600.7365s
	iters: 400, epoch: 1 | loss: 0.2410633
	speed: 0.0603s/iter; left time: 2467.0988s
Epoch: 1 cost time: 29.182723999023438
Epoch: 1, Steps: 413 | Train Loss: 0.382 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
Validation loss decreased (inf --> -0.972259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0179287
	speed: 0.2507s/iter; left time: 10224.1989s
	iters: 200, epoch: 2 | loss: 0.0207211
	speed: 0.0594s/iter; left time: 2416.2397s
	iters: 300, epoch: 2 | loss: 0.0014641
	speed: 0.0669s/iter; left time: 2716.8747s
	iters: 400, epoch: 2 | loss: 0.0673061
	speed: 0.0533s/iter; left time: 2158.8384s
Epoch: 2 cost time: 26.528462171554565
Epoch: 2, Steps: 413 | Train Loss: 0.162 Vali Loss: 0.280 Vali Acc: 0.956 Test Loss: 0.280 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0094801
	speed: 0.2190s/iter; left time: 8843.2538s
	iters: 200, epoch: 3 | loss: 0.0007019
	speed: 0.0481s/iter; left time: 1938.2223s
	iters: 300, epoch: 3 | loss: 0.0000003
	speed: 0.0533s/iter; left time: 2142.7911s
	iters: 400, epoch: 3 | loss: 0.2026762
	speed: 0.0570s/iter; left time: 2284.3239s
Epoch: 3 cost time: 23.01214098930359
Epoch: 3, Steps: 413 | Train Loss: 0.189 Vali Loss: 0.282 Vali Acc: 0.969 Test Loss: 0.282 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.3100563
	speed: 0.2189s/iter; left time: 8745.7009s
	iters: 200, epoch: 4 | loss: 0.0000047
	speed: 0.0575s/iter; left time: 2293.8497s
	iters: 300, epoch: 4 | loss: 0.0000001
	speed: 0.0602s/iter; left time: 2393.5765s
	iters: 400, epoch: 4 | loss: 0.0010324
	speed: 0.0534s/iter; left time: 2118.4745s
Epoch: 4 cost time: 25.124388694763184
Epoch: 4, Steps: 413 | Train Loss: 0.209 Vali Loss: 0.653 Vali Acc: 0.940 Test Loss: 0.653 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0000074
	speed: 0.2242s/iter; left time: 8866.9090s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0483s/iter; left time: 1903.5901s
	iters: 300, epoch: 5 | loss: 0.6146760
	speed: 0.0558s/iter; left time: 2197.3794s
	iters: 400, epoch: 5 | loss: 0.0131971
	speed: 0.0506s/iter; left time: 1987.6560s
Epoch: 5 cost time: 23.451152324676514
Epoch: 5, Steps: 413 | Train Loss: 0.236 Vali Loss: 0.563 Vali Acc: 0.957 Test Loss: 0.563 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.7348349
	speed: 0.2481s/iter; left time: 9710.2935s
	iters: 200, epoch: 6 | loss: 0.2104207
	speed: 0.0513s/iter; left time: 2002.5535s
	iters: 300, epoch: 6 | loss: 0.0597150
	speed: 0.0538s/iter; left time: 2096.1579s
	iters: 400, epoch: 6 | loss: 1.3828461
	speed: 0.0501s/iter; left time: 1944.8342s
Epoch: 6 cost time: 24.827653408050537
Epoch: 6, Steps: 413 | Train Loss: 0.255 Vali Loss: 0.334 Vali Acc: 0.975 Test Loss: 0.334 Test Acc: 0.975
Validation loss decreased (-0.972259 --> -0.974531).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0008670
	speed: 0.2794s/iter; left time: 10819.7236s
	iters: 200, epoch: 7 | loss: 0.6580034
	speed: 0.0998s/iter; left time: 3855.3348s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0906s/iter; left time: 3488.4776s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0834s/iter; left time: 3205.3289s
Epoch: 7 cost time: 40.26532554626465
Epoch: 7, Steps: 413 | Train Loss: 0.185 Vali Loss: 0.716 Vali Acc: 0.955 Test Loss: 0.716 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.3004s/iter; left time: 11507.6710s
	iters: 200, epoch: 8 | loss: 0.0000042
	speed: 0.0962s/iter; left time: 3677.1775s
	iters: 300, epoch: 8 | loss: 0.0000042
	speed: 0.0938s/iter; left time: 3575.7074s
	iters: 400, epoch: 8 | loss: 0.0717325
	speed: 0.0886s/iter; left time: 3365.8851s
Epoch: 8 cost time: 41.43685460090637
Epoch: 8, Steps: 413 | Train Loss: 0.280 Vali Loss: 0.614 Vali Acc: 0.958 Test Loss: 0.614 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.2400910
	speed: 0.2820s/iter; left time: 10686.3693s
	iters: 200, epoch: 9 | loss: 0.5598982
	speed: 0.0824s/iter; left time: 3113.5586s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0787s/iter; left time: 2965.5031s
	iters: 400, epoch: 9 | loss: 0.2643102
	speed: 0.0833s/iter; left time: 3131.1368s
Epoch: 9 cost time: 36.2731614112854
Epoch: 9, Steps: 413 | Train Loss: 0.294 Vali Loss: 0.682 Vali Acc: 0.965 Test Loss: 0.682 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2752s/iter; left time: 10316.6370s
	iters: 200, epoch: 10 | loss: 0.0000005
	speed: 0.0841s/iter; left time: 3142.3757s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0824s/iter; left time: 3072.5469s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0885s/iter; left time: 3291.0612s
Epoch: 10 cost time: 37.899961709976196
Epoch: 10, Steps: 413 | Train Loss: 0.275 Vali Loss: 0.535 Vali Acc: 0.973 Test Loss: 0.535 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2688s/iter; left time: 9965.4148s
	iters: 200, epoch: 11 | loss: 0.0000002
	speed: 0.0878s/iter; left time: 3246.4603s
	iters: 300, epoch: 11 | loss: 1.2175496
	speed: 0.0918s/iter; left time: 3382.9713s
	iters: 400, epoch: 11 | loss: 0.0003486
	speed: 0.0935s/iter; left time: 3438.9646s
Epoch: 11 cost time: 39.10019397735596
Epoch: 11, Steps: 413 | Train Loss: 0.268 Vali Loss: 0.652 Vali Acc: 0.970 Test Loss: 0.652 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1143638
	speed: 0.2663s/iter; left time: 9762.9858s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 2883.8205s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0802s/iter; left time: 2922.3086s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0852s/iter; left time: 3098.2204s
Epoch: 12 cost time: 34.85838007926941
Epoch: 12, Steps: 413 | Train Loss: 0.218 Vali Loss: 0.438 Vali Acc: 0.971 Test Loss: 0.438 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2465s/iter; left time: 8932.6153s
	iters: 200, epoch: 13 | loss: 1.7008278
	speed: 0.0831s/iter; left time: 3002.7273s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0862s/iter; left time: 3106.4734s
	iters: 400, epoch: 13 | loss: 0.0000427
	speed: 0.1057s/iter; left time: 3800.6423s
Epoch: 13 cost time: 37.66584634780884
Epoch: 13, Steps: 413 | Train Loss: 0.223 Vali Loss: 0.659 Vali Acc: 0.973 Test Loss: 0.659 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2858s/iter; left time: 10240.4842s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 2847.5220s
	iters: 300, epoch: 14 | loss: 2.0374022
	speed: 0.0689s/iter; left time: 2455.6524s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0875s/iter; left time: 3108.4974s
Epoch: 14 cost time: 34.496530294418335
Epoch: 14, Steps: 413 | Train Loss: 0.280 Vali Loss: 0.509 Vali Acc: 0.972 Test Loss: 0.509 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2515s/iter; left time: 8908.3603s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0787s/iter; left time: 2779.7131s
	iters: 300, epoch: 15 | loss: 1.2403867
	speed: 0.0803s/iter; left time: 2828.8308s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0651s/iter; left time: 2286.7613s
Epoch: 15 cost time: 30.52786922454834
Epoch: 15, Steps: 413 | Train Loss: 0.152 Vali Loss: 0.917 Vali Acc: 0.960 Test Loss: 0.917 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2618s/iter; left time: 9164.5643s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0784s/iter; left time: 2735.7358s
	iters: 300, epoch: 16 | loss: 0.8196100
	speed: 0.0833s/iter; left time: 2898.9950s
	iters: 400, epoch: 16 | loss: 1.9284823
	speed: 0.0632s/iter; left time: 2194.2754s
Epoch: 16 cost time: 31.700302839279175
Epoch: 16, Steps: 413 | Train Loss: 0.275 Vali Loss: 1.264 Vali Acc: 0.955 Test Loss: 1.264 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9745338790359254
model parameter : 550154
model size : 4.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0458837
	speed: 0.1101s/iter; left time: 4537.8103s
	iters: 200, epoch: 1 | loss: 0.1774439
	speed: 0.0718s/iter; left time: 2952.1479s
	iters: 300, epoch: 1 | loss: 0.2175181
	speed: 0.0557s/iter; left time: 2284.8409s
	iters: 400, epoch: 1 | loss: 0.0057803
	speed: 0.0504s/iter; left time: 2060.9944s
Epoch: 1 cost time: 29.45823049545288
Epoch: 1, Steps: 413 | Train Loss: 0.362 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
Validation loss decreased (inf --> -0.926327).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1075494
	speed: 0.2169s/iter; left time: 8848.7714s
	iters: 200, epoch: 2 | loss: 0.0835197
	speed: 0.0842s/iter; left time: 3425.7501s
	iters: 300, epoch: 2 | loss: 0.0007433
	speed: 0.0803s/iter; left time: 3259.3837s
	iters: 400, epoch: 2 | loss: 0.0625810
	speed: 0.0639s/iter; left time: 2588.0119s
Epoch: 2 cost time: 31.5212082862854
Epoch: 2, Steps: 413 | Train Loss: 0.167 Vali Loss: 0.192 Vali Acc: 0.966 Test Loss: 0.192 Test Acc: 0.966
Validation loss decreased (-0.926327 --> -0.965892).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2407148
	speed: 0.2377s/iter; left time: 9595.7711s
	iters: 200, epoch: 3 | loss: 0.0020629
	speed: 0.0913s/iter; left time: 3678.9508s
	iters: 300, epoch: 3 | loss: 0.0131332
	speed: 0.0802s/iter; left time: 3221.3452s
	iters: 400, epoch: 3 | loss: 0.1403561
	speed: 0.0523s/iter; left time: 2096.6695s
Epoch: 3 cost time: 31.350696563720703
Epoch: 3, Steps: 413 | Train Loss: 0.152 Vali Loss: 0.260 Vali Acc: 0.965 Test Loss: 0.260 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3487635
	speed: 0.2305s/iter; left time: 9212.0889s
	iters: 200, epoch: 4 | loss: 0.0001787
	speed: 0.0897s/iter; left time: 3575.0217s
	iters: 300, epoch: 4 | loss: 0.0000001
	speed: 0.0751s/iter; left time: 2985.4930s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0803s/iter; left time: 3183.4970s
Epoch: 4 cost time: 33.05255842208862
Epoch: 4, Steps: 413 | Train Loss: 0.159 Vali Loss: 0.265 Vali Acc: 0.967 Test Loss: 0.265 Test Acc: 0.967
Validation loss decreased (-0.965892 --> -0.966800).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000288
	speed: 0.2586s/iter; left time: 10226.1686s
	iters: 200, epoch: 5 | loss: 0.0098689
	speed: 0.1026s/iter; left time: 4046.3274s
	iters: 300, epoch: 5 | loss: 0.4308835
	speed: 0.0931s/iter; left time: 3662.2586s
	iters: 400, epoch: 5 | loss: 0.0000010
	speed: 0.0742s/iter; left time: 2912.2987s
Epoch: 5 cost time: 37.977678298950195
Epoch: 5, Steps: 413 | Train Loss: 0.170 Vali Loss: 0.254 Vali Acc: 0.974 Test Loss: 0.254 Test Acc: 0.974
Validation loss decreased (-0.966800 --> -0.974077).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0003644
	speed: 0.2313s/iter; left time: 9051.3765s
	iters: 200, epoch: 6 | loss: 0.0343999
	speed: 0.0949s/iter; left time: 3704.4102s
	iters: 300, epoch: 6 | loss: 0.0000196
	speed: 0.0887s/iter; left time: 3452.6780s
	iters: 400, epoch: 6 | loss: 0.0000026
	speed: 0.0698s/iter; left time: 2711.8254s
Epoch: 6 cost time: 35.57343792915344
Epoch: 6, Steps: 413 | Train Loss: 0.207 Vali Loss: 0.433 Vali Acc: 0.964 Test Loss: 0.433 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0008286
	speed: 0.2396s/iter; left time: 9277.6384s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.1146s/iter; left time: 4425.3645s
	iters: 300, epoch: 7 | loss: 0.7766395
	speed: 0.1154s/iter; left time: 4445.4236s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0877s/iter; left time: 3371.1213s
Epoch: 7 cost time: 42.769690990448
Epoch: 7, Steps: 413 | Train Loss: 0.210 Vali Loss: 0.313 Vali Acc: 0.975 Test Loss: 0.313 Test Acc: 0.975
Validation loss decreased (-0.974077 --> -0.975440).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0068897
	speed: 0.2691s/iter; left time: 10307.6745s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1152s/iter; left time: 4400.8499s
	iters: 300, epoch: 8 | loss: 0.0000103
	speed: 0.1068s/iter; left time: 4071.7406s
	iters: 400, epoch: 8 | loss: 0.0000007
	speed: 0.0871s/iter; left time: 3309.2121s
Epoch: 8 cost time: 43.268235206604004
Epoch: 8, Steps: 413 | Train Loss: 0.231 Vali Loss: 0.484 Vali Acc: 0.963 Test Loss: 0.484 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000037
	speed: 0.2603s/iter; left time: 9865.0543s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1035s/iter; left time: 3913.3219s
	iters: 300, epoch: 9 | loss: 0.0000008
	speed: 0.0766s/iter; left time: 2888.3376s
	iters: 400, epoch: 9 | loss: 0.1083275
	speed: 0.0639s/iter; left time: 2404.1544s
Epoch: 9 cost time: 34.82524228096008
Epoch: 9, Steps: 413 | Train Loss: 0.180 Vali Loss: 0.523 Vali Acc: 0.965 Test Loss: 0.523 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2397s/iter; left time: 8984.8338s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.0754s/iter; left time: 2820.2979s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 2585.9577s
	iters: 400, epoch: 10 | loss: 0.0000002
	speed: 0.0674s/iter; left time: 2505.4316s
Epoch: 10 cost time: 30.882157802581787
Epoch: 10, Steps: 413 | Train Loss: 0.192 Vali Loss: 0.350 Vali Acc: 0.980 Test Loss: 0.350 Test Acc: 0.980
Validation loss decreased (-0.975440 --> -0.979987).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.2300s/iter; left time: 8525.1134s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0807s/iter; left time: 2984.4598s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0725s/iter; left time: 2673.1813s
	iters: 400, epoch: 11 | loss: 0.0000003
	speed: 0.0603s/iter; left time: 2216.5669s
Epoch: 11 cost time: 29.97163963317871
Epoch: 11, Steps: 413 | Train Loss: 0.191 Vali Loss: 0.444 Vali Acc: 0.969 Test Loss: 0.444 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0029555
	speed: 0.2031s/iter; left time: 7443.7847s
	iters: 200, epoch: 12 | loss: 0.5430201
	speed: 0.0552s/iter; left time: 2019.1908s
	iters: 300, epoch: 12 | loss: 0.0004969
	speed: 0.0572s/iter; left time: 2085.0459s
	iters: 400, epoch: 12 | loss: 0.0165091
	speed: 0.0589s/iter; left time: 2140.3479s
Epoch: 12 cost time: 23.97769832611084
Epoch: 12, Steps: 413 | Train Loss: 0.194 Vali Loss: 0.719 Vali Acc: 0.964 Test Loss: 0.719 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1913s/iter; left time: 6932.6300s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 1926.9176s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0622s/iter; left time: 2240.5298s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0661s/iter; left time: 2376.4710s
Epoch: 13 cost time: 24.32440161705017
Epoch: 13, Steps: 413 | Train Loss: 0.176 Vali Loss: 0.658 Vali Acc: 0.961 Test Loss: 0.658 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.2756507
	speed: 0.2058s/iter; left time: 7375.1259s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 1967.4574s
	iters: 300, epoch: 14 | loss: 0.5723171
	speed: 0.0648s/iter; left time: 2309.9889s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0641s/iter; left time: 2278.9214s
Epoch: 14 cost time: 25.53859257698059
Epoch: 14, Steps: 413 | Train Loss: 0.226 Vali Loss: 0.766 Vali Acc: 0.970 Test Loss: 0.766 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.2957835
	speed: 0.1968s/iter; left time: 6972.2087s
	iters: 200, epoch: 15 | loss: 0.0000168
	speed: 0.0595s/iter; left time: 2100.8124s
	iters: 300, epoch: 15 | loss: 0.7229481
	speed: 0.0562s/iter; left time: 1979.0567s
	iters: 400, epoch: 15 | loss: 4.2386441
	speed: 0.0499s/iter; left time: 1754.0079s
Epoch: 15 cost time: 22.817126274108887
Epoch: 15, Steps: 413 | Train Loss: 0.222 Vali Loss: 0.429 Vali Acc: 0.971 Test Loss: 0.429 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1985s/iter; left time: 6949.9236s
	iters: 200, epoch: 16 | loss: 0.0001713
	speed: 0.0508s/iter; left time: 1774.6270s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 1856.0892s
	iters: 400, epoch: 16 | loss: 2.4936447
	speed: 0.0474s/iter; left time: 1645.3165s
Epoch: 16 cost time: 21.69754672050476
Epoch: 16, Steps: 413 | Train Loss: 0.188 Vali Loss: 0.634 Vali Acc: 0.970 Test Loss: 0.634 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2087s/iter; left time: 7221.2320s
	iters: 200, epoch: 17 | loss: 0.0000047
	speed: 0.0543s/iter; left time: 1872.9412s
	iters: 300, epoch: 17 | loss: 0.7721906
	speed: 0.0503s/iter; left time: 1731.6058s
	iters: 400, epoch: 17 | loss: 1.0062838
	speed: 0.0550s/iter; left time: 1885.1742s
Epoch: 17 cost time: 23.110480785369873
Epoch: 17, Steps: 413 | Train Loss: 0.234 Vali Loss: 1.030 Vali Acc: 0.949 Test Loss: 1.030 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000003
	speed: 0.2248s/iter; left time: 7684.8237s
	iters: 200, epoch: 18 | loss: 0.0000006
	speed: 0.0529s/iter; left time: 1802.7455s
	iters: 300, epoch: 18 | loss: 0.5212649
	speed: 0.0510s/iter; left time: 1731.3977s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 1706.4473s
Epoch: 18 cost time: 23.17942976951599
Epoch: 18, Steps: 413 | Train Loss: 0.208 Vali Loss: 0.772 Vali Acc: 0.965 Test Loss: 0.772 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.3404154
	speed: 0.2454s/iter; left time: 8286.9906s
	iters: 200, epoch: 19 | loss: 0.5949416
	speed: 0.0747s/iter; left time: 2513.6257s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 2392.2186s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 2374.4944s
Epoch: 19 cost time: 32.24450945854187
Epoch: 19, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.743 Vali Acc: 0.970 Test Loss: 0.743 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2485s/iter; left time: 8287.1343s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0725s/iter; left time: 2411.3050s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 2277.5572s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0728s/iter; left time: 2406.3304s
Epoch: 20 cost time: 31.2775936126709
Epoch: 20, Steps: 413 | Train Loss: 0.179 Vali Loss: 0.497 Vali Acc: 0.979 Test Loss: 0.497 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 467338
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2508929
	speed: 0.1040s/iter; left time: 4282.9207s
	iters: 200, epoch: 1 | loss: 0.1753518
	speed: 0.0678s/iter; left time: 2784.7589s
	iters: 300, epoch: 1 | loss: 0.0167246
	speed: 0.0691s/iter; left time: 2831.3505s
	iters: 400, epoch: 1 | loss: 0.4727324
	speed: 0.0765s/iter; left time: 3127.8963s
Epoch: 1 cost time: 32.86640024185181
Epoch: 1, Steps: 413 | Train Loss: 0.345 Vali Loss: 0.212 Vali Acc: 0.945 Test Loss: 0.212 Test Acc: 0.945
Validation loss decreased (inf --> -0.945428).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1307434
	speed: 0.2200s/iter; left time: 8973.6584s
	iters: 200, epoch: 2 | loss: 0.1882301
	speed: 0.0784s/iter; left time: 3188.6950s
	iters: 300, epoch: 2 | loss: 0.1998134
	speed: 0.0794s/iter; left time: 3223.5194s
	iters: 400, epoch: 2 | loss: 0.0070965
	speed: 0.0709s/iter; left time: 2870.0239s
Epoch: 2 cost time: 31.633256673812866
Epoch: 2, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
Validation loss decreased (-0.945428 --> -0.978171).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6766425
	speed: 0.2491s/iter; left time: 10055.8206s
	iters: 200, epoch: 3 | loss: 0.0013683
	speed: 0.0786s/iter; left time: 3164.2947s
	iters: 300, epoch: 3 | loss: 0.1888700
	speed: 0.0715s/iter; left time: 2872.1765s
	iters: 400, epoch: 3 | loss: 0.0018807
	speed: 0.0709s/iter; left time: 2841.2953s
Epoch: 3 cost time: 31.9272723197937
Epoch: 3, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.385 Vali Acc: 0.948 Test Loss: 0.385 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4014464
	speed: 0.2366s/iter; left time: 9454.7326s
	iters: 200, epoch: 4 | loss: 0.7966620
	speed: 0.0704s/iter; left time: 2805.2915s
	iters: 300, epoch: 4 | loss: 0.0015541
	speed: 0.0634s/iter; left time: 2520.0522s
	iters: 400, epoch: 4 | loss: 1.7186643
	speed: 0.0502s/iter; left time: 1992.0722s
Epoch: 4 cost time: 27.132074117660522
Epoch: 4, Steps: 413 | Train Loss: 0.168 Vali Loss: 0.364 Vali Acc: 0.955 Test Loss: 0.364 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.1856s/iter; left time: 7340.8819s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 1745.4251s
	iters: 300, epoch: 5 | loss: 0.0000186
	speed: 0.0467s/iter; left time: 1836.1376s
	iters: 400, epoch: 5 | loss: 0.1007854
	speed: 0.0409s/iter; left time: 1605.8313s
Epoch: 5 cost time: 19.511621236801147
Epoch: 5, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.211 Vali Acc: 0.972 Test Loss: 0.211 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.5685984
	speed: 0.1981s/iter; left time: 7752.2056s
	iters: 200, epoch: 6 | loss: 0.1227518
	speed: 0.0551s/iter; left time: 2150.4849s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0536s/iter; left time: 2088.2927s
	iters: 400, epoch: 6 | loss: 0.0000003
	speed: 0.0550s/iter; left time: 2136.6929s
Epoch: 6 cost time: 23.777016162872314
Epoch: 6, Steps: 413 | Train Loss: 0.147 Vali Loss: 0.359 Vali Acc: 0.966 Test Loss: 0.359 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0004255
	speed: 0.2152s/iter; left time: 8333.6673s
	iters: 200, epoch: 7 | loss: 0.0000002
	speed: 0.0491s/iter; left time: 1898.3074s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0524s/iter; left time: 2019.2263s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 2294.6878s
Epoch: 7 cost time: 23.128286361694336
Epoch: 7, Steps: 413 | Train Loss: 0.182 Vali Loss: 0.446 Vali Acc: 0.963 Test Loss: 0.446 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2085s/iter; left time: 7987.6518s
	iters: 200, epoch: 8 | loss: 0.1891237
	speed: 0.0509s/iter; left time: 1946.7362s
	iters: 300, epoch: 8 | loss: 0.0017971
	speed: 0.0551s/iter; left time: 2101.5895s
	iters: 400, epoch: 8 | loss: 0.0000710
	speed: 0.0524s/iter; left time: 1992.2033s
Epoch: 8 cost time: 21.98876452445984
Epoch: 8, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.355 Vali Acc: 0.963 Test Loss: 0.355 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.1727270
	speed: 0.1985s/iter; left time: 7524.1427s
	iters: 200, epoch: 9 | loss: 0.4374140
	speed: 0.0528s/iter; left time: 1995.2554s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0558s/iter; left time: 2105.0609s
	iters: 400, epoch: 9 | loss: 0.7573221
	speed: 0.0531s/iter; left time: 1996.9449s
Epoch: 9 cost time: 22.722686767578125
Epoch: 9, Steps: 413 | Train Loss: 0.165 Vali Loss: 0.593 Vali Acc: 0.961 Test Loss: 0.593 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2137s/iter; left time: 8010.4479s
	iters: 200, epoch: 10 | loss: 0.8323334
	speed: 0.0591s/iter; left time: 2211.1155s
	iters: 300, epoch: 10 | loss: 0.0000161
	speed: 0.0725s/iter; left time: 2704.3886s
	iters: 400, epoch: 10 | loss: 0.7448753
	speed: 0.0578s/iter; left time: 2148.3413s
Epoch: 10 cost time: 26.868003606796265
Epoch: 10, Steps: 413 | Train Loss: 0.172 Vali Loss: 0.481 Vali Acc: 0.965 Test Loss: 0.481 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2189s/iter; left time: 8113.8977s
	iters: 200, epoch: 11 | loss: 0.7266341
	speed: 0.0713s/iter; left time: 2634.4355s
	iters: 300, epoch: 11 | loss: 0.0001757
	speed: 0.0642s/iter; left time: 2367.6829s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0811s/iter; left time: 2982.6250s
Epoch: 11 cost time: 29.172529935836792
Epoch: 11, Steps: 413 | Train Loss: 0.203 Vali Loss: 0.322 Vali Acc: 0.965 Test Loss: 0.322 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2622s/iter; left time: 9610.7937s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0805s/iter; left time: 2944.0723s
	iters: 300, epoch: 12 | loss: 0.0000112
	speed: 0.0830s/iter; left time: 3024.4268s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0741s/iter; left time: 2694.0877s
Epoch: 12 cost time: 34.02670764923096
Epoch: 12, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.510 Vali Acc: 0.971 Test Loss: 0.510 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 384650
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0716677
	speed: 0.0970s/iter; left time: 3997.3630s
	iters: 200, epoch: 1 | loss: 0.0449516
	speed: 0.0681s/iter; left time: 2797.8460s
	iters: 300, epoch: 1 | loss: 0.0761395
	speed: 0.0677s/iter; left time: 2775.6241s
	iters: 400, epoch: 1 | loss: 0.0464297
	speed: 0.0614s/iter; left time: 2509.8486s
Epoch: 1 cost time: 30.308888912200928
Epoch: 1, Steps: 413 | Train Loss: 0.354 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
Validation loss decreased (inf --> -0.954069).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1229555
	speed: 0.2096s/iter; left time: 8549.5438s
	iters: 200, epoch: 2 | loss: 0.0151209
	speed: 0.0707s/iter; left time: 2877.0363s
	iters: 300, epoch: 2 | loss: 0.0018821
	speed: 0.0692s/iter; left time: 2810.4981s
	iters: 400, epoch: 2 | loss: 0.0244545
	speed: 0.0688s/iter; left time: 2786.8726s
Epoch: 2 cost time: 29.47434425354004
Epoch: 2, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
Validation loss decreased (-0.954069 --> -0.959525).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0004309
	speed: 0.2462s/iter; left time: 9939.4986s
	iters: 200, epoch: 3 | loss: 0.1502928
	speed: 0.0765s/iter; left time: 3080.2503s
	iters: 300, epoch: 3 | loss: 0.0041257
	speed: 0.0805s/iter; left time: 3234.9512s
	iters: 400, epoch: 3 | loss: 0.5668019
	speed: 0.0769s/iter; left time: 3083.5556s
Epoch: 3 cost time: 32.31874442100525
Epoch: 3, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.368 Vali Acc: 0.945 Test Loss: 0.368 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000026
	speed: 0.2517s/iter; left time: 10057.5634s
	iters: 200, epoch: 4 | loss: 0.0010573
	speed: 0.0752s/iter; left time: 2999.0654s
	iters: 300, epoch: 4 | loss: 0.0000812
	speed: 0.0777s/iter; left time: 3087.7187s
	iters: 400, epoch: 4 | loss: 0.1070874
	speed: 0.0785s/iter; left time: 3115.4121s
Epoch: 4 cost time: 33.31020379066467
Epoch: 4, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.239 Vali Acc: 0.965 Test Loss: 0.239 Test Acc: 0.965
Validation loss decreased (-0.959525 --> -0.964982).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000030
	speed: 0.2490s/iter; left time: 9846.8422s
	iters: 200, epoch: 5 | loss: 0.0081329
	speed: 0.0551s/iter; left time: 2171.8912s
	iters: 300, epoch: 5 | loss: 0.0176792
	speed: 0.0593s/iter; left time: 2334.8219s
	iters: 400, epoch: 5 | loss: 0.0000003
	speed: 0.0548s/iter; left time: 2151.1696s
Epoch: 5 cost time: 26.296000480651855
Epoch: 5, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.227 Vali Acc: 0.965 Test Loss: 0.227 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0162064
	speed: 0.2259s/iter; left time: 8842.1145s
	iters: 200, epoch: 6 | loss: 0.1540567
	speed: 0.0674s/iter; left time: 2631.3799s
	iters: 300, epoch: 6 | loss: 0.0137043
	speed: 0.0583s/iter; left time: 2271.2446s
	iters: 400, epoch: 6 | loss: 0.0000869
	speed: 0.0579s/iter; left time: 2247.5628s
Epoch: 6 cost time: 25.744837760925293
Epoch: 6, Steps: 413 | Train Loss: 0.145 Vali Loss: 0.482 Vali Acc: 0.960 Test Loss: 0.482 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0651177
	speed: 0.2337s/iter; left time: 9050.5789s
	iters: 200, epoch: 7 | loss: 1.0987209
	speed: 0.0516s/iter; left time: 1994.2368s
	iters: 300, epoch: 7 | loss: 0.0000008
	speed: 0.0577s/iter; left time: 2221.3527s
	iters: 400, epoch: 7 | loss: 0.0027540
	speed: 0.0563s/iter; left time: 2164.1760s
Epoch: 7 cost time: 23.888681411743164
Epoch: 7, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.513 Vali Acc: 0.950 Test Loss: 0.513 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000040
	speed: 0.2431s/iter; left time: 9313.7847s
	iters: 200, epoch: 8 | loss: 0.0000035
	speed: 0.0528s/iter; left time: 2018.1366s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 1986.5549s
	iters: 400, epoch: 8 | loss: 0.0003232
	speed: 0.0464s/iter; left time: 1765.2308s
Epoch: 8 cost time: 22.807393312454224
Epoch: 8, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.442 Vali Acc: 0.957 Test Loss: 0.442 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000022
	speed: 0.2279s/iter; left time: 8636.3189s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0474s/iter; left time: 1790.2983s
	iters: 300, epoch: 9 | loss: 0.0000196
	speed: 0.0517s/iter; left time: 1949.7475s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 1834.8894s
Epoch: 9 cost time: 22.356898546218872
Epoch: 9, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.341 Vali Acc: 0.975 Test Loss: 0.341 Test Acc: 0.975
Validation loss decreased (-0.964982 --> -0.975440).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0164958
	speed: 0.2201s/iter; left time: 8250.3361s
	iters: 200, epoch: 10 | loss: 0.0028481
	speed: 0.0473s/iter; left time: 1768.7205s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1691.2389s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0555s/iter; left time: 2064.4138s
Epoch: 10 cost time: 21.640573263168335
Epoch: 10, Steps: 413 | Train Loss: 0.154 Vali Loss: 0.339 Vali Acc: 0.973 Test Loss: 0.339 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2187s/iter; left time: 8108.1937s
	iters: 200, epoch: 11 | loss: 0.0546681
	speed: 0.0445s/iter; left time: 1643.7797s
	iters: 300, epoch: 11 | loss: 0.0000133
	speed: 0.0466s/iter; left time: 1719.9732s
	iters: 400, epoch: 11 | loss: 0.2073279
	speed: 0.0468s/iter; left time: 1721.3497s
Epoch: 11 cost time: 20.75677800178528
Epoch: 11, Steps: 413 | Train Loss: 0.157 Vali Loss: 0.374 Vali Acc: 0.967 Test Loss: 0.374 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000006
	speed: 0.2391s/iter; left time: 8764.7942s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 2514.9933s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 2366.8228s
	iters: 400, epoch: 12 | loss: 0.0002387
	speed: 0.0719s/iter; left time: 2613.2719s
Epoch: 12 cost time: 29.583417415618896
Epoch: 12, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.369 Vali Acc: 0.968 Test Loss: 0.369 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000075
	speed: 0.2482s/iter; left time: 8996.8724s
	iters: 200, epoch: 13 | loss: 0.0999374
	speed: 0.0777s/iter; left time: 2808.9473s
	iters: 300, epoch: 13 | loss: 0.0003805
	speed: 0.0779s/iter; left time: 2807.4099s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 2759.4522s
Epoch: 13 cost time: 32.362045764923096
Epoch: 13, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.499 Vali Acc: 0.960 Test Loss: 0.499 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0327951
	speed: 0.2604s/iter; left time: 9331.5709s
	iters: 200, epoch: 14 | loss: 0.0007275
	speed: 0.0775s/iter; left time: 2770.6957s
	iters: 300, epoch: 14 | loss: 0.0053710
	speed: 0.0696s/iter; left time: 2480.9870s
	iters: 400, epoch: 14 | loss: 0.0000220
	speed: 0.0767s/iter; left time: 2726.9862s
Epoch: 14 cost time: 31.703195571899414
Epoch: 14, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.323 Vali Acc: 0.971 Test Loss: 0.323 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000172
	speed: 0.2625s/iter; left time: 9297.9695s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0780s/iter; left time: 2754.9570s
	iters: 300, epoch: 15 | loss: 0.0000036
	speed: 0.0690s/iter; left time: 2428.7033s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0726s/iter; left time: 2548.5892s
Epoch: 15 cost time: 31.889158725738525
Epoch: 15, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.513 Vali Acc: 0.964 Test Loss: 0.513 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0010825
	speed: 0.2582s/iter; left time: 9037.2792s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0745s/iter; left time: 2600.8987s
	iters: 300, epoch: 16 | loss: 0.0000119
	speed: 0.0713s/iter; left time: 2481.2085s
	iters: 400, epoch: 16 | loss: 0.4401780
	speed: 0.0678s/iter; left time: 2353.7823s
Epoch: 16 cost time: 31.045772314071655
Epoch: 16, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.535 Vali Acc: 0.959 Test Loss: 0.535 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000005
	speed: 0.2394s/iter; left time: 8280.3126s
	iters: 200, epoch: 17 | loss: 0.0000273
	speed: 0.0679s/iter; left time: 2343.4300s
	iters: 300, epoch: 17 | loss: 0.0000020
	speed: 0.0679s/iter; left time: 2335.2358s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 2282.6096s
Epoch: 17 cost time: 28.609857320785522
Epoch: 17, Steps: 413 | Train Loss: 0.152 Vali Loss: 0.588 Vali Acc: 0.954 Test Loss: 0.588 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2098s/iter; left time: 7169.9566s
	iters: 200, epoch: 18 | loss: 0.0000003
	speed: 0.0475s/iter; left time: 1619.6142s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0534s/iter; left time: 1813.9999s
	iters: 400, epoch: 18 | loss: 0.0000050
	speed: 0.0593s/iter; left time: 2009.8168s
Epoch: 18 cost time: 22.836421012878418
Epoch: 18, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.462 Vali Acc: 0.966 Test Loss: 0.462 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2422s/iter; left time: 8178.2533s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 2010.9558s
	iters: 300, epoch: 19 | loss: 0.0002144
	speed: 0.0579s/iter; left time: 1944.2208s
	iters: 400, epoch: 19 | loss: 0.0000020
	speed: 0.0589s/iter; left time: 1972.1888s
Epoch: 19 cost time: 25.9099063873291
Epoch: 19, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.575 Vali Acc: 0.967 Test Loss: 0.575 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 318730
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2974775
	speed: 0.0881s/iter; left time: 3631.2010s
	iters: 200, epoch: 1 | loss: 0.1844031
	speed: 0.0513s/iter; left time: 2110.3633s
	iters: 300, epoch: 1 | loss: 0.0715263
	speed: 0.0495s/iter; left time: 2028.5338s
	iters: 400, epoch: 1 | loss: 0.1331438
	speed: 0.0503s/iter; left time: 2058.3902s
Epoch: 1 cost time: 24.98276996612549
Epoch: 1, Steps: 413 | Train Loss: 0.347 Vali Loss: 0.147 Vali Acc: 0.950 Test Loss: 0.147 Test Acc: 0.950
Validation loss decreased (inf --> -0.950431).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0012222
	speed: 0.1992s/iter; left time: 8125.0257s
	iters: 200, epoch: 2 | loss: 0.0397881
	speed: 0.0482s/iter; left time: 1961.3893s
	iters: 300, epoch: 2 | loss: 0.0020231
	speed: 0.0523s/iter; left time: 2122.7802s
	iters: 400, epoch: 2 | loss: 0.0225097
	speed: 0.0571s/iter; left time: 2310.7313s
Epoch: 2 cost time: 22.138587474822998
Epoch: 2, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
Validation loss decreased (-0.950431 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0009885
	speed: 0.2146s/iter; left time: 8664.3324s
	iters: 200, epoch: 3 | loss: 0.0000799
	speed: 0.0464s/iter; left time: 1868.0413s
	iters: 300, epoch: 3 | loss: 0.0097674
	speed: 0.0562s/iter; left time: 2259.6382s
	iters: 400, epoch: 3 | loss: 0.0440531
	speed: 0.0547s/iter; left time: 2192.2985s
Epoch: 3 cost time: 22.622976779937744
Epoch: 3, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0176391
	speed: 0.2231s/iter; left time: 8915.8378s
	iters: 200, epoch: 4 | loss: 0.0000007
	speed: 0.0565s/iter; left time: 2252.1650s
	iters: 300, epoch: 4 | loss: 0.4313153
	speed: 0.0537s/iter; left time: 2137.0553s
	iters: 400, epoch: 4 | loss: 0.0024885
	speed: 0.0510s/iter; left time: 2021.6695s
Epoch: 4 cost time: 24.157832384109497
Epoch: 4, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4495996
	speed: 0.2571s/iter; left time: 10168.0249s
	iters: 200, epoch: 5 | loss: 0.0040791
	speed: 0.0715s/iter; left time: 2820.3905s
	iters: 300, epoch: 5 | loss: 0.0043168
	speed: 0.0755s/iter; left time: 2969.1730s
	iters: 400, epoch: 5 | loss: 0.0130624
	speed: 0.0664s/iter; left time: 2606.1163s
Epoch: 5 cost time: 30.831177711486816
Epoch: 5, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.261 Vali Acc: 0.962 Test Loss: 0.261 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3990943
	speed: 0.2619s/iter; left time: 10249.0433s
	iters: 200, epoch: 6 | loss: 0.0000003
	speed: 0.0739s/iter; left time: 2885.7800s
	iters: 300, epoch: 6 | loss: 0.0026818
	speed: 0.0681s/iter; left time: 2653.0711s
	iters: 400, epoch: 6 | loss: 0.0010723
	speed: 0.0649s/iter; left time: 2522.0744s
Epoch: 6 cost time: 30.01465678215027
Epoch: 6, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.219 Vali Acc: 0.965 Test Loss: 0.219 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7333081
	speed: 0.2363s/iter; left time: 9151.8638s
	iters: 200, epoch: 7 | loss: 0.0000050
	speed: 0.0642s/iter; left time: 2479.4536s
	iters: 300, epoch: 7 | loss: 0.2074567
	speed: 0.0622s/iter; left time: 2395.5705s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0650s/iter; left time: 2497.6600s
Epoch: 7 cost time: 28.195515632629395
Epoch: 7, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.249 Vali Acc: 0.971 Test Loss: 0.249 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000003
	speed: 0.2363s/iter; left time: 9053.6724s
	iters: 200, epoch: 8 | loss: 0.6576722
	speed: 0.0649s/iter; left time: 2479.2909s
	iters: 300, epoch: 8 | loss: 0.0004455
	speed: 0.0647s/iter; left time: 2464.6116s
	iters: 400, epoch: 8 | loss: 0.2321383
	speed: 0.0628s/iter; left time: 2388.0963s
Epoch: 8 cost time: 27.21845769882202
Epoch: 8, Steps: 413 | Train Loss: 0.159 Vali Loss: 0.380 Vali Acc: 0.958 Test Loss: 0.380 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000022
	speed: 0.2544s/iter; left time: 9640.6996s
	iters: 200, epoch: 9 | loss: 0.2193593
	speed: 0.0681s/iter; left time: 2572.9857s
	iters: 300, epoch: 9 | loss: 0.0662054
	speed: 0.0674s/iter; left time: 2539.2977s
	iters: 400, epoch: 9 | loss: 0.7465976
	speed: 0.0686s/iter; left time: 2577.7787s
Epoch: 9 cost time: 29.633134126663208
Epoch: 9, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.318 Vali Acc: 0.956 Test Loss: 0.318 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000011
	speed: 0.2239s/iter; left time: 8392.0404s
	iters: 200, epoch: 10 | loss: 0.0000113
	speed: 0.0510s/iter; left time: 1908.0379s
	iters: 300, epoch: 10 | loss: 0.0609035
	speed: 0.0540s/iter; left time: 2012.6143s
	iters: 400, epoch: 10 | loss: 0.0000063
	speed: 0.0491s/iter; left time: 1823.9985s
Epoch: 10 cost time: 23.761475086212158
Epoch: 10, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.291 Vali Acc: 0.968 Test Loss: 0.291 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0904307
	speed: 0.2160s/iter; left time: 8009.0559s
	iters: 200, epoch: 11 | loss: 0.0000011
	speed: 0.0503s/iter; left time: 1860.3437s
	iters: 300, epoch: 11 | loss: 0.0988623
	speed: 0.0522s/iter; left time: 1925.5229s
	iters: 400, epoch: 11 | loss: 0.0000237
	speed: 0.0494s/iter; left time: 1818.2605s
Epoch: 11 cost time: 21.639222621917725
Epoch: 11, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.330 Vali Acc: 0.970 Test Loss: 0.330 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2080s/iter; left time: 7626.0238s
	iters: 200, epoch: 12 | loss: 0.0000329
	speed: 0.0449s/iter; left time: 1643.1493s
	iters: 300, epoch: 12 | loss: 0.4062656
	speed: 0.0453s/iter; left time: 1653.3153s
	iters: 400, epoch: 12 | loss: 0.0000008
	speed: 0.0467s/iter; left time: 1697.1395s
Epoch: 12 cost time: 20.60142207145691
Epoch: 12, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.499 Vali Acc: 0.961 Test Loss: 0.499 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm128_nh16_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9722601182355616
model parameter : 286090
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0727956
	speed: 0.0918s/iter; left time: 3780.3015s
	iters: 200, epoch: 1 | loss: 0.7175555
	speed: 0.0600s/iter; left time: 2465.5625s
	iters: 300, epoch: 1 | loss: 1.6766585
	speed: 0.0559s/iter; left time: 2292.2827s
	iters: 400, epoch: 1 | loss: 0.0203413
	speed: 0.0605s/iter; left time: 2474.5176s
Epoch: 1 cost time: 27.93347144126892
Epoch: 1, Steps: 413 | Train Loss: 0.441 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
Validation loss decreased (inf --> -0.946337).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0483304
	speed: 0.2458s/iter; left time: 10025.6635s
	iters: 200, epoch: 2 | loss: 0.0248947
	speed: 0.0607s/iter; left time: 2471.0840s
	iters: 300, epoch: 2 | loss: 0.2243519
	speed: 0.0557s/iter; left time: 2260.4496s
	iters: 400, epoch: 2 | loss: 0.0024912
	speed: 0.0555s/iter; left time: 2246.2348s
Epoch: 2 cost time: 25.309459924697876
Epoch: 2, Steps: 413 | Train Loss: 0.175 Vali Loss: 0.332 Vali Acc: 0.932 Test Loss: 0.332 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000978
	speed: 0.2270s/iter; left time: 9163.7266s
	iters: 200, epoch: 3 | loss: 0.0453560
	speed: 0.0608s/iter; left time: 2449.1831s
	iters: 300, epoch: 3 | loss: 0.0022327
	speed: 0.0538s/iter; left time: 2160.6525s
	iters: 400, epoch: 3 | loss: 0.6866313
	speed: 0.0543s/iter; left time: 2177.0294s
Epoch: 3 cost time: 24.584928274154663
Epoch: 3, Steps: 413 | Train Loss: 0.161 Vali Loss: 0.374 Vali Acc: 0.952 Test Loss: 0.374 Test Acc: 0.952
Validation loss decreased (-0.946337 --> -0.951793).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.2254s/iter; left time: 9006.1833s
	iters: 200, epoch: 4 | loss: 0.0000001
	speed: 0.0704s/iter; left time: 2807.3811s
	iters: 300, epoch: 4 | loss: 0.5052982
	speed: 0.0679s/iter; left time: 2701.3595s
	iters: 400, epoch: 4 | loss: 0.0522195
	speed: 0.0718s/iter; left time: 2849.0765s
Epoch: 4 cost time: 29.50496745109558
Epoch: 4, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.358 Vali Acc: 0.967 Test Loss: 0.358 Test Acc: 0.967
Validation loss decreased (-0.951793 --> -0.967254).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.2493s/iter; left time: 9858.6097s
	iters: 200, epoch: 5 | loss: 0.2780360
	speed: 0.0667s/iter; left time: 2630.9882s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 2733.0327s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0714s/iter; left time: 2800.7079s
Epoch: 5 cost time: 29.301173210144043
Epoch: 5, Steps: 413 | Train Loss: 0.183 Vali Loss: 0.435 Vali Acc: 0.949 Test Loss: 0.435 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2612s/iter; left time: 10221.6718s
	iters: 200, epoch: 6 | loss: 0.8567741
	speed: 0.0707s/iter; left time: 2759.8753s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0723s/iter; left time: 2814.9269s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 2871.7577s
Epoch: 6 cost time: 30.552024126052856
Epoch: 6, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.505 Vali Acc: 0.959 Test Loss: 0.505 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2593s/iter; left time: 10042.5610s
	iters: 200, epoch: 7 | loss: 0.0711595
	speed: 0.0715s/iter; left time: 2761.5435s
	iters: 300, epoch: 7 | loss: 0.0001259
	speed: 0.0791s/iter; left time: 3045.5600s
	iters: 400, epoch: 7 | loss: 0.0000195
	speed: 0.0772s/iter; left time: 2966.1901s
Epoch: 7 cost time: 31.459859132766724
Epoch: 7, Steps: 413 | Train Loss: 0.161 Vali Loss: 0.712 Vali Acc: 0.948 Test Loss: 0.712 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0003454
	speed: 0.2649s/iter; left time: 10147.0493s
	iters: 200, epoch: 8 | loss: 0.2369080
	speed: 0.0781s/iter; left time: 2983.1725s
	iters: 300, epoch: 8 | loss: 0.1043616
	speed: 0.0943s/iter; left time: 3594.6195s
	iters: 400, epoch: 8 | loss: 0.0367926
	speed: 0.0920s/iter; left time: 3498.5509s
Epoch: 8 cost time: 37.06133580207825
Epoch: 8, Steps: 413 | Train Loss: 0.148 Vali Loss: 0.754 Vali Acc: 0.957 Test Loss: 0.754 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.2758s/iter; left time: 10451.5327s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0855s/iter; left time: 3233.2725s
	iters: 300, epoch: 9 | loss: 0.0056315
	speed: 0.0996s/iter; left time: 3753.4202s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 3261.0246s
Epoch: 9 cost time: 37.700703859329224
Epoch: 9, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.529 Vali Acc: 0.967 Test Loss: 0.529 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.4661594
	speed: 0.2690s/iter; left time: 10082.7983s
	iters: 200, epoch: 10 | loss: 0.0154349
	speed: 0.0852s/iter; left time: 3184.7129s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 3333.5761s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0745s/iter; left time: 2768.8753s
Epoch: 10 cost time: 35.092469215393066
Epoch: 10, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.952 Vali Acc: 0.955 Test Loss: 0.952 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2525s/iter; left time: 9359.9536s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0755s/iter; left time: 2792.1402s
	iters: 300, epoch: 11 | loss: 0.0000003
	speed: 0.0797s/iter; left time: 2938.5410s
	iters: 400, epoch: 11 | loss: 0.0000004
	speed: 0.0595s/iter; left time: 2188.5621s
Epoch: 11 cost time: 29.48200297355652
Epoch: 11, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.768 Vali Acc: 0.954 Test Loss: 0.768 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2346s/iter; left time: 8598.2713s
	iters: 200, epoch: 12 | loss: 0.0489194
	speed: 0.0821s/iter; left time: 2999.8603s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0640s/iter; left time: 2333.7703s
	iters: 400, epoch: 12 | loss: 0.0004130
	speed: 0.0561s/iter; left time: 2041.3872s
Epoch: 12 cost time: 28.508078575134277
Epoch: 12, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.643 Vali Acc: 0.965 Test Loss: 0.643 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2392s/iter; left time: 8670.7208s
	iters: 200, epoch: 13 | loss: 0.0000684
	speed: 0.0595s/iter; left time: 2151.3011s
	iters: 300, epoch: 13 | loss: 0.2151855
	speed: 0.0561s/iter; left time: 2023.4278s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0607s/iter; left time: 2181.2120s
Epoch: 13 cost time: 25.145753622055054
Epoch: 13, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.912 Vali Acc: 0.961 Test Loss: 0.912 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0003336
	speed: 0.2358s/iter; left time: 8449.1757s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 1942.9341s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 1896.1415s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 2174.7178s
Epoch: 14 cost time: 24.89603567123413
Epoch: 14, Steps: 413 | Train Loss: 0.134 Vali Loss: 0.749 Vali Acc: 0.967 Test Loss: 0.749 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9672578444747613
model parameter : 491338
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2975050
	speed: 0.0952s/iter; left time: 3921.9632s
	iters: 200, epoch: 1 | loss: 0.0032419
	speed: 0.0518s/iter; left time: 2131.0364s
	iters: 300, epoch: 1 | loss: 0.0275831
	speed: 0.0586s/iter; left time: 2403.9696s
	iters: 400, epoch: 1 | loss: 0.0002348
	speed: 0.0555s/iter; left time: 2270.2186s
Epoch: 1 cost time: 27.05333375930786
Epoch: 1, Steps: 413 | Train Loss: 0.354 Vali Loss: 0.332 Vali Acc: 0.932 Test Loss: 0.332 Test Acc: 0.932
Validation loss decreased (inf --> -0.931784).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0002231
	speed: 0.2327s/iter; left time: 9491.6037s
	iters: 200, epoch: 2 | loss: 0.0005984
	speed: 0.0609s/iter; left time: 2476.6753s
	iters: 300, epoch: 2 | loss: 0.0000012
	speed: 0.0562s/iter; left time: 2279.7723s
	iters: 400, epoch: 2 | loss: 0.6128654
	speed: 0.0543s/iter; left time: 2197.2456s
Epoch: 2 cost time: 23.90669322013855
Epoch: 2, Steps: 413 | Train Loss: 0.165 Vali Loss: 0.219 Vali Acc: 0.955 Test Loss: 0.219 Test Acc: 0.955
Validation loss decreased (-0.931784 --> -0.955432).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2060032
	speed: 0.2392s/iter; left time: 9656.7358s
	iters: 200, epoch: 3 | loss: 0.3225426
	speed: 0.0538s/iter; left time: 2167.5878s
	iters: 300, epoch: 3 | loss: 0.0138159
	speed: 0.0799s/iter; left time: 3211.1049s
	iters: 400, epoch: 3 | loss: 0.1179187
	speed: 0.0868s/iter; left time: 3479.4274s
Epoch: 3 cost time: 30.70879602432251
Epoch: 3, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.346 Vali Acc: 0.956 Test Loss: 0.346 Test Acc: 0.956
Validation loss decreased (-0.955432 --> -0.956340).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.2413s/iter; left time: 9644.5831s
	iters: 200, epoch: 4 | loss: 0.0001128
	speed: 0.0755s/iter; left time: 3010.6070s
	iters: 300, epoch: 4 | loss: 0.0000133
	speed: 0.0744s/iter; left time: 2958.2438s
	iters: 400, epoch: 4 | loss: 0.0000075
	speed: 0.0722s/iter; left time: 2862.8109s
Epoch: 4 cost time: 30.5846266746521
Epoch: 4, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.808 Vali Acc: 0.906 Test Loss: 0.808 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000300
	speed: 0.2298s/iter; left time: 9090.0208s
	iters: 200, epoch: 5 | loss: 0.0001549
	speed: 0.0724s/iter; left time: 2854.4843s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 2819.1641s
	iters: 400, epoch: 5 | loss: 0.0000013
	speed: 0.0702s/iter; left time: 2754.8246s
Epoch: 5 cost time: 30.363131046295166
Epoch: 5, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.771 Vali Acc: 0.936 Test Loss: 0.771 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000446
	speed: 0.2203s/iter; left time: 8621.1795s
	iters: 200, epoch: 6 | loss: 0.0053525
	speed: 0.0727s/iter; left time: 2837.6283s
	iters: 300, epoch: 6 | loss: 0.0000200
	speed: 0.0691s/iter; left time: 2691.0900s
	iters: 400, epoch: 6 | loss: 0.2904296
	speed: 0.0704s/iter; left time: 2734.6412s
Epoch: 6 cost time: 30.281229734420776
Epoch: 6, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.638 Vali Acc: 0.946 Test Loss: 0.638 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2338s/iter; left time: 9054.5943s
	iters: 200, epoch: 7 | loss: 0.0057617
	speed: 0.0707s/iter; left time: 2730.4556s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 2566.4487s
	iters: 400, epoch: 7 | loss: 0.0047235
	speed: 0.0724s/iter; left time: 2782.0190s
Epoch: 7 cost time: 29.98645329475403
Epoch: 7, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.671 Vali Acc: 0.959 Test Loss: 0.671 Test Acc: 0.959
Validation loss decreased (-0.956340 --> -0.959066).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2458s/iter; left time: 9418.2493s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0787s/iter; left time: 3006.9483s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0742s/iter; left time: 2826.5787s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0718s/iter; left time: 2729.2585s
Epoch: 8 cost time: 32.056228160858154
Epoch: 8, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.826 Vali Acc: 0.948 Test Loss: 0.826 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0001144
	speed: 0.2436s/iter; left time: 9233.0484s
	iters: 200, epoch: 9 | loss: 1.1741600
	speed: 0.0724s/iter; left time: 2736.7848s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 2862.1166s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0767s/iter; left time: 2882.1143s
Epoch: 9 cost time: 31.783161401748657
Epoch: 9, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.573 Vali Acc: 0.962 Test Loss: 0.573 Test Acc: 0.962
Validation loss decreased (-0.959066 --> -0.962250).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0001987
	speed: 0.2128s/iter; left time: 7975.1816s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0463s/iter; left time: 1730.2489s
	iters: 300, epoch: 10 | loss: 0.0000033
	speed: 0.0511s/iter; left time: 1904.7075s
	iters: 400, epoch: 10 | loss: 0.0000105
	speed: 0.0492s/iter; left time: 1828.9956s
Epoch: 10 cost time: 21.715790271759033
Epoch: 10, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.487 Vali Acc: 0.960 Test Loss: 0.487 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2162s/iter; left time: 8014.8616s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 1951.8579s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 1926.0179s
	iters: 400, epoch: 11 | loss: 0.7629170
	speed: 0.0505s/iter; left time: 1856.8436s
Epoch: 11 cost time: 22.581021547317505
Epoch: 11, Steps: 413 | Train Loss: 0.073 Vali Loss: 1.389 Vali Acc: 0.935 Test Loss: 1.389 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.2162s/iter; left time: 7926.0511s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 1965.0098s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 2098.7880s
	iters: 400, epoch: 12 | loss: 0.0018561
	speed: 0.0536s/iter; left time: 1947.6122s
Epoch: 12 cost time: 23.31434988975525
Epoch: 12, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.896 Vali Acc: 0.961 Test Loss: 0.896 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2116s/iter; left time: 7668.4091s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.0532s/iter; left time: 1923.4397s
	iters: 300, epoch: 13 | loss: 0.5402709
	speed: 0.0481s/iter; left time: 1734.5786s
	iters: 400, epoch: 13 | loss: 0.0000002
	speed: 0.0521s/iter; left time: 1871.4540s
Epoch: 13 cost time: 21.531916856765747
Epoch: 13, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.628 Vali Acc: 0.967 Test Loss: 0.628 Test Acc: 0.967
Validation loss decreased (-0.962250 --> -0.966797).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2131s/iter; left time: 7636.9964s
	iters: 200, epoch: 14 | loss: 0.0000005
	speed: 0.0512s/iter; left time: 1830.9591s
	iters: 300, epoch: 14 | loss: 0.0000022
	speed: 0.0570s/iter; left time: 2032.2159s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0536s/iter; left time: 1903.8685s
Epoch: 14 cost time: 22.79793667793274
Epoch: 14, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.718 Vali Acc: 0.970 Test Loss: 0.718 Test Acc: 0.970
Validation loss decreased (-0.966797 --> -0.969524).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2053s/iter; left time: 7270.8930s
	iters: 200, epoch: 15 | loss: 0.0000032
	speed: 0.0479s/iter; left time: 1690.1252s
	iters: 300, epoch: 15 | loss: 0.0000131
	speed: 0.0565s/iter; left time: 1989.9005s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 1845.3205s
Epoch: 15 cost time: 21.899300813674927
Epoch: 15, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.733 Vali Acc: 0.970 Test Loss: 0.733 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2073s/iter; left time: 7255.5278s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0562s/iter; left time: 1960.5439s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0453s/iter; left time: 1577.3826s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 1867.6065s
Epoch: 16 cost time: 22.621466636657715
Epoch: 16, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.612 Vali Acc: 0.973 Test Loss: 0.612 Test Acc: 0.973
Validation loss decreased (-0.969524 --> -0.973164).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.5842402
	speed: 0.2224s/iter; left time: 7694.8808s
	iters: 200, epoch: 17 | loss: 0.0000038
	speed: 0.0688s/iter; left time: 2373.1222s
	iters: 300, epoch: 17 | loss: 0.0000282
	speed: 0.0681s/iter; left time: 2340.5057s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0715s/iter; left time: 2452.1946s
Epoch: 17 cost time: 29.75611686706543
Epoch: 17, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.542 Vali Acc: 0.970 Test Loss: 0.542 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2109s/iter; left time: 7208.6017s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0639s/iter; left time: 2176.6059s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0661s/iter; left time: 2247.3206s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0746s/iter; left time: 2526.6815s
Epoch: 18 cost time: 28.621227979660034
Epoch: 18, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.709 Vali Acc: 0.967 Test Loss: 0.709 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000143
	speed: 0.2085s/iter; left time: 7038.8573s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0663s/iter; left time: 2230.5607s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0732s/iter; left time: 2458.3509s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0743s/iter; left time: 2485.1783s
Epoch: 19 cost time: 30.397175073623657
Epoch: 19, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.902 Vali Acc: 0.959 Test Loss: 0.902 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2358s/iter; left time: 7865.5663s
	iters: 200, epoch: 20 | loss: 0.0758402
	speed: 0.0723s/iter; left time: 2405.6716s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0669s/iter; left time: 2216.5890s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0719s/iter; left time: 2376.1800s
Epoch: 20 cost time: 30.068029642105103
Epoch: 20, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.724 Vali Acc: 0.967 Test Loss: 0.724 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2357s/iter; left time: 7764.8253s
	iters: 200, epoch: 21 | loss: 0.0833338
	speed: 0.0747s/iter; left time: 2451.8686s
	iters: 300, epoch: 21 | loss: 0.4362121
	speed: 0.0752s/iter; left time: 2460.8762s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0703s/iter; left time: 2293.8662s
Epoch: 21 cost time: 31.02902364730835
Epoch: 21, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.730 Vali Acc: 0.967 Test Loss: 0.730 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2293s/iter; left time: 7459.7597s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 2377.3467s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0747s/iter; left time: 2414.9963s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 2260.9402s
Epoch: 22 cost time: 30.593034029006958
Epoch: 22, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.666 Vali Acc: 0.969 Test Loss: 0.666 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2302s/iter; left time: 7394.2754s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0483s/iter; left time: 1547.2727s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0550s/iter; left time: 1756.8811s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 1735.2494s
Epoch: 23 cost time: 23.779070377349854
Epoch: 23, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.629 Vali Acc: 0.971 Test Loss: 0.629 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2145s/iter; left time: 6798.5255s
	iters: 200, epoch: 24 | loss: 0.1902824
	speed: 0.0512s/iter; left time: 1616.7095s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 1539.1220s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 1579.3154s
Epoch: 24 cost time: 22.09312915802002
Epoch: 24, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.563 Vali Acc: 0.968 Test Loss: 0.563 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2080s/iter; left time: 6509.0039s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 1717.4784s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 1615.5047s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 1528.8850s
Epoch: 25 cost time: 21.972630977630615
Epoch: 25, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.480 Vali Acc: 0.977 Test Loss: 0.480 Test Acc: 0.977
Validation loss decreased (-0.973164 --> -0.977258).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1833s/iter; left time: 5660.0608s
	iters: 200, epoch: 26 | loss: 1.3174160
	speed: 0.0471s/iter; left time: 1450.3418s
	iters: 300, epoch: 26 | loss: 0.0000023
	speed: 0.0470s/iter; left time: 1441.2980s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 1521.7277s
Epoch: 26 cost time: 20.61353874206543
Epoch: 26, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.640 Vali Acc: 0.968 Test Loss: 0.640 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1911s/iter; left time: 5820.6216s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 1505.0599s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 1660.7766s
	iters: 400, epoch: 27 | loss: 0.2082609
	speed: 0.0436s/iter; left time: 1314.7155s
Epoch: 27 cost time: 21.15917205810547
Epoch: 27, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.681 Vali Acc: 0.971 Test Loss: 0.681 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1963s/iter; left time: 5900.2552s
	iters: 200, epoch: 28 | loss: 0.0066425
	speed: 0.0497s/iter; left time: 1487.1219s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 1502.8724s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0502s/iter; left time: 1492.0733s
Epoch: 28 cost time: 21.52951693534851
Epoch: 28, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.649 Vali Acc: 0.967 Test Loss: 0.649 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2049s/iter; left time: 6071.5570s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 1556.7278s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0543s/iter; left time: 1597.9597s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0475s/iter; left time: 1393.0255s
Epoch: 29 cost time: 22.11720871925354
Epoch: 29, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.659 Vali Acc: 0.966 Test Loss: 0.659 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1963s/iter; left time: 5736.8881s
	iters: 200, epoch: 30 | loss: 0.0000003
	speed: 0.0502s/iter; left time: 1462.0542s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0613s/iter; left time: 1778.9121s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0721s/iter; left time: 2084.4455s
Epoch: 30 cost time: 24.730414152145386
Epoch: 30, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.784 Vali Acc: 0.968 Test Loss: 0.784 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2260s/iter; left time: 6511.2017s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 2124.6450s
	iters: 300, epoch: 31 | loss: 0.2382520
	speed: 0.0684s/iter; left time: 1957.5347s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 1887.9370s
Epoch: 31 cost time: 29.762216567993164
Epoch: 31, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.808 Vali Acc: 0.966 Test Loss: 0.808 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2402s/iter; left time: 6822.2159s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0774s/iter; left time: 2190.4582s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 2302.6372s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0835s/iter; left time: 2345.8309s
Epoch: 32 cost time: 33.519155979156494
Epoch: 32, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.752 Vali Acc: 0.972 Test Loss: 0.752 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2704s/iter; left time: 7568.4769s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0775s/iter; left time: 2161.1427s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 2036.6145s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0761s/iter; left time: 2105.6198s
Epoch: 33 cost time: 32.58042550086975
Epoch: 33, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.691 Vali Acc: 0.972 Test Loss: 0.691 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2614s/iter; left time: 7206.4243s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 2387.8227s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 2262.6612s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 1944.5988s
Epoch: 34 cost time: 34.487600326538086
Epoch: 34, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.625 Vali Acc: 0.974 Test Loss: 0.625 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0000011
	speed: 0.2336s/iter; left time: 6343.0852s
	iters: 200, epoch: 35 | loss: 2.5072751
	speed: 0.0706s/iter; left time: 1909.2522s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 1892.1787s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0653s/iter; left time: 1753.0730s
Epoch: 35 cost time: 29.68310546875
Epoch: 35, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.688 Vali Acc: 0.971 Test Loss: 0.688 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.977262391996362
model parameter : 358346
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1050391
	speed: 0.0941s/iter; left time: 3878.5255s
	iters: 200, epoch: 1 | loss: 0.1371234
	speed: 0.0477s/iter; left time: 1960.2616s
	iters: 300, epoch: 1 | loss: 0.3282017
	speed: 0.0550s/iter; left time: 2256.5657s
	iters: 400, epoch: 1 | loss: 0.0055870
	speed: 0.0530s/iter; left time: 2167.7394s
Epoch: 1 cost time: 25.799087524414062
Epoch: 1, Steps: 413 | Train Loss: 0.365 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (inf --> -0.962254).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2885448
	speed: 0.2017s/iter; left time: 8227.8242s
	iters: 200, epoch: 2 | loss: 0.0268863
	speed: 0.0535s/iter; left time: 2176.6742s
	iters: 300, epoch: 2 | loss: 0.0054382
	speed: 0.0519s/iter; left time: 2107.5859s
	iters: 400, epoch: 2 | loss: 0.0060481
	speed: 0.0601s/iter; left time: 2434.0453s
Epoch: 2 cost time: 22.89362907409668
Epoch: 2, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0001185
	speed: 0.2139s/iter; left time: 8636.5134s
	iters: 200, epoch: 3 | loss: 0.9844509
	speed: 0.0465s/iter; left time: 1873.0694s
	iters: 300, epoch: 3 | loss: 0.0027032
	speed: 0.0488s/iter; left time: 1960.0161s
	iters: 400, epoch: 3 | loss: 0.0004411
	speed: 0.0485s/iter; left time: 1944.4642s
Epoch: 3 cost time: 21.116015434265137
Epoch: 3, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.196 Vali Acc: 0.964 Test Loss: 0.196 Test Acc: 0.964
Validation loss decreased (-0.962254 --> -0.963618).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0213794
	speed: 0.1961s/iter; left time: 7835.1735s
	iters: 200, epoch: 4 | loss: 0.0000001
	speed: 0.0474s/iter; left time: 1889.4875s
	iters: 300, epoch: 4 | loss: 0.0648540
	speed: 0.0420s/iter; left time: 1668.8622s
	iters: 400, epoch: 4 | loss: 0.0072922
	speed: 0.0494s/iter; left time: 1958.8966s
Epoch: 4 cost time: 19.64030933380127
Epoch: 4, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.287 Vali Acc: 0.964 Test Loss: 0.287 Test Acc: 0.964
Validation loss decreased (-0.963618 --> -0.964072).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000001
	speed: 0.2004s/iter; left time: 7924.7085s
	iters: 200, epoch: 5 | loss: 0.0020164
	speed: 0.0544s/iter; left time: 2147.2803s
	iters: 300, epoch: 5 | loss: 0.0010027
	speed: 0.0575s/iter; left time: 2263.4685s
	iters: 400, epoch: 5 | loss: 0.0000207
	speed: 0.0574s/iter; left time: 2251.7230s
Epoch: 5 cost time: 23.493982315063477
Epoch: 5, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.344 Vali Acc: 0.963 Test Loss: 0.344 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000005
	speed: 0.2348s/iter; left time: 9189.8123s
	iters: 200, epoch: 6 | loss: 0.0621221
	speed: 0.0568s/iter; left time: 2216.2678s
	iters: 300, epoch: 6 | loss: 0.1197082
	speed: 0.0540s/iter; left time: 2102.6766s
	iters: 400, epoch: 6 | loss: 0.2401791
	speed: 0.0545s/iter; left time: 2116.9673s
Epoch: 6 cost time: 24.150200366973877
Epoch: 6, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.151 Vali Acc: 0.980 Test Loss: 0.151 Test Acc: 0.980
Validation loss decreased (-0.964072 --> -0.979535).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0235397
	speed: 0.2176s/iter; left time: 8428.0231s
	iters: 200, epoch: 7 | loss: 0.0000153
	speed: 0.0497s/iter; left time: 1920.5175s
	iters: 300, epoch: 7 | loss: 0.0001407
	speed: 0.0518s/iter; left time: 1995.5571s
	iters: 400, epoch: 7 | loss: 0.0000593
	speed: 0.0482s/iter; left time: 1853.3331s
Epoch: 7 cost time: 21.888970851898193
Epoch: 7, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.297 Vali Acc: 0.968 Test Loss: 0.297 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1434209
	speed: 0.2264s/iter; left time: 8672.0969s
	iters: 200, epoch: 8 | loss: 0.0061149
	speed: 0.0642s/iter; left time: 2451.8553s
	iters: 300, epoch: 8 | loss: 0.0058062
	speed: 0.0663s/iter; left time: 2525.9152s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0635s/iter; left time: 2415.4352s
Epoch: 8 cost time: 28.393972158432007
Epoch: 8, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.360 Vali Acc: 0.969 Test Loss: 0.360 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2350s/iter; left time: 8905.9554s
	iters: 200, epoch: 9 | loss: 0.0009401
	speed: 0.0665s/iter; left time: 2514.4902s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 2591.2346s
	iters: 400, epoch: 9 | loss: 0.0497122
	speed: 0.0696s/iter; left time: 2617.5783s
Epoch: 9 cost time: 29.12583065032959
Epoch: 9, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2348190
	speed: 0.2185s/iter; left time: 8191.5183s
	iters: 200, epoch: 10 | loss: 1.4493563
	speed: 0.0623s/iter; left time: 2330.2394s
	iters: 300, epoch: 10 | loss: 1.0978031
	speed: 0.0648s/iter; left time: 2415.9336s
	iters: 400, epoch: 10 | loss: 0.5030394
	speed: 0.0577s/iter; left time: 2144.9367s
Epoch: 10 cost time: 26.285990476608276
Epoch: 10, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.399 Vali Acc: 0.973 Test Loss: 0.399 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2189s/iter; left time: 8113.3773s
	iters: 200, epoch: 11 | loss: 0.0001141
	speed: 0.0707s/iter; left time: 2615.0217s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0715s/iter; left time: 2635.4672s
	iters: 400, epoch: 11 | loss: 0.9940701
	speed: 0.0654s/iter; left time: 2405.9552s
Epoch: 11 cost time: 28.988862991333008
Epoch: 11, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.433 Vali Acc: 0.970 Test Loss: 0.433 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0005672
	speed: 0.2355s/iter; left time: 8631.8189s
	iters: 200, epoch: 12 | loss: 0.9168302
	speed: 0.0679s/iter; left time: 2483.9103s
	iters: 300, epoch: 12 | loss: 0.3936998
	speed: 0.0705s/iter; left time: 2569.6303s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0680s/iter; left time: 2472.3835s
Epoch: 12 cost time: 29.949580430984497
Epoch: 12, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.362 Vali Acc: 0.971 Test Loss: 0.362 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0009554
	speed: 0.2374s/iter; left time: 8603.7275s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 2211.9673s
	iters: 300, epoch: 13 | loss: 0.0010002
	speed: 0.0649s/iter; left time: 2337.5879s
	iters: 400, epoch: 13 | loss: 0.0000444
	speed: 0.0691s/iter; left time: 2484.3987s
Epoch: 13 cost time: 28.0843288898468
Epoch: 13, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.414 Vali Acc: 0.969 Test Loss: 0.414 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2168s/iter; left time: 7767.4463s
	iters: 200, epoch: 14 | loss: 0.0002545
	speed: 0.0465s/iter; left time: 1661.5695s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 1752.4112s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0469s/iter; left time: 1664.8410s
Epoch: 14 cost time: 21.453609466552734
Epoch: 14, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.358 Vali Acc: 0.978 Test Loss: 0.358 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000031
	speed: 0.2104s/iter; left time: 7451.9693s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 1831.5804s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 1653.9404s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 1691.1788s
Epoch: 15 cost time: 21.037739753723145
Epoch: 15, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.321 Vali Acc: 0.978 Test Loss: 0.321 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2206s/iter; left time: 7720.9779s
	iters: 200, epoch: 16 | loss: 0.0004423
	speed: 0.0514s/iter; left time: 1793.8565s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1765.7610s
	iters: 400, epoch: 16 | loss: 0.0026402
	speed: 0.0477s/iter; left time: 1655.4812s
Epoch: 16 cost time: 22.28342032432556
Epoch: 16, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.478 Vali Acc: 0.977 Test Loss: 0.478 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 291914
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3718972
	speed: 0.0837s/iter; left time: 3447.3489s
	iters: 200, epoch: 1 | loss: 0.3267166
	speed: 0.0482s/iter; left time: 1979.3866s
	iters: 300, epoch: 1 | loss: 0.0734624
	speed: 0.0472s/iter; left time: 1934.0886s
	iters: 400, epoch: 1 | loss: 0.0522722
	speed: 0.0472s/iter; left time: 1929.6628s
Epoch: 1 cost time: 23.21580410003662
Epoch: 1, Steps: 413 | Train Loss: 0.346 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
Validation loss decreased (inf --> -0.949066).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0284137
	speed: 0.2011s/iter; left time: 8203.1237s
	iters: 200, epoch: 2 | loss: 0.1745503
	speed: 0.0449s/iter; left time: 1827.8601s
	iters: 300, epoch: 2 | loss: 0.0207784
	speed: 0.0441s/iter; left time: 1791.3855s
	iters: 400, epoch: 2 | loss: 0.0086170
	speed: 0.0449s/iter; left time: 1816.9261s
Epoch: 2 cost time: 19.67047953605652
Epoch: 2, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
Validation loss decreased (-0.949066 --> -0.962709).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0144610
	speed: 0.2067s/iter; left time: 8343.8439s
	iters: 200, epoch: 3 | loss: 0.0139559
	speed: 0.0487s/iter; left time: 1961.2048s
	iters: 300, epoch: 3 | loss: 0.0049088
	speed: 0.0654s/iter; left time: 2628.7275s
	iters: 400, epoch: 3 | loss: 0.0002015
	speed: 0.0756s/iter; left time: 3029.1044s
Epoch: 3 cost time: 26.1230685710907
Epoch: 3, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.183 Vali Acc: 0.971 Test Loss: 0.183 Test Acc: 0.971
Validation loss decreased (-0.962709 --> -0.970894).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0009509
	speed: 0.2590s/iter; left time: 10349.3331s
	iters: 200, epoch: 4 | loss: 0.0001151
	speed: 0.0685s/iter; left time: 2730.6146s
	iters: 300, epoch: 4 | loss: 0.0205740
	speed: 0.0715s/iter; left time: 2844.4976s
	iters: 400, epoch: 4 | loss: 0.1791076
	speed: 0.0723s/iter; left time: 2868.8947s
Epoch: 4 cost time: 30.09933352470398
Epoch: 4, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.376 Vali Acc: 0.955 Test Loss: 0.376 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000292
	speed: 0.2573s/iter; left time: 10174.3854s
	iters: 200, epoch: 5 | loss: 0.3179236
	speed: 0.0673s/iter; left time: 2654.4203s
	iters: 300, epoch: 5 | loss: 0.0000065
	speed: 0.0655s/iter; left time: 2576.9865s
	iters: 400, epoch: 5 | loss: 0.3448121
	speed: 0.0666s/iter; left time: 2612.1613s
Epoch: 5 cost time: 29.12554407119751
Epoch: 5, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.222 Vali Acc: 0.970 Test Loss: 0.222 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0004746
	speed: 0.2388s/iter; left time: 9345.5110s
	iters: 200, epoch: 6 | loss: 0.0019876
	speed: 0.0695s/iter; left time: 2714.5052s
	iters: 300, epoch: 6 | loss: 0.0000343
	speed: 0.0662s/iter; left time: 2577.1039s
	iters: 400, epoch: 6 | loss: 0.0405087
	speed: 0.0690s/iter; left time: 2678.4438s
Epoch: 6 cost time: 29.336029291152954
Epoch: 6, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.181 Vali Acc: 0.978 Test Loss: 0.181 Test Acc: 0.978
Validation loss decreased (-0.970894 --> -0.977715).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0038409
	speed: 0.2504s/iter; left time: 9695.3257s
	iters: 200, epoch: 7 | loss: 0.0000012
	speed: 0.0710s/iter; left time: 2743.6373s
	iters: 300, epoch: 7 | loss: 0.0121096
	speed: 0.0650s/iter; left time: 2502.9038s
	iters: 400, epoch: 7 | loss: 0.0000049
	speed: 0.0648s/iter; left time: 2489.8951s
Epoch: 7 cost time: 28.870787858963013
Epoch: 7, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.271 Vali Acc: 0.970 Test Loss: 0.271 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0301874
	speed: 0.2311s/iter; left time: 8851.6207s
	iters: 200, epoch: 8 | loss: 0.0000044
	speed: 0.0652s/iter; left time: 2493.0183s
	iters: 300, epoch: 8 | loss: 0.4440293
	speed: 0.0673s/iter; left time: 2565.0026s
	iters: 400, epoch: 8 | loss: 0.0000009
	speed: 0.0669s/iter; left time: 2542.8854s
Epoch: 8 cost time: 28.40441918373108
Epoch: 8, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.309 Vali Acc: 0.964 Test Loss: 0.309 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000003
	speed: 0.2240s/iter; left time: 8488.4550s
	iters: 200, epoch: 9 | loss: 0.5643103
	speed: 0.0500s/iter; left time: 1891.4376s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1713.1959s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 1729.9204s
Epoch: 9 cost time: 22.05831241607666
Epoch: 9, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.181 Vali Acc: 0.977 Test Loss: 0.181 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2107s/iter; left time: 7897.2693s
	iters: 200, epoch: 10 | loss: 0.8901191
	speed: 0.0436s/iter; left time: 1630.3915s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 1612.4937s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 1674.0755s
Epoch: 10 cost time: 19.394935607910156
Epoch: 10, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.312 Vali Acc: 0.973 Test Loss: 0.312 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2203s/iter; left time: 8166.8519s
	iters: 200, epoch: 11 | loss: 0.0000031
	speed: 0.0494s/iter; left time: 1827.4580s
	iters: 300, epoch: 11 | loss: 0.0000002
	speed: 0.0519s/iter; left time: 1914.4182s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 1940.1191s
Epoch: 11 cost time: 21.8130099773407
Epoch: 11, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.323 Vali Acc: 0.970 Test Loss: 0.323 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2216s/iter; left time: 8122.7376s
	iters: 200, epoch: 12 | loss: 0.0001648
	speed: 0.0558s/iter; left time: 2038.1204s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0511s/iter; left time: 1864.2997s
	iters: 400, epoch: 12 | loss: 0.0001724
	speed: 0.0482s/iter; left time: 1753.9183s
Epoch: 12 cost time: 21.992345571517944
Epoch: 12, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.212 Vali Acc: 0.979 Test Loss: 0.212 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979079).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0107820
	speed: 0.2321s/iter; left time: 8412.6595s
	iters: 200, epoch: 13 | loss: 0.0060936
	speed: 0.0537s/iter; left time: 1939.5382s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 2014.4384s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 1637.7328s
Epoch: 13 cost time: 22.574188470840454
Epoch: 13, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.274 Vali Acc: 0.975 Test Loss: 0.274 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0020701
	speed: 0.2198s/iter; left time: 7876.7763s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 1874.3482s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0563s/iter; left time: 2004.7102s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0487s/iter; left time: 1731.5550s
Epoch: 14 cost time: 21.99763822555542
Epoch: 14, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.286 Vali Acc: 0.979 Test Loss: 0.286 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1993s/iter; left time: 7058.2424s
	iters: 200, epoch: 15 | loss: 0.7526867
	speed: 0.0486s/iter; left time: 1714.7981s
	iters: 300, epoch: 15 | loss: 0.0019205
	speed: 0.0487s/iter; left time: 1715.1445s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 1813.1825s
Epoch: 15 cost time: 20.947386264801025
Epoch: 15, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.418 Vali Acc: 0.975 Test Loss: 0.418 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2065s/iter; left time: 7228.1622s
	iters: 200, epoch: 16 | loss: 0.0000557
	speed: 0.0599s/iter; left time: 2092.1936s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 2130.9711s
	iters: 400, epoch: 16 | loss: 0.0274283
	speed: 0.0650s/iter; left time: 2254.3067s
Epoch: 16 cost time: 26.65228509902954
Epoch: 16, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.488 Vali Acc: 0.973 Test Loss: 0.488 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2313s/iter; left time: 8002.5150s
	iters: 200, epoch: 17 | loss: 0.1770199
	speed: 0.0615s/iter; left time: 2120.2430s
	iters: 300, epoch: 17 | loss: 0.0000161
	speed: 0.0572s/iter; left time: 1967.6996s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0514s/iter; left time: 1760.9868s
Epoch: 17 cost time: 24.51444101333618
Epoch: 17, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.426 Vali Acc: 0.975 Test Loss: 0.426 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2069s/iter; left time: 7072.7422s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 1552.5807s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 1446.9596s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 1486.4214s
Epoch: 18 cost time: 18.958231210708618
Epoch: 18, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.367 Vali Acc: 0.980 Test Loss: 0.367 Test Acc: 0.980
Validation loss decreased (-0.979079 --> -0.979987).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1887s/iter; left time: 6370.6983s
	iters: 200, epoch: 19 | loss: 0.0003478
	speed: 0.0454s/iter; left time: 1528.5012s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1538.1631s
	iters: 400, epoch: 19 | loss: 0.0000048
	speed: 0.0453s/iter; left time: 1516.7413s
Epoch: 19 cost time: 19.587000131607056
Epoch: 19, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.320 Vali Acc: 0.967 Test Loss: 0.320 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1844s/iter; left time: 6150.2181s
	iters: 200, epoch: 20 | loss: 0.0833289
	speed: 0.0368s/iter; left time: 1224.4930s
	iters: 300, epoch: 20 | loss: 0.0017100
	speed: 0.0358s/iter; left time: 1186.8378s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 1457.3834s
Epoch: 20 cost time: 16.407630681991577
Epoch: 20, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.353 Vali Acc: 0.982 Test Loss: 0.353 Test Acc: 0.982
Validation loss decreased (-0.979987 --> -0.982261).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1695s/iter; left time: 5583.8971s
	iters: 200, epoch: 21 | loss: 0.0001811
	speed: 0.0417s/iter; left time: 1368.0887s
	iters: 300, epoch: 21 | loss: 0.0000521
	speed: 0.0454s/iter; left time: 1485.4991s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 1239.9942s
Epoch: 21 cost time: 17.6828351020813
Epoch: 21, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.267 Vali Acc: 0.980 Test Loss: 0.267 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1749s/iter; left time: 5690.5128s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 1466.5129s
	iters: 300, epoch: 22 | loss: 0.1577300
	speed: 0.0304s/iter; left time: 982.9048s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0501s/iter; left time: 1615.2078s
Epoch: 22 cost time: 18.679380416870117
Epoch: 22, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.356 Vali Acc: 0.980 Test Loss: 0.356 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000030
	speed: 0.2905s/iter; left time: 9329.4396s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.1107s/iter; left time: 3542.7007s
	iters: 300, epoch: 23 | loss: 0.0000003
	speed: 0.0994s/iter; left time: 3171.2697s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0926s/iter; left time: 2947.1255s
Epoch: 23 cost time: 43.3180890083313
Epoch: 23, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.435 Vali Acc: 0.973 Test Loss: 0.435 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000225
	speed: 0.2955s/iter; left time: 9369.0855s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0828s/iter; left time: 2617.8691s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0938s/iter; left time: 2954.2990s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0724s/iter; left time: 2272.9830s
Epoch: 24 cost time: 37.04488253593445
Epoch: 24, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.387 Vali Acc: 0.977 Test Loss: 0.387 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2695s/iter; left time: 8432.0191s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 2163.0226s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0787s/iter; left time: 2447.3900s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0754s/iter; left time: 2336.8953s
Epoch: 25 cost time: 32.33207726478577
Epoch: 25, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.268 Vali Acc: 0.978 Test Loss: 0.268 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2649s/iter; left time: 8177.8148s
	iters: 200, epoch: 26 | loss: 0.2604790
	speed: 0.0736s/iter; left time: 2264.2582s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 2197.0337s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0737s/iter; left time: 2252.0985s
Epoch: 26 cost time: 31.497715950012207
Epoch: 26, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.300 Vali Acc: 0.977 Test Loss: 0.300 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2681s/iter; left time: 8168.1695s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 1905.4905s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0643s/iter; left time: 1946.8968s
	iters: 400, epoch: 27 | loss: 0.0106780
	speed: 0.0520s/iter; left time: 1567.7640s
Epoch: 27 cost time: 26.737253427505493
Epoch: 27, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.447 Vali Acc: 0.975 Test Loss: 0.447 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2296s/iter; left time: 6899.4653s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 1699.5597s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0484s/iter; left time: 1445.5118s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 1523.5572s
Epoch: 28 cost time: 22.790489673614502
Epoch: 28, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.365 Vali Acc: 0.976 Test Loss: 0.365 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0018157
	speed: 0.2402s/iter; left time: 7118.1275s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0620s/iter; left time: 1830.9092s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 1615.7416s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 1533.4346s
Epoch: 29 cost time: 24.129714012145996
Epoch: 29, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.310 Vali Acc: 0.980 Test Loss: 0.310 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2349s/iter; left time: 6864.0889s
	iters: 200, epoch: 30 | loss: 0.0000205
	speed: 0.0508s/iter; left time: 1480.2524s
	iters: 300, epoch: 30 | loss: 0.0642540
	speed: 0.0592s/iter; left time: 1716.8199s
	iters: 400, epoch: 30 | loss: 0.0000605
	speed: 0.0558s/iter; left time: 1612.5706s
Epoch: 30 cost time: 23.854201555252075
Epoch: 30, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.312 Vali Acc: 0.980 Test Loss: 0.312 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 250506
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4491871
	speed: 0.0875s/iter; left time: 3605.8050s
	iters: 200, epoch: 1 | loss: 0.3692557
	speed: 0.0505s/iter; left time: 2076.8263s
	iters: 300, epoch: 1 | loss: 0.9461555
	speed: 0.0456s/iter; left time: 1869.5770s
	iters: 400, epoch: 1 | loss: 0.2796887
	speed: 0.0476s/iter; left time: 1948.4312s
Epoch: 1 cost time: 23.938377141952515
Epoch: 1, Steps: 413 | Train Loss: 0.370 Vali Loss: 0.131 Vali Acc: 0.961 Test Loss: 0.131 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0753421
	speed: 0.2049s/iter; left time: 8358.8189s
	iters: 200, epoch: 2 | loss: 0.0001637
	speed: 0.0432s/iter; left time: 1759.7469s
	iters: 300, epoch: 2 | loss: 0.0037407
	speed: 0.0513s/iter; left time: 2082.5557s
	iters: 400, epoch: 2 | loss: 0.0100899
	speed: 0.0478s/iter; left time: 1936.3507s
Epoch: 2 cost time: 20.60615825653076
Epoch: 2, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6414638
	speed: 0.2459s/iter; left time: 9926.6551s
	iters: 200, epoch: 3 | loss: 0.0048645
	speed: 0.0680s/iter; left time: 2738.5774s
	iters: 300, epoch: 3 | loss: 0.1362503
	speed: 0.0640s/iter; left time: 2571.3051s
	iters: 400, epoch: 3 | loss: 0.0008059
	speed: 0.0733s/iter; left time: 2936.5929s
Epoch: 3 cost time: 30.261091232299805
Epoch: 3, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
Validation loss decreased (-0.960890 --> -0.982264).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1763421
	speed: 0.2937s/iter; left time: 11736.0829s
	iters: 200, epoch: 4 | loss: 0.1136913
	speed: 0.0746s/iter; left time: 2972.2267s
	iters: 300, epoch: 4 | loss: 0.0734436
	speed: 0.0719s/iter; left time: 2858.2969s
	iters: 400, epoch: 4 | loss: 0.0001733
	speed: 0.0661s/iter; left time: 2620.9479s
Epoch: 4 cost time: 31.309067010879517
Epoch: 4, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.321 Vali Acc: 0.949 Test Loss: 0.321 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000263
	speed: 0.2663s/iter; left time: 10531.6868s
	iters: 200, epoch: 5 | loss: 0.2492180
	speed: 0.0748s/iter; left time: 2950.3734s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0718s/iter; left time: 2825.0491s
	iters: 400, epoch: 5 | loss: 0.5263570
	speed: 0.0709s/iter; left time: 2784.4241s
Epoch: 5 cost time: 32.09635543823242
Epoch: 5, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0004445
	speed: 0.2574s/iter; left time: 10074.2553s
	iters: 200, epoch: 6 | loss: 0.0000001
	speed: 0.0696s/iter; left time: 2716.8992s
	iters: 300, epoch: 6 | loss: 0.0000382
	speed: 0.0672s/iter; left time: 2615.5080s
	iters: 400, epoch: 6 | loss: 0.0000026
	speed: 0.0661s/iter; left time: 2568.9659s
Epoch: 6 cost time: 30.23640489578247
Epoch: 6, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.146 Vali Acc: 0.978 Test Loss: 0.146 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0002701
	speed: 0.2598s/iter; left time: 10061.4052s
	iters: 200, epoch: 7 | loss: 0.0007551
	speed: 0.0672s/iter; left time: 2594.4630s
	iters: 300, epoch: 7 | loss: 0.0154914
	speed: 0.0613s/iter; left time: 2361.5424s
	iters: 400, epoch: 7 | loss: 0.0000006
	speed: 0.0503s/iter; left time: 1931.6802s
Epoch: 7 cost time: 27.084805488586426
Epoch: 7, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.167 Vali Acc: 0.977 Test Loss: 0.167 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0417534
	speed: 0.2183s/iter; left time: 8363.0413s
	iters: 200, epoch: 8 | loss: 0.4732837
	speed: 0.0496s/iter; left time: 1895.6913s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 1916.6925s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.0435s/iter; left time: 1652.3237s
Epoch: 8 cost time: 21.508475065231323
Epoch: 8, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.138 Vali Acc: 0.984 Test Loss: 0.138 Test Acc: 0.984
Validation loss decreased (-0.982264 --> -0.984082).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2189s/iter; left time: 8293.9692s
	iters: 200, epoch: 9 | loss: 0.0000004
	speed: 0.0464s/iter; left time: 1752.1869s
	iters: 300, epoch: 9 | loss: 0.0000042
	speed: 0.0476s/iter; left time: 1793.3749s
	iters: 400, epoch: 9 | loss: 0.5618867
	speed: 0.0410s/iter; left time: 1542.9104s
Epoch: 9 cost time: 20.396317958831787
Epoch: 9, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.372 Vali Acc: 0.949 Test Loss: 0.372 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2351s/iter; left time: 8810.8308s
	iters: 200, epoch: 10 | loss: 0.0000013
	speed: 0.0492s/iter; left time: 1838.4841s
	iters: 300, epoch: 10 | loss: 0.0000028
	speed: 0.0437s/iter; left time: 1629.3348s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0463s/iter; left time: 1722.7445s
Epoch: 10 cost time: 21.257967472076416
Epoch: 10, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.141 Vali Acc: 0.985 Test Loss: 0.141 Test Acc: 0.985
Validation loss decreased (-0.984082 --> -0.984537).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000147
	speed: 0.2136s/iter; left time: 7918.6536s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 1881.5817s
	iters: 300, epoch: 11 | loss: 0.0000917
	speed: 0.0488s/iter; left time: 1798.8737s
	iters: 400, epoch: 11 | loss: 0.0000026
	speed: 0.0473s/iter; left time: 1739.6664s
Epoch: 11 cost time: 21.446187734603882
Epoch: 11, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.255 Vali Acc: 0.971 Test Loss: 0.255 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0001939
	speed: 0.2202s/iter; left time: 8071.9343s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 1909.7068s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 1538.4619s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 1706.3039s
Epoch: 12 cost time: 21.68327522277832
Epoch: 12, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.174 Vali Acc: 0.982 Test Loss: 0.174 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.9202251
	speed: 0.2093s/iter; left time: 7586.9671s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 2053.2212s
	iters: 300, epoch: 13 | loss: 0.0000859
	speed: 0.0425s/iter; left time: 1530.4991s
	iters: 400, epoch: 13 | loss: 0.0200497
	speed: 0.0475s/iter; left time: 1707.2110s
Epoch: 13 cost time: 21.827003955841064
Epoch: 13, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000003
	speed: 0.2445s/iter; left time: 8761.7305s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0898s/iter; left time: 3209.5204s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0659s/iter; left time: 2349.4644s
	iters: 400, epoch: 14 | loss: 0.0369109
	speed: 0.0728s/iter; left time: 2585.5242s
Epoch: 14 cost time: 32.88591909408569
Epoch: 14, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.243 Vali Acc: 0.976 Test Loss: 0.243 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2797s/iter; left time: 9907.6170s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0799s/iter; left time: 2822.2594s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0738s/iter; left time: 2597.5129s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0748s/iter; left time: 2627.9709s
Epoch: 15 cost time: 33.98893976211548
Epoch: 15, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.412 Vali Acc: 0.962 Test Loss: 0.412 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2863s/iter; left time: 10020.7134s
	iters: 200, epoch: 16 | loss: 0.0000012
	speed: 0.0692s/iter; left time: 2414.6067s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0730s/iter; left time: 2540.9193s
	iters: 400, epoch: 16 | loss: 0.0002500
	speed: 0.0720s/iter; left time: 2499.5709s
Epoch: 16 cost time: 31.734489917755127
Epoch: 16, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.255 Vali Acc: 0.977 Test Loss: 0.255 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2553s/iter; left time: 8831.2288s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 2295.1087s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0644s/iter; left time: 2213.9207s
	iters: 400, epoch: 17 | loss: 0.0000042
	speed: 0.0655s/iter; left time: 2246.8894s
Epoch: 17 cost time: 29.397870540618896
Epoch: 17, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.301 Vali Acc: 0.972 Test Loss: 0.301 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2509s/iter; left time: 8574.7010s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 1632.0038s
	iters: 300, epoch: 18 | loss: 0.0034668
	speed: 0.0488s/iter; left time: 1657.5977s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 1758.4607s
Epoch: 18 cost time: 24.349042415618896
Epoch: 18, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.229 Vali Acc: 0.977 Test Loss: 0.229 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2220s/iter; left time: 7497.0389s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0511s/iter; left time: 1719.1672s
	iters: 300, epoch: 19 | loss: 0.0010384
	speed: 0.0492s/iter; left time: 1651.5333s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 1402.4821s
Epoch: 19 cost time: 21.346852779388428
Epoch: 19, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.264 Vali Acc: 0.974 Test Loss: 0.264 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2050s/iter; left time: 6837.3071s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 1352.6321s
	iters: 300, epoch: 20 | loss: 0.0000761
	speed: 0.0453s/iter; left time: 1502.3162s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 1384.3319s
Epoch: 20 cost time: 18.26072120666504
Epoch: 20, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.376 Vali Acc: 0.975 Test Loss: 0.376 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 209162
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2496778
	speed: 0.0823s/iter; left time: 3390.9797s
	iters: 200, epoch: 1 | loss: 0.1759147
	speed: 0.0457s/iter; left time: 1877.0956s
	iters: 300, epoch: 1 | loss: 0.0436981
	speed: 0.0441s/iter; left time: 1807.8171s
	iters: 400, epoch: 1 | loss: 0.5129097
	speed: 0.0370s/iter; left time: 1514.7082s
Epoch: 1 cost time: 21.56533980369568
Epoch: 1, Steps: 413 | Train Loss: 0.402 Vali Loss: 0.102 Vali Acc: 0.966 Test Loss: 0.102 Test Acc: 0.966
Validation loss decreased (inf --> -0.965893).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2187119
	speed: 0.2010s/iter; left time: 8200.3884s
	iters: 200, epoch: 2 | loss: 0.2899202
	speed: 0.0525s/iter; left time: 2135.1591s
	iters: 300, epoch: 2 | loss: 0.0433316
	speed: 0.0492s/iter; left time: 1996.1683s
	iters: 400, epoch: 2 | loss: 0.0429770
	speed: 0.0408s/iter; left time: 1651.5168s
Epoch: 2 cost time: 20.003456830978394
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0291089
	speed: 0.2196s/iter; left time: 8865.6862s
	iters: 200, epoch: 3 | loss: 0.0053179
	speed: 0.0553s/iter; left time: 2225.8632s
	iters: 300, epoch: 3 | loss: 0.0020855
	speed: 0.0518s/iter; left time: 2081.6915s
	iters: 400, epoch: 3 | loss: 0.0130559
	speed: 0.0540s/iter; left time: 2162.4037s
Epoch: 3 cost time: 23.299139738082886
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0012211
	speed: 0.2127s/iter; left time: 8498.0347s
	iters: 200, epoch: 4 | loss: 0.0001468
	speed: 0.0512s/iter; left time: 2042.5388s
	iters: 300, epoch: 4 | loss: 0.0148249
	speed: 0.0531s/iter; left time: 2109.4797s
	iters: 400, epoch: 4 | loss: 0.0012871
	speed: 0.0504s/iter; left time: 1999.1744s
Epoch: 4 cost time: 22.263055324554443
Epoch: 4, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
Validation loss decreased (-0.965893 --> -0.969075).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000158
	speed: 0.2147s/iter; left time: 8491.6346s
	iters: 200, epoch: 5 | loss: 0.0419488
	speed: 0.0483s/iter; left time: 1907.0448s
	iters: 300, epoch: 5 | loss: 0.0004570
	speed: 0.0539s/iter; left time: 2120.8236s
	iters: 400, epoch: 5 | loss: 0.0004648
	speed: 0.0583s/iter; left time: 2289.6116s
Epoch: 5 cost time: 22.47927761077881
Epoch: 5, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.175 Vali Acc: 0.962 Test Loss: 0.175 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000005
	speed: 0.2196s/iter; left time: 8593.1454s
	iters: 200, epoch: 6 | loss: 0.0252775
	speed: 0.0458s/iter; left time: 1787.9834s
	iters: 300, epoch: 6 | loss: 0.0011137
	speed: 0.0435s/iter; left time: 1692.4767s
	iters: 400, epoch: 6 | loss: 0.6498044
	speed: 0.0464s/iter; left time: 1802.6703s
Epoch: 6 cost time: 19.684566974639893
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.214 Vali Acc: 0.970 Test Loss: 0.214 Test Acc: 0.970
Validation loss decreased (-0.969075 --> -0.969984).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000067
	speed: 0.2435s/iter; left time: 9427.4006s
	iters: 200, epoch: 7 | loss: 0.0000303
	speed: 0.0454s/iter; left time: 1754.5700s
	iters: 300, epoch: 7 | loss: 0.1035168
	speed: 0.0470s/iter; left time: 1812.0439s
	iters: 400, epoch: 7 | loss: 0.0253308
	speed: 0.0492s/iter; left time: 1889.0609s
Epoch: 7 cost time: 21.29190731048584
Epoch: 7, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.253 Vali Acc: 0.962 Test Loss: 0.253 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0001785
	speed: 0.2305s/iter; left time: 8831.6669s
	iters: 200, epoch: 8 | loss: 0.0010068
	speed: 0.0561s/iter; left time: 2142.1885s
	iters: 300, epoch: 8 | loss: 0.1203609
	speed: 0.0540s/iter; left time: 2057.5297s
	iters: 400, epoch: 8 | loss: 0.0000029
	speed: 0.0469s/iter; left time: 1782.3973s
Epoch: 8 cost time: 22.914085149765015
Epoch: 8, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.199 Vali Acc: 0.978 Test Loss: 0.199 Test Acc: 0.978
Validation loss decreased (-0.969984 --> -0.977715).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000330
	speed: 0.2158s/iter; left time: 8178.3843s
	iters: 200, epoch: 9 | loss: 0.0062129
	speed: 0.0496s/iter; left time: 1875.2274s
	iters: 300, epoch: 9 | loss: 0.0000052
	speed: 0.0482s/iter; left time: 1817.7862s
	iters: 400, epoch: 9 | loss: 0.0797493
	speed: 0.0538s/iter; left time: 2022.6392s
Epoch: 9 cost time: 21.467232704162598
Epoch: 9, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.284 Vali Acc: 0.958 Test Loss: 0.284 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000005
	speed: 0.2159s/iter; left time: 8094.4680s
	iters: 200, epoch: 10 | loss: 0.0000843
	speed: 0.0497s/iter; left time: 1856.8338s
	iters: 300, epoch: 10 | loss: 0.0001639
	speed: 0.0499s/iter; left time: 1861.9814s
	iters: 400, epoch: 10 | loss: 0.0033469
	speed: 0.0575s/iter; left time: 2136.9278s
Epoch: 10 cost time: 21.414843797683716
Epoch: 10, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.216 Vali Acc: 0.968 Test Loss: 0.216 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0004324
	speed: 0.2090s/iter; left time: 7748.5055s
	iters: 200, epoch: 11 | loss: 0.3718901
	speed: 0.0461s/iter; left time: 1705.9173s
	iters: 300, epoch: 11 | loss: 0.0000002
	speed: 0.0429s/iter; left time: 1580.0047s
	iters: 400, epoch: 11 | loss: 0.0009950
	speed: 0.0511s/iter; left time: 1879.3209s
Epoch: 11 cost time: 20.92426824569702
Epoch: 11, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.212 Vali Acc: 0.970 Test Loss: 0.212 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000105
	speed: 0.2084s/iter; left time: 7640.5303s
	iters: 200, epoch: 12 | loss: 0.0014285
	speed: 0.0428s/iter; left time: 1563.6912s
	iters: 300, epoch: 12 | loss: 0.0239273
	speed: 0.0549s/iter; left time: 1999.8572s
	iters: 400, epoch: 12 | loss: 0.0000013
	speed: 0.0412s/iter; left time: 1498.6332s
Epoch: 12 cost time: 19.69815993309021
Epoch: 12, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2108s/iter; left time: 7639.4119s
	iters: 200, epoch: 13 | loss: 0.0000009
	speed: 0.0451s/iter; left time: 1628.4256s
	iters: 300, epoch: 13 | loss: 0.0029343
	speed: 0.0460s/iter; left time: 1658.3720s
	iters: 400, epoch: 13 | loss: 0.0577141
	speed: 0.0470s/iter; left time: 1690.8252s
Epoch: 13 cost time: 20.237093448638916
Epoch: 13, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.349 Vali Acc: 0.960 Test Loss: 0.349 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000003
	speed: 0.2292s/iter; left time: 8213.2024s
	iters: 200, epoch: 14 | loss: 0.0000060
	speed: 0.0502s/iter; left time: 1795.1009s
	iters: 300, epoch: 14 | loss: 0.0008970
	speed: 0.0449s/iter; left time: 1598.6430s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 1749.3940s
Epoch: 14 cost time: 21.129112005233765
Epoch: 14, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.244 Vali Acc: 0.970 Test Loss: 0.244 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2468s/iter; left time: 8742.1513s
	iters: 200, epoch: 15 | loss: 0.0000953
	speed: 0.0520s/iter; left time: 1838.2335s
	iters: 300, epoch: 15 | loss: 0.0000045
	speed: 0.0495s/iter; left time: 1744.3149s
	iters: 400, epoch: 15 | loss: 0.0000063
	speed: 0.0445s/iter; left time: 1562.0135s
Epoch: 15 cost time: 21.597571849822998
Epoch: 15, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0706093
	speed: 0.2410s/iter; left time: 8435.7093s
	iters: 200, epoch: 16 | loss: 0.0000052
	speed: 0.0520s/iter; left time: 1815.2854s
	iters: 300, epoch: 16 | loss: 0.0039205
	speed: 0.0500s/iter; left time: 1739.9696s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0521s/iter; left time: 1807.2219s
Epoch: 16 cost time: 22.740927696228027
Epoch: 16, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
Validation loss decreased (-0.977715 --> -0.984538).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000146
	speed: 0.2198s/iter; left time: 7602.5131s
	iters: 200, epoch: 17 | loss: 0.0172162
	speed: 0.0543s/iter; left time: 1872.3813s
	iters: 300, epoch: 17 | loss: 0.0000650
	speed: 0.0523s/iter; left time: 1798.3938s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 2091.7158s
Epoch: 17 cost time: 23.74458146095276
Epoch: 17, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.206 Vali Acc: 0.974 Test Loss: 0.206 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2297s/iter; left time: 7850.3418s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 1475.7785s
	iters: 300, epoch: 18 | loss: 0.0003472
	speed: 0.0503s/iter; left time: 1709.8188s
	iters: 400, epoch: 18 | loss: 0.3069904
	speed: 0.0536s/iter; left time: 1816.4480s
Epoch: 18 cost time: 21.7380690574646
Epoch: 18, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.192 Vali Acc: 0.980 Test Loss: 0.192 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2492s/iter; left time: 8416.0246s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 1750.2783s
	iters: 300, epoch: 19 | loss: 0.3918184
	speed: 0.0531s/iter; left time: 1783.9847s
	iters: 400, epoch: 19 | loss: 0.1090437
	speed: 0.0463s/iter; left time: 1548.8254s
Epoch: 19 cost time: 22.191566228866577
Epoch: 19, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.174 Vali Acc: 0.974 Test Loss: 0.174 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2525s/iter; left time: 8422.7640s
	iters: 200, epoch: 20 | loss: 0.3489647
	speed: 0.0490s/iter; left time: 1628.9278s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 1977.5460s
	iters: 400, epoch: 20 | loss: 0.3588351
	speed: 0.0518s/iter; left time: 1712.3682s
Epoch: 20 cost time: 23.572509050369263
Epoch: 20, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.280 Vali Acc: 0.974 Test Loss: 0.280 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2150s/iter; left time: 7083.4253s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 1558.2170s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 1528.6792s
	iters: 400, epoch: 21 | loss: 0.6252965
	speed: 0.0457s/iter; left time: 1491.0524s
Epoch: 21 cost time: 19.773123741149902
Epoch: 21, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.179 Vali Acc: 0.979 Test Loss: 0.179 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000102
	speed: 0.2485s/iter; left time: 8082.1391s
	iters: 200, epoch: 22 | loss: 0.0000042
	speed: 0.0508s/iter; left time: 1647.6486s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1526.4362s
	iters: 400, epoch: 22 | loss: 0.0000001
	speed: 0.0434s/iter; left time: 1397.7517s
Epoch: 22 cost time: 21.285987854003906
Epoch: 22, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.192 Vali Acc: 0.978 Test Loss: 0.192 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2218s/iter; left time: 7124.6254s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0541s/iter; left time: 1733.1114s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0562s/iter; left time: 1793.9289s
	iters: 400, epoch: 23 | loss: 0.0000008
	speed: 0.0500s/iter; left time: 1590.5156s
Epoch: 23 cost time: 23.09829020500183
Epoch: 23, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.268 Vali Acc: 0.970 Test Loss: 0.268 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000009
	speed: 0.2034s/iter; left time: 6448.8524s
	iters: 200, epoch: 24 | loss: 0.0039556
	speed: 0.0603s/iter; left time: 1904.9096s
	iters: 300, epoch: 24 | loss: 0.1024483
	speed: 0.0568s/iter; left time: 1790.3385s
	iters: 400, epoch: 24 | loss: 0.0000098
	speed: 0.0526s/iter; left time: 1652.8088s
Epoch: 24 cost time: 23.620753049850464
Epoch: 24, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.263 Vali Acc: 0.976 Test Loss: 0.263 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2226s/iter; left time: 6966.4453s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 1456.1021s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 1555.1112s
	iters: 400, epoch: 25 | loss: 0.0000001
	speed: 0.0530s/iter; left time: 1642.9721s
Epoch: 25 cost time: 21.673712968826294
Epoch: 25, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.274 Vali Acc: 0.968 Test Loss: 0.274 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0062348
	speed: 0.2188s/iter; left time: 6755.4239s
	iters: 200, epoch: 26 | loss: 0.0000001
	speed: 0.0574s/iter; left time: 1765.8414s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 1630.5876s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1497.3667s
Epoch: 26 cost time: 22.718897104263306
Epoch: 26, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.278 Vali Acc: 0.974 Test Loss: 0.278 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 176202
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3282618
	speed: 0.0833s/iter; left time: 3433.2362s
	iters: 200, epoch: 1 | loss: 0.2537071
	speed: 0.0482s/iter; left time: 1982.2825s
	iters: 300, epoch: 1 | loss: 0.1336919
	speed: 0.0488s/iter; left time: 2002.5545s
	iters: 400, epoch: 1 | loss: 0.1565017
	speed: 0.0443s/iter; left time: 1810.9498s
Epoch: 1 cost time: 23.205202102661133
Epoch: 1, Steps: 413 | Train Loss: 0.431 Vali Loss: 0.123 Vali Acc: 0.960 Test Loss: 0.123 Test Acc: 0.960
Validation loss decreased (inf --> -0.959526).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0257481
	speed: 0.2092s/iter; left time: 8532.4699s
	iters: 200, epoch: 2 | loss: 0.0024983
	speed: 0.0445s/iter; left time: 1810.5245s
	iters: 300, epoch: 2 | loss: 0.0459753
	speed: 0.0439s/iter; left time: 1783.5719s
	iters: 400, epoch: 2 | loss: 0.0347266
	speed: 0.0451s/iter; left time: 1824.6182s
Epoch: 2 cost time: 19.641636610031128
Epoch: 2, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.102 Vali Acc: 0.967 Test Loss: 0.102 Test Acc: 0.967
Validation loss decreased (-0.959526 --> -0.966802).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1311917
	speed: 0.1954s/iter; left time: 7888.3294s
	iters: 200, epoch: 3 | loss: 0.1477599
	speed: 0.0445s/iter; left time: 1791.7874s
	iters: 300, epoch: 3 | loss: 0.3056661
	speed: 0.0460s/iter; left time: 1847.9124s
	iters: 400, epoch: 3 | loss: 0.0051100
	speed: 0.0414s/iter; left time: 1658.1581s
Epoch: 3 cost time: 18.770006895065308
Epoch: 3, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.966802 --> -0.970895).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0297693
	speed: 0.1944s/iter; left time: 7767.1715s
	iters: 200, epoch: 4 | loss: 0.0000501
	speed: 0.0407s/iter; left time: 1622.4893s
	iters: 300, epoch: 4 | loss: 0.0055672
	speed: 0.0385s/iter; left time: 1530.5948s
	iters: 400, epoch: 4 | loss: 0.0152224
	speed: 0.0390s/iter; left time: 1547.9275s
Epoch: 4 cost time: 17.400731563568115
Epoch: 4, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0095642
	speed: 0.1634s/iter; left time: 6463.8930s
	iters: 200, epoch: 5 | loss: 0.0002088
	speed: 0.0394s/iter; left time: 1554.7758s
	iters: 300, epoch: 5 | loss: 0.0094021
	speed: 0.0368s/iter; left time: 1449.6311s
	iters: 400, epoch: 5 | loss: 0.0666327
	speed: 0.0395s/iter; left time: 1551.6194s
Epoch: 5 cost time: 16.405212879180908
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.970895 --> -0.975442).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5909445
	speed: 0.1768s/iter; left time: 6919.8150s
	iters: 200, epoch: 6 | loss: 0.0000509
	speed: 0.0427s/iter; left time: 1665.2069s
	iters: 300, epoch: 6 | loss: 0.0144167
	speed: 0.0392s/iter; left time: 1525.1165s
	iters: 400, epoch: 6 | loss: 0.0554065
	speed: 0.0415s/iter; left time: 1612.1525s
Epoch: 6 cost time: 17.645813941955566
Epoch: 6, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0002382
	speed: 0.1992s/iter; left time: 7713.0968s
	iters: 200, epoch: 7 | loss: 0.0465982
	speed: 0.0403s/iter; left time: 1555.8651s
	iters: 300, epoch: 7 | loss: 0.0046455
	speed: 0.0372s/iter; left time: 1432.2397s
	iters: 400, epoch: 7 | loss: 0.7816986
	speed: 0.0389s/iter; left time: 1496.2020s
Epoch: 7 cost time: 17.659356117248535
Epoch: 7, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.192 Vali Acc: 0.966 Test Loss: 0.192 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000164
	speed: 0.1899s/iter; left time: 7273.5086s
	iters: 200, epoch: 8 | loss: 0.0103900
	speed: 0.0363s/iter; left time: 1387.7540s
	iters: 300, epoch: 8 | loss: 0.0000100
	speed: 0.0375s/iter; left time: 1430.4600s
	iters: 400, epoch: 8 | loss: 0.0000224
	speed: 0.0429s/iter; left time: 1632.4235s
Epoch: 8 cost time: 17.462637424468994
Epoch: 8, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.975442 --> -0.976807).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.2024s/iter; left time: 7670.3363s
	iters: 200, epoch: 9 | loss: 0.0000670
	speed: 0.0424s/iter; left time: 1603.1298s
	iters: 300, epoch: 9 | loss: 0.0000032
	speed: 0.0378s/iter; left time: 1426.6299s
	iters: 400, epoch: 9 | loss: 0.3182488
	speed: 0.0428s/iter; left time: 1607.4981s
Epoch: 9 cost time: 18.309905767440796
Epoch: 9, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2829982
	speed: 0.1767s/iter; left time: 6623.0112s
	iters: 200, epoch: 10 | loss: 0.0069394
	speed: 0.0411s/iter; left time: 1537.0228s
	iters: 300, epoch: 10 | loss: 0.0005771
	speed: 0.0395s/iter; left time: 1474.0122s
	iters: 400, epoch: 10 | loss: 0.0652945
	speed: 0.0426s/iter; left time: 1582.4790s
Epoch: 10 cost time: 17.397334575653076
Epoch: 10, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.175 Vali Acc: 0.973 Test Loss: 0.175 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000189
	speed: 0.2034s/iter; left time: 7539.1728s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 1531.8371s
	iters: 300, epoch: 11 | loss: 0.0000003
	speed: 0.0395s/iter; left time: 1455.8916s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0387s/iter; left time: 1424.1297s
Epoch: 11 cost time: 17.668517112731934
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.179 Vali Acc: 0.973 Test Loss: 0.179 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000106
	speed: 0.1813s/iter; left time: 6647.0692s
	iters: 200, epoch: 12 | loss: 0.1629197
	speed: 0.0396s/iter; left time: 1449.1064s
	iters: 300, epoch: 12 | loss: 0.5774640
	speed: 0.0429s/iter; left time: 1563.3412s
	iters: 400, epoch: 12 | loss: 0.0000078
	speed: 0.0448s/iter; left time: 1627.8219s
Epoch: 12 cost time: 18.01029372215271
Epoch: 12, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.170 Vali Acc: 0.978 Test Loss: 0.170 Test Acc: 0.978
Validation loss decreased (-0.976807 --> -0.978170).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.1916s/iter; left time: 6944.0467s
	iters: 200, epoch: 13 | loss: 0.0442609
	speed: 0.0434s/iter; left time: 1568.0890s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 1621.8415s
	iters: 400, epoch: 13 | loss: 0.0000808
	speed: 0.0413s/iter; left time: 1484.0277s
Epoch: 13 cost time: 18.600066900253296
Epoch: 13, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.202 Vali Acc: 0.974 Test Loss: 0.202 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000015
	speed: 0.2088s/iter; left time: 7481.1664s
	iters: 200, epoch: 14 | loss: 0.0000003
	speed: 0.0457s/iter; left time: 1634.0526s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 1699.5518s
	iters: 400, epoch: 14 | loss: 0.1973187
	speed: 0.0510s/iter; left time: 1810.7146s
Epoch: 14 cost time: 20.73634696006775
Epoch: 14, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2133s/iter; left time: 7554.2619s
	iters: 200, epoch: 15 | loss: 0.3257740
	speed: 0.0466s/iter; left time: 1646.3504s
	iters: 300, epoch: 15 | loss: 0.0000658
	speed: 0.0465s/iter; left time: 1638.8877s
	iters: 400, epoch: 15 | loss: 0.0000007
	speed: 0.0462s/iter; left time: 1620.9861s
Epoch: 15 cost time: 19.94825315475464
Epoch: 15, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.177 Vali Acc: 0.971 Test Loss: 0.177 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.4257697
	speed: 0.2005s/iter; left time: 7018.9524s
	iters: 200, epoch: 16 | loss: 0.9476148
	speed: 0.0452s/iter; left time: 1576.2009s
	iters: 300, epoch: 16 | loss: 0.0000028
	speed: 0.0474s/iter; left time: 1650.5450s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1491.8514s
Epoch: 16 cost time: 20.039546251296997
Epoch: 16, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.214 Vali Acc: 0.977 Test Loss: 0.214 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1953s/iter; left time: 6754.5195s
	iters: 200, epoch: 17 | loss: 0.0002524
	speed: 0.0436s/iter; left time: 1503.4019s
	iters: 300, epoch: 17 | loss: 0.0000091
	speed: 0.0485s/iter; left time: 1669.0329s
	iters: 400, epoch: 17 | loss: 0.0000162
	speed: 0.0442s/iter; left time: 1516.4658s
Epoch: 17 cost time: 19.8696186542511
Epoch: 17, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.238 Vali Acc: 0.970 Test Loss: 0.238 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0003007
	speed: 0.2152s/iter; left time: 7354.6923s
	iters: 200, epoch: 18 | loss: 0.0003528
	speed: 0.0400s/iter; left time: 1362.8228s
	iters: 300, epoch: 18 | loss: 0.0001628
	speed: 0.0427s/iter; left time: 1449.9430s
	iters: 400, epoch: 18 | loss: 0.0000151
	speed: 0.0442s/iter; left time: 1499.1338s
Epoch: 18 cost time: 19.01957058906555
Epoch: 18, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.195 Vali Acc: 0.977 Test Loss: 0.195 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000744
	speed: 0.1979s/iter; left time: 6682.1858s
	iters: 200, epoch: 19 | loss: 0.0000006
	speed: 0.0456s/iter; left time: 1534.4459s
	iters: 300, epoch: 19 | loss: 0.0000008
	speed: 0.0430s/iter; left time: 1441.9010s
	iters: 400, epoch: 19 | loss: 0.3275157
	speed: 0.0459s/iter; left time: 1535.6386s
Epoch: 19 cost time: 19.112842559814453
Epoch: 19, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.146 Vali Acc: 0.978 Test Loss: 0.146 Test Acc: 0.978
Validation loss decreased (-0.978170 --> -0.978170).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1909s/iter; left time: 6368.2340s
	iters: 200, epoch: 20 | loss: 0.0006728
	speed: 0.0423s/iter; left time: 1405.5135s
	iters: 300, epoch: 20 | loss: 0.2607440
	speed: 0.0432s/iter; left time: 1432.8270s
	iters: 400, epoch: 20 | loss: 0.0036090
	speed: 0.0381s/iter; left time: 1259.8175s
Epoch: 20 cost time: 17.798593759536743
Epoch: 20, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000123
	speed: 0.1809s/iter; left time: 5958.5674s
	iters: 200, epoch: 21 | loss: 0.0030085
	speed: 0.0390s/iter; left time: 1280.4793s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1279.3182s
	iters: 400, epoch: 21 | loss: 0.0000002
	speed: 0.0417s/iter; left time: 1362.7238s
Epoch: 21 cost time: 17.885730504989624
Epoch: 21, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.192 Vali Acc: 0.973 Test Loss: 0.192 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0018877
	speed: 0.1965s/iter; left time: 6391.1052s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 1344.4920s
	iters: 300, epoch: 22 | loss: 0.0000079
	speed: 0.0411s/iter; left time: 1328.3802s
	iters: 400, epoch: 22 | loss: 0.1986789
	speed: 0.0425s/iter; left time: 1370.7633s
Epoch: 22 cost time: 18.113117218017578
Epoch: 22, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.245 Vali Acc: 0.973 Test Loss: 0.245 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1939s/iter; left time: 6228.6953s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0466s/iter; left time: 1492.7208s
	iters: 300, epoch: 23 | loss: 0.0000008
	speed: 0.0419s/iter; left time: 1338.3857s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 1426.5615s
Epoch: 23 cost time: 19.2778582572937
Epoch: 23, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.223 Vali Acc: 0.973 Test Loss: 0.223 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000003
	speed: 0.2089s/iter; left time: 6623.0364s
	iters: 200, epoch: 24 | loss: 0.0000009
	speed: 0.0489s/iter; left time: 1546.7931s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1429.5871s
	iters: 400, epoch: 24 | loss: 0.0005151
	speed: 0.0465s/iter; left time: 1460.0190s
Epoch: 24 cost time: 19.812687397003174
Epoch: 24, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.977 Test Loss: 0.213 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000665
	speed: 0.2018s/iter; left time: 6314.3063s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 1421.2247s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 1427.7210s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 1395.3595s
Epoch: 25 cost time: 19.72470760345459
Epoch: 25, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.270 Vali Acc: 0.973 Test Loss: 0.270 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.2342495
	speed: 0.1911s/iter; left time: 5901.0819s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 1312.7623s
	iters: 300, epoch: 26 | loss: 0.0000008
	speed: 0.0450s/iter; left time: 1379.4438s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.0459s/iter; left time: 1402.9255s
Epoch: 26 cost time: 19.642406225204468
Epoch: 26, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.174 Vali Acc: 0.979 Test Loss: 0.174 Test Acc: 0.979
Validation loss decreased (-0.978170 --> -0.979080).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2131s/iter; left time: 6490.1893s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 1292.1757s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0400s/iter; left time: 1210.6255s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0404s/iter; left time: 1217.7534s
Epoch: 27 cost time: 18.27636218070984
Epoch: 27, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.211 Vali Acc: 0.977 Test Loss: 0.211 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000006
	speed: 0.2035s/iter; left time: 6114.7700s
	iters: 200, epoch: 28 | loss: 0.0000012
	speed: 0.0479s/iter; left time: 1433.5049s
	iters: 300, epoch: 28 | loss: 0.0000025
	speed: 0.0519s/iter; left time: 1549.6345s
	iters: 400, epoch: 28 | loss: 0.0023838
	speed: 0.0459s/iter; left time: 1364.3031s
Epoch: 28 cost time: 20.807848930358887
Epoch: 28, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.202 Vali Acc: 0.973 Test Loss: 0.202 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2004s/iter; left time: 5940.0195s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 1387.4703s
	iters: 300, epoch: 29 | loss: 0.0009095
	speed: 0.0459s/iter; left time: 1350.4958s
	iters: 400, epoch: 29 | loss: 0.0000982
	speed: 0.0515s/iter; left time: 1512.1580s
Epoch: 29 cost time: 20.522512197494507
Epoch: 29, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.242 Vali Acc: 0.976 Test Loss: 0.242 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2183s/iter; left time: 6380.1418s
	iters: 200, epoch: 30 | loss: 0.0000001
	speed: 0.0468s/iter; left time: 1363.4943s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 1284.2785s
	iters: 400, epoch: 30 | loss: 0.0000872
	speed: 0.0490s/iter; left time: 1416.5968s
Epoch: 30 cost time: 20.20867657661438
Epoch: 30, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.372 Vali Acc: 0.966 Test Loss: 0.372 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0102283
	speed: 0.2071s/iter; left time: 5966.9226s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 1345.6571s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1309.8780s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 1373.7492s
Epoch: 31 cost time: 20.9333074092865
Epoch: 31, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.164 Vali Acc: 0.979 Test Loss: 0.164 Test Acc: 0.979
Validation loss decreased (-0.979080 --> -0.979080).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0000221
	speed: 0.2035s/iter; left time: 5777.9891s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0429s/iter; left time: 1213.8656s
	iters: 300, epoch: 32 | loss: 0.0134183
	speed: 0.0472s/iter; left time: 1330.1829s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 1371.5854s
Epoch: 32 cost time: 19.817112922668457
Epoch: 32, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0019609
	speed: 0.2100s/iter; left time: 5877.9872s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 1239.2797s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1290.5614s
	iters: 400, epoch: 33 | loss: 0.0008147
	speed: 0.0505s/iter; left time: 1398.9527s
Epoch: 33 cost time: 19.92036247253418
Epoch: 33, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0000001
	speed: 0.1913s/iter; left time: 5275.7928s
	iters: 200, epoch: 34 | loss: 0.0000016
	speed: 0.0460s/iter; left time: 1263.5352s
	iters: 300, epoch: 34 | loss: 0.0000001
	speed: 0.0509s/iter; left time: 1393.3932s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 1342.9033s
Epoch: 34 cost time: 19.212202072143555
Epoch: 34, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.205 Vali Acc: 0.981 Test Loss: 0.205 Test Acc: 0.981
Validation loss decreased (-0.979080 --> -0.981353).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2055s/iter; left time: 5581.6024s
	iters: 200, epoch: 35 | loss: 0.0000001
	speed: 0.0470s/iter; left time: 1270.5106s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 1213.1196s
	iters: 400, epoch: 35 | loss: 0.0012119
	speed: 0.0455s/iter; left time: 1221.5828s
Epoch: 35 cost time: 20.25981879234314
Epoch: 35, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.285 Vali Acc: 0.978 Test Loss: 0.285 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0000018
	speed: 0.2158s/iter; left time: 5772.2564s
	iters: 200, epoch: 36 | loss: 0.0148297
	speed: 0.0560s/iter; left time: 1491.9442s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0475s/iter; left time: 1259.6842s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 1142.4884s
Epoch: 36 cost time: 21.05030870437622
Epoch: 36, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.237 Vali Acc: 0.980 Test Loss: 0.237 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1935s/iter; left time: 5095.2874s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 1307.0457s
	iters: 300, epoch: 37 | loss: 0.0000261
	speed: 0.0450s/iter; left time: 1175.7181s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 1360.1991s
Epoch: 37 cost time: 20.35158109664917
Epoch: 37, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.212 Vali Acc: 0.977 Test Loss: 0.212 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0000120
	speed: 0.2085s/iter; left time: 5403.0872s
	iters: 200, epoch: 38 | loss: 0.4136771
	speed: 0.0441s/iter; left time: 1138.8117s
	iters: 300, epoch: 38 | loss: 0.0000171
	speed: 0.0507s/iter; left time: 1304.1119s
	iters: 400, epoch: 38 | loss: 0.0002011
	speed: 0.0406s/iter; left time: 1040.8752s
Epoch: 38 cost time: 19.700299739837646
Epoch: 38, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.349 Vali Acc: 0.968 Test Loss: 0.349 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0000206
	speed: 0.2007s/iter; left time: 5118.1767s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0484s/iter; left time: 1229.0510s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0453s/iter; left time: 1145.9528s
	iters: 400, epoch: 39 | loss: 0.0000043
	speed: 0.0430s/iter; left time: 1082.6729s
Epoch: 39 cost time: 19.346093893051147
Epoch: 39, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.302 Vali Acc: 0.973 Test Loss: 0.302 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.1930s/iter; left time: 4843.3044s
	iters: 200, epoch: 40 | loss: 0.0004138
	speed: 0.0483s/iter; left time: 1206.5129s
	iters: 300, epoch: 40 | loss: 0.0000101
	speed: 0.0463s/iter; left time: 1151.6000s
	iters: 400, epoch: 40 | loss: 0.0000007
	speed: 0.0463s/iter; left time: 1147.7270s
Epoch: 40 cost time: 19.398170948028564
Epoch: 40, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.253 Vali Acc: 0.980 Test Loss: 0.253 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.1939s/iter; left time: 4786.5991s
	iters: 200, epoch: 41 | loss: 0.4128325
	speed: 0.0427s/iter; left time: 1049.1050s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 1007.7490s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 1170.5096s
Epoch: 41 cost time: 18.914031505584717
Epoch: 41, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0010513
	speed: 0.2092s/iter; left time: 5077.0910s
	iters: 200, epoch: 42 | loss: 0.0000446
	speed: 0.0472s/iter; left time: 1140.9447s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 1048.8466s
	iters: 400, epoch: 42 | loss: 0.0652540
	speed: 0.0424s/iter; left time: 1015.3808s
Epoch: 42 cost time: 18.883044719696045
Epoch: 42, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.291 Vali Acc: 0.978 Test Loss: 0.291 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.2120s/iter; left time: 5057.8036s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1153.1289s
	iters: 300, epoch: 43 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1117.1814s
	iters: 400, epoch: 43 | loss: 0.8744786
	speed: 0.0458s/iter; left time: 1079.1168s
Epoch: 43 cost time: 21.043604135513306
Epoch: 43, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.980 Test Loss: 0.216 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.0000008
	speed: 0.1951s/iter; left time: 4573.7117s
	iters: 200, epoch: 44 | loss: 0.0167381
	speed: 0.0478s/iter; left time: 1115.6031s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.0471s/iter; left time: 1093.8949s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 1023.3612s
Epoch: 44 cost time: 19.36416721343994
Epoch: 44, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.988 Test Loss: 0.116 Test Acc: 0.988
Validation loss decreased (-0.981353 --> -0.988175).  Saving model ...
	iters: 100, epoch: 45 | loss: 0.0000000
	speed: 0.2051s/iter; left time: 4722.9589s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 990.3011s
	iters: 300, epoch: 45 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 1002.8206s
	iters: 400, epoch: 45 | loss: 0.0000011
	speed: 0.0434s/iter; left time: 987.3379s
Epoch: 45 cost time: 19.71316123008728
Epoch: 45, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 46 | loss: 0.0000002
	speed: 0.1977s/iter; left time: 4470.4040s
	iters: 200, epoch: 46 | loss: 0.1043102
	speed: 0.0506s/iter; left time: 1138.8898s
	iters: 300, epoch: 46 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 965.2186s
	iters: 400, epoch: 46 | loss: 0.0000323
	speed: 0.0443s/iter; left time: 987.9076s
Epoch: 46 cost time: 19.527539253234863
Epoch: 46, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.311 Vali Acc: 0.971 Test Loss: 0.311 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 47 | loss: 0.0000000
	speed: 0.1929s/iter; left time: 4282.7876s
	iters: 200, epoch: 47 | loss: 0.0001773
	speed: 0.0473s/iter; left time: 1045.4010s
	iters: 300, epoch: 47 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 949.6283s
	iters: 400, epoch: 47 | loss: 0.0015115
	speed: 0.0409s/iter; left time: 894.8463s
Epoch: 47 cost time: 18.6924569606781
Epoch: 47, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.174 Vali Acc: 0.979 Test Loss: 0.174 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 48 | loss: 0.0000000
	speed: 0.1969s/iter; left time: 4289.9467s
	iters: 200, epoch: 48 | loss: 0.0001696
	speed: 0.0486s/iter; left time: 1053.2846s
	iters: 300, epoch: 48 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 983.7450s
	iters: 400, epoch: 48 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 884.9958s
Epoch: 48 cost time: 19.18518304824829
Epoch: 48, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.231 Vali Acc: 0.981 Test Loss: 0.231 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 49 | loss: 0.0000000
	speed: 0.2093s/iter; left time: 4474.1700s
	iters: 200, epoch: 49 | loss: 0.0000000
	speed: 0.0429s/iter; left time: 912.1524s
	iters: 300, epoch: 49 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 835.7060s
	iters: 400, epoch: 49 | loss: 0.0000000
	speed: 0.0364s/iter; left time: 767.6744s
Epoch: 49 cost time: 17.110339641571045
Epoch: 49, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.292 Vali Acc: 0.973 Test Loss: 0.292 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 50 | loss: 0.0000000
	speed: 0.2023s/iter; left time: 4241.5137s
	iters: 200, epoch: 50 | loss: 0.3809940
	speed: 0.0462s/iter; left time: 964.7748s
	iters: 300, epoch: 50 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 962.8647s
	iters: 400, epoch: 50 | loss: 0.1472557
	speed: 0.0446s/iter; left time: 921.7225s
Epoch: 50 cost time: 19.264596223831177
Epoch: 50, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.383 Vali Acc: 0.970 Test Loss: 0.383 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 51 | loss: 0.0000000
	speed: 0.2206s/iter; left time: 4533.3546s
	iters: 200, epoch: 51 | loss: 0.0000342
	speed: 0.0516s/iter; left time: 1055.2096s
	iters: 300, epoch: 51 | loss: 0.0000036
	speed: 0.0462s/iter; left time: 939.9996s
	iters: 400, epoch: 51 | loss: 0.0000018
	speed: 0.0475s/iter; left time: 962.1727s
Epoch: 51 cost time: 21.167781352996826
Epoch: 51, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.233 Vali Acc: 0.983 Test Loss: 0.233 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 52 | loss: 0.0000000
	speed: 0.2184s/iter; left time: 4398.2755s
	iters: 200, epoch: 52 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 922.8012s
	iters: 300, epoch: 52 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 885.1966s
	iters: 400, epoch: 52 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 891.8088s
Epoch: 52 cost time: 19.588988065719604
Epoch: 52, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.225 Vali Acc: 0.979 Test Loss: 0.225 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 53 | loss: 0.0000001
	speed: 0.1994s/iter; left time: 3933.7852s
	iters: 200, epoch: 53 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 834.1010s
	iters: 300, epoch: 53 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 954.8425s
	iters: 400, epoch: 53 | loss: 0.0000001
	speed: 0.0445s/iter; left time: 865.3569s
Epoch: 53 cost time: 20.00252914428711
Epoch: 53, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.270 Vali Acc: 0.975 Test Loss: 0.270 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 54 | loss: 0.0000000
	speed: 0.1979s/iter; left time: 3822.6873s
	iters: 200, epoch: 54 | loss: 0.0000002
	speed: 0.0448s/iter; left time: 861.4340s
	iters: 300, epoch: 54 | loss: 0.0000001
	speed: 0.0484s/iter; left time: 925.0820s
	iters: 400, epoch: 54 | loss: 0.2441537
	speed: 0.0387s/iter; left time: 734.8961s
Epoch: 54 cost time: 19.258936405181885
Epoch: 54, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.219 Vali Acc: 0.979 Test Loss: 0.219 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9881764438381082
model parameter : 159882
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8247548
	speed: 0.0900s/iter; left time: 3709.4537s
	iters: 200, epoch: 1 | loss: 0.0117254
	speed: 0.0499s/iter; left time: 2050.7153s
	iters: 300, epoch: 1 | loss: 1.2389841
	speed: 0.0500s/iter; left time: 2051.5379s
	iters: 400, epoch: 1 | loss: 1.1385221
	speed: 0.0509s/iter; left time: 2080.1879s
Epoch: 1 cost time: 24.992953538894653
Epoch: 1, Steps: 413 | Train Loss: 0.422 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
Validation loss decreased (inf --> -0.973623).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0881701
	speed: 0.2465s/iter; left time: 10052.3748s
	iters: 200, epoch: 2 | loss: 0.2083135
	speed: 0.0641s/iter; left time: 2606.1998s
	iters: 300, epoch: 2 | loss: 0.2088971
	speed: 0.0544s/iter; left time: 2207.8180s
	iters: 400, epoch: 2 | loss: 0.7156360
	speed: 0.0513s/iter; left time: 2078.3428s
Epoch: 2 cost time: 25.132878303527832
Epoch: 2, Steps: 413 | Train Loss: 0.165 Vali Loss: 0.254 Vali Acc: 0.959 Test Loss: 0.254 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0009694
	speed: 0.2460s/iter; left time: 9930.3267s
	iters: 200, epoch: 3 | loss: 0.0550362
	speed: 0.0605s/iter; left time: 2434.9352s
	iters: 300, epoch: 3 | loss: 0.0002185
	speed: 0.0523s/iter; left time: 2100.7112s
	iters: 400, epoch: 3 | loss: 0.0411292
	speed: 0.0554s/iter; left time: 2219.3881s
Epoch: 3 cost time: 25.577974557876587
Epoch: 3, Steps: 413 | Train Loss: 0.168 Vali Loss: 0.364 Vali Acc: 0.968 Test Loss: 0.364 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.2417s/iter; left time: 9656.9296s
	iters: 200, epoch: 4 | loss: 0.0293622
	speed: 0.0681s/iter; left time: 2716.3428s
	iters: 300, epoch: 4 | loss: 0.2835426
	speed: 0.0551s/iter; left time: 2192.3332s
	iters: 400, epoch: 4 | loss: 0.0000988
	speed: 0.0527s/iter; left time: 2088.4492s
Epoch: 4 cost time: 26.17181968688965
Epoch: 4, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.540 Vali Acc: 0.934 Test Loss: 0.540 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0000662
	speed: 0.2373s/iter; left time: 9385.3566s
	iters: 200, epoch: 5 | loss: 0.0000001
	speed: 0.0599s/iter; left time: 2364.2553s
	iters: 300, epoch: 5 | loss: 0.5640408
	speed: 0.0508s/iter; left time: 1997.6878s
	iters: 400, epoch: 5 | loss: 0.1994151
	speed: 0.0566s/iter; left time: 2221.8238s
Epoch: 5 cost time: 24.22716450691223
Epoch: 5, Steps: 413 | Train Loss: 0.161 Vali Loss: 0.308 Vali Acc: 0.968 Test Loss: 0.308 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2329s/iter; left time: 9115.9246s
	iters: 200, epoch: 6 | loss: 0.2275666
	speed: 0.0625s/iter; left time: 2439.3603s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 1903.9890s
	iters: 400, epoch: 6 | loss: 0.1583038
	speed: 0.0575s/iter; left time: 2234.5777s
Epoch: 6 cost time: 24.296563625335693
Epoch: 6, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.612 Vali Acc: 0.960 Test Loss: 0.612 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000273
	speed: 0.2956s/iter; left time: 11447.8841s
	iters: 200, epoch: 7 | loss: 0.0004780
	speed: 0.0812s/iter; left time: 3138.1095s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0747s/iter; left time: 2878.0831s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0636s/iter; left time: 2445.5107s
Epoch: 7 cost time: 33.04114270210266
Epoch: 7, Steps: 413 | Train Loss: 0.140 Vali Loss: 0.559 Vali Acc: 0.965 Test Loss: 0.559 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.1412054
	speed: 0.2875s/iter; left time: 11014.8257s
	iters: 200, epoch: 8 | loss: 0.0000004
	speed: 0.0813s/iter; left time: 3106.8151s
	iters: 300, epoch: 8 | loss: 0.0006681
	speed: 0.0773s/iter; left time: 2945.6249s
	iters: 400, epoch: 8 | loss: 0.0001690
	speed: 0.0700s/iter; left time: 2662.1027s
Epoch: 8 cost time: 33.66559648513794
Epoch: 8, Steps: 413 | Train Loss: 0.134 Vali Loss: 0.862 Vali Acc: 0.957 Test Loss: 0.862 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000010
	speed: 0.3004s/iter; left time: 11385.8876s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0679s/iter; left time: 2565.4620s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 2592.4502s
	iters: 400, epoch: 9 | loss: 0.0003348
	speed: 0.0687s/iter; left time: 2584.3483s
Epoch: 9 cost time: 31.368367910385132
Epoch: 9, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.704 Vali Acc: 0.960 Test Loss: 0.704 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2688s/iter; left time: 10075.3706s
	iters: 200, epoch: 10 | loss: 1.3362485
	speed: 0.0667s/iter; left time: 2493.2804s
	iters: 300, epoch: 10 | loss: 0.0000414
	speed: 0.0691s/iter; left time: 2575.6631s
	iters: 400, epoch: 10 | loss: 0.6665661
	speed: 0.0684s/iter; left time: 2542.3697s
Epoch: 10 cost time: 29.842445373535156
Epoch: 10, Steps: 413 | Train Loss: 0.157 Vali Loss: 0.740 Vali Acc: 0.961 Test Loss: 0.740 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.2369355
	speed: 0.2843s/iter; left time: 10538.1018s
	iters: 200, epoch: 11 | loss: 0.0000029
	speed: 0.0702s/iter; left time: 2594.9407s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0682s/iter; left time: 2513.7787s
	iters: 400, epoch: 11 | loss: 0.2904463
	speed: 0.0722s/iter; left time: 2654.6663s
Epoch: 11 cost time: 30.344651222229004
Epoch: 11, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.744 Vali Acc: 0.966 Test Loss: 0.744 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9736243747157799
model parameter : 458314
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2424964
	speed: 0.0876s/iter; left time: 3609.1159s
	iters: 200, epoch: 1 | loss: 0.6902663
	speed: 0.0470s/iter; left time: 1931.2341s
	iters: 300, epoch: 1 | loss: 0.4744365
	speed: 0.0521s/iter; left time: 2134.7150s
	iters: 400, epoch: 1 | loss: 0.0030627
	speed: 0.0633s/iter; left time: 2589.7859s
Epoch: 1 cost time: 25.886884689331055
Epoch: 1, Steps: 413 | Train Loss: 0.389 Vali Loss: 0.224 Vali Acc: 0.954 Test Loss: 0.224 Test Acc: 0.954
Validation loss decreased (inf --> -0.954068).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000106
	speed: 0.2124s/iter; left time: 8662.3566s
	iters: 200, epoch: 2 | loss: 0.0387938
	speed: 0.0495s/iter; left time: 2012.3923s
	iters: 300, epoch: 2 | loss: 0.0016139
	speed: 0.0525s/iter; left time: 2132.2889s
	iters: 400, epoch: 2 | loss: 0.0138399
	speed: 0.0472s/iter; left time: 1909.2095s
Epoch: 2 cost time: 21.63664746284485
Epoch: 2, Steps: 413 | Train Loss: 0.165 Vali Loss: 0.225 Vali Acc: 0.965 Test Loss: 0.225 Test Acc: 0.965
Validation loss decreased (-0.954068 --> -0.964982).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.2201s/iter; left time: 8887.6376s
	iters: 200, epoch: 3 | loss: 0.0001960
	speed: 0.0491s/iter; left time: 1979.4528s
	iters: 300, epoch: 3 | loss: 0.0027025
	speed: 0.0466s/iter; left time: 1871.6699s
	iters: 400, epoch: 3 | loss: 0.0759860
	speed: 0.0502s/iter; left time: 2011.5833s
Epoch: 3 cost time: 20.463061809539795
Epoch: 3, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.242 Vali Acc: 0.957 Test Loss: 0.242 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000348
	speed: 0.2273s/iter; left time: 9082.5684s
	iters: 200, epoch: 4 | loss: 0.2874091
	speed: 0.0456s/iter; left time: 1817.5665s
	iters: 300, epoch: 4 | loss: 0.0000179
	speed: 0.0456s/iter; left time: 1812.4087s
	iters: 400, epoch: 4 | loss: 0.0000055
	speed: 0.0490s/iter; left time: 1944.5168s
Epoch: 4 cost time: 20.64363694190979
Epoch: 4, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.384 Vali Acc: 0.955 Test Loss: 0.384 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0002395
	speed: 0.2409s/iter; left time: 9526.6886s
	iters: 200, epoch: 5 | loss: 0.3786197
	speed: 0.0466s/iter; left time: 1838.3009s
	iters: 300, epoch: 5 | loss: 0.0028737
	speed: 0.0536s/iter; left time: 2107.1419s
	iters: 400, epoch: 5 | loss: 0.1062143
	speed: 0.0526s/iter; left time: 2063.6326s
Epoch: 5 cost time: 22.289042234420776
Epoch: 5, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.384 Vali Acc: 0.946 Test Loss: 0.384 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2590s/iter; left time: 10135.7396s
	iters: 200, epoch: 6 | loss: 1.0281649
	speed: 0.0702s/iter; left time: 2741.0727s
	iters: 300, epoch: 6 | loss: 0.7407090
	speed: 0.0693s/iter; left time: 2698.6742s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0811s/iter; left time: 3148.3140s
Epoch: 6 cost time: 31.33968448638916
Epoch: 6, Steps: 413 | Train Loss: 0.148 Vali Loss: 0.263 Vali Acc: 0.964 Test Loss: 0.263 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2384s/iter; left time: 9230.5304s
	iters: 200, epoch: 7 | loss: 0.0249414
	speed: 0.0641s/iter; left time: 2476.9699s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 2660.9397s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0816s/iter; left time: 3133.6900s
Epoch: 7 cost time: 29.421603441238403
Epoch: 7, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.355 Vali Acc: 0.964 Test Loss: 0.355 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2387s/iter; left time: 9145.6737s
	iters: 200, epoch: 8 | loss: 0.0881484
	speed: 0.0692s/iter; left time: 2642.3058s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0859s/iter; left time: 3274.9355s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0922s/iter; left time: 3502.8102s
Epoch: 8 cost time: 33.15349197387695
Epoch: 8, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.496 Vali Acc: 0.959 Test Loss: 0.496 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000419
	speed: 0.2730s/iter; left time: 10346.6198s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0812s/iter; left time: 3069.7966s
	iters: 300, epoch: 9 | loss: 0.0000004
	speed: 0.0830s/iter; left time: 3128.9602s
	iters: 400, epoch: 9 | loss: 0.0000004
	speed: 0.0681s/iter; left time: 2561.2487s
Epoch: 9 cost time: 32.69985270500183
Epoch: 9, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.723 Vali Acc: 0.945 Test Loss: 0.723 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2934s/iter; left time: 10996.4329s
	iters: 200, epoch: 10 | loss: 0.0000016
	speed: 0.0531s/iter; left time: 1984.5888s
	iters: 300, epoch: 10 | loss: 0.0007285
	speed: 0.0520s/iter; left time: 1940.3688s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0524s/iter; left time: 1950.0788s
Epoch: 10 cost time: 26.02975583076477
Epoch: 10, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.394 Vali Acc: 0.969 Test Loss: 0.394 Test Acc: 0.969
Validation loss decreased (-0.964982 --> -0.969073).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3368694
	speed: 0.2600s/iter; left time: 9639.8391s
	iters: 200, epoch: 11 | loss: 0.0279093
	speed: 0.0574s/iter; left time: 2122.1866s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0529s/iter; left time: 1952.0834s
	iters: 400, epoch: 11 | loss: 0.0000035
	speed: 0.0552s/iter; left time: 2030.2607s
Epoch: 11 cost time: 25.083560705184937
Epoch: 11, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.433 Vali Acc: 0.976 Test Loss: 0.433 Test Acc: 0.976
Validation loss decreased (-0.969073 --> -0.976349).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0003452
	speed: 0.2376s/iter; left time: 8708.5730s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1854.5144s
	iters: 300, epoch: 12 | loss: 0.0538018
	speed: 0.0500s/iter; left time: 1823.4791s
	iters: 400, epoch: 12 | loss: 0.0000048
	speed: 0.0526s/iter; left time: 1913.6460s
Epoch: 12 cost time: 23.253782033920288
Epoch: 12, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.617 Vali Acc: 0.965 Test Loss: 0.617 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2393s/iter; left time: 8674.3256s
	iters: 200, epoch: 13 | loss: 1.0477581
	speed: 0.0494s/iter; left time: 1785.9874s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0512s/iter; left time: 1844.3708s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1695.4736s
Epoch: 13 cost time: 21.200706243515015
Epoch: 13, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.708 Vali Acc: 0.964 Test Loss: 0.708 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000172
	speed: 0.2186s/iter; left time: 7832.5422s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 1847.7789s
	iters: 300, epoch: 14 | loss: 0.8422495
	speed: 0.0514s/iter; left time: 1831.1133s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0553s/iter; left time: 1963.4522s
Epoch: 14 cost time: 22.996866941452026
Epoch: 14, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.431 Vali Acc: 0.975 Test Loss: 0.431 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2296s/iter; left time: 8133.4206s
	iters: 200, epoch: 15 | loss: 0.0010356
	speed: 0.0453s/iter; left time: 1600.9165s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0463s/iter; left time: 1630.8071s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 1675.2774s
Epoch: 15 cost time: 20.755361080169678
Epoch: 15, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.467 Vali Acc: 0.975 Test Loss: 0.467 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2488s/iter; left time: 8710.2587s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0724s/iter; left time: 2525.6024s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0700s/iter; left time: 2436.9749s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0678s/iter; left time: 2352.5342s
Epoch: 16 cost time: 29.645135641098022
Epoch: 16, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.597 Vali Acc: 0.966 Test Loss: 0.597 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2416449
	speed: 0.2580s/iter; left time: 8923.4090s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0658s/iter; left time: 2268.2029s
	iters: 300, epoch: 17 | loss: 1.0068967
	speed: 0.0646s/iter; left time: 2221.3928s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 2315.9087s
Epoch: 17 cost time: 29.29203486442566
Epoch: 17, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.496 Vali Acc: 0.970 Test Loss: 0.496 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000159
	speed: 0.2711s/iter; left time: 9266.4050s
	iters: 200, epoch: 18 | loss: 0.0101674
	speed: 0.0902s/iter; left time: 3072.4956s
	iters: 300, epoch: 18 | loss: 0.5632220
	speed: 0.0791s/iter; left time: 2686.6969s
	iters: 400, epoch: 18 | loss: 0.2415793
	speed: 0.0675s/iter; left time: 2286.1227s
Epoch: 18 cost time: 33.88429498672485
Epoch: 18, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.626 Vali Acc: 0.972 Test Loss: 0.626 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0002619
	speed: 0.2745s/iter; left time: 9268.1031s
	iters: 200, epoch: 19 | loss: 0.2106154
	speed: 0.0791s/iter; left time: 2663.6865s
	iters: 300, epoch: 19 | loss: 1.5194547
	speed: 0.0666s/iter; left time: 2235.2093s
	iters: 400, epoch: 19 | loss: 1.0716345
	speed: 0.0678s/iter; left time: 2269.9757s
Epoch: 19 cost time: 31.95725727081299
Epoch: 19, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.581 Vali Acc: 0.970 Test Loss: 0.581 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2699s/iter; left time: 9003.0211s
	iters: 200, epoch: 20 | loss: 0.0046448
	speed: 0.0572s/iter; left time: 1900.6988s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 1633.0948s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0484s/iter; left time: 1601.3092s
Epoch: 20 cost time: 25.03487777709961
Epoch: 20, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.701 Vali Acc: 0.965 Test Loss: 0.701 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000005
	speed: 0.2424s/iter; left time: 7984.4400s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0636s/iter; left time: 2089.3347s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 1936.2534s
	iters: 400, epoch: 21 | loss: 1.5996416
	speed: 0.0480s/iter; left time: 1565.3665s
Epoch: 21 cost time: 25.219374179840088
Epoch: 21, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.726 Vali Acc: 0.963 Test Loss: 0.726 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 325322
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2128431
	speed: 0.0971s/iter; left time: 3999.4121s
	iters: 200, epoch: 1 | loss: 0.0202446
	speed: 0.0626s/iter; left time: 2571.4873s
	iters: 300, epoch: 1 | loss: 0.0774003
	speed: 0.0548s/iter; left time: 2248.6630s
	iters: 400, epoch: 1 | loss: 0.0634281
	speed: 0.0601s/iter; left time: 2458.5946s
Epoch: 1 cost time: 28.227108240127563
Epoch: 1, Steps: 413 | Train Loss: 0.346 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (inf --> -0.951794).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1233474
	speed: 0.2433s/iter; left time: 9923.5571s
	iters: 200, epoch: 2 | loss: 0.0463392
	speed: 0.0621s/iter; left time: 2525.1558s
	iters: 300, epoch: 2 | loss: 0.0408295
	speed: 0.0599s/iter; left time: 2430.3966s
	iters: 400, epoch: 2 | loss: 0.0165510
	speed: 0.0508s/iter; left time: 2055.7667s
Epoch: 2 cost time: 25.31979751586914
Epoch: 2, Steps: 413 | Train Loss: 0.149 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
Validation loss decreased (-0.951794 --> -0.967256).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1248904
	speed: 0.2851s/iter; left time: 11509.9279s
	iters: 200, epoch: 3 | loss: 0.0008988
	speed: 0.0842s/iter; left time: 3390.4408s
	iters: 300, epoch: 3 | loss: 0.0000440
	speed: 0.0811s/iter; left time: 3258.6310s
	iters: 400, epoch: 3 | loss: 0.0148331
	speed: 0.0739s/iter; left time: 2960.0139s
Epoch: 3 cost time: 34.05368113517761
Epoch: 3, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.258 Vali Acc: 0.963 Test Loss: 0.258 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000027
	speed: 0.2915s/iter; left time: 11648.0737s
	iters: 200, epoch: 4 | loss: 0.0001687
	speed: 0.0852s/iter; left time: 3397.0528s
	iters: 300, epoch: 4 | loss: 0.4965654
	speed: 0.0717s/iter; left time: 2850.3466s
	iters: 400, epoch: 4 | loss: 0.0000193
	speed: 0.0656s/iter; left time: 2599.9549s
Epoch: 4 cost time: 32.759376764297485
Epoch: 4, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.232 Vali Acc: 0.967 Test Loss: 0.232 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1281180
	speed: 0.2791s/iter; left time: 11037.3866s
	iters: 200, epoch: 5 | loss: 0.1211808
	speed: 0.0824s/iter; left time: 3250.0259s
	iters: 300, epoch: 5 | loss: 0.0000114
	speed: 0.0775s/iter; left time: 3049.2176s
	iters: 400, epoch: 5 | loss: 0.0000006
	speed: 0.0685s/iter; left time: 2688.0952s
Epoch: 5 cost time: 32.96771860122681
Epoch: 5, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.379 Vali Acc: 0.959 Test Loss: 0.379 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000950
	speed: 0.2668s/iter; left time: 10440.3498s
	iters: 200, epoch: 6 | loss: 0.0000016
	speed: 0.0813s/iter; left time: 3173.1056s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 2707.9405s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0571s/iter; left time: 2218.4751s
Epoch: 6 cost time: 31.274830102920532
Epoch: 6, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.261 Vali Acc: 0.970 Test Loss: 0.261 Test Acc: 0.970
Validation loss decreased (-0.967256 --> -0.969529).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2407s/iter; left time: 9321.8891s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.0548s/iter; left time: 2115.6313s
	iters: 300, epoch: 7 | loss: 0.1221622
	speed: 0.0522s/iter; left time: 2010.8633s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 1795.3967s
Epoch: 7 cost time: 22.694966793060303
Epoch: 7, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.345 Vali Acc: 0.965 Test Loss: 0.345 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0302697
	speed: 0.2228s/iter; left time: 8536.8710s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 2363.6672s
	iters: 300, epoch: 8 | loss: 0.0000010
	speed: 0.0653s/iter; left time: 2487.2123s
	iters: 400, epoch: 8 | loss: 0.0014986
	speed: 0.0458s/iter; left time: 1741.9003s
Epoch: 8 cost time: 24.698354482650757
Epoch: 8, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.375 Vali Acc: 0.968 Test Loss: 0.375 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2032s/iter; left time: 7701.3899s
	iters: 200, epoch: 9 | loss: 0.0000007
	speed: 0.0567s/iter; left time: 2141.8414s
	iters: 300, epoch: 9 | loss: 0.0325213
	speed: 0.0587s/iter; left time: 2212.6301s
	iters: 400, epoch: 9 | loss: 0.0048897
	speed: 0.0536s/iter; left time: 2015.7261s
Epoch: 9 cost time: 22.79828405380249
Epoch: 9, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.854 Vali Acc: 0.940 Test Loss: 0.854 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2100s/iter; left time: 7871.2655s
	iters: 200, epoch: 10 | loss: 0.0055988
	speed: 0.0505s/iter; left time: 1888.2680s
	iters: 300, epoch: 10 | loss: 0.0000016
	speed: 0.0519s/iter; left time: 1936.6945s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 1961.2685s
Epoch: 10 cost time: 21.788798570632935
Epoch: 10, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.308 Vali Acc: 0.975 Test Loss: 0.308 Test Acc: 0.975
Validation loss decreased (-0.969529 --> -0.974986).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0001687
	speed: 0.2360s/iter; left time: 8749.2922s
	iters: 200, epoch: 11 | loss: 0.0000019
	speed: 0.0551s/iter; left time: 2036.6582s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0600s/iter; left time: 2213.1858s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0582s/iter; left time: 2139.3849s
Epoch: 11 cost time: 24.878801345825195
Epoch: 11, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.402 Vali Acc: 0.973 Test Loss: 0.402 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2231s/iter; left time: 8178.2317s
	iters: 200, epoch: 12 | loss: 0.0000006
	speed: 0.0490s/iter; left time: 1789.6913s
	iters: 300, epoch: 12 | loss: 0.9639564
	speed: 0.0539s/iter; left time: 1965.4222s
	iters: 400, epoch: 12 | loss: 0.0005520
	speed: 0.0550s/iter; left time: 2001.2084s
Epoch: 12 cost time: 21.919246673583984
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.548 Vali Acc: 0.966 Test Loss: 0.548 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2443s/iter; left time: 8852.8772s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0743s/iter; left time: 2685.6131s
	iters: 300, epoch: 13 | loss: 0.0000224
	speed: 0.0571s/iter; left time: 2059.6782s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0763s/iter; left time: 2742.4577s
Epoch: 13 cost time: 29.311933279037476
Epoch: 13, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.352 Vali Acc: 0.977 Test Loss: 0.352 Test Acc: 0.977
Validation loss decreased (-0.974986 --> -0.977259).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2495s/iter; left time: 8939.0847s
	iters: 200, epoch: 14 | loss: 0.0000010
	speed: 0.0726s/iter; left time: 2592.7110s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2746.4343s
	iters: 400, epoch: 14 | loss: 0.0019872
	speed: 0.0775s/iter; left time: 2752.5990s
Epoch: 14 cost time: 30.841781854629517
Epoch: 14, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.377 Vali Acc: 0.975 Test Loss: 0.377 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000030
	speed: 0.2567s/iter; left time: 9091.6716s
	iters: 200, epoch: 15 | loss: 0.0000037
	speed: 0.0635s/iter; left time: 2242.0564s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 2347.2480s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0792s/iter; left time: 2780.3078s
Epoch: 15 cost time: 29.167120456695557
Epoch: 15, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.401 Vali Acc: 0.975 Test Loss: 0.401 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0004562
	speed: 0.2516s/iter; left time: 8807.9496s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0645s/iter; left time: 2250.9241s
	iters: 300, epoch: 16 | loss: 0.0000011
	speed: 0.0632s/iter; left time: 2200.8945s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0809s/iter; left time: 2807.9695s
Epoch: 16 cost time: 28.983774423599243
Epoch: 16, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.600 Vali Acc: 0.965 Test Loss: 0.600 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2475s/iter; left time: 8562.7224s
	iters: 200, epoch: 17 | loss: 0.5873588
	speed: 0.0702s/iter; left time: 2420.6052s
	iters: 300, epoch: 17 | loss: 0.0000002
	speed: 0.0715s/iter; left time: 2459.6575s
	iters: 400, epoch: 17 | loss: 0.0000397
	speed: 0.0601s/iter; left time: 2060.8465s
Epoch: 17 cost time: 29.29661512374878
Epoch: 17, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.372 Vali Acc: 0.975 Test Loss: 0.372 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2332s/iter; left time: 7971.6171s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 1626.3598s
	iters: 300, epoch: 18 | loss: 0.0000384
	speed: 0.0477s/iter; left time: 1619.1929s
	iters: 400, epoch: 18 | loss: 0.0000014
	speed: 0.0551s/iter; left time: 1867.8920s
Epoch: 18 cost time: 21.629982948303223
Epoch: 18, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.523 Vali Acc: 0.966 Test Loss: 0.523 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0019390
	speed: 0.2479s/iter; left time: 8372.2293s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0594s/iter; left time: 2000.0963s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0646s/iter; left time: 2169.1791s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 1919.4747s
Epoch: 19 cost time: 25.788264513015747
Epoch: 19, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.462 Vali Acc: 0.974 Test Loss: 0.462 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.6150080
	speed: 0.2361s/iter; left time: 7875.5916s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 1865.8078s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0600s/iter; left time: 1988.6262s
	iters: 400, epoch: 20 | loss: 0.0000003
	speed: 0.0532s/iter; left time: 1757.0750s
Epoch: 20 cost time: 24.611815452575684
Epoch: 20, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.577 Vali Acc: 0.969 Test Loss: 0.577 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2383s/iter; left time: 7848.6078s
	iters: 200, epoch: 21 | loss: 0.0153759
	speed: 0.0553s/iter; left time: 1815.9626s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1519.5777s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0513s/iter; left time: 1676.0388s
Epoch: 21 cost time: 22.277209758758545
Epoch: 21, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.487 Vali Acc: 0.975 Test Loss: 0.487 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000441
	speed: 0.2676s/iter; left time: 8703.2224s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 2007.3976s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0590s/iter; left time: 1906.2114s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 1830.0384s
Epoch: 22 cost time: 25.596936464309692
Epoch: 22, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.425 Vali Acc: 0.977 Test Loss: 0.425 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2636s/iter; left time: 8465.6183s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0696s/iter; left time: 2227.0572s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0627s/iter; left time: 2001.4239s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 1819.0293s
Epoch: 23 cost time: 27.129279136657715
Epoch: 23, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.238 Vali Acc: 0.985 Test Loss: 0.238 Test Acc: 0.985
Validation loss decreased (-0.977259 --> -0.984536).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0230574
	speed: 0.3441s/iter; left time: 10909.2448s
	iters: 200, epoch: 24 | loss: 0.0000248
	speed: 0.1052s/iter; left time: 3325.9765s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0825s/iter; left time: 2597.3917s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0835s/iter; left time: 2623.5285s
Epoch: 24 cost time: 40.74808955192566
Epoch: 24, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.449 Vali Acc: 0.972 Test Loss: 0.449 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.3196s/iter; left time: 9999.0952s
	iters: 200, epoch: 25 | loss: 0.0019717
	speed: 0.1015s/iter; left time: 3164.9048s
	iters: 300, epoch: 25 | loss: 0.0416988
	speed: 0.0811s/iter; left time: 2520.9819s
	iters: 400, epoch: 25 | loss: 0.0000022
	speed: 0.0736s/iter; left time: 2280.4809s
Epoch: 25 cost time: 39.04413962364197
Epoch: 25, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.459 Vali Acc: 0.974 Test Loss: 0.459 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2805s/iter; left time: 8661.9863s
	iters: 200, epoch: 26 | loss: 1.3392732
	speed: 0.0773s/iter; left time: 2379.8213s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0727s/iter; left time: 2230.7781s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0730s/iter; left time: 2230.5922s
Epoch: 26 cost time: 32.616268157958984
Epoch: 26, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.276 Vali Acc: 0.980 Test Loss: 0.276 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.3304s/iter; left time: 10065.8059s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.1010s/iter; left time: 3066.6714s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.1032s/iter; left time: 3121.6956s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.1155s/iter; left time: 3482.5870s
Epoch: 27 cost time: 45.293434381484985
Epoch: 27, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.376 Vali Acc: 0.976 Test Loss: 0.376 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.3702s/iter; left time: 11123.4954s
	iters: 200, epoch: 28 | loss: 0.0003636
	speed: 0.0977s/iter; left time: 2926.6033s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0890s/iter; left time: 2656.8507s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0757s/iter; left time: 2252.7083s
Epoch: 28 cost time: 39.903865337371826
Epoch: 28, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.510 Vali Acc: 0.972 Test Loss: 0.510 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2890s/iter; left time: 8566.4374s
	iters: 200, epoch: 29 | loss: 0.0007627
	speed: 0.0782s/iter; left time: 2311.0191s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 2251.9627s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0850s/iter; left time: 2493.2715s
Epoch: 29 cost time: 34.17928123474121
Epoch: 29, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.532 Vali Acc: 0.967 Test Loss: 0.532 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2855s/iter; left time: 8343.0624s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 1595.6975s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0589s/iter; left time: 1708.0651s
	iters: 400, epoch: 30 | loss: 0.0001221
	speed: 0.0533s/iter; left time: 1542.2106s
Epoch: 30 cost time: 25.031548261642456
Epoch: 30, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.537 Vali Acc: 0.973 Test Loss: 0.537 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.3195s/iter; left time: 9204.4275s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0706s/iter; left time: 2025.6006s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 1857.3415s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 1958.8708s
Epoch: 31 cost time: 32.42686986923218
Epoch: 31, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.507 Vali Acc: 0.976 Test Loss: 0.507 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.3299s/iter; left time: 9368.2916s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0885s/iter; left time: 2505.5494s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0703s/iter; left time: 1983.2552s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0738s/iter; left time: 2074.7033s
Epoch: 32 cost time: 35.66321682929993
Epoch: 32, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.587 Vali Acc: 0.971 Test Loss: 0.587 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.3303s/iter; left time: 9242.7571s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0844s/iter; left time: 2354.0431s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0630s/iter; left time: 1750.0449s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0799s/iter; left time: 2211.1569s
Epoch: 33 cost time: 34.058308362960815
Epoch: 33, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.556 Vali Acc: 0.974 Test Loss: 0.556 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 258890
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1894488
	speed: 0.1524s/iter; left time: 6277.9962s
	iters: 200, epoch: 1 | loss: 0.3444794
	speed: 0.1137s/iter; left time: 4673.4090s
	iters: 300, epoch: 1 | loss: 0.0333198
	speed: 0.1158s/iter; left time: 4747.1207s
	iters: 400, epoch: 1 | loss: 0.6267662
	speed: 0.1062s/iter; left time: 4342.8939s
Epoch: 1 cost time: 49.931495666503906
Epoch: 1, Steps: 413 | Train Loss: 0.365 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
Validation loss decreased (inf --> -0.967712).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1111508
	speed: 0.3163s/iter; left time: 12900.0434s
	iters: 200, epoch: 2 | loss: 0.5682454
	speed: 0.1171s/iter; left time: 4763.3247s
	iters: 300, epoch: 2 | loss: 0.0000564
	speed: 0.1115s/iter; left time: 4527.5206s
	iters: 400, epoch: 2 | loss: 0.2595053
	speed: 0.0913s/iter; left time: 3695.0106s
Epoch: 2 cost time: 44.0683696269989
Epoch: 2, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
Validation loss decreased (-0.967712 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0028752
	speed: 0.3472s/iter; left time: 14018.0446s
	iters: 200, epoch: 3 | loss: 0.0000223
	speed: 0.1200s/iter; left time: 4833.0312s
	iters: 300, epoch: 3 | loss: 0.0005282
	speed: 0.1042s/iter; left time: 4187.8996s
	iters: 400, epoch: 3 | loss: 0.0004518
	speed: 0.1017s/iter; left time: 4073.7890s
Epoch: 3 cost time: 46.839813232421875
Epoch: 3, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.163 Vali Acc: 0.966 Test Loss: 0.163 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000019
	speed: 0.3589s/iter; left time: 14343.7107s
	iters: 200, epoch: 4 | loss: 0.1082652
	speed: 0.0994s/iter; left time: 3962.2641s
	iters: 300, epoch: 4 | loss: 0.0002135
	speed: 0.0985s/iter; left time: 3915.3643s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0972s/iter; left time: 3855.6043s
Epoch: 4 cost time: 44.407790184020996
Epoch: 4, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.349 Vali Acc: 0.957 Test Loss: 0.349 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0005453
	speed: 0.3463s/iter; left time: 13695.7743s
	iters: 200, epoch: 5 | loss: 0.0007392
	speed: 0.1063s/iter; left time: 4193.0023s
	iters: 300, epoch: 5 | loss: 0.0255875
	speed: 0.0934s/iter; left time: 3674.7766s
	iters: 400, epoch: 5 | loss: 0.5118638
	speed: 0.0940s/iter; left time: 3690.3696s
Epoch: 5 cost time: 42.93756556510925
Epoch: 5, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.325 Vali Acc: 0.959 Test Loss: 0.325 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0013951
	speed: 0.3077s/iter; left time: 12043.7803s
	iters: 200, epoch: 6 | loss: 0.4453918
	speed: 0.0799s/iter; left time: 3118.6345s
	iters: 300, epoch: 6 | loss: 0.0000343
	speed: 0.0793s/iter; left time: 3087.3994s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 2972.4195s
Epoch: 6 cost time: 35.33100342750549
Epoch: 6, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.244 Vali Acc: 0.971 Test Loss: 0.244 Test Acc: 0.971
Validation loss decreased (-0.968621 --> -0.970893).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2981s/iter; left time: 11543.7968s
	iters: 200, epoch: 7 | loss: 0.0000968
	speed: 0.0720s/iter; left time: 2779.7495s
	iters: 300, epoch: 7 | loss: 0.0000225
	speed: 0.0848s/iter; left time: 3268.5515s
	iters: 400, epoch: 7 | loss: 0.0000072
	speed: 0.0714s/iter; left time: 2744.4677s
Epoch: 7 cost time: 33.545249223709106
Epoch: 7, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.330 Vali Acc: 0.958 Test Loss: 0.330 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000009
	speed: 0.3013s/iter; left time: 11543.3720s
	iters: 200, epoch: 8 | loss: 0.0000003
	speed: 0.0908s/iter; left time: 3469.0260s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0756s/iter; left time: 2879.3621s
	iters: 400, epoch: 8 | loss: 0.0018536
	speed: 0.0535s/iter; left time: 2032.7141s
Epoch: 8 cost time: 32.52646565437317
Epoch: 8, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.393 Vali Acc: 0.956 Test Loss: 0.393 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0007437
	speed: 0.2431s/iter; left time: 9211.8908s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0845s/iter; left time: 3192.6343s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0757s/iter; left time: 2853.8200s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0701s/iter; left time: 2634.1612s
Epoch: 9 cost time: 31.277925729751587
Epoch: 9, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.165 Vali Acc: 0.979 Test Loss: 0.165 Test Acc: 0.979
Validation loss decreased (-0.970893 --> -0.978625).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0142741
	speed: 0.2900s/iter; left time: 10869.0729s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 3240.0522s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0723s/iter; left time: 2694.4082s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 2268.0721s
Epoch: 10 cost time: 32.664708852767944
Epoch: 10, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.194 Vali Acc: 0.982 Test Loss: 0.194 Test Acc: 0.982
Validation loss decreased (-0.978625 --> -0.981808).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0147130
	speed: 0.2740s/iter; left time: 10158.4332s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0948s/iter; left time: 3505.2459s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1015s/iter; left time: 3741.9720s
	iters: 400, epoch: 11 | loss: 0.0185448
	speed: 0.0876s/iter; left time: 3220.0707s
Epoch: 11 cost time: 38.41665005683899
Epoch: 11, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.459 Vali Acc: 0.961 Test Loss: 0.459 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2988s/iter; left time: 10952.2974s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1000s/iter; left time: 3654.6121s
	iters: 300, epoch: 12 | loss: 0.0005382
	speed: 0.1042s/iter; left time: 3799.3806s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0866s/iter; left time: 3149.0880s
Epoch: 12 cost time: 40.76947522163391
Epoch: 12, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.360 Vali Acc: 0.974 Test Loss: 0.360 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3098s/iter; left time: 11229.8685s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1107s/iter; left time: 4000.5415s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1318s/iter; left time: 4749.3157s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1226s/iter; left time: 4408.3163s
Epoch: 13 cost time: 49.34523892402649
Epoch: 13, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.297 Vali Acc: 0.977 Test Loss: 0.297 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3513s/iter; left time: 12586.1858s
	iters: 200, epoch: 14 | loss: 0.0000019
	speed: 0.1184s/iter; left time: 4229.4912s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1085s/iter; left time: 3865.2702s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1038s/iter; left time: 3687.4038s
Epoch: 14 cost time: 47.095862865448
Epoch: 14, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.271 Vali Acc: 0.980 Test Loss: 0.271 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.3198597
	speed: 0.3209s/iter; left time: 11367.5165s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1264s/iter; left time: 4465.6007s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1112s/iter; left time: 3917.0408s
	iters: 400, epoch: 15 | loss: 0.0000308
	speed: 0.0894s/iter; left time: 3139.6173s
Epoch: 15 cost time: 45.30522394180298
Epoch: 15, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.330 Vali Acc: 0.974 Test Loss: 0.330 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000042
	speed: 0.3154s/iter; left time: 11040.9291s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 3121.8421s
	iters: 300, epoch: 16 | loss: 0.0000003
	speed: 0.0749s/iter; left time: 2608.4386s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0550s/iter; left time: 1908.2490s
Epoch: 16 cost time: 32.999263048172
Epoch: 16, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.397 Vali Acc: 0.975 Test Loss: 0.397 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0093035
	speed: 0.2607s/iter; left time: 9017.0463s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 2616.4854s
	iters: 300, epoch: 17 | loss: 0.0396610
	speed: 0.0802s/iter; left time: 2758.1881s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 2370.8137s
Epoch: 17 cost time: 29.793177843093872
Epoch: 17, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.289 Vali Acc: 0.980 Test Loss: 0.289 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000046
	speed: 0.2795s/iter; left time: 9554.2049s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0783s/iter; left time: 2668.6646s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0735s/iter; left time: 2497.0783s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0708s/iter; left time: 2399.4797s
Epoch: 18 cost time: 31.580157995224
Epoch: 18, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.442 Vali Acc: 0.969 Test Loss: 0.442 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000012
	speed: 0.2928s/iter; left time: 9888.1461s
	iters: 200, epoch: 19 | loss: 0.0025231
	speed: 0.0766s/iter; left time: 2580.3144s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 2741.3677s
	iters: 400, epoch: 19 | loss: 0.3201812
	speed: 0.0754s/iter; left time: 2524.8598s
Epoch: 19 cost time: 31.96213722229004
Epoch: 19, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.388 Vali Acc: 0.974 Test Loss: 0.388 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2522s/iter; left time: 8410.4704s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0700s/iter; left time: 2328.3053s
	iters: 300, epoch: 20 | loss: 0.0006835
	speed: 0.0808s/iter; left time: 2679.4204s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 2295.6034s
Epoch: 20 cost time: 31.280855894088745
Epoch: 20, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.266 Vali Acc: 0.980 Test Loss: 0.266 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 217482
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0957194
	speed: 0.1233s/iter; left time: 5079.1862s
	iters: 200, epoch: 1 | loss: 0.3426870
	speed: 0.0925s/iter; left time: 3803.5524s
	iters: 300, epoch: 1 | loss: 0.4147689
	speed: 0.0813s/iter; left time: 3334.7405s
	iters: 400, epoch: 1 | loss: 0.0140108
	speed: 0.0796s/iter; left time: 3257.7527s
Epoch: 1 cost time: 38.979785203933716
Epoch: 1, Steps: 413 | Train Loss: 0.372 Vali Loss: 0.144 Vali Acc: 0.950 Test Loss: 0.144 Test Acc: 0.950
Validation loss decreased (inf --> -0.949976).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0089622
	speed: 0.2931s/iter; left time: 11955.0268s
	iters: 200, epoch: 2 | loss: 0.0927597
	speed: 0.0886s/iter; left time: 3604.6372s
	iters: 300, epoch: 2 | loss: 0.0000865
	speed: 0.0838s/iter; left time: 3402.3196s
	iters: 400, epoch: 2 | loss: 0.2932105
	speed: 0.0916s/iter; left time: 3707.2633s
Epoch: 2 cost time: 38.4373939037323
Epoch: 2, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.949976 --> -0.969985).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000101
	speed: 0.3115s/iter; left time: 12575.9273s
	iters: 200, epoch: 3 | loss: 0.0991527
	speed: 0.0784s/iter; left time: 3159.0671s
	iters: 300, epoch: 3 | loss: 0.0245686
	speed: 0.0915s/iter; left time: 3675.8310s
	iters: 400, epoch: 3 | loss: 0.1182636
	speed: 0.0887s/iter; left time: 3556.6072s
Epoch: 3 cost time: 38.67030715942383
Epoch: 3, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.202 Vali Acc: 0.956 Test Loss: 0.202 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0029365
	speed: 0.3138s/iter; left time: 12538.3576s
	iters: 200, epoch: 4 | loss: 0.0019538
	speed: 0.0804s/iter; left time: 3206.3313s
	iters: 300, epoch: 4 | loss: 0.0004432
	speed: 0.0821s/iter; left time: 3263.8273s
	iters: 400, epoch: 4 | loss: 0.0000002
	speed: 0.0903s/iter; left time: 3580.5517s
Epoch: 4 cost time: 38.31347370147705
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.969985 --> -0.974533).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0104133
	speed: 0.2861s/iter; left time: 11314.3086s
	iters: 200, epoch: 5 | loss: 0.0000701
	speed: 0.0648s/iter; left time: 2557.0332s
	iters: 300, epoch: 5 | loss: 0.0115652
	speed: 0.0681s/iter; left time: 2681.1812s
	iters: 400, epoch: 5 | loss: 0.0606442
	speed: 0.0666s/iter; left time: 2614.1627s
Epoch: 5 cost time: 31.148507118225098
Epoch: 5, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.218 Vali Acc: 0.970 Test Loss: 0.218 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4686645
	speed: 0.2515s/iter; left time: 9841.2212s
	iters: 200, epoch: 6 | loss: 0.4427086
	speed: 0.0787s/iter; left time: 3070.8039s
	iters: 300, epoch: 6 | loss: 0.0000004
	speed: 0.0519s/iter; left time: 2021.4935s
	iters: 400, epoch: 6 | loss: 0.1347099
	speed: 0.0584s/iter; left time: 2269.0018s
Epoch: 6 cost time: 29.019669771194458
Epoch: 6, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.162 Vali Acc: 0.969 Test Loss: 0.162 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1291247
	speed: 0.2508s/iter; left time: 9710.3948s
	iters: 200, epoch: 7 | loss: 0.0000018
	speed: 0.0771s/iter; left time: 2976.5572s
	iters: 300, epoch: 7 | loss: 0.0000003
	speed: 0.0725s/iter; left time: 2794.3172s
	iters: 400, epoch: 7 | loss: 0.1863803
	speed: 0.0606s/iter; left time: 2330.0759s
Epoch: 7 cost time: 29.36993145942688
Epoch: 7, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.237 Vali Acc: 0.964 Test Loss: 0.237 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0228020
	speed: 0.2237s/iter; left time: 8570.4774s
	iters: 200, epoch: 8 | loss: 0.0000004
	speed: 0.0605s/iter; left time: 2312.2628s
	iters: 300, epoch: 8 | loss: 0.0000022
	speed: 0.0702s/iter; left time: 2674.7930s
	iters: 400, epoch: 8 | loss: 0.0000053
	speed: 0.0684s/iter; left time: 2599.9203s
Epoch: 8 cost time: 27.705728769302368
Epoch: 8, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.253 Vali Acc: 0.969 Test Loss: 0.253 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000022
	speed: 0.2194s/iter; left time: 8314.7058s
	iters: 200, epoch: 9 | loss: 0.0000020
	speed: 0.0614s/iter; left time: 2321.7722s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0582s/iter; left time: 2194.6087s
	iters: 400, epoch: 9 | loss: 0.0000006
	speed: 0.0638s/iter; left time: 2397.7941s
Epoch: 9 cost time: 25.98043203353882
Epoch: 9, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.974533 --> -0.974987).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000008
	speed: 0.2558s/iter; left time: 9587.9341s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0629s/iter; left time: 2351.0440s
	iters: 300, epoch: 10 | loss: 0.0000004
	speed: 0.0620s/iter; left time: 2309.7883s
	iters: 400, epoch: 10 | loss: 0.0001940
	speed: 0.0487s/iter; left time: 1809.4616s
Epoch: 10 cost time: 24.788453817367554
Epoch: 10, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.176 Vali Acc: 0.973 Test Loss: 0.176 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2334s/iter; left time: 8653.9413s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0772s/iter; left time: 2852.4079s
	iters: 300, epoch: 11 | loss: 0.0006992
	speed: 0.0667s/iter; left time: 2457.7819s
	iters: 400, epoch: 11 | loss: 0.0258142
	speed: 0.0654s/iter; left time: 2403.7075s
Epoch: 11 cost time: 29.349740028381348
Epoch: 11, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0027335
	speed: 0.2447s/iter; left time: 8970.7471s
	iters: 200, epoch: 12 | loss: 0.0000064
	speed: 0.1107s/iter; left time: 4048.6981s
	iters: 300, epoch: 12 | loss: 0.0552634
	speed: 0.1034s/iter; left time: 3769.8926s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0912s/iter; left time: 3314.2952s
Epoch: 12 cost time: 39.930859327316284
Epoch: 12, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.174 Vali Acc: 0.978 Test Loss: 0.174 Test Acc: 0.978
Validation loss decreased (-0.974987 --> -0.977715).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000121
	speed: 0.2618s/iter; left time: 9490.3062s
	iters: 200, epoch: 13 | loss: 0.0000024
	speed: 0.1127s/iter; left time: 4073.0778s
	iters: 300, epoch: 13 | loss: 0.0125628
	speed: 0.1008s/iter; left time: 3634.2963s
	iters: 400, epoch: 13 | loss: 0.0000054
	speed: 0.0817s/iter; left time: 2936.9095s
Epoch: 13 cost time: 39.86034822463989
Epoch: 13, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.355 Vali Acc: 0.968 Test Loss: 0.355 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2702s/iter; left time: 9682.4444s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1040s/iter; left time: 3714.4084s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.1080s/iter; left time: 3848.0800s
	iters: 400, epoch: 14 | loss: 0.0000070
	speed: 0.0771s/iter; left time: 2740.8597s
Epoch: 14 cost time: 40.24694323539734
Epoch: 14, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.259 Vali Acc: 0.976 Test Loss: 0.259 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6645747
	speed: 0.2578s/iter; left time: 9131.1777s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0888s/iter; left time: 3137.2413s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0859s/iter; left time: 3023.6097s
	iters: 400, epoch: 15 | loss: 0.1114271
	speed: 0.0773s/iter; left time: 2713.9899s
Epoch: 15 cost time: 34.78696942329407
Epoch: 15, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.199 Vali Acc: 0.980 Test Loss: 0.199 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979534).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000014
	speed: 0.2637s/iter; left time: 9232.0888s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1050s/iter; left time: 3666.6956s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1023s/iter; left time: 3559.5119s
	iters: 400, epoch: 16 | loss: 0.4535669
	speed: 0.0951s/iter; left time: 3299.6368s
Epoch: 16 cost time: 40.92834424972534
Epoch: 16, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.290 Vali Acc: 0.974 Test Loss: 0.290 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.2471s/iter; left time: 8548.6672s
	iters: 200, epoch: 17 | loss: 0.0217018
	speed: 0.0530s/iter; left time: 1828.5374s
	iters: 300, epoch: 17 | loss: 0.0000005
	speed: 0.0675s/iter; left time: 2320.4868s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0540s/iter; left time: 1851.4368s
Epoch: 17 cost time: 25.639731407165527
Epoch: 17, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.248 Vali Acc: 0.980 Test Loss: 0.248 Test Acc: 0.980
Validation loss decreased (-0.979534 --> -0.980443).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2423s/iter; left time: 8283.4058s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0600s/iter; left time: 2043.6541s
	iters: 300, epoch: 18 | loss: 0.2389775
	speed: 0.0563s/iter; left time: 1913.1502s
	iters: 400, epoch: 18 | loss: 0.0000320
	speed: 0.0475s/iter; left time: 1610.5625s
Epoch: 18 cost time: 25.465898990631104
Epoch: 18, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.340 Vali Acc: 0.972 Test Loss: 0.340 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2388s/iter; left time: 8064.2997s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 1988.6799s
	iters: 300, epoch: 19 | loss: 0.2625772
	speed: 0.0523s/iter; left time: 1755.3548s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 2039.9884s
Epoch: 19 cost time: 25.00939631462097
Epoch: 19, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.225 Vali Acc: 0.978 Test Loss: 0.225 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000009
	speed: 0.2199s/iter; left time: 7335.4506s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0604s/iter; left time: 2008.1807s
	iters: 300, epoch: 20 | loss: 0.0000002
	speed: 0.0538s/iter; left time: 1785.2693s
	iters: 400, epoch: 20 | loss: 0.0000002
	speed: 0.0573s/iter; left time: 1894.1930s
Epoch: 20 cost time: 24.88168168067932
Epoch: 20, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.369 Vali Acc: 0.968 Test Loss: 0.369 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2285s/iter; left time: 7527.2298s
	iters: 200, epoch: 21 | loss: 0.0001448
	speed: 0.0681s/iter; left time: 2235.9394s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.0554s/iter; left time: 1814.7887s
	iters: 400, epoch: 21 | loss: 0.6894819
	speed: 0.0526s/iter; left time: 1717.5771s
Epoch: 21 cost time: 25.094324827194214
Epoch: 21, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.312 Vali Acc: 0.970 Test Loss: 0.312 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2301s/iter; left time: 7483.1189s
	iters: 200, epoch: 22 | loss: 0.0000004
	speed: 0.0531s/iter; left time: 1722.4710s
	iters: 300, epoch: 22 | loss: 0.0244607
	speed: 0.0518s/iter; left time: 1674.6022s
	iters: 400, epoch: 22 | loss: 0.0008524
	speed: 0.0579s/iter; left time: 1864.4389s
Epoch: 22 cost time: 24.958407640457153
Epoch: 22, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.385 Vali Acc: 0.970 Test Loss: 0.385 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2466s/iter; left time: 7921.1604s
	iters: 200, epoch: 23 | loss: 0.0000540
	speed: 0.0555s/iter; left time: 1775.8159s
	iters: 300, epoch: 23 | loss: 0.0007976
	speed: 0.0729s/iter; left time: 2326.4051s
	iters: 400, epoch: 23 | loss: 0.3159847
	speed: 0.0968s/iter; left time: 3080.2955s
Epoch: 23 cost time: 30.399534225463867
Epoch: 23, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.246 Vali Acc: 0.977 Test Loss: 0.246 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2849s/iter; left time: 9030.9370s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0889s/iter; left time: 2808.4688s
	iters: 300, epoch: 24 | loss: 0.0011655
	speed: 0.0779s/iter; left time: 2454.6476s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 2729.2143s
Epoch: 24 cost time: 36.25825524330139
Epoch: 24, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.278 Vali Acc: 0.980 Test Loss: 0.278 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.1970436
	speed: 0.2607s/iter; left time: 8156.2710s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0784s/iter; left time: 2444.0912s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 2217.5821s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 2355.6769s
Epoch: 25 cost time: 32.78733944892883
Epoch: 25, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.497 Vali Acc: 0.971 Test Loss: 0.497 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0006694
	speed: 0.2679s/iter; left time: 8270.3952s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0931s/iter; left time: 2866.4039s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 2336.3625s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0893s/iter; left time: 2731.7669s
Epoch: 26 cost time: 37.016082525253296
Epoch: 26, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.470 Vali Acc: 0.974 Test Loss: 0.470 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2770s/iter; left time: 8439.3940s
	iters: 200, epoch: 27 | loss: 0.0000020
	speed: 0.0798s/iter; left time: 2422.4328s
	iters: 300, epoch: 27 | loss: 0.1215469
	speed: 0.0856s/iter; left time: 2589.6206s
	iters: 400, epoch: 27 | loss: 0.0000006
	speed: 0.0798s/iter; left time: 2406.5558s
Epoch: 27 cost time: 34.70479393005371
Epoch: 27, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.289 Vali Acc: 0.975 Test Loss: 0.289 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 176138
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3862742
	speed: 0.0774s/iter; left time: 3187.6508s
	iters: 200, epoch: 1 | loss: 0.6450571
	speed: 0.0458s/iter; left time: 1880.4013s
	iters: 300, epoch: 1 | loss: 0.5964805
	speed: 0.0548s/iter; left time: 2244.9645s
	iters: 400, epoch: 1 | loss: 0.1662363
	speed: 0.0474s/iter; left time: 1939.9455s
Epoch: 1 cost time: 23.17429494857788
Epoch: 1, Steps: 413 | Train Loss: 0.397 Vali Loss: 0.084 Vali Acc: 0.969 Test Loss: 0.084 Test Acc: 0.969
Validation loss decreased (inf --> -0.968621).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0057220
	speed: 0.2430s/iter; left time: 9910.8123s
	iters: 200, epoch: 2 | loss: 0.0013383
	speed: 0.0525s/iter; left time: 2136.8256s
	iters: 300, epoch: 2 | loss: 0.0820702
	speed: 0.0474s/iter; left time: 1925.3745s
	iters: 400, epoch: 2 | loss: 0.0444190
	speed: 0.0502s/iter; left time: 2032.8918s
Epoch: 2 cost time: 22.07166838645935
Epoch: 2, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.111 Vali Acc: 0.963 Test Loss: 0.111 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0528057
	speed: 0.2640s/iter; left time: 10659.6814s
	iters: 200, epoch: 3 | loss: 0.0024273
	speed: 0.0624s/iter; left time: 2512.3602s
	iters: 300, epoch: 3 | loss: 0.0001928
	speed: 0.0605s/iter; left time: 2431.5098s
	iters: 400, epoch: 3 | loss: 0.0006307
	speed: 0.0590s/iter; left time: 2363.4927s
Epoch: 3 cost time: 25.446836471557617
Epoch: 3, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.968621 --> -0.974533).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0002132
	speed: 0.2585s/iter; left time: 10330.7920s
	iters: 200, epoch: 4 | loss: 0.0062187
	speed: 0.0531s/iter; left time: 2116.9983s
	iters: 300, epoch: 4 | loss: 0.0042928
	speed: 0.0519s/iter; left time: 2064.4035s
	iters: 400, epoch: 4 | loss: 0.0000050
	speed: 0.0547s/iter; left time: 2170.1382s
Epoch: 4 cost time: 23.44928503036499
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000516
	speed: 0.2677s/iter; left time: 10586.1469s
	iters: 200, epoch: 5 | loss: 0.0002157
	speed: 0.0629s/iter; left time: 2483.2423s
	iters: 300, epoch: 5 | loss: 0.0000114
	speed: 0.0547s/iter; left time: 2151.0046s
	iters: 400, epoch: 5 | loss: 0.0000549
	speed: 0.0651s/iter; left time: 2553.9878s
Epoch: 5 cost time: 26.673998832702637
Epoch: 5, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0260443
	speed: 0.2874s/iter; left time: 11246.2596s
	iters: 200, epoch: 6 | loss: 0.0003286
	speed: 0.0699s/iter; left time: 2730.5611s
	iters: 300, epoch: 6 | loss: 0.0000241
	speed: 0.0742s/iter; left time: 2888.1004s
	iters: 400, epoch: 6 | loss: 0.0003652
	speed: 0.0607s/iter; left time: 2359.0803s
Epoch: 6 cost time: 30.386411666870117
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.267 Vali Acc: 0.962 Test Loss: 0.267 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0001301
	speed: 0.2653s/iter; left time: 10272.1696s
	iters: 200, epoch: 7 | loss: 0.0000025
	speed: 0.0539s/iter; left time: 2081.1951s
	iters: 300, epoch: 7 | loss: 0.0161575
	speed: 0.0514s/iter; left time: 1978.4501s
	iters: 400, epoch: 7 | loss: 0.0003157
	speed: 0.0503s/iter; left time: 1930.8835s
Epoch: 7 cost time: 22.682955503463745
Epoch: 7, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
Validation loss decreased (-0.974533 --> -0.977261).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0132859
	speed: 0.2164s/iter; left time: 8290.1700s
	iters: 200, epoch: 8 | loss: 0.0000011
	speed: 0.0574s/iter; left time: 2194.2628s
	iters: 300, epoch: 8 | loss: 0.0000021
	speed: 0.0448s/iter; left time: 1707.9521s
	iters: 400, epoch: 8 | loss: 0.0001348
	speed: 0.0680s/iter; left time: 2586.5696s
Epoch: 8 cost time: 24.376028776168823
Epoch: 8, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.193 Vali Acc: 0.971 Test Loss: 0.193 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0031370
	speed: 0.2840s/iter; left time: 10762.3672s
	iters: 200, epoch: 9 | loss: 0.0163762
	speed: 0.0674s/iter; left time: 2548.1788s
	iters: 300, epoch: 9 | loss: 0.0000065
	speed: 0.0657s/iter; left time: 2475.6585s
	iters: 400, epoch: 9 | loss: 1.0165344
	speed: 0.0658s/iter; left time: 2474.4853s
Epoch: 9 cost time: 28.206671476364136
Epoch: 9, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
Validation loss decreased (-0.977261 --> -0.977716).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000023
	speed: 0.3003s/iter; left time: 11257.9490s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0651s/iter; left time: 2432.3737s
	iters: 300, epoch: 10 | loss: 0.0000037
	speed: 0.0706s/iter; left time: 2630.4199s
	iters: 400, epoch: 10 | loss: 0.0917666
	speed: 0.0732s/iter; left time: 2722.7466s
Epoch: 10 cost time: 29.72498083114624
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.328 Vali Acc: 0.957 Test Loss: 0.328 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000082
	speed: 0.2651s/iter; left time: 9828.8558s
	iters: 200, epoch: 11 | loss: 0.0000204
	speed: 0.0640s/iter; left time: 2364.6307s
	iters: 300, epoch: 11 | loss: 0.0479501
	speed: 0.0612s/iter; left time: 2255.4369s
	iters: 400, epoch: 11 | loss: 0.9768200
	speed: 0.0648s/iter; left time: 2383.6057s
Epoch: 11 cost time: 26.679188013076782
Epoch: 11, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.206 Vali Acc: 0.968 Test Loss: 0.206 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0001216
	speed: 0.2712s/iter; left time: 9940.0271s
	iters: 200, epoch: 12 | loss: 0.0000044
	speed: 0.0583s/iter; left time: 2132.7796s
	iters: 300, epoch: 12 | loss: 0.2293449
	speed: 0.0544s/iter; left time: 1984.3504s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 1978.6243s
Epoch: 12 cost time: 24.531464099884033
Epoch: 12, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.191 Vali Acc: 0.973 Test Loss: 0.191 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2554s/iter; left time: 9256.8172s
	iters: 200, epoch: 13 | loss: 0.0000060
	speed: 0.0529s/iter; left time: 1913.7616s
	iters: 300, epoch: 13 | loss: 0.0409623
	speed: 0.0471s/iter; left time: 1697.4104s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0469s/iter; left time: 1684.3900s
Epoch: 13 cost time: 21.597809553146362
Epoch: 13, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2348s/iter; left time: 8413.5757s
	iters: 200, epoch: 14 | loss: 0.0953803
	speed: 0.0495s/iter; left time: 1768.8446s
	iters: 300, epoch: 14 | loss: 0.0000916
	speed: 0.0459s/iter; left time: 1633.9816s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0592s/iter; left time: 2104.3389s
Epoch: 14 cost time: 22.64514422416687
Epoch: 14, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.346 Vali Acc: 0.970 Test Loss: 0.346 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2447s/iter; left time: 8666.5465s
	iters: 200, epoch: 15 | loss: 0.0003048
	speed: 0.0546s/iter; left time: 1930.1430s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 2072.1845s
	iters: 400, epoch: 15 | loss: 0.0000032
	speed: 0.0630s/iter; left time: 2212.3704s
Epoch: 15 cost time: 25.989455461502075
Epoch: 15, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.176 Vali Acc: 0.979 Test Loss: 0.176 Test Acc: 0.979
Validation loss decreased (-0.977716 --> -0.979080).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0153748
	speed: 0.2480s/iter; left time: 8681.8343s
	iters: 200, epoch: 16 | loss: 0.0000405
	speed: 0.0592s/iter; left time: 2067.1784s
	iters: 300, epoch: 16 | loss: 0.0513743
	speed: 0.0651s/iter; left time: 2264.2610s
	iters: 400, epoch: 16 | loss: 0.0001821
	speed: 0.0631s/iter; left time: 2189.8806s
Epoch: 16 cost time: 27.053897380828857
Epoch: 16, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.252 Vali Acc: 0.973 Test Loss: 0.252 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.2468s/iter; left time: 8537.5424s
	iters: 200, epoch: 17 | loss: 0.0000005
	speed: 0.0589s/iter; left time: 2030.8083s
	iters: 300, epoch: 17 | loss: 0.0000503
	speed: 0.0618s/iter; left time: 2126.4863s
	iters: 400, epoch: 17 | loss: 0.0000002
	speed: 0.0606s/iter; left time: 2079.5413s
Epoch: 17 cost time: 25.693737030029297
Epoch: 17, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.180 Vali Acc: 0.981 Test Loss: 0.180 Test Acc: 0.981
Validation loss decreased (-0.979080 --> -0.980899).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1946263
	speed: 0.2642s/iter; left time: 9029.5096s
	iters: 200, epoch: 18 | loss: 0.0000120
	speed: 0.0598s/iter; left time: 2039.6148s
	iters: 300, epoch: 18 | loss: 0.0000181
	speed: 0.0541s/iter; left time: 1836.6268s
	iters: 400, epoch: 18 | loss: 0.0000006
	speed: 0.0465s/iter; left time: 1575.8882s
Epoch: 18 cost time: 23.279157876968384
Epoch: 18, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.279 Vali Acc: 0.976 Test Loss: 0.279 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000005
	speed: 0.2296s/iter; left time: 7752.4394s
	iters: 200, epoch: 19 | loss: 0.0672900
	speed: 0.0571s/iter; left time: 1920.9138s
	iters: 300, epoch: 19 | loss: 0.0000213
	speed: 0.0509s/iter; left time: 1706.9770s
	iters: 400, epoch: 19 | loss: 0.0011671
	speed: 0.0620s/iter; left time: 2075.3540s
Epoch: 19 cost time: 23.761418342590332
Epoch: 19, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.435 Vali Acc: 0.963 Test Loss: 0.435 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2821s/iter; left time: 9409.8747s
	iters: 200, epoch: 20 | loss: 0.0000004
	speed: 0.0560s/iter; left time: 1863.1840s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0573s/iter; left time: 1900.5595s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 1806.0438s
Epoch: 20 cost time: 24.697354316711426
Epoch: 20, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.393 Vali Acc: 0.961 Test Loss: 0.393 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0054326
	speed: 0.2617s/iter; left time: 8619.4810s
	iters: 200, epoch: 21 | loss: 0.0000023
	speed: 0.0557s/iter; left time: 1830.1569s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0667s/iter; left time: 2185.3630s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0618s/iter; left time: 2016.8869s
Epoch: 21 cost time: 25.371950149536133
Epoch: 21, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.442 Vali Acc: 0.960 Test Loss: 0.442 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2753s/iter; left time: 8955.6436s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0746s/iter; left time: 2417.5896s
	iters: 300, epoch: 22 | loss: 0.3109554
	speed: 0.0609s/iter; left time: 1968.6884s
	iters: 400, epoch: 22 | loss: 0.1794886
	speed: 0.0755s/iter; left time: 2432.1387s
Epoch: 22 cost time: 29.36715579032898
Epoch: 22, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.202 Vali Acc: 0.977 Test Loss: 0.202 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000750
	speed: 0.2776s/iter; left time: 8914.8425s
	iters: 200, epoch: 23 | loss: 0.0000015
	speed: 0.0773s/iter; left time: 2475.0174s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0767s/iter; left time: 2448.1293s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0852s/iter; left time: 2710.4270s
Epoch: 23 cost time: 32.53004288673401
Epoch: 23, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.223 Vali Acc: 0.977 Test Loss: 0.223 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0972015
	speed: 0.3205s/iter; left time: 10159.3185s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2458.0105s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0816s/iter; left time: 2569.9817s
	iters: 400, epoch: 24 | loss: 0.0000003
	speed: 0.0831s/iter; left time: 2608.6595s
Epoch: 24 cost time: 33.515432596206665
Epoch: 24, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.181 Vali Acc: 0.979 Test Loss: 0.181 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0006492
	speed: 0.3194s/iter; left time: 9994.5790s
	iters: 200, epoch: 25 | loss: 0.0000531
	speed: 0.0716s/iter; left time: 2232.5094s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 2225.1402s
	iters: 400, epoch: 25 | loss: 0.0001691
	speed: 0.0720s/iter; left time: 2230.5165s
Epoch: 25 cost time: 31.352330923080444
Epoch: 25, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.240 Vali Acc: 0.977 Test Loss: 0.240 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.5500685
	speed: 0.2937s/iter; left time: 9067.3698s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 1945.9794s
	iters: 300, epoch: 26 | loss: 0.0000004
	speed: 0.0632s/iter; left time: 1939.9345s
	iters: 400, epoch: 26 | loss: 0.0000011
	speed: 0.0605s/iter; left time: 1849.3914s
Epoch: 26 cost time: 26.95122742652893
Epoch: 26, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.350 Vali Acc: 0.970 Test Loss: 0.350 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2355s/iter; left time: 7175.0566s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 1535.7331s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 1847.1174s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 1844.9507s
Epoch: 27 cost time: 23.91666078567505
Epoch: 27, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.281 Vali Acc: 0.973 Test Loss: 0.281 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 143178
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7274082
	speed: 0.1012s/iter; left time: 4168.7337s
	iters: 200, epoch: 1 | loss: 0.1883044
	speed: 0.0586s/iter; left time: 2408.7546s
	iters: 300, epoch: 1 | loss: 0.3120593
	speed: 0.0621s/iter; left time: 2544.7787s
	iters: 400, epoch: 1 | loss: 0.2972227
	speed: 0.0609s/iter; left time: 2490.2398s
Epoch: 1 cost time: 29.325448989868164
Epoch: 1, Steps: 413 | Train Loss: 0.442 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0116886
	speed: 0.2563s/iter; left time: 10452.4562s
	iters: 200, epoch: 2 | loss: 0.0070862
	speed: 0.0476s/iter; left time: 1935.2325s
	iters: 300, epoch: 2 | loss: 0.0171165
	speed: 0.0553s/iter; left time: 2243.5930s
	iters: 400, epoch: 2 | loss: 0.0005990
	speed: 0.0524s/iter; left time: 2120.9091s
Epoch: 2 cost time: 22.74014973640442
Epoch: 2, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
Validation loss decreased (-0.957252 --> -0.969531).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0011979
	speed: 0.2635s/iter; left time: 10638.1762s
	iters: 200, epoch: 3 | loss: 0.1849145
	speed: 0.0532s/iter; left time: 2141.1902s
	iters: 300, epoch: 3 | loss: 0.0006220
	speed: 0.0521s/iter; left time: 2092.5039s
	iters: 400, epoch: 3 | loss: 0.0003657
	speed: 0.0468s/iter; left time: 1874.8283s
Epoch: 3 cost time: 22.59748864173889
Epoch: 3, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0042930
	speed: 0.2567s/iter; left time: 10260.1642s
	iters: 200, epoch: 4 | loss: 0.1142081
	speed: 0.0495s/iter; left time: 1971.6084s
	iters: 300, epoch: 4 | loss: 0.0067857
	speed: 0.0523s/iter; left time: 2080.3474s
	iters: 400, epoch: 4 | loss: 0.0007335
	speed: 0.0505s/iter; left time: 2002.4259s
Epoch: 4 cost time: 23.60443639755249
Epoch: 4, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0018292
	speed: 0.2801s/iter; left time: 11076.0331s
	iters: 200, epoch: 5 | loss: 0.0652466
	speed: 0.0687s/iter; left time: 2710.4367s
	iters: 300, epoch: 5 | loss: 0.0000246
	speed: 0.0642s/iter; left time: 2524.2451s
	iters: 400, epoch: 5 | loss: 0.0000462
	speed: 0.0572s/iter; left time: 2246.6469s
Epoch: 5 cost time: 27.180827617645264
Epoch: 5, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
Validation loss decreased (-0.969531 --> -0.970894).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1919492
	speed: 0.3103s/iter; left time: 12143.9606s
	iters: 200, epoch: 6 | loss: 0.0524790
	speed: 0.0784s/iter; left time: 3061.5464s
	iters: 300, epoch: 6 | loss: 0.0000245
	speed: 0.0788s/iter; left time: 3066.6167s
	iters: 400, epoch: 6 | loss: 0.0006581
	speed: 0.0753s/iter; left time: 2925.0447s
Epoch: 6 cost time: 33.7838613986969
Epoch: 6, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.266 Vali Acc: 0.956 Test Loss: 0.266 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000224
	speed: 0.2912s/iter; left time: 11277.7337s
	iters: 200, epoch: 7 | loss: 0.0000352
	speed: 0.0676s/iter; left time: 2611.9899s
	iters: 300, epoch: 7 | loss: 0.6403003
	speed: 0.0784s/iter; left time: 3021.5172s
	iters: 400, epoch: 7 | loss: 0.1385211
	speed: 0.0875s/iter; left time: 3361.0497s
Epoch: 7 cost time: 32.32258105278015
Epoch: 7, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.970894 --> -0.972713).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000264
	speed: 0.2868s/iter; left time: 10987.4042s
	iters: 200, epoch: 8 | loss: 0.0000003
	speed: 0.0647s/iter; left time: 2471.3958s
	iters: 300, epoch: 8 | loss: 0.0000006
	speed: 0.0649s/iter; left time: 2473.2918s
	iters: 400, epoch: 8 | loss: 0.0017010
	speed: 0.0615s/iter; left time: 2338.9359s
Epoch: 8 cost time: 27.267486572265625
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0001643
	speed: 0.2519s/iter; left time: 9547.0486s
	iters: 200, epoch: 9 | loss: 0.4997512
	speed: 0.0395s/iter; left time: 1491.2483s
	iters: 300, epoch: 9 | loss: 0.1526607
	speed: 0.0560s/iter; left time: 2111.1771s
	iters: 400, epoch: 9 | loss: 0.0000009
	speed: 0.0556s/iter; left time: 2091.0524s
Epoch: 9 cost time: 22.091860055923462
Epoch: 9, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.972713 --> -0.974987).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2790s/iter; left time: 10456.9031s
	iters: 200, epoch: 10 | loss: 0.0065063
	speed: 0.0594s/iter; left time: 2219.4968s
	iters: 300, epoch: 10 | loss: 0.4194222
	speed: 0.0636s/iter; left time: 2371.9429s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0589s/iter; left time: 2188.6578s
Epoch: 10 cost time: 26.094977855682373
Epoch: 10, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.202 Vali Acc: 0.970 Test Loss: 0.202 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000345
	speed: 0.2558s/iter; left time: 9482.8137s
	iters: 200, epoch: 11 | loss: 0.0973923
	speed: 0.0489s/iter; left time: 1806.3072s
	iters: 300, epoch: 11 | loss: 0.0072830
	speed: 0.0620s/iter; left time: 2287.1109s
	iters: 400, epoch: 11 | loss: 0.0003772
	speed: 0.0597s/iter; left time: 2196.2918s
Epoch: 11 cost time: 24.213512897491455
Epoch: 11, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.148 Vali Acc: 0.978 Test Loss: 0.148 Test Acc: 0.978
Validation loss decreased (-0.974987 --> -0.978170).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000244
	speed: 0.2596s/iter; left time: 9516.5251s
	iters: 200, epoch: 12 | loss: 0.0000018
	speed: 0.0626s/iter; left time: 2289.9388s
	iters: 300, epoch: 12 | loss: 0.0000143
	speed: 0.0642s/iter; left time: 2340.4665s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0644s/iter; left time: 2339.9792s
Epoch: 12 cost time: 26.67539072036743
Epoch: 12, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2059862
	speed: 0.2813s/iter; left time: 10196.1664s
	iters: 200, epoch: 13 | loss: 0.0001877
	speed: 0.0541s/iter; left time: 1954.3469s
	iters: 300, epoch: 13 | loss: 0.7379729
	speed: 0.0551s/iter; left time: 1985.5493s
	iters: 400, epoch: 13 | loss: 0.0720899
	speed: 0.0606s/iter; left time: 2178.2048s
Epoch: 13 cost time: 25.352022886276245
Epoch: 13, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.214 Vali Acc: 0.976 Test Loss: 0.214 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000027
	speed: 0.2785s/iter; left time: 9979.8994s
	iters: 200, epoch: 14 | loss: 0.0000245
	speed: 0.0643s/iter; left time: 2298.6546s
	iters: 300, epoch: 14 | loss: 0.0000050
	speed: 0.0621s/iter; left time: 2214.2412s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0586s/iter; left time: 2083.0642s
Epoch: 14 cost time: 25.945916414260864
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.227 Vali Acc: 0.972 Test Loss: 0.227 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.2718s/iter; left time: 9625.2158s
	iters: 200, epoch: 15 | loss: 0.0067698
	speed: 0.0619s/iter; left time: 2187.6806s
	iters: 300, epoch: 15 | loss: 0.0000024
	speed: 0.0685s/iter; left time: 2412.6727s
	iters: 400, epoch: 15 | loss: 0.0007215
	speed: 0.0600s/iter; left time: 2108.8303s
Epoch: 15 cost time: 27.500974416732788
Epoch: 15, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.225 Vali Acc: 0.973 Test Loss: 0.225 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000139
	speed: 0.2745s/iter; left time: 9607.4629s
	iters: 200, epoch: 16 | loss: 0.0063801
	speed: 0.0640s/iter; left time: 2232.4686s
	iters: 300, epoch: 16 | loss: 0.0000300
	speed: 0.0761s/iter; left time: 2649.1306s
	iters: 400, epoch: 16 | loss: 0.0000024
	speed: 0.0647s/iter; left time: 2245.6230s
Epoch: 16 cost time: 28.719120264053345
Epoch: 16, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.193 Vali Acc: 0.979 Test Loss: 0.193 Test Acc: 0.979
Validation loss decreased (-0.978170 --> -0.978625).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.2835s/iter; left time: 9807.5345s
	iters: 200, epoch: 17 | loss: 0.0000008
	speed: 0.0596s/iter; left time: 2056.9122s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0580s/iter; left time: 1994.4741s
	iters: 400, epoch: 17 | loss: 0.0000005
	speed: 0.0478s/iter; left time: 1639.8215s
Epoch: 17 cost time: 24.385442972183228
Epoch: 17, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.238 Vali Acc: 0.966 Test Loss: 0.238 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000034
	speed: 0.2832s/iter; left time: 9680.8354s
	iters: 200, epoch: 18 | loss: 0.0000591
	speed: 0.0706s/iter; left time: 2406.0368s
	iters: 300, epoch: 18 | loss: 0.0000780
	speed: 0.0664s/iter; left time: 2257.7395s
	iters: 400, epoch: 18 | loss: 0.2074569
	speed: 0.0712s/iter; left time: 2413.8711s
Epoch: 18 cost time: 29.262149572372437
Epoch: 18, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.305 Vali Acc: 0.972 Test Loss: 0.305 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0012552
	speed: 0.2936s/iter; left time: 9912.3908s
	iters: 200, epoch: 19 | loss: 0.0019625
	speed: 0.0733s/iter; left time: 2468.4327s
	iters: 300, epoch: 19 | loss: 0.0000064
	speed: 0.0749s/iter; left time: 2515.2710s
	iters: 400, epoch: 19 | loss: 0.0005690
	speed: 0.0664s/iter; left time: 2223.7129s
Epoch: 19 cost time: 30.901530981063843
Epoch: 19, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.235 Vali Acc: 0.971 Test Loss: 0.235 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.8836684
	speed: 0.2967s/iter; left time: 9896.3779s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0703s/iter; left time: 2337.1336s
	iters: 300, epoch: 20 | loss: 0.0000004
	speed: 0.0768s/iter; left time: 2547.2031s
	iters: 400, epoch: 20 | loss: 0.0377582
	speed: 0.0701s/iter; left time: 2318.0644s
Epoch: 20 cost time: 30.71236777305603
Epoch: 20, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.260 Vali Acc: 0.972 Test Loss: 0.260 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000247
	speed: 0.2909s/iter; left time: 9583.7776s
	iters: 200, epoch: 21 | loss: 1.0305597
	speed: 0.0605s/iter; left time: 1986.0594s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0655s/iter; left time: 2143.6358s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0727s/iter; left time: 2371.8084s
Epoch: 21 cost time: 28.30448007583618
Epoch: 21, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.176 Vali Acc: 0.978 Test Loss: 0.176 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2805s/iter; left time: 9122.5759s
	iters: 200, epoch: 22 | loss: 0.0000003
	speed: 0.0634s/iter; left time: 2056.4952s
	iters: 300, epoch: 22 | loss: 0.0989794
	speed: 0.0530s/iter; left time: 1714.8332s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 1938.4851s
Epoch: 22 cost time: 26.01560139656067
Epoch: 22, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.250 Vali Acc: 0.971 Test Loss: 0.250 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000016
	speed: 0.2517s/iter; left time: 8082.8468s
	iters: 200, epoch: 23 | loss: 0.0400513
	speed: 0.0614s/iter; left time: 1965.0203s
	iters: 300, epoch: 23 | loss: 0.0000175
	speed: 0.0552s/iter; left time: 1760.2578s
	iters: 400, epoch: 23 | loss: 0.4895848
	speed: 0.0536s/iter; left time: 1705.5983s
Epoch: 23 cost time: 23.83105707168579
Epoch: 23, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.322 Vali Acc: 0.967 Test Loss: 0.322 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2627s/iter; left time: 8327.4958s
	iters: 200, epoch: 24 | loss: 0.1903132
	speed: 0.0614s/iter; left time: 1938.7920s
	iters: 300, epoch: 24 | loss: 0.0000005
	speed: 0.0648s/iter; left time: 2041.2471s
	iters: 400, epoch: 24 | loss: 0.0000002
	speed: 0.0596s/iter; left time: 1870.3877s
Epoch: 24 cost time: 27.122467041015625
Epoch: 24, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.168 Vali Acc: 0.980 Test Loss: 0.168 Test Acc: 0.980
Validation loss decreased (-0.978625 --> -0.980444).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2648s/iter; left time: 8284.8455s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 1504.2784s
	iters: 300, epoch: 25 | loss: 0.0000001
	speed: 0.0625s/iter; left time: 1942.6678s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 1798.6886s
Epoch: 25 cost time: 24.087270975112915
Epoch: 25, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.211 Vali Acc: 0.974 Test Loss: 0.211 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000004
	speed: 0.2615s/iter; left time: 8074.4118s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 1776.6767s
	iters: 300, epoch: 26 | loss: 0.0000125
	speed: 0.0637s/iter; left time: 1953.7598s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.0608s/iter; left time: 1857.6675s
Epoch: 26 cost time: 25.821646451950073
Epoch: 26, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.180 Vali Acc: 0.980 Test Loss: 0.180 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.7848172
	speed: 0.2622s/iter; left time: 7987.3300s
	iters: 200, epoch: 27 | loss: 0.0000032
	speed: 0.0584s/iter; left time: 1773.1343s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 1852.0334s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 1692.3384s
Epoch: 27 cost time: 25.459396839141846
Epoch: 27, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.198 Vali Acc: 0.977 Test Loss: 0.198 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2798s/iter; left time: 8407.4100s
	iters: 200, epoch: 28 | loss: 0.0000708
	speed: 0.0689s/iter; left time: 2062.4556s
	iters: 300, epoch: 28 | loss: 0.0000249
	speed: 0.0640s/iter; left time: 1909.4418s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 2063.8672s
Epoch: 28 cost time: 29.116318464279175
Epoch: 28, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.201 Vali Acc: 0.979 Test Loss: 0.201 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000011
	speed: 0.2836s/iter; left time: 8406.0659s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0614s/iter; left time: 1812.2764s
	iters: 300, epoch: 29 | loss: 0.1807772
	speed: 0.0578s/iter; left time: 1701.5955s
	iters: 400, epoch: 29 | loss: 0.0000113
	speed: 0.0622s/iter; left time: 1824.7344s
Epoch: 29 cost time: 25.89026188850403
Epoch: 29, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2986s/iter; left time: 8726.8775s
	iters: 200, epoch: 30 | loss: 0.0000050
	speed: 0.0688s/iter; left time: 2004.0652s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0681s/iter; left time: 1977.0267s
	iters: 400, epoch: 30 | loss: 0.0000029
	speed: 0.0781s/iter; left time: 2258.3757s
Epoch: 30 cost time: 31.348686695098877
Epoch: 30, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.218 Vali Acc: 0.977 Test Loss: 0.218 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.1472318
	speed: 0.3006s/iter; left time: 8661.5619s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0696s/iter; left time: 1997.8707s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0690s/iter; left time: 1974.2688s
	iters: 400, epoch: 31 | loss: 0.0000128
	speed: 0.0800s/iter; left time: 2280.3949s
Epoch: 31 cost time: 30.482497930526733
Epoch: 31, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.172 Vali Acc: 0.980 Test Loss: 0.172 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.3086s/iter; left time: 8763.6649s
	iters: 200, epoch: 32 | loss: 0.4102739
	speed: 0.0682s/iter; left time: 1929.7088s
	iters: 300, epoch: 32 | loss: 0.0000001
	speed: 0.0731s/iter; left time: 2062.4865s
	iters: 400, epoch: 32 | loss: 0.2302241
	speed: 0.0647s/iter; left time: 1818.4533s
Epoch: 32 cost time: 29.30596899986267
Epoch: 32, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.327 Vali Acc: 0.972 Test Loss: 0.327 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.3071s/iter; left time: 8595.5043s
	iters: 200, epoch: 33 | loss: 0.0000003
	speed: 0.0706s/iter; left time: 1969.4306s
	iters: 300, epoch: 33 | loss: 0.0028377
	speed: 0.0723s/iter; left time: 2009.2699s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0645s/iter; left time: 1786.0478s
Epoch: 33 cost time: 28.70707607269287
Epoch: 33, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.288 Vali Acc: 0.977 Test Loss: 0.288 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0008418
	speed: 0.2752s/iter; left time: 7587.9919s
	iters: 200, epoch: 34 | loss: 0.0000002
	speed: 0.0657s/iter; left time: 1805.5863s
	iters: 300, epoch: 34 | loss: 0.0000826
	speed: 0.0588s/iter; left time: 1608.1231s
	iters: 400, epoch: 34 | loss: 0.0000002
	speed: 0.0559s/iter; left time: 1523.3138s
Epoch: 34 cost time: 26.18492031097412
Epoch: 34, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.292 Vali Acc: 0.975 Test Loss: 0.292 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 126858
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2519022
	speed: 0.1226s/iter; left time: 5052.7442s
	iters: 200, epoch: 1 | loss: 0.1726053
	speed: 0.0883s/iter; left time: 3630.0583s
	iters: 300, epoch: 1 | loss: 0.3430315
	speed: 0.0981s/iter; left time: 4022.6547s
	iters: 400, epoch: 1 | loss: 0.1195289
	speed: 0.1173s/iter; left time: 4797.5614s
Epoch: 1 cost time: 43.6370005607605
Epoch: 1, Steps: 413 | Train Loss: 0.439 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
Validation loss decreased (inf --> -0.955887).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0011867
	speed: 0.2793s/iter; left time: 11392.1599s
	iters: 200, epoch: 2 | loss: 0.0521321
	speed: 0.0722s/iter; left time: 2937.6082s
	iters: 300, epoch: 2 | loss: 0.0000002
	speed: 0.0811s/iter; left time: 3293.3262s
	iters: 400, epoch: 2 | loss: 0.1973833
	speed: 0.0815s/iter; left time: 3298.8941s
Epoch: 2 cost time: 32.2723925113678
Epoch: 2, Steps: 413 | Train Loss: 0.180 Vali Loss: 0.232 Vali Acc: 0.960 Test Loss: 0.232 Test Acc: 0.960
Validation loss decreased (-0.955887 --> -0.959979).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000002
	speed: 0.3051s/iter; left time: 12317.6743s
	iters: 200, epoch: 3 | loss: 0.3441525
	speed: 0.0946s/iter; left time: 3809.7718s
	iters: 300, epoch: 3 | loss: 0.0000120
	speed: 0.0760s/iter; left time: 3053.5064s
	iters: 400, epoch: 3 | loss: 0.0000002
	speed: 0.0782s/iter; left time: 3133.4072s
Epoch: 3 cost time: 34.19984269142151
Epoch: 3, Steps: 413 | Train Loss: 0.178 Vali Loss: 0.376 Vali Acc: 0.955 Test Loss: 0.376 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0674016
	speed: 0.3470s/iter; left time: 13865.0297s
	iters: 200, epoch: 4 | loss: 0.0000030
	speed: 0.1204s/iter; left time: 4801.0038s
	iters: 300, epoch: 4 | loss: 0.0000002
	speed: 0.1010s/iter; left time: 4017.1156s
	iters: 400, epoch: 4 | loss: 0.1333164
	speed: 0.0872s/iter; left time: 3458.8783s
Epoch: 4 cost time: 44.84198546409607
Epoch: 4, Steps: 413 | Train Loss: 0.142 Vali Loss: 0.587 Vali Acc: 0.948 Test Loss: 0.587 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8590334
	speed: 0.3329s/iter; left time: 13164.9109s
	iters: 200, epoch: 5 | loss: 0.0000002
	speed: 0.0961s/iter; left time: 3789.6910s
	iters: 300, epoch: 5 | loss: 0.0000045
	speed: 0.1173s/iter; left time: 4614.9508s
	iters: 400, epoch: 5 | loss: 1.1330948
	speed: 0.1167s/iter; left time: 4580.8287s
Epoch: 5 cost time: 46.737364053726196
Epoch: 5, Steps: 413 | Train Loss: 0.166 Vali Loss: 0.703 Vali Acc: 0.952 Test Loss: 0.703 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.3905s/iter; left time: 15283.3876s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.1377s/iter; left time: 5376.2071s
	iters: 300, epoch: 6 | loss: 0.0000038
	speed: 0.1408s/iter; left time: 5483.0322s
	iters: 400, epoch: 6 | loss: 0.0006111
	speed: 0.1518s/iter; left time: 5895.4260s
Epoch: 6 cost time: 60.242326974868774
Epoch: 6, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.427 Vali Acc: 0.961 Test Loss: 0.427 Test Acc: 0.961
Validation loss decreased (-0.959979 --> -0.960887).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.3659s/iter; left time: 14167.7253s
	iters: 200, epoch: 7 | loss: 0.0000061
	speed: 0.1107s/iter; left time: 4275.6190s
	iters: 300, epoch: 7 | loss: 0.0005740
	speed: 0.1311s/iter; left time: 5049.4376s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.1394s/iter; left time: 5356.6174s
Epoch: 7 cost time: 52.635857820510864
Epoch: 7, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.297 Vali Acc: 0.978 Test Loss: 0.297 Test Acc: 0.978
Validation loss decreased (-0.960887 --> -0.977714).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0214552
	speed: 0.2948s/iter; left time: 11292.1125s
	iters: 200, epoch: 8 | loss: 0.0000273
	speed: 0.0636s/iter; left time: 2428.3665s
	iters: 300, epoch: 8 | loss: 0.0066777
	speed: 0.0742s/iter; left time: 2829.3678s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0909s/iter; left time: 3455.6347s
Epoch: 8 cost time: 32.74702858924866
Epoch: 8, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.414 Vali Acc: 0.973 Test Loss: 0.414 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3137s/iter; left time: 11887.1609s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0960s/iter; left time: 3627.1792s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1024s/iter; left time: 3861.8947s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0898s/iter; left time: 3375.4122s
Epoch: 9 cost time: 38.42355918884277
Epoch: 9, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.441 Vali Acc: 0.965 Test Loss: 0.441 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.3069s/iter; left time: 11503.2619s
	iters: 200, epoch: 10 | loss: 0.0195959
	speed: 0.1205s/iter; left time: 4505.4241s
	iters: 300, epoch: 10 | loss: 0.0000002
	speed: 0.1274s/iter; left time: 4749.5220s
	iters: 400, epoch: 10 | loss: 0.0724885
	speed: 0.1064s/iter; left time: 3957.5413s
Epoch: 10 cost time: 47.51475977897644
Epoch: 10, Steps: 413 | Train Loss: 0.126 Vali Loss: 1.560 Vali Acc: 0.934 Test Loss: 1.560 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.3162s/iter; left time: 11720.5056s
	iters: 200, epoch: 11 | loss: 0.0088266
	speed: 0.1074s/iter; left time: 3970.0599s
	iters: 300, epoch: 11 | loss: 0.8303248
	speed: 0.1208s/iter; left time: 4452.8262s
	iters: 400, epoch: 11 | loss: 0.0006563
	speed: 0.0722s/iter; left time: 2656.1206s
Epoch: 11 cost time: 40.006011724472046
Epoch: 11, Steps: 413 | Train Loss: 0.149 Vali Loss: 0.652 Vali Acc: 0.965 Test Loss: 0.652 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000191
	speed: 0.2815s/iter; left time: 10319.5616s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0848s/iter; left time: 3100.9035s
	iters: 300, epoch: 12 | loss: 0.4792401
	speed: 0.1031s/iter; left time: 3757.7637s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.1000s/iter; left time: 3634.8045s
Epoch: 12 cost time: 38.21265411376953
Epoch: 12, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.682 Vali Acc: 0.970 Test Loss: 0.682 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000014
	speed: 0.3234s/iter; left time: 11722.7908s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1525s/iter; left time: 5512.7599s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1268s/iter; left time: 4569.7346s
	iters: 400, epoch: 13 | loss: 0.0000005
	speed: 0.1145s/iter; left time: 4116.7181s
Epoch: 13 cost time: 52.62276339530945
Epoch: 13, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.362 Vali Acc: 0.977 Test Loss: 0.362 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0010235
	speed: 0.3663s/iter; left time: 13124.5718s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1247s/iter; left time: 4455.1761s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1135s/iter; left time: 4043.0435s
	iters: 400, epoch: 14 | loss: 0.0000057
	speed: 0.1518s/iter; left time: 5392.7669s
Epoch: 14 cost time: 55.83360147476196
Epoch: 14, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.652 Vali Acc: 0.969 Test Loss: 0.652 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.4169s/iter; left time: 14767.5159s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1509s/iter; left time: 5329.5239s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.1186s/iter; left time: 4176.1070s
	iters: 400, epoch: 15 | loss: 0.0000004
	speed: 0.1127s/iter; left time: 3959.6229s
Epoch: 15 cost time: 56.081714391708374
Epoch: 15, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.637 Vali Acc: 0.967 Test Loss: 0.637 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.3734s/iter; left time: 13071.5377s
	iters: 200, epoch: 16 | loss: 0.1860352
	speed: 0.1262s/iter; left time: 4405.9440s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1295s/iter; left time: 4506.6926s
	iters: 400, epoch: 16 | loss: 0.0001671
	speed: 0.1405s/iter; left time: 4875.8133s
Epoch: 16 cost time: 54.30707883834839
Epoch: 16, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.550 Vali Acc: 0.965 Test Loss: 0.550 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3402s/iter; left time: 11767.9820s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1160s/iter; left time: 4002.8816s
	iters: 300, epoch: 17 | loss: 0.0000002
	speed: 0.1219s/iter; left time: 4193.3539s
	iters: 400, epoch: 17 | loss: 0.9892623
	speed: 0.0772s/iter; left time: 2647.4840s
Epoch: 17 cost time: 42.34579133987427
Epoch: 17, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.670 Vali Acc: 0.968 Test Loss: 0.670 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 441802
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3812146
	speed: 0.1058s/iter; left time: 4358.1040s
	iters: 200, epoch: 1 | loss: 0.0096145
	speed: 0.0726s/iter; left time: 2983.5848s
	iters: 300, epoch: 1 | loss: 0.0998796
	speed: 0.0946s/iter; left time: 3880.4438s
	iters: 400, epoch: 1 | loss: 0.0204622
	speed: 0.0911s/iter; left time: 3725.0815s
Epoch: 1 cost time: 38.166324615478516
Epoch: 1, Steps: 413 | Train Loss: 0.365 Vali Loss: 0.265 Vali Acc: 0.945 Test Loss: 0.265 Test Acc: 0.945
Validation loss decreased (inf --> -0.944518).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1516077
	speed: 0.2844s/iter; left time: 11600.7317s
	iters: 200, epoch: 2 | loss: 0.0728127
	speed: 0.0774s/iter; left time: 3150.8489s
	iters: 300, epoch: 2 | loss: 0.0149000
	speed: 0.0770s/iter; left time: 3123.4421s
	iters: 400, epoch: 2 | loss: 0.0004923
	speed: 0.0809s/iter; left time: 3275.4019s
Epoch: 2 cost time: 32.660346269607544
Epoch: 2, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.235 Vali Acc: 0.960 Test Loss: 0.235 Test Acc: 0.960
Validation loss decreased (-0.944518 --> -0.959979).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2496032
	speed: 0.3050s/iter; left time: 12315.0001s
	iters: 200, epoch: 3 | loss: 0.0002979
	speed: 0.0831s/iter; left time: 3348.1616s
	iters: 300, epoch: 3 | loss: 0.2701269
	speed: 0.0760s/iter; left time: 3054.2506s
	iters: 400, epoch: 3 | loss: 0.0000758
	speed: 0.1000s/iter; left time: 4009.2638s
Epoch: 3 cost time: 35.57109260559082
Epoch: 3, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.333 Vali Acc: 0.961 Test Loss: 0.333 Test Acc: 0.961
Validation loss decreased (-0.959979 --> -0.960888).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2128228
	speed: 0.3328s/iter; left time: 13298.6900s
	iters: 200, epoch: 4 | loss: 0.0000140
	speed: 0.1086s/iter; left time: 4328.5420s
	iters: 300, epoch: 4 | loss: 0.7446488
	speed: 0.1286s/iter; left time: 5112.2151s
	iters: 400, epoch: 4 | loss: 0.0000189
	speed: 0.1317s/iter; left time: 5221.5916s
Epoch: 4 cost time: 49.84659481048584
Epoch: 4, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.220 Vali Acc: 0.966 Test Loss: 0.220 Test Acc: 0.966
Validation loss decreased (-0.960888 --> -0.966346).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0660193
	speed: 0.3611s/iter; left time: 14279.6558s
	iters: 200, epoch: 5 | loss: 0.1798993
	speed: 0.1129s/iter; left time: 4452.0933s
	iters: 300, epoch: 5 | loss: 0.0000011
	speed: 0.1268s/iter; left time: 4988.6574s
	iters: 400, epoch: 5 | loss: 0.0203115
	speed: 0.1112s/iter; left time: 4365.3214s
Epoch: 5 cost time: 48.95966458320618
Epoch: 5, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.317 Vali Acc: 0.962 Test Loss: 0.317 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0004096
	speed: 0.3454s/iter; left time: 13519.0999s
	iters: 200, epoch: 6 | loss: 0.0000401
	speed: 0.1244s/iter; left time: 4857.7447s
	iters: 300, epoch: 6 | loss: 0.0734388
	speed: 0.1099s/iter; left time: 4279.2082s
	iters: 400, epoch: 6 | loss: 1.0082521
	speed: 0.0957s/iter; left time: 3714.8241s
Epoch: 6 cost time: 47.416597843170166
Epoch: 6, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.409 Vali Acc: 0.961 Test Loss: 0.409 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000008
	speed: 0.3274s/iter; left time: 12677.0597s
	iters: 200, epoch: 7 | loss: 0.0067502
	speed: 0.1172s/iter; left time: 4527.9737s
	iters: 300, epoch: 7 | loss: 0.2271148
	speed: 0.1061s/iter; left time: 4086.0526s
	iters: 400, epoch: 7 | loss: 0.0001512
	speed: 0.1143s/iter; left time: 4392.9243s
Epoch: 7 cost time: 46.82406258583069
Epoch: 7, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.297 Vali Acc: 0.975 Test Loss: 0.297 Test Acc: 0.975
Validation loss decreased (-0.966346 --> -0.974531).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.3202s/iter; left time: 12265.0044s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0722s/iter; left time: 2758.8332s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0927s/iter; left time: 3533.9903s
	iters: 400, epoch: 8 | loss: 0.0024273
	speed: 0.0631s/iter; left time: 2397.3422s
Epoch: 8 cost time: 31.594116926193237
Epoch: 8, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.391 Vali Acc: 0.965 Test Loss: 0.391 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3144s/iter; left time: 11915.3054s
	iters: 200, epoch: 9 | loss: 0.0000269
	speed: 0.0974s/iter; left time: 3681.5455s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0925s/iter; left time: 3486.9032s
	iters: 400, epoch: 9 | loss: 0.0000044
	speed: 0.0782s/iter; left time: 2938.3657s
Epoch: 9 cost time: 39.33080530166626
Epoch: 9, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.493 Vali Acc: 0.968 Test Loss: 0.493 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2905s/iter; left time: 10890.0835s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0625s/iter; left time: 2338.0305s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0684s/iter; left time: 2549.4336s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0629s/iter; left time: 2339.3762s
Epoch: 10 cost time: 28.242778062820435
Epoch: 10, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.562 Vali Acc: 0.968 Test Loss: 0.562 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2609s/iter; left time: 9673.6642s
	iters: 200, epoch: 11 | loss: 0.0246378
	speed: 0.0586s/iter; left time: 2167.0589s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0682s/iter; left time: 2514.2425s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 2076.9765s
Epoch: 11 cost time: 27.136237859725952
Epoch: 11, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.480 Vali Acc: 0.969 Test Loss: 0.480 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000999
	speed: 0.2805s/iter; left time: 10281.2634s
	iters: 200, epoch: 12 | loss: 0.4817674
	speed: 0.0739s/iter; left time: 2700.3898s
	iters: 300, epoch: 12 | loss: 0.0000006
	speed: 0.0731s/iter; left time: 2663.7932s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0826s/iter; left time: 3003.3402s
Epoch: 12 cost time: 32.690526723861694
Epoch: 12, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.450 Vali Acc: 0.968 Test Loss: 0.450 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000360
	speed: 0.3384s/iter; left time: 12265.3278s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1092s/iter; left time: 3948.5632s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1012s/iter; left time: 3648.2460s
	iters: 400, epoch: 13 | loss: 0.0828866
	speed: 0.1254s/iter; left time: 4506.0520s
Epoch: 13 cost time: 47.6762330532074
Epoch: 13, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.379 Vali Acc: 0.976 Test Loss: 0.379 Test Acc: 0.976
Validation loss decreased (-0.974531 --> -0.975894).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3644s/iter; left time: 13058.4038s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1085s/iter; left time: 3877.3915s
	iters: 300, epoch: 14 | loss: 0.0000010
	speed: 0.1491s/iter; left time: 5311.9429s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1483s/iter; left time: 5268.5279s
Epoch: 14 cost time: 53.894264698028564
Epoch: 14, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.655 Vali Acc: 0.966 Test Loss: 0.655 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3732s/iter; left time: 13217.7569s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1136s/iter; left time: 4013.5410s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0928s/iter; left time: 3269.0753s
	iters: 400, epoch: 15 | loss: 0.0000026
	speed: 0.0763s/iter; left time: 2678.6563s
Epoch: 15 cost time: 42.68337154388428
Epoch: 15, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.527 Vali Acc: 0.964 Test Loss: 0.527 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0316345
	speed: 0.3191s/iter; left time: 11169.9442s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1107s/iter; left time: 3865.6150s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0966s/iter; left time: 3360.5874s
	iters: 400, epoch: 16 | loss: 0.0124577
	speed: 0.1016s/iter; left time: 3527.2814s
Epoch: 16 cost time: 45.22387480735779
Epoch: 16, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.818 Vali Acc: 0.966 Test Loss: 0.818 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3321s/iter; left time: 11489.2722s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0755s/iter; left time: 2605.5328s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 2621.0051s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 2433.8595s
Epoch: 17 cost time: 33.19694495201111
Epoch: 17, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.400 Vali Acc: 0.973 Test Loss: 0.400 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3279s/iter; left time: 11207.0757s
	iters: 200, epoch: 18 | loss: 0.0035454
	speed: 0.0772s/iter; left time: 2632.0655s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 2954.7464s
	iters: 400, epoch: 18 | loss: 0.0114619
	speed: 0.0864s/iter; left time: 2926.7014s
Epoch: 18 cost time: 37.05954122543335
Epoch: 18, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.691 Vali Acc: 0.963 Test Loss: 0.691 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.3402s/iter; left time: 11489.1947s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0899s/iter; left time: 3027.0992s
	iters: 300, epoch: 19 | loss: 0.0023451
	speed: 0.0674s/iter; left time: 2260.7668s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0750s/iter; left time: 2510.1234s
Epoch: 19 cost time: 34.722707748413086
Epoch: 19, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.824 Vali Acc: 0.970 Test Loss: 0.824 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2891s/iter; left time: 9642.4161s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 2422.7203s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0658s/iter; left time: 2181.8208s
	iters: 400, epoch: 20 | loss: 0.2198371
	speed: 0.0629s/iter; left time: 2077.8130s
Epoch: 20 cost time: 29.5601487159729
Epoch: 20, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.487 Vali Acc: 0.968 Test Loss: 0.487 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2755s/iter; left time: 9076.4257s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0635s/iter; left time: 2084.2748s
	iters: 300, epoch: 21 | loss: 0.0269115
	speed: 0.0555s/iter; left time: 1816.5560s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 2036.7396s
Epoch: 21 cost time: 25.906417846679688
Epoch: 21, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.543 Vali Acc: 0.972 Test Loss: 0.543 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.3092s/iter; left time: 10059.2670s
	iters: 200, epoch: 22 | loss: 1.0672860
	speed: 0.1016s/iter; left time: 3295.1936s
	iters: 300, epoch: 22 | loss: 0.0000002
	speed: 0.0967s/iter; left time: 3126.8842s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0862s/iter; left time: 2779.6465s
Epoch: 22 cost time: 39.81242346763611
Epoch: 22, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.625 Vali Acc: 0.970 Test Loss: 0.625 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000004
	speed: 0.3540s/iter; left time: 11368.3754s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.1133s/iter; left time: 3628.8819s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1191s/iter; left time: 3801.0627s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1384s/iter; left time: 4404.7849s
Epoch: 23 cost time: 50.97754096984863
Epoch: 23, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.599 Vali Acc: 0.974 Test Loss: 0.599 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9758981355161437
model parameter : 308810
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1753472
	speed: 0.1440s/iter; left time: 5931.6642s
	iters: 200, epoch: 1 | loss: 0.2299105
	speed: 0.1031s/iter; left time: 4237.2313s
	iters: 300, epoch: 1 | loss: 0.0044861
	speed: 0.1028s/iter; left time: 4214.1743s
	iters: 400, epoch: 1 | loss: 0.0278928
	speed: 0.0978s/iter; left time: 4001.0042s
Epoch: 1 cost time: 46.13612627983093
Epoch: 1, Steps: 413 | Train Loss: 0.372 Vali Loss: 0.278 Vali Acc: 0.934 Test Loss: 0.278 Test Acc: 0.934
Validation loss decreased (inf --> -0.934058).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0262596
	speed: 0.3110s/iter; left time: 12684.0176s
	iters: 200, epoch: 2 | loss: 0.0008021
	speed: 0.0735s/iter; left time: 2991.9598s
	iters: 300, epoch: 2 | loss: 0.2637284
	speed: 0.0937s/iter; left time: 3801.0853s
	iters: 400, epoch: 2 | loss: 0.0000571
	speed: 0.1162s/iter; left time: 4705.7941s
Epoch: 2 cost time: 38.51971483230591
Epoch: 2, Steps: 413 | Train Loss: 0.142 Vali Loss: 0.159 Vali Acc: 0.968 Test Loss: 0.159 Test Acc: 0.968
Validation loss decreased (-0.934058 --> -0.967711).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000006
	speed: 0.2836s/iter; left time: 11450.9070s
	iters: 200, epoch: 3 | loss: 0.0000537
	speed: 0.0641s/iter; left time: 2579.6973s
	iters: 300, epoch: 3 | loss: 0.0301390
	speed: 0.0658s/iter; left time: 2642.7029s
	iters: 400, epoch: 3 | loss: 1.1902899
	speed: 0.0573s/iter; left time: 2294.5071s
Epoch: 3 cost time: 26.667046308517456
Epoch: 3, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0127876
	speed: 0.3146s/iter; left time: 12573.5668s
	iters: 200, epoch: 4 | loss: 0.0001061
	speed: 0.0807s/iter; left time: 3215.3755s
	iters: 300, epoch: 4 | loss: 0.1369676
	speed: 0.0842s/iter; left time: 3346.8647s
	iters: 400, epoch: 4 | loss: 0.3394897
	speed: 0.0825s/iter; left time: 3273.9550s
Epoch: 4 cost time: 35.66347599029541
Epoch: 4, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.297 Vali Acc: 0.965 Test Loss: 0.297 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0200640
	speed: 0.3134s/iter; left time: 12395.9793s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0784s/iter; left time: 3094.2593s
	iters: 300, epoch: 5 | loss: 0.0074315
	speed: 0.0724s/iter; left time: 2849.4967s
	iters: 400, epoch: 5 | loss: 1.5373027
	speed: 0.0740s/iter; left time: 2906.0513s
Epoch: 5 cost time: 32.96199417114258
Epoch: 5, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.200 Vali Acc: 0.968 Test Loss: 0.200 Test Acc: 0.968
Validation loss decreased (-0.967711 --> -0.968165).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000013
	speed: 0.2895s/iter; left time: 11328.4227s
	iters: 200, epoch: 6 | loss: 0.0000018
	speed: 0.0763s/iter; left time: 2978.6482s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 2854.0197s
	iters: 400, epoch: 6 | loss: 0.0000105
	speed: 0.0596s/iter; left time: 2316.2533s
Epoch: 6 cost time: 29.74038338661194
Epoch: 6, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.265 Vali Acc: 0.967 Test Loss: 0.265 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2517s/iter; left time: 9745.9055s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0589s/iter; left time: 2274.6274s
	iters: 300, epoch: 7 | loss: 0.1267078
	speed: 0.0626s/iter; left time: 2413.3057s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.0590s/iter; left time: 2268.6393s
Epoch: 7 cost time: 25.801907539367676
Epoch: 7, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.229 Vali Acc: 0.973 Test Loss: 0.229 Test Acc: 0.973
Validation loss decreased (-0.968165 --> -0.973167).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0049981
	speed: 0.3077s/iter; left time: 11787.6340s
	iters: 200, epoch: 8 | loss: 0.0000001
	speed: 0.0630s/iter; left time: 2406.6251s
	iters: 300, epoch: 8 | loss: 0.0000805
	speed: 0.0868s/iter; left time: 3308.0927s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0937s/iter; left time: 3561.4522s
Epoch: 8 cost time: 33.782246589660645
Epoch: 8, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.403 Vali Acc: 0.962 Test Loss: 0.403 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000016
	speed: 0.3720s/iter; left time: 14097.0114s
	iters: 200, epoch: 9 | loss: 0.9573903
	speed: 0.1238s/iter; left time: 4680.7985s
	iters: 300, epoch: 9 | loss: 0.0115164
	speed: 0.1219s/iter; left time: 4596.4544s
	iters: 400, epoch: 9 | loss: 0.0010416
	speed: 0.1350s/iter; left time: 5075.4180s
Epoch: 9 cost time: 52.8943657875061
Epoch: 9, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.193 Vali Acc: 0.984 Test Loss: 0.193 Test Acc: 0.984
Validation loss decreased (-0.973167 --> -0.984082).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000587
	speed: 0.3637s/iter; left time: 13632.1828s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1082s/iter; left time: 4045.7487s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.1371s/iter; left time: 5111.2906s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1177s/iter; left time: 4376.5432s
Epoch: 10 cost time: 50.832900047302246
Epoch: 10, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.283 Vali Acc: 0.974 Test Loss: 0.283 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.3077s/iter; left time: 11406.4969s
	iters: 200, epoch: 11 | loss: 0.0051527
	speed: 0.0994s/iter; left time: 3674.0364s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1028s/iter; left time: 3788.5069s
	iters: 400, epoch: 11 | loss: 0.0665808
	speed: 0.0935s/iter; left time: 3439.2652s
Epoch: 11 cost time: 41.20146417617798
Epoch: 11, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.982 Test Loss: 0.143 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2857s/iter; left time: 10473.8323s
	iters: 200, epoch: 12 | loss: 0.0000010
	speed: 0.0739s/iter; left time: 2699.9187s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0814s/iter; left time: 2965.8841s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0745s/iter; left time: 2707.4857s
Epoch: 12 cost time: 32.026033878326416
Epoch: 12, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.348 Vali Acc: 0.980 Test Loss: 0.348 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.2682s/iter; left time: 9722.0079s
	iters: 200, epoch: 13 | loss: 0.0016400
	speed: 0.0659s/iter; left time: 2382.5328s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 2225.6497s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0666s/iter; left time: 2395.5148s
Epoch: 13 cost time: 28.664663553237915
Epoch: 13, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.395 Vali Acc: 0.967 Test Loss: 0.395 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.2072169
	speed: 0.2965s/iter; left time: 10625.7814s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0730s/iter; left time: 2607.2129s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0749s/iter; left time: 2669.1380s
	iters: 400, epoch: 14 | loss: 0.0009780
	speed: 0.0719s/iter; left time: 2555.7726s
Epoch: 14 cost time: 31.734923124313354
Epoch: 14, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.447 Vali Acc: 0.964 Test Loss: 0.447 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2744s/iter; left time: 9719.4316s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 2051.1652s
	iters: 300, epoch: 15 | loss: 0.1767661
	speed: 0.0710s/iter; left time: 2499.6390s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0608s/iter; left time: 2135.4771s
Epoch: 15 cost time: 27.341299295425415
Epoch: 15, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.329 Vali Acc: 0.972 Test Loss: 0.329 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2778s/iter; left time: 9726.1664s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 2137.9233s
	iters: 300, epoch: 16 | loss: 0.0001459
	speed: 0.0616s/iter; left time: 2145.5771s
	iters: 400, epoch: 16 | loss: 0.0000002
	speed: 0.0668s/iter; left time: 2318.1723s
Epoch: 16 cost time: 27.36276912689209
Epoch: 16, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.434 Vali Acc: 0.974 Test Loss: 0.434 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2818s/iter; left time: 9747.2784s
	iters: 200, epoch: 17 | loss: 0.0034163
	speed: 0.0569s/iter; left time: 1962.3998s
	iters: 300, epoch: 17 | loss: 0.0001659
	speed: 0.0532s/iter; left time: 1831.2178s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0541s/iter; left time: 1854.0440s
Epoch: 17 cost time: 24.944634914398193
Epoch: 17, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.246 Vali Acc: 0.978 Test Loss: 0.246 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000040
	speed: 0.3441s/iter; left time: 11760.6141s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0980s/iter; left time: 3338.7831s
	iters: 300, epoch: 18 | loss: 0.0000002
	speed: 0.0909s/iter; left time: 3087.9069s
	iters: 400, epoch: 18 | loss: 0.0000279
	speed: 0.0919s/iter; left time: 3115.2126s
Epoch: 18 cost time: 42.72282838821411
Epoch: 18, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.273 Vali Acc: 0.976 Test Loss: 0.273 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.4042s/iter; left time: 13648.6878s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1156s/iter; left time: 3890.9075s
	iters: 300, epoch: 19 | loss: 0.0000044
	speed: 0.1180s/iter; left time: 3961.8844s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1637s/iter; left time: 5480.0436s
Epoch: 19 cost time: 54.61457943916321
Epoch: 19, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.325 Vali Acc: 0.980 Test Loss: 0.325 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 242378
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2277893
	speed: 0.1535s/iter; left time: 6324.2693s
	iters: 200, epoch: 1 | loss: 0.0283415
	speed: 0.0976s/iter; left time: 4009.9683s
	iters: 300, epoch: 1 | loss: 0.0722979
	speed: 0.0859s/iter; left time: 3522.3222s
	iters: 400, epoch: 1 | loss: 0.0007042
	speed: 0.0852s/iter; left time: 3484.1938s
Epoch: 1 cost time: 43.532769203186035
Epoch: 1, Steps: 413 | Train Loss: 0.350 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (inf --> -0.968166).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1622577
	speed: 0.3090s/iter; left time: 12604.6743s
	iters: 200, epoch: 2 | loss: 0.0040258
	speed: 0.1138s/iter; left time: 4629.8620s
	iters: 300, epoch: 2 | loss: 0.0002674
	speed: 0.0951s/iter; left time: 3858.5656s
	iters: 400, epoch: 2 | loss: 0.3052783
	speed: 0.0831s/iter; left time: 3362.9209s
Epoch: 2 cost time: 40.0700523853302
Epoch: 2, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000013
	speed: 0.3137s/iter; left time: 12665.9079s
	iters: 200, epoch: 3 | loss: 0.0043411
	speed: 0.1025s/iter; left time: 4129.9839s
	iters: 300, epoch: 3 | loss: 0.0181611
	speed: 0.1098s/iter; left time: 4412.6142s
	iters: 400, epoch: 3 | loss: 0.0088578
	speed: 0.1408s/iter; left time: 5643.7273s
Epoch: 3 cost time: 46.42900276184082
Epoch: 3, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.968166 --> -0.969985).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1049149
	speed: 0.3122s/iter; left time: 12476.1386s
	iters: 200, epoch: 4 | loss: 0.0093066
	speed: 0.1304s/iter; left time: 5197.5917s
	iters: 300, epoch: 4 | loss: 0.0003868
	speed: 0.1178s/iter; left time: 4683.8330s
	iters: 400, epoch: 4 | loss: 0.0000041
	speed: 0.0657s/iter; left time: 2605.2019s
Epoch: 4 cost time: 41.737096548080444
Epoch: 4, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.269 Vali Acc: 0.967 Test Loss: 0.269 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1706365
	speed: 0.3014s/iter; left time: 11918.3970s
	iters: 200, epoch: 5 | loss: 0.0004394
	speed: 0.0860s/iter; left time: 3392.3723s
	iters: 300, epoch: 5 | loss: 0.0000411
	speed: 0.0713s/iter; left time: 2806.0592s
	iters: 400, epoch: 5 | loss: 0.0002686
	speed: 0.0583s/iter; left time: 2286.7775s
Epoch: 5 cost time: 32.86693358421326
Epoch: 5, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.239 Vali Acc: 0.967 Test Loss: 0.239 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000035
	speed: 0.2639s/iter; left time: 10328.4850s
	iters: 200, epoch: 6 | loss: 0.0105896
	speed: 0.0793s/iter; left time: 3096.6059s
	iters: 300, epoch: 6 | loss: 0.0006776
	speed: 0.0699s/iter; left time: 2721.0621s
	iters: 400, epoch: 6 | loss: 0.0000017
	speed: 0.0627s/iter; left time: 2435.3915s
Epoch: 6 cost time: 29.38058352470398
Epoch: 6, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
Validation loss decreased (-0.969985 --> -0.974532).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000004
	speed: 0.2776s/iter; left time: 10750.7461s
	iters: 200, epoch: 7 | loss: 0.0000166
	speed: 0.0759s/iter; left time: 2931.9565s
	iters: 300, epoch: 7 | loss: 0.0000017
	speed: 0.0854s/iter; left time: 3290.0529s
	iters: 400, epoch: 7 | loss: 0.0000010
	speed: 0.1076s/iter; left time: 4134.8984s
Epoch: 7 cost time: 36.997936487197876
Epoch: 7, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.320 Vali Acc: 0.972 Test Loss: 0.320 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000011
	speed: 0.3917s/iter; left time: 15005.3983s
	iters: 200, epoch: 8 | loss: 0.0001284
	speed: 0.1184s/iter; left time: 4523.3497s
	iters: 300, epoch: 8 | loss: 0.0000066
	speed: 0.1060s/iter; left time: 4038.7370s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.1114s/iter; left time: 4233.6390s
Epoch: 8 cost time: 51.17735815048218
Epoch: 8, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.311 Vali Acc: 0.969 Test Loss: 0.311 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1463941
	speed: 0.3572s/iter; left time: 13538.5080s
	iters: 200, epoch: 9 | loss: 0.0000008
	speed: 0.0824s/iter; left time: 3112.8469s
	iters: 300, epoch: 9 | loss: 0.0001207
	speed: 0.0885s/iter; left time: 3335.3788s
	iters: 400, epoch: 9 | loss: 0.0000012
	speed: 0.1047s/iter; left time: 3935.6919s
Epoch: 9 cost time: 39.70923209190369
Epoch: 9, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.307 Vali Acc: 0.965 Test Loss: 0.307 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000005
	speed: 0.3196s/iter; left time: 11978.7633s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0917s/iter; left time: 3427.5054s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0882s/iter; left time: 3289.6013s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.1057s/iter; left time: 3929.8043s
Epoch: 10 cost time: 39.691489696502686
Epoch: 10, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.320 Vali Acc: 0.974 Test Loss: 0.320 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.3549s/iter; left time: 13157.3650s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0957s/iter; left time: 3536.5956s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.1208s/iter; left time: 4452.3179s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1129s/iter; left time: 4151.6830s
Epoch: 11 cost time: 46.91119027137756
Epoch: 11, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.255 Vali Acc: 0.973 Test Loss: 0.255 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000004
	speed: 0.2753s/iter; left time: 10090.3830s
	iters: 200, epoch: 12 | loss: 0.0000027
	speed: 0.0857s/iter; left time: 3134.0852s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1062s/iter; left time: 3872.8380s
	iters: 400, epoch: 12 | loss: 0.0000053
	speed: 0.0978s/iter; left time: 3555.4672s
Epoch: 12 cost time: 37.63520574569702
Epoch: 12, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.383 Vali Acc: 0.971 Test Loss: 0.383 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000117
	speed: 0.2821s/iter; left time: 10222.9931s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.1182s/iter; left time: 4273.8001s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0772s/iter; left time: 2781.0665s
	iters: 400, epoch: 13 | loss: 0.0791536
	speed: 0.0734s/iter; left time: 2636.9640s
Epoch: 13 cost time: 36.916216135025024
Epoch: 13, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.376 Vali Acc: 0.975 Test Loss: 0.376 Test Acc: 0.975
Validation loss decreased (-0.974532 --> -0.974985).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0014797
	speed: 0.2790s/iter; left time: 9996.3054s
	iters: 200, epoch: 14 | loss: 0.5013033
	speed: 0.0630s/iter; left time: 2250.5165s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 1851.1278s
	iters: 400, epoch: 14 | loss: 2.4809489
	speed: 0.0468s/iter; left time: 1661.7379s
Epoch: 14 cost time: 25.852718591690063
Epoch: 14, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.288 Vali Acc: 0.980 Test Loss: 0.288 Test Acc: 0.980
Validation loss decreased (-0.974985 --> -0.979533).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2762s/iter; left time: 9782.5475s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0683s/iter; left time: 2411.7652s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0562s/iter; left time: 1978.1158s
	iters: 400, epoch: 15 | loss: 0.0000003
	speed: 0.0539s/iter; left time: 1893.3656s
Epoch: 15 cost time: 28.920551300048828
Epoch: 15, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000006
	speed: 0.2812s/iter; left time: 9842.0702s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0851s/iter; left time: 2969.7080s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0646s/iter; left time: 2247.1104s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0673s/iter; left time: 2335.4516s
Epoch: 16 cost time: 30.612642526626587
Epoch: 16, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.481 Vali Acc: 0.971 Test Loss: 0.481 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3036s/iter; left time: 10503.1574s
	iters: 200, epoch: 17 | loss: 0.0000131
	speed: 0.1183s/iter; left time: 4080.7971s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1018s/iter; left time: 3502.6046s
	iters: 400, epoch: 17 | loss: 0.0628467
	speed: 0.1049s/iter; left time: 3598.4920s
Epoch: 17 cost time: 46.164865255355835
Epoch: 17, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.516 Vali Acc: 0.965 Test Loss: 0.516 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3699s/iter; left time: 12644.8810s
	iters: 200, epoch: 18 | loss: 0.0000003
	speed: 0.1079s/iter; left time: 3676.9947s
	iters: 300, epoch: 18 | loss: 0.2653137
	speed: 0.0982s/iter; left time: 3337.7302s
	iters: 400, epoch: 18 | loss: 0.0000034
	speed: 0.0950s/iter; left time: 3219.6937s
Epoch: 18 cost time: 44.44835424423218
Epoch: 18, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.348 Vali Acc: 0.970 Test Loss: 0.348 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2976s/iter; left time: 10047.7006s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0724s/iter; left time: 2437.0745s
	iters: 300, epoch: 19 | loss: 0.3541012
	speed: 0.0833s/iter; left time: 2795.2619s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0932s/iter; left time: 3120.6787s
Epoch: 19 cost time: 35.13130331039429
Epoch: 19, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.655 Vali Acc: 0.954 Test Loss: 0.655 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.3115s/iter; left time: 10388.2142s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0936s/iter; left time: 3112.0295s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0980s/iter; left time: 3247.5927s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0970s/iter; left time: 3204.8027s
Epoch: 20 cost time: 38.66249370574951
Epoch: 20, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.544 Vali Acc: 0.973 Test Loss: 0.544 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2655s/iter; left time: 8746.0075s
	iters: 200, epoch: 21 | loss: 0.0000011
	speed: 0.0642s/iter; left time: 2109.1251s
	iters: 300, epoch: 21 | loss: 0.0000125
	speed: 0.0789s/iter; left time: 2583.0628s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0802s/iter; left time: 2616.8669s
Epoch: 21 cost time: 31.470677375793457
Epoch: 21, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.372 Vali Acc: 0.975 Test Loss: 0.372 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2812s/iter; left time: 9148.1918s
	iters: 200, epoch: 22 | loss: 0.0361833
	speed: 0.0984s/iter; left time: 3190.3097s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 2804.2798s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 2449.7543s
Epoch: 22 cost time: 34.13523197174072
Epoch: 22, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.293 Vali Acc: 0.979 Test Loss: 0.293 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2456s/iter; left time: 7886.3138s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 2130.7686s
	iters: 300, epoch: 23 | loss: 0.0000004
	speed: 0.0775s/iter; left time: 2474.8371s
	iters: 400, epoch: 23 | loss: 0.0002635
	speed: 0.0622s/iter; left time: 1979.4280s
Epoch: 23 cost time: 27.9203884601593
Epoch: 23, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.270 Vali Acc: 0.980 Test Loss: 0.270 Test Acc: 0.980
Validation loss decreased (-0.979533 --> -0.979988).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.1564647
	speed: 0.2620s/iter; left time: 8305.7098s
	iters: 200, epoch: 24 | loss: 0.0000009
	speed: 0.0674s/iter; left time: 2130.1232s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0674s/iter; left time: 2123.6743s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 2060.2820s
Epoch: 24 cost time: 28.139300107955933
Epoch: 24, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.401 Vali Acc: 0.976 Test Loss: 0.401 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2499s/iter; left time: 7817.9260s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0686s/iter; left time: 2139.6922s
	iters: 300, epoch: 25 | loss: 0.0004979
	speed: 0.0643s/iter; left time: 1999.4178s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 1861.8449s
Epoch: 25 cost time: 27.38095474243164
Epoch: 25, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.264 Vali Acc: 0.980 Test Loss: 0.264 Test Acc: 0.980
Validation loss decreased (-0.979988 --> -0.979988).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2814s/iter; left time: 8689.2930s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0927s/iter; left time: 2854.2985s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0968s/iter; left time: 2970.7265s
	iters: 400, epoch: 26 | loss: 0.1326402
	speed: 0.1062s/iter; left time: 3246.2590s
Epoch: 26 cost time: 40.859522581100464
Epoch: 26, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.318 Vali Acc: 0.979 Test Loss: 0.318 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.3668s/iter; left time: 11173.5950s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.1018s/iter; left time: 3091.3059s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.1122s/iter; left time: 3395.5108s
	iters: 400, epoch: 27 | loss: 0.0000007
	speed: 0.0932s/iter; left time: 2812.1354s
Epoch: 27 cost time: 46.41831827163696
Epoch: 27, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.434 Vali Acc: 0.977 Test Loss: 0.434 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.3269s/iter; left time: 9822.7502s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0833s/iter; left time: 2493.4921s
	iters: 300, epoch: 28 | loss: 0.1159813
	speed: 0.0855s/iter; left time: 2552.3861s
	iters: 400, epoch: 28 | loss: 0.0000011
	speed: 0.0903s/iter; left time: 2687.7384s
Epoch: 28 cost time: 38.20643496513367
Epoch: 28, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.264 Vali Acc: 0.984 Test Loss: 0.264 Test Acc: 0.984
Validation loss decreased (-0.979988 --> -0.984081).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.3246s/iter; left time: 9619.0616s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0939s/iter; left time: 2773.1872s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0880s/iter; left time: 2589.2023s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.1118s/iter; left time: 3278.5668s
Epoch: 29 cost time: 41.12686729431152
Epoch: 29, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.382 Vali Acc: 0.980 Test Loss: 0.382 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.3034s/iter; left time: 8865.2211s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0726s/iter; left time: 2115.3728s
	iters: 300, epoch: 30 | loss: 0.0000014
	speed: 0.0706s/iter; left time: 2049.1490s
	iters: 400, epoch: 30 | loss: 0.0000009
	speed: 0.0830s/iter; left time: 2399.9172s
Epoch: 30 cost time: 32.18954420089722
Epoch: 30, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.309 Vali Acc: 0.982 Test Loss: 0.309 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0000346
	speed: 0.2801s/iter; left time: 8070.1317s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0938s/iter; left time: 2692.4542s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.1007s/iter; left time: 2881.1512s
	iters: 400, epoch: 31 | loss: 0.0024765
	speed: 0.0905s/iter; left time: 2581.3053s
Epoch: 31 cost time: 38.43609809875488
Epoch: 31, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.449 Vali Acc: 0.971 Test Loss: 0.449 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2994s/iter; left time: 8502.4593s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0750s/iter; left time: 2123.7625s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0616s/iter; left time: 1736.0011s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 1660.7929s
Epoch: 32 cost time: 31.86683964729309
Epoch: 32, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.340 Vali Acc: 0.980 Test Loss: 0.340 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.2975061
	speed: 0.2643s/iter; left time: 7397.1249s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0741s/iter; left time: 2065.8661s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0684s/iter; left time: 1901.0625s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0660s/iter; left time: 1828.2758s
Epoch: 33 cost time: 30.17955732345581
Epoch: 33, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.201 Vali Acc: 0.984 Test Loss: 0.201 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0001038
	speed: 0.3015s/iter; left time: 8314.0349s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0681s/iter; left time: 1870.9758s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0635s/iter; left time: 1739.1588s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 1722.4850s
Epoch: 34 cost time: 29.239298820495605
Epoch: 34, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.345 Vali Acc: 0.981 Test Loss: 0.345 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2322s/iter; left time: 6305.8681s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0784s/iter; left time: 2122.1179s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0737s/iter; left time: 1987.0134s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0686s/iter; left time: 1842.4225s
Epoch: 35 cost time: 30.041765689849854
Epoch: 35, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.367 Vali Acc: 0.979 Test Loss: 0.367 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2828s/iter; left time: 7565.0019s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.1219s/iter; left time: 3247.5694s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.1077s/iter; left time: 2859.2057s
	iters: 400, epoch: 36 | loss: 0.0076463
	speed: 0.0837s/iter; left time: 2214.0309s
Epoch: 36 cost time: 41.99590754508972
Epoch: 36, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.501 Vali Acc: 0.974 Test Loss: 0.501 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0000016
	speed: 0.3456s/iter; left time: 9099.9974s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.1190s/iter; left time: 3121.2309s
	iters: 300, epoch: 37 | loss: 0.0000309
	speed: 0.0941s/iter; left time: 2458.7123s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0858s/iter; left time: 2234.2776s
Epoch: 37 cost time: 44.28619885444641
Epoch: 37, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.449 Vali Acc: 0.980 Test Loss: 0.449 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.3111s/iter; left time: 8064.3291s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0931s/iter; left time: 2403.7548s
	iters: 300, epoch: 38 | loss: 0.0000102
	speed: 0.0842s/iter; left time: 2165.1841s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0903s/iter; left time: 2314.5704s
Epoch: 38 cost time: 37.02948474884033
Epoch: 38, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.354 Vali Acc: 0.980 Test Loss: 0.354 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 200970
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3764605
	speed: 0.1042s/iter; left time: 4295.0648s
	iters: 200, epoch: 1 | loss: 0.0650967
	speed: 0.0583s/iter; left time: 2397.2090s
	iters: 300, epoch: 1 | loss: 0.1802178
	speed: 0.0582s/iter; left time: 2385.9245s
	iters: 400, epoch: 1 | loss: 0.1799832
	speed: 0.0576s/iter; left time: 2357.3333s
Epoch: 1 cost time: 28.64212989807129
Epoch: 1, Steps: 413 | Train Loss: 0.373 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0068675
	speed: 0.2552s/iter; left time: 10407.2586s
	iters: 200, epoch: 2 | loss: 0.1666286
	speed: 0.0586s/iter; left time: 2384.0510s
	iters: 300, epoch: 2 | loss: 0.2173823
	speed: 0.0625s/iter; left time: 2535.5247s
	iters: 400, epoch: 2 | loss: 0.0308351
	speed: 0.0548s/iter; left time: 2217.3306s
Epoch: 2 cost time: 25.287676334381104
Epoch: 2, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
Validation loss decreased (-0.957252 --> -0.974078).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0049843
	speed: 0.2430s/iter; left time: 9812.9738s
	iters: 200, epoch: 3 | loss: 0.0000855
	speed: 0.0614s/iter; left time: 2472.4291s
	iters: 300, epoch: 3 | loss: 0.1692057
	speed: 0.0590s/iter; left time: 2371.3632s
	iters: 400, epoch: 3 | loss: 0.0000026
	speed: 0.0538s/iter; left time: 2154.1315s
Epoch: 3 cost time: 25.07108783721924
Epoch: 3, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
Validation loss decreased (-0.974078 --> -0.978626).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0002706
	speed: 0.2414s/iter; left time: 9646.4881s
	iters: 200, epoch: 4 | loss: 0.0005732
	speed: 0.0627s/iter; left time: 2500.7620s
	iters: 300, epoch: 4 | loss: 0.0228544
	speed: 0.0618s/iter; left time: 2459.2449s
	iters: 400, epoch: 4 | loss: 0.0231298
	speed: 0.0604s/iter; left time: 2393.6305s
Epoch: 4 cost time: 25.811060905456543
Epoch: 4, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.225 Vali Acc: 0.957 Test Loss: 0.225 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0001512
	speed: 0.2396s/iter; left time: 9474.5998s
	iters: 200, epoch: 5 | loss: 0.0041513
	speed: 0.0578s/iter; left time: 2280.0979s
	iters: 300, epoch: 5 | loss: 0.0003175
	speed: 0.0546s/iter; left time: 2150.0685s
	iters: 400, epoch: 5 | loss: 0.1018816
	speed: 0.0498s/iter; left time: 1952.6654s
Epoch: 5 cost time: 23.74433159828186
Epoch: 5, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.162 Vali Acc: 0.969 Test Loss: 0.162 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0145024
	speed: 0.2345s/iter; left time: 9177.8241s
	iters: 200, epoch: 6 | loss: 0.0000010
	speed: 0.0596s/iter; left time: 2325.7940s
	iters: 300, epoch: 6 | loss: 0.0000022
	speed: 0.0556s/iter; left time: 2165.2264s
	iters: 400, epoch: 6 | loss: 0.0051807
	speed: 0.0718s/iter; left time: 2788.2197s
Epoch: 6 cost time: 26.26130437850952
Epoch: 6, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.226 Vali Acc: 0.965 Test Loss: 0.226 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000001
	speed: 0.2652s/iter; left time: 10271.1008s
	iters: 200, epoch: 7 | loss: 0.1234505
	speed: 0.0615s/iter; left time: 2374.0021s
	iters: 300, epoch: 7 | loss: 0.1213737
	speed: 0.0788s/iter; left time: 3035.8031s
	iters: 400, epoch: 7 | loss: 0.0660066
	speed: 0.0793s/iter; left time: 3046.5360s
Epoch: 7 cost time: 30.69653820991516
Epoch: 7, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.232 Vali Acc: 0.968 Test Loss: 0.232 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000036
	speed: 0.3005s/iter; left time: 11511.8605s
	iters: 200, epoch: 8 | loss: 0.0879049
	speed: 0.1011s/iter; left time: 3861.4688s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0742s/iter; left time: 2828.0118s
	iters: 400, epoch: 8 | loss: 0.0013714
	speed: 0.0859s/iter; left time: 3265.3635s
Epoch: 8 cost time: 38.693570137023926
Epoch: 8, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.202 Vali Acc: 0.974 Test Loss: 0.202 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000030
	speed: 0.3066s/iter; left time: 11619.7103s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0967s/iter; left time: 3656.4275s
	iters: 300, epoch: 9 | loss: 0.0000077
	speed: 0.0821s/iter; left time: 3096.3381s
	iters: 400, epoch: 9 | loss: 0.0004531
	speed: 0.0798s/iter; left time: 3001.4636s
Epoch: 9 cost time: 37.89810252189636
Epoch: 9, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.172 Vali Acc: 0.979 Test Loss: 0.172 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.3045s/iter; left time: 11415.2155s
	iters: 200, epoch: 10 | loss: 0.0000156
	speed: 0.0964s/iter; left time: 3603.3425s
	iters: 300, epoch: 10 | loss: 0.0078381
	speed: 0.0776s/iter; left time: 2892.3797s
	iters: 400, epoch: 10 | loss: 0.1608557
	speed: 0.0749s/iter; left time: 2783.6208s
Epoch: 10 cost time: 36.3410279750824
Epoch: 10, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.230 Vali Acc: 0.972 Test Loss: 0.230 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0005181
	speed: 0.2578s/iter; left time: 9557.7905s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0740s/iter; left time: 2734.8882s
	iters: 300, epoch: 11 | loss: 0.0001105
	speed: 0.0667s/iter; left time: 2459.5282s
	iters: 400, epoch: 11 | loss: 0.4767086
	speed: 0.0538s/iter; left time: 1977.1854s
Epoch: 11 cost time: 27.61954665184021
Epoch: 11, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.282 Vali Acc: 0.972 Test Loss: 0.282 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2455s/iter; left time: 9000.0940s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 2664.9831s
	iters: 300, epoch: 12 | loss: 0.0001989
	speed: 0.0794s/iter; left time: 2895.0091s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0643s/iter; left time: 2337.8572s
Epoch: 12 cost time: 29.145023584365845
Epoch: 12, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.222 Vali Acc: 0.980 Test Loss: 0.222 Test Acc: 0.980
Validation loss decreased (-0.978626 --> -0.979989).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2488s/iter; left time: 9018.4876s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 2428.2025s
	iters: 300, epoch: 13 | loss: 0.0000052
	speed: 0.0719s/iter; left time: 2591.3733s
	iters: 400, epoch: 13 | loss: 0.0000030
	speed: 0.0638s/iter; left time: 2294.5724s
Epoch: 13 cost time: 28.10768461227417
Epoch: 13, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.316 Vali Acc: 0.972 Test Loss: 0.316 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000081
	speed: 0.2482s/iter; left time: 8893.3509s
	iters: 200, epoch: 14 | loss: 0.0000072
	speed: 0.0527s/iter; left time: 1884.6777s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 2052.3233s
	iters: 400, epoch: 14 | loss: 0.0159568
	speed: 0.0620s/iter; left time: 2202.1791s
Epoch: 14 cost time: 24.769468069076538
Epoch: 14, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.201 Vali Acc: 0.980 Test Loss: 0.201 Test Acc: 0.980
Validation loss decreased (-0.979989 --> -0.980444).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2479s/iter; left time: 8780.8037s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0622s/iter; left time: 2198.2345s
	iters: 300, epoch: 15 | loss: 0.0739358
	speed: 0.0636s/iter; left time: 2238.3867s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0699s/iter; left time: 2454.1757s
Epoch: 15 cost time: 27.59926128387451
Epoch: 15, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.264 Vali Acc: 0.977 Test Loss: 0.264 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000005
	speed: 0.2563s/iter; left time: 8972.7475s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0655s/iter; left time: 2285.3109s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 2019.6341s
	iters: 400, epoch: 16 | loss: 1.0470979
	speed: 0.0872s/iter; left time: 3025.5122s
Epoch: 16 cost time: 29.433507919311523
Epoch: 16, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.234 Vali Acc: 0.974 Test Loss: 0.234 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0002665
	speed: 0.2771s/iter; left time: 9584.5077s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0756s/iter; left time: 2606.5188s
	iters: 300, epoch: 17 | loss: 0.0001231
	speed: 0.0751s/iter; left time: 2581.2427s
	iters: 400, epoch: 17 | loss: 0.0002943
	speed: 0.1041s/iter; left time: 3571.5832s
Epoch: 17 cost time: 36.00450253486633
Epoch: 17, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.223 Vali Acc: 0.977 Test Loss: 0.223 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000081
	speed: 0.2635s/iter; left time: 9006.7990s
	iters: 200, epoch: 18 | loss: 0.0000070
	speed: 0.0748s/iter; left time: 2549.0579s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0758s/iter; left time: 2574.2820s
	iters: 400, epoch: 18 | loss: 0.0000017
	speed: 0.1030s/iter; left time: 3488.3875s
Epoch: 18 cost time: 34.863975048065186
Epoch: 18, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.388 Vali Acc: 0.973 Test Loss: 0.388 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2922s/iter; left time: 9865.6626s
	iters: 200, epoch: 19 | loss: 0.0280980
	speed: 0.0724s/iter; left time: 2436.1001s
	iters: 300, epoch: 19 | loss: 0.0000045
	speed: 0.0831s/iter; left time: 2788.3511s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.1003s/iter; left time: 3358.3729s
Epoch: 19 cost time: 36.66070222854614
Epoch: 19, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.398 Vali Acc: 0.967 Test Loss: 0.398 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2797s/iter; left time: 9329.1680s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 2544.2716s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0985s/iter; left time: 3265.1064s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.0994s/iter; left time: 3285.6529s
Epoch: 20 cost time: 37.936861515045166
Epoch: 20, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.235 Vali Acc: 0.978 Test Loss: 0.235 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2312s/iter; left time: 7616.7119s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 1652.4960s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 1798.0418s
	iters: 400, epoch: 21 | loss: 0.0000004
	speed: 0.0629s/iter; left time: 2054.1485s
Epoch: 21 cost time: 23.696990728378296
Epoch: 21, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.323 Vali Acc: 0.975 Test Loss: 0.323 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2519s/iter; left time: 8193.5091s
	iters: 200, epoch: 22 | loss: 0.0000003
	speed: 0.0656s/iter; left time: 2127.3237s
	iters: 300, epoch: 22 | loss: 0.0000029
	speed: 0.0823s/iter; left time: 2659.0168s
	iters: 400, epoch: 22 | loss: 0.0001942
	speed: 0.0859s/iter; left time: 2768.7838s
Epoch: 22 cost time: 31.77790641784668
Epoch: 22, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.309 Vali Acc: 0.979 Test Loss: 0.309 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.3773691
	speed: 0.2293s/iter; left time: 7362.4709s
	iters: 200, epoch: 23 | loss: 0.0000001
	speed: 0.0519s/iter; left time: 1661.1311s
	iters: 300, epoch: 23 | loss: 0.0000249
	speed: 0.0532s/iter; left time: 1698.1024s
	iters: 400, epoch: 23 | loss: 0.0002036
	speed: 0.0618s/iter; left time: 1966.4952s
Epoch: 23 cost time: 23.903516054153442
Epoch: 23, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.302 Vali Acc: 0.976 Test Loss: 0.302 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000002
	speed: 0.2500s/iter; left time: 7924.8928s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0497s/iter; left time: 1570.3952s
	iters: 300, epoch: 24 | loss: 0.0004090
	speed: 0.0468s/iter; left time: 1474.1482s
	iters: 400, epoch: 24 | loss: 0.1958185
	speed: 0.0700s/iter; left time: 2196.6351s
Epoch: 24 cost time: 23.52765464782715
Epoch: 24, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.283 Vali Acc: 0.979 Test Loss: 0.283 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 159626
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3115717
	speed: 0.0892s/iter; left time: 3676.4219s
	iters: 200, epoch: 1 | loss: 0.0525942
	speed: 0.0518s/iter; left time: 2129.9946s
	iters: 300, epoch: 1 | loss: 0.1252861
	speed: 0.0631s/iter; left time: 2586.1804s
	iters: 400, epoch: 1 | loss: 0.0207232
	speed: 0.0544s/iter; left time: 2226.4685s
Epoch: 1 cost time: 26.63264274597168
Epoch: 1, Steps: 413 | Train Loss: 0.402 Vali Loss: 0.121 Vali Acc: 0.960 Test Loss: 0.121 Test Acc: 0.960
Validation loss decreased (inf --> -0.959526).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0606537
	speed: 0.2213s/iter; left time: 9027.1546s
	iters: 200, epoch: 2 | loss: 0.3573735
	speed: 0.0398s/iter; left time: 1618.6933s
	iters: 300, epoch: 2 | loss: 0.1138993
	speed: 0.0436s/iter; left time: 1769.6331s
	iters: 400, epoch: 2 | loss: 0.1079558
	speed: 0.0442s/iter; left time: 1790.6077s
Epoch: 2 cost time: 18.294099807739258
Epoch: 2, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0057663
	speed: 0.2398s/iter; left time: 9681.7284s
	iters: 200, epoch: 3 | loss: 0.0185049
	speed: 0.0644s/iter; left time: 2595.4031s
	iters: 300, epoch: 3 | loss: 0.0030187
	speed: 0.0642s/iter; left time: 2578.2113s
	iters: 400, epoch: 3 | loss: 0.0015752
	speed: 0.0626s/iter; left time: 2510.4437s
Epoch: 3 cost time: 26.94004511833191
Epoch: 3, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
Validation loss decreased (-0.959526 --> -0.979081).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0021053
	speed: 0.2389s/iter; left time: 9546.5431s
	iters: 200, epoch: 4 | loss: 0.3934147
	speed: 0.0513s/iter; left time: 2046.5087s
	iters: 300, epoch: 4 | loss: 0.3206297
	speed: 0.0629s/iter; left time: 2502.5203s
	iters: 400, epoch: 4 | loss: 0.0002756
	speed: 0.0603s/iter; left time: 2390.3134s
Epoch: 4 cost time: 24.447340726852417
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.180 Vali Acc: 0.968 Test Loss: 0.180 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0024974
	speed: 0.2122s/iter; left time: 8391.8665s
	iters: 200, epoch: 5 | loss: 0.0001563
	speed: 0.0472s/iter; left time: 1861.2317s
	iters: 300, epoch: 5 | loss: 0.0015641
	speed: 0.0429s/iter; left time: 1686.9181s
	iters: 400, epoch: 5 | loss: 0.0000058
	speed: 0.0434s/iter; left time: 1703.5416s
Epoch: 5 cost time: 19.639968156814575
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000007
	speed: 0.1928s/iter; left time: 7544.6118s
	iters: 200, epoch: 6 | loss: 0.0000931
	speed: 0.0454s/iter; left time: 1772.2605s
	iters: 300, epoch: 6 | loss: 0.4736880
	speed: 0.0456s/iter; left time: 1775.0379s
	iters: 400, epoch: 6 | loss: 0.0147731
	speed: 0.0417s/iter; left time: 1617.8802s
Epoch: 6 cost time: 18.513495922088623
Epoch: 6, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.3745412
	speed: 0.2212s/iter; left time: 8563.8500s
	iters: 200, epoch: 7 | loss: 0.0001481
	speed: 0.0452s/iter; left time: 1745.9639s
	iters: 300, epoch: 7 | loss: 0.0000038
	speed: 0.0446s/iter; left time: 1717.1061s
	iters: 400, epoch: 7 | loss: 0.0006501
	speed: 0.0440s/iter; left time: 1690.9468s
Epoch: 7 cost time: 19.546119213104248
Epoch: 7, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0002312
	speed: 0.1938s/iter; left time: 7422.9124s
	iters: 200, epoch: 8 | loss: 0.0000051
	speed: 0.0404s/iter; left time: 1545.3251s
	iters: 300, epoch: 8 | loss: 0.0409171
	speed: 0.0428s/iter; left time: 1630.2066s
	iters: 400, epoch: 8 | loss: 0.0646852
	speed: 0.0457s/iter; left time: 1736.3058s
Epoch: 8 cost time: 18.671092987060547
Epoch: 8, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.186 Vali Acc: 0.974 Test Loss: 0.186 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0001976
	speed: 0.2018s/iter; left time: 7648.3456s
	iters: 200, epoch: 9 | loss: 0.0000028
	speed: 0.0422s/iter; left time: 1596.7224s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 1678.5681s
	iters: 400, epoch: 9 | loss: 0.0116283
	speed: 0.0494s/iter; left time: 1858.8962s
Epoch: 9 cost time: 19.46100687980652
Epoch: 9, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.232 Vali Acc: 0.965 Test Loss: 0.232 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0001844
	speed: 0.2238s/iter; left time: 8388.7813s
	iters: 200, epoch: 10 | loss: 0.0000024
	speed: 0.0509s/iter; left time: 1903.2609s
	iters: 300, epoch: 10 | loss: 0.0000032
	speed: 0.0494s/iter; left time: 1843.0590s
	iters: 400, epoch: 10 | loss: 0.0000628
	speed: 0.0485s/iter; left time: 1804.8156s
Epoch: 10 cost time: 21.557424068450928
Epoch: 10, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.240 Vali Acc: 0.967 Test Loss: 0.240 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2210s/iter; left time: 8193.0463s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0467s/iter; left time: 1727.8550s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0494s/iter; left time: 1820.5114s
	iters: 400, epoch: 11 | loss: 0.0189337
	speed: 0.0466s/iter; left time: 1713.1794s
Epoch: 11 cost time: 20.725990295410156
Epoch: 11, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.197 Vali Acc: 0.977 Test Loss: 0.197 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000171
	speed: 0.2387s/iter; left time: 8750.6725s
	iters: 200, epoch: 12 | loss: 0.0328123
	speed: 0.0541s/iter; left time: 1976.1592s
	iters: 300, epoch: 12 | loss: 0.0000006
	speed: 0.0561s/iter; left time: 2045.0007s
	iters: 400, epoch: 12 | loss: 0.0001083
	speed: 0.0537s/iter; left time: 1953.5819s
Epoch: 12 cost time: 23.93710684776306
Epoch: 12, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000102
	speed: 0.2526s/iter; left time: 9156.8743s
	iters: 200, epoch: 13 | loss: 0.0000017
	speed: 0.0441s/iter; left time: 1595.4915s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0542s/iter; left time: 1954.1412s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 2010.1333s
Epoch: 13 cost time: 22.505236625671387
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.285 Vali Acc: 0.965 Test Loss: 0.285 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
model parameter : 126666
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3332464
	speed: 0.1051s/iter; left time: 4331.3568s
	iters: 200, epoch: 1 | loss: 0.2934884
	speed: 0.0531s/iter; left time: 2183.1949s
	iters: 300, epoch: 1 | loss: 0.0486025
	speed: 0.0575s/iter; left time: 2355.7380s
	iters: 400, epoch: 1 | loss: 0.0622580
	speed: 0.0526s/iter; left time: 2152.0230s
Epoch: 1 cost time: 27.730942964553833
Epoch: 1, Steps: 413 | Train Loss: 0.445 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
Validation loss decreased (inf --> -0.956797).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0222539
	speed: 0.2522s/iter; left time: 10288.3759s
	iters: 200, epoch: 2 | loss: 0.0066361
	speed: 0.0607s/iter; left time: 2470.3752s
	iters: 300, epoch: 2 | loss: 0.2333332
	speed: 0.0522s/iter; left time: 2120.0801s
	iters: 400, epoch: 2 | loss: 0.0010092
	speed: 0.0586s/iter; left time: 2371.3475s
Epoch: 2 cost time: 24.45012593269348
Epoch: 2, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.096 Vali Acc: 0.969 Test Loss: 0.096 Test Acc: 0.969
Validation loss decreased (-0.956797 --> -0.969076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1069484
	speed: 0.2540s/iter; left time: 10254.2957s
	iters: 200, epoch: 3 | loss: 0.1406720
	speed: 0.0579s/iter; left time: 2333.1636s
	iters: 300, epoch: 3 | loss: 0.0005264
	speed: 0.0552s/iter; left time: 2217.5116s
	iters: 400, epoch: 3 | loss: 0.4779620
	speed: 0.0571s/iter; left time: 2287.9063s
Epoch: 3 cost time: 24.431820154190063
Epoch: 3, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.084 Vali Acc: 0.972 Test Loss: 0.084 Test Acc: 0.972
Validation loss decreased (-0.969076 --> -0.972259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0034400
	speed: 0.2729s/iter; left time: 10904.2479s
	iters: 200, epoch: 4 | loss: 0.4093310
	speed: 0.0620s/iter; left time: 2473.0156s
	iters: 300, epoch: 4 | loss: 0.0000553
	speed: 0.0559s/iter; left time: 2222.7088s
	iters: 400, epoch: 4 | loss: 0.0002250
	speed: 0.0545s/iter; left time: 2159.8743s
Epoch: 4 cost time: 24.17694330215454
Epoch: 4, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0001289
	speed: 0.2709s/iter; left time: 10714.0924s
	iters: 200, epoch: 5 | loss: 0.0004849
	speed: 0.0619s/iter; left time: 2443.0305s
	iters: 300, epoch: 5 | loss: 0.0004322
	speed: 0.0525s/iter; left time: 2064.1307s
	iters: 400, epoch: 5 | loss: 0.0242854
	speed: 0.0631s/iter; left time: 2474.9981s
Epoch: 5 cost time: 26.67418146133423
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.972259 --> -0.974533).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000008
	speed: 0.2936s/iter; left time: 11491.3725s
	iters: 200, epoch: 6 | loss: 0.0105314
	speed: 0.0632s/iter; left time: 2468.1436s
	iters: 300, epoch: 6 | loss: 0.0000347
	speed: 0.0558s/iter; left time: 2171.9197s
	iters: 400, epoch: 6 | loss: 0.8086092
	speed: 0.0565s/iter; left time: 2193.5827s
Epoch: 6 cost time: 25.461164951324463
Epoch: 6, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000142
	speed: 0.2770s/iter; left time: 10724.3755s
	iters: 200, epoch: 7 | loss: 0.0038903
	speed: 0.0681s/iter; left time: 2632.0414s
	iters: 300, epoch: 7 | loss: 0.0000811
	speed: 0.0556s/iter; left time: 2142.0141s
	iters: 400, epoch: 7 | loss: 0.0002985
	speed: 0.0594s/iter; left time: 2282.4784s
Epoch: 7 cost time: 26.6952702999115
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.210 Vali Acc: 0.963 Test Loss: 0.210 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000122
	speed: 0.2833s/iter; left time: 10851.6436s
	iters: 200, epoch: 8 | loss: 0.0013799
	speed: 0.0682s/iter; left time: 2605.1333s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 2088.4936s
	iters: 400, epoch: 8 | loss: 0.0000041
	speed: 0.0573s/iter; left time: 2178.0457s
Epoch: 8 cost time: 27.127272605895996
Epoch: 8, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000126
	speed: 0.2712s/iter; left time: 10278.5298s
	iters: 200, epoch: 9 | loss: 0.0000020
	speed: 0.0649s/iter; left time: 2452.3508s
	iters: 300, epoch: 9 | loss: 0.0012332
	speed: 0.0675s/iter; left time: 2545.8120s
	iters: 400, epoch: 9 | loss: 0.0000070
	speed: 0.0634s/iter; left time: 2382.4525s
Epoch: 9 cost time: 27.92057204246521
Epoch: 9, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0005465
	speed: 0.2816s/iter; left time: 10555.3182s
	iters: 200, epoch: 10 | loss: 0.0000004
	speed: 0.0599s/iter; left time: 2237.6063s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0659s/iter; left time: 2456.1112s
	iters: 400, epoch: 10 | loss: 0.0000390
	speed: 0.0618s/iter; left time: 2298.0968s
Epoch: 10 cost time: 27.164278268814087
Epoch: 10, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000068
	speed: 0.2866s/iter; left time: 10626.0383s
	iters: 200, epoch: 11 | loss: 0.0000524
	speed: 0.0704s/iter; left time: 2601.1027s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 2140.9924s
	iters: 400, epoch: 11 | loss: 0.0582354
	speed: 0.0606s/iter; left time: 2227.8411s
Epoch: 11 cost time: 27.430980920791626
Epoch: 11, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.314 Vali Acc: 0.955 Test Loss: 0.314 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.4743022
	speed: 0.2490s/iter; left time: 9128.1485s
	iters: 200, epoch: 12 | loss: 0.1073361
	speed: 0.0648s/iter; left time: 2370.5304s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 2119.3912s
	iters: 400, epoch: 12 | loss: 0.0000070
	speed: 0.0495s/iter; left time: 1798.7548s
Epoch: 12 cost time: 25.430999994277954
Epoch: 12, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.209 Vali Acc: 0.970 Test Loss: 0.209 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000044
	speed: 0.2550s/iter; left time: 9244.0137s
	iters: 200, epoch: 13 | loss: 0.0000017
	speed: 0.0550s/iter; left time: 1987.4231s
	iters: 300, epoch: 13 | loss: 0.1451094
	speed: 0.0585s/iter; left time: 2108.7342s
	iters: 400, epoch: 13 | loss: 0.0000073
	speed: 0.0566s/iter; left time: 2035.6922s
Epoch: 13 cost time: 24.67250370979309
Epoch: 13, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.195 Vali Acc: 0.973 Test Loss: 0.195 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000594
	speed: 0.2543s/iter; left time: 9110.6049s
	iters: 200, epoch: 14 | loss: 0.0003568
	speed: 0.0567s/iter; left time: 2024.2236s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0570s/iter; left time: 2030.6428s
	iters: 400, epoch: 14 | loss: 0.0003250
	speed: 0.0601s/iter; left time: 2135.3763s
Epoch: 14 cost time: 25.4314546585083
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.222 Vali Acc: 0.970 Test Loss: 0.222 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0328453
	speed: 0.2425s/iter; left time: 8588.5463s
	iters: 200, epoch: 15 | loss: 0.0000015
	speed: 0.0525s/iter; left time: 1853.2208s
	iters: 300, epoch: 15 | loss: 0.0000003
	speed: 0.0631s/iter; left time: 2221.8483s
	iters: 400, epoch: 15 | loss: 0.0021910
	speed: 0.0603s/iter; left time: 2116.3895s
Epoch: 15 cost time: 25.207056760787964
Epoch: 15, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.200 Vali Acc: 0.977 Test Loss: 0.200 Test Acc: 0.977
Validation loss decreased (-0.974533 --> -0.976806).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2386887
	speed: 0.2578s/iter; left time: 9024.6843s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0664s/iter; left time: 2319.2966s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 2303.3182s
	iters: 400, epoch: 16 | loss: 0.0000044
	speed: 0.0640s/iter; left time: 2220.7191s
Epoch: 16 cost time: 27.95139503479004
Epoch: 16, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.228 Vali Acc: 0.976 Test Loss: 0.228 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2726s/iter; left time: 9428.7283s
	iters: 200, epoch: 17 | loss: 0.0000314
	speed: 0.0599s/iter; left time: 2066.0370s
	iters: 300, epoch: 17 | loss: 0.0918136
	speed: 0.0609s/iter; left time: 2094.8290s
	iters: 400, epoch: 17 | loss: 0.0000023
	speed: 0.0623s/iter; left time: 2136.2775s
Epoch: 17 cost time: 27.08399200439453
Epoch: 17, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.219 Vali Acc: 0.974 Test Loss: 0.219 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0004684
	speed: 0.2679s/iter; left time: 9155.2361s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0667s/iter; left time: 2274.2893s
	iters: 300, epoch: 18 | loss: 0.0101493
	speed: 0.0590s/iter; left time: 2005.0947s
	iters: 400, epoch: 18 | loss: 0.0074168
	speed: 0.0655s/iter; left time: 2220.7999s
Epoch: 18 cost time: 26.95859408378601
Epoch: 18, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.357 Vali Acc: 0.961 Test Loss: 0.357 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000023
	speed: 0.2606s/iter; left time: 8800.0768s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0611s/iter; left time: 2055.6211s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0674s/iter; left time: 2262.5556s
	iters: 400, epoch: 19 | loss: 0.0034420
	speed: 0.0671s/iter; left time: 2245.1365s
Epoch: 19 cost time: 27.99210000038147
Epoch: 19, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.976806 --> -0.976806).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.1425236
	speed: 0.2596s/iter; left time: 8657.2547s
	iters: 200, epoch: 20 | loss: 0.0000006
	speed: 0.0539s/iter; left time: 1791.7728s
	iters: 300, epoch: 20 | loss: 0.1947371
	speed: 0.0557s/iter; left time: 1845.2178s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.0613s/iter; left time: 2026.9826s
Epoch: 20 cost time: 24.230544805526733
Epoch: 20, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.209 Vali Acc: 0.977 Test Loss: 0.209 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2702s/iter; left time: 8901.8165s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0563s/iter; left time: 1847.3073s
	iters: 300, epoch: 21 | loss: 0.0080569
	speed: 0.0540s/iter; left time: 1766.6944s
	iters: 400, epoch: 21 | loss: 0.0001911
	speed: 0.0542s/iter; left time: 1769.6208s
Epoch: 21 cost time: 24.53516173362732
Epoch: 21, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.252 Vali Acc: 0.973 Test Loss: 0.252 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.2567s/iter; left time: 8351.5017s
	iters: 200, epoch: 22 | loss: 0.2418332
	speed: 0.0561s/iter; left time: 1817.6545s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0592s/iter; left time: 1912.4310s
	iters: 400, epoch: 22 | loss: 0.4094591
	speed: 0.0678s/iter; left time: 2184.1910s
Epoch: 22 cost time: 25.547718286514282
Epoch: 22, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.222 Vali Acc: 0.976 Test Loss: 0.222 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1451660
	speed: 0.2494s/iter; left time: 8007.9144s
	iters: 200, epoch: 23 | loss: 0.0002978
	speed: 0.0486s/iter; left time: 1556.5004s
	iters: 300, epoch: 23 | loss: 0.0000120
	speed: 0.0482s/iter; left time: 1538.4665s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0637s/iter; left time: 2025.7287s
Epoch: 23 cost time: 22.87808322906494
Epoch: 23, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.194 Vali Acc: 0.976 Test Loss: 0.194 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2605s/iter; left time: 8258.8948s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0540s/iter; left time: 1706.2378s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0552s/iter; left time: 1739.6603s
	iters: 400, epoch: 24 | loss: 0.0000020
	speed: 0.0500s/iter; left time: 1569.9554s
Epoch: 24 cost time: 23.71683979034424
Epoch: 24, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.173 Vali Acc: 0.981 Test Loss: 0.173 Test Acc: 0.981
Validation loss decreased (-0.976806 --> -0.981353).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000319
	speed: 0.2343s/iter; left time: 7331.5088s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 1478.3387s
	iters: 300, epoch: 25 | loss: 0.0000033
	speed: 0.0537s/iter; left time: 1669.6262s
	iters: 400, epoch: 25 | loss: 0.0004121
	speed: 0.0616s/iter; left time: 1908.4798s
Epoch: 25 cost time: 23.83348035812378
Epoch: 25, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.179 Vali Acc: 0.977 Test Loss: 0.179 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0001142
	speed: 0.2475s/iter; left time: 7641.7007s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 1882.9422s
	iters: 300, epoch: 26 | loss: 0.0003540
	speed: 0.0594s/iter; left time: 1823.6749s
	iters: 400, epoch: 26 | loss: 0.0000017
	speed: 0.0577s/iter; left time: 1765.1968s
Epoch: 26 cost time: 26.05341410636902
Epoch: 26, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000038
	speed: 0.2606s/iter; left time: 7937.3046s
	iters: 200, epoch: 27 | loss: 0.0000005
	speed: 0.0595s/iter; left time: 1805.5918s
	iters: 300, epoch: 27 | loss: 0.0000002
	speed: 0.0601s/iter; left time: 1818.1980s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 1708.6614s
Epoch: 27 cost time: 25.5569064617157
Epoch: 27, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000011
	speed: 0.2801s/iter; left time: 8415.7445s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 1735.0705s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 1685.0912s
	iters: 400, epoch: 28 | loss: 0.0000006
	speed: 0.0574s/iter; left time: 1709.1237s
Epoch: 28 cost time: 24.556596755981445
Epoch: 28, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.274 Vali Acc: 0.974 Test Loss: 0.274 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000495
	speed: 0.2886s/iter; left time: 8553.1607s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0511s/iter; left time: 1508.4446s
	iters: 300, epoch: 29 | loss: 0.1075216
	speed: 0.0580s/iter; left time: 1706.2181s
	iters: 400, epoch: 29 | loss: 0.0000010
	speed: 0.0484s/iter; left time: 1418.7791s
Epoch: 29 cost time: 23.754332065582275
Epoch: 29, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.282 Vali Acc: 0.973 Test Loss: 0.282 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000015
	speed: 0.2340s/iter; left time: 6838.7409s
	iters: 200, epoch: 30 | loss: 0.1252087
	speed: 0.0511s/iter; left time: 1487.2147s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 1696.0091s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0531s/iter; left time: 1535.8076s
Epoch: 30 cost time: 22.74345564842224
Epoch: 30, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.159 Vali Acc: 0.984 Test Loss: 0.159 Test Acc: 0.984
Validation loss decreased (-0.981353 --> -0.983627).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0000012
	speed: 0.2272s/iter; left time: 6546.7144s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0508s/iter; left time: 1459.7263s
	iters: 300, epoch: 31 | loss: 0.3296003
	speed: 0.0493s/iter; left time: 1410.5514s
	iters: 400, epoch: 31 | loss: 0.0000005
	speed: 0.0543s/iter; left time: 1548.2515s
Epoch: 31 cost time: 22.184911012649536
Epoch: 31, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.207 Vali Acc: 0.978 Test Loss: 0.207 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0512602
	speed: 0.2384s/iter; left time: 6771.2574s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0524s/iter; left time: 1482.3460s
	iters: 300, epoch: 32 | loss: 0.0000925
	speed: 0.0461s/iter; left time: 1299.5442s
	iters: 400, epoch: 32 | loss: 0.0755839
	speed: 0.0523s/iter; left time: 1470.3464s
Epoch: 32 cost time: 21.95756220817566
Epoch: 32, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.299 Vali Acc: 0.971 Test Loss: 0.299 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2499s/iter; left time: 6993.2370s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 1237.6844s
	iters: 300, epoch: 33 | loss: 0.0013230
	speed: 0.0457s/iter; left time: 1268.5735s
	iters: 400, epoch: 33 | loss: 0.0000075
	speed: 0.0465s/iter; left time: 1288.2307s
Epoch: 33 cost time: 20.54274010658264
Epoch: 33, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.322 Vali Acc: 0.973 Test Loss: 0.322 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2180s/iter; left time: 6010.6895s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0372s/iter; left time: 1021.4185s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 1260.6793s
	iters: 400, epoch: 34 | loss: 0.0161502
	speed: 0.0498s/iter; left time: 1359.4036s
Epoch: 34 cost time: 19.61885166168213
Epoch: 34, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.296 Vali Acc: 0.972 Test Loss: 0.296 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2277s/iter; left time: 6184.0914s
	iters: 200, epoch: 35 | loss: 0.0000002
	speed: 0.0485s/iter; left time: 1313.4505s
	iters: 300, epoch: 35 | loss: 0.0000157
	speed: 0.0556s/iter; left time: 1498.5400s
	iters: 400, epoch: 35 | loss: 0.0000003
	speed: 0.0437s/iter; left time: 1174.8037s
Epoch: 35 cost time: 21.65109157562256
Epoch: 35, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.323 Vali Acc: 0.971 Test Loss: 0.323 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2202s/iter; left time: 5888.9403s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0508s/iter; left time: 1353.8662s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 1352.1930s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 1592.6610s
Epoch: 36 cost time: 22.93324589729309
Epoch: 36, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.292 Vali Acc: 0.969 Test Loss: 0.292 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0000002
	speed: 0.2303s/iter; left time: 6064.2030s
	iters: 200, epoch: 37 | loss: 0.0221042
	speed: 0.0532s/iter; left time: 1394.5594s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 1347.7712s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 1480.9548s
Epoch: 37 cost time: 22.96052122116089
Epoch: 37, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.257 Vali Acc: 0.970 Test Loss: 0.257 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2660s/iter; left time: 6893.8337s
	iters: 200, epoch: 38 | loss: 0.0000012
	speed: 0.0573s/iter; left time: 1480.7069s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 1483.7501s
	iters: 400, epoch: 38 | loss: 0.0000001
	speed: 0.0548s/iter; left time: 1403.7328s
Epoch: 38 cost time: 25.049876928329468
Epoch: 38, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.309 Vali Acc: 0.969 Test Loss: 0.309 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0000002
	speed: 0.2595s/iter; left time: 6618.8311s
	iters: 200, epoch: 39 | loss: 0.0376272
	speed: 0.0587s/iter; left time: 1491.0520s
	iters: 300, epoch: 39 | loss: 0.0002079
	speed: 0.0581s/iter; left time: 1469.4566s
	iters: 400, epoch: 39 | loss: 0.3790519
	speed: 0.0594s/iter; left time: 1496.5553s
Epoch: 39 cost time: 25.157421588897705
Epoch: 39, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.215 Vali Acc: 0.978 Test Loss: 0.215 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.6651300
	speed: 0.2602s/iter; left time: 6529.3745s
	iters: 200, epoch: 40 | loss: 0.0001107
	speed: 0.0590s/iter; left time: 1475.6227s
	iters: 300, epoch: 40 | loss: 0.0000437
	speed: 0.0573s/iter; left time: 1426.9286s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0613s/iter; left time: 1519.7742s
Epoch: 40 cost time: 25.276968479156494
Epoch: 40, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.337 Vali Acc: 0.972 Test Loss: 0.337 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm64_nh16_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 110346
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1389554
	speed: 0.0947s/iter; left time: 3903.4831s
	iters: 200, epoch: 1 | loss: 0.1203819
	speed: 0.0624s/iter; left time: 2565.2946s
	iters: 300, epoch: 1 | loss: 0.2781095
	speed: 0.0664s/iter; left time: 2720.8322s
	iters: 400, epoch: 1 | loss: 0.0241655
	speed: 0.0577s/iter; left time: 2361.8554s
Epoch: 1 cost time: 28.90407419204712
Epoch: 1, Steps: 413 | Train Loss: 0.380 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
Validation loss decreased (inf --> -0.934513).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4770472
	speed: 0.2666s/iter; left time: 10874.8910s
	iters: 200, epoch: 2 | loss: 0.0033951
	speed: 0.0693s/iter; left time: 2819.0458s
	iters: 300, epoch: 2 | loss: 0.4452015
	speed: 0.0520s/iter; left time: 2111.0341s
	iters: 400, epoch: 2 | loss: 0.1193452
	speed: 0.0589s/iter; left time: 2384.5304s
Epoch: 2 cost time: 26.846271276474
Epoch: 2, Steps: 413 | Train Loss: 0.140 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.934513 --> -0.950430).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1055704
	speed: 0.2742s/iter; left time: 11071.4804s
	iters: 200, epoch: 3 | loss: 0.0256111
	speed: 0.0648s/iter; left time: 2609.4426s
	iters: 300, epoch: 3 | loss: 0.0067632
	speed: 0.0567s/iter; left time: 2278.9463s
	iters: 400, epoch: 3 | loss: 0.0130373
	speed: 0.0478s/iter; left time: 1914.4858s
Epoch: 3 cost time: 25.824593544006348
Epoch: 3, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.167 Vali Acc: 0.966 Test Loss: 0.167 Test Acc: 0.966
Validation loss decreased (-0.950430 --> -0.966347).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0381506
	speed: 0.2408s/iter; left time: 9623.0904s
	iters: 200, epoch: 4 | loss: 0.0000361
	speed: 0.0572s/iter; left time: 2278.1364s
	iters: 300, epoch: 4 | loss: 0.0000303
	speed: 0.0579s/iter; left time: 2300.8359s
	iters: 400, epoch: 4 | loss: 0.0003746
	speed: 0.0593s/iter; left time: 2351.3057s
Epoch: 4 cost time: 25.025743007659912
Epoch: 4, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
Validation loss decreased (-0.966347 --> -0.966801).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000004
	speed: 0.2491s/iter; left time: 9850.8845s
	iters: 200, epoch: 5 | loss: 0.2096236
	speed: 0.0699s/iter; left time: 2759.0339s
	iters: 300, epoch: 5 | loss: 0.6597984
	speed: 0.0705s/iter; left time: 2774.2343s
	iters: 400, epoch: 5 | loss: 0.1453838
	speed: 0.0627s/iter; left time: 2460.6720s
Epoch: 5 cost time: 28.599236011505127
Epoch: 5, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.280 Vali Acc: 0.968 Test Loss: 0.280 Test Acc: 0.968
Validation loss decreased (-0.966801 --> -0.967710).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000002
	speed: 0.2727s/iter; left time: 10671.5799s
	iters: 200, epoch: 6 | loss: 0.0000024
	speed: 0.0692s/iter; left time: 2700.1147s
	iters: 300, epoch: 6 | loss: 0.0001196
	speed: 0.0703s/iter; left time: 2736.4587s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0754s/iter; left time: 2929.8610s
Epoch: 6 cost time: 29.802802562713623
Epoch: 6, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.413 Vali Acc: 0.960 Test Loss: 0.413 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000014
	speed: 0.2977s/iter; left time: 11528.2111s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0721s/iter; left time: 2785.7358s
	iters: 300, epoch: 7 | loss: 0.0235622
	speed: 0.0850s/iter; left time: 3274.2856s
	iters: 400, epoch: 7 | loss: 0.0000981
	speed: 0.0779s/iter; left time: 2993.6760s
Epoch: 7 cost time: 32.817779779434204
Epoch: 7, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.366 Vali Acc: 0.964 Test Loss: 0.366 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000004
	speed: 0.3175s/iter; left time: 12162.5951s
	iters: 200, epoch: 8 | loss: 0.0000384
	speed: 0.0726s/iter; left time: 2773.4180s
	iters: 300, epoch: 8 | loss: 0.0000013
	speed: 0.0651s/iter; left time: 2479.2762s
	iters: 400, epoch: 8 | loss: 0.0000006
	speed: 0.0872s/iter; left time: 3314.3557s
Epoch: 8 cost time: 32.788267850875854
Epoch: 8, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.382 Vali Acc: 0.962 Test Loss: 0.382 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000006
	speed: 0.2978s/iter; left time: 11284.7001s
	iters: 200, epoch: 9 | loss: 0.0012803
	speed: 0.0485s/iter; left time: 1832.6055s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0581s/iter; left time: 2188.8516s
	iters: 400, epoch: 9 | loss: 0.0001892
	speed: 0.0538s/iter; left time: 2024.3364s
Epoch: 9 cost time: 24.611173391342163
Epoch: 9, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.336 Vali Acc: 0.969 Test Loss: 0.336 Test Acc: 0.969
Validation loss decreased (-0.967710 --> -0.968619).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000287
	speed: 0.2682s/iter; left time: 10053.4355s
	iters: 200, epoch: 10 | loss: 0.0021820
	speed: 0.0553s/iter; left time: 2068.7545s
	iters: 300, epoch: 10 | loss: 0.0084019
	speed: 0.0523s/iter; left time: 1949.0387s
	iters: 400, epoch: 10 | loss: 1.0305623
	speed: 0.0502s/iter; left time: 1867.7701s
Epoch: 10 cost time: 23.050320863723755
Epoch: 10, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.360 Vali Acc: 0.966 Test Loss: 0.360 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2406s/iter; left time: 8918.7266s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0618s/iter; left time: 2285.5877s
	iters: 300, epoch: 11 | loss: 0.0036143
	speed: 0.0588s/iter; left time: 2169.0817s
	iters: 400, epoch: 11 | loss: 0.0367922
	speed: 0.0549s/iter; left time: 2019.8153s
Epoch: 11 cost time: 24.53539204597473
Epoch: 11, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.377 Vali Acc: 0.963 Test Loss: 0.377 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2568s/iter; left time: 9413.0735s
	iters: 200, epoch: 12 | loss: 0.0000115
	speed: 0.0698s/iter; left time: 2551.3543s
	iters: 300, epoch: 12 | loss: 0.0002069
	speed: 0.0788s/iter; left time: 2872.3415s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0780s/iter; left time: 2836.1183s
Epoch: 12 cost time: 30.45534086227417
Epoch: 12, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.316 Vali Acc: 0.972 Test Loss: 0.316 Test Acc: 0.972
Validation loss decreased (-0.968619 --> -0.972257).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2679s/iter; left time: 9709.3279s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0587s/iter; left time: 2120.4491s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0673s/iter; left time: 2427.4119s
	iters: 400, epoch: 13 | loss: 1.1178894
	speed: 0.0599s/iter; left time: 2153.2644s
Epoch: 13 cost time: 26.82697820663452
Epoch: 13, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.688 Vali Acc: 0.951 Test Loss: 0.688 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000288
	speed: 0.2560s/iter; left time: 9173.8600s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0604s/iter; left time: 2157.9677s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0629s/iter; left time: 2241.0605s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0723s/iter; left time: 2568.2955s
Epoch: 14 cost time: 27.693997383117676
Epoch: 14, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.394 Vali Acc: 0.970 Test Loss: 0.394 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0549714
	speed: 0.2919s/iter; left time: 10337.3528s
	iters: 200, epoch: 15 | loss: 0.0004219
	speed: 0.0709s/iter; left time: 2505.7618s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0830s/iter; left time: 2923.5074s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0711s/iter; left time: 2495.9648s
Epoch: 15 cost time: 31.970700979232788
Epoch: 15, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.517 Vali Acc: 0.968 Test Loss: 0.517 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2828s/iter; left time: 9900.4890s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0695s/iter; left time: 2425.6373s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0737s/iter; left time: 2566.4325s
	iters: 400, epoch: 16 | loss: 0.0000592
	speed: 0.0775s/iter; left time: 2691.4434s
Epoch: 16 cost time: 31.23718523979187
Epoch: 16, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.357 Vali Acc: 0.969 Test Loss: 0.357 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.8148831
	speed: 0.3078s/iter; left time: 10648.0591s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0749s/iter; left time: 2582.7035s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0855s/iter; left time: 2939.9241s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0838s/iter; left time: 2873.3674s
Epoch: 17 cost time: 35.04475998878479
Epoch: 17, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.369 Vali Acc: 0.972 Test Loss: 0.369 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2808s/iter; left time: 9598.4693s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0734s/iter; left time: 2500.5310s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 2683.3331s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0842s/iter; left time: 2851.6072s
Epoch: 18 cost time: 32.421815395355225
Epoch: 18, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.485 Vali Acc: 0.970 Test Loss: 0.485 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2781s/iter; left time: 9391.7622s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 1784.3916s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0540s/iter; left time: 1813.9214s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 1597.0351s
Epoch: 19 cost time: 23.218117713928223
Epoch: 19, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.462 Vali Acc: 0.967 Test Loss: 0.462 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2473s/iter; left time: 8248.4689s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0573s/iter; left time: 1907.0717s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 1882.7772s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0641s/iter; left time: 2117.1822s
Epoch: 20 cost time: 24.816098928451538
Epoch: 20, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.500 Vali Acc: 0.969 Test Loss: 0.500 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000078
	speed: 0.2477s/iter; left time: 8161.0945s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0573s/iter; left time: 1881.6437s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 1985.6829s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 1671.9765s
Epoch: 21 cost time: 23.711665153503418
Epoch: 21, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.442 Vali Acc: 0.972 Test Loss: 0.442 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2558s/iter; left time: 8322.2610s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0677s/iter; left time: 2195.1132s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0553s/iter; left time: 1788.2920s
	iters: 400, epoch: 22 | loss: 0.0000013
	speed: 0.0636s/iter; left time: 2050.0605s
Epoch: 22 cost time: 26.90824055671692
Epoch: 22, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.540 Vali Acc: 0.963 Test Loss: 0.540 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9722601182355616
model parameter : 237738
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2360591
	speed: 0.0924s/iter; left time: 3806.1369s
	iters: 200, epoch: 1 | loss: 0.1107459
	speed: 0.0584s/iter; left time: 2401.0259s
	iters: 300, epoch: 1 | loss: 0.0851275
	speed: 0.0716s/iter; left time: 2935.6398s
	iters: 400, epoch: 1 | loss: 0.3348596
	speed: 0.0767s/iter; left time: 3135.7387s
Epoch: 1 cost time: 31.19195318222046
Epoch: 1, Steps: 413 | Train Loss: 0.359 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
Validation loss decreased (inf --> -0.959526).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0046334
	speed: 0.2644s/iter; left time: 10783.7389s
	iters: 200, epoch: 2 | loss: 0.2079140
	speed: 0.0824s/iter; left time: 3353.1323s
	iters: 300, epoch: 2 | loss: 0.0021545
	speed: 0.0811s/iter; left time: 3293.4887s
	iters: 400, epoch: 2 | loss: 0.0009983
	speed: 0.0587s/iter; left time: 2377.6770s
Epoch: 2 cost time: 31.475420475006104
Epoch: 2, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
Validation loss decreased (-0.959526 --> -0.964528).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0190213
	speed: 0.2573s/iter; left time: 10386.7641s
	iters: 200, epoch: 3 | loss: 0.0711655
	speed: 0.0907s/iter; left time: 3652.2170s
	iters: 300, epoch: 3 | loss: 0.0580418
	speed: 0.0804s/iter; left time: 3232.0540s
	iters: 400, epoch: 3 | loss: 0.0002992
	speed: 0.0742s/iter; left time: 2972.6171s
Epoch: 3 cost time: 34.186705589294434
Epoch: 3, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
Validation loss decreased (-0.964528 --> -0.969530).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2251321
	speed: 0.2640s/iter; left time: 10548.6064s
	iters: 200, epoch: 4 | loss: 0.3759633
	speed: 0.0973s/iter; left time: 3879.6979s
	iters: 300, epoch: 4 | loss: 0.0028399
	speed: 0.0732s/iter; left time: 2911.0899s
	iters: 400, epoch: 4 | loss: 0.0008820
	speed: 0.0676s/iter; left time: 2681.6689s
Epoch: 4 cost time: 34.37632918357849
Epoch: 4, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.184 Vali Acc: 0.971 Test Loss: 0.184 Test Acc: 0.971
Validation loss decreased (-0.969530 --> -0.970894).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000063
	speed: 0.3015s/iter; left time: 11925.4131s
	iters: 200, epoch: 5 | loss: 0.0000175
	speed: 0.0982s/iter; left time: 3875.5542s
	iters: 300, epoch: 5 | loss: 0.0000821
	speed: 0.0994s/iter; left time: 3911.0540s
	iters: 400, epoch: 5 | loss: 0.0020426
	speed: 0.0548s/iter; left time: 2150.3755s
Epoch: 5 cost time: 37.17236590385437
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.279 Vali Acc: 0.960 Test Loss: 0.279 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3511361
	speed: 0.2346s/iter; left time: 9182.4430s
	iters: 200, epoch: 6 | loss: 0.0003014
	speed: 0.0552s/iter; left time: 2154.5401s
	iters: 300, epoch: 6 | loss: 0.2111743
	speed: 0.0542s/iter; left time: 2108.8712s
	iters: 400, epoch: 6 | loss: 0.0011270
	speed: 0.0461s/iter; left time: 1789.7617s
Epoch: 6 cost time: 22.91128897666931
Epoch: 6, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.228 Vali Acc: 0.963 Test Loss: 0.228 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0457187
	speed: 0.2198s/iter; left time: 8512.4847s
	iters: 200, epoch: 7 | loss: 0.0020313
	speed: 0.0544s/iter; left time: 2102.1264s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0609s/iter; left time: 2344.5199s
	iters: 400, epoch: 7 | loss: 0.0002725
	speed: 0.0550s/iter; left time: 2112.9955s
Epoch: 7 cost time: 23.27695107460022
Epoch: 7, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.193 Vali Acc: 0.965 Test Loss: 0.193 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000807
	speed: 0.2365s/iter; left time: 9060.1339s
	iters: 200, epoch: 8 | loss: 0.6848356
	speed: 0.0471s/iter; left time: 1800.7382s
	iters: 300, epoch: 8 | loss: 0.0005466
	speed: 0.0658s/iter; left time: 2507.3366s
	iters: 400, epoch: 8 | loss: 0.0101036
	speed: 0.0561s/iter; left time: 2131.5369s
Epoch: 8 cost time: 23.980236053466797
Epoch: 8, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.370 Vali Acc: 0.956 Test Loss: 0.370 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000054
	speed: 0.2320s/iter; left time: 8791.3867s
	iters: 200, epoch: 9 | loss: 0.0000012
	speed: 0.0569s/iter; left time: 2151.2332s
	iters: 300, epoch: 9 | loss: 0.0000023
	speed: 0.0590s/iter; left time: 2222.2620s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0608s/iter; left time: 2284.5835s
Epoch: 9 cost time: 24.903817415237427
Epoch: 9, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.208 Vali Acc: 0.974 Test Loss: 0.208 Test Acc: 0.974
Validation loss decreased (-0.970894 --> -0.974077).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000397
	speed: 0.2510s/iter; left time: 9409.4519s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.0557s/iter; left time: 2081.6746s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0609s/iter; left time: 2270.7733s
	iters: 400, epoch: 10 | loss: 0.0000005
	speed: 0.0723s/iter; left time: 2687.4303s
Epoch: 10 cost time: 27.298487424850464
Epoch: 10, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.323 Vali Acc: 0.964 Test Loss: 0.323 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0003924
	speed: 0.2548s/iter; left time: 9445.7430s
	iters: 200, epoch: 11 | loss: 0.0000780
	speed: 0.0738s/iter; left time: 2727.1401s
	iters: 300, epoch: 11 | loss: 0.0000011
	speed: 0.0874s/iter; left time: 3223.9264s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0854s/iter; left time: 3139.8754s
Epoch: 11 cost time: 34.016780614852905
Epoch: 11, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
Validation loss decreased (-0.974077 --> -0.974531).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000025
	speed: 0.2700s/iter; left time: 9898.5043s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 2457.8599s
	iters: 300, epoch: 12 | loss: 0.0000256
	speed: 0.0826s/iter; left time: 3013.0462s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0930s/iter; left time: 3382.6646s
Epoch: 12 cost time: 33.76345872879028
Epoch: 12, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.257 Vali Acc: 0.972 Test Loss: 0.257 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2517s/iter; left time: 9122.3985s
	iters: 200, epoch: 13 | loss: 0.0021915
	speed: 0.0644s/iter; left time: 2328.8631s
	iters: 300, epoch: 13 | loss: 0.0000008
	speed: 0.0679s/iter; left time: 2446.3417s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0854s/iter; left time: 3067.9714s
Epoch: 13 cost time: 30.81124520301819
Epoch: 13, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.351 Vali Acc: 0.968 Test Loss: 0.351 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2512s/iter; left time: 9002.0686s
	iters: 200, epoch: 14 | loss: 0.0009423
	speed: 0.0579s/iter; left time: 2070.4892s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0639s/iter; left time: 2275.8861s
	iters: 400, epoch: 14 | loss: 0.0000112
	speed: 0.0613s/iter; left time: 2178.1003s
Epoch: 14 cost time: 26.81725239753723
Epoch: 14, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.421 Vali Acc: 0.961 Test Loss: 0.421 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2255s/iter; left time: 7988.4448s
	iters: 200, epoch: 15 | loss: 0.0190251
	speed: 0.0501s/iter; left time: 1769.2003s
	iters: 300, epoch: 15 | loss: 0.0000377
	speed: 0.0494s/iter; left time: 1739.9475s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 2204.6083s
Epoch: 15 cost time: 22.901631355285645
Epoch: 15, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.257 Vali Acc: 0.971 Test Loss: 0.257 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0002057
	speed: 0.2054s/iter; left time: 7191.6043s
	iters: 200, epoch: 16 | loss: 0.0017199
	speed: 0.0476s/iter; left time: 1662.8303s
	iters: 300, epoch: 16 | loss: 0.0000057
	speed: 0.0451s/iter; left time: 1569.3487s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1610.9995s
Epoch: 16 cost time: 20.119037866592407
Epoch: 16, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.363 Vali Acc: 0.968 Test Loss: 0.363 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0005634
	speed: 0.2310s/iter; left time: 7989.4815s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0502s/iter; left time: 1732.6172s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0514s/iter; left time: 1768.0641s
	iters: 400, epoch: 17 | loss: 0.0000051
	speed: 0.0522s/iter; left time: 1789.9679s
Epoch: 17 cost time: 22.397536039352417
Epoch: 17, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.361 Vali Acc: 0.970 Test Loss: 0.361 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2278s/iter; left time: 7786.1374s
	iters: 200, epoch: 18 | loss: 0.0000008
	speed: 0.0516s/iter; left time: 1758.7672s
	iters: 300, epoch: 18 | loss: 0.0000021
	speed: 0.0478s/iter; left time: 1624.4704s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 1750.5001s
Epoch: 18 cost time: 21.79051685333252
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.350 Vali Acc: 0.969 Test Loss: 0.350 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0387439
	speed: 0.2114s/iter; left time: 7137.6441s
	iters: 200, epoch: 19 | loss: 0.0000451
	speed: 0.0480s/iter; left time: 1615.1928s
	iters: 300, epoch: 19 | loss: 0.1575734
	speed: 0.0492s/iter; left time: 1650.4198s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0416s/iter; left time: 1391.8277s
Epoch: 19 cost time: 20.159478902816772
Epoch: 19, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.259 Vali Acc: 0.977 Test Loss: 0.259 Test Acc: 0.977
Validation loss decreased (-0.974531 --> -0.977260).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000004
	speed: 0.2196s/iter; left time: 7324.7650s
	iters: 200, epoch: 20 | loss: 0.0002929
	speed: 0.0532s/iter; left time: 1768.2460s
	iters: 300, epoch: 20 | loss: 0.0005660
	speed: 0.0686s/iter; left time: 2274.2109s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 1757.6365s
Epoch: 20 cost time: 23.70808506011963
Epoch: 20, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.427 Vali Acc: 0.963 Test Loss: 0.427 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2487s/iter; left time: 8191.4425s
	iters: 200, epoch: 21 | loss: 0.0000004
	speed: 0.0703s/iter; left time: 2309.0524s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0648s/iter; left time: 2120.7677s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0673s/iter; left time: 2197.3555s
Epoch: 21 cost time: 30.65389132499695
Epoch: 21, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.326 Vali Acc: 0.976 Test Loss: 0.326 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.2724s/iter; left time: 8861.2385s
	iters: 200, epoch: 22 | loss: 0.6838750
	speed: 0.0729s/iter; left time: 2362.7073s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 2267.9169s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0692s/iter; left time: 2229.0977s
Epoch: 22 cost time: 31.75644302368164
Epoch: 22, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.228 Vali Acc: 0.977 Test Loss: 0.228 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000683
	speed: 0.2703s/iter; left time: 8681.2480s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 2224.5698s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.0655s/iter; left time: 2089.7019s
	iters: 400, epoch: 23 | loss: 0.0000004
	speed: 0.0666s/iter; left time: 2118.6428s
Epoch: 23 cost time: 31.011791944503784
Epoch: 23, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.399 Vali Acc: 0.970 Test Loss: 0.399 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2867s/iter; left time: 9089.0463s
	iters: 200, epoch: 24 | loss: 0.0000044
	speed: 0.0719s/iter; left time: 2272.3533s
	iters: 300, epoch: 24 | loss: 0.0004447
	speed: 0.0784s/iter; left time: 2471.1960s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 2475.9197s
Epoch: 24 cost time: 33.5772967338562
Epoch: 24, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.520 Vali Acc: 0.964 Test Loss: 0.520 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000036
	speed: 0.2559s/iter; left time: 8005.9764s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 1491.4980s
	iters: 300, epoch: 25 | loss: 0.0003964
	speed: 0.0461s/iter; left time: 1434.0311s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 1603.5901s
Epoch: 25 cost time: 21.685412645339966
Epoch: 25, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.336 Vali Acc: 0.976 Test Loss: 0.336 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2305s/iter; left time: 7117.1879s
	iters: 200, epoch: 26 | loss: 0.0000863
	speed: 0.0721s/iter; left time: 2217.5214s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0594s/iter; left time: 1823.2979s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 1749.6362s
Epoch: 26 cost time: 26.775580644607544
Epoch: 26, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.400 Vali Acc: 0.971 Test Loss: 0.400 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000002
	speed: 0.2414s/iter; left time: 7355.2478s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 1857.4182s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 1523.9537s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 1537.4227s
Epoch: 27 cost time: 25.010082006454468
Epoch: 27, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.457 Vali Acc: 0.967 Test Loss: 0.457 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000006
	speed: 0.2199s/iter; left time: 6607.8328s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 1633.4801s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0536s/iter; left time: 1599.8361s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 1504.9205s
Epoch: 28 cost time: 22.556670665740967
Epoch: 28, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.364 Vali Acc: 0.969 Test Loss: 0.364 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2035s/iter; left time: 6031.7626s
	iters: 200, epoch: 29 | loss: 0.0000012
	speed: 0.0520s/iter; left time: 1535.5014s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 1385.0004s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1254.7703s
Epoch: 29 cost time: 20.3862726688385
Epoch: 29, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.373 Vali Acc: 0.971 Test Loss: 0.373 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.977262391996362
model parameter : 171242
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4831519
	speed: 0.1442s/iter; left time: 5940.4391s
	iters: 200, epoch: 1 | loss: 0.1279430
	speed: 0.1047s/iter; left time: 4302.3817s
	iters: 300, epoch: 1 | loss: 0.1719052
	speed: 0.0874s/iter; left time: 3581.4832s
	iters: 400, epoch: 1 | loss: 0.0549616
	speed: 0.0657s/iter; left time: 2685.3045s
Epoch: 1 cost time: 41.276599168777466
Epoch: 1, Steps: 413 | Train Loss: 0.385 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
Validation loss decreased (inf --> -0.949066).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0158512
	speed: 0.2905s/iter; left time: 11847.9495s
	iters: 200, epoch: 2 | loss: 0.0245601
	speed: 0.0832s/iter; left time: 3386.3144s
	iters: 300, epoch: 2 | loss: 0.1258581
	speed: 0.0791s/iter; left time: 3211.6129s
	iters: 400, epoch: 2 | loss: 0.0380090
	speed: 0.0760s/iter; left time: 3077.2497s
Epoch: 2 cost time: 35.312052488327026
Epoch: 2, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
Validation loss decreased (-0.949066 --> -0.959980).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0015783
	speed: 0.2815s/iter; left time: 11364.8537s
	iters: 200, epoch: 3 | loss: 0.0662815
	speed: 0.0819s/iter; left time: 3298.1655s
	iters: 300, epoch: 3 | loss: 0.0529385
	speed: 0.0732s/iter; left time: 2942.0752s
	iters: 400, epoch: 3 | loss: 0.0000382
	speed: 0.0739s/iter; left time: 2962.6472s
Epoch: 3 cost time: 33.433523416519165
Epoch: 3, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
Validation loss decreased (-0.959980 --> -0.963618).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0004422
	speed: 0.2729s/iter; left time: 10907.5355s
	iters: 200, epoch: 4 | loss: 0.0083028
	speed: 0.0546s/iter; left time: 2175.1115s
	iters: 300, epoch: 4 | loss: 0.0000334
	speed: 0.0442s/iter; left time: 1758.2403s
	iters: 400, epoch: 4 | loss: 0.0124645
	speed: 0.0585s/iter; left time: 2318.4473s
Epoch: 4 cost time: 23.595824718475342
Epoch: 4, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.220 Vali Acc: 0.970 Test Loss: 0.220 Test Acc: 0.970
Validation loss decreased (-0.963618 --> -0.969984).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000050
	speed: 0.2690s/iter; left time: 10640.1632s
	iters: 200, epoch: 5 | loss: 0.5310430
	speed: 0.0744s/iter; left time: 2936.7097s
	iters: 300, epoch: 5 | loss: 0.0908713
	speed: 0.0744s/iter; left time: 2926.9925s
	iters: 400, epoch: 5 | loss: 0.0192934
	speed: 0.0653s/iter; left time: 2561.6417s
Epoch: 5 cost time: 29.1732075214386
Epoch: 5, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.185 Vali Acc: 0.961 Test Loss: 0.185 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.7014107
	speed: 0.2428s/iter; left time: 9501.4065s
	iters: 200, epoch: 6 | loss: 0.0008936
	speed: 0.0577s/iter; left time: 2251.0088s
	iters: 300, epoch: 6 | loss: 0.2398618
	speed: 0.0639s/iter; left time: 2487.3132s
	iters: 400, epoch: 6 | loss: 0.0045752
	speed: 0.0550s/iter; left time: 2134.5104s
Epoch: 6 cost time: 24.911881923675537
Epoch: 6, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.257 Vali Acc: 0.963 Test Loss: 0.257 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0001820
	speed: 0.2206s/iter; left time: 8542.6534s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 2418.7853s
	iters: 300, epoch: 7 | loss: 0.0000373
	speed: 0.0623s/iter; left time: 2398.5929s
	iters: 400, epoch: 7 | loss: 0.1254089
	speed: 0.0615s/iter; left time: 2362.8104s
Epoch: 7 cost time: 26.272480726242065
Epoch: 7, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.272 Vali Acc: 0.969 Test Loss: 0.272 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2798197
	speed: 0.2353s/iter; left time: 9014.8303s
	iters: 200, epoch: 8 | loss: 0.0000041
	speed: 0.0500s/iter; left time: 1908.8482s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 1967.2668s
	iters: 400, epoch: 8 | loss: 0.0002446
	speed: 0.0515s/iter; left time: 1956.8660s
Epoch: 8 cost time: 22.11715841293335
Epoch: 8, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.159 Vali Acc: 0.980 Test Loss: 0.159 Test Acc: 0.980
Validation loss decreased (-0.969984 --> -0.979989).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0394200
	speed: 0.2686s/iter; left time: 10178.5275s
	iters: 200, epoch: 9 | loss: 0.0001003
	speed: 0.0883s/iter; left time: 3336.4510s
	iters: 300, epoch: 9 | loss: 0.0000004
	speed: 0.0999s/iter; left time: 3766.6117s
	iters: 400, epoch: 9 | loss: 0.0000004
	speed: 0.0909s/iter; left time: 3418.0575s
Epoch: 9 cost time: 37.92075061798096
Epoch: 9, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.250 Vali Acc: 0.968 Test Loss: 0.250 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.2751s/iter; left time: 10313.2178s
	iters: 200, epoch: 10 | loss: 0.0072840
	speed: 0.0968s/iter; left time: 3617.7078s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0793s/iter; left time: 2955.4183s
	iters: 400, epoch: 10 | loss: 0.0000022
	speed: 0.0677s/iter; left time: 2518.8436s
Epoch: 10 cost time: 34.14907360076904
Epoch: 10, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.242 Vali Acc: 0.968 Test Loss: 0.242 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2316117
	speed: 0.2436s/iter; left time: 9031.9261s
	iters: 200, epoch: 11 | loss: 0.0000405
	speed: 0.0657s/iter; left time: 2428.8139s
	iters: 300, epoch: 11 | loss: 0.1343679
	speed: 0.0901s/iter; left time: 3321.4835s
	iters: 400, epoch: 11 | loss: 0.0230541
	speed: 0.0882s/iter; left time: 3244.9634s
Epoch: 11 cost time: 32.618247747421265
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.268 Vali Acc: 0.970 Test Loss: 0.268 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1334162
	speed: 0.2557s/iter; left time: 9372.5842s
	iters: 200, epoch: 12 | loss: 0.0000063
	speed: 0.0823s/iter; left time: 3009.9249s
	iters: 300, epoch: 12 | loss: 0.1529949
	speed: 0.0752s/iter; left time: 2743.0050s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 1881.1877s
Epoch: 12 cost time: 29.568149089813232
Epoch: 12, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.323 Vali Acc: 0.970 Test Loss: 0.323 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000032
	speed: 0.2294s/iter; left time: 8313.1812s
	iters: 200, epoch: 13 | loss: 0.0024581
	speed: 0.0602s/iter; left time: 2175.0120s
	iters: 300, epoch: 13 | loss: 0.0000292
	speed: 0.0593s/iter; left time: 2135.7676s
	iters: 400, epoch: 13 | loss: 0.1454831
	speed: 0.0692s/iter; left time: 2486.0860s
Epoch: 13 cost time: 26.28807234764099
Epoch: 13, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.246 Vali Acc: 0.974 Test Loss: 0.246 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000965
	speed: 0.2420s/iter; left time: 8670.1406s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0552s/iter; left time: 1972.0486s
	iters: 300, epoch: 14 | loss: 0.0000581
	speed: 0.0665s/iter; left time: 2371.0463s
	iters: 400, epoch: 14 | loss: 0.0000008
	speed: 0.0731s/iter; left time: 2597.4775s
Epoch: 14 cost time: 26.75126361846924
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.232 Vali Acc: 0.974 Test Loss: 0.232 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000026
	speed: 0.2295s/iter; left time: 8129.0690s
	iters: 200, epoch: 15 | loss: 0.0000163
	speed: 0.0524s/iter; left time: 1849.1625s
	iters: 300, epoch: 15 | loss: 0.0025734
	speed: 0.0544s/iter; left time: 1916.4632s
	iters: 400, epoch: 15 | loss: 0.0000806
	speed: 0.0514s/iter; left time: 1805.1051s
Epoch: 15 cost time: 23.08934736251831
Epoch: 15, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.270 Vali Acc: 0.969 Test Loss: 0.270 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000003
	speed: 0.2347s/iter; left time: 8215.7233s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 1877.8580s
	iters: 300, epoch: 16 | loss: 0.0000056
	speed: 0.0598s/iter; left time: 2082.0702s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 2015.9984s
Epoch: 16 cost time: 24.361266136169434
Epoch: 16, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.402 Vali Acc: 0.965 Test Loss: 0.402 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2592s/iter; left time: 8965.6725s
	iters: 200, epoch: 17 | loss: 0.0003535
	speed: 0.0489s/iter; left time: 1687.8187s
	iters: 300, epoch: 17 | loss: 0.0000776
	speed: 0.0522s/iter; left time: 1796.7195s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0434s/iter; left time: 1487.4175s
Epoch: 17 cost time: 21.9170241355896
Epoch: 17, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.239 Vali Acc: 0.977 Test Loss: 0.239 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000003
	speed: 0.2584s/iter; left time: 8832.0385s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0631s/iter; left time: 2150.3376s
	iters: 300, epoch: 18 | loss: 0.0378664
	speed: 0.0599s/iter; left time: 2034.1681s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0781s/iter; left time: 2644.4082s
Epoch: 18 cost time: 29.64665150642395
Epoch: 18, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.378 Vali Acc: 0.971 Test Loss: 0.378 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 138026
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3568674
	speed: 0.0828s/iter; left time: 3412.1496s
	iters: 200, epoch: 1 | loss: 0.0775917
	speed: 0.0500s/iter; left time: 2056.0091s
	iters: 300, epoch: 1 | loss: 0.0504557
	speed: 0.0497s/iter; left time: 2035.9881s
	iters: 400, epoch: 1 | loss: 0.0064540
	speed: 0.0554s/iter; left time: 2264.3530s
Epoch: 1 cost time: 24.80623197555542
Epoch: 1, Steps: 413 | Train Loss: 0.419 Vali Loss: 0.111 Vali Acc: 0.961 Test Loss: 0.111 Test Acc: 0.961
Validation loss decreased (inf --> -0.961345).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0047457
	speed: 0.2213s/iter; left time: 9027.5920s
	iters: 200, epoch: 2 | loss: 0.0106503
	speed: 0.0506s/iter; left time: 2059.8255s
	iters: 300, epoch: 2 | loss: 0.0474739
	speed: 0.0562s/iter; left time: 2282.3405s
	iters: 400, epoch: 2 | loss: 0.0286378
	speed: 0.0501s/iter; left time: 2027.8751s
Epoch: 2 cost time: 21.78364634513855
Epoch: 2, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
Validation loss decreased (-0.961345 --> -0.962709).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0311648
	speed: 0.2183s/iter; left time: 8814.9212s
	iters: 200, epoch: 3 | loss: 0.0003156
	speed: 0.0478s/iter; left time: 1925.4296s
	iters: 300, epoch: 3 | loss: 0.0097245
	speed: 0.0453s/iter; left time: 1821.6511s
	iters: 400, epoch: 3 | loss: 0.0651187
	speed: 0.0458s/iter; left time: 1836.0109s
Epoch: 3 cost time: 20.25198268890381
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
Validation loss decreased (-0.962709 --> -0.964528).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0081007
	speed: 0.1994s/iter; left time: 7969.7779s
	iters: 200, epoch: 4 | loss: 0.0000230
	speed: 0.0443s/iter; left time: 1767.0360s
	iters: 300, epoch: 4 | loss: 0.0003887
	speed: 0.0483s/iter; left time: 1919.9010s
	iters: 400, epoch: 4 | loss: 0.0860648
	speed: 0.0458s/iter; left time: 1816.1625s
Epoch: 4 cost time: 19.65239644050598
Epoch: 4, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.194 Vali Acc: 0.963 Test Loss: 0.194 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0031520
	speed: 0.2008s/iter; left time: 7939.5758s
	iters: 200, epoch: 5 | loss: 0.0034572
	speed: 0.0386s/iter; left time: 1524.3729s
	iters: 300, epoch: 5 | loss: 0.0000534
	speed: 0.0478s/iter; left time: 1880.1658s
	iters: 400, epoch: 5 | loss: 0.0595682
	speed: 0.0519s/iter; left time: 2036.3008s
Epoch: 5 cost time: 19.707143306732178
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.206 Vali Acc: 0.972 Test Loss: 0.206 Test Acc: 0.972
Validation loss decreased (-0.964528 --> -0.972258).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0158221
	speed: 0.2146s/iter; left time: 8400.4978s
	iters: 200, epoch: 6 | loss: 0.0239585
	speed: 0.0472s/iter; left time: 1840.9971s
	iters: 300, epoch: 6 | loss: 0.0001852
	speed: 0.0400s/iter; left time: 1557.4605s
	iters: 400, epoch: 6 | loss: 0.0487227
	speed: 0.0416s/iter; left time: 1616.8905s
Epoch: 6 cost time: 19.053410530090332
Epoch: 6, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.213 Vali Acc: 0.955 Test Loss: 0.213 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000480
	speed: 0.2093s/iter; left time: 8103.4472s
	iters: 200, epoch: 7 | loss: 0.0000003
	speed: 0.0506s/iter; left time: 1955.2602s
	iters: 300, epoch: 7 | loss: 0.0058173
	speed: 0.0456s/iter; left time: 1757.8093s
	iters: 400, epoch: 7 | loss: 0.0000002
	speed: 0.0464s/iter; left time: 1782.1879s
Epoch: 7 cost time: 21.713229417800903
Epoch: 7, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
Validation loss decreased (-0.972258 --> -0.972259).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0002811
	speed: 0.2120s/iter; left time: 8121.1228s
	iters: 200, epoch: 8 | loss: 0.0048330
	speed: 0.0480s/iter; left time: 1833.3802s
	iters: 300, epoch: 8 | loss: 0.2936411
	speed: 0.0413s/iter; left time: 1575.5559s
	iters: 400, epoch: 8 | loss: 0.0000099
	speed: 0.0410s/iter; left time: 1556.5983s
Epoch: 8 cost time: 19.098715782165527
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.175 Vali Acc: 0.974 Test Loss: 0.175 Test Acc: 0.974
Validation loss decreased (-0.972259 --> -0.974077).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0552109
	speed: 0.1983s/iter; left time: 7513.7018s
	iters: 200, epoch: 9 | loss: 0.0000008
	speed: 0.0403s/iter; left time: 1521.6696s
	iters: 300, epoch: 9 | loss: 0.0011121
	speed: 0.0447s/iter; left time: 1684.1897s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 1650.7450s
Epoch: 9 cost time: 18.439565181732178
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
Validation loss decreased (-0.974077 --> -0.976351).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1912s/iter; left time: 7167.6285s
	iters: 200, epoch: 10 | loss: 0.0004559
	speed: 0.0466s/iter; left time: 1740.4043s
	iters: 300, epoch: 10 | loss: 0.0056508
	speed: 0.0421s/iter; left time: 1570.3065s
	iters: 400, epoch: 10 | loss: 0.0115065
	speed: 0.0441s/iter; left time: 1639.4880s
Epoch: 10 cost time: 18.938758850097656
Epoch: 10, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.269 Vali Acc: 0.969 Test Loss: 0.269 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0005797
	speed: 0.2066s/iter; left time: 7659.4717s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 1807.1676s
	iters: 300, epoch: 11 | loss: 0.0192247
	speed: 0.0535s/iter; left time: 1973.3306s
	iters: 400, epoch: 11 | loss: 0.0000171
	speed: 0.0557s/iter; left time: 2047.5239s
Epoch: 11 cost time: 22.743208169937134
Epoch: 11, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.281 Vali Acc: 0.964 Test Loss: 0.281 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000174
	speed: 0.2035s/iter; left time: 7460.0007s
	iters: 200, epoch: 12 | loss: 0.0017116
	speed: 0.0510s/iter; left time: 1864.0071s
	iters: 300, epoch: 12 | loss: 0.0000302
	speed: 0.0529s/iter; left time: 1929.2020s
	iters: 400, epoch: 12 | loss: 0.1038604
	speed: 0.0525s/iter; left time: 1907.3082s
Epoch: 12 cost time: 21.91383147239685
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.366 Vali Acc: 0.968 Test Loss: 0.366 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.2328s/iter; left time: 8439.1049s
	iters: 200, epoch: 13 | loss: 0.0007705
	speed: 0.0492s/iter; left time: 1779.6579s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0547s/iter; left time: 1971.6410s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 1649.9238s
Epoch: 13 cost time: 22.105313062667847
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.216 Vali Acc: 0.972 Test Loss: 0.216 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2318s/iter; left time: 8304.4568s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 2017.3037s
	iters: 300, epoch: 14 | loss: 0.0275935
	speed: 0.0529s/iter; left time: 1883.7106s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0506s/iter; left time: 1797.4962s
Epoch: 14 cost time: 23.468679666519165
Epoch: 14, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.218 Vali Acc: 0.971 Test Loss: 0.218 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000005
	speed: 0.2157s/iter; left time: 7638.7651s
	iters: 200, epoch: 15 | loss: 0.0000537
	speed: 0.0561s/iter; left time: 1980.8300s
	iters: 300, epoch: 15 | loss: 0.0000034
	speed: 0.0540s/iter; left time: 1900.7276s
	iters: 400, epoch: 15 | loss: 0.0000002
	speed: 0.0584s/iter; left time: 2049.4556s
Epoch: 15 cost time: 23.451266050338745
Epoch: 15, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.191 Vali Acc: 0.973 Test Loss: 0.191 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000031
	speed: 0.2200s/iter; left time: 7702.6645s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 1805.2035s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0445s/iter; left time: 1548.6376s
	iters: 400, epoch: 16 | loss: 0.2901121
	speed: 0.0536s/iter; left time: 1861.5067s
Epoch: 16 cost time: 21.689490795135498
Epoch: 16, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.223 Vali Acc: 0.976 Test Loss: 0.223 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2048s/iter; left time: 7086.0216s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0408s/iter; left time: 1407.1330s
	iters: 300, epoch: 17 | loss: 0.5991715
	speed: 0.0447s/iter; left time: 1537.2667s
	iters: 400, epoch: 17 | loss: 0.6682469
	speed: 0.0446s/iter; left time: 1528.5592s
Epoch: 17 cost time: 18.776609420776367
Epoch: 17, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.273 Vali Acc: 0.973 Test Loss: 0.273 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000009
	speed: 0.2126s/iter; left time: 7268.0531s
	iters: 200, epoch: 18 | loss: 0.0000600
	speed: 0.0559s/iter; left time: 1903.6308s
	iters: 300, epoch: 18 | loss: 0.0000013
	speed: 0.0585s/iter; left time: 1987.6334s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 1508.0960s
Epoch: 18 cost time: 21.613598346710205
Epoch: 18, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.186 Vali Acc: 0.977 Test Loss: 0.186 Test Acc: 0.977
Validation loss decreased (-0.976351 --> -0.977261).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2074s/iter; left time: 7002.1807s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0513s/iter; left time: 1728.0103s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0519s/iter; left time: 1742.1738s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 1763.7410s
Epoch: 19 cost time: 22.00537943840027
Epoch: 19, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.359 Vali Acc: 0.970 Test Loss: 0.359 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0001099
	speed: 0.1989s/iter; left time: 6635.1416s
	iters: 200, epoch: 20 | loss: 0.0013299
	speed: 0.0422s/iter; left time: 1402.6251s
	iters: 300, epoch: 20 | loss: 0.0000202
	speed: 0.0477s/iter; left time: 1580.9755s
	iters: 400, epoch: 20 | loss: 0.0000160
	speed: 0.0490s/iter; left time: 1619.2964s
Epoch: 20 cost time: 19.44207453727722
Epoch: 20, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2220s/iter; left time: 7314.3821s
	iters: 200, epoch: 21 | loss: 0.0000053
	speed: 0.0434s/iter; left time: 1424.0215s
	iters: 300, epoch: 21 | loss: 0.0013762
	speed: 0.0426s/iter; left time: 1395.1742s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 1353.1805s
Epoch: 21 cost time: 19.2967050075531
Epoch: 21, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.348 Vali Acc: 0.969 Test Loss: 0.348 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2226s/iter; left time: 7240.9887s
	iters: 200, epoch: 22 | loss: 0.0026990
	speed: 0.0600s/iter; left time: 1947.2674s
	iters: 300, epoch: 22 | loss: 0.0002201
	speed: 0.0627s/iter; left time: 2025.3818s
	iters: 400, epoch: 22 | loss: 0.0000002
	speed: 0.0567s/iter; left time: 1827.2174s
Epoch: 22 cost time: 25.69387984275818
Epoch: 22, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.240 Vali Acc: 0.978 Test Loss: 0.240 Test Acc: 0.978
Validation loss decreased (-0.977261 --> -0.977715).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2312s/iter; left time: 7423.3966s
	iters: 200, epoch: 23 | loss: 0.5443150
	speed: 0.0501s/iter; left time: 1603.4055s
	iters: 300, epoch: 23 | loss: 0.0619717
	speed: 0.0479s/iter; left time: 1528.7564s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 1744.6938s
Epoch: 23 cost time: 21.548441886901855
Epoch: 23, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.217 Vali Acc: 0.980 Test Loss: 0.217 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979989).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2177s/iter; left time: 6901.1364s
	iters: 200, epoch: 24 | loss: 0.0000003
	speed: 0.0550s/iter; left time: 1736.5484s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 1648.2016s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0562s/iter; left time: 1764.9707s
Epoch: 24 cost time: 22.686289310455322
Epoch: 24, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.208 Vali Acc: 0.980 Test Loss: 0.208 Test Acc: 0.980
Validation loss decreased (-0.979989 --> -0.979989).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2424s/iter; left time: 7585.5990s
	iters: 200, epoch: 25 | loss: 0.2772678
	speed: 0.0570s/iter; left time: 1777.6957s
	iters: 300, epoch: 25 | loss: 0.0000151
	speed: 0.0572s/iter; left time: 1777.8977s
	iters: 400, epoch: 25 | loss: 0.0009808
	speed: 0.0569s/iter; left time: 1761.9544s
Epoch: 25 cost time: 24.930013179779053
Epoch: 25, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.285 Vali Acc: 0.976 Test Loss: 0.285 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2254s/iter; left time: 6960.5570s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 1695.6788s
	iters: 300, epoch: 26 | loss: 0.0074045
	speed: 0.0583s/iter; left time: 1789.5629s
	iters: 400, epoch: 26 | loss: 0.0000032
	speed: 0.0487s/iter; left time: 1489.9236s
Epoch: 26 cost time: 23.17926335334778
Epoch: 26, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.324 Vali Acc: 0.977 Test Loss: 0.324 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000001
	speed: 0.2220s/iter; left time: 6761.4076s
	iters: 200, epoch: 27 | loss: 0.0000041
	speed: 0.0506s/iter; left time: 1537.1733s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0540s/iter; left time: 1635.0795s
	iters: 400, epoch: 27 | loss: 0.0388834
	speed: 0.0540s/iter; left time: 1629.9140s
Epoch: 27 cost time: 22.57374882698059
Epoch: 27, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2400s/iter; left time: 7211.8962s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 1382.7338s
	iters: 300, epoch: 28 | loss: 0.1105959
	speed: 0.0501s/iter; left time: 1494.1591s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 1337.8346s
Epoch: 28 cost time: 20.68036150932312
Epoch: 28, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.371 Vali Acc: 0.973 Test Loss: 0.371 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2204s/iter; left time: 6530.8606s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 1379.7168s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 1353.3934s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 1374.4427s
Epoch: 29 cost time: 20.294244050979614
Epoch: 29, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.980 Test Loss: 0.221 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2113s/iter; left time: 6173.9028s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 1268.1216s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 1529.1512s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0466s/iter; left time: 1346.4648s
Epoch: 30 cost time: 20.687592029571533
Epoch: 30, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.335 Vali Acc: 0.974 Test Loss: 0.335 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2255s/iter; left time: 6496.2676s
	iters: 200, epoch: 31 | loss: 0.0000413
	speed: 0.0493s/iter; left time: 1416.1012s
	iters: 300, epoch: 31 | loss: 0.0218336
	speed: 0.0552s/iter; left time: 1579.7277s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1293.0959s
Epoch: 31 cost time: 22.03038454055786
Epoch: 31, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.541 Vali Acc: 0.965 Test Loss: 0.541 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0006898
	speed: 0.2126s/iter; left time: 6036.8281s
	iters: 200, epoch: 32 | loss: 0.0000004
	speed: 0.0522s/iter; left time: 1476.5597s
	iters: 300, epoch: 32 | loss: 0.3139592
	speed: 0.0496s/iter; left time: 1397.4031s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1378.1138s
Epoch: 32 cost time: 21.36020064353943
Epoch: 32, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.354 Vali Acc: 0.976 Test Loss: 0.354 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0059376
	speed: 0.2270s/iter; left time: 6353.6175s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0618s/iter; left time: 1724.0031s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 1552.5808s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0590s/iter; left time: 1633.4131s
Epoch: 33 cost time: 24.124874591827393
Epoch: 33, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.322 Vali Acc: 0.973 Test Loss: 0.322 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0022704
	speed: 0.2415s/iter; left time: 6659.1444s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 1690.7994s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 1616.4547s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 1494.7550s
Epoch: 34 cost time: 24.64466643333435
Epoch: 34, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.308 Vali Acc: 0.977 Test Loss: 0.308 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 117322
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4374376
	speed: 0.0807s/iter; left time: 3323.8006s
	iters: 200, epoch: 1 | loss: 0.3166265
	speed: 0.0553s/iter; left time: 2273.3125s
	iters: 300, epoch: 1 | loss: 0.0582971
	speed: 0.0590s/iter; left time: 2418.1504s
	iters: 400, epoch: 1 | loss: 0.0466014
	speed: 0.0591s/iter; left time: 2417.0018s
Epoch: 1 cost time: 26.22193479537964
Epoch: 1, Steps: 413 | Train Loss: 0.446 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
Validation loss decreased (inf --> -0.942699).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0558904
	speed: 0.2361s/iter; left time: 9628.2591s
	iters: 200, epoch: 2 | loss: 0.2238507
	speed: 0.0605s/iter; left time: 2463.0614s
	iters: 300, epoch: 2 | loss: 0.0636110
	speed: 0.0535s/iter; left time: 2171.7250s
	iters: 400, epoch: 2 | loss: 0.1115817
	speed: 0.0523s/iter; left time: 2116.8501s
Epoch: 2 cost time: 24.195918083190918
Epoch: 2, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
Validation loss decreased (-0.942699 --> -0.967712).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0857401
	speed: 0.2367s/iter; left time: 9556.3582s
	iters: 200, epoch: 3 | loss: 0.0072561
	speed: 0.0568s/iter; left time: 2289.0234s
	iters: 300, epoch: 3 | loss: 0.0019793
	speed: 0.0577s/iter; left time: 2319.9939s
	iters: 400, epoch: 3 | loss: 0.0649728
	speed: 0.0615s/iter; left time: 2464.3545s
Epoch: 3 cost time: 24.947322845458984
Epoch: 3, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1055263
	speed: 0.2138s/iter; left time: 8543.7056s
	iters: 200, epoch: 4 | loss: 0.0016883
	speed: 0.0467s/iter; left time: 1860.4974s
	iters: 300, epoch: 4 | loss: 0.0117657
	speed: 0.0516s/iter; left time: 2053.4828s
	iters: 400, epoch: 4 | loss: 0.0380745
	speed: 0.0542s/iter; left time: 2149.9204s
Epoch: 4 cost time: 21.842857599258423
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0596565
	speed: 0.2152s/iter; left time: 8510.8436s
	iters: 200, epoch: 5 | loss: 0.0363098
	speed: 0.0468s/iter; left time: 1845.5897s
	iters: 300, epoch: 5 | loss: 0.0066393
	speed: 0.0477s/iter; left time: 1877.9721s
	iters: 400, epoch: 5 | loss: 0.0009237
	speed: 0.0495s/iter; left time: 1944.3469s
Epoch: 5 cost time: 20.682565689086914
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
Validation loss decreased (-0.967712 --> -0.971349).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0012438
	speed: 0.2011s/iter; left time: 7871.0104s
	iters: 200, epoch: 6 | loss: 0.1172875
	speed: 0.0431s/iter; left time: 1681.2002s
	iters: 300, epoch: 6 | loss: 0.0108261
	speed: 0.0500s/iter; left time: 1946.3007s
	iters: 400, epoch: 6 | loss: 0.0000087
	speed: 0.0470s/iter; left time: 1824.0254s
Epoch: 6 cost time: 20.031861066818237
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0172787
	speed: 0.2216s/iter; left time: 8581.6660s
	iters: 200, epoch: 7 | loss: 0.0063543
	speed: 0.0497s/iter; left time: 1918.4522s
	iters: 300, epoch: 7 | loss: 0.0000074
	speed: 0.0489s/iter; left time: 1884.0762s
	iters: 400, epoch: 7 | loss: 0.4645065
	speed: 0.0518s/iter; left time: 1989.2920s
Epoch: 7 cost time: 21.50409173965454
Epoch: 7, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0053838
	speed: 0.2227s/iter; left time: 8533.1409s
	iters: 200, epoch: 8 | loss: 0.0005192
	speed: 0.0449s/iter; left time: 1716.3580s
	iters: 300, epoch: 8 | loss: 0.0023234
	speed: 0.0487s/iter; left time: 1854.2408s
	iters: 400, epoch: 8 | loss: 0.0000009
	speed: 0.0456s/iter; left time: 1732.4254s
Epoch: 8 cost time: 20.745274305343628
Epoch: 8, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.971349 --> -0.977261).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000071
	speed: 0.2115s/iter; left time: 8013.4222s
	iters: 200, epoch: 9 | loss: 0.0731951
	speed: 0.0486s/iter; left time: 1838.7363s
	iters: 300, epoch: 9 | loss: 0.0000019
	speed: 0.0485s/iter; left time: 1829.1551s
	iters: 400, epoch: 9 | loss: 0.0025594
	speed: 0.0494s/iter; left time: 1858.2169s
Epoch: 9 cost time: 20.861478090286255
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0108620
	speed: 0.2057s/iter; left time: 7711.0212s
	iters: 200, epoch: 10 | loss: 0.0007051
	speed: 0.0493s/iter; left time: 1842.1556s
	iters: 300, epoch: 10 | loss: 0.0000012
	speed: 0.0567s/iter; left time: 2115.2994s
	iters: 400, epoch: 10 | loss: 0.3809544
	speed: 0.0567s/iter; left time: 2108.2400s
Epoch: 10 cost time: 22.599323987960815
Epoch: 10, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.195 Vali Acc: 0.965 Test Loss: 0.195 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000040
	speed: 0.2071s/iter; left time: 7677.8804s
	iters: 200, epoch: 11 | loss: 0.0001294
	speed: 0.0474s/iter; left time: 1751.8039s
	iters: 300, epoch: 11 | loss: 0.0162283
	speed: 0.0492s/iter; left time: 1814.3897s
	iters: 400, epoch: 11 | loss: 0.0000004
	speed: 0.0551s/iter; left time: 2026.0491s
Epoch: 11 cost time: 21.324109077453613
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.270 Vali Acc: 0.958 Test Loss: 0.270 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2169s/iter; left time: 7950.3086s
	iters: 200, epoch: 12 | loss: 0.0001760
	speed: 0.0502s/iter; left time: 1835.9407s
	iters: 300, epoch: 12 | loss: 0.0000083
	speed: 0.0479s/iter; left time: 1747.7628s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0455s/iter; left time: 1655.8099s
Epoch: 12 cost time: 21.738078594207764
Epoch: 12, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0001141
	speed: 0.2356s/iter; left time: 8538.8671s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 1759.7083s
	iters: 300, epoch: 13 | loss: 0.0000064
	speed: 0.0500s/iter; left time: 1801.0339s
	iters: 400, epoch: 13 | loss: 0.0003848
	speed: 0.0469s/iter; left time: 1684.0391s
Epoch: 13 cost time: 21.54436993598938
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.166 Vali Acc: 0.978 Test Loss: 0.166 Test Acc: 0.978
Validation loss decreased (-0.977261 --> -0.977715).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.2152s/iter; left time: 7711.8542s
	iters: 200, epoch: 14 | loss: 0.3081946
	speed: 0.0620s/iter; left time: 2216.1514s
	iters: 300, epoch: 14 | loss: 0.0000002
	speed: 0.0566s/iter; left time: 2017.7521s
	iters: 400, epoch: 14 | loss: 0.0001094
	speed: 0.0549s/iter; left time: 1948.9656s
Epoch: 14 cost time: 24.494252681732178
Epoch: 14, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2260s/iter; left time: 8004.2093s
	iters: 200, epoch: 15 | loss: 0.0000003
	speed: 0.0489s/iter; left time: 1727.7182s
	iters: 300, epoch: 15 | loss: 0.0829450
	speed: 0.0462s/iter; left time: 1626.6605s
	iters: 400, epoch: 15 | loss: 0.0000254
	speed: 0.0451s/iter; left time: 1582.9705s
Epoch: 15 cost time: 21.088780164718628
Epoch: 15, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000104
	speed: 0.1956s/iter; left time: 6848.6434s
	iters: 200, epoch: 16 | loss: 0.0031431
	speed: 0.0420s/iter; left time: 1467.6605s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 1558.8858s
	iters: 400, epoch: 16 | loss: 0.0000606
	speed: 0.0508s/iter; left time: 1762.5076s
Epoch: 16 cost time: 19.260512113571167
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2134s/iter; left time: 7380.6377s
	iters: 200, epoch: 17 | loss: 0.0003536
	speed: 0.0413s/iter; left time: 1425.6104s
	iters: 300, epoch: 17 | loss: 0.0000469
	speed: 0.0441s/iter; left time: 1516.5763s
	iters: 400, epoch: 17 | loss: 0.0497475
	speed: 0.0425s/iter; left time: 1457.5914s
Epoch: 17 cost time: 18.434005737304688
Epoch: 17, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.198 Vali Acc: 0.968 Test Loss: 0.198 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000002
	speed: 0.1929s/iter; left time: 6593.9114s
	iters: 200, epoch: 18 | loss: 0.0000038
	speed: 0.0437s/iter; left time: 1490.0062s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0446s/iter; left time: 1515.4148s
	iters: 400, epoch: 18 | loss: 0.0537557
	speed: 0.0432s/iter; left time: 1462.7159s
Epoch: 18 cost time: 19.438109874725342
Epoch: 18, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0668582
	speed: 0.1916s/iter; left time: 6470.4828s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 1462.9450s
	iters: 300, epoch: 19 | loss: 0.0000194
	speed: 0.0489s/iter; left time: 1639.7834s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1552.9213s
Epoch: 19 cost time: 19.577669382095337
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.214 Vali Acc: 0.970 Test Loss: 0.214 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0036566
	speed: 0.2029s/iter; left time: 6766.1330s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0466s/iter; left time: 1551.1396s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0416s/iter; left time: 1378.4537s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.0378s/iter; left time: 1249.7360s
Epoch: 20 cost time: 18.81101369857788
Epoch: 20, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.251 Vali Acc: 0.970 Test Loss: 0.251 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000215
	speed: 0.1928s/iter; left time: 6351.5010s
	iters: 200, epoch: 21 | loss: 0.0000058
	speed: 0.0405s/iter; left time: 1330.8276s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.0437s/iter; left time: 1430.8547s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 1499.1179s
Epoch: 21 cost time: 18.30367946624756
Epoch: 21, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000211
	speed: 0.1975s/iter; left time: 6424.0222s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 1425.0617s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 1257.1463s
	iters: 400, epoch: 22 | loss: 0.0000001
	speed: 0.0434s/iter; left time: 1397.6674s
Epoch: 22 cost time: 18.539591550827026
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2063s/iter; left time: 6624.7347s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 1797.3733s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0555s/iter; left time: 1770.6308s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 1669.8630s
Epoch: 23 cost time: 22.729335069656372
Epoch: 23, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.348 Vali Acc: 0.965 Test Loss: 0.348 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 96650
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3732502
	speed: 0.0948s/iter; left time: 3907.6030s
	iters: 200, epoch: 1 | loss: 0.2919992
	speed: 0.0565s/iter; left time: 2320.2742s
	iters: 300, epoch: 1 | loss: 0.2639363
	speed: 0.0647s/iter; left time: 2650.7450s
	iters: 400, epoch: 1 | loss: 0.0077116
	speed: 0.0629s/iter; left time: 2573.5704s
Epoch: 1 cost time: 28.783197164535522
Epoch: 1, Steps: 413 | Train Loss: 0.485 Vali Loss: 0.103 Vali Acc: 0.963 Test Loss: 0.103 Test Acc: 0.963
Validation loss decreased (inf --> -0.962709).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0092471
	speed: 0.2542s/iter; left time: 10369.6187s
	iters: 200, epoch: 2 | loss: 0.0751874
	speed: 0.0556s/iter; left time: 2261.6213s
	iters: 300, epoch: 2 | loss: 0.1142541
	speed: 0.0559s/iter; left time: 2270.3353s
	iters: 400, epoch: 2 | loss: 0.0131238
	speed: 0.0662s/iter; left time: 2681.1217s
Epoch: 2 cost time: 24.74344825744629
Epoch: 2, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.071 Vali Acc: 0.971 Test Loss: 0.071 Test Acc: 0.971
Validation loss decreased (-0.962709 --> -0.970895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0536806
	speed: 0.2615s/iter; left time: 10558.0078s
	iters: 200, epoch: 3 | loss: 0.0328968
	speed: 0.0546s/iter; left time: 2197.5629s
	iters: 300, epoch: 3 | loss: 0.0134363
	speed: 0.0550s/iter; left time: 2209.3381s
	iters: 400, epoch: 3 | loss: 0.0358119
	speed: 0.0588s/iter; left time: 2356.2081s
Epoch: 3 cost time: 24.153021335601807
Epoch: 3, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.057 Vali Acc: 0.980 Test Loss: 0.057 Test Acc: 0.980
Validation loss decreased (-0.970895 --> -0.979536).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0013759
	speed: 0.2603s/iter; left time: 10403.2528s
	iters: 200, epoch: 4 | loss: 0.2424463
	speed: 0.0548s/iter; left time: 2182.4658s
	iters: 300, epoch: 4 | loss: 0.0000994
	speed: 0.0527s/iter; left time: 2095.2398s
	iters: 400, epoch: 4 | loss: 0.0324302
	speed: 0.0476s/iter; left time: 1889.3242s
Epoch: 4 cost time: 23.052432775497437
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0082110
	speed: 0.2533s/iter; left time: 10019.2174s
	iters: 200, epoch: 5 | loss: 0.0005100
	speed: 0.0502s/iter; left time: 1979.0968s
	iters: 300, epoch: 5 | loss: 0.0018546
	speed: 0.0557s/iter; left time: 2190.6068s
	iters: 400, epoch: 5 | loss: 0.0109614
	speed: 0.0520s/iter; left time: 2042.5598s
Epoch: 5 cost time: 24.019887447357178
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0001243
	speed: 0.2321s/iter; left time: 9082.5886s
	iters: 200, epoch: 6 | loss: 0.0001279
	speed: 0.0510s/iter; left time: 1990.5788s
	iters: 300, epoch: 6 | loss: 0.0000313
	speed: 0.0552s/iter; left time: 2148.9139s
	iters: 400, epoch: 6 | loss: 0.0010270
	speed: 0.0560s/iter; left time: 2173.4212s
Epoch: 6 cost time: 22.39087462425232
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1226697
	speed: 0.2667s/iter; left time: 10327.6741s
	iters: 200, epoch: 7 | loss: 0.0608405
	speed: 0.0464s/iter; left time: 1793.9918s
	iters: 300, epoch: 7 | loss: 0.0000019
	speed: 0.0585s/iter; left time: 2252.6700s
	iters: 400, epoch: 7 | loss: 0.0017078
	speed: 0.0595s/iter; left time: 2286.1781s
Epoch: 7 cost time: 23.69782543182373
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0002029
	speed: 0.2601s/iter; left time: 9965.4519s
	iters: 200, epoch: 8 | loss: 0.0029714
	speed: 0.0547s/iter; left time: 2089.6183s
	iters: 300, epoch: 8 | loss: 0.0275509
	speed: 0.0534s/iter; left time: 2034.9534s
	iters: 400, epoch: 8 | loss: 0.0010537
	speed: 0.0609s/iter; left time: 2314.8758s
Epoch: 8 cost time: 23.907984018325806
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0038564
	speed: 0.2694s/iter; left time: 10210.2198s
	iters: 200, epoch: 9 | loss: 0.0004894
	speed: 0.0567s/iter; left time: 2142.1728s
	iters: 300, epoch: 9 | loss: 0.0685016
	speed: 0.0528s/iter; left time: 1988.6554s
	iters: 400, epoch: 9 | loss: 0.0915101
	speed: 0.0577s/iter; left time: 2167.9022s
Epoch: 9 cost time: 24.145314931869507
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0041451
	speed: 0.2709s/iter; left time: 10154.4892s
	iters: 200, epoch: 10 | loss: 0.1330564
	speed: 0.0532s/iter; left time: 1988.8653s
	iters: 300, epoch: 10 | loss: 0.0000316
	speed: 0.0511s/iter; left time: 1903.4847s
	iters: 400, epoch: 10 | loss: 0.0169163
	speed: 0.0534s/iter; left time: 1984.2401s
Epoch: 10 cost time: 23.302306175231934
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0002282
	speed: 0.2533s/iter; left time: 9390.3606s
	iters: 200, epoch: 11 | loss: 0.0000011
	speed: 0.0462s/iter; left time: 1709.3471s
	iters: 300, epoch: 11 | loss: 0.0001678
	speed: 0.0494s/iter; left time: 1819.8743s
	iters: 400, epoch: 11 | loss: 0.1127266
	speed: 0.0482s/iter; left time: 1773.2923s
Epoch: 11 cost time: 22.05331301689148
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000145
	speed: 0.2534s/iter; left time: 9289.9010s
	iters: 200, epoch: 12 | loss: 0.0000954
	speed: 0.0516s/iter; left time: 1887.2666s
	iters: 300, epoch: 12 | loss: 0.0077023
	speed: 0.0511s/iter; left time: 1861.3738s
	iters: 400, epoch: 12 | loss: 0.0000006
	speed: 0.0582s/iter; left time: 2115.0571s
Epoch: 12 cost time: 23.581079244613647
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000054
	speed: 0.2608s/iter; left time: 9451.9773s
	iters: 200, epoch: 13 | loss: 0.0000002
	speed: 0.0542s/iter; left time: 1957.9568s
	iters: 300, epoch: 13 | loss: 0.0016632
	speed: 0.0605s/iter; left time: 2181.3630s
	iters: 400, epoch: 13 | loss: 0.0000003
	speed: 0.0541s/iter; left time: 1946.3978s
Epoch: 13 cost time: 24.551034927368164
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.193 Vali Acc: 0.968 Test Loss: 0.193 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 80170
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7944252
	speed: 0.0822s/iter; left time: 3384.7815s
	iters: 200, epoch: 1 | loss: 0.3179186
	speed: 0.0392s/iter; left time: 1609.1961s
	iters: 300, epoch: 1 | loss: 0.5925768
	speed: 0.0452s/iter; left time: 1854.9967s
	iters: 400, epoch: 1 | loss: 0.0739023
	speed: 0.0426s/iter; left time: 1741.8144s
Epoch: 1 cost time: 21.686569690704346
Epoch: 1, Steps: 413 | Train Loss: 0.555 Vali Loss: 0.129 Vali Acc: 0.955 Test Loss: 0.129 Test Acc: 0.955
Validation loss decreased (inf --> -0.954523).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0266923
	speed: 0.2102s/iter; left time: 8574.3117s
	iters: 200, epoch: 2 | loss: 0.0157074
	speed: 0.0479s/iter; left time: 1949.2815s
	iters: 300, epoch: 2 | loss: 0.0621210
	speed: 0.0443s/iter; left time: 1797.2299s
	iters: 400, epoch: 2 | loss: 0.0243055
	speed: 0.0417s/iter; left time: 1690.1427s
Epoch: 2 cost time: 19.91623592376709
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.086 Vali Acc: 0.969 Test Loss: 0.086 Test Acc: 0.969
Validation loss decreased (-0.954523 --> -0.969076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0473948
	speed: 0.2124s/iter; left time: 8576.9450s
	iters: 200, epoch: 3 | loss: 0.0267380
	speed: 0.0581s/iter; left time: 2338.4557s
	iters: 300, epoch: 3 | loss: 0.0012227
	speed: 0.0582s/iter; left time: 2338.5684s
	iters: 400, epoch: 3 | loss: 0.2388663
	speed: 0.0578s/iter; left time: 2318.0459s
Epoch: 3 cost time: 24.275370597839355
Epoch: 3, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.969076 --> -0.979990).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0155348
	speed: 0.2207s/iter; left time: 8818.1449s
	iters: 200, epoch: 4 | loss: 0.0022388
	speed: 0.0456s/iter; left time: 1818.8400s
	iters: 300, epoch: 4 | loss: 0.0323087
	speed: 0.0484s/iter; left time: 1922.6667s
	iters: 400, epoch: 4 | loss: 0.2745275
	speed: 0.0478s/iter; left time: 1895.7309s
Epoch: 4 cost time: 20.639986515045166
Epoch: 4, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1170868
	speed: 0.1971s/iter; left time: 7796.4568s
	iters: 200, epoch: 5 | loss: 0.0004107
	speed: 0.0391s/iter; left time: 1544.0043s
	iters: 300, epoch: 5 | loss: 0.0045691
	speed: 0.0445s/iter; left time: 1750.8066s
	iters: 400, epoch: 5 | loss: 0.0394935
	speed: 0.0441s/iter; left time: 1731.7687s
Epoch: 5 cost time: 18.600330591201782
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0238094
	speed: 0.2016s/iter; left time: 7890.0312s
	iters: 200, epoch: 6 | loss: 0.0080051
	speed: 0.0417s/iter; left time: 1627.2283s
	iters: 300, epoch: 6 | loss: 0.0008384
	speed: 0.0403s/iter; left time: 1570.3257s
	iters: 400, epoch: 6 | loss: 0.0064465
	speed: 0.0459s/iter; left time: 1784.0035s
Epoch: 6 cost time: 18.970664501190186
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0043820
	speed: 0.2171s/iter; left time: 8405.5832s
	iters: 200, epoch: 7 | loss: 0.0026759
	speed: 0.0486s/iter; left time: 1876.1949s
	iters: 300, epoch: 7 | loss: 0.0006911
	speed: 0.0464s/iter; left time: 1789.0420s
	iters: 400, epoch: 7 | loss: 0.0042806
	speed: 0.0419s/iter; left time: 1608.5640s
Epoch: 7 cost time: 19.88378620147705
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1169908
	speed: 0.2025s/iter; left time: 7757.1730s
	iters: 200, epoch: 8 | loss: 0.0208554
	speed: 0.0425s/iter; left time: 1623.0476s
	iters: 300, epoch: 8 | loss: 0.0013623
	speed: 0.0402s/iter; left time: 1531.4076s
	iters: 400, epoch: 8 | loss: 0.0057327
	speed: 0.0334s/iter; left time: 1268.5527s
Epoch: 8 cost time: 17.672917127609253
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0012989
	speed: 0.1908s/iter; left time: 7230.4296s
	iters: 200, epoch: 9 | loss: 0.0000154
	speed: 0.0428s/iter; left time: 1619.2522s
	iters: 300, epoch: 9 | loss: 0.0310386
	speed: 0.0361s/iter; left time: 1362.5385s
	iters: 400, epoch: 9 | loss: 0.4221114
	speed: 0.0367s/iter; left time: 1378.5349s
Epoch: 9 cost time: 17.151602506637573
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0067263
	speed: 0.1833s/iter; left time: 6871.5369s
	iters: 200, epoch: 10 | loss: 0.0000192
	speed: 0.0402s/iter; left time: 1503.3332s
	iters: 300, epoch: 10 | loss: 0.0001355
	speed: 0.0373s/iter; left time: 1391.3190s
	iters: 400, epoch: 10 | loss: 0.0000276
	speed: 0.0393s/iter; left time: 1462.9301s
Epoch: 10 cost time: 17.62977361679077
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000273
	speed: 0.1985s/iter; left time: 7358.9127s
	iters: 200, epoch: 11 | loss: 0.0000033
	speed: 0.0382s/iter; left time: 1412.1849s
	iters: 300, epoch: 11 | loss: 0.0000244
	speed: 0.0380s/iter; left time: 1402.0402s
	iters: 400, epoch: 11 | loss: 0.0000978
	speed: 0.0410s/iter; left time: 1508.5177s
Epoch: 11 cost time: 17.145099401474
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0919775
	speed: 0.1912s/iter; left time: 7008.1745s
	iters: 200, epoch: 12 | loss: 0.0000143
	speed: 0.0461s/iter; left time: 1686.2695s
	iters: 300, epoch: 12 | loss: 0.0000170
	speed: 0.0381s/iter; left time: 1390.4179s
	iters: 400, epoch: 12 | loss: 0.0128833
	speed: 0.0411s/iter; left time: 1494.7847s
Epoch: 12 cost time: 18.95032548904419
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0001350
	speed: 0.2008s/iter; left time: 7279.1945s
	iters: 200, epoch: 13 | loss: 0.0000876
	speed: 0.0430s/iter; left time: 1553.2562s
	iters: 300, epoch: 13 | loss: 0.0022434
	speed: 0.0412s/iter; left time: 1484.5633s
	iters: 400, epoch: 13 | loss: 0.0310990
	speed: 0.0388s/iter; left time: 1396.3711s
Epoch: 13 cost time: 18.51109743118286
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 72010
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0839185
	speed: 0.0950s/iter; left time: 3912.5200s
	iters: 200, epoch: 1 | loss: 0.2504853
	speed: 0.0624s/iter; left time: 2564.2197s
	iters: 300, epoch: 1 | loss: 0.0493613
	speed: 0.0576s/iter; left time: 2362.8568s
	iters: 400, epoch: 1 | loss: 0.0005656
	speed: 0.0510s/iter; left time: 2087.4949s
Epoch: 1 cost time: 27.595722198486328
Epoch: 1, Steps: 413 | Train Loss: 0.371 Vali Loss: 0.259 Vali Acc: 0.936 Test Loss: 0.259 Test Acc: 0.936
Validation loss decreased (inf --> -0.936332).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000775
	speed: 0.2343s/iter; left time: 9556.2066s
	iters: 200, epoch: 2 | loss: 0.0018569
	speed: 0.0581s/iter; left time: 2364.1909s
	iters: 300, epoch: 2 | loss: 0.0408078
	speed: 0.0574s/iter; left time: 2328.7209s
	iters: 400, epoch: 2 | loss: 0.0022536
	speed: 0.0638s/iter; left time: 2583.8720s
Epoch: 2 cost time: 24.92837142944336
Epoch: 2, Steps: 413 | Train Loss: 0.145 Vali Loss: 0.220 Vali Acc: 0.952 Test Loss: 0.220 Test Acc: 0.952
Validation loss decreased (-0.936332 --> -0.952249).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0157505
	speed: 0.2366s/iter; left time: 9553.9018s
	iters: 200, epoch: 3 | loss: 0.0000301
	speed: 0.0585s/iter; left time: 2356.6769s
	iters: 300, epoch: 3 | loss: 0.0010178
	speed: 0.0668s/iter; left time: 2682.6345s
	iters: 400, epoch: 3 | loss: 0.0075285
	speed: 0.0649s/iter; left time: 2600.7629s
Epoch: 3 cost time: 26.99991250038147
Epoch: 3, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.311 Vali Acc: 0.942 Test Loss: 0.311 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000027
	speed: 0.2331s/iter; left time: 9314.3452s
	iters: 200, epoch: 4 | loss: 0.0005781
	speed: 0.0560s/iter; left time: 2230.5497s
	iters: 300, epoch: 4 | loss: 0.0175666
	speed: 0.0518s/iter; left time: 2059.3436s
	iters: 400, epoch: 4 | loss: 0.0080295
	speed: 0.0538s/iter; left time: 2135.7467s
Epoch: 4 cost time: 23.21263813972473
Epoch: 4, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
Validation loss decreased (-0.952249 --> -0.973168).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000001
	speed: 0.2182s/iter; left time: 8629.6590s
	iters: 200, epoch: 5 | loss: 0.0000002
	speed: 0.0455s/iter; left time: 1796.3473s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1857.0854s
	iters: 400, epoch: 5 | loss: 0.0000081
	speed: 0.0409s/iter; left time: 1606.9335s
Epoch: 5 cost time: 18.902734994888306
Epoch: 5, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.314 Vali Acc: 0.965 Test Loss: 0.314 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.2093s/iter; left time: 8190.3890s
	iters: 200, epoch: 6 | loss: 0.0000011
	speed: 0.0428s/iter; left time: 1672.5457s
	iters: 300, epoch: 6 | loss: 0.0000014
	speed: 0.0445s/iter; left time: 1731.7262s
	iters: 400, epoch: 6 | loss: 0.0001378
	speed: 0.0375s/iter; left time: 1457.2737s
Epoch: 6 cost time: 18.127476453781128
Epoch: 6, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.492 Vali Acc: 0.945 Test Loss: 0.492 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2208s/iter; left time: 8551.7162s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 1690.0696s
	iters: 300, epoch: 7 | loss: 0.2489448
	speed: 0.0409s/iter; left time: 1575.7406s
	iters: 400, epoch: 7 | loss: 0.4707017
	speed: 0.0448s/iter; left time: 1719.6208s
Epoch: 7 cost time: 19.09954333305359
Epoch: 7, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.341 Vali Acc: 0.970 Test Loss: 0.341 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2023s/iter; left time: 7750.6248s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1802.1797s
	iters: 300, epoch: 8 | loss: 0.2877197
	speed: 0.0487s/iter; left time: 1855.0337s
	iters: 400, epoch: 8 | loss: 0.0000157
	speed: 0.0484s/iter; left time: 1838.6616s
Epoch: 8 cost time: 21.26021909713745
Epoch: 8, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.304 Vali Acc: 0.969 Test Loss: 0.304 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000002
	speed: 0.1974s/iter; left time: 7482.2131s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 1983.0550s
	iters: 300, epoch: 9 | loss: 0.3062167
	speed: 0.0578s/iter; left time: 2177.8255s
	iters: 400, epoch: 9 | loss: 0.0000040
	speed: 0.0498s/iter; left time: 1871.1224s
Epoch: 9 cost time: 21.692022800445557
Epoch: 9, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.423 Vali Acc: 0.967 Test Loss: 0.423 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2176s/iter; left time: 8154.6643s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.0470s/iter; left time: 1757.5030s
	iters: 300, epoch: 10 | loss: 0.0384447
	speed: 0.0590s/iter; left time: 2198.8945s
	iters: 400, epoch: 10 | loss: 0.3108200
	speed: 0.0571s/iter; left time: 2122.1180s
Epoch: 10 cost time: 22.892987728118896
Epoch: 10, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.516 Vali Acc: 0.962 Test Loss: 0.516 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1697809
	speed: 0.2027s/iter; left time: 7512.5189s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 1885.2496s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 1921.3633s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0600s/iter; left time: 2205.5269s
Epoch: 11 cost time: 22.981722116470337
Epoch: 11, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.442 Vali Acc: 0.965 Test Loss: 0.442 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2092s/iter; left time: 7667.8096s
	iters: 200, epoch: 12 | loss: 0.0000215
	speed: 0.0471s/iter; left time: 1723.2418s
	iters: 300, epoch: 12 | loss: 0.0000074
	speed: 0.0502s/iter; left time: 1830.8340s
	iters: 400, epoch: 12 | loss: 0.4313772
	speed: 0.0498s/iter; left time: 1809.5103s
Epoch: 12 cost time: 21.438332319259644
Epoch: 12, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.680 Vali Acc: 0.943 Test Loss: 0.680 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2220s/iter; left time: 8047.4578s
	iters: 200, epoch: 13 | loss: 0.0000004
	speed: 0.0530s/iter; left time: 1914.8639s
	iters: 300, epoch: 13 | loss: 0.0004542
	speed: 0.0543s/iter; left time: 1957.3412s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 1712.0792s
Epoch: 13 cost time: 22.571192026138306
Epoch: 13, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.460 Vali Acc: 0.964 Test Loss: 0.460 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.2442657
	speed: 0.2366s/iter; left time: 8479.3158s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 1862.4296s
	iters: 300, epoch: 14 | loss: 0.0000015
	speed: 0.0454s/iter; left time: 1616.5883s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 1832.4196s
Epoch: 14 cost time: 22.509729862213135
Epoch: 14, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.463 Vali Acc: 0.963 Test Loss: 0.463 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9731696225557072
model parameter : 221098
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8933111
	speed: 0.1003s/iter; left time: 4134.2328s
	iters: 200, epoch: 1 | loss: 0.0089234
	speed: 0.0674s/iter; left time: 2771.7249s
	iters: 300, epoch: 1 | loss: 0.2748246
	speed: 0.0687s/iter; left time: 2818.2679s
	iters: 400, epoch: 1 | loss: 0.0956242
	speed: 0.0537s/iter; left time: 2196.2181s
Epoch: 1 cost time: 29.805439233779907
Epoch: 1, Steps: 413 | Train Loss: 0.360 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
Validation loss decreased (inf --> -0.959980).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0386104
	speed: 0.2311s/iter; left time: 9427.5016s
	iters: 200, epoch: 2 | loss: 0.0008335
	speed: 0.0606s/iter; left time: 2465.7261s
	iters: 300, epoch: 2 | loss: 0.1582316
	speed: 0.0483s/iter; left time: 1958.8134s
	iters: 400, epoch: 2 | loss: 0.0004835
	speed: 0.0503s/iter; left time: 2036.1464s
Epoch: 2 cost time: 23.012699604034424
Epoch: 2, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.253 Vali Acc: 0.941 Test Loss: 0.253 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4489352
	speed: 0.2475s/iter; left time: 9993.0082s
	iters: 200, epoch: 3 | loss: 0.1581563
	speed: 0.0561s/iter; left time: 2260.8425s
	iters: 300, epoch: 3 | loss: 0.1471979
	speed: 0.0526s/iter; left time: 2111.2291s
	iters: 400, epoch: 3 | loss: 0.0033817
	speed: 0.0525s/iter; left time: 2105.7706s
Epoch: 3 cost time: 24.558333158493042
Epoch: 3, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0001203
	speed: 0.2360s/iter; left time: 9429.9015s
	iters: 200, epoch: 4 | loss: 0.0002975
	speed: 0.0482s/iter; left time: 1920.3007s
	iters: 300, epoch: 4 | loss: 0.0000131
	speed: 0.0570s/iter; left time: 2265.1579s
	iters: 400, epoch: 4 | loss: 0.0008831
	speed: 0.0478s/iter; left time: 1894.5289s
Epoch: 4 cost time: 22.659868478775024
Epoch: 4, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.260 Vali Acc: 0.957 Test Loss: 0.260 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0109629
	speed: 0.2268s/iter; left time: 8971.2935s
	iters: 200, epoch: 5 | loss: 0.0000318
	speed: 0.0504s/iter; left time: 1987.4943s
	iters: 300, epoch: 5 | loss: 0.0044490
	speed: 0.0457s/iter; left time: 1797.5371s
	iters: 400, epoch: 5 | loss: 0.0078544
	speed: 0.0580s/iter; left time: 2276.5490s
Epoch: 5 cost time: 21.092451333999634
Epoch: 5, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.227 Vali Acc: 0.966 Test Loss: 0.227 Test Acc: 0.966
Validation loss decreased (-0.959980 --> -0.966346).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0001026
	speed: 0.2548s/iter; left time: 9970.7961s
	iters: 200, epoch: 6 | loss: 0.2694974
	speed: 0.0648s/iter; left time: 2531.0143s
	iters: 300, epoch: 6 | loss: 0.0002247
	speed: 0.0766s/iter; left time: 2983.3145s
	iters: 400, epoch: 6 | loss: 0.0003550
	speed: 0.0806s/iter; left time: 3129.7069s
Epoch: 6 cost time: 30.351068258285522
Epoch: 6, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.256 Vali Acc: 0.964 Test Loss: 0.256 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0315967
	speed: 0.2737s/iter; left time: 10597.1318s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 3052.3964s
	iters: 300, epoch: 7 | loss: 0.0000093
	speed: 0.0721s/iter; left time: 2777.0546s
	iters: 400, epoch: 7 | loss: 0.0184403
	speed: 0.0797s/iter; left time: 3060.5759s
Epoch: 7 cost time: 32.28496527671814
Epoch: 7, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.351 Vali Acc: 0.961 Test Loss: 0.351 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0001868
	speed: 0.2875s/iter; left time: 11012.9237s
	iters: 200, epoch: 8 | loss: 0.0006065
	speed: 0.0681s/iter; left time: 2602.8408s
	iters: 300, epoch: 8 | loss: 0.0000071
	speed: 0.0789s/iter; left time: 3005.4133s
	iters: 400, epoch: 8 | loss: 0.4147140
	speed: 0.0774s/iter; left time: 2942.7574s
Epoch: 8 cost time: 31.751288890838623
Epoch: 8, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.306 Vali Acc: 0.954 Test Loss: 0.306 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000115
	speed: 0.2612s/iter; left time: 9896.9144s
	iters: 200, epoch: 9 | loss: 0.0000002
	speed: 0.0633s/iter; left time: 2393.2100s
	iters: 300, epoch: 9 | loss: 0.0000081
	speed: 0.0833s/iter; left time: 3140.6643s
	iters: 400, epoch: 9 | loss: 0.0000029
	speed: 0.0810s/iter; left time: 3044.9816s
Epoch: 9 cost time: 31.005945444107056
Epoch: 9, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.422 Vali Acc: 0.948 Test Loss: 0.422 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0097256
	speed: 0.2499s/iter; left time: 9367.4360s
	iters: 200, epoch: 10 | loss: 0.0038854
	speed: 0.0517s/iter; left time: 1932.7772s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0475s/iter; left time: 1769.9314s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0475s/iter; left time: 1767.5229s
Epoch: 10 cost time: 21.2967689037323
Epoch: 10, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.322 Vali Acc: 0.964 Test Loss: 0.322 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2239s/iter; left time: 8300.4642s
	iters: 200, epoch: 11 | loss: 0.0000288
	speed: 0.0439s/iter; left time: 1624.4355s
	iters: 300, epoch: 11 | loss: 0.0000044
	speed: 0.0507s/iter; left time: 1869.0229s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1739.3506s
Epoch: 11 cost time: 20.638036966323853
Epoch: 11, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.359 Vali Acc: 0.959 Test Loss: 0.359 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2044s/iter; left time: 7493.3183s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0484s/iter; left time: 1770.8562s
	iters: 300, epoch: 12 | loss: 0.0000033
	speed: 0.0561s/iter; left time: 2045.3138s
	iters: 400, epoch: 12 | loss: 0.0052140
	speed: 0.0414s/iter; left time: 1506.0683s
Epoch: 12 cost time: 20.21953582763672
Epoch: 12, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.362 Vali Acc: 0.971 Test Loss: 0.362 Test Acc: 0.971
Validation loss decreased (-0.966346 --> -0.970892).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.2123s/iter; left time: 7696.4901s
	iters: 200, epoch: 13 | loss: 0.0031701
	speed: 0.0508s/iter; left time: 1836.9528s
	iters: 300, epoch: 13 | loss: 0.0000364
	speed: 0.0466s/iter; left time: 1681.3415s
	iters: 400, epoch: 13 | loss: 0.0006711
	speed: 0.0479s/iter; left time: 1722.4805s
Epoch: 13 cost time: 20.909072160720825
Epoch: 13, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.296 Vali Acc: 0.968 Test Loss: 0.296 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0039496
	speed: 0.2331s/iter; left time: 8351.1304s
	iters: 200, epoch: 14 | loss: 0.0760191
	speed: 0.0472s/iter; left time: 1686.2700s
	iters: 300, epoch: 14 | loss: 0.0055280
	speed: 0.0447s/iter; left time: 1592.8427s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1721.5690s
Epoch: 14 cost time: 20.75614619255066
Epoch: 14, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.383 Vali Acc: 0.964 Test Loss: 0.383 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2539s/iter; left time: 8991.9637s
	iters: 200, epoch: 15 | loss: 0.0900215
	speed: 0.0697s/iter; left time: 2461.7036s
	iters: 300, epoch: 15 | loss: 0.0018401
	speed: 0.0683s/iter; left time: 2404.7378s
	iters: 400, epoch: 15 | loss: 0.0000004
	speed: 0.0639s/iter; left time: 2245.4921s
Epoch: 15 cost time: 29.970022916793823
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.349 Vali Acc: 0.970 Test Loss: 0.349 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0001177
	speed: 0.2694s/iter; left time: 9430.0364s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 2070.6507s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0582s/iter; left time: 2024.5854s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0732s/iter; left time: 2539.2125s
Epoch: 16 cost time: 27.836020469665527
Epoch: 16, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.316 Vali Acc: 0.972 Test Loss: 0.316 Test Acc: 0.972
Validation loss decreased (-0.970892 --> -0.972257).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000017
	speed: 0.2703s/iter; left time: 9350.8918s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0668s/iter; left time: 2303.7332s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0755s/iter; left time: 2598.2264s
	iters: 400, epoch: 17 | loss: 0.0000885
	speed: 0.0727s/iter; left time: 2491.6644s
Epoch: 17 cost time: 32.12689256668091
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.279 Vali Acc: 0.969 Test Loss: 0.279 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2603s/iter; left time: 8898.2386s
	iters: 200, epoch: 18 | loss: 0.1037339
	speed: 0.0609s/iter; left time: 2074.2111s
	iters: 300, epoch: 18 | loss: 0.0000041
	speed: 0.0663s/iter; left time: 2252.7440s
	iters: 400, epoch: 18 | loss: 0.0000002
	speed: 0.0610s/iter; left time: 2067.8419s
Epoch: 18 cost time: 28.058286428451538
Epoch: 18, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.248 Vali Acc: 0.978 Test Loss: 0.248 Test Acc: 0.978
Validation loss decreased (-0.972257 --> -0.977715).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0883734
	speed: 0.2176s/iter; left time: 7348.6073s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 1778.0304s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 1904.3733s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0539s/iter; left time: 1803.8943s
Epoch: 19 cost time: 22.65540361404419
Epoch: 19, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.378 Vali Acc: 0.973 Test Loss: 0.378 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000009
	speed: 0.2284s/iter; left time: 7616.7811s
	iters: 200, epoch: 20 | loss: 0.0000096
	speed: 0.0522s/iter; left time: 1734.8018s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 1806.6029s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 1573.6440s
Epoch: 20 cost time: 22.033065795898438
Epoch: 20, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.482 Vali Acc: 0.967 Test Loss: 0.482 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.3035458
	speed: 0.2288s/iter; left time: 7536.7196s
	iters: 200, epoch: 21 | loss: 0.0000202
	speed: 0.0508s/iter; left time: 1669.6748s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0513s/iter; left time: 1680.8390s
	iters: 400, epoch: 21 | loss: 0.0000002
	speed: 0.0550s/iter; left time: 1793.9664s
Epoch: 21 cost time: 22.39360284805298
Epoch: 21, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.394 Vali Acc: 0.966 Test Loss: 0.394 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000018
	speed: 0.2107s/iter; left time: 6853.1235s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 1453.3880s
	iters: 300, epoch: 22 | loss: 0.0000083
	speed: 0.0501s/iter; left time: 1619.1211s
	iters: 400, epoch: 22 | loss: 0.0000031
	speed: 0.0643s/iter; left time: 2073.3391s
Epoch: 22 cost time: 23.074953317642212
Epoch: 22, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.368 Vali Acc: 0.966 Test Loss: 0.368 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2173s/iter; left time: 6978.5606s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0571s/iter; left time: 1827.8826s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 1809.4936s
	iters: 400, epoch: 23 | loss: 0.0000012
	speed: 0.0578s/iter; left time: 1840.4012s
Epoch: 23 cost time: 23.88939595222473
Epoch: 23, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.580 Vali Acc: 0.959 Test Loss: 0.580 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2389s/iter; left time: 7573.7907s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0661s/iter; left time: 2090.4658s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 1928.0121s
	iters: 400, epoch: 24 | loss: 0.0000687
	speed: 0.0635s/iter; left time: 1994.1012s
Epoch: 24 cost time: 27.487769603729248
Epoch: 24, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.490 Vali Acc: 0.969 Test Loss: 0.490 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2560s/iter; left time: 8008.5814s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0585s/iter; left time: 1825.4870s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0682s/iter; left time: 2119.8139s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0636s/iter; left time: 1972.4198s
Epoch: 25 cost time: 28.2719886302948
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.407 Vali Acc: 0.971 Test Loss: 0.407 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000125
	speed: 0.2620s/iter; left time: 8090.9100s
	iters: 200, epoch: 26 | loss: 0.0000004
	speed: 0.0627s/iter; left time: 1929.4753s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.0570s/iter; left time: 1749.6002s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 1919.7840s
Epoch: 26 cost time: 27.623353481292725
Epoch: 26, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.425 Vali Acc: 0.968 Test Loss: 0.425 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2705s/iter; left time: 8240.3117s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 2481.3251s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0669s/iter; left time: 2025.8500s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0705s/iter; left time: 2125.3657s
Epoch: 27 cost time: 32.34740400314331
Epoch: 27, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.418 Vali Acc: 0.971 Test Loss: 0.418 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2132s/iter; left time: 6405.5354s
	iters: 200, epoch: 28 | loss: 0.0070244
	speed: 0.0622s/iter; left time: 1863.8937s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 1741.5733s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 1655.0062s
Epoch: 28 cost time: 24.51279354095459
Epoch: 28, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.406 Vali Acc: 0.974 Test Loss: 0.406 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 154602
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7454826
	speed: 0.0755s/iter; left time: 3109.8734s
	iters: 200, epoch: 1 | loss: 0.2379435
	speed: 0.0420s/iter; left time: 1727.7340s
	iters: 300, epoch: 1 | loss: 0.2151888
	speed: 0.0431s/iter; left time: 1769.0330s
	iters: 400, epoch: 1 | loss: 0.0464179
	speed: 0.0398s/iter; left time: 1629.6010s
Epoch: 1 cost time: 20.65018606185913
Epoch: 1, Steps: 413 | Train Loss: 0.406 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
Validation loss decreased (inf --> -0.956342).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5871485
	speed: 0.1738s/iter; left time: 7089.7144s
	iters: 200, epoch: 2 | loss: 0.0048123
	speed: 0.0439s/iter; left time: 1787.4879s
	iters: 300, epoch: 2 | loss: 0.1469370
	speed: 0.0458s/iter; left time: 1859.1533s
	iters: 400, epoch: 2 | loss: 0.7474364
	speed: 0.0471s/iter; left time: 1907.1029s
Epoch: 2 cost time: 18.962371587753296
Epoch: 2, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.956342 --> -0.967712).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0011934
	speed: 0.1726s/iter; left time: 6968.8501s
	iters: 200, epoch: 3 | loss: 0.0021244
	speed: 0.0364s/iter; left time: 1467.1502s
	iters: 300, epoch: 3 | loss: 0.0402583
	speed: 0.0390s/iter; left time: 1566.9969s
	iters: 400, epoch: 3 | loss: 0.1058476
	speed: 0.0444s/iter; left time: 1777.3627s
Epoch: 3 cost time: 17.195528268814087
Epoch: 3, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.967712 --> -0.968166).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0003201
	speed: 0.1788s/iter; left time: 7145.7535s
	iters: 200, epoch: 4 | loss: 0.0007011
	speed: 0.0442s/iter; left time: 1760.1386s
	iters: 300, epoch: 4 | loss: 0.1296790
	speed: 0.0469s/iter; left time: 1865.4005s
	iters: 400, epoch: 4 | loss: 0.0014458
	speed: 0.0567s/iter; left time: 2249.1078s
Epoch: 4 cost time: 20.106266021728516
Epoch: 4, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1477978
	speed: 0.1918s/iter; left time: 7586.9132s
	iters: 200, epoch: 5 | loss: 0.5927914
	speed: 0.0504s/iter; left time: 1988.2342s
	iters: 300, epoch: 5 | loss: 0.0659626
	speed: 0.0490s/iter; left time: 1926.6607s
	iters: 400, epoch: 5 | loss: 0.0000663
	speed: 0.0514s/iter; left time: 2017.9303s
Epoch: 5 cost time: 21.176599264144897
Epoch: 5, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.274 Vali Acc: 0.945 Test Loss: 0.274 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000007
	speed: 0.1966s/iter; left time: 7693.4747s
	iters: 200, epoch: 6 | loss: 0.0920451
	speed: 0.0420s/iter; left time: 1641.2314s
	iters: 300, epoch: 6 | loss: 0.0033954
	speed: 0.0379s/iter; left time: 1476.1707s
	iters: 400, epoch: 6 | loss: 0.0000020
	speed: 0.0375s/iter; left time: 1458.2293s
Epoch: 6 cost time: 17.713338375091553
Epoch: 6, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.968166 --> -0.974987).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0007695
	speed: 0.1788s/iter; left time: 6922.6455s
	iters: 200, epoch: 7 | loss: 0.0000024
	speed: 0.0378s/iter; left time: 1461.5527s
	iters: 300, epoch: 7 | loss: 0.0000005
	speed: 0.0392s/iter; left time: 1510.2760s
	iters: 400, epoch: 7 | loss: 0.1535818
	speed: 0.0385s/iter; left time: 1479.7375s
Epoch: 7 cost time: 17.277617931365967
Epoch: 7, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.325 Vali Acc: 0.954 Test Loss: 0.325 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000012
	speed: 0.1787s/iter; left time: 6844.7235s
	iters: 200, epoch: 8 | loss: 0.0004158
	speed: 0.0427s/iter; left time: 1632.0768s
	iters: 300, epoch: 8 | loss: 0.6268245
	speed: 0.0402s/iter; left time: 1533.3614s
	iters: 400, epoch: 8 | loss: 0.2484690
	speed: 0.0401s/iter; left time: 1523.2863s
Epoch: 8 cost time: 17.976645469665527
Epoch: 8, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.974987 --> -0.981354).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000129
	speed: 0.1919s/iter; left time: 7272.3101s
	iters: 200, epoch: 9 | loss: 0.0185900
	speed: 0.0595s/iter; left time: 2247.3534s
	iters: 300, epoch: 9 | loss: 0.0001829
	speed: 0.0565s/iter; left time: 2130.4716s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0423s/iter; left time: 1589.8237s
Epoch: 9 cost time: 22.27241277694702
Epoch: 9, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.296 Vali Acc: 0.970 Test Loss: 0.296 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0083269
	speed: 0.1915s/iter; left time: 7178.7060s
	iters: 200, epoch: 10 | loss: 0.0000399
	speed: 0.0716s/iter; left time: 2676.8443s
	iters: 300, epoch: 10 | loss: 0.0015461
	speed: 0.0782s/iter; left time: 2915.9098s
	iters: 400, epoch: 10 | loss: 0.0063251
	speed: 0.0616s/iter; left time: 2291.4507s
Epoch: 10 cost time: 27.491878509521484
Epoch: 10, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.208 Vali Acc: 0.970 Test Loss: 0.208 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.2014s/iter; left time: 7464.6329s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 2185.4517s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 2218.1086s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0599s/iter; left time: 2203.3909s
Epoch: 11 cost time: 25.620248317718506
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.214 Vali Acc: 0.977 Test Loss: 0.214 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.1831s/iter; left time: 6712.2160s
	iters: 200, epoch: 12 | loss: 0.0000011
	speed: 0.0485s/iter; left time: 1771.3044s
	iters: 300, epoch: 12 | loss: 0.0000064
	speed: 0.0451s/iter; left time: 1643.5987s
	iters: 400, epoch: 12 | loss: 0.0001115
	speed: 0.0473s/iter; left time: 1718.8804s
Epoch: 12 cost time: 19.90043020248413
Epoch: 12, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.319 Vali Acc: 0.970 Test Loss: 0.319 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000789
	speed: 0.1882s/iter; left time: 6822.6730s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 1356.1722s
	iters: 300, epoch: 13 | loss: 0.0000094
	speed: 0.0378s/iter; left time: 1361.0464s
	iters: 400, epoch: 13 | loss: 0.0003418
	speed: 0.0416s/iter; left time: 1493.6031s
Epoch: 13 cost time: 17.016700983047485
Epoch: 13, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.479 Vali Acc: 0.961 Test Loss: 0.479 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0002338
	speed: 0.1902s/iter; left time: 6815.5512s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 1361.5858s
	iters: 300, epoch: 14 | loss: 0.0000014
	speed: 0.0447s/iter; left time: 1591.5848s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1511.6225s
Epoch: 14 cost time: 17.973615884780884
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.300 Vali Acc: 0.972 Test Loss: 0.300 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1654s/iter; left time: 5857.1147s
	iters: 200, epoch: 15 | loss: 0.0005033
	speed: 0.0385s/iter; left time: 1359.2398s
	iters: 300, epoch: 15 | loss: 0.4543791
	speed: 0.0379s/iter; left time: 1335.8322s
	iters: 400, epoch: 15 | loss: 0.0000711
	speed: 0.0358s/iter; left time: 1257.0101s
Epoch: 15 cost time: 15.902228832244873
Epoch: 15, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.217 Vali Acc: 0.979 Test Loss: 0.217 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000027
	speed: 0.1837s/iter; left time: 6429.1421s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.0382s/iter; left time: 1333.3599s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0417s/iter; left time: 1450.4036s
	iters: 400, epoch: 16 | loss: 0.0372147
	speed: 0.0420s/iter; left time: 1457.1516s
Epoch: 16 cost time: 18.12265396118164
Epoch: 16, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.278 Vali Acc: 0.969 Test Loss: 0.278 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0011257
	speed: 0.1819s/iter; left time: 6291.0404s
	iters: 200, epoch: 17 | loss: 0.0128939
	speed: 0.0374s/iter; left time: 1289.4462s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 1644.9499s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0408s/iter; left time: 1398.0858s
Epoch: 17 cost time: 17.788315057754517
Epoch: 17, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.219 Vali Acc: 0.977 Test Loss: 0.219 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000194
	speed: 0.1760s/iter; left time: 6017.3803s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 1536.6686s
	iters: 300, epoch: 18 | loss: 0.0876367
	speed: 0.0416s/iter; left time: 1414.8400s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0484s/iter; left time: 1640.6693s
Epoch: 18 cost time: 19.545278549194336
Epoch: 18, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.367 Vali Acc: 0.970 Test Loss: 0.367 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 121386
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1624149
	speed: 0.1001s/iter; left time: 4124.5764s
	iters: 200, epoch: 1 | loss: 0.2771589
	speed: 0.0487s/iter; left time: 2003.1120s
	iters: 300, epoch: 1 | loss: 0.1625833
	speed: 0.0479s/iter; left time: 1965.9928s
	iters: 400, epoch: 1 | loss: 0.2902811
	speed: 0.0504s/iter; left time: 2059.3929s
Epoch: 1 cost time: 25.351011037826538
Epoch: 1, Steps: 413 | Train Loss: 0.422 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (inf --> -0.961800).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0207646
	speed: 0.2061s/iter; left time: 8406.4813s
	iters: 200, epoch: 2 | loss: 0.0066280
	speed: 0.0492s/iter; left time: 2001.5618s
	iters: 300, epoch: 2 | loss: 0.0037278
	speed: 0.0507s/iter; left time: 2059.3015s
	iters: 400, epoch: 2 | loss: 0.0031619
	speed: 0.0555s/iter; left time: 2247.3910s
Epoch: 2 cost time: 21.361005783081055
Epoch: 2, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0175665
	speed: 0.2251s/iter; left time: 9087.5980s
	iters: 200, epoch: 3 | loss: 0.2251400
	speed: 0.0442s/iter; left time: 1781.9094s
	iters: 300, epoch: 3 | loss: 0.0007832
	speed: 0.0567s/iter; left time: 2279.6980s
	iters: 400, epoch: 3 | loss: 0.0233595
	speed: 0.0560s/iter; left time: 2242.6995s
Epoch: 3 cost time: 22.923538208007812
Epoch: 3, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.196 Vali Acc: 0.955 Test Loss: 0.196 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0001168
	speed: 0.2156s/iter; left time: 8617.7154s
	iters: 200, epoch: 4 | loss: 0.0026464
	speed: 0.0424s/iter; left time: 1689.4077s
	iters: 300, epoch: 4 | loss: 0.0003183
	speed: 0.0430s/iter; left time: 1709.3671s
	iters: 400, epoch: 4 | loss: 0.0021070
	speed: 0.0425s/iter; left time: 1685.9471s
Epoch: 4 cost time: 18.74165368080139
Epoch: 4, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
Validation loss decreased (-0.961800 --> -0.970895).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0039817
	speed: 0.2298s/iter; left time: 9088.9278s
	iters: 200, epoch: 5 | loss: 0.0103270
	speed: 0.0489s/iter; left time: 1928.1722s
	iters: 300, epoch: 5 | loss: 0.1561004
	speed: 0.0511s/iter; left time: 2010.5060s
	iters: 400, epoch: 5 | loss: 0.1232528
	speed: 0.0440s/iter; left time: 1727.1485s
Epoch: 5 cost time: 21.673198699951172
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.149 Vali Acc: 0.966 Test Loss: 0.149 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0003176
	speed: 0.2193s/iter; left time: 8583.7777s
	iters: 200, epoch: 6 | loss: 0.0000168
	speed: 0.0466s/iter; left time: 1817.7212s
	iters: 300, epoch: 6 | loss: 0.0275271
	speed: 0.0481s/iter; left time: 1873.9855s
	iters: 400, epoch: 6 | loss: 0.0000887
	speed: 0.0441s/iter; left time: 1714.1370s
Epoch: 6 cost time: 20.08980655670166
Epoch: 6, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
Validation loss decreased (-0.970895 --> -0.971349).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0008025
	speed: 0.2388s/iter; left time: 9245.5168s
	iters: 200, epoch: 7 | loss: 0.1341508
	speed: 0.0490s/iter; left time: 1890.7542s
	iters: 300, epoch: 7 | loss: 0.0011823
	speed: 0.0487s/iter; left time: 1877.7940s
	iters: 400, epoch: 7 | loss: 0.0000197
	speed: 0.0585s/iter; left time: 2248.1587s
Epoch: 7 cost time: 22.372965574264526
Epoch: 7, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.211 Vali Acc: 0.970 Test Loss: 0.211 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000247
	speed: 0.2100s/iter; left time: 8046.4762s
	iters: 200, epoch: 8 | loss: 0.0009448
	speed: 0.0549s/iter; left time: 2096.9437s
	iters: 300, epoch: 8 | loss: 0.0000168
	speed: 0.0498s/iter; left time: 1898.2003s
	iters: 400, epoch: 8 | loss: 0.0000062
	speed: 0.0539s/iter; left time: 2048.5858s
Epoch: 8 cost time: 22.50241494178772
Epoch: 8, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.971349 --> -0.977261).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000373
	speed: 0.2157s/iter; left time: 8173.4874s
	iters: 200, epoch: 9 | loss: 0.0138645
	speed: 0.0504s/iter; left time: 1906.5590s
	iters: 300, epoch: 9 | loss: 0.0041477
	speed: 0.0518s/iter; left time: 1953.4711s
	iters: 400, epoch: 9 | loss: 0.0000285
	speed: 0.0531s/iter; left time: 1995.7721s
Epoch: 9 cost time: 21.95941710472107
Epoch: 9, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000639
	speed: 0.2148s/iter; left time: 8051.6091s
	iters: 200, epoch: 10 | loss: 0.0000437
	speed: 0.0451s/iter; left time: 1685.0926s
	iters: 300, epoch: 10 | loss: 0.0013896
	speed: 0.0460s/iter; left time: 1714.9647s
	iters: 400, epoch: 10 | loss: 0.0000010
	speed: 0.0514s/iter; left time: 1912.9490s
Epoch: 10 cost time: 20.499680757522583
Epoch: 10, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.223 Vali Acc: 0.973 Test Loss: 0.223 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000024
	speed: 0.2124s/iter; left time: 7875.4379s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0491s/iter; left time: 1814.3876s
	iters: 300, epoch: 11 | loss: 0.0003903
	speed: 0.0477s/iter; left time: 1760.2052s
	iters: 400, epoch: 11 | loss: 0.0000230
	speed: 0.0438s/iter; left time: 1610.3682s
Epoch: 11 cost time: 20.260323762893677
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.233 Vali Acc: 0.972 Test Loss: 0.233 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2178s/iter; left time: 7984.7620s
	iters: 200, epoch: 12 | loss: 0.0003012
	speed: 0.0497s/iter; left time: 1817.4992s
	iters: 300, epoch: 12 | loss: 0.0000305
	speed: 0.0455s/iter; left time: 1658.7200s
	iters: 400, epoch: 12 | loss: 0.0005057
	speed: 0.0458s/iter; left time: 1663.8545s
Epoch: 12 cost time: 20.71251940727234
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.251 Vali Acc: 0.970 Test Loss: 0.251 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1749088
	speed: 0.2248s/iter; left time: 8148.5642s
	iters: 200, epoch: 13 | loss: 0.0449459
	speed: 0.0514s/iter; left time: 1859.3043s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0438s/iter; left time: 1578.3602s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 1791.6036s
Epoch: 13 cost time: 20.874760150909424
Epoch: 13, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000003
	speed: 0.2398s/iter; left time: 8591.0264s
	iters: 200, epoch: 14 | loss: 0.0000005
	speed: 0.0479s/iter; left time: 1712.7937s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0453s/iter; left time: 1613.0153s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1650.0249s
Epoch: 14 cost time: 20.2931969165802
Epoch: 14, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.182 Vali Acc: 0.973 Test Loss: 0.182 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000132
	speed: 0.2314s/iter; left time: 8194.2870s
	iters: 200, epoch: 15 | loss: 0.0009524
	speed: 0.0482s/iter; left time: 1704.0612s
	iters: 300, epoch: 15 | loss: 0.0000002
	speed: 0.0462s/iter; left time: 1627.5489s
	iters: 400, epoch: 15 | loss: 0.0031854
	speed: 0.0505s/iter; left time: 1773.7680s
Epoch: 15 cost time: 21.153074741363525
Epoch: 15, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.371 Vali Acc: 0.969 Test Loss: 0.371 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000027
	speed: 0.2152s/iter; left time: 7534.1264s
	iters: 200, epoch: 16 | loss: 0.0001176
	speed: 0.0381s/iter; left time: 1329.2511s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1496.2322s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 1560.7977s
Epoch: 16 cost time: 18.156588792800903
Epoch: 16, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.318 Vali Acc: 0.968 Test Loss: 0.318 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2371s/iter; left time: 8202.2821s
	iters: 200, epoch: 17 | loss: 0.0319361
	speed: 0.0468s/iter; left time: 1613.9394s
	iters: 300, epoch: 17 | loss: 0.4982929
	speed: 0.0416s/iter; left time: 1429.7939s
	iters: 400, epoch: 17 | loss: 0.0000057
	speed: 0.0432s/iter; left time: 1480.1196s
Epoch: 17 cost time: 18.814852714538574
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.323 Vali Acc: 0.971 Test Loss: 0.323 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2242s/iter; left time: 7663.6829s
	iters: 200, epoch: 18 | loss: 0.0000437
	speed: 0.0439s/iter; left time: 1495.3061s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0502s/iter; left time: 1705.0418s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 1646.1457s
Epoch: 18 cost time: 21.63936138153076
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.166 Vali Acc: 0.977 Test Loss: 0.166 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.977262391996362
model parameter : 100682
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3741092
	speed: 0.0863s/iter; left time: 3556.7170s
	iters: 200, epoch: 1 | loss: 0.0972184
	speed: 0.0504s/iter; left time: 2070.9559s
	iters: 300, epoch: 1 | loss: 0.0216037
	speed: 0.0428s/iter; left time: 1756.5075s
	iters: 400, epoch: 1 | loss: 0.0277172
	speed: 0.0502s/iter; left time: 2054.3230s
Epoch: 1 cost time: 23.807645797729492
Epoch: 1, Steps: 413 | Train Loss: 0.468 Vali Loss: 0.120 Vali Acc: 0.958 Test Loss: 0.120 Test Acc: 0.958
Validation loss decreased (inf --> -0.957707).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0642129
	speed: 0.2185s/iter; left time: 8912.4653s
	iters: 200, epoch: 2 | loss: 0.0283500
	speed: 0.0554s/iter; left time: 2253.8671s
	iters: 300, epoch: 2 | loss: 0.0452477
	speed: 0.0474s/iter; left time: 1924.6754s
	iters: 400, epoch: 2 | loss: 0.0120878
	speed: 0.0418s/iter; left time: 1691.0139s
Epoch: 2 cost time: 21.104415893554688
Epoch: 2, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
Validation loss decreased (-0.957707 --> -0.963619).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0078682
	speed: 0.2275s/iter; left time: 9184.9173s
	iters: 200, epoch: 3 | loss: 0.0121052
	speed: 0.0528s/iter; left time: 2127.3437s
	iters: 300, epoch: 3 | loss: 0.0189917
	speed: 0.0455s/iter; left time: 1829.8798s
	iters: 400, epoch: 3 | loss: 0.0106102
	speed: 0.0453s/iter; left time: 1814.7998s
Epoch: 3 cost time: 20.84075093269348
Epoch: 3, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.109 Vali Acc: 0.966 Test Loss: 0.109 Test Acc: 0.966
Validation loss decreased (-0.963619 --> -0.966347).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0029546
	speed: 0.2071s/iter; left time: 8276.3059s
	iters: 200, epoch: 4 | loss: 0.0003239
	speed: 0.0443s/iter; left time: 1767.2604s
	iters: 300, epoch: 4 | loss: 0.0000563
	speed: 0.0447s/iter; left time: 1778.1094s
	iters: 400, epoch: 4 | loss: 0.0021318
	speed: 0.0467s/iter; left time: 1850.2595s
Epoch: 4 cost time: 18.973384857177734
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
Validation loss decreased (-0.966347 --> -0.973623).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000042
	speed: 0.2043s/iter; left time: 8079.5450s
	iters: 200, epoch: 5 | loss: 0.1011405
	speed: 0.0458s/iter; left time: 1807.7655s
	iters: 300, epoch: 5 | loss: 0.0000356
	speed: 0.0434s/iter; left time: 1706.5981s
	iters: 400, epoch: 5 | loss: 0.0001204
	speed: 0.0466s/iter; left time: 1830.2194s
Epoch: 5 cost time: 19.462504386901855
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0002496
	speed: 0.1785s/iter; left time: 6987.1078s
	iters: 200, epoch: 6 | loss: 0.0068131
	speed: 0.0473s/iter; left time: 1844.4655s
	iters: 300, epoch: 6 | loss: 0.0000286
	speed: 0.0461s/iter; left time: 1795.3287s
	iters: 400, epoch: 6 | loss: 0.1158076
	speed: 0.0458s/iter; left time: 1780.4677s
Epoch: 6 cost time: 20.058675289154053
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4497986
	speed: 0.2226s/iter; left time: 8618.9617s
	iters: 200, epoch: 7 | loss: 0.0002920
	speed: 0.0511s/iter; left time: 1974.4753s
	iters: 300, epoch: 7 | loss: 0.0550714
	speed: 0.0456s/iter; left time: 1757.7609s
	iters: 400, epoch: 7 | loss: 0.0000299
	speed: 0.0401s/iter; left time: 1542.3794s
Epoch: 7 cost time: 20.43680763244629
Epoch: 7, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.193 Vali Acc: 0.965 Test Loss: 0.193 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0005679
	speed: 0.2377s/iter; left time: 9107.2607s
	iters: 200, epoch: 8 | loss: 0.0000526
	speed: 0.0431s/iter; left time: 1647.7021s
	iters: 300, epoch: 8 | loss: 0.5142774
	speed: 0.0518s/iter; left time: 1972.7138s
	iters: 400, epoch: 8 | loss: 0.0003446
	speed: 0.0496s/iter; left time: 1886.0004s
Epoch: 8 cost time: 22.442331314086914
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0016018
	speed: 0.2062s/iter; left time: 7814.8538s
	iters: 200, epoch: 9 | loss: 0.0072030
	speed: 0.0427s/iter; left time: 1614.9856s
	iters: 300, epoch: 9 | loss: 0.0000003
	speed: 0.0465s/iter; left time: 1751.9909s
	iters: 400, epoch: 9 | loss: 0.0000241
	speed: 0.0526s/iter; left time: 1977.2404s
Epoch: 9 cost time: 20.217410564422607
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.171 Vali Acc: 0.965 Test Loss: 0.171 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0039921
	speed: 0.2356s/iter; left time: 8830.1278s
	iters: 200, epoch: 10 | loss: 0.0000013
	speed: 0.0498s/iter; left time: 1863.4796s
	iters: 300, epoch: 10 | loss: 0.0041947
	speed: 0.0443s/iter; left time: 1651.4422s
	iters: 400, epoch: 10 | loss: 0.0002814
	speed: 0.0462s/iter; left time: 1717.3586s
Epoch: 10 cost time: 20.30797815322876
Epoch: 10, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.973623 --> -0.979990).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0970227
	speed: 0.2253s/iter; left time: 8350.8633s
	iters: 200, epoch: 11 | loss: 0.0000012
	speed: 0.0485s/iter; left time: 1792.2975s
	iters: 300, epoch: 11 | loss: 0.0000672
	speed: 0.0494s/iter; left time: 1822.8695s
	iters: 400, epoch: 11 | loss: 0.0008159
	speed: 0.0479s/iter; left time: 1760.5747s
Epoch: 11 cost time: 21.4670627117157
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.199 Vali Acc: 0.968 Test Loss: 0.199 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2185s/iter; left time: 8008.1464s
	iters: 200, epoch: 12 | loss: 0.0000325
	speed: 0.0499s/iter; left time: 1823.1477s
	iters: 300, epoch: 12 | loss: 0.0000966
	speed: 0.0477s/iter; left time: 1737.3831s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0492s/iter; left time: 1788.0108s
Epoch: 12 cost time: 20.574833154678345
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.203 Vali Acc: 0.967 Test Loss: 0.203 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000031
	speed: 0.2213s/iter; left time: 8019.3298s
	iters: 200, epoch: 13 | loss: 0.0000038
	speed: 0.0476s/iter; left time: 1721.1288s
	iters: 300, epoch: 13 | loss: 0.0084171
	speed: 0.0445s/iter; left time: 1602.9613s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0496s/iter; left time: 1783.9327s
Epoch: 13 cost time: 20.640262842178345
Epoch: 13, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0033002
	speed: 0.2167s/iter; left time: 7766.2504s
	iters: 200, epoch: 14 | loss: 0.0045007
	speed: 0.0451s/iter; left time: 1612.2487s
	iters: 300, epoch: 14 | loss: 0.0165026
	speed: 0.0464s/iter; left time: 1654.2489s
	iters: 400, epoch: 14 | loss: 0.0019366
	speed: 0.0470s/iter; left time: 1671.6632s
Epoch: 14 cost time: 20.877068758010864
Epoch: 14, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.979990 --> -0.982719).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0004098
	speed: 0.2096s/iter; left time: 7424.8665s
	iters: 200, epoch: 15 | loss: 0.0004055
	speed: 0.0425s/iter; left time: 1501.1455s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0456s/iter; left time: 1605.0953s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 1479.1520s
Epoch: 15 cost time: 18.950227737426758
Epoch: 15, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.149 Vali Acc: 0.978 Test Loss: 0.149 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2072s/iter; left time: 7254.0088s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.0417s/iter; left time: 1456.9100s
	iters: 300, epoch: 16 | loss: 0.0000003
	speed: 0.0384s/iter; left time: 1335.3652s
	iters: 400, epoch: 16 | loss: 0.0000025
	speed: 0.0487s/iter; left time: 1689.1558s
Epoch: 16 cost time: 19.109802961349487
Epoch: 16, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2135s/iter; left time: 7386.7078s
	iters: 200, epoch: 17 | loss: 0.0112230
	speed: 0.0500s/iter; left time: 1726.0012s
	iters: 300, epoch: 17 | loss: 0.0000277
	speed: 0.0447s/iter; left time: 1536.0389s
	iters: 400, epoch: 17 | loss: 0.0000103
	speed: 0.0498s/iter; left time: 1708.4994s
Epoch: 17 cost time: 20.36433506011963
Epoch: 17, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.364 Vali Acc: 0.958 Test Loss: 0.364 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0003216
	speed: 0.2243s/iter; left time: 7665.9576s
	iters: 200, epoch: 18 | loss: 0.0003679
	speed: 0.0494s/iter; left time: 1685.0613s
	iters: 300, epoch: 18 | loss: 0.0000133
	speed: 0.0499s/iter; left time: 1696.5747s
	iters: 400, epoch: 18 | loss: 0.1588529
	speed: 0.0481s/iter; left time: 1629.1722s
Epoch: 18 cost time: 21.148525953292847
Epoch: 18, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0019223
	speed: 0.2241s/iter; left time: 7565.8383s
	iters: 200, epoch: 19 | loss: 0.2139321
	speed: 0.0487s/iter; left time: 1639.1460s
	iters: 300, epoch: 19 | loss: 0.0001826
	speed: 0.0481s/iter; left time: 1613.0576s
	iters: 400, epoch: 19 | loss: 0.0000007
	speed: 0.0472s/iter; left time: 1579.5731s
Epoch: 19 cost time: 20.98777198791504
Epoch: 19, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.146 Vali Acc: 0.980 Test Loss: 0.146 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2284s/iter; left time: 7618.9625s
	iters: 200, epoch: 20 | loss: 0.0000438
	speed: 0.0521s/iter; left time: 1733.7701s
	iters: 300, epoch: 20 | loss: 0.0000004
	speed: 0.0476s/iter; left time: 1579.2186s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 1624.9634s
Epoch: 20 cost time: 21.92518949508667
Epoch: 20, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.136 Vali Acc: 0.984 Test Loss: 0.136 Test Acc: 0.984
Validation loss decreased (-0.982719 --> -0.983628).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2244s/iter; left time: 7390.8328s
	iters: 200, epoch: 21 | loss: 0.0108926
	speed: 0.0562s/iter; left time: 1846.4283s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0505s/iter; left time: 1653.8785s
	iters: 400, epoch: 21 | loss: 0.0010144
	speed: 0.0546s/iter; left time: 1782.6077s
Epoch: 21 cost time: 22.927701234817505
Epoch: 21, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.2100s/iter; left time: 6830.3003s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 1405.0019s
	iters: 300, epoch: 22 | loss: 0.0005668
	speed: 0.0491s/iter; left time: 1587.6974s
	iters: 400, epoch: 22 | loss: 0.0011086
	speed: 0.0478s/iter; left time: 1540.4975s
Epoch: 22 cost time: 20.313785552978516
Epoch: 22, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.248 Vali Acc: 0.971 Test Loss: 0.248 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000020
	speed: 0.2336s/iter; left time: 7500.6375s
	iters: 200, epoch: 23 | loss: 0.0200385
	speed: 0.0448s/iter; left time: 1435.6672s
	iters: 300, epoch: 23 | loss: 0.0000022
	speed: 0.0508s/iter; left time: 1621.2839s
	iters: 400, epoch: 23 | loss: 0.0000365
	speed: 0.0488s/iter; left time: 1551.6098s
Epoch: 23 cost time: 21.370312690734863
Epoch: 23, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.159 Vali Acc: 0.979 Test Loss: 0.159 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2398s/iter; left time: 7603.3101s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 1296.1937s
	iters: 300, epoch: 24 | loss: 0.0000247
	speed: 0.0466s/iter; left time: 1468.7510s
	iters: 400, epoch: 24 | loss: 0.0004269
	speed: 0.0454s/iter; left time: 1426.1606s
Epoch: 24 cost time: 19.96722936630249
Epoch: 24, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2358s/iter; left time: 7377.2823s
	iters: 200, epoch: 25 | loss: 0.0024027
	speed: 0.0502s/iter; left time: 1566.9488s
	iters: 300, epoch: 25 | loss: 0.0000099
	speed: 0.0445s/iter; left time: 1382.2937s
	iters: 400, epoch: 25 | loss: 0.0000018
	speed: 0.0460s/iter; left time: 1424.1077s
Epoch: 25 cost time: 20.34788990020752
Epoch: 25, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2166s/iter; left time: 6688.7680s
	iters: 200, epoch: 26 | loss: 0.0000003
	speed: 0.0527s/iter; left time: 1621.4028s
	iters: 300, epoch: 26 | loss: 0.0000072
	speed: 0.0448s/iter; left time: 1373.5220s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 1380.3697s
Epoch: 26 cost time: 20.803816080093384
Epoch: 26, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.182 Vali Acc: 0.978 Test Loss: 0.182 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2122s/iter; left time: 6464.8325s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0511s/iter; left time: 1552.1079s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 1159.2498s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 1285.8790s
Epoch: 27 cost time: 19.671630144119263
Epoch: 27, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.138 Vali Acc: 0.981 Test Loss: 0.138 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0003181
	speed: 0.2060s/iter; left time: 6190.1731s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0465s/iter; left time: 1393.9932s
	iters: 300, epoch: 28 | loss: 0.0122266
	speed: 0.0453s/iter; left time: 1352.6023s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0471s/iter; left time: 1399.8010s
Epoch: 28 cost time: 19.8517062664032
Epoch: 28, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.177 Vali Acc: 0.980 Test Loss: 0.177 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2215s/iter; left time: 6564.3306s
	iters: 200, epoch: 29 | loss: 0.0000007
	speed: 0.0414s/iter; left time: 1222.9206s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 1160.9038s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 1414.4277s
Epoch: 29 cost time: 18.876708030700684
Epoch: 29, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.171 Vali Acc: 0.980 Test Loss: 0.171 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.3385048
	speed: 0.2309s/iter; left time: 6748.0391s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 1436.0599s
	iters: 300, epoch: 30 | loss: 0.0000001
	speed: 0.0479s/iter; left time: 1389.7984s
	iters: 400, epoch: 30 | loss: 0.0000001
	speed: 0.0414s/iter; left time: 1196.5598s
Epoch: 30 cost time: 20.498709201812744
Epoch: 30, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.154 Vali Acc: 0.982 Test Loss: 0.154 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 80010
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2104862
	speed: 0.0769s/iter; left time: 3168.4099s
	iters: 200, epoch: 1 | loss: 0.3527004
	speed: 0.0492s/iter; left time: 2022.6131s
	iters: 300, epoch: 1 | loss: 0.1320652
	speed: 0.0448s/iter; left time: 1835.5804s
	iters: 400, epoch: 1 | loss: 0.0249861
	speed: 0.0424s/iter; left time: 1733.3303s
Epoch: 1 cost time: 22.06013011932373
Epoch: 1, Steps: 413 | Train Loss: 0.498 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
Validation loss decreased (inf --> -0.965438).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0203186
	speed: 0.2295s/iter; left time: 9360.4816s
	iters: 200, epoch: 2 | loss: 0.0234060
	speed: 0.0490s/iter; left time: 1995.6022s
	iters: 300, epoch: 2 | loss: 0.3407160
	speed: 0.0475s/iter; left time: 1928.1664s
	iters: 400, epoch: 2 | loss: 0.0126641
	speed: 0.0476s/iter; left time: 1926.9485s
Epoch: 2 cost time: 21.31176209449768
Epoch: 2, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.087 Vali Acc: 0.971 Test Loss: 0.087 Test Acc: 0.971
Validation loss decreased (-0.965438 --> -0.970895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2307167
	speed: 0.2075s/iter; left time: 8378.5657s
	iters: 200, epoch: 3 | loss: 0.0408742
	speed: 0.0457s/iter; left time: 1839.1665s
	iters: 300, epoch: 3 | loss: 0.0022307
	speed: 0.0470s/iter; left time: 1889.4514s
	iters: 400, epoch: 3 | loss: 0.0013817
	speed: 0.0507s/iter; left time: 2032.8169s
Epoch: 3 cost time: 20.90040898323059
Epoch: 3, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.058 Vali Acc: 0.980 Test Loss: 0.058 Test Acc: 0.980
Validation loss decreased (-0.970895 --> -0.979990).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0243436
	speed: 0.1845s/iter; left time: 7373.0201s
	iters: 200, epoch: 4 | loss: 0.0345011
	speed: 0.0372s/iter; left time: 1482.3202s
	iters: 300, epoch: 4 | loss: 0.0099023
	speed: 0.0389s/iter; left time: 1548.6912s
	iters: 400, epoch: 4 | loss: 0.0004672
	speed: 0.0430s/iter; left time: 1705.4963s
Epoch: 4 cost time: 16.994379997253418
Epoch: 4, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0065507
	speed: 0.2082s/iter; left time: 8234.2634s
	iters: 200, epoch: 5 | loss: 0.0007159
	speed: 0.0472s/iter; left time: 1861.4135s
	iters: 300, epoch: 5 | loss: 0.0354770
	speed: 0.0445s/iter; left time: 1751.5276s
	iters: 400, epoch: 5 | loss: 0.0362654
	speed: 0.0495s/iter; left time: 1942.2025s
Epoch: 5 cost time: 20.39927363395691
Epoch: 5, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0084564
	speed: 0.1991s/iter; left time: 7791.4168s
	iters: 200, epoch: 6 | loss: 0.0001094
	speed: 0.0480s/iter; left time: 1874.8237s
	iters: 300, epoch: 6 | loss: 0.0000325
	speed: 0.0437s/iter; left time: 1702.6323s
	iters: 400, epoch: 6 | loss: 0.0017153
	speed: 0.0537s/iter; left time: 2084.8481s
Epoch: 6 cost time: 20.58147144317627
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000154
	speed: 0.1976s/iter; left time: 7653.4464s
	iters: 200, epoch: 7 | loss: 0.0000108
	speed: 0.0477s/iter; left time: 1840.6966s
	iters: 300, epoch: 7 | loss: 0.0111915
	speed: 0.0441s/iter; left time: 1699.3719s
	iters: 400, epoch: 7 | loss: 0.0012425
	speed: 0.0407s/iter; left time: 1563.8133s
Epoch: 7 cost time: 18.637818574905396
Epoch: 7, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000036
	speed: 0.2031s/iter; left time: 7779.2657s
	iters: 200, epoch: 8 | loss: 0.1290579
	speed: 0.0461s/iter; left time: 1760.2801s
	iters: 300, epoch: 8 | loss: 0.0299148
	speed: 0.0466s/iter; left time: 1776.9947s
	iters: 400, epoch: 8 | loss: 0.0000765
	speed: 0.0474s/iter; left time: 1800.5779s
Epoch: 8 cost time: 20.44586443901062
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0001794
	speed: 0.2212s/iter; left time: 8384.6130s
	iters: 200, epoch: 9 | loss: 0.0514279
	speed: 0.0530s/iter; left time: 2004.7125s
	iters: 300, epoch: 9 | loss: 0.0002364
	speed: 0.0555s/iter; left time: 2091.6400s
	iters: 400, epoch: 9 | loss: 0.0000474
	speed: 0.0527s/iter; left time: 1979.9497s
Epoch: 9 cost time: 22.810612201690674
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000280
	speed: 0.2157s/iter; left time: 8084.3429s
	iters: 200, epoch: 10 | loss: 0.0003229
	speed: 0.0416s/iter; left time: 1556.7528s
	iters: 300, epoch: 10 | loss: 0.0048926
	speed: 0.0441s/iter; left time: 1646.0273s
	iters: 400, epoch: 10 | loss: 0.0000068
	speed: 0.0520s/iter; left time: 1933.3153s
Epoch: 10 cost time: 19.750422954559326
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000005
	speed: 0.2263s/iter; left time: 8389.9647s
	iters: 200, epoch: 11 | loss: 0.0001856
	speed: 0.0446s/iter; left time: 1647.1001s
	iters: 300, epoch: 11 | loss: 0.2959936
	speed: 0.0468s/iter; left time: 1725.5293s
	iters: 400, epoch: 11 | loss: 0.0000261
	speed: 0.0412s/iter; left time: 1515.0171s
Epoch: 11 cost time: 19.857195138931274
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000322
	speed: 0.2205s/iter; left time: 8083.4763s
	iters: 200, epoch: 12 | loss: 0.0000012
	speed: 0.0459s/iter; left time: 1679.4293s
	iters: 300, epoch: 12 | loss: 0.0000129
	speed: 0.0498s/iter; left time: 1816.7207s
	iters: 400, epoch: 12 | loss: 0.0007661
	speed: 0.0415s/iter; left time: 1507.8870s
Epoch: 12 cost time: 20.000667333602905
Epoch: 12, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.204 Vali Acc: 0.964 Test Loss: 0.204 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0177441
	speed: 0.1884s/iter; left time: 6829.8516s
	iters: 200, epoch: 13 | loss: 0.0426856
	speed: 0.0445s/iter; left time: 1608.4648s
	iters: 300, epoch: 13 | loss: 0.0417837
	speed: 0.0420s/iter; left time: 1512.9604s
	iters: 400, epoch: 13 | loss: 0.0458981
	speed: 0.0442s/iter; left time: 1587.3189s
Epoch: 13 cost time: 18.57463002204895
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 63530
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3847529
	speed: 0.0905s/iter; left time: 3728.6352s
	iters: 200, epoch: 1 | loss: 0.2344331
	speed: 0.0418s/iter; left time: 1718.1937s
	iters: 300, epoch: 1 | loss: 0.1380920
	speed: 0.0474s/iter; left time: 1943.9311s
	iters: 400, epoch: 1 | loss: 0.0194164
	speed: 0.0406s/iter; left time: 1662.0782s
Epoch: 1 cost time: 22.661147832870483
Epoch: 1, Steps: 413 | Train Loss: 0.609 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
Validation loss decreased (inf --> -0.958616).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1160101
	speed: 0.1931s/iter; left time: 7875.2325s
	iters: 200, epoch: 2 | loss: 0.0160757
	speed: 0.0507s/iter; left time: 2064.4714s
	iters: 300, epoch: 2 | loss: 0.0164338
	speed: 0.0530s/iter; left time: 2149.8425s
	iters: 400, epoch: 2 | loss: 0.1382771
	speed: 0.0523s/iter; left time: 2118.7831s
Epoch: 2 cost time: 21.60335350036621
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
Validation loss decreased (-0.958616 --> -0.969986).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0179913
	speed: 0.1993s/iter; left time: 8048.4874s
	iters: 200, epoch: 3 | loss: 0.0034020
	speed: 0.0424s/iter; left time: 1709.5917s
	iters: 300, epoch: 3 | loss: 0.0390158
	speed: 0.0494s/iter; left time: 1986.0821s
	iters: 400, epoch: 3 | loss: 0.0554045
	speed: 0.0492s/iter; left time: 1973.6130s
Epoch: 3 cost time: 20.215620517730713
Epoch: 3, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.068 Vali Acc: 0.976 Test Loss: 0.068 Test Acc: 0.976
Validation loss decreased (-0.969986 --> -0.976352).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0081425
	speed: 0.2207s/iter; left time: 8821.3841s
	iters: 200, epoch: 4 | loss: 0.0021704
	speed: 0.0512s/iter; left time: 2040.6679s
	iters: 300, epoch: 4 | loss: 0.0005648
	speed: 0.0511s/iter; left time: 2031.8581s
	iters: 400, epoch: 4 | loss: 0.0000596
	speed: 0.0465s/iter; left time: 1843.8142s
Epoch: 4 cost time: 21.150014400482178
Epoch: 4, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.068 Vali Acc: 0.978 Test Loss: 0.068 Test Acc: 0.978
Validation loss decreased (-0.976352 --> -0.977716).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0110759
	speed: 0.2201s/iter; left time: 8703.6968s
	iters: 200, epoch: 5 | loss: 0.0028220
	speed: 0.0423s/iter; left time: 1666.8128s
	iters: 300, epoch: 5 | loss: 0.0016946
	speed: 0.0436s/iter; left time: 1717.4301s
	iters: 400, epoch: 5 | loss: 0.1592767
	speed: 0.0522s/iter; left time: 2049.5730s
Epoch: 5 cost time: 19.952154397964478
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0001465
	speed: 0.2255s/iter; left time: 8827.1064s
	iters: 200, epoch: 6 | loss: 0.0001841
	speed: 0.0508s/iter; left time: 1982.2675s
	iters: 300, epoch: 6 | loss: 0.0004049
	speed: 0.0457s/iter; left time: 1780.0396s
	iters: 400, epoch: 6 | loss: 0.0000890
	speed: 0.0477s/iter; left time: 1850.8325s
Epoch: 6 cost time: 20.935261249542236
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0008413
	speed: 0.2394s/iter; left time: 9270.8058s
	iters: 200, epoch: 7 | loss: 0.0149274
	speed: 0.0505s/iter; left time: 1948.9627s
	iters: 300, epoch: 7 | loss: 0.1551743
	speed: 0.0467s/iter; left time: 1797.8438s
	iters: 400, epoch: 7 | loss: 0.0010612
	speed: 0.0495s/iter; left time: 1901.8739s
Epoch: 7 cost time: 21.389575481414795
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000106
	speed: 0.2113s/iter; left time: 8094.1674s
	iters: 200, epoch: 8 | loss: 0.0277338
	speed: 0.0452s/iter; left time: 1726.0228s
	iters: 300, epoch: 8 | loss: 0.0168251
	speed: 0.0436s/iter; left time: 1663.4756s
	iters: 400, epoch: 8 | loss: 0.0000860
	speed: 0.0454s/iter; left time: 1726.4811s
Epoch: 8 cost time: 19.5668888092041
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1229550
	speed: 0.2164s/iter; left time: 8201.5804s
	iters: 200, epoch: 9 | loss: 0.0661704
	speed: 0.0548s/iter; left time: 2070.4435s
	iters: 300, epoch: 9 | loss: 0.0006215
	speed: 0.0531s/iter; left time: 2001.9654s
	iters: 400, epoch: 9 | loss: 0.0011073
	speed: 0.0611s/iter; left time: 2296.2416s
Epoch: 9 cost time: 23.576762914657593
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0103666
	speed: 0.2207s/iter; left time: 8272.7992s
	iters: 200, epoch: 10 | loss: 0.0069047
	speed: 0.0455s/iter; left time: 1701.0859s
	iters: 300, epoch: 10 | loss: 0.0000847
	speed: 0.0581s/iter; left time: 2164.8278s
	iters: 400, epoch: 10 | loss: 0.0028164
	speed: 0.0500s/iter; left time: 1858.7102s
Epoch: 10 cost time: 22.174504041671753
Epoch: 10, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.2416728
	speed: 0.2244s/iter; left time: 8319.9990s
	iters: 200, epoch: 11 | loss: 0.0009106
	speed: 0.0476s/iter; left time: 1758.6620s
	iters: 300, epoch: 11 | loss: 0.0003485
	speed: 0.0525s/iter; left time: 1935.6293s
	iters: 400, epoch: 11 | loss: 0.0000181
	speed: 0.0467s/iter; left time: 1718.0358s
Epoch: 11 cost time: 21.60692310333252
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.977716 --> -0.978171).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000037
	speed: 0.2474s/iter; left time: 9069.1234s
	iters: 200, epoch: 12 | loss: 0.0006592
	speed: 0.0461s/iter; left time: 1683.9986s
	iters: 300, epoch: 12 | loss: 0.0000096
	speed: 0.0454s/iter; left time: 1654.7262s
	iters: 400, epoch: 12 | loss: 0.0000635
	speed: 0.0465s/iter; left time: 1692.4087s
Epoch: 12 cost time: 20.89397096633911
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.978171 --> -0.980445).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0002678
	speed: 0.2304s/iter; left time: 8349.8635s
	iters: 200, epoch: 13 | loss: 0.0000020
	speed: 0.0463s/iter; left time: 1672.4423s
	iters: 300, epoch: 13 | loss: 0.0000977
	speed: 0.0487s/iter; left time: 1756.7416s
	iters: 400, epoch: 13 | loss: 0.0000007
	speed: 0.0457s/iter; left time: 1643.9751s
Epoch: 13 cost time: 19.930456399917603
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000044
	speed: 0.2252s/iter; left time: 8068.9954s
	iters: 200, epoch: 14 | loss: 0.0000100
	speed: 0.0393s/iter; left time: 1404.0655s
	iters: 300, epoch: 14 | loss: 0.0000507
	speed: 0.0442s/iter; left time: 1576.2288s
	iters: 400, epoch: 14 | loss: 0.0096243
	speed: 0.0485s/iter; left time: 1721.7072s
Epoch: 14 cost time: 19.628453254699707
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000090
	speed: 0.2230s/iter; left time: 7898.9149s
	iters: 200, epoch: 15 | loss: 0.0044859
	speed: 0.0533s/iter; left time: 1882.3097s
	iters: 300, epoch: 15 | loss: 0.0062014
	speed: 0.0452s/iter; left time: 1590.4859s
	iters: 400, epoch: 15 | loss: 0.0052774
	speed: 0.0489s/iter; left time: 1718.9585s
Epoch: 15 cost time: 21.239582777023315
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000005
	speed: 0.2288s/iter; left time: 8008.3777s
	iters: 200, epoch: 16 | loss: 0.0007660
	speed: 0.0417s/iter; left time: 1455.2868s
	iters: 300, epoch: 16 | loss: 0.0000014
	speed: 0.0426s/iter; left time: 1483.0772s
	iters: 400, epoch: 16 | loss: 0.0000012
	speed: 0.0438s/iter; left time: 1521.5615s
Epoch: 16 cost time: 19.081799030303955
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000075
	speed: 0.2161s/iter; left time: 7476.4431s
	iters: 200, epoch: 17 | loss: 0.0000004
	speed: 0.0432s/iter; left time: 1489.8451s
	iters: 300, epoch: 17 | loss: 0.0398503
	speed: 0.0443s/iter; left time: 1522.6414s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 1574.4920s
Epoch: 17 cost time: 19.89712643623352
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0052044
	speed: 0.2084s/iter; left time: 7121.4117s
	iters: 200, epoch: 18 | loss: 0.0000414
	speed: 0.0454s/iter; left time: 1548.7474s
	iters: 300, epoch: 18 | loss: 0.0000095
	speed: 0.0472s/iter; left time: 1604.1405s
	iters: 400, epoch: 18 | loss: 0.0000112
	speed: 0.0441s/iter; left time: 1492.6295s
Epoch: 18 cost time: 20.150310754776
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000003
	speed: 0.2109s/iter; left time: 7122.1922s
	iters: 200, epoch: 19 | loss: 0.0000033
	speed: 0.0465s/iter; left time: 1564.6965s
	iters: 300, epoch: 19 | loss: 0.0033516
	speed: 0.0467s/iter; left time: 1566.0930s
	iters: 400, epoch: 19 | loss: 0.0000271
	speed: 0.0534s/iter; left time: 1788.5059s
Epoch: 19 cost time: 20.83634901046753
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.125 Vali Acc: 0.983 Test Loss: 0.125 Test Acc: 0.983
Validation loss decreased (-0.980445 --> -0.982718).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0027097
	speed: 0.2052s/iter; left time: 6843.4589s
	iters: 200, epoch: 20 | loss: 0.0000004
	speed: 0.0527s/iter; left time: 1753.6757s
	iters: 300, epoch: 20 | loss: 0.0006557
	speed: 0.0447s/iter; left time: 1481.5933s
	iters: 400, epoch: 20 | loss: 0.7049470
	speed: 0.0495s/iter; left time: 1635.3939s
Epoch: 20 cost time: 20.867896795272827
Epoch: 20, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000039
	speed: 0.2153s/iter; left time: 7093.0252s
	iters: 200, epoch: 21 | loss: 0.0624459
	speed: 0.0449s/iter; left time: 1473.4189s
	iters: 300, epoch: 21 | loss: 0.0000029
	speed: 0.0445s/iter; left time: 1455.4620s
	iters: 400, epoch: 21 | loss: 0.0000012
	speed: 0.0413s/iter; left time: 1348.3972s
Epoch: 21 cost time: 19.449981451034546
Epoch: 21, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0440347
	speed: 0.2152s/iter; left time: 6998.9031s
	iters: 200, epoch: 22 | loss: 0.0000175
	speed: 0.0429s/iter; left time: 1391.2411s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.0444s/iter; left time: 1435.0171s
	iters: 400, epoch: 22 | loss: 0.0000975
	speed: 0.0474s/iter; left time: 1526.4345s
Epoch: 22 cost time: 19.57649278640747
Epoch: 22, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.152 Vali Acc: 0.979 Test Loss: 0.152 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0002838
	speed: 0.1923s/iter; left time: 6174.1536s
	iters: 200, epoch: 23 | loss: 0.0000165
	speed: 0.0452s/iter; left time: 1446.3336s
	iters: 300, epoch: 23 | loss: 0.0004173
	speed: 0.0478s/iter; left time: 1526.7261s
	iters: 400, epoch: 23 | loss: 0.0033551
	speed: 0.0455s/iter; left time: 1446.2023s
Epoch: 23 cost time: 19.838746309280396
Epoch: 23, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0228603
	speed: 0.2014s/iter; left time: 6385.3176s
	iters: 200, epoch: 24 | loss: 0.0000023
	speed: 0.0389s/iter; left time: 1229.2322s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.0393s/iter; left time: 1236.9429s
	iters: 400, epoch: 24 | loss: 0.0000053
	speed: 0.0385s/iter; left time: 1210.2485s
Epoch: 24 cost time: 17.058324575424194
Epoch: 24, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.214 Vali Acc: 0.978 Test Loss: 0.214 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0004988
	speed: 0.1993s/iter; left time: 6236.4730s
	iters: 200, epoch: 25 | loss: 0.0001772
	speed: 0.0458s/iter; left time: 1430.0102s
	iters: 300, epoch: 25 | loss: 0.0000248
	speed: 0.0470s/iter; left time: 1462.5700s
	iters: 400, epoch: 25 | loss: 0.0000117
	speed: 0.0418s/iter; left time: 1293.8443s
Epoch: 25 cost time: 19.663676023483276
Epoch: 25, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.157 Vali Acc: 0.977 Test Loss: 0.157 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0737320
	speed: 0.2134s/iter; left time: 6587.4333s
	iters: 200, epoch: 26 | loss: 0.0009370
	speed: 0.0498s/iter; left time: 1531.1435s
	iters: 300, epoch: 26 | loss: 0.0001746
	speed: 0.0453s/iter; left time: 1388.8570s
	iters: 400, epoch: 26 | loss: 0.0000995
	speed: 0.0438s/iter; left time: 1339.6551s
Epoch: 26 cost time: 20.47089719772339
Epoch: 26, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.172 Vali Acc: 0.979 Test Loss: 0.172 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2054s/iter; left time: 6256.3267s
	iters: 200, epoch: 27 | loss: 0.0264062
	speed: 0.0426s/iter; left time: 1293.7171s
	iters: 300, epoch: 27 | loss: 0.0000086
	speed: 0.0429s/iter; left time: 1297.3739s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 1321.5073s
Epoch: 27 cost time: 19.16512393951416
Epoch: 27, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.169 Vali Acc: 0.977 Test Loss: 0.169 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2272s/iter; left time: 6828.3907s
	iters: 200, epoch: 28 | loss: 0.0045134
	speed: 0.0415s/iter; left time: 1243.1892s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0409s/iter; left time: 1220.7594s
	iters: 400, epoch: 28 | loss: 0.0000005
	speed: 0.0425s/iter; left time: 1263.3225s
Epoch: 28 cost time: 19.168092250823975
Epoch: 28, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.978 Test Loss: 0.192 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000027
	speed: 0.2066s/iter; left time: 6122.4233s
	iters: 200, epoch: 29 | loss: 0.0034724
	speed: 0.0432s/iter; left time: 1275.4115s
	iters: 300, epoch: 29 | loss: 0.0000059
	speed: 0.0390s/iter; left time: 1146.6570s
	iters: 400, epoch: 29 | loss: 0.0000040
	speed: 0.0409s/iter; left time: 1199.5476s
Epoch: 29 cost time: 18.41540217399597
Epoch: 29, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.211 Vali Acc: 0.972 Test Loss: 0.211 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 55370
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2943671
	speed: 0.0877s/iter; left time: 3611.9854s
	iters: 200, epoch: 1 | loss: 0.5610615
	speed: 0.0532s/iter; left time: 2188.3166s
	iters: 300, epoch: 1 | loss: 0.0115015
	speed: 0.0506s/iter; left time: 2076.1144s
	iters: 400, epoch: 1 | loss: 0.2749498
	speed: 0.0506s/iter; left time: 2069.1692s
Epoch: 1 cost time: 24.870075702667236
Epoch: 1, Steps: 413 | Train Loss: 0.399 Vali Loss: 0.187 Vali Acc: 0.953 Test Loss: 0.187 Test Acc: 0.953
Validation loss decreased (inf --> -0.952704).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1209171
	speed: 0.2367s/iter; left time: 9655.0137s
	iters: 200, epoch: 2 | loss: 0.0558775
	speed: 0.0669s/iter; left time: 2721.6214s
	iters: 300, epoch: 2 | loss: 0.2027925
	speed: 0.0644s/iter; left time: 2613.9820s
	iters: 400, epoch: 2 | loss: 0.0994014
	speed: 0.0645s/iter; left time: 2611.5726s
Epoch: 2 cost time: 28.808714389801025
Epoch: 2, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.232 Vali Acc: 0.952 Test Loss: 0.232 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0001082
	speed: 0.2221s/iter; left time: 8967.3959s
	iters: 200, epoch: 3 | loss: 0.0075059
	speed: 0.0488s/iter; left time: 1967.3557s
	iters: 300, epoch: 3 | loss: 0.0001003
	speed: 0.0480s/iter; left time: 1930.1818s
	iters: 400, epoch: 3 | loss: 0.2468211
	speed: 0.0489s/iter; left time: 1959.4197s
Epoch: 3 cost time: 21.260978937149048
Epoch: 3, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.276 Vali Acc: 0.956 Test Loss: 0.276 Test Acc: 0.956
Validation loss decreased (-0.952704 --> -0.955886).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0150922
	speed: 0.2296s/iter; left time: 9173.7233s
	iters: 200, epoch: 4 | loss: 0.0139167
	speed: 0.0570s/iter; left time: 2274.0933s
	iters: 300, epoch: 4 | loss: 0.0002027
	speed: 0.0565s/iter; left time: 2245.3671s
	iters: 400, epoch: 4 | loss: 0.0012700
	speed: 0.0535s/iter; left time: 2120.2410s
Epoch: 4 cost time: 23.52814269065857
Epoch: 4, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.359 Vali Acc: 0.956 Test Loss: 0.359 Test Acc: 0.956
Validation loss decreased (-0.955886 --> -0.956340).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8012837
	speed: 0.2328s/iter; left time: 9205.8096s
	iters: 200, epoch: 5 | loss: 0.0297131
	speed: 0.0595s/iter; left time: 2347.3555s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 2160.0714s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1923.6467s
Epoch: 5 cost time: 23.29964303970337
Epoch: 5, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.295 Vali Acc: 0.966 Test Loss: 0.295 Test Acc: 0.966
Validation loss decreased (-0.956340 --> -0.966345).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3623308
	speed: 0.2347s/iter; left time: 9187.1264s
	iters: 200, epoch: 6 | loss: 0.0000002
	speed: 0.0532s/iter; left time: 2075.8689s
	iters: 300, epoch: 6 | loss: 0.0000244
	speed: 0.0616s/iter; left time: 2397.6685s
	iters: 400, epoch: 6 | loss: 0.1364151
	speed: 0.0458s/iter; left time: 1780.3693s
Epoch: 6 cost time: 23.420472621917725
Epoch: 6, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.429 Vali Acc: 0.954 Test Loss: 0.429 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000206
	speed: 0.2275s/iter; left time: 8808.8450s
	iters: 200, epoch: 7 | loss: 0.3312930
	speed: 0.0609s/iter; left time: 2350.6643s
	iters: 300, epoch: 7 | loss: 0.0001463
	speed: 0.0575s/iter; left time: 2213.7808s
	iters: 400, epoch: 7 | loss: 0.0019253
	speed: 0.0495s/iter; left time: 1900.3587s
Epoch: 7 cost time: 24.443689346313477
Epoch: 7, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.534 Vali Acc: 0.955 Test Loss: 0.534 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000220
	speed: 0.2370s/iter; left time: 9080.9294s
	iters: 200, epoch: 8 | loss: 0.0008028
	speed: 0.0590s/iter; left time: 2255.9582s
	iters: 300, epoch: 8 | loss: 0.0000283
	speed: 0.0643s/iter; left time: 2450.0407s
	iters: 400, epoch: 8 | loss: 0.0046844
	speed: 0.0636s/iter; left time: 2415.7667s
Epoch: 8 cost time: 26.05949592590332
Epoch: 8, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.352 Vali Acc: 0.967 Test Loss: 0.352 Test Acc: 0.967
Validation loss decreased (-0.966345 --> -0.966800).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2388s/iter; left time: 9048.5599s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0700s/iter; left time: 2644.4375s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0703s/iter; left time: 2650.4320s
	iters: 400, epoch: 9 | loss: 0.0018760
	speed: 0.0577s/iter; left time: 2171.1981s
Epoch: 9 cost time: 27.709800243377686
Epoch: 9, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.231 Vali Acc: 0.973 Test Loss: 0.231 Test Acc: 0.973
Validation loss decreased (-0.966800 --> -0.972713).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000539
	speed: 0.2267s/iter; left time: 8499.4756s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0631s/iter; left time: 2357.8419s
	iters: 300, epoch: 10 | loss: 0.0000004
	speed: 0.0562s/iter; left time: 2093.6889s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0595s/iter; left time: 2212.5544s
Epoch: 10 cost time: 25.17085909843445
Epoch: 10, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.280 Vali Acc: 0.974 Test Loss: 0.280 Test Acc: 0.974
Validation loss decreased (-0.972713 --> -0.974076).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0001243
	speed: 0.2363s/iter; left time: 8760.8618s
	iters: 200, epoch: 11 | loss: 0.0000007
	speed: 0.0671s/iter; left time: 2481.7650s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0573s/iter; left time: 2112.6299s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 1937.6198s
Epoch: 11 cost time: 25.940213441848755
Epoch: 11, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.343 Vali Acc: 0.969 Test Loss: 0.343 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1194592
	speed: 0.2158s/iter; left time: 7909.8851s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 1837.2533s
	iters: 300, epoch: 12 | loss: 0.0000006
	speed: 0.0443s/iter; left time: 1614.6400s
	iters: 400, epoch: 12 | loss: 0.0055651
	speed: 0.0441s/iter; left time: 1604.7337s
Epoch: 12 cost time: 20.257670640945435
Epoch: 12, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.477 Vali Acc: 0.963 Test Loss: 0.477 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0001233
	speed: 0.2255s/iter; left time: 8171.9808s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0505s/iter; left time: 1825.8261s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 1589.1478s
	iters: 400, epoch: 13 | loss: 0.0000094
	speed: 0.0433s/iter; left time: 1557.2063s
Epoch: 13 cost time: 19.642489910125732
Epoch: 13, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.437 Vali Acc: 0.964 Test Loss: 0.437 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2164s/iter; left time: 7753.2928s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 1881.0355s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0497s/iter; left time: 1771.0290s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 1727.5677s
Epoch: 14 cost time: 21.909973859786987
Epoch: 14, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.532 Vali Acc: 0.965 Test Loss: 0.532 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2172s/iter; left time: 7692.4339s
	iters: 200, epoch: 15 | loss: 0.0004560
	speed: 0.0469s/iter; left time: 1655.7383s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 1760.5474s
	iters: 400, epoch: 15 | loss: 0.1858714
	speed: 0.0544s/iter; left time: 1909.7842s
Epoch: 15 cost time: 21.53957462310791
Epoch: 15, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.818 Vali Acc: 0.946 Test Loss: 0.818 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2188s/iter; left time: 7659.7721s
	iters: 200, epoch: 16 | loss: 0.6592978
	speed: 0.0568s/iter; left time: 1980.9335s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0622s/iter; left time: 2164.5018s
	iters: 400, epoch: 16 | loss: 0.0000172
	speed: 0.0552s/iter; left time: 1914.9176s
Epoch: 16 cost time: 24.21725630760193
Epoch: 16, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.547 Vali Acc: 0.967 Test Loss: 0.547 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2311s/iter; left time: 7995.5559s
	iters: 200, epoch: 17 | loss: 0.4315134
	speed: 0.0535s/iter; left time: 1844.9807s
	iters: 300, epoch: 17 | loss: 0.0012574
	speed: 0.0562s/iter; left time: 1933.7204s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0554s/iter; left time: 1899.5504s
Epoch: 17 cost time: 24.033368825912476
Epoch: 17, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.660 Vali Acc: 0.960 Test Loss: 0.660 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000031
	speed: 0.2211s/iter; left time: 7556.0544s
	iters: 200, epoch: 18 | loss: 0.0000049
	speed: 0.0527s/iter; left time: 1797.2384s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 1699.8028s
	iters: 400, epoch: 18 | loss: 0.1359578
	speed: 0.0514s/iter; left time: 1741.9333s
Epoch: 18 cost time: 22.521607875823975
Epoch: 18, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.818 Vali Acc: 0.951 Test Loss: 0.818 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000682
	speed: 0.2114s/iter; left time: 7139.8488s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 1883.0946s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 1658.4500s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 1741.8884s
Epoch: 19 cost time: 22.401254653930664
Epoch: 19, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.558 Vali Acc: 0.973 Test Loss: 0.558 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2141s/iter; left time: 7140.3562s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 1624.9475s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 1695.9760s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 1776.8492s
Epoch: 20 cost time: 22.112102270126343
Epoch: 20, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.664 Vali Acc: 0.964 Test Loss: 0.664 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9740791268758526
model parameter : 212778
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1401741
	speed: 0.0863s/iter; left time: 3556.6942s
	iters: 200, epoch: 1 | loss: 0.0401070
	speed: 0.0508s/iter; left time: 2086.9986s
	iters: 300, epoch: 1 | loss: 0.0845455
	speed: 0.0433s/iter; left time: 1777.2085s
	iters: 400, epoch: 1 | loss: 0.4453019
	speed: 0.0445s/iter; left time: 1821.9435s
Epoch: 1 cost time: 23.172426462173462
Epoch: 1, Steps: 413 | Train Loss: 0.356 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (inf --> -0.961799).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0242677
	speed: 0.1998s/iter; left time: 8150.7804s
	iters: 200, epoch: 2 | loss: 0.1618273
	speed: 0.0387s/iter; left time: 1573.3356s
	iters: 300, epoch: 2 | loss: 0.0207412
	speed: 0.0477s/iter; left time: 1935.7747s
	iters: 400, epoch: 2 | loss: 0.0006229
	speed: 0.0526s/iter; left time: 2129.5606s
Epoch: 2 cost time: 19.80610942840576
Epoch: 2, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
Validation loss decreased (-0.961799 --> -0.968166).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0300069
	speed: 0.2241s/iter; left time: 9046.6734s
	iters: 200, epoch: 3 | loss: 0.0066692
	speed: 0.0468s/iter; left time: 1886.2769s
	iters: 300, epoch: 3 | loss: 0.1024095
	speed: 0.0600s/iter; left time: 2409.7753s
	iters: 400, epoch: 3 | loss: 0.0020258
	speed: 0.0632s/iter; left time: 2533.3905s
Epoch: 3 cost time: 24.36185622215271
Epoch: 3, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.336 Vali Acc: 0.945 Test Loss: 0.336 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0049455
	speed: 0.2256s/iter; left time: 9016.0919s
	iters: 200, epoch: 4 | loss: 0.0720658
	speed: 0.0607s/iter; left time: 2420.1748s
	iters: 300, epoch: 4 | loss: 0.0000055
	speed: 0.0648s/iter; left time: 2577.5953s
	iters: 400, epoch: 4 | loss: 0.0000195
	speed: 0.0613s/iter; left time: 2430.2008s
Epoch: 4 cost time: 26.342545747756958
Epoch: 4, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.202 Vali Acc: 0.960 Test Loss: 0.202 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0583207
	speed: 0.2136s/iter; left time: 8448.1230s
	iters: 200, epoch: 5 | loss: 0.0002134
	speed: 0.0439s/iter; left time: 1732.5212s
	iters: 300, epoch: 5 | loss: 0.0000645
	speed: 0.0497s/iter; left time: 1956.4562s
	iters: 400, epoch: 5 | loss: 0.0017332
	speed: 0.0559s/iter; left time: 2193.5548s
Epoch: 5 cost time: 21.559910535812378
Epoch: 5, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.281 Vali Acc: 0.963 Test Loss: 0.281 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0007278
	speed: 0.2276s/iter; left time: 8906.4732s
	iters: 200, epoch: 6 | loss: 0.0027296
	speed: 0.0520s/iter; left time: 2028.8539s
	iters: 300, epoch: 6 | loss: 0.1906682
	speed: 0.0509s/iter; left time: 1982.1086s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 2205.1623s
Epoch: 6 cost time: 22.643580436706543
Epoch: 6, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.193 Vali Acc: 0.969 Test Loss: 0.193 Test Acc: 0.969
Validation loss decreased (-0.968166 --> -0.969075).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0674529
	speed: 0.2085s/iter; left time: 8072.2979s
	iters: 200, epoch: 7 | loss: 0.0000017
	speed: 0.0466s/iter; left time: 1798.7656s
	iters: 300, epoch: 7 | loss: 0.0337552
	speed: 0.0416s/iter; left time: 1601.9826s
	iters: 400, epoch: 7 | loss: 0.0004475
	speed: 0.0442s/iter; left time: 1696.9218s
Epoch: 7 cost time: 19.514207363128662
Epoch: 7, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.257 Vali Acc: 0.970 Test Loss: 0.257 Test Acc: 0.970
Validation loss decreased (-0.969075 --> -0.969984).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000697
	speed: 0.1971s/iter; left time: 7551.3901s
	iters: 200, epoch: 8 | loss: 0.0000001
	speed: 0.0404s/iter; left time: 1544.5206s
	iters: 300, epoch: 8 | loss: 0.0005612
	speed: 0.0430s/iter; left time: 1640.4966s
	iters: 400, epoch: 8 | loss: 0.0000004
	speed: 0.0452s/iter; left time: 1719.5629s
Epoch: 8 cost time: 18.856719493865967
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.441 Vali Acc: 0.959 Test Loss: 0.441 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.2115s/iter; left time: 8016.4655s
	iters: 200, epoch: 9 | loss: 0.2561305
	speed: 0.0485s/iter; left time: 1834.9915s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0587s/iter; left time: 2212.1452s
	iters: 400, epoch: 9 | loss: 0.5402458
	speed: 0.0454s/iter; left time: 1708.7340s
Epoch: 9 cost time: 22.170114755630493
Epoch: 9, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.338 Vali Acc: 0.965 Test Loss: 0.338 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1364493
	speed: 0.2142s/iter; left time: 8028.9882s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.0439s/iter; left time: 1639.5512s
	iters: 300, epoch: 10 | loss: 0.0075618
	speed: 0.0471s/iter; left time: 1756.2416s
	iters: 400, epoch: 10 | loss: 0.0159313
	speed: 0.0439s/iter; left time: 1631.1235s
Epoch: 10 cost time: 20.67706060409546
Epoch: 10, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.262 Vali Acc: 0.970 Test Loss: 0.262 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2349s/iter; left time: 8707.7850s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0557s/iter; left time: 2059.7721s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0683s/iter; left time: 2519.1433s
	iters: 400, epoch: 11 | loss: 0.0000022
	speed: 0.0596s/iter; left time: 2192.0664s
Epoch: 11 cost time: 25.762621879577637
Epoch: 11, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.286 Vali Acc: 0.973 Test Loss: 0.286 Test Acc: 0.973
Validation loss decreased (-0.969984 --> -0.973167).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0842394
	speed: 0.2338s/iter; left time: 8570.2178s
	iters: 200, epoch: 12 | loss: 0.0001929
	speed: 0.0546s/iter; left time: 1997.3692s
	iters: 300, epoch: 12 | loss: 0.0000034
	speed: 0.0557s/iter; left time: 2029.5963s
	iters: 400, epoch: 12 | loss: 0.5473403
	speed: 0.0566s/iter; left time: 2059.5127s
Epoch: 12 cost time: 23.93281316757202
Epoch: 12, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.283 Vali Acc: 0.973 Test Loss: 0.283 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2338s/iter; left time: 8473.8248s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0704s/iter; left time: 2543.7063s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 2475.3867s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 1970.9298s
Epoch: 13 cost time: 26.498657941818237
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.389 Vali Acc: 0.967 Test Loss: 0.389 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2210s/iter; left time: 7920.3438s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 2084.3180s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 1856.4909s
	iters: 400, epoch: 14 | loss: 0.0000525
	speed: 0.0454s/iter; left time: 1611.5652s
Epoch: 14 cost time: 23.198129415512085
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.308 Vali Acc: 0.972 Test Loss: 0.308 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.1148553
	speed: 0.2238s/iter; left time: 7926.9556s
	iters: 200, epoch: 15 | loss: 0.4157537
	speed: 0.0531s/iter; left time: 1875.0646s
	iters: 300, epoch: 15 | loss: 0.0000034
	speed: 0.0470s/iter; left time: 1655.1323s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1779.7780s
Epoch: 15 cost time: 21.24536943435669
Epoch: 15, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.498 Vali Acc: 0.964 Test Loss: 0.498 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0371175
	speed: 0.2272s/iter; left time: 7952.7413s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 1779.1745s
	iters: 300, epoch: 16 | loss: 0.4083035
	speed: 0.0482s/iter; left time: 1679.1443s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 1655.1879s
Epoch: 16 cost time: 20.804030895233154
Epoch: 16, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.324 Vali Acc: 0.973 Test Loss: 0.324 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2152s/iter; left time: 7442.9048s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1632.8129s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 1439.2946s
	iters: 400, epoch: 17 | loss: 0.0012783
	speed: 0.0477s/iter; left time: 1634.6018s
Epoch: 17 cost time: 19.754931449890137
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.385 Vali Acc: 0.970 Test Loss: 0.385 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000004
	speed: 0.2077s/iter; left time: 7100.8601s
	iters: 200, epoch: 18 | loss: 0.0000757
	speed: 0.0513s/iter; left time: 1748.1682s
	iters: 300, epoch: 18 | loss: 0.0000010
	speed: 0.0535s/iter; left time: 1817.4198s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 1866.3625s
Epoch: 18 cost time: 22.98607850074768
Epoch: 18, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.429 Vali Acc: 0.969 Test Loss: 0.429 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2292s/iter; left time: 7741.0537s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0659s/iter; left time: 2220.1865s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0661s/iter; left time: 2218.0486s
	iters: 400, epoch: 19 | loss: 0.3340108
	speed: 0.0621s/iter; left time: 2079.6530s
Epoch: 19 cost time: 28.286069631576538
Epoch: 19, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.548 Vali Acc: 0.965 Test Loss: 0.548 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2507s/iter; left time: 8361.3671s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 1942.2392s
	iters: 300, epoch: 20 | loss: 0.0000201
	speed: 0.0676s/iter; left time: 2240.9802s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0564s/iter; left time: 1862.7025s
Epoch: 20 cost time: 26.78830599784851
Epoch: 20, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.407 Vali Acc: 0.970 Test Loss: 0.407 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000053
	speed: 0.2389s/iter; left time: 7870.6024s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0642s/iter; left time: 2110.0096s
	iters: 300, epoch: 21 | loss: 0.5245844
	speed: 0.0581s/iter; left time: 1902.7727s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0634s/iter; left time: 2069.9506s
Epoch: 21 cost time: 26.15488910675049
Epoch: 21, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.438 Vali Acc: 0.968 Test Loss: 0.438 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9731696225557072
model parameter : 146282
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1650782
	speed: 0.0787s/iter; left time: 3241.3677s
	iters: 200, epoch: 1 | loss: 0.0451770
	speed: 0.0416s/iter; left time: 1708.7131s
	iters: 300, epoch: 1 | loss: 1.3710910
	speed: 0.0552s/iter; left time: 2262.9527s
	iters: 400, epoch: 1 | loss: 0.0233376
	speed: 0.0660s/iter; left time: 2698.4753s
Epoch: 1 cost time: 25.235869646072388
Epoch: 1, Steps: 413 | Train Loss: 0.421 Vali Loss: 0.126 Vali Acc: 0.956 Test Loss: 0.126 Test Acc: 0.956
Validation loss decreased (inf --> -0.956343).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0530346
	speed: 0.2305s/iter; left time: 9402.1954s
	iters: 200, epoch: 2 | loss: 0.3059354
	speed: 0.0448s/iter; left time: 1823.7275s
	iters: 300, epoch: 2 | loss: 0.0044179
	speed: 0.0511s/iter; left time: 2073.0430s
	iters: 400, epoch: 2 | loss: 0.0317705
	speed: 0.0477s/iter; left time: 1930.3423s
Epoch: 2 cost time: 20.496176958084106
Epoch: 2, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
Validation loss decreased (-0.956343 --> -0.965892).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0017233
	speed: 0.2438s/iter; left time: 9845.2220s
	iters: 200, epoch: 3 | loss: 0.5418402
	speed: 0.0571s/iter; left time: 2299.9063s
	iters: 300, epoch: 3 | loss: 0.0002489
	speed: 0.0462s/iter; left time: 1857.7023s
	iters: 400, epoch: 3 | loss: 0.2562776
	speed: 0.0540s/iter; left time: 2163.4217s
Epoch: 3 cost time: 22.549509048461914
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.225 Vali Acc: 0.954 Test Loss: 0.225 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2234091
	speed: 0.2427s/iter; left time: 9698.2008s
	iters: 200, epoch: 4 | loss: 0.0191963
	speed: 0.0666s/iter; left time: 2652.9578s
	iters: 300, epoch: 4 | loss: 0.0023021
	speed: 0.0579s/iter; left time: 2302.7128s
	iters: 400, epoch: 4 | loss: 0.0000558
	speed: 0.0550s/iter; left time: 2180.9567s
Epoch: 4 cost time: 26.402328491210938
Epoch: 4, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.249 Vali Acc: 0.966 Test Loss: 0.249 Test Acc: 0.966
Validation loss decreased (-0.965892 --> -0.966346).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000630
	speed: 0.2264s/iter; left time: 8955.6485s
	iters: 200, epoch: 5 | loss: 0.0000024
	speed: 0.0627s/iter; left time: 2473.1500s
	iters: 300, epoch: 5 | loss: 0.0007833
	speed: 0.0615s/iter; left time: 2418.2487s
	iters: 400, epoch: 5 | loss: 0.0016117
	speed: 0.0593s/iter; left time: 2328.4279s
Epoch: 5 cost time: 26.509493112564087
Epoch: 5, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
Validation loss decreased (-0.966346 --> -0.972259).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000089
	speed: 0.2442s/iter; left time: 9555.3493s
	iters: 200, epoch: 6 | loss: 0.0000134
	speed: 0.0661s/iter; left time: 2581.8326s
	iters: 300, epoch: 6 | loss: 0.0001778
	speed: 0.0614s/iter; left time: 2390.1998s
	iters: 400, epoch: 6 | loss: 0.0000054
	speed: 0.0586s/iter; left time: 2274.8846s
Epoch: 6 cost time: 26.810035705566406
Epoch: 6, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000055
	speed: 0.2493s/iter; left time: 9652.9442s
	iters: 200, epoch: 7 | loss: 0.0000199
	speed: 0.0656s/iter; left time: 2534.0755s
	iters: 300, epoch: 7 | loss: 0.4974477
	speed: 0.0596s/iter; left time: 2295.3669s
	iters: 400, epoch: 7 | loss: 0.7101750
	speed: 0.0564s/iter; left time: 2167.0964s
Epoch: 7 cost time: 25.34512758255005
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.236 Vali Acc: 0.965 Test Loss: 0.236 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000009
	speed: 0.2136s/iter; left time: 8181.3741s
	iters: 200, epoch: 8 | loss: 0.0000027
	speed: 0.0533s/iter; left time: 2034.8372s
	iters: 300, epoch: 8 | loss: 0.0000219
	speed: 0.0495s/iter; left time: 1887.6751s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.0565s/iter; left time: 2146.4382s
Epoch: 8 cost time: 22.346574783325195
Epoch: 8, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.277 Vali Acc: 0.967 Test Loss: 0.277 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000634
	speed: 0.2243s/iter; left time: 8501.9378s
	iters: 200, epoch: 9 | loss: 0.0130449
	speed: 0.0492s/iter; left time: 1859.0659s
	iters: 300, epoch: 9 | loss: 0.0001739
	speed: 0.0517s/iter; left time: 1948.9080s
	iters: 400, epoch: 9 | loss: 0.0000007
	speed: 0.0542s/iter; left time: 2037.4021s
Epoch: 9 cost time: 22.84827995300293
Epoch: 9, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.282 Vali Acc: 0.967 Test Loss: 0.282 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2253s/iter; left time: 8443.5751s
	iters: 200, epoch: 10 | loss: 0.1652291
	speed: 0.0459s/iter; left time: 1714.2384s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 1794.5031s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0491s/iter; left time: 1824.2541s
Epoch: 10 cost time: 20.829410076141357
Epoch: 10, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.250 Vali Acc: 0.969 Test Loss: 0.250 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000005
	speed: 0.2357s/iter; left time: 8737.0909s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 1764.4628s
	iters: 300, epoch: 11 | loss: 0.0000002
	speed: 0.0501s/iter; left time: 1845.7526s
	iters: 400, epoch: 11 | loss: 0.0266126
	speed: 0.0505s/iter; left time: 1855.8003s
Epoch: 11 cost time: 21.11183452606201
Epoch: 11, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.304 Vali Acc: 0.970 Test Loss: 0.304 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000533
	speed: 0.2282s/iter; left time: 8364.5188s
	iters: 200, epoch: 12 | loss: 0.0275673
	speed: 0.0557s/iter; left time: 2036.6811s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0542s/iter; left time: 1975.3116s
	iters: 400, epoch: 12 | loss: 0.3040103
	speed: 0.0520s/iter; left time: 1890.0990s
Epoch: 12 cost time: 23.019824266433716
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.306 Vali Acc: 0.973 Test Loss: 0.306 Test Acc: 0.973
Validation loss decreased (-0.972259 --> -0.973167).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0008016
	speed: 0.2126s/iter; left time: 7704.0337s
	iters: 200, epoch: 13 | loss: 0.0025991
	speed: 0.0516s/iter; left time: 1865.7714s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 1684.7324s
	iters: 400, epoch: 13 | loss: 0.0002275
	speed: 0.0512s/iter; left time: 1840.0991s
Epoch: 13 cost time: 21.927873611450195
Epoch: 13, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.245 Vali Acc: 0.973 Test Loss: 0.245 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2793458
	speed: 0.1921s/iter; left time: 6883.9989s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.0487s/iter; left time: 1741.1517s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 1962.3238s
	iters: 400, epoch: 14 | loss: 0.0003706
	speed: 0.0524s/iter; left time: 1861.5297s
Epoch: 14 cost time: 21.980186223983765
Epoch: 14, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.237 Vali Acc: 0.973 Test Loss: 0.237 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2188s/iter; left time: 7748.1481s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 1614.4743s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 1550.3887s
	iters: 400, epoch: 15 | loss: 0.0000703
	speed: 0.0463s/iter; left time: 1627.7243s
Epoch: 15 cost time: 19.824193000793457
Epoch: 15, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.215 Vali Acc: 0.979 Test Loss: 0.215 Test Acc: 0.979
Validation loss decreased (-0.973167 --> -0.979079).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2426152
	speed: 0.2204s/iter; left time: 7714.8271s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0486s/iter; left time: 1694.7251s
	iters: 300, epoch: 16 | loss: 0.0023997
	speed: 0.0519s/iter; left time: 1805.2701s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 1628.3183s
Epoch: 16 cost time: 20.310818433761597
Epoch: 16, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.326 Vali Acc: 0.969 Test Loss: 0.326 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2228s/iter; left time: 7705.8213s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 1677.8973s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 1778.3698s
	iters: 400, epoch: 17 | loss: 0.0000038
	speed: 0.0466s/iter; left time: 1599.3387s
Epoch: 17 cost time: 21.239405870437622
Epoch: 17, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.297 Vali Acc: 0.971 Test Loss: 0.297 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.1101058
	speed: 0.2186s/iter; left time: 7470.9205s
	iters: 200, epoch: 18 | loss: 0.0028596
	speed: 0.0486s/iter; left time: 1657.6329s
	iters: 300, epoch: 18 | loss: 0.0000031
	speed: 0.0469s/iter; left time: 1593.6640s
	iters: 400, epoch: 18 | loss: 0.0000009
	speed: 0.0528s/iter; left time: 1790.3576s
Epoch: 18 cost time: 21.338133811950684
Epoch: 18, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.165 Vali Acc: 0.982 Test Loss: 0.165 Test Acc: 0.982
Validation loss decreased (-0.979079 --> -0.981808).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0012272
	speed: 0.2109s/iter; left time: 7122.4532s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 1573.3952s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 1949.5388s
	iters: 400, epoch: 19 | loss: 0.0001708
	speed: 0.0620s/iter; left time: 2074.7670s
Epoch: 19 cost time: 23.24785351753235
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000504
	speed: 0.2636s/iter; left time: 8791.8786s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 2379.5645s
	iters: 300, epoch: 20 | loss: 0.0308148
	speed: 0.0549s/iter; left time: 1820.1337s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.0598s/iter; left time: 1977.4929s
Epoch: 20 cost time: 28.834945678710938
Epoch: 20, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.207 Vali Acc: 0.977 Test Loss: 0.207 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2376s/iter; left time: 7826.8809s
	iters: 200, epoch: 21 | loss: 0.0026106
	speed: 0.0505s/iter; left time: 1657.1087s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0542s/iter; left time: 1774.1984s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 1777.7694s
Epoch: 21 cost time: 23.02371859550476
Epoch: 21, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.341 Vali Acc: 0.969 Test Loss: 0.341 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2225s/iter; left time: 7238.6115s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 1867.7504s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0537s/iter; left time: 1734.8150s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 1680.1262s
Epoch: 22 cost time: 23.791855335235596
Epoch: 22, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.374 Vali Acc: 0.972 Test Loss: 0.374 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000146
	speed: 0.2202s/iter; left time: 7072.2991s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0537s/iter; left time: 1719.3819s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 1613.9544s
	iters: 400, epoch: 23 | loss: 0.3581165
	speed: 0.0560s/iter; left time: 1781.3939s
Epoch: 23 cost time: 22.301355600357056
Epoch: 23, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.318 Vali Acc: 0.970 Test Loss: 0.318 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2302s/iter; left time: 7298.3914s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0499s/iter; left time: 1576.2597s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1485.3758s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0471s/iter; left time: 1479.0264s
Epoch: 24 cost time: 21.237165689468384
Epoch: 24, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.278 Vali Acc: 0.974 Test Loss: 0.278 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2347s/iter; left time: 7344.7535s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 1502.5013s
	iters: 300, epoch: 25 | loss: 0.0025030
	speed: 0.0464s/iter; left time: 1443.1924s
	iters: 400, epoch: 25 | loss: 0.0000048
	speed: 0.0515s/iter; left time: 1597.2281s
Epoch: 25 cost time: 21.591142892837524
Epoch: 25, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.368 Vali Acc: 0.975 Test Loss: 0.368 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000007
	speed: 0.2129s/iter; left time: 6573.4893s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 1751.9626s
	iters: 300, epoch: 26 | loss: 0.0000035
	speed: 0.0462s/iter; left time: 1417.1073s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1444.9299s
Epoch: 26 cost time: 20.499046564102173
Epoch: 26, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.343 Vali Acc: 0.979 Test Loss: 0.343 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000001
	speed: 0.2334s/iter; left time: 7111.0751s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0558s/iter; left time: 1694.9637s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0558s/iter; left time: 1689.7952s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0607s/iter; left time: 1829.8389s
Epoch: 27 cost time: 25.172357320785522
Epoch: 27, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.293 Vali Acc: 0.979 Test Loss: 0.293 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2375s/iter; left time: 7137.2363s
	iters: 200, epoch: 28 | loss: 0.0031602
	speed: 0.0600s/iter; left time: 1797.8848s
	iters: 300, epoch: 28 | loss: 0.0000056
	speed: 0.0637s/iter; left time: 1900.9257s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0604s/iter; left time: 1796.7320s
Epoch: 28 cost time: 25.939716577529907
Epoch: 28, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.339 Vali Acc: 0.980 Test Loss: 0.339 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 113066
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1937039
	speed: 0.0815s/iter; left time: 3358.6892s
	iters: 200, epoch: 1 | loss: 0.2899304
	speed: 0.0465s/iter; left time: 1910.9687s
	iters: 300, epoch: 1 | loss: 0.0082085
	speed: 0.0427s/iter; left time: 1749.2940s
	iters: 400, epoch: 1 | loss: 0.0396053
	speed: 0.0424s/iter; left time: 1736.2156s
Epoch: 1 cost time: 21.889054775238037
Epoch: 1, Steps: 413 | Train Loss: 0.422 Vali Loss: 0.104 Vali Acc: 0.966 Test Loss: 0.104 Test Acc: 0.966
Validation loss decreased (inf --> -0.966347).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0232949
	speed: 0.1874s/iter; left time: 7644.3417s
	iters: 200, epoch: 2 | loss: 0.0176030
	speed: 0.0421s/iter; left time: 1711.9866s
	iters: 300, epoch: 2 | loss: 0.0551114
	speed: 0.0445s/iter; left time: 1806.6833s
	iters: 400, epoch: 2 | loss: 0.3696311
	speed: 0.0426s/iter; left time: 1723.5667s
Epoch: 2 cost time: 18.46400475502014
Epoch: 2, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0450992
	speed: 0.1840s/iter; left time: 7430.2724s
	iters: 200, epoch: 3 | loss: 0.0013759
	speed: 0.0413s/iter; left time: 1663.4355s
	iters: 300, epoch: 3 | loss: 0.0164664
	speed: 0.0370s/iter; left time: 1484.8722s
	iters: 400, epoch: 3 | loss: 0.0022065
	speed: 0.0388s/iter; left time: 1553.0803s
Epoch: 3 cost time: 17.608585834503174
Epoch: 3, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0005754
	speed: 0.2100s/iter; left time: 8391.7566s
	iters: 200, epoch: 4 | loss: 0.0000190
	speed: 0.0434s/iter; left time: 1731.0735s
	iters: 300, epoch: 4 | loss: 0.1183151
	speed: 0.0418s/iter; left time: 1663.5087s
	iters: 400, epoch: 4 | loss: 0.0857979
	speed: 0.0430s/iter; left time: 1705.4626s
Epoch: 4 cost time: 18.894066333770752
Epoch: 4, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.170 Vali Acc: 0.961 Test Loss: 0.170 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.1340864
	speed: 0.1993s/iter; left time: 7882.4116s
	iters: 200, epoch: 5 | loss: 0.0005159
	speed: 0.0430s/iter; left time: 1696.3968s
	iters: 300, epoch: 5 | loss: 0.0026274
	speed: 0.0500s/iter; left time: 1965.5485s
	iters: 400, epoch: 5 | loss: 0.0077443
	speed: 0.0472s/iter; left time: 1851.7234s
Epoch: 5 cost time: 20.00770878791809
Epoch: 5, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.248 Vali Acc: 0.960 Test Loss: 0.248 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0067676
	speed: 0.1833s/iter; left time: 7173.7607s
	iters: 200, epoch: 6 | loss: 0.1540496
	speed: 0.0405s/iter; left time: 1580.2996s
	iters: 300, epoch: 6 | loss: 0.0000217
	speed: 0.0401s/iter; left time: 1559.7427s
	iters: 400, epoch: 6 | loss: 0.3775479
	speed: 0.0437s/iter; left time: 1698.7328s
Epoch: 6 cost time: 17.621622562408447
Epoch: 6, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
Validation loss decreased (-0.966347 --> -0.967256).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000001
	speed: 0.1829s/iter; left time: 7082.8692s
	iters: 200, epoch: 7 | loss: 0.0000018
	speed: 0.0422s/iter; left time: 1629.4677s
	iters: 300, epoch: 7 | loss: 0.0000029
	speed: 0.0437s/iter; left time: 1682.0338s
	iters: 400, epoch: 7 | loss: 0.0000394
	speed: 0.0428s/iter; left time: 1643.1000s
Epoch: 7 cost time: 18.26746416091919
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.181 Vali Acc: 0.973 Test Loss: 0.181 Test Acc: 0.973
Validation loss decreased (-0.967256 --> -0.972713).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0001147
	speed: 0.2041s/iter; left time: 7819.6389s
	iters: 200, epoch: 8 | loss: 0.0002260
	speed: 0.0416s/iter; left time: 1589.4776s
	iters: 300, epoch: 8 | loss: 0.2635000
	speed: 0.0429s/iter; left time: 1636.5054s
	iters: 400, epoch: 8 | loss: 0.0006653
	speed: 0.0433s/iter; left time: 1644.5184s
Epoch: 8 cost time: 18.965946674346924
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.173 Vali Acc: 0.973 Test Loss: 0.173 Test Acc: 0.973
Validation loss decreased (-0.972713 --> -0.972713).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000138
	speed: 0.1854s/iter; left time: 7027.4619s
	iters: 200, epoch: 9 | loss: 0.0000050
	speed: 0.0403s/iter; left time: 1523.8802s
	iters: 300, epoch: 9 | loss: 0.0004143
	speed: 0.0468s/iter; left time: 1762.5489s
	iters: 400, epoch: 9 | loss: 0.0000012
	speed: 0.0438s/iter; left time: 1646.4223s
Epoch: 9 cost time: 18.32892632484436
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.260 Vali Acc: 0.968 Test Loss: 0.260 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0103153
	speed: 0.2002s/iter; left time: 7503.5979s
	iters: 200, epoch: 10 | loss: 0.0189486
	speed: 0.0380s/iter; left time: 1419.8038s
	iters: 300, epoch: 10 | loss: 0.0004163
	speed: 0.0427s/iter; left time: 1592.2760s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0420s/iter; left time: 1562.6403s
Epoch: 10 cost time: 17.967798948287964
Epoch: 10, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.206 Vali Acc: 0.969 Test Loss: 0.206 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0016919
	speed: 0.1894s/iter; left time: 7021.6020s
	iters: 200, epoch: 11 | loss: 0.0000544
	speed: 0.0467s/iter; left time: 1727.0074s
	iters: 300, epoch: 11 | loss: 0.0000019
	speed: 0.0436s/iter; left time: 1606.9373s
	iters: 400, epoch: 11 | loss: 0.0000331
	speed: 0.0386s/iter; left time: 1417.8366s
Epoch: 11 cost time: 18.3323917388916
Epoch: 11, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.254 Vali Acc: 0.966 Test Loss: 0.254 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000011
	speed: 0.1785s/iter; left time: 6541.7114s
	iters: 200, epoch: 12 | loss: 0.0016421
	speed: 0.0369s/iter; left time: 1348.9637s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0401s/iter; left time: 1460.8101s
	iters: 400, epoch: 12 | loss: 0.0000008
	speed: 0.0428s/iter; left time: 1556.2555s
Epoch: 12 cost time: 17.36319851875305
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.246 Vali Acc: 0.973 Test Loss: 0.246 Test Acc: 0.973
Validation loss decreased (-0.972713 --> -0.973167).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1644625
	speed: 0.1880s/iter; left time: 6813.1292s
	iters: 200, epoch: 13 | loss: 0.1363347
	speed: 0.0365s/iter; left time: 1319.6919s
	iters: 300, epoch: 13 | loss: 0.0000003
	speed: 0.0424s/iter; left time: 1530.0960s
	iters: 400, epoch: 13 | loss: 0.0000002
	speed: 0.0402s/iter; left time: 1444.9973s
Epoch: 13 cost time: 17.399301767349243
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.176 Vali Acc: 0.981 Test Loss: 0.176 Test Acc: 0.981
Validation loss decreased (-0.973167 --> -0.980899).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2004s/iter; left time: 7181.5994s
	iters: 200, epoch: 14 | loss: 0.0010205
	speed: 0.0447s/iter; left time: 1598.9442s
	iters: 300, epoch: 14 | loss: 0.0171120
	speed: 0.0461s/iter; left time: 1642.9864s
	iters: 400, epoch: 14 | loss: 0.4126250
	speed: 0.0364s/iter; left time: 1292.1266s
Epoch: 14 cost time: 18.442516088485718
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.299 Vali Acc: 0.970 Test Loss: 0.299 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0048521
	speed: 0.1782s/iter; left time: 6313.3093s
	iters: 200, epoch: 15 | loss: 0.0000156
	speed: 0.0367s/iter; left time: 1296.5730s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 1553.3701s
	iters: 400, epoch: 15 | loss: 0.3491112
	speed: 0.0476s/iter; left time: 1669.9133s
Epoch: 15 cost time: 18.533599853515625
Epoch: 15, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.385 Vali Acc: 0.965 Test Loss: 0.385 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000025
	speed: 0.1992s/iter; left time: 6973.2507s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0440s/iter; left time: 1536.9615s
	iters: 300, epoch: 16 | loss: 0.5055602
	speed: 0.0429s/iter; left time: 1493.4351s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 1501.5756s
Epoch: 16 cost time: 19.21920108795166
Epoch: 16, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.248 Vali Acc: 0.977 Test Loss: 0.248 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0001562
	speed: 0.2114s/iter; left time: 7312.0579s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1566.6971s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 1487.9607s
	iters: 400, epoch: 17 | loss: 0.0034765
	speed: 0.0422s/iter; left time: 1445.9231s
Epoch: 17 cost time: 18.960518836975098
Epoch: 17, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.323 Vali Acc: 0.971 Test Loss: 0.323 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2138s/iter; left time: 7306.1218s
	iters: 200, epoch: 18 | loss: 0.0087759
	speed: 0.0442s/iter; left time: 1506.2367s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 1411.3515s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1448.5969s
Epoch: 18 cost time: 19.2500102519989
Epoch: 18, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.361 Vali Acc: 0.973 Test Loss: 0.361 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2083s/iter; left time: 7033.9074s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 1509.6593s
	iters: 300, epoch: 19 | loss: 0.0001784
	speed: 0.0439s/iter; left time: 1472.4832s
	iters: 400, epoch: 19 | loss: 0.5513437
	speed: 0.0393s/iter; left time: 1316.0076s
Epoch: 19 cost time: 18.899834394454956
Epoch: 19, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.243 Vali Acc: 0.971 Test Loss: 0.243 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1926s/iter; left time: 6424.5296s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1429.1311s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 1582.2462s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 1524.7746s
Epoch: 20 cost time: 19.570682287216187
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.235 Vali Acc: 0.976 Test Loss: 0.235 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000002
	speed: 0.2029s/iter; left time: 6684.7001s
	iters: 200, epoch: 21 | loss: 0.0017652
	speed: 0.0410s/iter; left time: 1345.3102s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 1356.3430s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 1423.6663s
Epoch: 21 cost time: 18.489225149154663
Epoch: 21, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.165 Vali Acc: 0.979 Test Loss: 0.165 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2135s/iter; left time: 6945.6062s
	iters: 200, epoch: 22 | loss: 0.0001318
	speed: 0.0441s/iter; left time: 1430.4144s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 1542.5128s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 1549.4265s
Epoch: 22 cost time: 19.845587491989136
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.246 Vali Acc: 0.976 Test Loss: 0.246 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000624
	speed: 0.2021s/iter; left time: 6490.6128s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 1533.7463s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.0471s/iter; left time: 1504.4414s
	iters: 400, epoch: 23 | loss: 0.0000008
	speed: 0.0421s/iter; left time: 1338.6438s
Epoch: 23 cost time: 19.850030660629272
Epoch: 23, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.250 Vali Acc: 0.976 Test Loss: 0.250 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 92362
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4500472
	speed: 0.0920s/iter; left time: 3792.2313s
	iters: 200, epoch: 1 | loss: 0.0965919
	speed: 0.0492s/iter; left time: 2023.3999s
	iters: 300, epoch: 1 | loss: 0.4180270
	speed: 0.0519s/iter; left time: 2128.6638s
	iters: 400, epoch: 1 | loss: 0.1489599
	speed: 0.0474s/iter; left time: 1940.7146s
Epoch: 1 cost time: 24.624139070510864
Epoch: 1, Steps: 413 | Train Loss: 0.475 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1372648
	speed: 0.1993s/iter; left time: 8128.7848s
	iters: 200, epoch: 2 | loss: 0.0076355
	speed: 0.0557s/iter; left time: 2264.2907s
	iters: 300, epoch: 2 | loss: 0.0266973
	speed: 0.0536s/iter; left time: 2175.1750s
	iters: 400, epoch: 2 | loss: 0.4374867
	speed: 0.0522s/iter; left time: 2114.1870s
Epoch: 2 cost time: 22.40706157684326
Epoch: 2, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.140 Vali Acc: 0.950 Test Loss: 0.140 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3147509
	speed: 0.2331s/iter; left time: 9413.3775s
	iters: 200, epoch: 3 | loss: 0.0045058
	speed: 0.0502s/iter; left time: 2019.9077s
	iters: 300, epoch: 3 | loss: 0.0035673
	speed: 0.0458s/iter; left time: 1840.5177s
	iters: 400, epoch: 3 | loss: 0.0146319
	speed: 0.0416s/iter; left time: 1665.9247s
Epoch: 3 cost time: 19.001129150390625
Epoch: 3, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.057 Vali Acc: 0.979 Test Loss: 0.057 Test Acc: 0.979
Validation loss decreased (-0.957252 --> -0.979081).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0171954
	speed: 0.2160s/iter; left time: 8632.6693s
	iters: 200, epoch: 4 | loss: 0.0007323
	speed: 0.0480s/iter; left time: 1911.3884s
	iters: 300, epoch: 4 | loss: 0.2405354
	speed: 0.0513s/iter; left time: 2038.6916s
	iters: 400, epoch: 4 | loss: 0.0139013
	speed: 0.0470s/iter; left time: 1862.3076s
Epoch: 4 cost time: 21.908841371536255
Epoch: 4, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0001297
	speed: 0.2028s/iter; left time: 8019.6059s
	iters: 200, epoch: 5 | loss: 0.0062407
	speed: 0.0397s/iter; left time: 1567.3847s
	iters: 300, epoch: 5 | loss: 0.0138433
	speed: 0.0430s/iter; left time: 1690.7665s
	iters: 400, epoch: 5 | loss: 0.1956846
	speed: 0.0447s/iter; left time: 1753.0652s
Epoch: 5 cost time: 18.624226570129395
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000835
	speed: 0.2043s/iter; left time: 7996.7483s
	iters: 200, epoch: 6 | loss: 0.2182109
	speed: 0.0432s/iter; left time: 1686.1803s
	iters: 300, epoch: 6 | loss: 0.0163717
	speed: 0.0460s/iter; left time: 1792.5688s
	iters: 400, epoch: 6 | loss: 0.0002954
	speed: 0.0458s/iter; left time: 1777.4051s
Epoch: 6 cost time: 19.980653762817383
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.979535).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000636
	speed: 0.1942s/iter; left time: 7519.8537s
	iters: 200, epoch: 7 | loss: 0.0001430
	speed: 0.0434s/iter; left time: 1676.9200s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0389s/iter; left time: 1499.9055s
	iters: 400, epoch: 7 | loss: 0.0000466
	speed: 0.0364s/iter; left time: 1397.0579s
Epoch: 7 cost time: 17.586087942123413
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.180 Vali Acc: 0.962 Test Loss: 0.180 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0207297
	speed: 0.1991s/iter; left time: 7626.6372s
	iters: 200, epoch: 8 | loss: 0.0000141
	speed: 0.0519s/iter; left time: 1981.7852s
	iters: 300, epoch: 8 | loss: 0.0001051
	speed: 0.0457s/iter; left time: 1740.2938s
	iters: 400, epoch: 8 | loss: 0.0000427
	speed: 0.0465s/iter; left time: 1769.1889s
Epoch: 8 cost time: 20.978248357772827
Epoch: 8, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.185 Vali Acc: 0.964 Test Loss: 0.185 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000009
	speed: 0.2121s/iter; left time: 8038.3466s
	iters: 200, epoch: 9 | loss: 0.0001993
	speed: 0.0564s/iter; left time: 2132.8178s
	iters: 300, epoch: 9 | loss: 0.0000016
	speed: 0.0498s/iter; left time: 1878.7352s
	iters: 400, epoch: 9 | loss: 0.0000666
	speed: 0.0472s/iter; left time: 1775.7300s
Epoch: 9 cost time: 21.41331911087036
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2025s/iter; left time: 7591.4861s
	iters: 200, epoch: 10 | loss: 0.1125853
	speed: 0.0439s/iter; left time: 1641.1522s
	iters: 300, epoch: 10 | loss: 0.0000247
	speed: 0.0488s/iter; left time: 1819.1089s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0437s/iter; left time: 1623.4754s
Epoch: 10 cost time: 19.415375232696533
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0002683
	speed: 0.2156s/iter; left time: 7992.1122s
	iters: 200, epoch: 11 | loss: 0.1859240
	speed: 0.0499s/iter; left time: 1846.1799s
	iters: 300, epoch: 11 | loss: 0.0002831
	speed: 0.0517s/iter; left time: 1906.5009s
	iters: 400, epoch: 11 | loss: 0.0000093
	speed: 0.0466s/iter; left time: 1713.1229s
Epoch: 11 cost time: 21.033865690231323
Epoch: 11, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.201 Vali Acc: 0.964 Test Loss: 0.201 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000003
	speed: 0.2047s/iter; left time: 7504.9348s
	iters: 200, epoch: 12 | loss: 0.0011834
	speed: 0.0495s/iter; left time: 1811.3125s
	iters: 300, epoch: 12 | loss: 0.1420946
	speed: 0.0435s/iter; left time: 1584.9338s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 1602.6141s
Epoch: 12 cost time: 20.11669921875
Epoch: 12, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0013068
	speed: 0.1968s/iter; left time: 7131.9555s
	iters: 200, epoch: 13 | loss: 0.0000003
	speed: 0.0435s/iter; left time: 1573.1915s
	iters: 300, epoch: 13 | loss: 0.0009966
	speed: 0.0446s/iter; left time: 1606.9919s
	iters: 400, epoch: 13 | loss: 0.0002955
	speed: 0.0478s/iter; left time: 1719.2369s
Epoch: 13 cost time: 19.10848045349121
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0961039
	speed: 0.2125s/iter; left time: 7614.7214s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0466s/iter; left time: 1663.6851s
	iters: 300, epoch: 14 | loss: 0.0311069
	speed: 0.0455s/iter; left time: 1621.2698s
	iters: 400, epoch: 14 | loss: 0.0000052
	speed: 0.0402s/iter; left time: 1429.9040s
Epoch: 14 cost time: 18.849921941757202
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0064600
	speed: 0.1958s/iter; left time: 6934.4752s
	iters: 200, epoch: 15 | loss: 0.0000994
	speed: 0.0411s/iter; left time: 1452.7477s
	iters: 300, epoch: 15 | loss: 0.0097895
	speed: 0.0405s/iter; left time: 1428.0990s
	iters: 400, epoch: 15 | loss: 0.0000009
	speed: 0.0478s/iter; left time: 1678.3488s
Epoch: 15 cost time: 19.10310935974121
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.241 Vali Acc: 0.965 Test Loss: 0.241 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000325
	speed: 0.2153s/iter; left time: 7535.1708s
	iters: 200, epoch: 16 | loss: 0.0157442
	speed: 0.0502s/iter; left time: 1750.8057s
	iters: 300, epoch: 16 | loss: 0.0000003
	speed: 0.0474s/iter; left time: 1650.5167s
	iters: 400, epoch: 16 | loss: 0.0058371
	speed: 0.0445s/iter; left time: 1545.5582s
Epoch: 16 cost time: 20.694846391677856
Epoch: 16, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.227 Vali Acc: 0.968 Test Loss: 0.227 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 71690
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5230346
	speed: 0.0733s/iter; left time: 3021.2612s
	iters: 200, epoch: 1 | loss: 0.3578624
	speed: 0.0447s/iter; left time: 1836.0785s
	iters: 300, epoch: 1 | loss: 0.0946409
	speed: 0.0449s/iter; left time: 1840.3269s
	iters: 400, epoch: 1 | loss: 0.0375233
	speed: 0.0540s/iter; left time: 2207.6040s
Epoch: 1 cost time: 22.649115800857544
Epoch: 1, Steps: 413 | Train Loss: 0.511 Vali Loss: 0.109 Vali Acc: 0.958 Test Loss: 0.109 Test Acc: 0.958
Validation loss decreased (inf --> -0.957707).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0052858
	speed: 0.2412s/iter; left time: 9837.3911s
	iters: 200, epoch: 2 | loss: 0.2458022
	speed: 0.0463s/iter; left time: 1884.7800s
	iters: 300, epoch: 2 | loss: 0.2198894
	speed: 0.0537s/iter; left time: 2178.2877s
	iters: 400, epoch: 2 | loss: 0.2245584
	speed: 0.0539s/iter; left time: 2181.6788s
Epoch: 2 cost time: 22.59736657142639
Epoch: 2, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
Validation loss decreased (-0.957707 --> -0.966802).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0064671
	speed: 0.2364s/iter; left time: 9544.0567s
	iters: 200, epoch: 3 | loss: 0.0206803
	speed: 0.0470s/iter; left time: 1894.8873s
	iters: 300, epoch: 3 | loss: 0.2335519
	speed: 0.0452s/iter; left time: 1817.3078s
	iters: 400, epoch: 3 | loss: 0.2672174
	speed: 0.0522s/iter; left time: 2091.6190s
Epoch: 3 cost time: 21.53477454185486
Epoch: 3, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.112 Vali Acc: 0.966 Test Loss: 0.112 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0386025
	speed: 0.2440s/iter; left time: 9749.0827s
	iters: 200, epoch: 4 | loss: 0.0059251
	speed: 0.0432s/iter; left time: 1720.1590s
	iters: 300, epoch: 4 | loss: 0.0066360
	speed: 0.0493s/iter; left time: 1961.2207s
	iters: 400, epoch: 4 | loss: 0.0504170
	speed: 0.0509s/iter; left time: 2019.3756s
Epoch: 4 cost time: 20.86266016960144
Epoch: 4, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.966802 --> -0.968166).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000961
	speed: 0.2027s/iter; left time: 8015.5563s
	iters: 200, epoch: 5 | loss: 0.0001666
	speed: 0.0421s/iter; left time: 1658.9145s
	iters: 300, epoch: 5 | loss: 0.0007707
	speed: 0.0500s/iter; left time: 1967.4713s
	iters: 400, epoch: 5 | loss: 0.0009318
	speed: 0.0458s/iter; left time: 1795.7181s
Epoch: 5 cost time: 20.07481813430786
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.968166 --> -0.975897).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000693
	speed: 0.2169s/iter; left time: 8488.1217s
	iters: 200, epoch: 6 | loss: 0.0016793
	speed: 0.0438s/iter; left time: 1709.7865s
	iters: 300, epoch: 6 | loss: 0.0006133
	speed: 0.0394s/iter; left time: 1533.5935s
	iters: 400, epoch: 6 | loss: 0.0004448
	speed: 0.0457s/iter; left time: 1776.0803s
Epoch: 6 cost time: 19.322038650512695
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0023763
	speed: 0.2223s/iter; left time: 8608.9304s
	iters: 200, epoch: 7 | loss: 0.0053513
	speed: 0.0417s/iter; left time: 1610.8129s
	iters: 300, epoch: 7 | loss: 0.0514472
	speed: 0.0506s/iter; left time: 1949.9829s
	iters: 400, epoch: 7 | loss: 0.0000207
	speed: 0.0427s/iter; left time: 1642.2436s
Epoch: 7 cost time: 19.575859785079956
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000649
	speed: 0.2095s/iter; left time: 8024.1869s
	iters: 200, epoch: 8 | loss: 0.0000048
	speed: 0.0503s/iter; left time: 1920.9636s
	iters: 300, epoch: 8 | loss: 0.0000018
	speed: 0.0485s/iter; left time: 1846.5856s
	iters: 400, epoch: 8 | loss: 0.3792112
	speed: 0.0456s/iter; left time: 1731.4778s
Epoch: 8 cost time: 20.6537868976593
Epoch: 8, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000009
	speed: 0.2168s/iter; left time: 8215.2434s
	iters: 200, epoch: 9 | loss: 0.0268968
	speed: 0.0454s/iter; left time: 1714.6981s
	iters: 300, epoch: 9 | loss: 0.0004100
	speed: 0.0476s/iter; left time: 1794.5730s
	iters: 400, epoch: 9 | loss: 0.0002097
	speed: 0.0460s/iter; left time: 1730.6979s
Epoch: 9 cost time: 20.265279531478882
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000552
	speed: 0.2493s/iter; left time: 9346.1044s
	iters: 200, epoch: 10 | loss: 0.0000433
	speed: 0.0480s/iter; left time: 1795.6040s
	iters: 300, epoch: 10 | loss: 0.0000805
	speed: 0.0493s/iter; left time: 1837.2448s
	iters: 400, epoch: 10 | loss: 0.0050235
	speed: 0.0458s/iter; left time: 1702.5558s
Epoch: 10 cost time: 20.996599435806274
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.965 Test Loss: 0.204 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0002425
	speed: 0.2343s/iter; left time: 8685.5375s
	iters: 200, epoch: 11 | loss: 0.0112935
	speed: 0.0535s/iter; left time: 1978.5149s
	iters: 300, epoch: 11 | loss: 0.0005256
	speed: 0.0483s/iter; left time: 1780.2195s
	iters: 400, epoch: 11 | loss: 0.0000217
	speed: 0.0489s/iter; left time: 1797.4283s
Epoch: 11 cost time: 21.539961338043213
Epoch: 11, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000319
	speed: 0.2320s/iter; left time: 8502.8907s
	iters: 200, epoch: 12 | loss: 0.0001916
	speed: 0.0558s/iter; left time: 2041.1983s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 1705.1537s
	iters: 400, epoch: 12 | loss: 0.0000117
	speed: 0.0439s/iter; left time: 1595.0772s
Epoch: 12 cost time: 21.60113787651062
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0427678
	speed: 0.1898s/iter; left time: 6880.9858s
	iters: 200, epoch: 13 | loss: 0.2517816
	speed: 0.0516s/iter; left time: 1864.7410s
	iters: 300, epoch: 13 | loss: 0.0000266
	speed: 0.0523s/iter; left time: 1885.5205s
	iters: 400, epoch: 13 | loss: 0.0018672
	speed: 0.0500s/iter; left time: 1796.0830s
Epoch: 13 cost time: 21.15063762664795
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.200 Vali Acc: 0.969 Test Loss: 0.200 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000175
	speed: 0.1937s/iter; left time: 6939.7607s
	iters: 200, epoch: 14 | loss: 0.0000179
	speed: 0.0453s/iter; left time: 1617.3449s
	iters: 300, epoch: 14 | loss: 0.0006792
	speed: 0.0367s/iter; left time: 1306.8302s
	iters: 400, epoch: 14 | loss: 0.0000169
	speed: 0.0373s/iter; left time: 1323.9309s
Epoch: 14 cost time: 18.039488315582275
Epoch: 14, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.191 Vali Acc: 0.969 Test Loss: 0.191 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000709
	speed: 0.2117s/iter; left time: 7497.6670s
	iters: 200, epoch: 15 | loss: 0.2927926
	speed: 0.0403s/iter; left time: 1423.8855s
	iters: 300, epoch: 15 | loss: 0.0000898
	speed: 0.0431s/iter; left time: 1517.1705s
	iters: 400, epoch: 15 | loss: 0.0001680
	speed: 0.0470s/iter; left time: 1651.0121s
Epoch: 15 cost time: 19.943727493286133
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9758981355161437
model parameter : 55210
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4597658
	speed: 0.0849s/iter; left time: 3496.9688s
	iters: 200, epoch: 1 | loss: 0.3870228
	speed: 0.0502s/iter; left time: 2063.5781s
	iters: 300, epoch: 1 | loss: 0.1877917
	speed: 0.0530s/iter; left time: 2173.1274s
	iters: 400, epoch: 1 | loss: 0.1695543
	speed: 0.0540s/iter; left time: 2208.8306s
Epoch: 1 cost time: 25.184359073638916
Epoch: 1, Steps: 413 | Train Loss: 0.575 Vali Loss: 0.114 Vali Acc: 0.961 Test Loss: 0.114 Test Acc: 0.961
Validation loss decreased (inf --> -0.961345).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0492262
	speed: 0.2205s/iter; left time: 8991.8672s
	iters: 200, epoch: 2 | loss: 0.0850682
	speed: 0.0504s/iter; left time: 2050.1988s
	iters: 300, epoch: 2 | loss: 0.0107078
	speed: 0.0589s/iter; left time: 2389.5012s
	iters: 400, epoch: 2 | loss: 0.0985958
	speed: 0.0514s/iter; left time: 2081.3978s
Epoch: 2 cost time: 22.76144790649414
Epoch: 2, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
Validation loss decreased (-0.961345 --> -0.968167).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0019374
	speed: 0.2303s/iter; left time: 9299.9632s
	iters: 200, epoch: 3 | loss: 0.0020514
	speed: 0.0608s/iter; left time: 2448.3619s
	iters: 300, epoch: 3 | loss: 0.0285139
	speed: 0.0455s/iter; left time: 1828.1154s
	iters: 400, epoch: 3 | loss: 0.0072711
	speed: 0.0446s/iter; left time: 1788.3747s
Epoch: 3 cost time: 21.654561281204224
Epoch: 3, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.968167 --> -0.970440).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0021115
	speed: 0.2221s/iter; left time: 8876.7121s
	iters: 200, epoch: 4 | loss: 0.0179934
	speed: 0.0505s/iter; left time: 2012.3360s
	iters: 300, epoch: 4 | loss: 0.0031212
	speed: 0.0492s/iter; left time: 1954.5882s
	iters: 400, epoch: 4 | loss: 0.0015932
	speed: 0.0480s/iter; left time: 1904.1383s
Epoch: 4 cost time: 21.880831718444824
Epoch: 4, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
Validation loss decreased (-0.970440 --> -0.976352).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0024016
	speed: 0.2226s/iter; left time: 8801.7791s
	iters: 200, epoch: 5 | loss: 0.0035197
	speed: 0.0478s/iter; left time: 1887.1343s
	iters: 300, epoch: 5 | loss: 0.0049090
	speed: 0.0532s/iter; left time: 2093.4601s
	iters: 400, epoch: 5 | loss: 0.0094954
	speed: 0.0508s/iter; left time: 1994.4994s
Epoch: 5 cost time: 21.55832028388977
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0048254
	speed: 0.2269s/iter; left time: 8878.9894s
	iters: 200, epoch: 6 | loss: 0.0002285
	speed: 0.0404s/iter; left time: 1578.2461s
	iters: 300, epoch: 6 | loss: 0.1704024
	speed: 0.0550s/iter; left time: 2140.5928s
	iters: 400, epoch: 6 | loss: 0.0000360
	speed: 0.0449s/iter; left time: 1743.8470s
Epoch: 6 cost time: 20.49853825569153
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0023791
	speed: 0.2189s/iter; left time: 8474.6297s
	iters: 200, epoch: 7 | loss: 0.0667574
	speed: 0.0447s/iter; left time: 1727.6180s
	iters: 300, epoch: 7 | loss: 0.0000404
	speed: 0.0427s/iter; left time: 1646.1982s
	iters: 400, epoch: 7 | loss: 0.0163337
	speed: 0.0464s/iter; left time: 1782.5308s
Epoch: 7 cost time: 20.238547325134277
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0009313
	speed: 0.2071s/iter; left time: 7932.6952s
	iters: 200, epoch: 8 | loss: 0.0000330
	speed: 0.0529s/iter; left time: 2021.5959s
	iters: 300, epoch: 8 | loss: 0.1143128
	speed: 0.0511s/iter; left time: 1946.3073s
	iters: 400, epoch: 8 | loss: 0.0019203
	speed: 0.0489s/iter; left time: 1858.9167s
Epoch: 8 cost time: 21.241499423980713
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000730
	speed: 0.2151s/iter; left time: 8151.5399s
	iters: 200, epoch: 9 | loss: 0.0001694
	speed: 0.0463s/iter; left time: 1749.6243s
	iters: 300, epoch: 9 | loss: 0.0000595
	speed: 0.0517s/iter; left time: 1947.7628s
	iters: 400, epoch: 9 | loss: 0.0116609
	speed: 0.0485s/iter; left time: 1823.3498s
Epoch: 9 cost time: 21.042621850967407
Epoch: 9, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0001125
	speed: 0.2263s/iter; left time: 8483.9913s
	iters: 200, epoch: 10 | loss: 0.0001829
	speed: 0.0472s/iter; left time: 1762.8484s
	iters: 300, epoch: 10 | loss: 0.0053718
	speed: 0.0460s/iter; left time: 1714.3807s
	iters: 400, epoch: 10 | loss: 0.0048693
	speed: 0.0445s/iter; left time: 1655.8753s
Epoch: 10 cost time: 20.189416885375977
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000003
	speed: 0.2280s/iter; left time: 8452.6996s
	iters: 200, epoch: 11 | loss: 0.0100334
	speed: 0.0595s/iter; left time: 2198.2930s
	iters: 300, epoch: 11 | loss: 0.0001706
	speed: 0.0515s/iter; left time: 1899.5280s
	iters: 400, epoch: 11 | loss: 0.0001235
	speed: 0.0486s/iter; left time: 1787.3522s
Epoch: 11 cost time: 23.19647455215454
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0002904
	speed: 0.2254s/iter; left time: 8261.0159s
	iters: 200, epoch: 12 | loss: 0.0367022
	speed: 0.0496s/iter; left time: 1811.9932s
	iters: 300, epoch: 12 | loss: 0.0000382
	speed: 0.0484s/iter; left time: 1762.9649s
	iters: 400, epoch: 12 | loss: 0.0000010
	speed: 0.0472s/iter; left time: 1714.7131s
Epoch: 12 cost time: 21.414363145828247
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000640
	speed: 0.2147s/iter; left time: 7780.2015s
	iters: 200, epoch: 13 | loss: 0.0000402
	speed: 0.0494s/iter; left time: 1786.9486s
	iters: 300, epoch: 13 | loss: 0.0000091
	speed: 0.0494s/iter; left time: 1779.5299s
	iters: 400, epoch: 13 | loss: 0.0000148
	speed: 0.0444s/iter; left time: 1594.7292s
Epoch: 13 cost time: 20.530128479003906
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.118 Vali Acc: 0.979 Test Loss: 0.118 Test Acc: 0.979
Validation loss decreased (-0.976352 --> -0.978625).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000578
	speed: 0.2294s/iter; left time: 8219.2329s
	iters: 200, epoch: 14 | loss: 0.0022756
	speed: 0.0453s/iter; left time: 1619.1867s
	iters: 300, epoch: 14 | loss: 0.0311819
	speed: 0.0452s/iter; left time: 1609.5782s
	iters: 400, epoch: 14 | loss: 0.0001305
	speed: 0.0491s/iter; left time: 1743.0962s
Epoch: 14 cost time: 20.665919542312622
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.978625 --> -0.983173).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0013646
	speed: 0.2188s/iter; left time: 7750.4950s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0424s/iter; left time: 1498.4074s
	iters: 300, epoch: 15 | loss: 0.0000016
	speed: 0.0477s/iter; left time: 1680.1298s
	iters: 400, epoch: 15 | loss: 0.0015874
	speed: 0.0431s/iter; left time: 1513.2473s
Epoch: 15 cost time: 19.432641983032227
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.196 Vali Acc: 0.965 Test Loss: 0.196 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000006
	speed: 0.2091s/iter; left time: 7318.1819s
	iters: 200, epoch: 16 | loss: 0.0001437
	speed: 0.0411s/iter; left time: 1436.3649s
	iters: 300, epoch: 16 | loss: 0.0000020
	speed: 0.0463s/iter; left time: 1611.3444s
	iters: 400, epoch: 16 | loss: 0.0000083
	speed: 0.0493s/iter; left time: 1712.2508s
Epoch: 16 cost time: 19.983364820480347
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.179 Vali Acc: 0.966 Test Loss: 0.179 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000014
	speed: 0.2265s/iter; left time: 7837.0001s
	iters: 200, epoch: 17 | loss: 0.1587859
	speed: 0.0521s/iter; left time: 1795.7435s
	iters: 300, epoch: 17 | loss: 0.0003420
	speed: 0.0495s/iter; left time: 1701.7025s
	iters: 400, epoch: 17 | loss: 0.0000053
	speed: 0.0432s/iter; left time: 1482.2276s
Epoch: 17 cost time: 21.393258810043335
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.2180s/iter; left time: 7452.7836s
	iters: 200, epoch: 18 | loss: 0.0000040
	speed: 0.0520s/iter; left time: 1771.7980s
	iters: 300, epoch: 18 | loss: 0.0087685
	speed: 0.0572s/iter; left time: 1943.8923s
	iters: 400, epoch: 18 | loss: 0.0000210
	speed: 0.0489s/iter; left time: 1656.0876s
Epoch: 18 cost time: 22.61287832260132
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0003344
	speed: 0.2191s/iter; left time: 7399.4360s
	iters: 200, epoch: 19 | loss: 0.0000886
	speed: 0.0470s/iter; left time: 1583.5313s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0541s/iter; left time: 1816.2839s
	iters: 400, epoch: 19 | loss: 0.0002357
	speed: 0.0433s/iter; left time: 1450.5905s
Epoch: 19 cost time: 20.59933876991272
Epoch: 19, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.204 Vali Acc: 0.967 Test Loss: 0.204 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000018
	speed: 0.2215s/iter; left time: 7388.8605s
	iters: 200, epoch: 20 | loss: 0.0009010
	speed: 0.0490s/iter; left time: 1628.0770s
	iters: 300, epoch: 20 | loss: 0.0001610
	speed: 0.0472s/iter; left time: 1566.1769s
	iters: 400, epoch: 20 | loss: 0.0003385
	speed: 0.0521s/iter; left time: 1721.5038s
Epoch: 20 cost time: 21.944587230682373
Epoch: 20, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2189s/iter; left time: 7211.8824s
	iters: 200, epoch: 21 | loss: 0.0000516
	speed: 0.0474s/iter; left time: 1556.5110s
	iters: 300, epoch: 21 | loss: 0.0372530
	speed: 0.0462s/iter; left time: 1511.9473s
	iters: 400, epoch: 21 | loss: 0.0042272
	speed: 0.0472s/iter; left time: 1540.2320s
Epoch: 21 cost time: 20.03409194946289
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.228 Vali Acc: 0.972 Test Loss: 0.228 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2079s/iter; left time: 6761.4609s
	iters: 200, epoch: 22 | loss: 0.0000221
	speed: 0.0452s/iter; left time: 1466.4940s
	iters: 300, epoch: 22 | loss: 0.0001699
	speed: 0.0486s/iter; left time: 1571.3657s
	iters: 400, epoch: 22 | loss: 0.0372722
	speed: 0.0522s/iter; left time: 1682.5460s
Epoch: 22 cost time: 21.04375672340393
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.976 Test Loss: 0.161 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000438
	speed: 0.2187s/iter; left time: 7024.2772s
	iters: 200, epoch: 23 | loss: 0.0002890
	speed: 0.0430s/iter; left time: 1376.7438s
	iters: 300, epoch: 23 | loss: 0.0308445
	speed: 0.0455s/iter; left time: 1453.7025s
	iters: 400, epoch: 23 | loss: 0.0000057
	speed: 0.0634s/iter; left time: 2016.8037s
Epoch: 23 cost time: 21.427233934402466
Epoch: 23, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000207
	speed: 0.2140s/iter; left time: 6784.3416s
	iters: 200, epoch: 24 | loss: 0.0000415
	speed: 0.0483s/iter; left time: 1526.9432s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 1380.9862s
	iters: 400, epoch: 24 | loss: 0.0022076
	speed: 0.0422s/iter; left time: 1323.8371s
Epoch: 24 cost time: 19.350703954696655
Epoch: 24, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.156 Vali Acc: 0.980 Test Loss: 0.156 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm32_nh4_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 47050
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1540335
	speed: 0.0733s/iter; left time: 3021.3671s
	iters: 200, epoch: 1 | loss: 0.1512198
	speed: 0.0380s/iter; left time: 1561.0483s
	iters: 300, epoch: 1 | loss: 0.0162694
	speed: 0.0404s/iter; left time: 1657.9347s
	iters: 400, epoch: 1 | loss: 0.0077261
	speed: 0.0342s/iter; left time: 1398.3831s
Epoch: 1 cost time: 19.114851713180542
Epoch: 1, Steps: 413 | Train Loss: 0.396 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
Validation loss decreased (inf --> -0.959071).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3575411
	speed: 0.1898s/iter; left time: 7741.4539s
	iters: 200, epoch: 2 | loss: 0.0092162
	speed: 0.0449s/iter; left time: 1826.4848s
	iters: 300, epoch: 2 | loss: 0.1480833
	speed: 0.0495s/iter; left time: 2010.9280s
	iters: 400, epoch: 2 | loss: 0.0049639
	speed: 0.0461s/iter; left time: 1866.7056s
Epoch: 2 cost time: 20.53813600540161
Epoch: 2, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0432426
	speed: 0.1933s/iter; left time: 7805.1799s
	iters: 200, epoch: 3 | loss: 0.0187056
	speed: 0.0424s/iter; left time: 1708.3013s
	iters: 300, epoch: 3 | loss: 0.0003093
	speed: 0.0468s/iter; left time: 1879.9451s
	iters: 400, epoch: 3 | loss: 0.1989174
	speed: 0.0416s/iter; left time: 1667.9314s
Epoch: 3 cost time: 19.456745147705078
Epoch: 3, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
Validation loss decreased (-0.959071 --> -0.964528).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0012926
	speed: 0.1845s/iter; left time: 7373.7138s
	iters: 200, epoch: 4 | loss: 0.0000277
	speed: 0.0442s/iter; left time: 1760.0777s
	iters: 300, epoch: 4 | loss: 0.0000588
	speed: 0.0479s/iter; left time: 1903.8828s
	iters: 400, epoch: 4 | loss: 0.0014742
	speed: 0.0431s/iter; left time: 1711.3059s
Epoch: 4 cost time: 19.098161220550537
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0001567
	speed: 0.1836s/iter; left time: 7259.6272s
	iters: 200, epoch: 5 | loss: 0.0046736
	speed: 0.0401s/iter; left time: 1582.2081s
	iters: 300, epoch: 5 | loss: 0.0000761
	speed: 0.0397s/iter; left time: 1562.0639s
	iters: 400, epoch: 5 | loss: 0.0010874
	speed: 0.0404s/iter; left time: 1585.3215s
Epoch: 5 cost time: 17.39257025718689
Epoch: 5, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.187 Vali Acc: 0.965 Test Loss: 0.187 Test Acc: 0.965
Validation loss decreased (-0.964528 --> -0.964982).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0040959
	speed: 0.1980s/iter; left time: 7748.2742s
	iters: 200, epoch: 6 | loss: 0.0281664
	speed: 0.0374s/iter; left time: 1458.5587s
	iters: 300, epoch: 6 | loss: 0.1304605
	speed: 0.0405s/iter; left time: 1578.1407s
	iters: 400, epoch: 6 | loss: 0.0480677
	speed: 0.0405s/iter; left time: 1573.3355s
Epoch: 6 cost time: 18.13459825515747
Epoch: 6, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.344 Vali Acc: 0.951 Test Loss: 0.344 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000451
	speed: 0.1732s/iter; left time: 6707.6636s
	iters: 200, epoch: 7 | loss: 0.0000347
	speed: 0.0439s/iter; left time: 1696.9633s
	iters: 300, epoch: 7 | loss: 0.6040788
	speed: 0.0410s/iter; left time: 1580.5345s
	iters: 400, epoch: 7 | loss: 0.0000984
	speed: 0.0368s/iter; left time: 1413.7494s
Epoch: 7 cost time: 18.09233522415161
Epoch: 7, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.242 Vali Acc: 0.965 Test Loss: 0.242 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3833907
	speed: 0.1626s/iter; left time: 6227.8809s
	iters: 200, epoch: 8 | loss: 0.0000059
	speed: 0.0426s/iter; left time: 1629.2983s
	iters: 300, epoch: 8 | loss: 0.0000246
	speed: 0.0422s/iter; left time: 1608.9985s
	iters: 400, epoch: 8 | loss: 0.1564444
	speed: 0.0396s/iter; left time: 1504.0355s
Epoch: 8 cost time: 17.774622440338135
Epoch: 8, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
Validation loss decreased (-0.964982 --> -0.969984).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1654s/iter; left time: 6266.6796s
	iters: 200, epoch: 9 | loss: 0.0000005
	speed: 0.0368s/iter; left time: 1392.4192s
	iters: 300, epoch: 9 | loss: 0.0000141
	speed: 0.0460s/iter; left time: 1732.6874s
	iters: 400, epoch: 9 | loss: 0.0000138
	speed: 0.0389s/iter; left time: 1463.8771s
Epoch: 9 cost time: 17.605109214782715
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.224 Vali Acc: 0.964 Test Loss: 0.224 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000149
	speed: 0.1781s/iter; left time: 6675.3330s
	iters: 200, epoch: 10 | loss: 0.0564374
	speed: 0.0417s/iter; left time: 1559.9910s
	iters: 300, epoch: 10 | loss: 0.0002818
	speed: 0.0421s/iter; left time: 1568.3759s
	iters: 400, epoch: 10 | loss: 0.0002260
	speed: 0.0433s/iter; left time: 1608.3082s
Epoch: 10 cost time: 19.06391191482544
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.250 Vali Acc: 0.966 Test Loss: 0.250 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3850293
	speed: 0.1874s/iter; left time: 6947.4652s
	iters: 200, epoch: 11 | loss: 0.0000902
	speed: 0.0423s/iter; left time: 1562.1214s
	iters: 300, epoch: 11 | loss: 0.0000014
	speed: 0.0390s/iter; left time: 1437.7983s
	iters: 400, epoch: 11 | loss: 0.0185118
	speed: 0.0428s/iter; left time: 1574.5065s
Epoch: 11 cost time: 18.391863584518433
Epoch: 11, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.369 Vali Acc: 0.960 Test Loss: 0.369 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000002
	speed: 0.1866s/iter; left time: 6840.6586s
	iters: 200, epoch: 12 | loss: 0.0295852
	speed: 0.0405s/iter; left time: 1482.3617s
	iters: 300, epoch: 12 | loss: 0.0003323
	speed: 0.0445s/iter; left time: 1623.7907s
	iters: 400, epoch: 12 | loss: 0.2470503
	speed: 0.0472s/iter; left time: 1716.4887s
Epoch: 12 cost time: 18.901124715805054
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.228 Vali Acc: 0.968 Test Loss: 0.228 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000010
	speed: 0.1899s/iter; left time: 6883.5380s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 1773.1661s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 1692.0722s
	iters: 400, epoch: 13 | loss: 0.0000012
	speed: 0.0489s/iter; left time: 1757.4135s
Epoch: 13 cost time: 20.668495655059814
Epoch: 13, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.169 Vali Acc: 0.974 Test Loss: 0.169 Test Acc: 0.974
Validation loss decreased (-0.969984 --> -0.973623).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0212177
	speed: 0.1796s/iter; left time: 6436.3069s
	iters: 200, epoch: 14 | loss: 0.0001063
	speed: 0.0515s/iter; left time: 1841.6954s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0458s/iter; left time: 1632.8030s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 1592.0124s
Epoch: 14 cost time: 20.418349504470825
Epoch: 14, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.306 Vali Acc: 0.965 Test Loss: 0.306 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000041
	speed: 0.1941s/iter; left time: 6876.5951s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0455s/iter; left time: 1607.6362s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 1586.6979s
	iters: 400, epoch: 15 | loss: 0.0000005
	speed: 0.0421s/iter; left time: 1477.0723s
Epoch: 15 cost time: 19.290536403656006
Epoch: 15, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.338 Vali Acc: 0.965 Test Loss: 0.338 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000103
	speed: 0.2032s/iter; left time: 7114.2806s
	iters: 200, epoch: 16 | loss: 0.0000607
	speed: 0.0476s/iter; left time: 1661.3593s
	iters: 300, epoch: 16 | loss: 0.0000911
	speed: 0.0490s/iter; left time: 1704.2250s
	iters: 400, epoch: 16 | loss: 0.1580738
	speed: 0.0437s/iter; left time: 1517.2737s
Epoch: 16 cost time: 20.25132656097412
Epoch: 16, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.362 Vali Acc: 0.964 Test Loss: 0.362 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000003
	speed: 0.1794s/iter; left time: 6206.3576s
	iters: 200, epoch: 17 | loss: 0.5805147
	speed: 0.0399s/iter; left time: 1377.6307s
	iters: 300, epoch: 17 | loss: 0.0000324
	speed: 0.0413s/iter; left time: 1422.0065s
	iters: 400, epoch: 17 | loss: 0.0022880
	speed: 0.0415s/iter; left time: 1421.4807s
Epoch: 17 cost time: 17.43898105621338
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.324 Vali Acc: 0.965 Test Loss: 0.324 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1892s/iter; left time: 6467.1954s
	iters: 200, epoch: 18 | loss: 0.0003356
	speed: 0.0374s/iter; left time: 1274.1386s
	iters: 300, epoch: 18 | loss: 0.0000063
	speed: 0.0381s/iter; left time: 1293.3533s
	iters: 400, epoch: 18 | loss: 0.0077908
	speed: 0.0407s/iter; left time: 1379.1984s
Epoch: 18 cost time: 17.20292830467224
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.297 Vali Acc: 0.970 Test Loss: 0.297 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0004700
	speed: 0.1853s/iter; left time: 6257.7285s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0477s/iter; left time: 1605.3342s
	iters: 300, epoch: 19 | loss: 0.9721359
	speed: 0.0436s/iter; left time: 1463.4315s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0466s/iter; left time: 1560.5754s
Epoch: 19 cost time: 20.117326736450195
Epoch: 19, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.973623 --> -0.975441).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.1977s/iter; left time: 6593.2198s
	iters: 200, epoch: 20 | loss: 0.0035216
	speed: 0.0411s/iter; left time: 1365.9532s
	iters: 300, epoch: 20 | loss: 0.0000006
	speed: 0.0429s/iter; left time: 1420.9632s
	iters: 400, epoch: 20 | loss: 0.0000018
	speed: 0.0404s/iter; left time: 1334.2665s
Epoch: 20 cost time: 18.59504461288452
Epoch: 20, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.410 Vali Acc: 0.960 Test Loss: 0.410 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1921s/iter; left time: 6328.0399s
	iters: 200, epoch: 21 | loss: 0.0000020
	speed: 0.0401s/iter; left time: 1317.5293s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 1467.7476s
	iters: 400, epoch: 21 | loss: 0.0190610
	speed: 0.0408s/iter; left time: 1331.2558s
Epoch: 21 cost time: 17.502862453460693
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.303 Vali Acc: 0.965 Test Loss: 0.303 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.1956s/iter; left time: 6363.6329s
	iters: 200, epoch: 22 | loss: 0.0000067
	speed: 0.0431s/iter; left time: 1397.9376s
	iters: 300, epoch: 22 | loss: 0.1131408
	speed: 0.0441s/iter; left time: 1424.6800s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 1539.6338s
Epoch: 22 cost time: 19.3236026763916
Epoch: 22, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.229 Vali Acc: 0.973 Test Loss: 0.229 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1129971
	speed: 0.2069s/iter; left time: 6643.9572s
	iters: 200, epoch: 23 | loss: 0.0463654
	speed: 0.0468s/iter; left time: 1497.9279s
	iters: 300, epoch: 23 | loss: 0.0000013
	speed: 0.0470s/iter; left time: 1500.7616s
	iters: 400, epoch: 23 | loss: 0.0000005
	speed: 0.0480s/iter; left time: 1527.8492s
Epoch: 23 cost time: 20.264739274978638
Epoch: 23, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.307 Vali Acc: 0.966 Test Loss: 0.307 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.2199156
	speed: 0.1958s/iter; left time: 6208.2818s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0463s/iter; left time: 1464.7286s
	iters: 300, epoch: 24 | loss: 0.0000106
	speed: 0.0475s/iter; left time: 1495.7063s
	iters: 400, epoch: 24 | loss: 0.0000167
	speed: 0.0516s/iter; left time: 1620.8243s
Epoch: 24 cost time: 20.206360340118408
Epoch: 24, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.360 Vali Acc: 0.965 Test Loss: 0.360 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2042s/iter; left time: 6389.8948s
	iters: 200, epoch: 25 | loss: 0.0000189
	speed: 0.0488s/iter; left time: 1522.6462s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0540s/iter; left time: 1678.2280s
	iters: 400, epoch: 25 | loss: 0.0010126
	speed: 0.0555s/iter; left time: 1720.4684s
Epoch: 25 cost time: 22.04128909111023
Epoch: 25, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.394 Vali Acc: 0.963 Test Loss: 0.394 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2232s/iter; left time: 6891.7860s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0447s/iter; left time: 1375.3677s
	iters: 300, epoch: 26 | loss: 0.0000993
	speed: 0.0489s/iter; left time: 1501.4964s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 1507.4532s
Epoch: 26 cost time: 20.902586936950684
Epoch: 26, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.481 Vali Acc: 0.966 Test Loss: 0.481 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2169s/iter; left time: 6608.3287s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 1351.6794s
	iters: 300, epoch: 27 | loss: 0.0646471
	speed: 0.0423s/iter; left time: 1281.5535s
	iters: 400, epoch: 27 | loss: 0.0002582
	speed: 0.0494s/iter; left time: 1488.5782s
Epoch: 27 cost time: 20.178561687469482
Epoch: 27, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.296 Vali Acc: 0.973 Test Loss: 0.296 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2080s/iter; left time: 6251.7152s
	iters: 200, epoch: 28 | loss: 0.0013945
	speed: 0.0430s/iter; left time: 1288.5526s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 1325.0847s
	iters: 400, epoch: 28 | loss: 0.0000001
	speed: 0.0391s/iter; left time: 1163.6414s
Epoch: 28 cost time: 18.997997283935547
Epoch: 28, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.346 Vali Acc: 0.966 Test Loss: 0.346 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2030s/iter; left time: 6016.4866s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 1198.7694s
	iters: 300, epoch: 29 | loss: 0.0000001
	speed: 0.0441s/iter; left time: 1298.1406s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 1300.3304s
Epoch: 29 cost time: 19.047307014465332
Epoch: 29, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.362 Vali Acc: 0.970 Test Loss: 0.362 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 117082
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1558947
	speed: 0.0690s/iter; left time: 2842.1675s
	iters: 200, epoch: 1 | loss: 0.1187043
	speed: 0.0470s/iter; left time: 1933.5883s
	iters: 300, epoch: 1 | loss: 0.3850237
	speed: 0.0435s/iter; left time: 1782.7196s
	iters: 400, epoch: 1 | loss: 0.1382968
	speed: 0.0467s/iter; left time: 1910.1947s
Epoch: 1 cost time: 21.329694509506226
Epoch: 1, Steps: 413 | Train Loss: 0.418 Vali Loss: 0.128 Vali Acc: 0.955 Test Loss: 0.128 Test Acc: 0.955
Validation loss decreased (inf --> -0.954978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1066841
	speed: 0.1931s/iter; left time: 7876.7534s
	iters: 200, epoch: 2 | loss: 0.0286064
	speed: 0.0511s/iter; left time: 2080.6628s
	iters: 300, epoch: 2 | loss: 0.1107813
	speed: 0.0513s/iter; left time: 2082.6778s
	iters: 400, epoch: 2 | loss: 0.5319683
	speed: 0.0485s/iter; left time: 1964.1755s
Epoch: 2 cost time: 20.403608798980713
Epoch: 2, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
Validation loss decreased (-0.954978 --> -0.971804).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0164927
	speed: 0.1909s/iter; left time: 7708.6658s
	iters: 200, epoch: 3 | loss: 0.0018043
	speed: 0.0425s/iter; left time: 1710.2065s
	iters: 300, epoch: 3 | loss: 0.0001580
	speed: 0.0467s/iter; left time: 1877.1726s
	iters: 400, epoch: 3 | loss: 0.0002705
	speed: 0.0461s/iter; left time: 1845.5457s
Epoch: 3 cost time: 19.437578678131104
Epoch: 3, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000873
	speed: 0.2146s/iter; left time: 8576.6294s
	iters: 200, epoch: 4 | loss: 0.0151448
	speed: 0.0437s/iter; left time: 1743.2500s
	iters: 300, epoch: 4 | loss: 0.0000151
	speed: 0.0482s/iter; left time: 1915.4309s
	iters: 400, epoch: 4 | loss: 0.0005987
	speed: 0.0568s/iter; left time: 2253.4765s
Epoch: 4 cost time: 20.683207035064697
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1838416
	speed: 0.2175s/iter; left time: 8603.0166s
	iters: 200, epoch: 5 | loss: 0.1240346
	speed: 0.0443s/iter; left time: 1748.7670s
	iters: 300, epoch: 5 | loss: 0.0001388
	speed: 0.0521s/iter; left time: 2050.4296s
	iters: 400, epoch: 5 | loss: 0.0012025
	speed: 0.0470s/iter; left time: 1843.4216s
Epoch: 5 cost time: 20.679080963134766
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.222 Vali Acc: 0.953 Test Loss: 0.222 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0037325
	speed: 0.2197s/iter; left time: 8598.2860s
	iters: 200, epoch: 6 | loss: 0.0000317
	speed: 0.0490s/iter; left time: 1913.3537s
	iters: 300, epoch: 6 | loss: 0.1389160
	speed: 0.0447s/iter; left time: 1741.4101s
	iters: 400, epoch: 6 | loss: 0.0106085
	speed: 0.0487s/iter; left time: 1891.8816s
Epoch: 6 cost time: 20.42344307899475
Epoch: 6, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.181 Vali Acc: 0.965 Test Loss: 0.181 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0001904
	speed: 0.2154s/iter; left time: 8340.1382s
	iters: 200, epoch: 7 | loss: 0.0015679
	speed: 0.0441s/iter; left time: 1703.9496s
	iters: 300, epoch: 7 | loss: 0.2172386
	speed: 0.0485s/iter; left time: 1866.7026s
	iters: 400, epoch: 7 | loss: 0.0200999
	speed: 0.0483s/iter; left time: 1855.8915s
Epoch: 7 cost time: 20.30186629295349
Epoch: 7, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000137
	speed: 0.2058s/iter; left time: 7882.3475s
	iters: 200, epoch: 8 | loss: 0.0772884
	speed: 0.0501s/iter; left time: 1915.0088s
	iters: 300, epoch: 8 | loss: 0.1880918
	speed: 0.0474s/iter; left time: 1807.2268s
	iters: 400, epoch: 8 | loss: 0.0024817
	speed: 0.0430s/iter; left time: 1634.3943s
Epoch: 8 cost time: 20.611329078674316
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.196 Vali Acc: 0.959 Test Loss: 0.196 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0013684
	speed: 0.1962s/iter; left time: 7434.0969s
	iters: 200, epoch: 9 | loss: 0.0009925
	speed: 0.0391s/iter; left time: 1476.4695s
	iters: 300, epoch: 9 | loss: 0.0002695
	speed: 0.0542s/iter; left time: 2041.6578s
	iters: 400, epoch: 9 | loss: 0.0000279
	speed: 0.0432s/iter; left time: 1625.8800s
Epoch: 9 cost time: 19.14917302131653
Epoch: 9, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.221 Vali Acc: 0.965 Test Loss: 0.221 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0678887
	speed: 0.2031s/iter; left time: 7613.2619s
	iters: 200, epoch: 10 | loss: 0.0000909
	speed: 0.0416s/iter; left time: 1554.4367s
	iters: 300, epoch: 10 | loss: 0.0006101
	speed: 0.0464s/iter; left time: 1729.8010s
	iters: 400, epoch: 10 | loss: 0.0233839
	speed: 0.0397s/iter; left time: 1474.4288s
Epoch: 10 cost time: 18.235860347747803
Epoch: 10, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.201 Vali Acc: 0.968 Test Loss: 0.201 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0001220
	speed: 0.1999s/iter; left time: 7409.9919s
	iters: 200, epoch: 11 | loss: 0.1971413
	speed: 0.0499s/iter; left time: 1844.0338s
	iters: 300, epoch: 11 | loss: 0.0000007
	speed: 0.0486s/iter; left time: 1792.1073s
	iters: 400, epoch: 11 | loss: 0.0913449
	speed: 0.0470s/iter; left time: 1727.9000s
Epoch: 11 cost time: 20.615113973617554
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000018
	speed: 0.2054s/iter; left time: 7528.4924s
	iters: 200, epoch: 12 | loss: 0.0000010
	speed: 0.0469s/iter; left time: 1714.9259s
	iters: 300, epoch: 12 | loss: 0.0013187
	speed: 0.0474s/iter; left time: 1729.2528s
	iters: 400, epoch: 12 | loss: 0.0000658
	speed: 0.0462s/iter; left time: 1679.9684s
Epoch: 12 cost time: 20.368274450302124
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.240 Vali Acc: 0.968 Test Loss: 0.240 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9718053660754888
model parameter : 83834
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3464908
	speed: 0.0956s/iter; left time: 3937.3244s
	iters: 200, epoch: 1 | loss: 0.3189041
	speed: 0.0493s/iter; left time: 2026.1349s
	iters: 300, epoch: 1 | loss: 0.0156580
	speed: 0.0460s/iter; left time: 1886.5203s
	iters: 400, epoch: 1 | loss: 0.0895470
	speed: 0.0488s/iter; left time: 1995.5281s
Epoch: 1 cost time: 24.55468726158142
Epoch: 1, Steps: 413 | Train Loss: 0.477 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
Validation loss decreased (inf --> -0.956797).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0880956
	speed: 0.2129s/iter; left time: 8683.3493s
	iters: 200, epoch: 2 | loss: 0.2347694
	speed: 0.0486s/iter; left time: 1979.3596s
	iters: 300, epoch: 2 | loss: 0.0342064
	speed: 0.0532s/iter; left time: 2160.2494s
	iters: 400, epoch: 2 | loss: 0.1413128
	speed: 0.0518s/iter; left time: 2097.0929s
Epoch: 2 cost time: 21.828762769699097
Epoch: 2, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.106 Vali Acc: 0.964 Test Loss: 0.106 Test Acc: 0.964
Validation loss decreased (-0.956797 --> -0.963619).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0040395
	speed: 0.2092s/iter; left time: 8445.4048s
	iters: 200, epoch: 3 | loss: 0.0516516
	speed: 0.0557s/iter; left time: 2244.6822s
	iters: 300, epoch: 3 | loss: 0.0395806
	speed: 0.0477s/iter; left time: 1914.7427s
	iters: 400, epoch: 3 | loss: 0.0035578
	speed: 0.0538s/iter; left time: 2156.9775s
Epoch: 3 cost time: 21.887993097305298
Epoch: 3, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
Validation loss decreased (-0.963619 --> -0.968166).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0002789
	speed: 0.2240s/iter; left time: 8950.8414s
	iters: 200, epoch: 4 | loss: 0.0218697
	speed: 0.0467s/iter; left time: 1862.5476s
	iters: 300, epoch: 4 | loss: 0.1386667
	speed: 0.0439s/iter; left time: 1746.6300s
	iters: 400, epoch: 4 | loss: 0.0037721
	speed: 0.0468s/iter; left time: 1855.0195s
Epoch: 4 cost time: 20.355619192123413
Epoch: 4, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
Validation loss decreased (-0.968166 --> -0.975897).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0306902
	speed: 0.2008s/iter; left time: 7942.7538s
	iters: 200, epoch: 5 | loss: 0.0000995
	speed: 0.0401s/iter; left time: 1580.6437s
	iters: 300, epoch: 5 | loss: 0.0001662
	speed: 0.0464s/iter; left time: 1824.1325s
	iters: 400, epoch: 5 | loss: 0.0114103
	speed: 0.0467s/iter; left time: 1831.7186s
Epoch: 5 cost time: 19.099591493606567
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0005355
	speed: 0.2065s/iter; left time: 8080.4559s
	iters: 200, epoch: 6 | loss: 0.0390732
	speed: 0.0500s/iter; left time: 1952.3782s
	iters: 300, epoch: 6 | loss: 0.0002570
	speed: 0.0477s/iter; left time: 1856.9911s
	iters: 400, epoch: 6 | loss: 0.0001106
	speed: 0.0417s/iter; left time: 1620.6128s
Epoch: 6 cost time: 20.507421731948853
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0001181
	speed: 0.2205s/iter; left time: 8539.9952s
	iters: 200, epoch: 7 | loss: 0.0003406
	speed: 0.0437s/iter; left time: 1687.5458s
	iters: 300, epoch: 7 | loss: 0.0002715
	speed: 0.0471s/iter; left time: 1814.3119s
	iters: 400, epoch: 7 | loss: 0.0007851
	speed: 0.0449s/iter; left time: 1723.9461s
Epoch: 7 cost time: 20.287311792373657
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0078001
	speed: 0.2486s/iter; left time: 9525.1032s
	iters: 200, epoch: 8 | loss: 0.0001976
	speed: 0.0509s/iter; left time: 1943.2497s
	iters: 300, epoch: 8 | loss: 0.0007720
	speed: 0.0493s/iter; left time: 1880.0517s
	iters: 400, epoch: 8 | loss: 0.0948447
	speed: 0.0462s/iter; left time: 1754.8234s
Epoch: 8 cost time: 21.791977882385254
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000003
	speed: 0.2373s/iter; left time: 8994.2528s
	iters: 200, epoch: 9 | loss: 0.0110894
	speed: 0.0483s/iter; left time: 1824.9026s
	iters: 300, epoch: 9 | loss: 0.0000077
	speed: 0.0510s/iter; left time: 1922.2076s
	iters: 400, epoch: 9 | loss: 0.0000027
	speed: 0.0456s/iter; left time: 1714.4439s
Epoch: 9 cost time: 22.13489818572998
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000547
	speed: 0.2262s/iter; left time: 8479.9140s
	iters: 200, epoch: 10 | loss: 0.0011364
	speed: 0.0635s/iter; left time: 2374.8305s
	iters: 300, epoch: 10 | loss: 0.0001998
	speed: 0.0584s/iter; left time: 2178.4706s
	iters: 400, epoch: 10 | loss: 0.0000021
	speed: 0.0466s/iter; left time: 1732.4405s
Epoch: 10 cost time: 23.964857816696167
Epoch: 10, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0001813
	speed: 0.2248s/iter; left time: 8333.7307s
	iters: 200, epoch: 11 | loss: 0.0000404
	speed: 0.0473s/iter; left time: 1748.9808s
	iters: 300, epoch: 11 | loss: 0.0003112
	speed: 0.0554s/iter; left time: 2044.2606s
	iters: 400, epoch: 11 | loss: 0.0389828
	speed: 0.0563s/iter; left time: 2070.0551s
Epoch: 11 cost time: 22.6929132938385
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0023155
	speed: 0.2142s/iter; left time: 7850.5344s
	iters: 200, epoch: 12 | loss: 0.0001169
	speed: 0.0487s/iter; left time: 1778.7728s
	iters: 300, epoch: 12 | loss: 0.0000774
	speed: 0.0490s/iter; left time: 1786.3143s
	iters: 400, epoch: 12 | loss: 0.0002244
	speed: 0.0528s/iter; left time: 1919.0823s
Epoch: 12 cost time: 21.28490161895752
Epoch: 12, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.184 Vali Acc: 0.974 Test Loss: 0.184 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000140
	speed: 0.2374s/iter; left time: 8605.4179s
	iters: 200, epoch: 13 | loss: 0.0000090
	speed: 0.0469s/iter; left time: 1695.6379s
	iters: 300, epoch: 13 | loss: 0.0016614
	speed: 0.0462s/iter; left time: 1664.4557s
	iters: 400, epoch: 13 | loss: 0.3195512
	speed: 0.0472s/iter; left time: 1694.8252s
Epoch: 13 cost time: 20.69066333770752
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.253 Vali Acc: 0.965 Test Loss: 0.253 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000111
	speed: 0.2065s/iter; left time: 7399.3647s
	iters: 200, epoch: 14 | loss: 0.0052641
	speed: 0.0445s/iter; left time: 1588.3932s
	iters: 300, epoch: 14 | loss: 0.2141197
	speed: 0.0506s/iter; left time: 1804.7506s
	iters: 400, epoch: 14 | loss: 0.2619191
	speed: 0.0516s/iter; left time: 1833.5844s
Epoch: 14 cost time: 20.928226709365845
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.286 Vali Acc: 0.968 Test Loss: 0.286 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9758981355161437
model parameter : 67226
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7313561
	speed: 0.0713s/iter; left time: 2937.0702s
	iters: 200, epoch: 1 | loss: 0.2953278
	speed: 0.0422s/iter; left time: 1734.2237s
	iters: 300, epoch: 1 | loss: 0.2603109
	speed: 0.0410s/iter; left time: 1682.2689s
	iters: 400, epoch: 1 | loss: 0.1671045
	speed: 0.0442s/iter; left time: 1808.8695s
Epoch: 1 cost time: 20.565988779067993
Epoch: 1, Steps: 413 | Train Loss: 0.520 Vali Loss: 0.124 Vali Acc: 0.958 Test Loss: 0.124 Test Acc: 0.958
Validation loss decreased (inf --> -0.957707).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0867992
	speed: 0.2106s/iter; left time: 8590.6036s
	iters: 200, epoch: 2 | loss: 0.0461435
	speed: 0.0447s/iter; left time: 1820.7429s
	iters: 300, epoch: 2 | loss: 0.0080582
	speed: 0.0452s/iter; left time: 1833.6351s
	iters: 400, epoch: 2 | loss: 0.0098919
	speed: 0.0453s/iter; left time: 1834.5752s
Epoch: 2 cost time: 19.64487314224243
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.094 Vali Acc: 0.969 Test Loss: 0.094 Test Acc: 0.969
Validation loss decreased (-0.957707 --> -0.969076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0367358
	speed: 0.1991s/iter; left time: 8039.5498s
	iters: 200, epoch: 3 | loss: 0.1294497
	speed: 0.0468s/iter; left time: 1886.3644s
	iters: 300, epoch: 3 | loss: 0.0995253
	speed: 0.0469s/iter; left time: 1883.1651s
	iters: 400, epoch: 3 | loss: 0.0066688
	speed: 0.0435s/iter; left time: 1741.7523s
Epoch: 3 cost time: 19.53782558441162
Epoch: 3, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1065403
	speed: 0.1904s/iter; left time: 7607.8177s
	iters: 200, epoch: 4 | loss: 0.0035228
	speed: 0.0459s/iter; left time: 1829.4956s
	iters: 300, epoch: 4 | loss: 0.3159823
	speed: 0.0378s/iter; left time: 1502.5336s
	iters: 400, epoch: 4 | loss: 0.1933592
	speed: 0.0391s/iter; left time: 1550.9749s
Epoch: 4 cost time: 18.232089281082153
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
Validation loss decreased (-0.969076 --> -0.974078).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0001506
	speed: 0.1772s/iter; left time: 7007.3193s
	iters: 200, epoch: 5 | loss: 0.0053610
	speed: 0.0432s/iter; left time: 1703.9200s
	iters: 300, epoch: 5 | loss: 0.0135916
	speed: 0.0401s/iter; left time: 1578.6055s
	iters: 400, epoch: 5 | loss: 0.0222162
	speed: 0.0385s/iter; left time: 1512.9966s
Epoch: 5 cost time: 17.847978591918945
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.108 Vali Acc: 0.966 Test Loss: 0.108 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0005351
	speed: 0.1776s/iter; left time: 6952.4216s
	iters: 200, epoch: 6 | loss: 0.0082705
	speed: 0.0395s/iter; left time: 1541.4328s
	iters: 300, epoch: 6 | loss: 0.0043890
	speed: 0.0389s/iter; left time: 1515.7610s
	iters: 400, epoch: 6 | loss: 0.0033166
	speed: 0.0348s/iter; left time: 1352.7648s
Epoch: 6 cost time: 16.210753679275513
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0022640
	speed: 0.1667s/iter; left time: 6454.2351s
	iters: 200, epoch: 7 | loss: 0.0003273
	speed: 0.0349s/iter; left time: 1346.5308s
	iters: 300, epoch: 7 | loss: 0.0000665
	speed: 0.0420s/iter; left time: 1619.7541s
	iters: 400, epoch: 7 | loss: 0.0310035
	speed: 0.0348s/iter; left time: 1337.5085s
Epoch: 7 cost time: 16.26134467124939
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0003408
	speed: 0.1714s/iter; left time: 6565.2718s
	iters: 200, epoch: 8 | loss: 0.0118354
	speed: 0.0433s/iter; left time: 1652.6626s
	iters: 300, epoch: 8 | loss: 0.0000301
	speed: 0.0371s/iter; left time: 1415.2553s
	iters: 400, epoch: 8 | loss: 0.1679580
	speed: 0.0356s/iter; left time: 1354.3923s
Epoch: 8 cost time: 16.757527351379395
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0281975
	speed: 0.1688s/iter; left time: 6396.4123s
	iters: 200, epoch: 9 | loss: 0.0000572
	speed: 0.0413s/iter; left time: 1560.2586s
	iters: 300, epoch: 9 | loss: 0.0006789
	speed: 0.0349s/iter; left time: 1317.4407s
	iters: 400, epoch: 9 | loss: 0.0494310
	speed: 0.0386s/iter; left time: 1452.9512s
Epoch: 9 cost time: 16.960496187210083
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0055640
	speed: 0.1776s/iter; left time: 6655.8978s
	iters: 200, epoch: 10 | loss: 0.0800272
	speed: 0.0411s/iter; left time: 1537.5157s
	iters: 300, epoch: 10 | loss: 0.0003531
	speed: 0.0416s/iter; left time: 1551.8736s
	iters: 400, epoch: 10 | loss: 0.3738123
	speed: 0.0399s/iter; left time: 1483.6851s
Epoch: 10 cost time: 17.90564513206482
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.974078 --> -0.976807).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000014
	speed: 0.1933s/iter; left time: 7166.2262s
	iters: 200, epoch: 11 | loss: 0.0004789
	speed: 0.0404s/iter; left time: 1495.0352s
	iters: 300, epoch: 11 | loss: 0.0000026
	speed: 0.0400s/iter; left time: 1476.2464s
	iters: 400, epoch: 11 | loss: 0.7306913
	speed: 0.0395s/iter; left time: 1453.3097s
Epoch: 11 cost time: 17.362995862960815
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000051
	speed: 0.1826s/iter; left time: 6692.3955s
	iters: 200, epoch: 12 | loss: 0.0000050
	speed: 0.0407s/iter; left time: 1489.0947s
	iters: 300, epoch: 12 | loss: 0.0000115
	speed: 0.0402s/iter; left time: 1464.9599s
	iters: 400, epoch: 12 | loss: 0.0046586
	speed: 0.0395s/iter; left time: 1436.7363s
Epoch: 12 cost time: 17.44290018081665
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.976807 --> -0.979535).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0025073
	speed: 0.1716s/iter; left time: 6220.4237s
	iters: 200, epoch: 13 | loss: 0.0000143
	speed: 0.0370s/iter; left time: 1336.4846s
	iters: 300, epoch: 13 | loss: 0.0003029
	speed: 0.0431s/iter; left time: 1553.7880s
	iters: 400, epoch: 13 | loss: 0.0000406
	speed: 0.0472s/iter; left time: 1696.0265s
Epoch: 13 cost time: 17.749951124191284
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0004469
	speed: 0.1869s/iter; left time: 6695.8227s
	iters: 200, epoch: 14 | loss: 0.0193401
	speed: 0.0404s/iter; left time: 1442.9585s
	iters: 300, epoch: 14 | loss: 0.1796072
	speed: 0.0418s/iter; left time: 1489.3635s
	iters: 400, epoch: 14 | loss: 0.5867662
	speed: 0.0442s/iter; left time: 1571.6645s
Epoch: 14 cost time: 17.918057680130005
Epoch: 14, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0002315
	speed: 0.1978s/iter; left time: 7005.1042s
	iters: 200, epoch: 15 | loss: 0.0000487
	speed: 0.0463s/iter; left time: 1635.0850s
	iters: 300, epoch: 15 | loss: 0.0000468
	speed: 0.0484s/iter; left time: 1703.2892s
	iters: 400, epoch: 15 | loss: 0.0000083
	speed: 0.0408s/iter; left time: 1433.7231s
Epoch: 15 cost time: 19.106395959854126
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000016
	speed: 0.1793s/iter; left time: 6276.7992s
	iters: 200, epoch: 16 | loss: 0.0008586
	speed: 0.0403s/iter; left time: 1405.0660s
	iters: 300, epoch: 16 | loss: 0.0010740
	speed: 0.0428s/iter; left time: 1488.6045s
	iters: 400, epoch: 16 | loss: 0.0011026
	speed: 0.0394s/iter; left time: 1367.4551s
Epoch: 16 cost time: 17.394999980926514
Epoch: 16, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000031
	speed: 0.1809s/iter; left time: 6256.7702s
	iters: 200, epoch: 17 | loss: 0.0000452
	speed: 0.0383s/iter; left time: 1321.9862s
	iters: 300, epoch: 17 | loss: 0.0035913
	speed: 0.0426s/iter; left time: 1466.3925s
	iters: 400, epoch: 17 | loss: 0.0001220
	speed: 0.0354s/iter; left time: 1213.9266s
Epoch: 17 cost time: 17.23789691925049
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0003124
	speed: 0.1874s/iter; left time: 6405.7681s
	iters: 200, epoch: 18 | loss: 0.0000367
	speed: 0.0425s/iter; left time: 1447.5066s
	iters: 300, epoch: 18 | loss: 0.0015318
	speed: 0.0404s/iter; left time: 1371.7445s
	iters: 400, epoch: 18 | loss: 0.0000443
	speed: 0.0344s/iter; left time: 1164.6377s
Epoch: 18 cost time: 17.85838007926941
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.189 Vali Acc: 0.977 Test Loss: 0.189 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0005273
	speed: 0.1787s/iter; left time: 6035.0909s
	iters: 200, epoch: 19 | loss: 0.0033224
	speed: 0.0373s/iter; left time: 1256.9854s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0415s/iter; left time: 1392.4542s
	iters: 400, epoch: 19 | loss: 0.0000038
	speed: 0.0401s/iter; left time: 1343.6742s
Epoch: 19 cost time: 17.2051420211792
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.145 Vali Acc: 0.982 Test Loss: 0.145 Test Acc: 0.982
Validation loss decreased (-0.979535 --> -0.981808).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1688s/iter; left time: 5631.1984s
	iters: 200, epoch: 20 | loss: 0.0000805
	speed: 0.0362s/iter; left time: 1202.2522s
	iters: 300, epoch: 20 | loss: 0.0000020
	speed: 0.0366s/iter; left time: 1214.1772s
	iters: 400, epoch: 20 | loss: 0.0000014
	speed: 0.0394s/iter; left time: 1303.8402s
Epoch: 20 cost time: 16.165979623794556
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000003
	speed: 0.1907s/iter; left time: 6282.9246s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.0444s/iter; left time: 1459.2528s
	iters: 300, epoch: 21 | loss: 0.0000852
	speed: 0.0450s/iter; left time: 1473.3007s
	iters: 400, epoch: 21 | loss: 0.0045330
	speed: 0.0419s/iter; left time: 1366.0958s
Epoch: 21 cost time: 18.57056975364685
Epoch: 21, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1865s/iter; left time: 6067.4808s
	iters: 200, epoch: 22 | loss: 0.0000027
	speed: 0.0442s/iter; left time: 1434.3761s
	iters: 300, epoch: 22 | loss: 0.0000064
	speed: 0.0446s/iter; left time: 1441.5594s
	iters: 400, epoch: 22 | loss: 0.0000149
	speed: 0.0412s/iter; left time: 1328.2695s
Epoch: 22 cost time: 18.539908409118652
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.151 Vali Acc: 0.979 Test Loss: 0.151 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1901s/iter; left time: 6104.9469s
	iters: 200, epoch: 23 | loss: 0.0001803
	speed: 0.0451s/iter; left time: 1443.4716s
	iters: 300, epoch: 23 | loss: 0.0000067
	speed: 0.0435s/iter; left time: 1387.9701s
	iters: 400, epoch: 23 | loss: 0.0002995
	speed: 0.0409s/iter; left time: 1302.4776s
Epoch: 23 cost time: 18.810317993164062
Epoch: 23, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000004
	speed: 0.1972s/iter; left time: 6251.7399s
	iters: 200, epoch: 24 | loss: 0.0000025
	speed: 0.0403s/iter; left time: 1273.6568s
	iters: 300, epoch: 24 | loss: 0.0000303
	speed: 0.0431s/iter; left time: 1356.8821s
	iters: 400, epoch: 24 | loss: 0.0051189
	speed: 0.0474s/iter; left time: 1489.8500s
Epoch: 24 cost time: 18.82724165916443
Epoch: 24, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.178 Vali Acc: 0.976 Test Loss: 0.178 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000070
	speed: 0.2047s/iter; left time: 6405.0243s
	iters: 200, epoch: 25 | loss: 0.0448740
	speed: 0.0462s/iter; left time: 1440.0504s
	iters: 300, epoch: 25 | loss: 0.0000056
	speed: 0.0445s/iter; left time: 1382.5723s
	iters: 400, epoch: 25 | loss: 0.0001055
	speed: 0.0490s/iter; left time: 1518.3569s
Epoch: 25 cost time: 20.297226190567017
Epoch: 25, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0072879
	speed: 0.1963s/iter; left time: 6060.9337s
	iters: 200, epoch: 26 | loss: 0.0000104
	speed: 0.0355s/iter; left time: 1091.3366s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 1258.7318s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 1265.0941s
Epoch: 26 cost time: 17.500813245773315
Epoch: 26, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.182 Vali Acc: 0.976 Test Loss: 0.182 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000090
	speed: 0.1818s/iter; left time: 5536.6904s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0387s/iter; left time: 1173.9523s
	iters: 300, epoch: 27 | loss: 0.5683227
	speed: 0.0384s/iter; left time: 1160.9224s
	iters: 400, epoch: 27 | loss: 0.0000001
	speed: 0.0359s/iter; left time: 1082.3251s
Epoch: 27 cost time: 16.66105365753174
Epoch: 27, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.230 Vali Acc: 0.974 Test Loss: 0.230 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000001
	speed: 0.1785s/iter; left time: 5364.9188s
	iters: 200, epoch: 28 | loss: 0.0002095
	speed: 0.0414s/iter; left time: 1241.1476s
	iters: 300, epoch: 28 | loss: 0.0000004
	speed: 0.0407s/iter; left time: 1213.9147s
	iters: 400, epoch: 28 | loss: 0.0000642
	speed: 0.0360s/iter; left time: 1071.4343s
Epoch: 28 cost time: 17.38012957572937
Epoch: 28, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000023
	speed: 0.1793s/iter; left time: 5314.8858s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0386s/iter; left time: 1140.2935s
	iters: 300, epoch: 29 | loss: 0.0000006
	speed: 0.0417s/iter; left time: 1226.9908s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 1156.0637s
Epoch: 29 cost time: 17.248340129852295
Epoch: 29, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.273 Vali Acc: 0.974 Test Loss: 0.273 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 56874
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5022461
	speed: 0.0804s/iter; left time: 3311.8301s
	iters: 200, epoch: 1 | loss: 0.1055019
	speed: 0.0480s/iter; left time: 1973.4176s
	iters: 300, epoch: 1 | loss: 0.3134063
	speed: 0.0493s/iter; left time: 2020.5255s
	iters: 400, epoch: 1 | loss: 0.3104115
	speed: 0.0429s/iter; left time: 1755.9440s
Epoch: 1 cost time: 22.801593780517578
Epoch: 1, Steps: 413 | Train Loss: 0.594 Vali Loss: 0.125 Vali Acc: 0.955 Test Loss: 0.125 Test Acc: 0.955
Validation loss decreased (inf --> -0.955433).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0624996
	speed: 0.2313s/iter; left time: 9434.3238s
	iters: 200, epoch: 2 | loss: 0.1945237
	speed: 0.0500s/iter; left time: 2035.4383s
	iters: 300, epoch: 2 | loss: 0.0549101
	speed: 0.0472s/iter; left time: 1917.1034s
	iters: 400, epoch: 2 | loss: 0.1707865
	speed: 0.0469s/iter; left time: 1897.0537s
Epoch: 2 cost time: 21.085795640945435
Epoch: 2, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.099 Vali Acc: 0.964 Test Loss: 0.099 Test Acc: 0.964
Validation loss decreased (-0.955433 --> -0.963619).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1216411
	speed: 0.2249s/iter; left time: 9081.9320s
	iters: 200, epoch: 3 | loss: 0.0085477
	speed: 0.0512s/iter; left time: 2062.3414s
	iters: 300, epoch: 3 | loss: 0.0050840
	speed: 0.0506s/iter; left time: 2032.5996s
	iters: 400, epoch: 3 | loss: 0.0008826
	speed: 0.0486s/iter; left time: 1947.3961s
Epoch: 3 cost time: 21.12798571586609
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.064 Vali Acc: 0.978 Test Loss: 0.064 Test Acc: 0.978
Validation loss decreased (-0.963619 --> -0.978171).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0527187
	speed: 0.1985s/iter; left time: 7932.0936s
	iters: 200, epoch: 4 | loss: 0.1388768
	speed: 0.0489s/iter; left time: 1951.1399s
	iters: 300, epoch: 4 | loss: 0.0996967
	speed: 0.0448s/iter; left time: 1783.0581s
	iters: 400, epoch: 4 | loss: 0.0126573
	speed: 0.0458s/iter; left time: 1815.7621s
Epoch: 4 cost time: 19.985214948654175
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.094 Vali Acc: 0.966 Test Loss: 0.094 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0006111
	speed: 0.2201s/iter; left time: 8706.4902s
	iters: 200, epoch: 5 | loss: 0.2041090
	speed: 0.0546s/iter; left time: 2155.3837s
	iters: 300, epoch: 5 | loss: 0.0022564
	speed: 0.0466s/iter; left time: 1834.7100s
	iters: 400, epoch: 5 | loss: 0.0034291
	speed: 0.0454s/iter; left time: 1781.0231s
Epoch: 5 cost time: 21.208820104599
Epoch: 5, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0061966
	speed: 0.2261s/iter; left time: 8849.6802s
	iters: 200, epoch: 6 | loss: 0.0040139
	speed: 0.0480s/iter; left time: 1872.3032s
	iters: 300, epoch: 6 | loss: 0.0054106
	speed: 0.0483s/iter; left time: 1881.7347s
	iters: 400, epoch: 6 | loss: 0.0008446
	speed: 0.0505s/iter; left time: 1960.2280s
Epoch: 6 cost time: 20.97266721725464
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0559142
	speed: 0.2260s/iter; left time: 8750.7009s
	iters: 200, epoch: 7 | loss: 0.0010919
	speed: 0.0500s/iter; left time: 1931.8737s
	iters: 300, epoch: 7 | loss: 0.0020363
	speed: 0.0443s/iter; left time: 1708.4872s
	iters: 400, epoch: 7 | loss: 0.2010350
	speed: 0.0409s/iter; left time: 1571.7871s
Epoch: 7 cost time: 19.408870220184326
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0044219
	speed: 0.2194s/iter; left time: 8405.7610s
	iters: 200, epoch: 8 | loss: 0.0000459
	speed: 0.0447s/iter; left time: 1706.7104s
	iters: 300, epoch: 8 | loss: 0.0013826
	speed: 0.0474s/iter; left time: 1805.6718s
	iters: 400, epoch: 8 | loss: 0.0005169
	speed: 0.0468s/iter; left time: 1779.0284s
Epoch: 8 cost time: 20.994752407073975
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0102654
	speed: 0.2218s/iter; left time: 8403.8415s
	iters: 200, epoch: 9 | loss: 0.0062472
	speed: 0.0440s/iter; left time: 1664.1044s
	iters: 300, epoch: 9 | loss: 0.0024785
	speed: 0.0392s/iter; left time: 1479.2735s
	iters: 400, epoch: 9 | loss: 0.0006080
	speed: 0.0416s/iter; left time: 1564.7462s
Epoch: 9 cost time: 19.083662033081055
Epoch: 9, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0001058
	speed: 0.2173s/iter; left time: 8145.6638s
	iters: 200, epoch: 10 | loss: 0.0241848
	speed: 0.0432s/iter; left time: 1613.7897s
	iters: 300, epoch: 10 | loss: 0.0030952
	speed: 0.0447s/iter; left time: 1665.6428s
	iters: 400, epoch: 10 | loss: 0.0004942
	speed: 0.0454s/iter; left time: 1687.4099s
Epoch: 10 cost time: 20.229836225509644
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0043568
	speed: 0.1939s/iter; left time: 7187.9778s
	iters: 200, epoch: 11 | loss: 0.0005287
	speed: 0.0492s/iter; left time: 1817.4556s
	iters: 300, epoch: 11 | loss: 0.0160221
	speed: 0.0511s/iter; left time: 1882.8111s
	iters: 400, epoch: 11 | loss: 0.0001621
	speed: 0.0457s/iter; left time: 1681.1670s
Epoch: 11 cost time: 20.880638122558594
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0002599
	speed: 0.1951s/iter; left time: 7152.2921s
	iters: 200, epoch: 12 | loss: 0.0007742
	speed: 0.0468s/iter; left time: 1710.3357s
	iters: 300, epoch: 12 | loss: 0.0001462
	speed: 0.0436s/iter; left time: 1588.6669s
	iters: 400, epoch: 12 | loss: 0.0000431
	speed: 0.0468s/iter; left time: 1702.1509s
Epoch: 12 cost time: 19.707542419433594
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0001734
	speed: 0.2117s/iter; left time: 7671.3959s
	iters: 200, epoch: 13 | loss: 0.0000125
	speed: 0.0541s/iter; left time: 1954.5423s
	iters: 300, epoch: 13 | loss: 0.0000247
	speed: 0.0509s/iter; left time: 1835.4866s
	iters: 400, epoch: 13 | loss: 0.0172440
	speed: 0.0489s/iter; left time: 1757.6157s
Epoch: 13 cost time: 21.717607736587524
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
Validation loss decreased (-0.978171 --> -0.978626).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0541452
	speed: 0.2203s/iter; left time: 7894.4138s
	iters: 200, epoch: 14 | loss: 0.2255927
	speed: 0.0509s/iter; left time: 1818.9859s
	iters: 300, epoch: 14 | loss: 0.1916266
	speed: 0.0526s/iter; left time: 1875.5954s
	iters: 400, epoch: 14 | loss: 0.0014573
	speed: 0.0508s/iter; left time: 1806.2505s
Epoch: 14 cost time: 22.031111478805542
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000450
	speed: 0.2342s/iter; left time: 8296.2328s
	iters: 200, epoch: 15 | loss: 0.0000032
	speed: 0.0485s/iter; left time: 1711.5591s
	iters: 300, epoch: 15 | loss: 0.0000176
	speed: 0.0514s/iter; left time: 1811.2438s
	iters: 400, epoch: 15 | loss: 0.0001930
	speed: 0.0514s/iter; left time: 1804.1459s
Epoch: 15 cost time: 21.769987106323242
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000158
	speed: 0.2280s/iter; left time: 7980.3437s
	iters: 200, epoch: 16 | loss: 0.0015578
	speed: 0.0428s/iter; left time: 1492.6981s
	iters: 300, epoch: 16 | loss: 0.3786958
	speed: 0.0457s/iter; left time: 1592.1554s
	iters: 400, epoch: 16 | loss: 0.0010301
	speed: 0.0463s/iter; left time: 1605.2122s
Epoch: 16 cost time: 19.225884437561035
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000002
	speed: 0.2251s/iter; left time: 7788.2631s
	iters: 200, epoch: 17 | loss: 0.0000007
	speed: 0.0442s/iter; left time: 1523.7613s
	iters: 300, epoch: 17 | loss: 0.1520868
	speed: 0.0434s/iter; left time: 1492.8845s
	iters: 400, epoch: 17 | loss: 0.0000012
	speed: 0.0445s/iter; left time: 1526.2562s
Epoch: 17 cost time: 19.319300651550293
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.202 Vali Acc: 0.962 Test Loss: 0.202 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000049
	speed: 0.2233s/iter; left time: 7631.5082s
	iters: 200, epoch: 18 | loss: 0.0007006
	speed: 0.0503s/iter; left time: 1713.3740s
	iters: 300, epoch: 18 | loss: 0.0000178
	speed: 0.0541s/iter; left time: 1837.4929s
	iters: 400, epoch: 18 | loss: 0.0040459
	speed: 0.0486s/iter; left time: 1645.7669s
Epoch: 18 cost time: 22.64995789527893
Epoch: 18, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.142 Vali Acc: 0.976 Test Loss: 0.142 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0009219
	speed: 0.2153s/iter; left time: 7269.1713s
	iters: 200, epoch: 19 | loss: 0.0486891
	speed: 0.0479s/iter; left time: 1612.4122s
	iters: 300, epoch: 19 | loss: 0.0000002
	speed: 0.0451s/iter; left time: 1514.6915s
	iters: 400, epoch: 19 | loss: 0.0008977
	speed: 0.0501s/iter; left time: 1677.0996s
Epoch: 19 cost time: 20.739368200302124
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.143 Vali Acc: 0.972 Test Loss: 0.143 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000199
	speed: 0.2222s/iter; left time: 7411.2069s
	iters: 200, epoch: 20 | loss: 0.0001045
	speed: 0.0577s/iter; left time: 1918.9129s
	iters: 300, epoch: 20 | loss: 0.0023903
	speed: 0.0519s/iter; left time: 1720.9953s
	iters: 400, epoch: 20 | loss: 0.0005271
	speed: 0.0488s/iter; left time: 1611.5853s
Epoch: 20 cost time: 22.39821195602417
Epoch: 20, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.166 Vali Acc: 0.974 Test Loss: 0.166 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0001291
	speed: 0.2307s/iter; left time: 7598.6788s
	iters: 200, epoch: 21 | loss: 0.0000044
	speed: 0.0511s/iter; left time: 1676.9706s
	iters: 300, epoch: 21 | loss: 0.0000003
	speed: 0.0517s/iter; left time: 1693.8338s
	iters: 400, epoch: 21 | loss: 0.0000006
	speed: 0.0546s/iter; left time: 1781.5565s
Epoch: 21 cost time: 22.545311450958252
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000013
	speed: 0.2411s/iter; left time: 7841.7271s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0488s/iter; left time: 1581.1008s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.0503s/iter; left time: 1624.9048s
	iters: 400, epoch: 22 | loss: 0.0004844
	speed: 0.0484s/iter; left time: 1558.4184s
Epoch: 22 cost time: 21.99684500694275
Epoch: 22, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.251 Vali Acc: 0.966 Test Loss: 0.251 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0006306
	speed: 0.2267s/iter; left time: 7279.4907s
	iters: 200, epoch: 23 | loss: 0.0121281
	speed: 0.0515s/iter; left time: 1647.4843s
	iters: 300, epoch: 23 | loss: 0.0000145
	speed: 0.0512s/iter; left time: 1634.8537s
	iters: 400, epoch: 23 | loss: 0.0043675
	speed: 0.0502s/iter; left time: 1596.5565s
Epoch: 23 cost time: 21.870731592178345
Epoch: 23, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.167 Vali Acc: 0.978 Test Loss: 0.167 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9786266484765803
model parameter : 46538
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7882626
	speed: 0.0863s/iter; left time: 3554.7635s
	iters: 200, epoch: 1 | loss: 0.3686749
	speed: 0.0462s/iter; left time: 1900.1702s
	iters: 300, epoch: 1 | loss: 0.0853408
	speed: 0.0466s/iter; left time: 1909.7582s
	iters: 400, epoch: 1 | loss: 0.0673478
	speed: 0.0519s/iter; left time: 2121.1423s
Epoch: 1 cost time: 24.09100317955017
Epoch: 1, Steps: 413 | Train Loss: 0.657 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (inf --> -0.958616).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1078039
	speed: 0.2252s/iter; left time: 9184.4718s
	iters: 200, epoch: 2 | loss: 0.0204428
	speed: 0.0440s/iter; left time: 1789.1796s
	iters: 300, epoch: 2 | loss: 0.1602011
	speed: 0.0475s/iter; left time: 1929.0558s
	iters: 400, epoch: 2 | loss: 0.0597289
	speed: 0.0408s/iter; left time: 1651.1638s
Epoch: 2 cost time: 19.400121450424194
Epoch: 2, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
Validation loss decreased (-0.958616 --> -0.978626).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0159491
	speed: 0.2254s/iter; left time: 9100.6692s
	iters: 200, epoch: 3 | loss: 0.1401650
	speed: 0.0423s/iter; left time: 1701.7666s
	iters: 300, epoch: 3 | loss: 0.0009890
	speed: 0.0440s/iter; left time: 1767.9636s
	iters: 400, epoch: 3 | loss: 0.0497532
	speed: 0.0459s/iter; left time: 1837.7823s
Epoch: 3 cost time: 19.966965436935425
Epoch: 3, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.081 Vali Acc: 0.971 Test Loss: 0.081 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0142200
	speed: 0.2220s/iter; left time: 8870.5524s
	iters: 200, epoch: 4 | loss: 0.0539388
	speed: 0.0505s/iter; left time: 2014.6784s
	iters: 300, epoch: 4 | loss: 0.1132201
	speed: 0.0475s/iter; left time: 1889.5183s
	iters: 400, epoch: 4 | loss: 0.0058526
	speed: 0.0477s/iter; left time: 1892.8040s
Epoch: 4 cost time: 20.891286849975586
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.055 Vali Acc: 0.980 Test Loss: 0.055 Test Acc: 0.980
Validation loss decreased (-0.978626 --> -0.979536).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0373347
	speed: 0.2226s/iter; left time: 8805.0751s
	iters: 200, epoch: 5 | loss: 0.0024365
	speed: 0.0550s/iter; left time: 2170.0793s
	iters: 300, epoch: 5 | loss: 0.0627228
	speed: 0.0444s/iter; left time: 1747.4322s
	iters: 400, epoch: 5 | loss: 0.0018047
	speed: 0.0431s/iter; left time: 1691.2222s
Epoch: 5 cost time: 20.125847816467285
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0417943
	speed: 0.2135s/iter; left time: 8357.3581s
	iters: 200, epoch: 6 | loss: 0.0267904
	speed: 0.0496s/iter; left time: 1937.4392s
	iters: 300, epoch: 6 | loss: 0.1284513
	speed: 0.0501s/iter; left time: 1950.1815s
	iters: 400, epoch: 6 | loss: 0.1916009
	speed: 0.0522s/iter; left time: 2026.4664s
Epoch: 6 cost time: 21.11640691757202
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.071 Vali Acc: 0.971 Test Loss: 0.071 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0023544
	speed: 0.2212s/iter; left time: 8563.8315s
	iters: 200, epoch: 7 | loss: 0.0009341
	speed: 0.0482s/iter; left time: 1863.4819s
	iters: 300, epoch: 7 | loss: 0.0148289
	speed: 0.0514s/iter; left time: 1981.6886s
	iters: 400, epoch: 7 | loss: 0.0005111
	speed: 0.0466s/iter; left time: 1791.9124s
Epoch: 7 cost time: 21.309239864349365
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0015289
	speed: 0.2124s/iter; left time: 8137.5997s
	iters: 200, epoch: 8 | loss: 0.0082328
	speed: 0.0526s/iter; left time: 2008.9877s
	iters: 300, epoch: 8 | loss: 0.0336868
	speed: 0.0523s/iter; left time: 1992.5345s
	iters: 400, epoch: 8 | loss: 0.0001754
	speed: 0.0482s/iter; left time: 1833.8390s
Epoch: 8 cost time: 21.87913966178894
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.062 Vali Acc: 0.978 Test Loss: 0.062 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.3843273
	speed: 0.2305s/iter; left time: 8736.3253s
	iters: 200, epoch: 9 | loss: 0.0009684
	speed: 0.0496s/iter; left time: 1875.8133s
	iters: 300, epoch: 9 | loss: 0.0000910
	speed: 0.0530s/iter; left time: 1999.7049s
	iters: 400, epoch: 9 | loss: 0.0002081
	speed: 0.0461s/iter; left time: 1732.1087s
Epoch: 9 cost time: 21.882405996322632
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.052 Vali Acc: 0.984 Test Loss: 0.052 Test Acc: 0.984
Validation loss decreased (-0.979536 --> -0.983628).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0001241
	speed: 0.2196s/iter; left time: 8231.4547s
	iters: 200, epoch: 10 | loss: 0.0145106
	speed: 0.0469s/iter; left time: 1753.7290s
	iters: 300, epoch: 10 | loss: 0.0000413
	speed: 0.0462s/iter; left time: 1722.1308s
	iters: 400, epoch: 10 | loss: 0.0011173
	speed: 0.0490s/iter; left time: 1820.5630s
Epoch: 10 cost time: 21.1070396900177
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2539521
	speed: 0.2366s/iter; left time: 8772.5754s
	iters: 200, epoch: 11 | loss: 0.0006763
	speed: 0.0491s/iter; left time: 1815.9507s
	iters: 300, epoch: 11 | loss: 0.0290368
	speed: 0.0497s/iter; left time: 1834.1073s
	iters: 400, epoch: 11 | loss: 0.0000171
	speed: 0.0461s/iter; left time: 1693.9447s
Epoch: 11 cost time: 21.197700023651123
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000656
	speed: 0.2069s/iter; left time: 7586.3344s
	iters: 200, epoch: 12 | loss: 0.0169381
	speed: 0.0453s/iter; left time: 1656.5020s
	iters: 300, epoch: 12 | loss: 0.0000169
	speed: 0.0469s/iter; left time: 1708.5727s
	iters: 400, epoch: 12 | loss: 0.0001187
	speed: 0.0482s/iter; left time: 1754.0492s
Epoch: 12 cost time: 19.65904188156128
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0170048
	speed: 0.2219s/iter; left time: 8041.8261s
	iters: 200, epoch: 13 | loss: 0.0004237
	speed: 0.0465s/iter; left time: 1680.0218s
	iters: 300, epoch: 13 | loss: 0.0016592
	speed: 0.0455s/iter; left time: 1641.2736s
	iters: 400, epoch: 13 | loss: 0.0168378
	speed: 0.0512s/iter; left time: 1839.0029s
Epoch: 13 cost time: 20.88082480430603
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0019042
	speed: 0.2212s/iter; left time: 7925.7849s
	iters: 200, epoch: 14 | loss: 0.0000381
	speed: 0.0473s/iter; left time: 1688.9300s
	iters: 300, epoch: 14 | loss: 0.0005237
	speed: 0.0470s/iter; left time: 1675.8848s
	iters: 400, epoch: 14 | loss: 0.0008593
	speed: 0.0496s/iter; left time: 1761.2958s
Epoch: 14 cost time: 20.577274084091187
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0061797
	speed: 0.2422s/iter; left time: 8578.6971s
	iters: 200, epoch: 15 | loss: 0.0000009
	speed: 0.0472s/iter; left time: 1665.4416s
	iters: 300, epoch: 15 | loss: 0.0001300
	speed: 0.0476s/iter; left time: 1676.9629s
	iters: 400, epoch: 15 | loss: 0.0013436
	speed: 0.0481s/iter; left time: 1688.5493s
Epoch: 15 cost time: 21.076425313949585
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000139
	speed: 0.2204s/iter; left time: 7714.3317s
	iters: 200, epoch: 16 | loss: 0.0889444
	speed: 0.0460s/iter; left time: 1604.1167s
	iters: 300, epoch: 16 | loss: 0.0002520
	speed: 0.0546s/iter; left time: 1901.3389s
	iters: 400, epoch: 16 | loss: 0.0000437
	speed: 0.0493s/iter; left time: 1710.7803s
Epoch: 16 cost time: 21.873835802078247
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000137
	speed: 0.2152s/iter; left time: 7444.4190s
	iters: 200, epoch: 17 | loss: 0.0000046
	speed: 0.0538s/iter; left time: 1855.3747s
	iters: 300, epoch: 17 | loss: 0.0002528
	speed: 0.0477s/iter; left time: 1640.4806s
	iters: 400, epoch: 17 | loss: 0.0000101
	speed: 0.0478s/iter; left time: 1637.7801s
Epoch: 17 cost time: 20.7033953666687
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000105
	speed: 0.2254s/iter; left time: 7703.4031s
	iters: 200, epoch: 18 | loss: 0.0002450
	speed: 0.0438s/iter; left time: 1494.2103s
	iters: 300, epoch: 18 | loss: 0.0044739
	speed: 0.0490s/iter; left time: 1663.5725s
	iters: 400, epoch: 18 | loss: 0.0013423
	speed: 0.0546s/iter; left time: 1848.4677s
Epoch: 18 cost time: 21.79568099975586
Epoch: 18, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000089
	speed: 0.2379s/iter; left time: 8034.2841s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0540s/iter; left time: 1816.6873s
	iters: 300, epoch: 19 | loss: 0.0000093
	speed: 0.0538s/iter; left time: 1806.6885s
	iters: 400, epoch: 19 | loss: 0.0000562
	speed: 0.0464s/iter; left time: 1553.7825s
Epoch: 19 cost time: 22.199426889419556
Epoch: 19, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 38298
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0232085
	speed: 0.0823s/iter; left time: 3390.4138s
	iters: 200, epoch: 1 | loss: 0.5452182
	speed: 0.0510s/iter; left time: 2096.6918s
	iters: 300, epoch: 1 | loss: 0.1416415
	speed: 0.0449s/iter; left time: 1840.1783s
	iters: 400, epoch: 1 | loss: 0.1628111
	speed: 0.0431s/iter; left time: 1761.8984s
Epoch: 1 cost time: 23.026926040649414
Epoch: 1, Steps: 413 | Train Loss: 0.709 Vali Loss: 0.163 Vali Acc: 0.947 Test Loss: 0.163 Test Acc: 0.947
Validation loss decreased (inf --> -0.946792).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2423763
	speed: 0.2136s/iter; left time: 8710.3792s
	iters: 200, epoch: 2 | loss: 0.0488271
	speed: 0.0445s/iter; left time: 1810.4043s
	iters: 300, epoch: 2 | loss: 0.0668793
	speed: 0.0454s/iter; left time: 1842.1255s
	iters: 400, epoch: 2 | loss: 0.0104758
	speed: 0.0481s/iter; left time: 1947.5077s
Epoch: 2 cost time: 19.952085494995117
Epoch: 2, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
Validation loss decreased (-0.946792 --> -0.968166).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0251904
	speed: 0.2375s/iter; left time: 9588.6775s
	iters: 200, epoch: 3 | loss: 0.0086548
	speed: 0.0488s/iter; left time: 1965.6191s
	iters: 300, epoch: 3 | loss: 0.2380264
	speed: 0.0479s/iter; left time: 1925.9937s
	iters: 400, epoch: 3 | loss: 0.0024738
	speed: 0.0481s/iter; left time: 1927.5461s
Epoch: 3 cost time: 22.122443914413452
Epoch: 3, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
Validation loss decreased (-0.968166 --> -0.975897).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0550209
	speed: 0.2313s/iter; left time: 9244.0399s
	iters: 200, epoch: 4 | loss: 0.1646056
	speed: 0.0562s/iter; left time: 2241.2318s
	iters: 300, epoch: 4 | loss: 0.0202964
	speed: 0.0513s/iter; left time: 2041.1204s
	iters: 400, epoch: 4 | loss: 0.1665925
	speed: 0.0591s/iter; left time: 2344.5365s
Epoch: 4 cost time: 23.33014440536499
Epoch: 4, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0502432
	speed: 0.2203s/iter; left time: 8711.8870s
	iters: 200, epoch: 5 | loss: 0.0238080
	speed: 0.0529s/iter; left time: 2086.6371s
	iters: 300, epoch: 5 | loss: 0.0084974
	speed: 0.0531s/iter; left time: 2089.1703s
	iters: 400, epoch: 5 | loss: 0.1115894
	speed: 0.0560s/iter; left time: 2197.9771s
Epoch: 5 cost time: 22.4052472114563
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.063 Vali Acc: 0.978 Test Loss: 0.063 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.977717).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0149702
	speed: 0.1961s/iter; left time: 7675.2134s
	iters: 200, epoch: 6 | loss: 0.0049878
	speed: 0.0564s/iter; left time: 2202.3240s
	iters: 300, epoch: 6 | loss: 0.0289430
	speed: 0.0521s/iter; left time: 2029.5995s
	iters: 400, epoch: 6 | loss: 0.1334862
	speed: 0.0442s/iter; left time: 1717.6041s
Epoch: 6 cost time: 21.235808610916138
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0124233
	speed: 0.2266s/iter; left time: 8775.1504s
	iters: 200, epoch: 7 | loss: 0.0671827
	speed: 0.0476s/iter; left time: 1837.2391s
	iters: 300, epoch: 7 | loss: 0.0188473
	speed: 0.0479s/iter; left time: 1844.2917s
	iters: 400, epoch: 7 | loss: 0.0017007
	speed: 0.0480s/iter; left time: 1844.4393s
Epoch: 7 cost time: 20.926855325698853
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.087 Vali Acc: 0.971 Test Loss: 0.087 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0016133
	speed: 0.2222s/iter; left time: 8510.9697s
	iters: 200, epoch: 8 | loss: 0.0002533
	speed: 0.0490s/iter; left time: 1872.5806s
	iters: 300, epoch: 8 | loss: 0.0054648
	speed: 0.0469s/iter; left time: 1786.4625s
	iters: 400, epoch: 8 | loss: 0.0032388
	speed: 0.0445s/iter; left time: 1690.1796s
Epoch: 8 cost time: 20.1876323223114
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.093 Vali Acc: 0.972 Test Loss: 0.093 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0098655
	speed: 0.2204s/iter; left time: 8352.1356s
	iters: 200, epoch: 9 | loss: 0.0098867
	speed: 0.0508s/iter; left time: 1918.9855s
	iters: 300, epoch: 9 | loss: 0.0087740
	speed: 0.0470s/iter; left time: 1770.0848s
	iters: 400, epoch: 9 | loss: 0.4815072
	speed: 0.0498s/iter; left time: 1874.0007s
Epoch: 9 cost time: 21.114978313446045
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0060942
	speed: 0.2343s/iter; left time: 8780.8168s
	iters: 200, epoch: 10 | loss: 0.0050747
	speed: 0.0458s/iter; left time: 1711.3252s
	iters: 300, epoch: 10 | loss: 0.0017083
	speed: 0.0480s/iter; left time: 1787.8637s
	iters: 400, epoch: 10 | loss: 0.0004454
	speed: 0.0512s/iter; left time: 1903.8927s
Epoch: 10 cost time: 20.902374744415283
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0031427
	speed: 0.2346s/iter; left time: 8695.4080s
	iters: 200, epoch: 11 | loss: 0.1828728
	speed: 0.0503s/iter; left time: 1859.0522s
	iters: 300, epoch: 11 | loss: 0.0029318
	speed: 0.0465s/iter; left time: 1712.9027s
	iters: 400, epoch: 11 | loss: 0.1385776
	speed: 0.0567s/iter; left time: 2085.2926s
Epoch: 11 cost time: 22.146480321884155
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0020782
	speed: 0.2233s/iter; left time: 8187.4800s
	iters: 200, epoch: 12 | loss: 0.3441269
	speed: 0.0532s/iter; left time: 1945.8945s
	iters: 300, epoch: 12 | loss: 0.0002967
	speed: 0.0511s/iter; left time: 1862.0656s
	iters: 400, epoch: 12 | loss: 0.0011017
	speed: 0.0510s/iter; left time: 1855.0093s
Epoch: 12 cost time: 21.676018714904785
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0023988
	speed: 0.2246s/iter; left time: 8138.9485s
	iters: 200, epoch: 13 | loss: 0.0013462
	speed: 0.0415s/iter; left time: 1500.9598s
	iters: 300, epoch: 13 | loss: 0.0111400
	speed: 0.0449s/iter; left time: 1620.1534s
	iters: 400, epoch: 13 | loss: 0.2305043
	speed: 0.0505s/iter; left time: 1815.2348s
Epoch: 13 cost time: 19.938332557678223
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0004733
	speed: 0.2297s/iter; left time: 8230.4557s
	iters: 200, epoch: 14 | loss: 0.0000293
	speed: 0.0532s/iter; left time: 1902.6936s
	iters: 300, epoch: 14 | loss: 0.0005774
	speed: 0.0526s/iter; left time: 1873.1351s
	iters: 400, epoch: 14 | loss: 0.0178330
	speed: 0.0520s/iter; left time: 1849.1641s
Epoch: 14 cost time: 22.528781175613403
Epoch: 14, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0002056
	speed: 0.2311s/iter; left time: 8184.0136s
	iters: 200, epoch: 15 | loss: 0.0177023
	speed: 0.0489s/iter; left time: 1727.3891s
	iters: 300, epoch: 15 | loss: 0.0041903
	speed: 0.0534s/iter; left time: 1880.5187s
	iters: 400, epoch: 15 | loss: 0.0039474
	speed: 0.0507s/iter; left time: 1781.7267s
Epoch: 15 cost time: 21.554378271102905
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 34218
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2150171
	speed: 0.0882s/iter; left time: 3634.9164s
	iters: 200, epoch: 1 | loss: 0.4307443
	speed: 0.0533s/iter; left time: 2190.3978s
	iters: 300, epoch: 1 | loss: 0.0072557
	speed: 0.0551s/iter; left time: 2257.6778s
	iters: 400, epoch: 1 | loss: 0.2580968
	speed: 0.0572s/iter; left time: 2338.0263s
Epoch: 1 cost time: 26.312798500061035
Epoch: 1, Steps: 413 | Train Loss: 0.388 Vali Loss: 0.119 Vali Acc: 0.966 Test Loss: 0.119 Test Acc: 0.966
Validation loss decreased (inf --> -0.966347).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0051262
	speed: 0.2049s/iter; left time: 8356.4503s
	iters: 200, epoch: 2 | loss: 0.1008187
	speed: 0.0451s/iter; left time: 1836.0288s
	iters: 300, epoch: 2 | loss: 0.2892026
	speed: 0.0487s/iter; left time: 1975.9688s
	iters: 400, epoch: 2 | loss: 0.2607441
	speed: 0.0539s/iter; left time: 2181.8717s
Epoch: 2 cost time: 20.410805463790894
Epoch: 2, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0004301
	speed: 0.1967s/iter; left time: 7943.6083s
	iters: 200, epoch: 3 | loss: 0.2538801
	speed: 0.0453s/iter; left time: 1826.1562s
	iters: 300, epoch: 3 | loss: 0.0649088
	speed: 0.0536s/iter; left time: 2154.7758s
	iters: 400, epoch: 3 | loss: 0.0042792
	speed: 0.0524s/iter; left time: 2098.2794s
Epoch: 3 cost time: 21.11328125
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.176 Vali Acc: 0.961 Test Loss: 0.176 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6619629
	speed: 0.2055s/iter; left time: 8211.1996s
	iters: 200, epoch: 4 | loss: 0.0028875
	speed: 0.0475s/iter; left time: 1892.3720s
	iters: 300, epoch: 4 | loss: 0.0196993
	speed: 0.0505s/iter; left time: 2008.9239s
	iters: 400, epoch: 4 | loss: 0.0033375
	speed: 0.0500s/iter; left time: 1984.4434s
Epoch: 4 cost time: 21.23499298095703
Epoch: 4, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.163 Vali Acc: 0.966 Test Loss: 0.163 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.3471659
	speed: 0.1960s/iter; left time: 7751.0477s
	iters: 200, epoch: 5 | loss: 0.0682328
	speed: 0.0502s/iter; left time: 1981.0514s
	iters: 300, epoch: 5 | loss: 0.0043289
	speed: 0.0478s/iter; left time: 1881.9021s
	iters: 400, epoch: 5 | loss: 0.0037558
	speed: 0.0519s/iter; left time: 2036.4683s
Epoch: 5 cost time: 21.664466619491577
Epoch: 5, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.177 Vali Acc: 0.964 Test Loss: 0.177 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7341974
	speed: 0.2302s/iter; left time: 9009.6215s
	iters: 200, epoch: 6 | loss: 0.0026890
	speed: 0.0640s/iter; left time: 2499.0478s
	iters: 300, epoch: 6 | loss: 0.0000279
	speed: 0.0639s/iter; left time: 2488.8060s
	iters: 400, epoch: 6 | loss: 0.0000249
	speed: 0.0660s/iter; left time: 2564.2542s
Epoch: 6 cost time: 27.143583297729492
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.251 Vali Acc: 0.963 Test Loss: 0.251 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000026
	speed: 0.2686s/iter; left time: 10402.4729s
	iters: 200, epoch: 7 | loss: 0.0602242
	speed: 0.0679s/iter; left time: 2622.7840s
	iters: 300, epoch: 7 | loss: 0.0000026
	speed: 0.0678s/iter; left time: 2610.7896s
	iters: 400, epoch: 7 | loss: 0.0000275
	speed: 0.0670s/iter; left time: 2572.9627s
Epoch: 7 cost time: 28.23255491256714
Epoch: 7, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
Validation loss decreased (-0.966347 --> -0.975442).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000142
	speed: 0.2546s/iter; left time: 9753.9127s
	iters: 200, epoch: 8 | loss: 0.0000098
	speed: 0.0614s/iter; left time: 2345.1462s
	iters: 300, epoch: 8 | loss: 0.0267379
	speed: 0.0591s/iter; left time: 2250.3981s
	iters: 400, epoch: 8 | loss: 0.0093918
	speed: 0.0585s/iter; left time: 2224.0247s
Epoch: 8 cost time: 26.146634817123413
Epoch: 8, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
Validation loss decreased (-0.975442 --> -0.976352).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000002
	speed: 0.2568s/iter; left time: 9731.5612s
	iters: 200, epoch: 9 | loss: 0.0004205
	speed: 0.0525s/iter; left time: 1985.5039s
	iters: 300, epoch: 9 | loss: 0.0000023
	speed: 0.0565s/iter; left time: 2128.3700s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0543s/iter; left time: 2039.8077s
Epoch: 9 cost time: 24.628445386886597
Epoch: 9, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.190 Vali Acc: 0.971 Test Loss: 0.190 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000122
	speed: 0.2477s/iter; left time: 9283.6201s
	iters: 200, epoch: 10 | loss: 0.0000481
	speed: 0.0488s/iter; left time: 1823.3242s
	iters: 300, epoch: 10 | loss: 0.0000179
	speed: 0.0601s/iter; left time: 2242.5482s
	iters: 400, epoch: 10 | loss: 0.0073627
	speed: 0.0553s/iter; left time: 2058.0839s
Epoch: 10 cost time: 24.079034566879272
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.197 Vali Acc: 0.965 Test Loss: 0.197 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000025
	speed: 0.2541s/iter; left time: 9419.2274s
	iters: 200, epoch: 11 | loss: 0.0000009
	speed: 0.0554s/iter; left time: 2049.9307s
	iters: 300, epoch: 11 | loss: 0.0000025
	speed: 0.0557s/iter; left time: 2054.0742s
	iters: 400, epoch: 11 | loss: 0.0004253
	speed: 0.0530s/iter; left time: 1947.1664s
Epoch: 11 cost time: 24.441769123077393
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.250 Vali Acc: 0.965 Test Loss: 0.250 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0469572
	speed: 0.2437s/iter; left time: 8933.5843s
	iters: 200, epoch: 12 | loss: 0.3787707
	speed: 0.0544s/iter; left time: 1988.0503s
	iters: 300, epoch: 12 | loss: 0.0019123
	speed: 0.0542s/iter; left time: 1975.7510s
	iters: 400, epoch: 12 | loss: 0.0000041
	speed: 0.0563s/iter; left time: 2045.4736s
Epoch: 12 cost time: 24.027085304260254
Epoch: 12, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.311 Vali Acc: 0.965 Test Loss: 0.311 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000042
	speed: 0.2446s/iter; left time: 8865.2750s
	iters: 200, epoch: 13 | loss: 0.0000571
	speed: 0.0540s/iter; left time: 1953.6293s
	iters: 300, epoch: 13 | loss: 0.0140934
	speed: 0.0550s/iter; left time: 1983.8875s
	iters: 400, epoch: 13 | loss: 0.0000051
	speed: 0.0512s/iter; left time: 1841.7948s
Epoch: 13 cost time: 23.594396829605103
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.222 Vali Acc: 0.975 Test Loss: 0.222 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.2446200
	speed: 0.2508s/iter; left time: 8987.7476s
	iters: 200, epoch: 14 | loss: 0.0118445
	speed: 0.0548s/iter; left time: 1958.8631s
	iters: 300, epoch: 14 | loss: 0.0006291
	speed: 0.0578s/iter; left time: 2057.9026s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0548s/iter; left time: 1948.5964s
Epoch: 14 cost time: 23.877281427383423
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.319 Vali Acc: 0.969 Test Loss: 0.319 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0055592
	speed: 0.2441s/iter; left time: 8647.1769s
	iters: 200, epoch: 15 | loss: 0.3008916
	speed: 0.0501s/iter; left time: 1771.0813s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0505s/iter; left time: 1779.1950s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0537s/iter; left time: 1886.1440s
Epoch: 15 cost time: 22.70675802230835
Epoch: 15, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.216 Vali Acc: 0.975 Test Loss: 0.216 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000001
	speed: 0.2430s/iter; left time: 8506.4047s
	iters: 200, epoch: 16 | loss: 0.0000409
	speed: 0.0526s/iter; left time: 1835.0948s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0554s/iter; left time: 1929.6697s
	iters: 400, epoch: 16 | loss: 0.0000111
	speed: 0.0596s/iter; left time: 2067.8337s
Epoch: 16 cost time: 23.687844038009644
Epoch: 16, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.282 Vali Acc: 0.969 Test Loss: 0.282 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2561s/iter; left time: 8860.7374s
	iters: 200, epoch: 17 | loss: 0.1474227
	speed: 0.0497s/iter; left time: 1715.7504s
	iters: 300, epoch: 17 | loss: 0.0022882
	speed: 0.0555s/iter; left time: 1908.9592s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 1807.9464s
Epoch: 17 cost time: 23.552635431289673
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.349 Vali Acc: 0.966 Test Loss: 0.349 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000014
	speed: 0.2379s/iter; left time: 8131.9655s
	iters: 200, epoch: 18 | loss: 0.0000079
	speed: 0.0566s/iter; left time: 1927.8671s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 1812.5641s
	iters: 400, epoch: 18 | loss: 0.0000182
	speed: 0.0533s/iter; left time: 1804.5552s
Epoch: 18 cost time: 23.363086700439453
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 108634
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3473003
	speed: 0.0813s/iter; left time: 3351.6488s
	iters: 200, epoch: 1 | loss: 0.4471627
	speed: 0.0460s/iter; left time: 1891.4798s
	iters: 300, epoch: 1 | loss: 0.0397697
	speed: 0.0460s/iter; left time: 1885.3990s
	iters: 400, epoch: 1 | loss: 0.1050452
	speed: 0.0456s/iter; left time: 1865.2422s
Epoch: 1 cost time: 22.553003072738647
Epoch: 1, Steps: 413 | Train Loss: 0.423 Vali Loss: 0.160 Vali Acc: 0.947 Test Loss: 0.160 Test Acc: 0.947
Validation loss decreased (inf --> -0.947247).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0172697
	speed: 0.1967s/iter; left time: 8022.9424s
	iters: 200, epoch: 2 | loss: 0.0124740
	speed: 0.0475s/iter; left time: 1933.1249s
	iters: 300, epoch: 2 | loss: 0.0223590
	speed: 0.0413s/iter; left time: 1675.8238s
	iters: 400, epoch: 2 | loss: 0.1369901
	speed: 0.0450s/iter; left time: 1823.3014s
Epoch: 2 cost time: 18.736183166503906
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
Validation loss decreased (-0.947247 --> -0.960435).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0022854
	speed: 0.2056s/iter; left time: 8302.7784s
	iters: 200, epoch: 3 | loss: 0.1024139
	speed: 0.0474s/iter; left time: 1909.8050s
	iters: 300, epoch: 3 | loss: 0.0061846
	speed: 0.0427s/iter; left time: 1717.0282s
	iters: 400, epoch: 3 | loss: 0.0031648
	speed: 0.0433s/iter; left time: 1733.4973s
Epoch: 3 cost time: 19.44400954246521
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
Validation loss decreased (-0.960435 --> -0.963164).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0004950
	speed: 0.2169s/iter; left time: 8668.4495s
	iters: 200, epoch: 4 | loss: 0.0566374
	speed: 0.0417s/iter; left time: 1662.3915s
	iters: 300, epoch: 4 | loss: 0.0002658
	speed: 0.0438s/iter; left time: 1741.7448s
	iters: 400, epoch: 4 | loss: 0.0003529
	speed: 0.0454s/iter; left time: 1799.1079s
Epoch: 4 cost time: 19.533405780792236
Epoch: 4, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
Validation loss decreased (-0.963164 --> -0.968166).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0017357
	speed: 0.1991s/iter; left time: 7873.9087s
	iters: 200, epoch: 5 | loss: 0.0007527
	speed: 0.0429s/iter; left time: 1693.3973s
	iters: 300, epoch: 5 | loss: 0.0018052
	speed: 0.0535s/iter; left time: 2106.5397s
	iters: 400, epoch: 5 | loss: 0.0001867
	speed: 0.0510s/iter; left time: 2002.9618s
Epoch: 5 cost time: 21.02151107788086
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0024988
	speed: 0.2032s/iter; left time: 7951.0406s
	iters: 200, epoch: 6 | loss: 0.4813707
	speed: 0.0504s/iter; left time: 1966.5501s
	iters: 300, epoch: 6 | loss: 0.0024721
	speed: 0.0492s/iter; left time: 1915.5774s
	iters: 400, epoch: 6 | loss: 0.1007454
	speed: 0.0482s/iter; left time: 1872.1782s
Epoch: 6 cost time: 20.476237535476685
Epoch: 6, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.188 Vali Acc: 0.957 Test Loss: 0.188 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000057
	speed: 0.1981s/iter; left time: 7671.3933s
	iters: 200, epoch: 7 | loss: 0.1114017
	speed: 0.0493s/iter; left time: 1904.2132s
	iters: 300, epoch: 7 | loss: 0.0000224
	speed: 0.0503s/iter; left time: 1936.7033s
	iters: 400, epoch: 7 | loss: 0.0009001
	speed: 0.0440s/iter; left time: 1690.8062s
Epoch: 7 cost time: 20.09957194328308
Epoch: 7, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0001013
	speed: 0.2066s/iter; left time: 7914.5947s
	iters: 200, epoch: 8 | loss: 0.0000764
	speed: 0.0454s/iter; left time: 1734.8891s
	iters: 300, epoch: 8 | loss: 0.0000058
	speed: 0.0508s/iter; left time: 1934.3874s
	iters: 400, epoch: 8 | loss: 0.0003770
	speed: 0.0445s/iter; left time: 1692.7147s
Epoch: 8 cost time: 20.69915223121643
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0044658
	speed: 0.2223s/iter; left time: 8425.4500s
	iters: 200, epoch: 9 | loss: 0.0000012
	speed: 0.0501s/iter; left time: 1892.3107s
	iters: 300, epoch: 9 | loss: 0.0000021
	speed: 0.0485s/iter; left time: 1826.9208s
	iters: 400, epoch: 9 | loss: 0.0000008
	speed: 0.0404s/iter; left time: 1520.7110s
Epoch: 9 cost time: 20.68005919456482
Epoch: 9, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.208 Vali Acc: 0.964 Test Loss: 0.208 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0001168
	speed: 0.2148s/iter; left time: 8049.9660s
	iters: 200, epoch: 10 | loss: 0.0000217
	speed: 0.0434s/iter; left time: 1623.7294s
	iters: 300, epoch: 10 | loss: 0.0008664
	speed: 0.0457s/iter; left time: 1703.3911s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0420s/iter; left time: 1560.1729s
Epoch: 10 cost time: 19.065698862075806
Epoch: 10, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.218 Vali Acc: 0.965 Test Loss: 0.218 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.2448749
	speed: 0.2151s/iter; left time: 7975.1019s
	iters: 200, epoch: 11 | loss: 0.0024932
	speed: 0.0440s/iter; left time: 1627.9611s
	iters: 300, epoch: 11 | loss: 0.0026232
	speed: 0.0485s/iter; left time: 1788.4624s
	iters: 400, epoch: 11 | loss: 0.0000149
	speed: 0.0497s/iter; left time: 1829.0569s
Epoch: 11 cost time: 20.852973222732544
Epoch: 11, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
Validation loss decreased (-0.968166 --> -0.971804).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0001379
	speed: 0.2173s/iter; left time: 7967.1249s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0554s/iter; left time: 2025.5246s
	iters: 300, epoch: 12 | loss: 0.0000034
	speed: 0.0514s/iter; left time: 1873.4850s
	iters: 400, epoch: 12 | loss: 0.0535119
	speed: 0.0492s/iter; left time: 1788.4278s
Epoch: 12 cost time: 22.120018243789673
Epoch: 12, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.222 Vali Acc: 0.965 Test Loss: 0.222 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000069
	speed: 0.2045s/iter; left time: 7413.1855s
	iters: 200, epoch: 13 | loss: 0.0000064
	speed: 0.0500s/iter; left time: 1805.5752s
	iters: 300, epoch: 13 | loss: 0.0297306
	speed: 0.0511s/iter; left time: 1842.6199s
	iters: 400, epoch: 13 | loss: 0.0000620
	speed: 0.0465s/iter; left time: 1670.1697s
Epoch: 13 cost time: 21.117703914642334
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.235 Vali Acc: 0.971 Test Loss: 0.235 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000963
	speed: 0.2099s/iter; left time: 7519.8683s
	iters: 200, epoch: 14 | loss: 0.0919030
	speed: 0.0452s/iter; left time: 1614.2983s
	iters: 300, epoch: 14 | loss: 0.0000194
	speed: 0.0442s/iter; left time: 1575.6863s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0449s/iter; left time: 1596.8970s
Epoch: 14 cost time: 20.165927410125732
Epoch: 14, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.266 Vali Acc: 0.967 Test Loss: 0.266 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.2074s/iter; left time: 7345.8721s
	iters: 200, epoch: 15 | loss: 0.0408526
	speed: 0.0509s/iter; left time: 1798.1561s
	iters: 300, epoch: 15 | loss: 0.0000034
	speed: 0.0467s/iter; left time: 1644.9896s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0463s/iter; left time: 1626.9734s
Epoch: 15 cost time: 21.255082845687866
Epoch: 15, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.346 Vali Acc: 0.966 Test Loss: 0.346 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000029
	speed: 0.2102s/iter; left time: 7356.9889s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.0484s/iter; left time: 1690.3412s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1763.1792s
	iters: 400, epoch: 16 | loss: 0.0000154
	speed: 0.0505s/iter; left time: 1753.5496s
Epoch: 16 cost time: 21.505828142166138
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.234 Vali Acc: 0.969 Test Loss: 0.234 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000693
	speed: 0.2130s/iter; left time: 7368.7159s
	iters: 200, epoch: 17 | loss: 0.0004968
	speed: 0.0509s/iter; left time: 1756.9809s
	iters: 300, epoch: 17 | loss: 0.1793691
	speed: 0.0529s/iter; left time: 1821.0513s
	iters: 400, epoch: 17 | loss: 0.0041221
	speed: 0.0542s/iter; left time: 1857.7988s
Epoch: 17 cost time: 22.05324673652649
Epoch: 17, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.258 Vali Acc: 0.970 Test Loss: 0.258 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000007
	speed: 0.2097s/iter; left time: 7166.3073s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 1860.4538s
	iters: 300, epoch: 18 | loss: 0.0002266
	speed: 0.0572s/iter; left time: 1942.8419s
	iters: 400, epoch: 18 | loss: 0.1608114
	speed: 0.0547s/iter; left time: 1854.5401s
Epoch: 18 cost time: 23.25787663459778
Epoch: 18, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.285 Vali Acc: 0.968 Test Loss: 0.285 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000011
	speed: 0.2277s/iter; left time: 7689.3334s
	iters: 200, epoch: 19 | loss: 0.4263211
	speed: 0.0487s/iter; left time: 1640.6996s
	iters: 300, epoch: 19 | loss: 0.0000189
	speed: 0.0547s/iter; left time: 1834.6094s
	iters: 400, epoch: 19 | loss: 0.0000004
	speed: 0.0519s/iter; left time: 1735.9874s
Epoch: 19 cost time: 22.49095916748047
Epoch: 19, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.286 Vali Acc: 0.968 Test Loss: 0.286 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000008
	speed: 0.2195s/iter; left time: 7319.6328s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0485s/iter; left time: 1611.7038s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 1499.6183s
	iters: 400, epoch: 20 | loss: 0.0000063
	speed: 0.0437s/iter; left time: 1443.9565s
Epoch: 20 cost time: 20.087819576263428
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.257 Vali Acc: 0.972 Test Loss: 0.257 Test Acc: 0.972
Validation loss decreased (-0.971804 --> -0.972258).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000011
	speed: 0.1991s/iter; left time: 6557.3512s
	iters: 200, epoch: 21 | loss: 0.0006229
	speed: 0.0464s/iter; left time: 1523.8235s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 1610.4510s
	iters: 400, epoch: 21 | loss: 0.0000082
	speed: 0.0453s/iter; left time: 1479.2728s
Epoch: 21 cost time: 20.26111674308777
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.277 Vali Acc: 0.968 Test Loss: 0.277 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2114s/iter; left time: 6874.9042s
	iters: 200, epoch: 22 | loss: 0.0000002
	speed: 0.0456s/iter; left time: 1480.2189s
	iters: 300, epoch: 22 | loss: 0.0000176
	speed: 0.0431s/iter; left time: 1392.7505s
	iters: 400, epoch: 22 | loss: 0.0019694
	speed: 0.0483s/iter; left time: 1556.8607s
Epoch: 22 cost time: 20.43889570236206
Epoch: 22, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
Validation loss decreased (-0.972258 --> -0.975441).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000962
	speed: 0.2238s/iter; left time: 7186.6691s
	iters: 200, epoch: 23 | loss: 0.0901523
	speed: 0.0446s/iter; left time: 1428.3732s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 1534.3993s
	iters: 400, epoch: 23 | loss: 0.0009542
	speed: 0.0504s/iter; left time: 1604.8485s
Epoch: 23 cost time: 20.78852105140686
Epoch: 23, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.235 Vali Acc: 0.973 Test Loss: 0.235 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0008333
	speed: 0.2278s/iter; left time: 7220.8421s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 1561.9045s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 1477.5311s
	iters: 400, epoch: 24 | loss: 0.0620230
	speed: 0.0488s/iter; left time: 1533.3414s
Epoch: 24 cost time: 21.041877508163452
Epoch: 24, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000010
	speed: 0.2280s/iter; left time: 7133.0516s
	iters: 200, epoch: 25 | loss: 0.0001680
	speed: 0.0512s/iter; left time: 1595.3915s
	iters: 300, epoch: 25 | loss: 0.0000002
	speed: 0.0494s/iter; left time: 1534.2470s
	iters: 400, epoch: 25 | loss: 0.0000005
	speed: 0.0512s/iter; left time: 1585.8003s
Epoch: 25 cost time: 21.672754287719727
Epoch: 25, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0002120
	speed: 0.2137s/iter; left time: 6597.1528s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 1447.2665s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.0506s/iter; left time: 1550.8686s
	iters: 400, epoch: 26 | loss: 0.2524089
	speed: 0.0497s/iter; left time: 1520.8397s
Epoch: 26 cost time: 20.969462871551514
Epoch: 26, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.238 Vali Acc: 0.974 Test Loss: 0.238 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000007
	speed: 0.2065s/iter; left time: 6289.2228s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 1457.9752s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 1417.3377s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0446s/iter; left time: 1346.5323s
Epoch: 27 cost time: 20.133544445037842
Epoch: 27, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.973 Test Loss: 0.197 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0044710
	speed: 0.2180s/iter; left time: 6551.4158s
	iters: 200, epoch: 28 | loss: 0.0000063
	speed: 0.0473s/iter; left time: 1416.8820s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1268.8471s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 1252.0997s
Epoch: 28 cost time: 19.505565643310547
Epoch: 28, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.284 Vali Acc: 0.972 Test Loss: 0.284 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0373557
	speed: 0.2026s/iter; left time: 6004.9177s
	iters: 200, epoch: 29 | loss: 0.0000001
	speed: 0.0412s/iter; left time: 1217.6503s
	iters: 300, epoch: 29 | loss: 0.0005592
	speed: 0.0420s/iter; left time: 1235.5706s
	iters: 400, epoch: 29 | loss: 0.0000016
	speed: 0.0423s/iter; left time: 1239.8277s
Epoch: 29 cost time: 18.715011835098267
Epoch: 29, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.974 Test Loss: 0.252 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000020
	speed: 0.1931s/iter; left time: 5644.4857s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1377.3848s
	iters: 300, epoch: 30 | loss: 0.0000009
	speed: 0.0445s/iter; left time: 1291.8063s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1313.4037s
Epoch: 30 cost time: 19.87889003753662
Epoch: 30, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.970 Test Loss: 0.310 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0093274
	speed: 0.2049s/iter; left time: 5904.5533s
	iters: 200, epoch: 31 | loss: 0.0000002
	speed: 0.0524s/iter; left time: 1504.4775s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 1335.4396s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0475s/iter; left time: 1354.4285s
Epoch: 31 cost time: 21.354313850402832
Epoch: 31, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.311 Vali Acc: 0.975 Test Loss: 0.311 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2018s/iter; left time: 5729.8118s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1202.2783s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1309.6569s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1302.7387s
Epoch: 32 cost time: 19.896864652633667
Epoch: 32, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.255 Vali Acc: 0.972 Test Loss: 0.255 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 75386
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6361039
	speed: 0.0850s/iter; left time: 3503.8023s
	iters: 200, epoch: 1 | loss: 0.1885601
	speed: 0.0429s/iter; left time: 1761.3845s
	iters: 300, epoch: 1 | loss: 0.0822794
	speed: 0.0429s/iter; left time: 1759.4258s
	iters: 400, epoch: 1 | loss: 0.0292362
	speed: 0.0422s/iter; left time: 1726.5717s
Epoch: 1 cost time: 21.964298248291016
Epoch: 1, Steps: 413 | Train Loss: 0.492 Vali Loss: 0.160 Vali Acc: 0.947 Test Loss: 0.160 Test Acc: 0.947
Validation loss decreased (inf --> -0.946792).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0682298
	speed: 0.1912s/iter; left time: 7796.8743s
	iters: 200, epoch: 2 | loss: 0.0885886
	speed: 0.0465s/iter; left time: 1891.0506s
	iters: 300, epoch: 2 | loss: 0.0318817
	speed: 0.0476s/iter; left time: 1932.4115s
	iters: 400, epoch: 2 | loss: 0.1336258
	speed: 0.0425s/iter; left time: 1721.4381s
Epoch: 2 cost time: 19.420578241348267
Epoch: 2, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.112 Vali Acc: 0.960 Test Loss: 0.112 Test Acc: 0.960
Validation loss decreased (-0.946792 --> -0.959526).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1721382
	speed: 0.1849s/iter; left time: 7465.0018s
	iters: 200, epoch: 3 | loss: 0.0035939
	speed: 0.0522s/iter; left time: 2102.8219s
	iters: 300, epoch: 3 | loss: 0.0075935
	speed: 0.0506s/iter; left time: 2032.2807s
	iters: 400, epoch: 3 | loss: 0.0014855
	speed: 0.0473s/iter; left time: 1896.5505s
Epoch: 3 cost time: 20.780951738357544
Epoch: 3, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.959526 --> -0.972714).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0008777
	speed: 0.1981s/iter; left time: 7917.9540s
	iters: 200, epoch: 4 | loss: 0.0016940
	speed: 0.0486s/iter; left time: 1935.4779s
	iters: 300, epoch: 4 | loss: 0.0126817
	speed: 0.0449s/iter; left time: 1786.8343s
	iters: 400, epoch: 4 | loss: 0.0007145
	speed: 0.0515s/iter; left time: 2043.8792s
Epoch: 4 cost time: 20.961545705795288
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0108255
	speed: 0.1925s/iter; left time: 7613.6647s
	iters: 200, epoch: 5 | loss: 0.0035898
	speed: 0.0467s/iter; left time: 1840.7329s
	iters: 300, epoch: 5 | loss: 0.0018823
	speed: 0.0489s/iter; left time: 1924.5532s
	iters: 400, epoch: 5 | loss: 0.0006063
	speed: 0.0449s/iter; left time: 1763.7238s
Epoch: 5 cost time: 19.572776556015015
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0388689
	speed: 0.2067s/iter; left time: 8090.7759s
	iters: 200, epoch: 6 | loss: 0.0003988
	speed: 0.0506s/iter; left time: 1973.5446s
	iters: 300, epoch: 6 | loss: 0.0782013
	speed: 0.0500s/iter; left time: 1947.5464s
	iters: 400, epoch: 6 | loss: 0.0406893
	speed: 0.0491s/iter; left time: 1906.0300s
Epoch: 6 cost time: 21.21900177001953
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0237418
	speed: 0.2079s/iter; left time: 8051.1191s
	iters: 200, epoch: 7 | loss: 0.0000402
	speed: 0.0513s/iter; left time: 1980.0586s
	iters: 300, epoch: 7 | loss: 0.0000002
	speed: 0.0477s/iter; left time: 1835.9470s
	iters: 400, epoch: 7 | loss: 0.0123144
	speed: 0.0529s/iter; left time: 2031.6228s
Epoch: 7 cost time: 21.84396743774414
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0049059
	speed: 0.1967s/iter; left time: 7536.0805s
	iters: 200, epoch: 8 | loss: 0.0001494
	speed: 0.0430s/iter; left time: 1642.4943s
	iters: 300, epoch: 8 | loss: 0.0069275
	speed: 0.0432s/iter; left time: 1646.8533s
	iters: 400, epoch: 8 | loss: 0.0004942
	speed: 0.0456s/iter; left time: 1734.7706s
Epoch: 8 cost time: 18.938437938690186
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.231 Vali Acc: 0.961 Test Loss: 0.231 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0042001
	speed: 0.1902s/iter; left time: 7209.1320s
	iters: 200, epoch: 9 | loss: 0.0003545
	speed: 0.0461s/iter; left time: 1743.1775s
	iters: 300, epoch: 9 | loss: 0.0000002
	speed: 0.0428s/iter; left time: 1612.4068s
	iters: 400, epoch: 9 | loss: 0.0000793
	speed: 0.0497s/iter; left time: 1866.7343s
Epoch: 9 cost time: 19.739682912826538
Epoch: 9, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0079591
	speed: 0.1987s/iter; left time: 7448.1987s
	iters: 200, epoch: 10 | loss: 0.0414906
	speed: 0.0414s/iter; left time: 1549.1174s
	iters: 300, epoch: 10 | loss: 0.0000474
	speed: 0.0444s/iter; left time: 1655.8969s
	iters: 400, epoch: 10 | loss: 0.0000070
	speed: 0.0482s/iter; left time: 1791.1821s
Epoch: 10 cost time: 19.53707194328308
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.972714 --> -0.974987).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0248141
	speed: 0.1972s/iter; left time: 7309.4726s
	iters: 200, epoch: 11 | loss: 0.0000076
	speed: 0.0397s/iter; left time: 1466.8993s
	iters: 300, epoch: 11 | loss: 0.0000693
	speed: 0.0422s/iter; left time: 1554.6080s
	iters: 400, epoch: 11 | loss: 0.1722278
	speed: 0.0461s/iter; left time: 1696.0245s
Epoch: 11 cost time: 18.264703273773193
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.257 Vali Acc: 0.960 Test Loss: 0.257 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0004263
	speed: 0.2081s/iter; left time: 7629.4809s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.0447s/iter; left time: 1634.2235s
	iters: 300, epoch: 12 | loss: 0.0000023
	speed: 0.0481s/iter; left time: 1751.9994s
	iters: 400, epoch: 12 | loss: 0.0000028
	speed: 0.0473s/iter; left time: 1720.1350s
Epoch: 12 cost time: 20.512736797332764
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.177 Vali Acc: 0.974 Test Loss: 0.177 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000135
	speed: 0.2090s/iter; left time: 7576.2068s
	iters: 200, epoch: 13 | loss: 0.0000002
	speed: 0.0509s/iter; left time: 1840.5279s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0495s/iter; left time: 1783.5228s
	iters: 400, epoch: 13 | loss: 0.0000243
	speed: 0.0460s/iter; left time: 1654.2501s
Epoch: 13 cost time: 21.5890851020813
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.974 Test Loss: 0.167 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000002
	speed: 0.2108s/iter; left time: 7551.9812s
	iters: 200, epoch: 14 | loss: 0.0000306
	speed: 0.0489s/iter; left time: 1748.8810s
	iters: 300, epoch: 14 | loss: 0.0001962
	speed: 0.0509s/iter; left time: 1815.4231s
	iters: 400, epoch: 14 | loss: 0.0000889
	speed: 0.0516s/iter; left time: 1834.9878s
Epoch: 14 cost time: 21.56360411643982
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.151 Vali Acc: 0.974 Test Loss: 0.151 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000020
	speed: 0.2132s/iter; left time: 7551.5138s
	iters: 200, epoch: 15 | loss: 0.0002538
	speed: 0.0461s/iter; left time: 1629.6606s
	iters: 300, epoch: 15 | loss: 0.0570894
	speed: 0.0453s/iter; left time: 1594.0655s
	iters: 400, epoch: 15 | loss: 0.0030511
	speed: 0.0523s/iter; left time: 1838.4533s
Epoch: 15 cost time: 20.80612015724182
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.236 Vali Acc: 0.971 Test Loss: 0.236 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0003548
	speed: 0.2143s/iter; left time: 7502.4904s
	iters: 200, epoch: 16 | loss: 0.0000020
	speed: 0.0397s/iter; left time: 1386.2727s
	iters: 300, epoch: 16 | loss: 0.0000007
	speed: 0.0392s/iter; left time: 1363.6910s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 1345.3485s
Epoch: 16 cost time: 18.04931950569153
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000095
	speed: 0.1872s/iter; left time: 6474.9213s
	iters: 200, epoch: 17 | loss: 0.0032545
	speed: 0.0401s/iter; left time: 1382.7093s
	iters: 300, epoch: 17 | loss: 0.0000007
	speed: 0.0459s/iter; left time: 1579.3726s
	iters: 400, epoch: 17 | loss: 0.0011733
	speed: 0.0452s/iter; left time: 1548.6402s
Epoch: 17 cost time: 18.56709337234497
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000012
	speed: 0.1870s/iter; left time: 6389.9665s
	iters: 200, epoch: 18 | loss: 0.0003966
	speed: 0.0420s/iter; left time: 1432.3624s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0419s/iter; left time: 1422.6616s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0451s/iter; left time: 1527.7331s
Epoch: 18 cost time: 18.637197732925415
Epoch: 18, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.240 Vali Acc: 0.971 Test Loss: 0.240 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000060
	speed: 0.1871s/iter; left time: 6316.6351s
	iters: 200, epoch: 19 | loss: 0.0008970
	speed: 0.0420s/iter; left time: 1414.5715s
	iters: 300, epoch: 19 | loss: 0.5563942
	speed: 0.0416s/iter; left time: 1395.0351s
	iters: 400, epoch: 19 | loss: 0.0677079
	speed: 0.0468s/iter; left time: 1565.5590s
Epoch: 19 cost time: 18.87413263320923
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0004863
	speed: 0.1855s/iter; left time: 6185.5039s
	iters: 200, epoch: 20 | loss: 0.0000002
	speed: 0.0440s/iter; left time: 1462.6174s
	iters: 300, epoch: 20 | loss: 0.0001631
	speed: 0.0454s/iter; left time: 1504.3480s
	iters: 400, epoch: 20 | loss: 0.0000019
	speed: 0.0425s/iter; left time: 1404.2316s
Epoch: 20 cost time: 19.130694150924683
Epoch: 20, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.224 Vali Acc: 0.977 Test Loss: 0.224 Test Acc: 0.977
Validation loss decreased (-0.974987 --> -0.977260).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000195
	speed: 0.1853s/iter; left time: 6104.4019s
	iters: 200, epoch: 21 | loss: 0.0000066
	speed: 0.0411s/iter; left time: 1348.6766s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 1410.6264s
	iters: 400, epoch: 21 | loss: 0.0016864
	speed: 0.0465s/iter; left time: 1516.3383s
Epoch: 21 cost time: 18.53165626525879
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.241 Vali Acc: 0.976 Test Loss: 0.241 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0010275
	speed: 0.1803s/iter; left time: 5865.9187s
	iters: 200, epoch: 22 | loss: 0.0000012
	speed: 0.0405s/iter; left time: 1314.4790s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.0396s/iter; left time: 1280.8250s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0416s/iter; left time: 1339.7728s
Epoch: 22 cost time: 17.711660861968994
Epoch: 22, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.218 Vali Acc: 0.972 Test Loss: 0.218 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0026359
	speed: 0.1819s/iter; left time: 5841.3669s
	iters: 200, epoch: 23 | loss: 0.0000001
	speed: 0.0435s/iter; left time: 1393.4469s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 1420.5109s
	iters: 400, epoch: 23 | loss: 0.0000028
	speed: 0.0369s/iter; left time: 1175.0697s
Epoch: 23 cost time: 17.953890323638916
Epoch: 23, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.240 Vali Acc: 0.970 Test Loss: 0.240 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000571
	speed: 0.1915s/iter; left time: 6070.1364s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 1453.9389s
	iters: 300, epoch: 24 | loss: 0.0000062
	speed: 0.0417s/iter; left time: 1315.0137s
	iters: 400, epoch: 24 | loss: 0.1067547
	speed: 0.0380s/iter; left time: 1192.6883s
Epoch: 24 cost time: 18.48503613471985
Epoch: 24, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.251 Vali Acc: 0.974 Test Loss: 0.251 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000327
	speed: 0.1709s/iter; left time: 5348.0329s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 1380.9873s
	iters: 300, epoch: 25 | loss: 0.0003772
	speed: 0.0428s/iter; left time: 1330.1368s
	iters: 400, epoch: 25 | loss: 0.0044705
	speed: 0.0439s/iter; left time: 1360.4220s
Epoch: 25 cost time: 18.661240339279175
Epoch: 25, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.297 Vali Acc: 0.966 Test Loss: 0.297 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0084952
	speed: 0.1741s/iter; left time: 5376.8775s
	iters: 200, epoch: 26 | loss: 0.0000860
	speed: 0.0382s/iter; left time: 1175.1319s
	iters: 300, epoch: 26 | loss: 0.0000017
	speed: 0.0421s/iter; left time: 1290.6698s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.0373s/iter; left time: 1140.2652s
Epoch: 26 cost time: 16.813918828964233
Epoch: 26, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.969 Test Loss: 0.215 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1743s/iter; left time: 5310.2414s
	iters: 200, epoch: 27 | loss: 0.0000001
	speed: 0.0422s/iter; left time: 1280.7681s
	iters: 300, epoch: 27 | loss: 0.0000001
	speed: 0.0384s/iter; left time: 1163.2583s
	iters: 400, epoch: 27 | loss: 0.0000002
	speed: 0.0420s/iter; left time: 1265.9538s
Epoch: 27 cost time: 17.436718702316284
Epoch: 27, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.225 Vali Acc: 0.974 Test Loss: 0.225 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000011
	speed: 0.1860s/iter; left time: 5589.5661s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 1262.0858s
	iters: 300, epoch: 28 | loss: 0.0000013
	speed: 0.0412s/iter; left time: 1229.4404s
	iters: 400, epoch: 28 | loss: 0.1124332
	speed: 0.0472s/iter; left time: 1404.6047s
Epoch: 28 cost time: 18.563903331756592
Epoch: 28, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.209 Vali Acc: 0.974 Test Loss: 0.209 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1951s/iter; left time: 5782.8974s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1392.7640s
	iters: 300, epoch: 29 | loss: 0.0000015
	speed: 0.0449s/iter; left time: 1320.4995s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 1514.6695s
Epoch: 29 cost time: 20.129969596862793
Epoch: 29, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2021s/iter; left time: 5906.9078s
	iters: 200, epoch: 30 | loss: 0.0000001
	speed: 0.0432s/iter; left time: 1259.1145s
	iters: 300, epoch: 30 | loss: 0.0000101
	speed: 0.0492s/iter; left time: 1428.1719s
	iters: 400, epoch: 30 | loss: 0.0000001
	speed: 0.0451s/iter; left time: 1305.4362s
Epoch: 30 cost time: 19.920582056045532
Epoch: 30, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.976 Test Loss: 0.222 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.977262391996362
model parameter : 58778
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6321128
	speed: 0.0788s/iter; left time: 3244.7815s
	iters: 200, epoch: 1 | loss: 0.1603610
	speed: 0.0447s/iter; left time: 1838.4023s
	iters: 300, epoch: 1 | loss: 0.0562006
	speed: 0.0468s/iter; left time: 1918.1725s
	iters: 400, epoch: 1 | loss: 0.1056021
	speed: 0.0447s/iter; left time: 1829.1167s
Epoch: 1 cost time: 22.054698944091797
Epoch: 1, Steps: 413 | Train Loss: 0.528 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
Validation loss decreased (inf --> -0.962254).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0254641
	speed: 0.1954s/iter; left time: 7968.9103s
	iters: 200, epoch: 2 | loss: 0.0110539
	speed: 0.0513s/iter; left time: 2085.8042s
	iters: 300, epoch: 2 | loss: 0.4716289
	speed: 0.0502s/iter; left time: 2037.2130s
	iters: 400, epoch: 2 | loss: 0.3986285
	speed: 0.0460s/iter; left time: 1863.5124s
Epoch: 2 cost time: 20.495921850204468
Epoch: 2, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.109 Vali Acc: 0.961 Test Loss: 0.109 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1135008
	speed: 0.2158s/iter; left time: 8712.5975s
	iters: 200, epoch: 3 | loss: 0.0079411
	speed: 0.0469s/iter; left time: 1890.7941s
	iters: 300, epoch: 3 | loss: 0.0011367
	speed: 0.0483s/iter; left time: 1940.5843s
	iters: 400, epoch: 3 | loss: 0.0760407
	speed: 0.0546s/iter; left time: 2186.0947s
Epoch: 3 cost time: 21.444165468215942
Epoch: 3, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.095 Vali Acc: 0.963 Test Loss: 0.095 Test Acc: 0.963
Validation loss decreased (-0.962254 --> -0.962709).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0018493
	speed: 0.2156s/iter; left time: 8616.0572s
	iters: 200, epoch: 4 | loss: 0.0177145
	speed: 0.0483s/iter; left time: 1925.8727s
	iters: 300, epoch: 4 | loss: 0.0348734
	speed: 0.0497s/iter; left time: 1977.4338s
	iters: 400, epoch: 4 | loss: 0.0284611
	speed: 0.0535s/iter; left time: 2123.3517s
Epoch: 4 cost time: 22.0707528591156
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.966 Test Loss: 0.103 Test Acc: 0.966
Validation loss decreased (-0.962709 --> -0.965893).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0016757
	speed: 0.2212s/iter; left time: 8747.7395s
	iters: 200, epoch: 5 | loss: 0.0193038
	speed: 0.0510s/iter; left time: 2010.2445s
	iters: 300, epoch: 5 | loss: 0.0014528
	speed: 0.0465s/iter; left time: 1828.7366s
	iters: 400, epoch: 5 | loss: 0.2482740
	speed: 0.0498s/iter; left time: 1953.9896s
Epoch: 5 cost time: 21.489030838012695
Epoch: 5, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.965893 --> -0.977262).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0050898
	speed: 0.2106s/iter; left time: 8243.9729s
	iters: 200, epoch: 6 | loss: 0.1766325
	speed: 0.0487s/iter; left time: 1902.4883s
	iters: 300, epoch: 6 | loss: 0.0004742
	speed: 0.0495s/iter; left time: 1925.5493s
	iters: 400, epoch: 6 | loss: 0.0032653
	speed: 0.0479s/iter; left time: 1860.1771s
Epoch: 6 cost time: 21.087332487106323
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000108
	speed: 0.2038s/iter; left time: 7891.6163s
	iters: 200, epoch: 7 | loss: 0.0109718
	speed: 0.0506s/iter; left time: 1952.7307s
	iters: 300, epoch: 7 | loss: 0.0676396
	speed: 0.0500s/iter; left time: 1927.8315s
	iters: 400, epoch: 7 | loss: 0.0000472
	speed: 0.0501s/iter; left time: 1925.2580s
Epoch: 7 cost time: 21.264065980911255
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0925483
	speed: 0.2095s/iter; left time: 8027.0024s
	iters: 200, epoch: 8 | loss: 0.0000099
	speed: 0.0434s/iter; left time: 1659.9582s
	iters: 300, epoch: 8 | loss: 0.0015487
	speed: 0.0489s/iter; left time: 1863.5541s
	iters: 400, epoch: 8 | loss: 0.0011622
	speed: 0.0466s/iter; left time: 1772.0317s
Epoch: 8 cost time: 20.504115104675293
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0004072
	speed: 0.2040s/iter; left time: 7731.2183s
	iters: 200, epoch: 9 | loss: 0.0020640
	speed: 0.0486s/iter; left time: 1837.3392s
	iters: 300, epoch: 9 | loss: 0.0149518
	speed: 0.0470s/iter; left time: 1771.9807s
	iters: 400, epoch: 9 | loss: 0.2343263
	speed: 0.0421s/iter; left time: 1584.1816s
Epoch: 9 cost time: 19.822322368621826
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1882784
	speed: 0.1985s/iter; left time: 7439.4799s
	iters: 200, epoch: 10 | loss: 0.0000010
	speed: 0.0498s/iter; left time: 1859.9853s
	iters: 300, epoch: 10 | loss: 0.0000151
	speed: 0.0481s/iter; left time: 1793.9264s
	iters: 400, epoch: 10 | loss: 0.0007204
	speed: 0.0502s/iter; left time: 1867.7079s
Epoch: 10 cost time: 20.780811548233032
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.159 Vali Acc: 0.966 Test Loss: 0.159 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000287
	speed: 0.2049s/iter; left time: 7597.5558s
	iters: 200, epoch: 11 | loss: 0.0051684
	speed: 0.0510s/iter; left time: 1886.1345s
	iters: 300, epoch: 11 | loss: 0.0036988
	speed: 0.0500s/iter; left time: 1842.2768s
	iters: 400, epoch: 11 | loss: 0.0014575
	speed: 0.0480s/iter; left time: 1765.2798s
Epoch: 11 cost time: 21.52932643890381
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000020
	speed: 0.2165s/iter; left time: 7936.2880s
	iters: 200, epoch: 12 | loss: 0.0000138
	speed: 0.0487s/iter; left time: 1781.2755s
	iters: 300, epoch: 12 | loss: 0.0038797
	speed: 0.0493s/iter; left time: 1797.0973s
	iters: 400, epoch: 12 | loss: 0.0155820
	speed: 0.0453s/iter; left time: 1647.4879s
Epoch: 12 cost time: 21.05926275253296
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
Validation loss decreased (-0.977262 --> -0.979080).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0018208
	speed: 0.1963s/iter; left time: 7116.5595s
	iters: 200, epoch: 13 | loss: 0.1298548
	speed: 0.0468s/iter; left time: 1691.3666s
	iters: 300, epoch: 13 | loss: 0.0361240
	speed: 0.0417s/iter; left time: 1504.4938s
	iters: 400, epoch: 13 | loss: 0.0001647
	speed: 0.0448s/iter; left time: 1609.7588s
Epoch: 13 cost time: 19.156107187271118
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000284
	speed: 0.2005s/iter; left time: 7185.7679s
	iters: 200, epoch: 14 | loss: 0.0012662
	speed: 0.0446s/iter; left time: 1594.7772s
	iters: 300, epoch: 14 | loss: 0.0002352
	speed: 0.0455s/iter; left time: 1619.5121s
	iters: 400, epoch: 14 | loss: 0.0003450
	speed: 0.0393s/iter; left time: 1397.8801s
Epoch: 14 cost time: 19.058244228363037
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000002
	speed: 0.1930s/iter; left time: 6835.7743s
	iters: 200, epoch: 15 | loss: 0.0000037
	speed: 0.0433s/iter; left time: 1528.3903s
	iters: 300, epoch: 15 | loss: 0.0005881
	speed: 0.0417s/iter; left time: 1467.8779s
	iters: 400, epoch: 15 | loss: 0.0014728
	speed: 0.0438s/iter; left time: 1538.8467s
Epoch: 15 cost time: 18.643982648849487
Epoch: 15, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
Validation loss decreased (-0.979080 --> -0.982264).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0016664
	speed: 0.1866s/iter; left time: 6530.8853s
	iters: 200, epoch: 16 | loss: 0.0004699
	speed: 0.0419s/iter; left time: 1461.1938s
	iters: 300, epoch: 16 | loss: 0.0000936
	speed: 0.0381s/iter; left time: 1324.3716s
	iters: 400, epoch: 16 | loss: 0.0028759
	speed: 0.0381s/iter; left time: 1321.5664s
Epoch: 16 cost time: 17.281774759292603
Epoch: 16, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.182 Vali Acc: 0.971 Test Loss: 0.182 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000270
	speed: 0.1927s/iter; left time: 6667.4351s
	iters: 200, epoch: 17 | loss: 0.0024619
	speed: 0.0395s/iter; left time: 1363.7317s
	iters: 300, epoch: 17 | loss: 0.0002099
	speed: 0.0446s/iter; left time: 1532.4090s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 1543.3530s
Epoch: 17 cost time: 18.52801775932312
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0007157
	speed: 0.1914s/iter; left time: 6543.7176s
	iters: 200, epoch: 18 | loss: 0.0412207
	speed: 0.0454s/iter; left time: 1547.2235s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 1585.9999s
	iters: 400, epoch: 18 | loss: 0.0000274
	speed: 0.0425s/iter; left time: 1439.0370s
Epoch: 18 cost time: 19.609612226486206
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.199 Vali Acc: 0.970 Test Loss: 0.199 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1977s/iter; left time: 6675.3973s
	iters: 200, epoch: 19 | loss: 0.0000034
	speed: 0.0475s/iter; left time: 1600.5913s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 1707.6302s
	iters: 400, epoch: 19 | loss: 0.0000012
	speed: 0.0411s/iter; left time: 1375.7026s
Epoch: 19 cost time: 20.575198650360107
Epoch: 19, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.153 Vali Acc: 0.979 Test Loss: 0.153 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0002754
	speed: 0.1719s/iter; left time: 5734.8180s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 1417.1130s
	iters: 300, epoch: 20 | loss: 0.0000143
	speed: 0.0406s/iter; left time: 1347.4903s
	iters: 400, epoch: 20 | loss: 0.1585505
	speed: 0.0385s/iter; left time: 1272.6579s
Epoch: 20 cost time: 17.566771745681763
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000003
	speed: 0.1792s/iter; left time: 5901.8005s
	iters: 200, epoch: 21 | loss: 0.0000034
	speed: 0.0429s/iter; left time: 1409.3524s
	iters: 300, epoch: 21 | loss: 0.3324576
	speed: 0.0503s/iter; left time: 1646.0480s
	iters: 400, epoch: 21 | loss: 0.2695401
	speed: 0.0405s/iter; left time: 1320.4801s
Epoch: 21 cost time: 19.17440390586853
Epoch: 21, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0046350
	speed: 0.1838s/iter; left time: 5979.0909s
	iters: 200, epoch: 22 | loss: 0.0000169
	speed: 0.0467s/iter; left time: 1515.7458s
	iters: 300, epoch: 22 | loss: 0.0000754
	speed: 0.0462s/iter; left time: 1492.1875s
	iters: 400, epoch: 22 | loss: 0.0000076
	speed: 0.0413s/iter; left time: 1331.0752s
Epoch: 22 cost time: 19.765907526016235
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.166 Vali Acc: 0.978 Test Loss: 0.166 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1892s/iter; left time: 6075.6677s
	iters: 200, epoch: 23 | loss: 0.0472627
	speed: 0.0442s/iter; left time: 1415.3473s
	iters: 300, epoch: 23 | loss: 0.0000423
	speed: 0.0484s/iter; left time: 1543.6173s
	iters: 400, epoch: 23 | loss: 0.0035513
	speed: 0.0466s/iter; left time: 1481.6237s
Epoch: 23 cost time: 20.052956104278564
Epoch: 23, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0009822
	speed: 0.1838s/iter; left time: 5827.6148s
	iters: 200, epoch: 24 | loss: 0.0000007
	speed: 0.0433s/iter; left time: 1367.3094s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 1330.2185s
	iters: 400, epoch: 24 | loss: 0.0019430
	speed: 0.0438s/iter; left time: 1376.1169s
Epoch: 24 cost time: 18.659112215042114
Epoch: 24, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.159 Vali Acc: 0.979 Test Loss: 0.159 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1842s/iter; left time: 5764.0981s
	iters: 200, epoch: 25 | loss: 0.0018507
	speed: 0.0423s/iter; left time: 1319.7249s
	iters: 300, epoch: 25 | loss: 0.0000014
	speed: 0.0389s/iter; left time: 1208.6649s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 1270.0438s
Epoch: 25 cost time: 17.76222848892212
Epoch: 25, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.178 Vali Acc: 0.974 Test Loss: 0.178 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 48426
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9324008
	speed: 0.0705s/iter; left time: 2906.3737s
	iters: 200, epoch: 1 | loss: 0.1444064
	speed: 0.0464s/iter; left time: 1908.2630s
	iters: 300, epoch: 1 | loss: 0.1225536
	speed: 0.0504s/iter; left time: 2068.1180s
	iters: 400, epoch: 1 | loss: 0.1379264
	speed: 0.0504s/iter; left time: 2061.3580s
Epoch: 1 cost time: 22.439735174179077
Epoch: 1, Steps: 413 | Train Loss: 0.619 Vali Loss: 0.102 Vali Acc: 0.967 Test Loss: 0.102 Test Acc: 0.967
Validation loss decreased (inf --> -0.966802).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1455591
	speed: 0.1917s/iter; left time: 7819.2426s
	iters: 200, epoch: 2 | loss: 0.1711750
	speed: 0.0439s/iter; left time: 1784.8301s
	iters: 300, epoch: 2 | loss: 0.1658116
	speed: 0.0503s/iter; left time: 2042.1503s
	iters: 400, epoch: 2 | loss: 0.0136711
	speed: 0.0448s/iter; left time: 1814.0500s
Epoch: 2 cost time: 19.629314661026
Epoch: 2, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
Validation loss decreased (-0.966802 --> -0.968166).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0223426
	speed: 0.1854s/iter; left time: 7486.6071s
	iters: 200, epoch: 3 | loss: 0.0229704
	speed: 0.0465s/iter; left time: 1874.2907s
	iters: 300, epoch: 3 | loss: 0.0899239
	speed: 0.0456s/iter; left time: 1832.2470s
	iters: 400, epoch: 3 | loss: 0.0421824
	speed: 0.0476s/iter; left time: 1905.7879s
Epoch: 3 cost time: 19.911173343658447
Epoch: 3, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.062 Vali Acc: 0.976 Test Loss: 0.062 Test Acc: 0.976
Validation loss decreased (-0.968166 --> -0.976352).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0008868
	speed: 0.1853s/iter; left time: 7406.5517s
	iters: 200, epoch: 4 | loss: 0.0044382
	speed: 0.0426s/iter; left time: 1698.2121s
	iters: 300, epoch: 4 | loss: 0.0058818
	speed: 0.0454s/iter; left time: 1803.9341s
	iters: 400, epoch: 4 | loss: 0.0413134
	speed: 0.0508s/iter; left time: 2013.5199s
Epoch: 4 cost time: 19.755849599838257
Epoch: 4, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.081 Vali Acc: 0.972 Test Loss: 0.081 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0011402
	speed: 0.1998s/iter; left time: 7901.1801s
	iters: 200, epoch: 5 | loss: 0.0137711
	speed: 0.0458s/iter; left time: 1805.1543s
	iters: 300, epoch: 5 | loss: 0.0789398
	speed: 0.0487s/iter; left time: 1916.6724s
	iters: 400, epoch: 5 | loss: 0.0020946
	speed: 0.0451s/iter; left time: 1771.7901s
Epoch: 5 cost time: 20.27217745780945
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0022450
	speed: 0.2041s/iter; left time: 7989.0731s
	iters: 200, epoch: 6 | loss: 0.0055010
	speed: 0.0464s/iter; left time: 1812.8102s
	iters: 300, epoch: 6 | loss: 0.0054068
	speed: 0.0480s/iter; left time: 1869.8045s
	iters: 400, epoch: 6 | loss: 0.0151228
	speed: 0.0535s/iter; left time: 2077.9487s
Epoch: 6 cost time: 20.789661645889282
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0023223
	speed: 0.1925s/iter; left time: 7453.7686s
	iters: 200, epoch: 7 | loss: 0.0003129
	speed: 0.0515s/iter; left time: 1988.3781s
	iters: 300, epoch: 7 | loss: 0.0244313
	speed: 0.0506s/iter; left time: 1949.7515s
	iters: 400, epoch: 7 | loss: 0.0187910
	speed: 0.0485s/iter; left time: 1864.3552s
Epoch: 7 cost time: 20.88688325881958
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0015394
	speed: 0.2070s/iter; left time: 7932.0556s
	iters: 200, epoch: 8 | loss: 0.0001178
	speed: 0.0499s/iter; left time: 1904.8829s
	iters: 300, epoch: 8 | loss: 0.0014570
	speed: 0.0494s/iter; left time: 1882.4613s
	iters: 400, epoch: 8 | loss: 0.0022871
	speed: 0.0545s/iter; left time: 2072.3535s
Epoch: 8 cost time: 21.88207459449768
Epoch: 8, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.976352 --> -0.977716).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0029018
	speed: 0.1933s/iter; left time: 7326.7931s
	iters: 200, epoch: 9 | loss: 0.0019966
	speed: 0.0472s/iter; left time: 1784.0778s
	iters: 300, epoch: 9 | loss: 0.0007190
	speed: 0.0507s/iter; left time: 1912.9711s
	iters: 400, epoch: 9 | loss: 0.1770986
	speed: 0.0464s/iter; left time: 1742.9712s
Epoch: 9 cost time: 20.79838991165161
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0123661
	speed: 0.1957s/iter; left time: 7335.1895s
	iters: 200, epoch: 10 | loss: 0.0000121
	speed: 0.0501s/iter; left time: 1874.3852s
	iters: 300, epoch: 10 | loss: 0.0283556
	speed: 0.0483s/iter; left time: 1800.5257s
	iters: 400, epoch: 10 | loss: 0.0000107
	speed: 0.0492s/iter; left time: 1829.8982s
Epoch: 10 cost time: 20.46163821220398
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0017350
	speed: 0.2000s/iter; left time: 7415.1174s
	iters: 200, epoch: 11 | loss: 0.0001387
	speed: 0.0471s/iter; left time: 1740.7876s
	iters: 300, epoch: 11 | loss: 0.0077316
	speed: 0.0430s/iter; left time: 1585.8340s
	iters: 400, epoch: 11 | loss: 0.0029749
	speed: 0.0447s/iter; left time: 1644.8283s
Epoch: 11 cost time: 19.435014486312866
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0017892
	speed: 0.1997s/iter; left time: 7319.1021s
	iters: 200, epoch: 12 | loss: 0.0000739
	speed: 0.0514s/iter; left time: 1877.6214s
	iters: 300, epoch: 12 | loss: 0.0131073
	speed: 0.0486s/iter; left time: 1772.0403s
	iters: 400, epoch: 12 | loss: 0.1806050
	speed: 0.0448s/iter; left time: 1627.7064s
Epoch: 12 cost time: 20.64804458618164
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000504
	speed: 0.2080s/iter; left time: 7538.8063s
	iters: 200, epoch: 13 | loss: 0.0048292
	speed: 0.0465s/iter; left time: 1682.3546s
	iters: 300, epoch: 13 | loss: 0.0030790
	speed: 0.0433s/iter; left time: 1561.7440s
	iters: 400, epoch: 13 | loss: 0.0011256
	speed: 0.0464s/iter; left time: 1669.3421s
Epoch: 13 cost time: 20.080646276474
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0019680
	speed: 0.2036s/iter; left time: 7296.6639s
	iters: 200, epoch: 14 | loss: 0.0052594
	speed: 0.0488s/iter; left time: 1744.7502s
	iters: 300, epoch: 14 | loss: 0.6551953
	speed: 0.0466s/iter; left time: 1660.9176s
	iters: 400, epoch: 14 | loss: 0.0044935
	speed: 0.0446s/iter; left time: 1583.5344s
Epoch: 14 cost time: 20.748985290527344
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000138
	speed: 0.2026s/iter; left time: 7176.6991s
	iters: 200, epoch: 15 | loss: 0.1201662
	speed: 0.0464s/iter; left time: 1638.8542s
	iters: 300, epoch: 15 | loss: 0.0001156
	speed: 0.0463s/iter; left time: 1628.8920s
	iters: 400, epoch: 15 | loss: 0.0000033
	speed: 0.0446s/iter; left time: 1567.7590s
Epoch: 15 cost time: 20.222927570343018
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.169 Vali Acc: 0.968 Test Loss: 0.169 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000028
	speed: 0.1868s/iter; left time: 6537.5904s
	iters: 200, epoch: 16 | loss: 0.0000024
	speed: 0.0485s/iter; left time: 1691.4698s
	iters: 300, epoch: 16 | loss: 0.0442048
	speed: 0.0478s/iter; left time: 1663.2290s
	iters: 400, epoch: 16 | loss: 0.0001187
	speed: 0.0462s/iter; left time: 1603.7807s
Epoch: 16 cost time: 19.653545141220093
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000647
	speed: 0.1976s/iter; left time: 6836.2995s
	iters: 200, epoch: 17 | loss: 0.0000121
	speed: 0.0452s/iter; left time: 1560.5372s
	iters: 300, epoch: 17 | loss: 0.0947362
	speed: 0.0399s/iter; left time: 1370.7877s
	iters: 400, epoch: 17 | loss: 0.0000432
	speed: 0.0444s/iter; left time: 1523.5394s
Epoch: 17 cost time: 19.125922441482544
Epoch: 17, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.145 Vali Acc: 0.976 Test Loss: 0.145 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000016
	speed: 0.1884s/iter; left time: 6438.1748s
	iters: 200, epoch: 18 | loss: 0.0000125
	speed: 0.0423s/iter; left time: 1443.1100s
	iters: 300, epoch: 18 | loss: 0.0000279
	speed: 0.0422s/iter; left time: 1435.1488s
	iters: 400, epoch: 18 | loss: 0.1190500
	speed: 0.0443s/iter; left time: 1500.8584s
Epoch: 18 cost time: 19.45794939994812
Epoch: 18, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 38090
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0497937
	speed: 0.0742s/iter; left time: 3056.8268s
	iters: 200, epoch: 1 | loss: 0.3250247
	speed: 0.0423s/iter; left time: 1740.1237s
	iters: 300, epoch: 1 | loss: 0.0633822
	speed: 0.0447s/iter; left time: 1832.5752s
	iters: 400, epoch: 1 | loss: 0.1534046
	speed: 0.0500s/iter; left time: 2045.9786s
Epoch: 1 cost time: 21.797470331192017
Epoch: 1, Steps: 413 | Train Loss: 0.658 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
Validation loss decreased (inf --> -0.962709).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0388978
	speed: 0.1759s/iter; left time: 7174.3423s
	iters: 200, epoch: 2 | loss: 0.1620748
	speed: 0.0415s/iter; left time: 1687.7690s
	iters: 300, epoch: 2 | loss: 0.0249606
	speed: 0.0459s/iter; left time: 1864.1470s
	iters: 400, epoch: 2 | loss: 0.0081949
	speed: 0.0402s/iter; left time: 1628.5006s
Epoch: 2 cost time: 17.90008306503296
Epoch: 2, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.105 Vali Acc: 0.960 Test Loss: 0.105 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0635850
	speed: 0.2034s/iter; left time: 8212.0367s
	iters: 200, epoch: 3 | loss: 0.0708916
	speed: 0.0458s/iter; left time: 1843.5049s
	iters: 300, epoch: 3 | loss: 0.2110914
	speed: 0.0457s/iter; left time: 1836.9785s
	iters: 400, epoch: 3 | loss: 0.0091733
	speed: 0.0472s/iter; left time: 1891.5421s
Epoch: 3 cost time: 20.371063232421875
Epoch: 3, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.065 Vali Acc: 0.973 Test Loss: 0.065 Test Acc: 0.973
Validation loss decreased (-0.962709 --> -0.972714).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0209455
	speed: 0.2039s/iter; left time: 8146.5817s
	iters: 200, epoch: 4 | loss: 0.0067208
	speed: 0.0516s/iter; left time: 2054.9784s
	iters: 300, epoch: 4 | loss: 0.0208167
	speed: 0.0482s/iter; left time: 1915.1955s
	iters: 400, epoch: 4 | loss: 0.0521544
	speed: 0.0460s/iter; left time: 1824.0029s
Epoch: 4 cost time: 20.651100397109985
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0099704
	speed: 0.2020s/iter; left time: 7990.2583s
	iters: 200, epoch: 5 | loss: 0.0020151
	speed: 0.0414s/iter; left time: 1632.9225s
	iters: 300, epoch: 5 | loss: 0.0411145
	speed: 0.0444s/iter; left time: 1748.8512s
	iters: 400, epoch: 5 | loss: 0.0035764
	speed: 0.0494s/iter; left time: 1939.4703s
Epoch: 5 cost time: 19.951939344406128
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.074 Vali Acc: 0.972 Test Loss: 0.074 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0019289
	speed: 0.2188s/iter; left time: 8561.5821s
	iters: 200, epoch: 6 | loss: 0.0252202
	speed: 0.0452s/iter; left time: 1763.3407s
	iters: 300, epoch: 6 | loss: 0.0016525
	speed: 0.0464s/iter; left time: 1807.9194s
	iters: 400, epoch: 6 | loss: 0.0065608
	speed: 0.0515s/iter; left time: 1999.4420s
Epoch: 6 cost time: 21.577072381973267
Epoch: 6, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
Validation loss decreased (-0.972714 --> -0.975897).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0164435
	speed: 0.2075s/iter; left time: 8033.1363s
	iters: 200, epoch: 7 | loss: 0.0003362
	speed: 0.0447s/iter; left time: 1726.3235s
	iters: 300, epoch: 7 | loss: 0.0287380
	speed: 0.0488s/iter; left time: 1880.7425s
	iters: 400, epoch: 7 | loss: 0.0002884
	speed: 0.0499s/iter; left time: 1916.4494s
Epoch: 7 cost time: 20.221408128738403
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0001326
	speed: 0.1929s/iter; left time: 7391.2867s
	iters: 200, epoch: 8 | loss: 0.0062205
	speed: 0.0506s/iter; left time: 1934.5247s
	iters: 300, epoch: 8 | loss: 0.0148845
	speed: 0.0433s/iter; left time: 1651.3384s
	iters: 400, epoch: 8 | loss: 0.0006222
	speed: 0.0462s/iter; left time: 1757.7724s
Epoch: 8 cost time: 19.760206937789917
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0144627
	speed: 0.2035s/iter; left time: 7713.3716s
	iters: 200, epoch: 9 | loss: 0.0005557
	speed: 0.0461s/iter; left time: 1743.6695s
	iters: 300, epoch: 9 | loss: 0.0224461
	speed: 0.0457s/iter; left time: 1721.5576s
	iters: 400, epoch: 9 | loss: 0.0140065
	speed: 0.0487s/iter; left time: 1831.6723s
Epoch: 9 cost time: 19.577304124832153
Epoch: 9, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0019804
	speed: 0.1995s/iter; left time: 7476.7615s
	iters: 200, epoch: 10 | loss: 0.0032589
	speed: 0.0475s/iter; left time: 1776.4246s
	iters: 300, epoch: 10 | loss: 0.0005491
	speed: 0.0470s/iter; left time: 1750.7432s
	iters: 400, epoch: 10 | loss: 0.1557213
	speed: 0.0437s/iter; left time: 1625.0570s
Epoch: 10 cost time: 19.93358087539673
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0046201
	speed: 0.2050s/iter; left time: 7598.0107s
	iters: 200, epoch: 11 | loss: 0.0241835
	speed: 0.0474s/iter; left time: 1754.0345s
	iters: 300, epoch: 11 | loss: 0.0000129
	speed: 0.0462s/iter; left time: 1703.8100s
	iters: 400, epoch: 11 | loss: 0.0003159
	speed: 0.0448s/iter; left time: 1647.0733s
Epoch: 11 cost time: 19.56565833091736
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0003866
	speed: 0.2037s/iter; left time: 7467.3964s
	iters: 200, epoch: 12 | loss: 0.0025086
	speed: 0.0473s/iter; left time: 1730.8671s
	iters: 300, epoch: 12 | loss: 0.0064377
	speed: 0.0463s/iter; left time: 1689.1180s
	iters: 400, epoch: 12 | loss: 0.0985190
	speed: 0.0413s/iter; left time: 1503.2251s
Epoch: 12 cost time: 19.65344500541687
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0020226
	speed: 0.2141s/iter; left time: 7761.3318s
	iters: 200, epoch: 13 | loss: 0.0006067
	speed: 0.0443s/iter; left time: 1600.5245s
	iters: 300, epoch: 13 | loss: 0.0106742
	speed: 0.0480s/iter; left time: 1730.5360s
	iters: 400, epoch: 13 | loss: 0.0000082
	speed: 0.0452s/iter; left time: 1625.1496s
Epoch: 13 cost time: 20.409991025924683
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000026
	speed: 0.2101s/iter; left time: 7527.1702s
	iters: 200, epoch: 14 | loss: 0.0000158
	speed: 0.0486s/iter; left time: 1735.0686s
	iters: 300, epoch: 14 | loss: 0.0000037
	speed: 0.0510s/iter; left time: 1818.9536s
	iters: 400, epoch: 14 | loss: 0.2929558
	speed: 0.0535s/iter; left time: 1900.3405s
Epoch: 14 cost time: 21.76840090751648
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.975897 --> -0.980900).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0038747
	speed: 0.2139s/iter; left time: 7577.2973s
	iters: 200, epoch: 15 | loss: 0.0004324
	speed: 0.0484s/iter; left time: 1710.4746s
	iters: 300, epoch: 15 | loss: 0.0000037
	speed: 0.0422s/iter; left time: 1485.5013s
	iters: 400, epoch: 15 | loss: 0.0000039
	speed: 0.0451s/iter; left time: 1583.8321s
Epoch: 15 cost time: 19.60894012451172
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0014810
	speed: 0.2096s/iter; left time: 7336.3429s
	iters: 200, epoch: 16 | loss: 0.0000151
	speed: 0.0458s/iter; left time: 1599.0627s
	iters: 300, epoch: 16 | loss: 0.1079390
	speed: 0.0437s/iter; left time: 1519.5060s
	iters: 400, epoch: 16 | loss: 0.0214185
	speed: 0.0454s/iter; left time: 1576.6078s
Epoch: 16 cost time: 19.7420072555542
Epoch: 16, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0001228
	speed: 0.2064s/iter; left time: 7141.5686s
	iters: 200, epoch: 17 | loss: 0.0000179
	speed: 0.0419s/iter; left time: 1444.8281s
	iters: 300, epoch: 17 | loss: 0.0000105
	speed: 0.0431s/iter; left time: 1482.7384s
	iters: 400, epoch: 17 | loss: 0.0000192
	speed: 0.0406s/iter; left time: 1391.0048s
Epoch: 17 cost time: 18.538474082946777
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.2164s/iter; left time: 7395.0161s
	iters: 200, epoch: 18 | loss: 0.0000016
	speed: 0.0428s/iter; left time: 1458.0094s
	iters: 300, epoch: 18 | loss: 0.0000088
	speed: 0.0466s/iter; left time: 1584.1100s
	iters: 400, epoch: 18 | loss: 0.0000014
	speed: 0.0447s/iter; left time: 1514.2902s
Epoch: 18 cost time: 19.578670501708984
Epoch: 18, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000012
	speed: 0.2118s/iter; left time: 7152.9646s
	iters: 200, epoch: 19 | loss: 0.0000845
	speed: 0.0427s/iter; left time: 1438.2529s
	iters: 300, epoch: 19 | loss: 0.0000347
	speed: 0.0432s/iter; left time: 1450.8278s
	iters: 400, epoch: 19 | loss: 0.0000274
	speed: 0.0473s/iter; left time: 1582.6480s
Epoch: 19 cost time: 19.185251235961914
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0008494
	speed: 0.2192s/iter; left time: 7311.6520s
	iters: 200, epoch: 20 | loss: 0.0000064
	speed: 0.0463s/iter; left time: 1538.3169s
	iters: 300, epoch: 20 | loss: 0.0000198
	speed: 0.0446s/iter; left time: 1477.7921s
	iters: 400, epoch: 20 | loss: 0.0739899
	speed: 0.0458s/iter; left time: 1514.2734s
Epoch: 20 cost time: 19.63382887840271
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0099018
	speed: 0.2168s/iter; left time: 7140.2856s
	iters: 200, epoch: 21 | loss: 0.0004357
	speed: 0.0467s/iter; left time: 1534.5032s
	iters: 300, epoch: 21 | loss: 0.0000578
	speed: 0.0411s/iter; left time: 1345.8569s
	iters: 400, epoch: 21 | loss: 0.0000386
	speed: 0.0464s/iter; left time: 1514.0034s
Epoch: 21 cost time: 19.460125207901
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0060692
	speed: 0.1997s/iter; left time: 6497.0306s
	iters: 200, epoch: 22 | loss: 0.0000181
	speed: 0.0426s/iter; left time: 1382.8090s
	iters: 300, epoch: 22 | loss: 0.0000003
	speed: 0.0433s/iter; left time: 1399.8152s
	iters: 400, epoch: 22 | loss: 0.0438040
	speed: 0.0457s/iter; left time: 1472.1507s
Epoch: 22 cost time: 18.612812757492065
Epoch: 22, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.982 Test Loss: 0.089 Test Acc: 0.982
Validation loss decreased (-0.980900 --> -0.982264).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000003
	speed: 0.1968s/iter; left time: 6320.1983s
	iters: 200, epoch: 23 | loss: 0.0000005
	speed: 0.0402s/iter; left time: 1287.7387s
	iters: 300, epoch: 23 | loss: 0.0000041
	speed: 0.0415s/iter; left time: 1325.1144s
	iters: 400, epoch: 23 | loss: 0.0059101
	speed: 0.0428s/iter; left time: 1360.5129s
Epoch: 23 cost time: 18.04835844039917
Epoch: 23, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0001521
	speed: 0.1883s/iter; left time: 5970.2907s
	iters: 200, epoch: 24 | loss: 0.0020235
	speed: 0.0390s/iter; left time: 1231.7821s
	iters: 300, epoch: 24 | loss: 0.0165331
	speed: 0.0400s/iter; left time: 1259.1574s
	iters: 400, epoch: 24 | loss: 0.0000422
	speed: 0.0455s/iter; left time: 1430.0417s
Epoch: 24 cost time: 17.756232261657715
Epoch: 24, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0301115
	speed: 0.1978s/iter; left time: 6190.0771s
	iters: 200, epoch: 25 | loss: 0.0000254
	speed: 0.0436s/iter; left time: 1360.9386s
	iters: 300, epoch: 25 | loss: 0.0000374
	speed: 0.0472s/iter; left time: 1466.7716s
	iters: 400, epoch: 25 | loss: 0.0015777
	speed: 0.0462s/iter; left time: 1432.3938s
Epoch: 25 cost time: 19.571996688842773
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0007771
	speed: 0.1756s/iter; left time: 5421.8083s
	iters: 200, epoch: 26 | loss: 0.0000487
	speed: 0.0403s/iter; left time: 1239.9570s
	iters: 300, epoch: 26 | loss: 0.0000832
	speed: 0.0413s/iter; left time: 1266.8627s
	iters: 400, epoch: 26 | loss: 0.0000123
	speed: 0.0450s/iter; left time: 1376.5402s
Epoch: 26 cost time: 17.947102308273315
Epoch: 26, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000188
	speed: 0.1764s/iter; left time: 5374.7659s
	iters: 200, epoch: 27 | loss: 0.0000009
	speed: 0.0384s/iter; left time: 1165.1288s
	iters: 300, epoch: 27 | loss: 0.0153980
	speed: 0.0436s/iter; left time: 1319.5317s
	iters: 400, epoch: 27 | loss: 0.0000007
	speed: 0.0418s/iter; left time: 1262.2119s
Epoch: 27 cost time: 17.289656162261963
Epoch: 27, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000003
	speed: 0.1898s/iter; left time: 5704.0779s
	iters: 200, epoch: 28 | loss: 0.0000004
	speed: 0.0417s/iter; left time: 1247.8560s
	iters: 300, epoch: 28 | loss: 0.0000097
	speed: 0.0430s/iter; left time: 1283.3796s
	iters: 400, epoch: 28 | loss: 0.0000004
	speed: 0.0382s/iter; left time: 1137.9325s
Epoch: 28 cost time: 17.468834161758423
Epoch: 28, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000009
	speed: 0.1886s/iter; left time: 5590.0265s
	iters: 200, epoch: 29 | loss: 0.0002722
	speed: 0.0397s/iter; left time: 1171.5986s
	iters: 300, epoch: 29 | loss: 0.0000001
	speed: 0.0401s/iter; left time: 1181.8702s
	iters: 400, epoch: 29 | loss: 0.0000050
	speed: 0.0431s/iter; left time: 1262.9926s
Epoch: 29 cost time: 17.661328554153442
Epoch: 29, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0009621
	speed: 0.1964s/iter; left time: 5741.0083s
	iters: 200, epoch: 30 | loss: 0.0000071
	speed: 0.0447s/iter; left time: 1301.5653s
	iters: 300, epoch: 30 | loss: 0.0000005
	speed: 0.0421s/iter; left time: 1222.7128s
	iters: 400, epoch: 30 | loss: 0.0001103
	speed: 0.0462s/iter; left time: 1335.3415s
Epoch: 30 cost time: 19.38858199119568
Epoch: 30, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.166 Vali Acc: 0.970 Test Loss: 0.166 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000086
	speed: 0.1978s/iter; left time: 5698.8852s
	iters: 200, epoch: 31 | loss: 0.0000207
	speed: 0.0452s/iter; left time: 1298.7003s
	iters: 300, epoch: 31 | loss: 0.0000097
	speed: 0.0397s/iter; left time: 1135.2963s
	iters: 400, epoch: 31 | loss: 0.0123164
	speed: 0.0444s/iter; left time: 1265.1997s
Epoch: 31 cost time: 19.18535542488098
Epoch: 31, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1838s/iter; left time: 5218.2351s
	iters: 200, epoch: 32 | loss: 0.0000001
	speed: 0.0462s/iter; left time: 1307.2735s
	iters: 300, epoch: 32 | loss: 0.0005099
	speed: 0.0426s/iter; left time: 1202.3620s
	iters: 400, epoch: 32 | loss: 0.0000027
	speed: 0.0454s/iter; left time: 1277.0238s
Epoch: 32 cost time: 18.938828468322754
Epoch: 32, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 29850
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0443348
	speed: 0.0893s/iter; left time: 3679.9982s
	iters: 200, epoch: 1 | loss: 0.4712301
	speed: 0.0472s/iter; left time: 1941.2244s
	iters: 300, epoch: 1 | loss: 0.1818319
	speed: 0.0510s/iter; left time: 2090.8481s
	iters: 400, epoch: 1 | loss: 0.3169756
	speed: 0.0426s/iter; left time: 1742.2942s
Epoch: 1 cost time: 23.72412419319153
Epoch: 1, Steps: 413 | Train Loss: 0.783 Vali Loss: 0.141 Vali Acc: 0.955 Test Loss: 0.141 Test Acc: 0.955
Validation loss decreased (inf --> -0.954978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2607895
	speed: 0.2169s/iter; left time: 8847.1862s
	iters: 200, epoch: 2 | loss: 0.0525052
	speed: 0.0526s/iter; left time: 2141.9003s
	iters: 300, epoch: 2 | loss: 0.0326341
	speed: 0.0502s/iter; left time: 2035.5386s
	iters: 400, epoch: 2 | loss: 0.0972701
	speed: 0.0480s/iter; left time: 1944.8052s
Epoch: 2 cost time: 21.022660493850708
Epoch: 2, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.091 Vali Acc: 0.969 Test Loss: 0.091 Test Acc: 0.969
Validation loss decreased (-0.954978 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0398076
	speed: 0.2487s/iter; left time: 10042.0766s
	iters: 200, epoch: 3 | loss: 0.1991156
	speed: 0.0498s/iter; left time: 2005.7580s
	iters: 300, epoch: 3 | loss: 0.2607718
	speed: 0.0558s/iter; left time: 2243.0333s
	iters: 400, epoch: 3 | loss: 0.0117419
	speed: 0.0546s/iter; left time: 2186.5438s
Epoch: 3 cost time: 22.868225574493408
Epoch: 3, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.066 Vali Acc: 0.974 Test Loss: 0.066 Test Acc: 0.974
Validation loss decreased (-0.968621 --> -0.973624).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0029710
	speed: 0.2467s/iter; left time: 9858.2514s
	iters: 200, epoch: 4 | loss: 0.0142720
	speed: 0.0506s/iter; left time: 2017.4884s
	iters: 300, epoch: 4 | loss: 0.0109466
	speed: 0.0585s/iter; left time: 2327.3148s
	iters: 400, epoch: 4 | loss: 0.0227481
	speed: 0.0540s/iter; left time: 2139.9721s
Epoch: 4 cost time: 23.528944969177246
Epoch: 4, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.069 Vali Acc: 0.972 Test Loss: 0.069 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0219521
	speed: 0.2373s/iter; left time: 9383.6161s
	iters: 200, epoch: 5 | loss: 0.0682171
	speed: 0.0629s/iter; left time: 2480.3674s
	iters: 300, epoch: 5 | loss: 0.0971332
	speed: 0.0502s/iter; left time: 1974.4499s
	iters: 400, epoch: 5 | loss: 0.0245681
	speed: 0.0566s/iter; left time: 2222.9969s
Epoch: 5 cost time: 23.892143964767456
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.063 Vali Acc: 0.976 Test Loss: 0.063 Test Acc: 0.976
Validation loss decreased (-0.973624 --> -0.975898).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1215558
	speed: 0.2432s/iter; left time: 9519.2444s
	iters: 200, epoch: 6 | loss: 0.1392494
	speed: 0.0480s/iter; left time: 1872.5742s
	iters: 300, epoch: 6 | loss: 0.0025911
	speed: 0.0524s/iter; left time: 2041.4726s
	iters: 400, epoch: 6 | loss: 0.0661421
	speed: 0.0512s/iter; left time: 1986.8054s
Epoch: 6 cost time: 22.34666919708252
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.063 Vali Acc: 0.976 Test Loss: 0.063 Test Acc: 0.976
Validation loss decreased (-0.975898 --> -0.976352).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0222903
	speed: 0.2381s/iter; left time: 9221.8741s
	iters: 200, epoch: 7 | loss: 0.0433683
	speed: 0.0505s/iter; left time: 1949.7083s
	iters: 300, epoch: 7 | loss: 0.0463061
	speed: 0.0493s/iter; left time: 1898.6099s
	iters: 400, epoch: 7 | loss: 0.0016826
	speed: 0.0437s/iter; left time: 1680.7266s
Epoch: 7 cost time: 21.520559549331665
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0004074
	speed: 0.2293s/iter; left time: 8786.3420s
	iters: 200, epoch: 8 | loss: 0.3118736
	speed: 0.0499s/iter; left time: 1908.4644s
	iters: 300, epoch: 8 | loss: 0.0005981
	speed: 0.0548s/iter; left time: 2089.9875s
	iters: 400, epoch: 8 | loss: 0.0016932
	speed: 0.0608s/iter; left time: 2309.4006s
Epoch: 8 cost time: 22.66774034500122
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0036071
	speed: 0.2423s/iter; left time: 9184.0706s
	iters: 200, epoch: 9 | loss: 0.0022253
	speed: 0.0514s/iter; left time: 1944.4538s
	iters: 300, epoch: 9 | loss: 0.1169356
	speed: 0.0475s/iter; left time: 1788.9048s
	iters: 400, epoch: 9 | loss: 0.0003220
	speed: 0.0510s/iter; left time: 1916.3183s
Epoch: 9 cost time: 21.571029901504517
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000814
	speed: 0.2131s/iter; left time: 7987.5591s
	iters: 200, epoch: 10 | loss: 0.0001564
	speed: 0.0481s/iter; left time: 1796.6129s
	iters: 300, epoch: 10 | loss: 0.0022750
	speed: 0.0483s/iter; left time: 1801.6497s
	iters: 400, epoch: 10 | loss: 0.0091478
	speed: 0.0520s/iter; left time: 1934.5210s
Epoch: 10 cost time: 21.103362321853638
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.090 Vali Acc: 0.971 Test Loss: 0.090 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0014170
	speed: 0.2251s/iter; left time: 8343.2235s
	iters: 200, epoch: 11 | loss: 0.0400945
	speed: 0.0523s/iter; left time: 1935.1879s
	iters: 300, epoch: 11 | loss: 0.0001570
	speed: 0.0538s/iter; left time: 1984.3160s
	iters: 400, epoch: 11 | loss: 0.0016178
	speed: 0.0498s/iter; left time: 1831.7786s
Epoch: 11 cost time: 22.722014904022217
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976352 --> -0.976807).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0015156
	speed: 0.2287s/iter; left time: 8384.3512s
	iters: 200, epoch: 12 | loss: 0.0000404
	speed: 0.0527s/iter; left time: 1927.1549s
	iters: 300, epoch: 12 | loss: 0.0000347
	speed: 0.0519s/iter; left time: 1892.8015s
	iters: 400, epoch: 12 | loss: 0.0023261
	speed: 0.0502s/iter; left time: 1824.2967s
Epoch: 12 cost time: 22.056812286376953
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0006362
	speed: 0.2259s/iter; left time: 8186.0390s
	iters: 200, epoch: 13 | loss: 0.3399667
	speed: 0.0449s/iter; left time: 1621.8848s
	iters: 300, epoch: 13 | loss: 0.0004206
	speed: 0.0477s/iter; left time: 1719.9616s
	iters: 400, epoch: 13 | loss: 0.0001068
	speed: 0.0514s/iter; left time: 1846.5923s
Epoch: 13 cost time: 20.43817138671875
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000363
	speed: 0.2238s/iter; left time: 8019.0647s
	iters: 200, epoch: 14 | loss: 0.0103123
	speed: 0.0516s/iter; left time: 1844.8853s
	iters: 300, epoch: 14 | loss: 0.1858239
	speed: 0.0532s/iter; left time: 1893.9826s
	iters: 400, epoch: 14 | loss: 0.0044804
	speed: 0.0484s/iter; left time: 1719.8840s
Epoch: 14 cost time: 21.794553995132446
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0001674
	speed: 0.2314s/iter; left time: 8196.4349s
	iters: 200, epoch: 15 | loss: 0.0001485
	speed: 0.0500s/iter; left time: 1767.4897s
	iters: 300, epoch: 15 | loss: 0.1400867
	speed: 0.0539s/iter; left time: 1898.3850s
	iters: 400, epoch: 15 | loss: 0.0000509
	speed: 0.0479s/iter; left time: 1682.9833s
Epoch: 15 cost time: 22.191792011260986
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0002724
	speed: 0.2175s/iter; left time: 7614.0243s
	iters: 200, epoch: 16 | loss: 0.1535112
	speed: 0.0491s/iter; left time: 1714.7571s
	iters: 300, epoch: 16 | loss: 0.0005230
	speed: 0.0554s/iter; left time: 1927.5193s
	iters: 400, epoch: 16 | loss: 0.0000013
	speed: 0.0504s/iter; left time: 1750.5342s
Epoch: 16 cost time: 22.15610933303833
Epoch: 16, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0002761
	speed: 0.2438s/iter; left time: 8433.1691s
	iters: 200, epoch: 17 | loss: 0.0136159
	speed: 0.0511s/iter; left time: 1761.8038s
	iters: 300, epoch: 17 | loss: 0.0019377
	speed: 0.0488s/iter; left time: 1677.4087s
	iters: 400, epoch: 17 | loss: 0.0010399
	speed: 0.0487s/iter; left time: 1670.9429s
Epoch: 17 cost time: 21.76620602607727
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.161 Vali Acc: 0.969 Test Loss: 0.161 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000594
	speed: 0.2263s/iter; left time: 7735.0719s
	iters: 200, epoch: 18 | loss: 0.0000917
	speed: 0.0535s/iter; left time: 1822.7658s
	iters: 300, epoch: 18 | loss: 0.0007900
	speed: 0.0506s/iter; left time: 1721.0218s
	iters: 400, epoch: 18 | loss: 0.0001621
	speed: 0.0544s/iter; left time: 1842.9702s
Epoch: 18 cost time: 22.90395998954773
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0012379
	speed: 0.2341s/iter; left time: 7906.1408s
	iters: 200, epoch: 19 | loss: 0.0148777
	speed: 0.0476s/iter; left time: 1602.7825s
	iters: 300, epoch: 19 | loss: 0.0000357
	speed: 0.0571s/iter; left time: 1917.0771s
	iters: 400, epoch: 19 | loss: 0.0000019
	speed: 0.0536s/iter; left time: 1792.3166s
Epoch: 19 cost time: 22.773342609405518
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.976807 --> -0.979535).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0001286
	speed: 0.2287s/iter; left time: 7627.4817s
	iters: 200, epoch: 20 | loss: 0.0009132
	speed: 0.0481s/iter; left time: 1601.0403s
	iters: 300, epoch: 20 | loss: 0.0198136
	speed: 0.0508s/iter; left time: 1682.7366s
	iters: 400, epoch: 20 | loss: 0.0023112
	speed: 0.0541s/iter; left time: 1789.6222s
Epoch: 20 cost time: 21.978097915649414
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0010797
	speed: 0.2212s/iter; left time: 7286.3433s
	iters: 200, epoch: 21 | loss: 0.0000969
	speed: 0.0545s/iter; left time: 1790.4282s
	iters: 300, epoch: 21 | loss: 0.0016077
	speed: 0.0503s/iter; left time: 1645.7453s
	iters: 400, epoch: 21 | loss: 0.0045449
	speed: 0.0479s/iter; left time: 1563.4249s
Epoch: 21 cost time: 21.59855079650879
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0001823
	speed: 0.2112s/iter; left time: 6869.0097s
	iters: 200, epoch: 22 | loss: 0.0000004
	speed: 0.0491s/iter; left time: 1593.4833s
	iters: 300, epoch: 22 | loss: 0.0004985
	speed: 0.0441s/iter; left time: 1426.1832s
	iters: 400, epoch: 22 | loss: 0.0000117
	speed: 0.0474s/iter; left time: 1527.4540s
Epoch: 22 cost time: 20.16786551475525
Epoch: 22, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000180
	speed: 0.2236s/iter; left time: 7180.1954s
	iters: 200, epoch: 23 | loss: 0.0003549
	speed: 0.0477s/iter; left time: 1526.3692s
	iters: 300, epoch: 23 | loss: 0.0017099
	speed: 0.0498s/iter; left time: 1590.2510s
	iters: 400, epoch: 23 | loss: 0.0015913
	speed: 0.0474s/iter; left time: 1508.8263s
Epoch: 23 cost time: 22.093350410461426
Epoch: 23, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000132
	speed: 0.2305s/iter; left time: 7307.4545s
	iters: 200, epoch: 24 | loss: 0.0000051
	speed: 0.0498s/iter; left time: 1573.8981s
	iters: 300, epoch: 24 | loss: 0.0000053
	speed: 0.0532s/iter; left time: 1676.9220s
	iters: 400, epoch: 24 | loss: 0.0002859
	speed: 0.0512s/iter; left time: 1608.7413s
Epoch: 24 cost time: 23.190062046051025
Epoch: 24, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.1726009
	speed: 0.2344s/iter; left time: 7333.3903s
	iters: 200, epoch: 25 | loss: 0.0024855
	speed: 0.0464s/iter; left time: 1446.7949s
	iters: 300, epoch: 25 | loss: 0.0000374
	speed: 0.0565s/iter; left time: 1757.5075s
	iters: 400, epoch: 25 | loss: 0.0008490
	speed: 0.0556s/iter; left time: 1721.8049s
Epoch: 25 cost time: 22.758856534957886
Epoch: 25, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0091234
	speed: 0.2312s/iter; left time: 7137.9354s
	iters: 200, epoch: 26 | loss: 0.0014769
	speed: 0.0516s/iter; left time: 1588.3290s
	iters: 300, epoch: 26 | loss: 0.0005186
	speed: 0.0525s/iter; left time: 1610.6632s
	iters: 400, epoch: 26 | loss: 0.0000119
	speed: 0.0466s/iter; left time: 1425.7280s
Epoch: 26 cost time: 21.83454990386963
Epoch: 26, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000236
	speed: 0.2394s/iter; left time: 7292.3218s
	iters: 200, epoch: 27 | loss: 0.0024989
	speed: 0.0480s/iter; left time: 1458.6332s
	iters: 300, epoch: 27 | loss: 0.0000440
	speed: 0.0554s/iter; left time: 1677.3367s
	iters: 400, epoch: 27 | loss: 0.0001674
	speed: 0.0475s/iter; left time: 1433.9340s
Epoch: 27 cost time: 21.971545457839966
Epoch: 27, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0086014
	speed: 0.2459s/iter; left time: 7388.0263s
	iters: 200, epoch: 28 | loss: 0.0000194
	speed: 0.0595s/iter; left time: 1783.4542s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 1520.8392s
	iters: 400, epoch: 28 | loss: 0.0000572
	speed: 0.0547s/iter; left time: 1626.8765s
Epoch: 28 cost time: 24.3826801776886
Epoch: 28, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0016341
	speed: 0.2387s/iter; left time: 7073.2283s
	iters: 200, epoch: 29 | loss: 0.0119379
	speed: 0.0551s/iter; left time: 1627.9712s
	iters: 300, epoch: 29 | loss: 0.0000319
	speed: 0.0468s/iter; left time: 1377.8980s
	iters: 400, epoch: 29 | loss: 0.0018348
	speed: 0.0474s/iter; left time: 1391.7666s
Epoch: 29 cost time: 22.017787218093872
Epoch: 29, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 25770
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3812117
	speed: 0.1134s/iter; left time: 4671.2311s
	iters: 200, epoch: 1 | loss: 0.6291167
	speed: 0.0704s/iter; left time: 2893.5499s
	iters: 300, epoch: 1 | loss: 0.2130276
	speed: 0.0718s/iter; left time: 2944.5916s
	iters: 400, epoch: 1 | loss: 0.2519929
	speed: 0.0741s/iter; left time: 3028.9700s
Epoch: 1 cost time: 34.04299712181091
Epoch: 1, Steps: 413 | Train Loss: 0.418 Vali Loss: 0.119 Vali Acc: 0.961 Test Loss: 0.119 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4580825
	speed: 0.2495s/iter; left time: 10177.6609s
	iters: 200, epoch: 2 | loss: 0.0106796
	speed: 0.0720s/iter; left time: 2931.2491s
	iters: 300, epoch: 2 | loss: 0.0077724
	speed: 0.0705s/iter; left time: 2860.7581s
	iters: 400, epoch: 2 | loss: 0.0053789
	speed: 0.0708s/iter; left time: 2865.4154s
Epoch: 2 cost time: 30.969074964523315
Epoch: 2, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0010267
	speed: 0.2490s/iter; left time: 10054.5601s
	iters: 200, epoch: 3 | loss: 0.0025066
	speed: 0.0755s/iter; left time: 3041.7361s
	iters: 300, epoch: 3 | loss: 0.0793441
	speed: 0.0699s/iter; left time: 2810.2175s
	iters: 400, epoch: 3 | loss: 0.0000399
	speed: 0.0760s/iter; left time: 3047.1595s
Epoch: 3 cost time: 31.503398418426514
Epoch: 3, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.212 Vali Acc: 0.952 Test Loss: 0.212 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1572183
	speed: 0.2744s/iter; left time: 10966.3705s
	iters: 200, epoch: 4 | loss: 0.0162913
	speed: 0.0774s/iter; left time: 3085.2825s
	iters: 300, epoch: 4 | loss: 0.1106196
	speed: 0.0792s/iter; left time: 3148.3865s
	iters: 400, epoch: 4 | loss: 0.0000011
	speed: 0.0824s/iter; left time: 3268.2992s
Epoch: 4 cost time: 34.74356937408447
Epoch: 4, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.200 Vali Acc: 0.963 Test Loss: 0.200 Test Acc: 0.963
Validation loss decreased (-0.960890 --> -0.963163).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0083131
	speed: 0.2865s/iter; left time: 11328.8992s
	iters: 200, epoch: 5 | loss: 0.0000383
	speed: 0.0727s/iter; left time: 2869.7246s
	iters: 300, epoch: 5 | loss: 0.0027687
	speed: 0.0712s/iter; left time: 2799.9130s
	iters: 400, epoch: 5 | loss: 0.0000226
	speed: 0.0717s/iter; left time: 2813.7125s
Epoch: 5 cost time: 31.928651809692383
Epoch: 5, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.244 Vali Acc: 0.956 Test Loss: 0.244 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000225
	speed: 0.2537s/iter; left time: 9927.4519s
	iters: 200, epoch: 6 | loss: 0.0000355
	speed: 0.0635s/iter; left time: 2478.5118s
	iters: 300, epoch: 6 | loss: 0.0000119
	speed: 0.0623s/iter; left time: 2424.9670s
	iters: 400, epoch: 6 | loss: 0.0000296
	speed: 0.0606s/iter; left time: 2353.8728s
Epoch: 6 cost time: 27.07395100593567
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.272 Vali Acc: 0.960 Test Loss: 0.272 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0002605
	speed: 0.2381s/iter; left time: 9219.1435s
	iters: 200, epoch: 7 | loss: 0.0130859
	speed: 0.0573s/iter; left time: 2211.9038s
	iters: 300, epoch: 7 | loss: 0.0000002
	speed: 0.0571s/iter; left time: 2200.6709s
	iters: 400, epoch: 7 | loss: 0.0002717
	speed: 0.0615s/iter; left time: 2362.5963s
Epoch: 7 cost time: 25.60525941848755
Epoch: 7, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.267 Vali Acc: 0.963 Test Loss: 0.267 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000280
	speed: 0.2208s/iter; left time: 8456.9627s
	iters: 200, epoch: 8 | loss: 0.0000021
	speed: 0.0620s/iter; left time: 2368.9186s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0638s/iter; left time: 2431.0739s
	iters: 400, epoch: 8 | loss: 0.0000379
	speed: 0.0603s/iter; left time: 2293.3331s
Epoch: 8 cost time: 26.19147229194641
Epoch: 8, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.164 Vali Acc: 0.973 Test Loss: 0.164 Test Acc: 0.973
Validation loss decreased (-0.963163 --> -0.972713).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0006899
	speed: 0.2315s/iter; left time: 8774.3102s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0720s/iter; left time: 2720.8401s
	iters: 300, epoch: 9 | loss: 0.0000408
	speed: 0.0633s/iter; left time: 2387.0793s
	iters: 400, epoch: 9 | loss: 0.0001836
	speed: 0.0651s/iter; left time: 2446.4300s
Epoch: 9 cost time: 28.957631826400757
Epoch: 9, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.230 Vali Acc: 0.966 Test Loss: 0.230 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0044834
	speed: 0.2145s/iter; left time: 8039.6025s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0655s/iter; left time: 2448.6599s
	iters: 300, epoch: 10 | loss: 0.0004417
	speed: 0.0602s/iter; left time: 2244.1938s
	iters: 400, epoch: 10 | loss: 0.0000003
	speed: 0.0576s/iter; left time: 2140.8777s
Epoch: 10 cost time: 26.011852264404297
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.281 Vali Acc: 0.969 Test Loss: 0.281 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3408811
	speed: 0.2179s/iter; left time: 8076.5162s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0603s/iter; left time: 2229.8405s
	iters: 300, epoch: 11 | loss: 0.0000002
	speed: 0.0620s/iter; left time: 2284.3535s
	iters: 400, epoch: 11 | loss: 0.0000006
	speed: 0.0639s/iter; left time: 2348.1324s
Epoch: 11 cost time: 26.08888030052185
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.289 Vali Acc: 0.966 Test Loss: 0.289 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000012
	speed: 0.2463s/iter; left time: 9029.7394s
	iters: 200, epoch: 12 | loss: 0.0000493
	speed: 0.0618s/iter; left time: 2259.8641s
	iters: 300, epoch: 12 | loss: 0.0000633
	speed: 0.0626s/iter; left time: 2281.3998s
	iters: 400, epoch: 12 | loss: 0.0196526
	speed: 0.0671s/iter; left time: 2440.8275s
Epoch: 12 cost time: 26.858688354492188
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.208 Vali Acc: 0.971 Test Loss: 0.208 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000004
	speed: 0.2510s/iter; left time: 9095.9557s
	iters: 200, epoch: 13 | loss: 0.3967810
	speed: 0.0646s/iter; left time: 2334.0671s
	iters: 300, epoch: 13 | loss: 0.0000167
	speed: 0.0766s/iter; left time: 2762.2541s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0726s/iter; left time: 2608.6495s
Epoch: 13 cost time: 30.21108603477478
Epoch: 13, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.249 Vali Acc: 0.964 Test Loss: 0.249 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2581s/iter; left time: 9248.3159s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 2204.0532s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0680s/iter; left time: 2422.4965s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 2631.1420s
Epoch: 14 cost time: 28.776336669921875
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.278 Vali Acc: 0.970 Test Loss: 0.278 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000026
	speed: 0.2510s/iter; left time: 8889.0683s
	iters: 200, epoch: 15 | loss: 0.0000609
	speed: 0.0623s/iter; left time: 2199.3129s
	iters: 300, epoch: 15 | loss: 0.0000271
	speed: 0.0683s/iter; left time: 2404.0913s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 2560.9455s
Epoch: 15 cost time: 27.933959007263184
Epoch: 15, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.345 Vali Acc: 0.963 Test Loss: 0.345 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000030
	speed: 0.2544s/iter; left time: 8904.0991s
	iters: 200, epoch: 16 | loss: 0.0003196
	speed: 0.0640s/iter; left time: 2234.0193s
	iters: 300, epoch: 16 | loss: 0.0000102
	speed: 0.0758s/iter; left time: 2638.9323s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 2543.6809s
Epoch: 16 cost time: 30.53584337234497
Epoch: 16, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
Validation loss decreased (-0.972713 --> -0.974986).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000105
	speed: 0.2773s/iter; left time: 9591.2979s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0834s/iter; left time: 2875.5769s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 2991.6934s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0904s/iter; left time: 3099.9946s
Epoch: 17 cost time: 36.62520909309387
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.309 Vali Acc: 0.972 Test Loss: 0.309 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000027
	speed: 0.2798s/iter; left time: 9562.8982s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0757s/iter; left time: 2579.7879s
	iters: 300, epoch: 18 | loss: 0.0065932
	speed: 0.0796s/iter; left time: 2704.0394s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0799s/iter; left time: 2705.8773s
Epoch: 18 cost time: 33.25935673713684
Epoch: 18, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.298 Vali Acc: 0.971 Test Loss: 0.298 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2665s/iter; left time: 8997.2910s
	iters: 200, epoch: 19 | loss: 0.0038303
	speed: 0.0739s/iter; left time: 2486.6137s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 2677.8048s
	iters: 400, epoch: 19 | loss: 0.0000072
	speed: 0.0803s/iter; left time: 2687.9021s
Epoch: 19 cost time: 33.58313059806824
Epoch: 19, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.385 Vali Acc: 0.960 Test Loss: 0.385 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000610
	speed: 0.2849s/iter; left time: 9501.1621s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0787s/iter; left time: 2618.2689s
	iters: 300, epoch: 20 | loss: 0.0000320
	speed: 0.0799s/iter; left time: 2648.3795s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0747s/iter; left time: 2468.8737s
Epoch: 20 cost time: 32.87335658073425
Epoch: 20, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.255 Vali Acc: 0.970 Test Loss: 0.255 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2678s/iter; left time: 8820.6770s
	iters: 200, epoch: 21 | loss: 0.0016125
	speed: 0.0845s/iter; left time: 2775.3203s
	iters: 300, epoch: 21 | loss: 0.0019735
	speed: 0.0861s/iter; left time: 2819.1122s
	iters: 400, epoch: 21 | loss: 0.1799715
	speed: 0.0870s/iter; left time: 2838.7093s
Epoch: 21 cost time: 36.86481046676636
Epoch: 21, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.381 Vali Acc: 0.962 Test Loss: 0.381 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2712s/iter; left time: 8822.7900s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 2499.6411s
	iters: 300, epoch: 22 | loss: 0.1333465
	speed: 0.0790s/iter; left time: 2553.1115s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 2449.1764s
Epoch: 22 cost time: 32.41670489311218
Epoch: 22, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.388 Vali Acc: 0.965 Test Loss: 0.388 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000002
	speed: 0.2628s/iter; left time: 8439.1620s
	iters: 200, epoch: 23 | loss: 0.0826684
	speed: 0.0688s/iter; left time: 2204.0236s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0706s/iter; left time: 2253.4124s
	iters: 400, epoch: 23 | loss: 0.0000020
	speed: 0.0675s/iter; left time: 2146.4584s
Epoch: 23 cost time: 29.89854669570923
Epoch: 23, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.318 Vali Acc: 0.970 Test Loss: 0.318 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2546s/iter; left time: 8072.7922s
	iters: 200, epoch: 24 | loss: 0.0000006
	speed: 0.0690s/iter; left time: 2180.4715s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0696s/iter; left time: 2193.0395s
	iters: 400, epoch: 24 | loss: 0.0000001
	speed: 0.0646s/iter; left time: 2029.4144s
Epoch: 24 cost time: 28.43684959411621
Epoch: 24, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.329 Vali Acc: 0.971 Test Loss: 0.329 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2484s/iter; left time: 7772.2703s
	iters: 200, epoch: 25 | loss: 0.3870459
	speed: 0.0701s/iter; left time: 2187.0815s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0622s/iter; left time: 1934.4916s
	iters: 400, epoch: 25 | loss: 0.0000015
	speed: 0.0708s/iter; left time: 2194.4031s
Epoch: 25 cost time: 29.617152214050293
Epoch: 25, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2582s/iter; left time: 7972.7132s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0683s/iter; left time: 2103.2109s
	iters: 300, epoch: 26 | loss: 0.5543281
	speed: 0.0623s/iter; left time: 1910.0353s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0683s/iter; left time: 2088.1313s
Epoch: 26 cost time: 28.614771366119385
Epoch: 26, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.423 Vali Acc: 0.965 Test Loss: 0.423 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9749886311959982
model parameter : 104410
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2984472
	speed: 0.0914s/iter; left time: 3765.9412s
	iters: 200, epoch: 1 | loss: 0.2027737
	speed: 0.0459s/iter; left time: 1884.7735s
	iters: 300, epoch: 1 | loss: 0.1524902
	speed: 0.0423s/iter; left time: 1735.6618s
	iters: 400, epoch: 1 | loss: 0.0055902
	speed: 0.0474s/iter; left time: 1939.7896s
Epoch: 1 cost time: 23.318000555038452
Epoch: 1, Steps: 413 | Train Loss: 0.437 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0197443
	speed: 0.2139s/iter; left time: 8725.4615s
	iters: 200, epoch: 2 | loss: 0.0219696
	speed: 0.0489s/iter; left time: 1989.4343s
	iters: 300, epoch: 2 | loss: 0.0046995
	speed: 0.0525s/iter; left time: 2129.3272s
	iters: 400, epoch: 2 | loss: 0.0372501
	speed: 0.0509s/iter; left time: 2059.6798s
Epoch: 2 cost time: 22.307852506637573
Epoch: 2, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.106 Vali Acc: 0.964 Test Loss: 0.106 Test Acc: 0.964
Validation loss decreased (-0.957252 --> -0.963619).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0001855
	speed: 0.2177s/iter; left time: 8787.8722s
	iters: 200, epoch: 3 | loss: 0.0470788
	speed: 0.0496s/iter; left time: 1997.3485s
	iters: 300, epoch: 3 | loss: 0.0146618
	speed: 0.0571s/iter; left time: 2292.2177s
	iters: 400, epoch: 3 | loss: 0.0013084
	speed: 0.0488s/iter; left time: 1953.7072s
Epoch: 3 cost time: 22.5336697101593
Epoch: 3, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.235 Vali Acc: 0.945 Test Loss: 0.235 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0159824
	speed: 0.2309s/iter; left time: 9226.5808s
	iters: 200, epoch: 4 | loss: 0.0007679
	speed: 0.0476s/iter; left time: 1898.6527s
	iters: 300, epoch: 4 | loss: 0.0373790
	speed: 0.0485s/iter; left time: 1928.7684s
	iters: 400, epoch: 4 | loss: 0.3275469
	speed: 0.0496s/iter; left time: 1966.9578s
Epoch: 4 cost time: 22.462810277938843
Epoch: 4, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.225 Vali Acc: 0.953 Test Loss: 0.225 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0008437
	speed: 0.2272s/iter; left time: 8985.4284s
	iters: 200, epoch: 5 | loss: 0.0000788
	speed: 0.0518s/iter; left time: 2044.1439s
	iters: 300, epoch: 5 | loss: 0.0038227
	speed: 0.0523s/iter; left time: 2057.9964s
	iters: 400, epoch: 5 | loss: 0.0150732
	speed: 0.0462s/iter; left time: 1811.6429s
Epoch: 5 cost time: 21.66214370727539
Epoch: 5, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.963619 --> -0.966802).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0017314
	speed: 0.2151s/iter; left time: 8417.0206s
	iters: 200, epoch: 6 | loss: 0.0000042
	speed: 0.0529s/iter; left time: 2066.0966s
	iters: 300, epoch: 6 | loss: 0.0000911
	speed: 0.0498s/iter; left time: 1938.9950s
	iters: 400, epoch: 6 | loss: 0.0014453
	speed: 0.0382s/iter; left time: 1484.0029s
Epoch: 6 cost time: 20.671680688858032
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
Validation loss decreased (-0.966802 --> -0.972259).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000039
	speed: 0.2100s/iter; left time: 8130.8331s
	iters: 200, epoch: 7 | loss: 0.1389781
	speed: 0.0445s/iter; left time: 1717.0363s
	iters: 300, epoch: 7 | loss: 0.0468625
	speed: 0.0471s/iter; left time: 1812.7974s
	iters: 400, epoch: 7 | loss: 0.0037348
	speed: 0.0412s/iter; left time: 1581.4748s
Epoch: 7 cost time: 19.403902053833008
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.240 Vali Acc: 0.960 Test Loss: 0.240 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1210187
	speed: 0.2081s/iter; left time: 7973.2559s
	iters: 200, epoch: 8 | loss: 0.0000508
	speed: 0.0451s/iter; left time: 1721.6157s
	iters: 300, epoch: 8 | loss: 0.0092289
	speed: 0.0494s/iter; left time: 1881.6312s
	iters: 400, epoch: 8 | loss: 0.0066327
	speed: 0.0452s/iter; left time: 1718.8633s
Epoch: 8 cost time: 20.68831777572632
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.185 Vali Acc: 0.974 Test Loss: 0.185 Test Acc: 0.974
Validation loss decreased (-0.972259 --> -0.974077).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0012390
	speed: 0.1931s/iter; left time: 7319.6093s
	iters: 200, epoch: 9 | loss: 0.0346781
	speed: 0.0502s/iter; left time: 1897.1515s
	iters: 300, epoch: 9 | loss: 0.0000826
	speed: 0.0489s/iter; left time: 1843.0267s
	iters: 400, epoch: 9 | loss: 0.0000013
	speed: 0.0495s/iter; left time: 1861.7184s
Epoch: 9 cost time: 21.243364810943604
Epoch: 9, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.234 Vali Acc: 0.962 Test Loss: 0.234 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0276133
	speed: 0.2062s/iter; left time: 7729.6172s
	iters: 200, epoch: 10 | loss: 0.0346214
	speed: 0.0428s/iter; left time: 1600.8332s
	iters: 300, epoch: 10 | loss: 0.0085153
	speed: 0.0407s/iter; left time: 1518.0245s
	iters: 400, epoch: 10 | loss: 0.0000037
	speed: 0.0418s/iter; left time: 1552.9577s
Epoch: 10 cost time: 19.028775453567505
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.229 Vali Acc: 0.966 Test Loss: 0.229 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0033921
	speed: 0.2099s/iter; left time: 7780.4593s
	iters: 200, epoch: 11 | loss: 0.0000372
	speed: 0.0510s/iter; left time: 1887.0884s
	iters: 300, epoch: 11 | loss: 0.0374254
	speed: 0.0473s/iter; left time: 1744.6674s
	iters: 400, epoch: 11 | loss: 0.0000265
	speed: 0.0480s/iter; left time: 1763.4641s
Epoch: 11 cost time: 21.32797646522522
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.183 Vali Acc: 0.968 Test Loss: 0.183 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000003
	speed: 0.2246s/iter; left time: 8234.6444s
	iters: 200, epoch: 12 | loss: 0.0000229
	speed: 0.0433s/iter; left time: 1581.8373s
	iters: 300, epoch: 12 | loss: 0.0768471
	speed: 0.0445s/iter; left time: 1622.6344s
	iters: 400, epoch: 12 | loss: 0.0000016
	speed: 0.0475s/iter; left time: 1726.9152s
Epoch: 12 cost time: 20.09638237953186
Epoch: 12, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.173 Vali Acc: 0.973 Test Loss: 0.173 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0002002
	speed: 0.2280s/iter; left time: 8265.0637s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1754.4243s
	iters: 300, epoch: 13 | loss: 0.0000042
	speed: 0.0452s/iter; left time: 1629.9310s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 1717.8887s
Epoch: 13 cost time: 20.26465892791748
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.244 Vali Acc: 0.966 Test Loss: 0.244 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000059
	speed: 0.2147s/iter; left time: 7691.4755s
	iters: 200, epoch: 14 | loss: 0.0000303
	speed: 0.0443s/iter; left time: 1582.9598s
	iters: 300, epoch: 14 | loss: 0.0000591
	speed: 0.0407s/iter; left time: 1450.3593s
	iters: 400, epoch: 14 | loss: 0.2573529
	speed: 0.0467s/iter; left time: 1658.6366s
Epoch: 14 cost time: 18.786048412322998
Epoch: 14, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0006917
	speed: 0.2196s/iter; left time: 7778.9946s
	iters: 200, epoch: 15 | loss: 0.0335768
	speed: 0.0501s/iter; left time: 1768.2013s
	iters: 300, epoch: 15 | loss: 0.0014513
	speed: 0.0513s/iter; left time: 1807.7662s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 1652.2779s
Epoch: 15 cost time: 21.519866466522217
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
Validation loss decreased (-0.974077 --> -0.974987).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000121
	speed: 0.2195s/iter; left time: 7683.0180s
	iters: 200, epoch: 16 | loss: 0.0000052
	speed: 0.0426s/iter; left time: 1485.6511s
	iters: 300, epoch: 16 | loss: 0.0001359
	speed: 0.0481s/iter; left time: 1673.9623s
	iters: 400, epoch: 16 | loss: 0.0002797
	speed: 0.0541s/iter; left time: 1876.8200s
Epoch: 16 cost time: 20.547041416168213
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.169 Vali Acc: 0.974 Test Loss: 0.169 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000113
	speed: 0.2173s/iter; left time: 7518.3120s
	iters: 200, epoch: 17 | loss: 0.0000448
	speed: 0.0439s/iter; left time: 1514.9339s
	iters: 300, epoch: 17 | loss: 0.0034422
	speed: 0.0441s/iter; left time: 1518.4254s
	iters: 400, epoch: 17 | loss: 0.0000003
	speed: 0.0495s/iter; left time: 1696.0212s
Epoch: 17 cost time: 19.2882239818573
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.240 Vali Acc: 0.970 Test Loss: 0.240 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2162s/iter; left time: 7391.1932s
	iters: 200, epoch: 18 | loss: 0.0000027
	speed: 0.0474s/iter; left time: 1615.8850s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 1484.7820s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 1745.2995s
Epoch: 18 cost time: 20.422413110733032
Epoch: 18, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.196 Vali Acc: 0.972 Test Loss: 0.196 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0002467
	speed: 0.2239s/iter; left time: 7560.7376s
	iters: 200, epoch: 19 | loss: 0.0000023
	speed: 0.0505s/iter; left time: 1700.3164s
	iters: 300, epoch: 19 | loss: 0.0000047
	speed: 0.0477s/iter; left time: 1600.7048s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0485s/iter; left time: 1621.8454s
Epoch: 19 cost time: 21.134832859039307
Epoch: 19, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.267 Vali Acc: 0.972 Test Loss: 0.267 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000015
	speed: 0.2091s/iter; left time: 6973.7311s
	iters: 200, epoch: 20 | loss: 0.0000002
	speed: 0.0478s/iter; left time: 1587.9055s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 1598.9897s
	iters: 400, epoch: 20 | loss: 0.0031237
	speed: 0.0513s/iter; left time: 1694.9703s
Epoch: 20 cost time: 21.140939712524414
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.306 Vali Acc: 0.969 Test Loss: 0.306 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0188472
	speed: 0.2085s/iter; left time: 6868.1885s
	iters: 200, epoch: 21 | loss: 0.0000373
	speed: 0.0528s/iter; left time: 1733.7291s
	iters: 300, epoch: 21 | loss: 0.0026160
	speed: 0.0480s/iter; left time: 1572.2703s
	iters: 400, epoch: 21 | loss: 0.0000007
	speed: 0.0484s/iter; left time: 1578.7044s
Epoch: 21 cost time: 21.282460689544678
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.974 Test Loss: 0.213 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2131s/iter; left time: 6930.2866s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0445s/iter; left time: 1442.3365s
	iters: 300, epoch: 22 | loss: 0.0014516
	speed: 0.0524s/iter; left time: 1693.4013s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 1629.5052s
Epoch: 22 cost time: 21.850620985031128
Epoch: 22, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.303 Vali Acc: 0.970 Test Loss: 0.303 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2117s/iter; left time: 6797.6756s
	iters: 200, epoch: 23 | loss: 0.0011865
	speed: 0.0445s/iter; left time: 1423.6933s
	iters: 300, epoch: 23 | loss: 0.0000005
	speed: 0.0482s/iter; left time: 1539.1660s
	iters: 400, epoch: 23 | loss: 0.3670572
	speed: 0.0431s/iter; left time: 1371.5052s
Epoch: 23 cost time: 19.9517662525177
Epoch: 23, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.359 Vali Acc: 0.969 Test Loss: 0.359 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2047s/iter; left time: 6490.3047s
	iters: 200, epoch: 24 | loss: 0.0000001
	speed: 0.0451s/iter; left time: 1425.7984s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 1373.9091s
	iters: 400, epoch: 24 | loss: 0.0005046
	speed: 0.0444s/iter; left time: 1395.6803s
Epoch: 24 cost time: 19.97714376449585
Epoch: 24, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.289 Vali Acc: 0.972 Test Loss: 0.289 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2037s/iter; left time: 6373.8733s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0529s/iter; left time: 1648.8567s
	iters: 300, epoch: 25 | loss: 0.0000010
	speed: 0.0537s/iter; left time: 1668.3850s
	iters: 400, epoch: 25 | loss: 0.0006478
	speed: 0.0431s/iter; left time: 1337.0536s
Epoch: 25 cost time: 21.411855220794678
Epoch: 25, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9749886311959982
model parameter : 71162
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3510546
	speed: 0.1033s/iter; left time: 4255.8769s
	iters: 200, epoch: 1 | loss: 0.1628303
	speed: 0.0574s/iter; left time: 2357.4663s
	iters: 300, epoch: 1 | loss: 0.3809321
	speed: 0.0557s/iter; left time: 2285.1507s
	iters: 400, epoch: 1 | loss: 0.0652301
	speed: 0.0528s/iter; left time: 2161.2118s
Epoch: 1 cost time: 27.596909046173096
Epoch: 1, Steps: 413 | Train Loss: 0.523 Vali Loss: 0.161 Vali Acc: 0.947 Test Loss: 0.161 Test Acc: 0.947
Validation loss decreased (inf --> -0.946792).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2418066
	speed: 0.2359s/iter; left time: 9623.6260s
	iters: 200, epoch: 2 | loss: 0.0884802
	speed: 0.0550s/iter; left time: 2238.0270s
	iters: 300, epoch: 2 | loss: 0.0290974
	speed: 0.0503s/iter; left time: 2041.9906s
	iters: 400, epoch: 2 | loss: 0.0445576
	speed: 0.0455s/iter; left time: 1843.6796s
Epoch: 2 cost time: 22.114440202713013
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
Validation loss decreased (-0.946792 --> -0.956797).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0272783
	speed: 0.2376s/iter; left time: 9592.9492s
	iters: 200, epoch: 3 | loss: 0.0015390
	speed: 0.0495s/iter; left time: 1994.0681s
	iters: 300, epoch: 3 | loss: 0.6399406
	speed: 0.0502s/iter; left time: 2016.7531s
	iters: 400, epoch: 3 | loss: 0.0039655
	speed: 0.0499s/iter; left time: 2001.6667s
Epoch: 3 cost time: 21.98984169960022
Epoch: 3, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
Validation loss decreased (-0.956797 --> -0.964983).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1753419
	speed: 0.2339s/iter; left time: 9346.4126s
	iters: 200, epoch: 4 | loss: 0.0069965
	speed: 0.0501s/iter; left time: 1995.1990s
	iters: 300, epoch: 4 | loss: 0.0097493
	speed: 0.0501s/iter; left time: 1991.8958s
	iters: 400, epoch: 4 | loss: 0.1228739
	speed: 0.0540s/iter; left time: 2139.7697s
Epoch: 4 cost time: 22.085503339767456
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.964983 --> -0.972714).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0687927
	speed: 0.2390s/iter; left time: 9453.3207s
	iters: 200, epoch: 5 | loss: 0.0002033
	speed: 0.0479s/iter; left time: 1888.5860s
	iters: 300, epoch: 5 | loss: 0.0000550
	speed: 0.0528s/iter; left time: 2079.3972s
	iters: 400, epoch: 5 | loss: 0.0081319
	speed: 0.0467s/iter; left time: 1832.9383s
Epoch: 5 cost time: 21.061065435409546
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1359504
	speed: 0.2284s/iter; left time: 8938.0440s
	iters: 200, epoch: 6 | loss: 0.0456542
	speed: 0.0539s/iter; left time: 2103.9361s
	iters: 300, epoch: 6 | loss: 0.1325978
	speed: 0.0539s/iter; left time: 2098.1327s
	iters: 400, epoch: 6 | loss: 0.0016210
	speed: 0.0486s/iter; left time: 1888.6672s
Epoch: 6 cost time: 22.901703119277954
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000044
	speed: 0.2405s/iter; left time: 9311.5645s
	iters: 200, epoch: 7 | loss: 0.0078061
	speed: 0.0525s/iter; left time: 2028.4268s
	iters: 300, epoch: 7 | loss: 0.0059188
	speed: 0.0484s/iter; left time: 1865.5981s
	iters: 400, epoch: 7 | loss: 0.0000845
	speed: 0.0471s/iter; left time: 1810.5904s
Epoch: 7 cost time: 21.30111026763916
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.972714 --> -0.975897).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5437104
	speed: 0.2410s/iter; left time: 9234.1000s
	iters: 200, epoch: 8 | loss: 0.0958860
	speed: 0.0513s/iter; left time: 1962.0563s
	iters: 300, epoch: 8 | loss: 0.0061503
	speed: 0.0557s/iter; left time: 2123.8614s
	iters: 400, epoch: 8 | loss: 0.0070408
	speed: 0.0512s/iter; left time: 1946.7597s
Epoch: 8 cost time: 22.864679098129272
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0011582
	speed: 0.2454s/iter; left time: 9300.4271s
	iters: 200, epoch: 9 | loss: 0.0028383
	speed: 0.0563s/iter; left time: 2129.8323s
	iters: 300, epoch: 9 | loss: 0.8686645
	speed: 0.0514s/iter; left time: 1938.4858s
	iters: 400, epoch: 9 | loss: 0.0024446
	speed: 0.0588s/iter; left time: 2209.7022s
Epoch: 9 cost time: 24.070307970046997
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.975897 --> -0.976352).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000006
	speed: 0.2561s/iter; left time: 9599.1370s
	iters: 200, epoch: 10 | loss: 0.2466339
	speed: 0.0564s/iter; left time: 2106.8959s
	iters: 300, epoch: 10 | loss: 0.0433333
	speed: 0.0549s/iter; left time: 2047.0771s
	iters: 400, epoch: 10 | loss: 0.0000356
	speed: 0.0582s/iter; left time: 2163.0111s
Epoch: 10 cost time: 24.263755559921265
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000137
	speed: 0.2479s/iter; left time: 9191.6466s
	iters: 200, epoch: 11 | loss: 0.0001359
	speed: 0.0556s/iter; left time: 2055.8119s
	iters: 300, epoch: 11 | loss: 0.0000883
	speed: 0.0548s/iter; left time: 2018.7171s
	iters: 400, epoch: 11 | loss: 0.0007029
	speed: 0.0520s/iter; left time: 1912.0171s
Epoch: 11 cost time: 23.77062153816223
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.250 Vali Acc: 0.964 Test Loss: 0.250 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000194
	speed: 0.2271s/iter; left time: 8325.6418s
	iters: 200, epoch: 12 | loss: 0.0001328
	speed: 0.0508s/iter; left time: 1856.4305s
	iters: 300, epoch: 12 | loss: 0.2014968
	speed: 0.0572s/iter; left time: 2085.3849s
	iters: 400, epoch: 12 | loss: 0.0000008
	speed: 0.0559s/iter; left time: 2034.1068s
Epoch: 12 cost time: 23.48150134086609
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.170 Vali Acc: 0.976 Test Loss: 0.170 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0142561
	speed: 0.2260s/iter; left time: 8193.1022s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.0590s/iter; left time: 2131.9817s
	iters: 300, epoch: 13 | loss: 0.0284305
	speed: 0.0543s/iter; left time: 1955.4831s
	iters: 400, epoch: 13 | loss: 0.0001027
	speed: 0.0513s/iter; left time: 1843.1023s
Epoch: 13 cost time: 23.344184160232544
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.186 Vali Acc: 0.974 Test Loss: 0.186 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0060445
	speed: 0.2437s/iter; left time: 8730.8488s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0520s/iter; left time: 1858.1650s
	iters: 300, epoch: 14 | loss: 0.0000008
	speed: 0.0553s/iter; left time: 1971.3283s
	iters: 400, epoch: 14 | loss: 0.0000003
	speed: 0.0544s/iter; left time: 1932.2347s
Epoch: 14 cost time: 23.39168953895569
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.187 Vali Acc: 0.965 Test Loss: 0.187 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000674
	speed: 0.2349s/iter; left time: 8319.0748s
	iters: 200, epoch: 15 | loss: 0.0000026
	speed: 0.0541s/iter; left time: 1909.5149s
	iters: 300, epoch: 15 | loss: 0.0007045
	speed: 0.0530s/iter; left time: 1864.9598s
	iters: 400, epoch: 15 | loss: 0.0146954
	speed: 0.0536s/iter; left time: 1884.0556s
Epoch: 15 cost time: 23.331433534622192
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.176 Vali Acc: 0.976 Test Loss: 0.176 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2302s/iter; left time: 8056.6526s
	iters: 200, epoch: 16 | loss: 0.0137406
	speed: 0.0482s/iter; left time: 1680.7612s
	iters: 300, epoch: 16 | loss: 0.0000060
	speed: 0.0523s/iter; left time: 1821.6752s
	iters: 400, epoch: 16 | loss: 0.0000869
	speed: 0.0551s/iter; left time: 1911.0729s
Epoch: 16 cost time: 22.246150016784668
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.972 Test Loss: 0.200 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000022
	speed: 0.2216s/iter; left time: 7664.3478s
	iters: 200, epoch: 17 | loss: 0.0021970
	speed: 0.0530s/iter; left time: 1828.7648s
	iters: 300, epoch: 17 | loss: 0.0000237
	speed: 0.0500s/iter; left time: 1718.7826s
	iters: 400, epoch: 17 | loss: 0.0000002
	speed: 0.0545s/iter; left time: 1868.6786s
Epoch: 17 cost time: 22.21939516067505
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.189 Vali Acc: 0.970 Test Loss: 0.189 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.2229s/iter; left time: 7620.0322s
	iters: 200, epoch: 18 | loss: 0.0001065
	speed: 0.0535s/iter; left time: 1824.3155s
	iters: 300, epoch: 18 | loss: 0.0000341
	speed: 0.0526s/iter; left time: 1787.9571s
	iters: 400, epoch: 18 | loss: 0.0000667
	speed: 0.0546s/iter; left time: 1850.4949s
Epoch: 18 cost time: 22.341049194335938
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.185 Vali Acc: 0.978 Test Loss: 0.185 Test Acc: 0.978
Validation loss decreased (-0.976352 --> -0.977715).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000154
	speed: 0.2268s/iter; left time: 7658.2762s
	iters: 200, epoch: 19 | loss: 0.0000203
	speed: 0.0532s/iter; left time: 1789.5984s
	iters: 300, epoch: 19 | loss: 0.0003038
	speed: 0.0537s/iter; left time: 1802.8706s
	iters: 400, epoch: 19 | loss: 0.0000050
	speed: 0.0525s/iter; left time: 1758.6785s
Epoch: 19 cost time: 23.511745929718018
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.158 Vali Acc: 0.974 Test Loss: 0.158 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0628020
	speed: 0.2271s/iter; left time: 7576.2999s
	iters: 200, epoch: 20 | loss: 0.0000003
	speed: 0.0544s/iter; left time: 1807.8165s
	iters: 300, epoch: 20 | loss: 0.0000010
	speed: 0.0591s/iter; left time: 1960.7147s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.0609s/iter; left time: 2013.3099s
Epoch: 20 cost time: 23.76763343811035
Epoch: 20, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.232 Vali Acc: 0.977 Test Loss: 0.232 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0086301
	speed: 0.2229s/iter; left time: 7341.6076s
	iters: 200, epoch: 21 | loss: 0.0003589
	speed: 0.0469s/iter; left time: 1539.5407s
	iters: 300, epoch: 21 | loss: 0.0000153
	speed: 0.0570s/iter; left time: 1867.4237s
	iters: 400, epoch: 21 | loss: 0.0000045
	speed: 0.0545s/iter; left time: 1778.7574s
Epoch: 21 cost time: 22.312192678451538
Epoch: 21, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.263 Vali Acc: 0.969 Test Loss: 0.263 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000012
	speed: 0.2171s/iter; left time: 7060.3910s
	iters: 200, epoch: 22 | loss: 0.0006956
	speed: 0.0504s/iter; left time: 1633.3442s
	iters: 300, epoch: 22 | loss: 0.0004326
	speed: 0.0533s/iter; left time: 1721.5141s
	iters: 400, epoch: 22 | loss: 0.0000009
	speed: 0.0604s/iter; left time: 1947.6962s
Epoch: 22 cost time: 23.293034315109253
Epoch: 22, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.308 Vali Acc: 0.973 Test Loss: 0.308 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000040
	speed: 0.2340s/iter; left time: 7514.4091s
	iters: 200, epoch: 23 | loss: 0.0012825
	speed: 0.0538s/iter; left time: 1721.7371s
	iters: 300, epoch: 23 | loss: 0.0000053
	speed: 0.0529s/iter; left time: 1688.1585s
	iters: 400, epoch: 23 | loss: 0.0000542
	speed: 0.0560s/iter; left time: 1782.3063s
Epoch: 23 cost time: 23.63224983215332
Epoch: 23, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2557s/iter; left time: 8107.2922s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1492.4366s
	iters: 300, epoch: 24 | loss: 0.0002962
	speed: 0.0484s/iter; left time: 1523.8246s
	iters: 400, epoch: 24 | loss: 0.0000053
	speed: 0.0525s/iter; left time: 1648.8818s
Epoch: 24 cost time: 21.87799572944641
Epoch: 24, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.227 Vali Acc: 0.977 Test Loss: 0.227 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2305s/iter; left time: 7211.4522s
	iters: 200, epoch: 25 | loss: 0.0017442
	speed: 0.0514s/iter; left time: 1603.1789s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 1743.7636s
	iters: 400, epoch: 25 | loss: 0.0174114
	speed: 0.0545s/iter; left time: 1688.3208s
Epoch: 25 cost time: 23.055272340774536
Epoch: 25, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2239s/iter; left time: 6912.0281s
	iters: 200, epoch: 26 | loss: 0.0000010
	speed: 0.0526s/iter; left time: 1619.0184s
	iters: 300, epoch: 26 | loss: 0.0000622
	speed: 0.0527s/iter; left time: 1617.7457s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.0530s/iter; left time: 1621.6565s
Epoch: 26 cost time: 22.216755628585815
Epoch: 26, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.978 Test Loss: 0.217 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000060
	speed: 0.2222s/iter; left time: 6767.9500s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0550s/iter; left time: 1671.0520s
	iters: 300, epoch: 27 | loss: 0.0365998
	speed: 0.0559s/iter; left time: 1692.7520s
	iters: 400, epoch: 27 | loss: 0.0000012
	speed: 0.0583s/iter; left time: 1757.1198s
Epoch: 27 cost time: 23.272570371627808
Epoch: 27, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.980 Test Loss: 0.165 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979989).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000001
	speed: 0.2388s/iter; left time: 7177.1179s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 1558.4563s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 1528.9517s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 1683.9862s
Epoch: 28 cost time: 23.650025367736816
Epoch: 28, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.264 Vali Acc: 0.979 Test Loss: 0.264 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2600s/iter; left time: 7706.2795s
	iters: 200, epoch: 29 | loss: 0.0000142
	speed: 0.0495s/iter; left time: 1461.8925s
	iters: 300, epoch: 29 | loss: 0.0706094
	speed: 0.0554s/iter; left time: 1630.3973s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0586s/iter; left time: 1717.7850s
Epoch: 29 cost time: 23.82368516921997
Epoch: 29, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.977 Test Loss: 0.199 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0002655
	speed: 0.2573s/iter; left time: 7520.6604s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 1555.2605s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 1506.8473s
	iters: 400, epoch: 30 | loss: 0.0000130
	speed: 0.0554s/iter; left time: 1603.0187s
Epoch: 30 cost time: 23.100041151046753
Epoch: 30, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.231 Vali Acc: 0.980 Test Loss: 0.231 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0000001
	speed: 0.2316s/iter; left time: 6672.8352s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0575s/iter; left time: 1651.8139s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0541s/iter; left time: 1548.9152s
	iters: 400, epoch: 31 | loss: 0.0000367
	speed: 0.0565s/iter; left time: 1611.6934s
Epoch: 31 cost time: 23.721920490264893
Epoch: 31, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.174 Vali Acc: 0.980 Test Loss: 0.174 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2501s/iter; left time: 7102.3736s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 1638.5084s
	iters: 300, epoch: 32 | loss: 0.0000002
	speed: 0.0550s/iter; left time: 1552.2915s
	iters: 400, epoch: 32 | loss: 0.0118290
	speed: 0.0513s/iter; left time: 1441.0022s
Epoch: 32 cost time: 24.254547595977783
Epoch: 32, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.293 Vali Acc: 0.973 Test Loss: 0.293 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2337s/iter; left time: 6539.6041s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 1448.4539s
	iters: 300, epoch: 33 | loss: 0.0000036
	speed: 0.0519s/iter; left time: 1441.2523s
	iters: 400, epoch: 33 | loss: 0.0000014
	speed: 0.0486s/iter; left time: 1346.0855s
Epoch: 33 cost time: 22.833879947662354
Epoch: 33, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.972 Test Loss: 0.217 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0002005
	speed: 0.2311s/iter; left time: 6371.7639s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 1436.7667s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 1575.8196s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 1492.4319s
Epoch: 34 cost time: 23.844231843948364
Epoch: 34, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.277 Vali Acc: 0.972 Test Loss: 0.277 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0000075
	speed: 0.2507s/iter; left time: 6809.5499s
	iters: 200, epoch: 35 | loss: 0.0009124
	speed: 0.0537s/iter; left time: 1454.1653s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 1423.4721s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 1272.8428s
Epoch: 35 cost time: 22.98758363723755
Epoch: 35, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.208 Vali Acc: 0.976 Test Loss: 0.208 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0000002
	speed: 0.2360s/iter; left time: 6313.2984s
	iters: 200, epoch: 36 | loss: 0.6551746
	speed: 0.0484s/iter; left time: 1289.1820s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0535s/iter; left time: 1418.9027s
	iters: 400, epoch: 36 | loss: 0.0000002
	speed: 0.0518s/iter; left time: 1369.6205s
Epoch: 36 cost time: 23.122741222381592
Epoch: 36, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.974 Test Loss: 0.207 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.2309s/iter; left time: 6079.6528s
	iters: 200, epoch: 37 | loss: 0.0000021
	speed: 0.0530s/iter; left time: 1390.1795s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 1484.3972s
	iters: 400, epoch: 37 | loss: 0.0002885
	speed: 0.0585s/iter; left time: 1523.0183s
Epoch: 37 cost time: 24.066528797149658
Epoch: 37, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.271 Vali Acc: 0.976 Test Loss: 0.271 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 54554
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3487213
	speed: 0.0973s/iter; left time: 4008.5889s
	iters: 200, epoch: 1 | loss: 0.1220749
	speed: 0.0538s/iter; left time: 2210.8783s
	iters: 300, epoch: 1 | loss: 0.0532466
	speed: 0.0551s/iter; left time: 2257.6470s
	iters: 400, epoch: 1 | loss: 0.0319783
	speed: 0.0573s/iter; left time: 2345.0044s
Epoch: 1 cost time: 27.12725591659546
Epoch: 1, Steps: 413 | Train Loss: 0.524 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
Validation loss decreased (inf --> -0.959071).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0747614
	speed: 0.2580s/iter; left time: 10521.5656s
	iters: 200, epoch: 2 | loss: 0.0102526
	speed: 0.0555s/iter; left time: 2260.1762s
	iters: 300, epoch: 2 | loss: 0.0372163
	speed: 0.0567s/iter; left time: 2299.4599s
	iters: 400, epoch: 2 | loss: 0.0170116
	speed: 0.0512s/iter; left time: 2071.9618s
Epoch: 2 cost time: 23.959513425827026
Epoch: 2, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.135 Vali Acc: 0.956 Test Loss: 0.135 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0154449
	speed: 0.2453s/iter; left time: 9903.8794s
	iters: 200, epoch: 3 | loss: 0.0213213
	speed: 0.0535s/iter; left time: 2153.9121s
	iters: 300, epoch: 3 | loss: 0.0398855
	speed: 0.0531s/iter; left time: 2133.3037s
	iters: 400, epoch: 3 | loss: 0.0020258
	speed: 0.0492s/iter; left time: 1971.5836s
Epoch: 3 cost time: 23.26850152015686
Epoch: 3, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.109 Vali Acc: 0.964 Test Loss: 0.109 Test Acc: 0.964
Validation loss decreased (-0.959071 --> -0.964073).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0024604
	speed: 0.2465s/iter; left time: 9849.6552s
	iters: 200, epoch: 4 | loss: 0.2276343
	speed: 0.0554s/iter; left time: 2209.9559s
	iters: 300, epoch: 4 | loss: 0.0387179
	speed: 0.0524s/iter; left time: 2085.0187s
	iters: 400, epoch: 4 | loss: 0.1009317
	speed: 0.0520s/iter; left time: 2063.0714s
Epoch: 4 cost time: 23.73203945159912
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (-0.964073 --> -0.970895).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0391504
	speed: 0.2264s/iter; left time: 8955.8296s
	iters: 200, epoch: 5 | loss: 0.0005961
	speed: 0.0587s/iter; left time: 2315.0459s
	iters: 300, epoch: 5 | loss: 0.0697220
	speed: 0.0576s/iter; left time: 2266.3261s
	iters: 400, epoch: 5 | loss: 0.0589821
	speed: 0.0526s/iter; left time: 2065.9420s
Epoch: 5 cost time: 23.737276315689087
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.970895 --> -0.975442).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000237
	speed: 0.2491s/iter; left time: 9748.5354s
	iters: 200, epoch: 6 | loss: 0.0021822
	speed: 0.0537s/iter; left time: 2097.8622s
	iters: 300, epoch: 6 | loss: 0.0018912
	speed: 0.0528s/iter; left time: 2054.0770s
	iters: 400, epoch: 6 | loss: 0.0000648
	speed: 0.0559s/iter; left time: 2169.2589s
Epoch: 6 cost time: 23.6297504901886
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0087316
	speed: 0.2386s/iter; left time: 9239.0180s
	iters: 200, epoch: 7 | loss: 0.0012658
	speed: 0.0605s/iter; left time: 2335.6612s
	iters: 300, epoch: 7 | loss: 0.0060362
	speed: 0.0530s/iter; left time: 2041.0155s
	iters: 400, epoch: 7 | loss: 0.0001461
	speed: 0.0574s/iter; left time: 2206.9921s
Epoch: 7 cost time: 24.50509762763977
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.975442 --> -0.979990).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0408391
	speed: 0.2336s/iter; left time: 8949.7449s
	iters: 200, epoch: 8 | loss: 0.0000591
	speed: 0.0506s/iter; left time: 1932.6701s
	iters: 300, epoch: 8 | loss: 0.0100680
	speed: 0.0554s/iter; left time: 2110.9437s
	iters: 400, epoch: 8 | loss: 0.0005346
	speed: 0.0581s/iter; left time: 2208.4775s
Epoch: 8 cost time: 23.225076913833618
Epoch: 8, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0001195
	speed: 0.2421s/iter; left time: 9175.8522s
	iters: 200, epoch: 9 | loss: 0.0000011
	speed: 0.0559s/iter; left time: 2113.9543s
	iters: 300, epoch: 9 | loss: 0.0000348
	speed: 0.0567s/iter; left time: 2138.3568s
	iters: 400, epoch: 9 | loss: 0.0001502
	speed: 0.0518s/iter; left time: 1946.2749s
Epoch: 9 cost time: 23.82798171043396
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000019
	speed: 0.2342s/iter; left time: 8779.8311s
	iters: 200, epoch: 10 | loss: 0.0000488
	speed: 0.0553s/iter; left time: 2068.1796s
	iters: 300, epoch: 10 | loss: 0.0025940
	speed: 0.0511s/iter; left time: 1906.3570s
	iters: 400, epoch: 10 | loss: 0.0020961
	speed: 0.0541s/iter; left time: 2012.7056s
Epoch: 10 cost time: 22.724421501159668
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000723
	speed: 0.2423s/iter; left time: 8981.9117s
	iters: 200, epoch: 11 | loss: 0.0281234
	speed: 0.0515s/iter; left time: 1903.2763s
	iters: 300, epoch: 11 | loss: 0.0189511
	speed: 0.0586s/iter; left time: 2160.2551s
	iters: 400, epoch: 11 | loss: 0.0000025
	speed: 0.0513s/iter; left time: 1886.0841s
Epoch: 11 cost time: 23.430344343185425
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0001005
	speed: 0.2442s/iter; left time: 8950.5253s
	iters: 200, epoch: 12 | loss: 0.0008890
	speed: 0.0591s/iter; left time: 2159.4657s
	iters: 300, epoch: 12 | loss: 0.0258516
	speed: 0.0539s/iter; left time: 1964.2241s
	iters: 400, epoch: 12 | loss: 0.0000397
	speed: 0.0598s/iter; left time: 2175.9124s
Epoch: 12 cost time: 23.966444969177246
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.191 Vali Acc: 0.970 Test Loss: 0.191 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000182
	speed: 0.2436s/iter; left time: 8827.9358s
	iters: 200, epoch: 13 | loss: 0.0000004
	speed: 0.0527s/iter; left time: 1905.5200s
	iters: 300, epoch: 13 | loss: 0.0006797
	speed: 0.0524s/iter; left time: 1887.7946s
	iters: 400, epoch: 13 | loss: 0.0000024
	speed: 0.0545s/iter; left time: 1958.6219s
Epoch: 13 cost time: 22.999572038650513
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0104416
	speed: 0.2518s/iter; left time: 9022.8049s
	iters: 200, epoch: 14 | loss: 0.0000059
	speed: 0.0502s/iter; left time: 1793.9298s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 1781.8917s
	iters: 400, epoch: 14 | loss: 0.0000004
	speed: 0.0523s/iter; left time: 1857.9864s
Epoch: 14 cost time: 22.160234928131104
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2477s/iter; left time: 8772.1400s
	iters: 200, epoch: 15 | loss: 0.0016343
	speed: 0.0508s/iter; left time: 1795.6844s
	iters: 300, epoch: 15 | loss: 0.0000006
	speed: 0.0481s/iter; left time: 1692.5569s
	iters: 400, epoch: 15 | loss: 0.0000315
	speed: 0.0554s/iter; left time: 1946.1521s
Epoch: 15 cost time: 22.29625415802002
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0270464
	speed: 0.2517s/iter; left time: 8810.3714s
	iters: 200, epoch: 16 | loss: 0.0000088
	speed: 0.0567s/iter; left time: 1979.9383s
	iters: 300, epoch: 16 | loss: 0.0568079
	speed: 0.0573s/iter; left time: 1993.0859s
	iters: 400, epoch: 16 | loss: 0.2121258
	speed: 0.0554s/iter; left time: 1923.7742s
Epoch: 16 cost time: 24.78182315826416
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.150 Vali Acc: 0.974 Test Loss: 0.150 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000810
	speed: 0.2517s/iter; left time: 8707.4593s
	iters: 200, epoch: 17 | loss: 0.0018889
	speed: 0.0573s/iter; left time: 1976.5982s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0483s/iter; left time: 1661.7301s
	iters: 400, epoch: 17 | loss: 0.0000002
	speed: 0.0504s/iter; left time: 1729.8353s
Epoch: 17 cost time: 23.00454092025757
Epoch: 17, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.979990 --> -0.982719).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0401310
	speed: 0.2553s/iter; left time: 8727.3564s
	iters: 200, epoch: 18 | loss: 0.4316009
	speed: 0.0549s/iter; left time: 1869.5047s
	iters: 300, epoch: 18 | loss: 0.0008789
	speed: 0.0466s/iter; left time: 1584.4985s
	iters: 400, epoch: 18 | loss: 0.1749669
	speed: 0.0484s/iter; left time: 1639.4522s
Epoch: 18 cost time: 22.217877626419067
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.169 Vali Acc: 0.977 Test Loss: 0.169 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0948805
	speed: 0.2541s/iter; left time: 8579.2640s
	iters: 200, epoch: 19 | loss: 0.0000006
	speed: 0.0474s/iter; left time: 1597.2066s
	iters: 300, epoch: 19 | loss: 0.0005243
	speed: 0.0447s/iter; left time: 1501.8590s
	iters: 400, epoch: 19 | loss: 0.0000020
	speed: 0.0540s/iter; left time: 1806.4879s
Epoch: 19 cost time: 21.09015130996704
Epoch: 19, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000511
	speed: 0.2169s/iter; left time: 7233.7503s
	iters: 200, epoch: 20 | loss: 0.0000003
	speed: 0.0500s/iter; left time: 1663.5215s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 1549.6384s
	iters: 400, epoch: 20 | loss: 0.0003025
	speed: 0.0490s/iter; left time: 1618.7447s
Epoch: 20 cost time: 21.692017793655396
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000174
	speed: 0.2470s/iter; left time: 8136.8751s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0539s/iter; left time: 1770.6194s
	iters: 300, epoch: 21 | loss: 0.0002446
	speed: 0.0540s/iter; left time: 1768.0944s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 1618.3787s
Epoch: 21 cost time: 22.679613828659058
Epoch: 21, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.984 Test Loss: 0.116 Test Acc: 0.984
Validation loss decreased (-0.982719 --> -0.983628).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2519s/iter; left time: 8193.7205s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0587s/iter; left time: 1903.9994s
	iters: 300, epoch: 22 | loss: 0.1498286
	speed: 0.0601s/iter; left time: 1944.2333s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 1669.7132s
Epoch: 22 cost time: 24.405064821243286
Epoch: 22, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.199 Vali Acc: 0.976 Test Loss: 0.199 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2488s/iter; left time: 7988.9978s
	iters: 200, epoch: 23 | loss: 0.0000005
	speed: 0.0552s/iter; left time: 1768.2963s
	iters: 300, epoch: 23 | loss: 0.3907456
	speed: 0.0599s/iter; left time: 1910.9414s
	iters: 400, epoch: 23 | loss: 0.0000002
	speed: 0.0506s/iter; left time: 1611.3570s
Epoch: 23 cost time: 23.750550031661987
Epoch: 23, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.974 Test Loss: 0.206 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0016142
	speed: 0.2502s/iter; left time: 7931.4176s
	iters: 200, epoch: 24 | loss: 0.0000008
	speed: 0.0547s/iter; left time: 1729.4024s
	iters: 300, epoch: 24 | loss: 0.0062962
	speed: 0.0481s/iter; left time: 1516.4154s
	iters: 400, epoch: 24 | loss: 0.0000795
	speed: 0.0513s/iter; left time: 1612.3552s
Epoch: 24 cost time: 22.959438800811768
Epoch: 24, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.153 Vali Acc: 0.979 Test Loss: 0.153 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.2578s/iter; left time: 8065.0967s
	iters: 200, epoch: 25 | loss: 0.0000001
	speed: 0.0553s/iter; left time: 1725.8466s
	iters: 300, epoch: 25 | loss: 0.0000921
	speed: 0.0599s/iter; left time: 1862.5809s
	iters: 400, epoch: 25 | loss: 0.0000072
	speed: 0.0576s/iter; left time: 1785.0221s
Epoch: 25 cost time: 25.779239654541016
Epoch: 25, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.191 Vali Acc: 0.976 Test Loss: 0.191 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0009594
	speed: 0.2564s/iter; left time: 7916.8494s
	iters: 200, epoch: 26 | loss: 0.0072047
	speed: 0.0557s/iter; left time: 1713.6696s
	iters: 300, epoch: 26 | loss: 0.0000237
	speed: 0.0532s/iter; left time: 1631.6322s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 1462.4255s
Epoch: 26 cost time: 23.691583156585693
Epoch: 26, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000258
	speed: 0.2348s/iter; left time: 7151.6184s
	iters: 200, epoch: 27 | loss: 0.0000003
	speed: 0.0509s/iter; left time: 1546.8894s
	iters: 300, epoch: 27 | loss: 0.0000004
	speed: 0.0525s/iter; left time: 1589.9516s
	iters: 400, epoch: 27 | loss: 0.0000005
	speed: 0.0513s/iter; left time: 1546.4865s
Epoch: 27 cost time: 22.774965524673462
Epoch: 27, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.131 Vali Acc: 0.984 Test Loss: 0.131 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000162
	speed: 0.2295s/iter; left time: 6897.0778s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 1533.4068s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 1547.1226s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 1721.1941s
Epoch: 28 cost time: 23.17657446861267
Epoch: 28, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000053
	speed: 0.1997s/iter; left time: 5919.0777s
	iters: 200, epoch: 29 | loss: 0.0034082
	speed: 0.0454s/iter; left time: 1341.0510s
	iters: 300, epoch: 29 | loss: 0.0000034
	speed: 0.0536s/iter; left time: 1577.7590s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0511s/iter; left time: 1498.4611s
Epoch: 29 cost time: 21.006838083267212
Epoch: 29, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.135 Vali Acc: 0.981 Test Loss: 0.135 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000011
	speed: 0.2233s/iter; left time: 6526.6563s
	iters: 200, epoch: 30 | loss: 0.0000117
	speed: 0.0474s/iter; left time: 1381.2313s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 1508.7173s
	iters: 400, epoch: 30 | loss: 0.0000001
	speed: 0.0529s/iter; left time: 1528.9525s
Epoch: 30 cost time: 22.41288924217224
Epoch: 30, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.152 Vali Acc: 0.980 Test Loss: 0.152 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2347s/iter; left time: 6762.1902s
	iters: 200, epoch: 31 | loss: 0.0000036
	speed: 0.0567s/iter; left time: 1628.9081s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 1571.3402s
	iters: 400, epoch: 31 | loss: 0.0000245
	speed: 0.0527s/iter; left time: 1503.5873s
Epoch: 31 cost time: 23.07819104194641
Epoch: 31, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.981 Test Loss: 0.200 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 44202
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4977328
	speed: 0.1030s/iter; left time: 4242.0114s
	iters: 200, epoch: 1 | loss: 0.4151561
	speed: 0.0498s/iter; left time: 2048.7724s
	iters: 300, epoch: 1 | loss: 0.1846008
	speed: 0.0500s/iter; left time: 2048.0893s
	iters: 400, epoch: 1 | loss: 0.2513477
	speed: 0.0546s/iter; left time: 2232.0932s
Epoch: 1 cost time: 26.55311155319214
Epoch: 1, Steps: 413 | Train Loss: 0.630 Vali Loss: 0.128 Vali Acc: 0.955 Test Loss: 0.128 Test Acc: 0.955
Validation loss decreased (inf --> -0.955433).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0941170
	speed: 0.2570s/iter; left time: 10480.8209s
	iters: 200, epoch: 2 | loss: 0.0145104
	speed: 0.0499s/iter; left time: 2031.2298s
	iters: 300, epoch: 2 | loss: 0.0698364
	speed: 0.0519s/iter; left time: 2108.4738s
	iters: 400, epoch: 2 | loss: 0.0027529
	speed: 0.0574s/iter; left time: 2324.0585s
Epoch: 2 cost time: 23.410173416137695
Epoch: 2, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.087 Vali Acc: 0.969 Test Loss: 0.087 Test Acc: 0.969
Validation loss decreased (-0.955433 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0033000
	speed: 0.2453s/iter; left time: 9902.3934s
	iters: 200, epoch: 3 | loss: 0.1922226
	speed: 0.0574s/iter; left time: 2312.0018s
	iters: 300, epoch: 3 | loss: 0.0028089
	speed: 0.0636s/iter; left time: 2554.7046s
	iters: 400, epoch: 3 | loss: 0.1201987
	speed: 0.0595s/iter; left time: 2384.2083s
Epoch: 3 cost time: 25.039315223693848
Epoch: 3, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
Validation loss decreased (-0.968621 --> -0.974533).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0202467
	speed: 0.2712s/iter; left time: 10837.1109s
	iters: 200, epoch: 4 | loss: 0.1215350
	speed: 0.0619s/iter; left time: 2466.5291s
	iters: 300, epoch: 4 | loss: 0.0635780
	speed: 0.0522s/iter; left time: 2076.2430s
	iters: 400, epoch: 4 | loss: 0.0139440
	speed: 0.0555s/iter; left time: 2202.3085s
Epoch: 4 cost time: 24.91997241973877
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0012671
	speed: 0.2696s/iter; left time: 10660.7221s
	iters: 200, epoch: 5 | loss: 0.0034994
	speed: 0.0597s/iter; left time: 2353.2886s
	iters: 300, epoch: 5 | loss: 0.1769477
	speed: 0.0595s/iter; left time: 2340.2444s
	iters: 400, epoch: 5 | loss: 0.0205861
	speed: 0.0549s/iter; left time: 2153.5416s
Epoch: 5 cost time: 24.880918502807617
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.974533 --> -0.974988).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0055123
	speed: 0.2748s/iter; left time: 10752.9716s
	iters: 200, epoch: 6 | loss: 0.0442273
	speed: 0.0505s/iter; left time: 1972.2779s
	iters: 300, epoch: 6 | loss: 0.0016711
	speed: 0.0559s/iter; left time: 2174.8118s
	iters: 400, epoch: 6 | loss: 0.0020128
	speed: 0.0634s/iter; left time: 2463.5537s
Epoch: 6 cost time: 24.97248411178589
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0005781
	speed: 0.2679s/iter; left time: 10374.7202s
	iters: 200, epoch: 7 | loss: 0.0014667
	speed: 0.0632s/iter; left time: 2440.2603s
	iters: 300, epoch: 7 | loss: 0.0000041
	speed: 0.0714s/iter; left time: 2751.5087s
	iters: 400, epoch: 7 | loss: 0.0006025
	speed: 0.0596s/iter; left time: 2288.3468s
Epoch: 7 cost time: 27.19468069076538
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2050029
	speed: 0.2543s/iter; left time: 9742.4922s
	iters: 200, epoch: 8 | loss: 0.0021533
	speed: 0.0572s/iter; left time: 2185.8980s
	iters: 300, epoch: 8 | loss: 0.0002620
	speed: 0.0552s/iter; left time: 2102.3293s
	iters: 400, epoch: 8 | loss: 0.3320935
	speed: 0.0644s/iter; left time: 2447.5547s
Epoch: 8 cost time: 25.125514030456543
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0079498
	speed: 0.2471s/iter; left time: 9365.1530s
	iters: 200, epoch: 9 | loss: 0.0087967
	speed: 0.0590s/iter; left time: 2231.0946s
	iters: 300, epoch: 9 | loss: 0.0608020
	speed: 0.0633s/iter; left time: 2387.3190s
	iters: 400, epoch: 9 | loss: 0.1331042
	speed: 0.0605s/iter; left time: 2273.6938s
Epoch: 9 cost time: 25.45754885673523
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000692
	speed: 0.2480s/iter; left time: 9294.6118s
	iters: 200, epoch: 10 | loss: 0.0005614
	speed: 0.0581s/iter; left time: 2170.2163s
	iters: 300, epoch: 10 | loss: 0.0000392
	speed: 0.0505s/iter; left time: 1882.6978s
	iters: 400, epoch: 10 | loss: 0.0019456
	speed: 0.0529s/iter; left time: 1968.6122s
Epoch: 10 cost time: 23.870294332504272
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2133766
	speed: 0.2546s/iter; left time: 9439.2281s
	iters: 200, epoch: 11 | loss: 0.0001978
	speed: 0.0557s/iter; left time: 2057.8037s
	iters: 300, epoch: 11 | loss: 0.2698904
	speed: 0.0545s/iter; left time: 2009.1905s
	iters: 400, epoch: 11 | loss: 0.0837801
	speed: 0.0464s/iter; left time: 1706.9260s
Epoch: 11 cost time: 23.24841618537903
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974988 --> -0.975442).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0004493
	speed: 0.2620s/iter; left time: 9605.8943s
	iters: 200, epoch: 12 | loss: 0.0000224
	speed: 0.0533s/iter; left time: 1946.9774s
	iters: 300, epoch: 12 | loss: 0.0062451
	speed: 0.0501s/iter; left time: 1827.8175s
	iters: 400, epoch: 12 | loss: 0.0000053
	speed: 0.0564s/iter; left time: 2050.8197s
Epoch: 12 cost time: 23.180278301239014
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0007685
	speed: 0.2631s/iter; left time: 9534.8494s
	iters: 200, epoch: 13 | loss: 0.0008200
	speed: 0.0542s/iter; left time: 1957.7558s
	iters: 300, epoch: 13 | loss: 0.0008480
	speed: 0.0591s/iter; left time: 2130.2966s
	iters: 400, epoch: 13 | loss: 0.0000781
	speed: 0.0611s/iter; left time: 2195.2483s
Epoch: 13 cost time: 25.09230089187622
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0013875
	speed: 0.2543s/iter; left time: 9112.0653s
	iters: 200, epoch: 14 | loss: 0.0046481
	speed: 0.0601s/iter; left time: 2146.0792s
	iters: 300, epoch: 14 | loss: 0.0006378
	speed: 0.0552s/iter; left time: 1965.6447s
	iters: 400, epoch: 14 | loss: 0.0000390
	speed: 0.0608s/iter; left time: 2159.4734s
Epoch: 14 cost time: 24.991385459899902
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.1100425
	speed: 0.2622s/iter; left time: 9288.6170s
	iters: 200, epoch: 15 | loss: 0.0000004
	speed: 0.0510s/iter; left time: 1802.2001s
	iters: 300, epoch: 15 | loss: 0.0001384
	speed: 0.0511s/iter; left time: 1800.1210s
	iters: 400, epoch: 15 | loss: 0.0040450
	speed: 0.0531s/iter; left time: 1864.8992s
Epoch: 15 cost time: 23.059064388275146
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0095453
	speed: 0.2465s/iter; left time: 8629.4856s
	iters: 200, epoch: 16 | loss: 0.0000046
	speed: 0.0479s/iter; left time: 1672.5290s
	iters: 300, epoch: 16 | loss: 0.0000165
	speed: 0.0591s/iter; left time: 2056.3628s
	iters: 400, epoch: 16 | loss: 0.0000079
	speed: 0.0564s/iter; left time: 1957.5669s
Epoch: 16 cost time: 23.321102380752563
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000035
	speed: 0.2478s/iter; left time: 8573.0130s
	iters: 200, epoch: 17 | loss: 0.0000222
	speed: 0.0529s/iter; left time: 1824.6916s
	iters: 300, epoch: 17 | loss: 0.0000263
	speed: 0.0548s/iter; left time: 1883.3683s
	iters: 400, epoch: 17 | loss: 0.0020995
	speed: 0.0661s/iter; left time: 2267.5823s
Epoch: 17 cost time: 24.711910486221313
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0014612
	speed: 0.2572s/iter; left time: 8790.6908s
	iters: 200, epoch: 18 | loss: 0.0000054
	speed: 0.0577s/iter; left time: 1964.7784s
	iters: 300, epoch: 18 | loss: 0.0250243
	speed: 0.0621s/iter; left time: 2111.2484s
	iters: 400, epoch: 18 | loss: 0.0000026
	speed: 0.0577s/iter; left time: 1956.0006s
Epoch: 18 cost time: 24.79912757873535
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0006120
	speed: 0.2782s/iter; left time: 9394.3794s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0585s/iter; left time: 1968.7763s
	iters: 300, epoch: 19 | loss: 0.1593587
	speed: 0.0659s/iter; left time: 2211.3179s
	iters: 400, epoch: 19 | loss: 0.0000149
	speed: 0.0590s/iter; left time: 1974.6899s
Epoch: 19 cost time: 26.48466730117798
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0009073
	speed: 0.2660s/iter; left time: 8873.4207s
	iters: 200, epoch: 20 | loss: 0.0009714
	speed: 0.0608s/iter; left time: 2023.1727s
	iters: 300, epoch: 20 | loss: 0.0000780
	speed: 0.0616s/iter; left time: 2043.2268s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0542s/iter; left time: 1793.0565s
Epoch: 20 cost time: 24.83424735069275
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.218 Vali Acc: 0.970 Test Loss: 0.218 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2653s/iter; left time: 8738.6456s
	iters: 200, epoch: 21 | loss: 0.0000526
	speed: 0.0579s/iter; left time: 1902.1304s
	iters: 300, epoch: 21 | loss: 0.0000183
	speed: 0.0571s/iter; left time: 1870.2158s
	iters: 400, epoch: 21 | loss: 0.0000125
	speed: 0.0564s/iter; left time: 1841.1997s
Epoch: 21 cost time: 24.47268009185791
Epoch: 21, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 33866
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0742009
	speed: 0.0932s/iter; left time: 3841.4523s
	iters: 200, epoch: 1 | loss: 0.2245323
	speed: 0.0549s/iter; left time: 2258.0530s
	iters: 300, epoch: 1 | loss: 0.0425266
	speed: 0.0600s/iter; left time: 2460.5223s
	iters: 400, epoch: 1 | loss: 0.0737224
	speed: 0.0526s/iter; left time: 2150.9893s
Epoch: 1 cost time: 26.83401107788086
Epoch: 1, Steps: 413 | Train Loss: 0.681 Vali Loss: 0.144 Vali Acc: 0.956 Test Loss: 0.144 Test Acc: 0.956
Validation loss decreased (inf --> -0.955888).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2693829
	speed: 0.2369s/iter; left time: 9663.3895s
	iters: 200, epoch: 2 | loss: 0.0298055
	speed: 0.0536s/iter; left time: 2179.7876s
	iters: 300, epoch: 2 | loss: 0.1516665
	speed: 0.0552s/iter; left time: 2238.5788s
	iters: 400, epoch: 2 | loss: 0.0650029
	speed: 0.0471s/iter; left time: 1907.2172s
Epoch: 2 cost time: 22.48950505256653
Epoch: 2, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.112 Vali Acc: 0.961 Test Loss: 0.112 Test Acc: 0.961
Validation loss decreased (-0.955888 --> -0.960890).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0241174
	speed: 0.2421s/iter; left time: 9773.0574s
	iters: 200, epoch: 3 | loss: 0.0704799
	speed: 0.0501s/iter; left time: 2018.0729s
	iters: 300, epoch: 3 | loss: 0.0272092
	speed: 0.0576s/iter; left time: 2315.1200s
	iters: 400, epoch: 3 | loss: 0.0071012
	speed: 0.0523s/iter; left time: 2094.1424s
Epoch: 3 cost time: 23.341610193252563
Epoch: 3, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.098 Vali Acc: 0.967 Test Loss: 0.098 Test Acc: 0.967
Validation loss decreased (-0.960890 --> -0.967257).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0180150
	speed: 0.2367s/iter; left time: 9460.5443s
	iters: 200, epoch: 4 | loss: 0.1280792
	speed: 0.0609s/iter; left time: 2429.0974s
	iters: 300, epoch: 4 | loss: 0.0098409
	speed: 0.0549s/iter; left time: 2183.8259s
	iters: 400, epoch: 4 | loss: 0.0040332
	speed: 0.0523s/iter; left time: 2073.4140s
Epoch: 4 cost time: 24.883801698684692
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0058563
	speed: 0.2527s/iter; left time: 9992.4136s
	iters: 200, epoch: 5 | loss: 0.0015034
	speed: 0.0637s/iter; left time: 2514.8371s
	iters: 300, epoch: 5 | loss: 0.0122174
	speed: 0.0692s/iter; left time: 2724.8730s
	iters: 400, epoch: 5 | loss: 0.0120662
	speed: 0.0639s/iter; left time: 2509.0610s
Epoch: 5 cost time: 27.053076028823853
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
Validation loss decreased (-0.967257 --> -0.967712).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0009417
	speed: 0.2628s/iter; left time: 10284.7079s
	iters: 200, epoch: 6 | loss: 0.0132397
	speed: 0.0593s/iter; left time: 2316.5742s
	iters: 300, epoch: 6 | loss: 0.0063530
	speed: 0.0563s/iter; left time: 2190.2877s
	iters: 400, epoch: 6 | loss: 0.0001015
	speed: 0.0669s/iter; left time: 2599.8498s
Epoch: 6 cost time: 25.58004140853882
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.967712 --> -0.972714).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2920153
	speed: 0.2608s/iter; left time: 10097.4853s
	iters: 200, epoch: 7 | loss: 0.0297005
	speed: 0.0693s/iter; left time: 2675.1698s
	iters: 300, epoch: 7 | loss: 0.0248680
	speed: 0.0667s/iter; left time: 2568.9770s
	iters: 400, epoch: 7 | loss: 0.0008597
	speed: 0.0617s/iter; left time: 2370.3171s
Epoch: 7 cost time: 28.66482424736023
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.092 Vali Acc: 0.967 Test Loss: 0.092 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0027190
	speed: 0.2660s/iter; left time: 10190.2961s
	iters: 200, epoch: 8 | loss: 0.0048181
	speed: 0.0701s/iter; left time: 2677.0116s
	iters: 300, epoch: 8 | loss: 0.0004684
	speed: 0.0747s/iter; left time: 2846.4967s
	iters: 400, epoch: 8 | loss: 0.0104635
	speed: 0.0784s/iter; left time: 2980.7129s
Epoch: 8 cost time: 31.11598777770996
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0040237
	speed: 0.2615s/iter; left time: 9908.4442s
	iters: 200, epoch: 9 | loss: 0.0080021
	speed: 0.0741s/iter; left time: 2800.0592s
	iters: 300, epoch: 9 | loss: 0.0001212
	speed: 0.0691s/iter; left time: 2605.2233s
	iters: 400, epoch: 9 | loss: 0.0031319
	speed: 0.0669s/iter; left time: 2516.6042s
Epoch: 9 cost time: 29.876477479934692
Epoch: 9, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.972714 --> -0.976807).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000183
	speed: 0.2626s/iter; left time: 9843.9582s
	iters: 200, epoch: 10 | loss: 0.0003226
	speed: 0.0662s/iter; left time: 2474.2716s
	iters: 300, epoch: 10 | loss: 0.0002225
	speed: 0.0642s/iter; left time: 2394.8860s
	iters: 400, epoch: 10 | loss: 0.0013377
	speed: 0.0695s/iter; left time: 2583.9045s
Epoch: 10 cost time: 28.70259141921997
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0024048
	speed: 0.2658s/iter; left time: 9852.4995s
	iters: 200, epoch: 11 | loss: 0.0005152
	speed: 0.0720s/iter; left time: 2660.4831s
	iters: 300, epoch: 11 | loss: 0.0006741
	speed: 0.0757s/iter; left time: 2792.4849s
	iters: 400, epoch: 11 | loss: 0.0000694
	speed: 0.0690s/iter; left time: 2537.0589s
Epoch: 11 cost time: 30.227338552474976
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0012544
	speed: 0.2702s/iter; left time: 9906.2730s
	iters: 200, epoch: 12 | loss: 0.0045963
	speed: 0.0592s/iter; left time: 2164.0412s
	iters: 300, epoch: 12 | loss: 0.1465473
	speed: 0.0736s/iter; left time: 2683.8662s
	iters: 400, epoch: 12 | loss: 0.0026247
	speed: 0.0750s/iter; left time: 2727.2418s
Epoch: 12 cost time: 28.982711791992188
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0003893
	speed: 0.2913s/iter; left time: 10559.8368s
	iters: 200, epoch: 13 | loss: 0.0010101
	speed: 0.0730s/iter; left time: 2638.9017s
	iters: 300, epoch: 13 | loss: 0.0261111
	speed: 0.0680s/iter; left time: 2451.6232s
	iters: 400, epoch: 13 | loss: 0.0755459
	speed: 0.0699s/iter; left time: 2511.2725s
Epoch: 13 cost time: 29.782248497009277
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.2227338
	speed: 0.3010s/iter; left time: 10785.4246s
	iters: 200, epoch: 14 | loss: 0.0000501
	speed: 0.0749s/iter; left time: 2677.3310s
	iters: 300, epoch: 14 | loss: 0.1195184
	speed: 0.0674s/iter; left time: 2402.6057s
	iters: 400, epoch: 14 | loss: 0.0001860
	speed: 0.0683s/iter; left time: 2427.4661s
Epoch: 14 cost time: 30.626429319381714
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0029060
	speed: 0.2917s/iter; left time: 10332.5267s
	iters: 200, epoch: 15 | loss: 0.0000131
	speed: 0.0636s/iter; left time: 2245.1035s
	iters: 300, epoch: 15 | loss: 0.1424388
	speed: 0.0581s/iter; left time: 2045.8120s
	iters: 400, epoch: 15 | loss: 0.0000807
	speed: 0.0675s/iter; left time: 2371.3645s
Epoch: 15 cost time: 27.32547926902771
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000197
	speed: 0.3040s/iter; left time: 10642.5192s
	iters: 200, epoch: 16 | loss: 0.0000071
	speed: 0.0677s/iter; left time: 2362.8888s
	iters: 300, epoch: 16 | loss: 0.0119907
	speed: 0.0610s/iter; left time: 2124.8359s
	iters: 400, epoch: 16 | loss: 0.0085865
	speed: 0.0562s/iter; left time: 1951.2481s
Epoch: 16 cost time: 27.029836893081665
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.976807 --> -0.978171).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0001191
	speed: 0.2642s/iter; left time: 9140.9301s
	iters: 200, epoch: 17 | loss: 0.0001342
	speed: 0.0650s/iter; left time: 2241.4309s
	iters: 300, epoch: 17 | loss: 0.0744681
	speed: 0.0613s/iter; left time: 2107.5998s
	iters: 400, epoch: 17 | loss: 0.0036509
	speed: 0.0553s/iter; left time: 1896.4604s
Epoch: 17 cost time: 26.11425280570984
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0006637
	speed: 0.2501s/iter; left time: 8548.8519s
	iters: 200, epoch: 18 | loss: 0.0000166
	speed: 0.0612s/iter; left time: 2086.7360s
	iters: 300, epoch: 18 | loss: 0.0001228
	speed: 0.0638s/iter; left time: 2167.2971s
	iters: 400, epoch: 18 | loss: 0.0027062
	speed: 0.0636s/iter; left time: 2154.9930s
Epoch: 18 cost time: 26.013769388198853
Epoch: 18, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000060
	speed: 0.2794s/iter; left time: 9433.5442s
	iters: 200, epoch: 19 | loss: 0.0000018
	speed: 0.0668s/iter; left time: 2247.2950s
	iters: 300, epoch: 19 | loss: 0.0000006
	speed: 0.0655s/iter; left time: 2199.4147s
	iters: 400, epoch: 19 | loss: 0.5178040
	speed: 0.0615s/iter; left time: 2058.4197s
Epoch: 19 cost time: 28.533118963241577
Epoch: 19, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0211527
	speed: 0.2848s/iter; left time: 9500.5024s
	iters: 200, epoch: 20 | loss: 0.0001419
	speed: 0.0650s/iter; left time: 2162.0843s
	iters: 300, epoch: 20 | loss: 0.0000214
	speed: 0.0692s/iter; left time: 2294.9139s
	iters: 400, epoch: 20 | loss: 0.0001128
	speed: 0.0610s/iter; left time: 2016.3880s
Epoch: 20 cost time: 28.096986293792725
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0055084
	speed: 0.2766s/iter; left time: 9110.1520s
	iters: 200, epoch: 21 | loss: 0.0005433
	speed: 0.0636s/iter; left time: 2089.0096s
	iters: 300, epoch: 21 | loss: 0.0007546
	speed: 0.0639s/iter; left time: 2093.6496s
	iters: 400, epoch: 21 | loss: 0.0000004
	speed: 0.0570s/iter; left time: 1861.0556s
Epoch: 21 cost time: 26.59799098968506
Epoch: 21, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0014239
	speed: 0.2663s/iter; left time: 8661.9708s
	iters: 200, epoch: 22 | loss: 0.0000882
	speed: 0.0643s/iter; left time: 2086.5964s
	iters: 300, epoch: 22 | loss: 0.2179456
	speed: 0.0639s/iter; left time: 2065.6788s
	iters: 400, epoch: 22 | loss: 0.0213836
	speed: 0.0619s/iter; left time: 1994.2295s
Epoch: 22 cost time: 26.858561754226685
Epoch: 22, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0024391
	speed: 0.2666s/iter; left time: 8560.6007s
	iters: 200, epoch: 23 | loss: 0.0000001
	speed: 0.0642s/iter; left time: 2054.6504s
	iters: 300, epoch: 23 | loss: 0.3390680
	speed: 0.0618s/iter; left time: 1973.4373s
	iters: 400, epoch: 23 | loss: 0.0000115
	speed: 0.0611s/iter; left time: 1944.3864s
Epoch: 23 cost time: 26.577770471572876
Epoch: 23, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000953
	speed: 0.2931s/iter; left time: 9292.8251s
	iters: 200, epoch: 24 | loss: 0.0040579
	speed: 0.0659s/iter; left time: 2082.7201s
	iters: 300, epoch: 24 | loss: 0.0011179
	speed: 0.0748s/iter; left time: 2357.5895s
	iters: 400, epoch: 24 | loss: 0.1524093
	speed: 0.0617s/iter; left time: 1937.3632s
Epoch: 24 cost time: 29.87272548675537
Epoch: 24, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0003032
	speed: 0.2785s/iter; left time: 8714.8928s
	iters: 200, epoch: 25 | loss: 0.0296297
	speed: 0.0739s/iter; left time: 2305.2151s
	iters: 300, epoch: 25 | loss: 0.0000083
	speed: 0.0677s/iter; left time: 2103.3589s
	iters: 400, epoch: 25 | loss: 0.0000011
	speed: 0.0641s/iter; left time: 1986.3824s
Epoch: 25 cost time: 29.47256588935852
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000018
	speed: 0.2797s/iter; left time: 8635.3346s
	iters: 200, epoch: 26 | loss: 0.3187896
	speed: 0.0716s/iter; left time: 2204.6992s
	iters: 300, epoch: 26 | loss: 0.0000018
	speed: 0.0693s/iter; left time: 2127.3524s
	iters: 400, epoch: 26 | loss: 0.0092764
	speed: 0.0614s/iter; left time: 1876.2145s
Epoch: 26 cost time: 29.16838765144348
Epoch: 26, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.141 Vali Acc: 0.974 Test Loss: 0.141 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 25626
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3874731
	speed: 0.0897s/iter; left time: 3696.9532s
	iters: 200, epoch: 1 | loss: 0.6089710
	speed: 0.0698s/iter; left time: 2866.8716s
	iters: 300, epoch: 1 | loss: 0.0807597
	speed: 0.0635s/iter; left time: 2604.0537s
	iters: 400, epoch: 1 | loss: 0.0891681
	speed: 0.0599s/iter; left time: 2451.6366s
Epoch: 1 cost time: 29.289382696151733
Epoch: 1, Steps: 413 | Train Loss: 0.781 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
Validation loss decreased (inf --> -0.949066).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1626050
	speed: 0.2340s/iter; left time: 9545.0535s
	iters: 200, epoch: 2 | loss: 0.0170121
	speed: 0.0539s/iter; left time: 2194.3993s
	iters: 300, epoch: 2 | loss: 0.0194924
	speed: 0.0567s/iter; left time: 2301.9370s
	iters: 400, epoch: 2 | loss: 0.1602086
	speed: 0.0586s/iter; left time: 2372.5943s
Epoch: 2 cost time: 23.733585596084595
Epoch: 2, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.110 Vali Acc: 0.957 Test Loss: 0.110 Test Acc: 0.957
Validation loss decreased (-0.949066 --> -0.957252).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0391004
	speed: 0.2305s/iter; left time: 9305.0383s
	iters: 200, epoch: 3 | loss: 0.0246667
	speed: 0.0561s/iter; left time: 2258.1629s
	iters: 300, epoch: 3 | loss: 0.0646078
	speed: 0.0554s/iter; left time: 2226.8017s
	iters: 400, epoch: 3 | loss: 0.1332013
	speed: 0.0521s/iter; left time: 2088.7155s
Epoch: 3 cost time: 23.81215000152588
Epoch: 3, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
Validation loss decreased (-0.957252 --> -0.976352).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0231472
	speed: 0.2522s/iter; left time: 10078.0718s
	iters: 200, epoch: 4 | loss: 0.0431202
	speed: 0.0656s/iter; left time: 2614.8023s
	iters: 300, epoch: 4 | loss: 0.0043587
	speed: 0.0639s/iter; left time: 2539.2190s
	iters: 400, epoch: 4 | loss: 0.0053705
	speed: 0.0585s/iter; left time: 2320.2816s
Epoch: 4 cost time: 26.803958892822266
Epoch: 4, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.066 Vali Acc: 0.975 Test Loss: 0.066 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0047814
	speed: 0.2463s/iter; left time: 9741.4230s
	iters: 200, epoch: 5 | loss: 0.0107736
	speed: 0.0663s/iter; left time: 2614.6007s
	iters: 300, epoch: 5 | loss: 0.0210309
	speed: 0.0612s/iter; left time: 2407.8936s
	iters: 400, epoch: 5 | loss: 0.0886816
	speed: 0.0622s/iter; left time: 2440.7257s
Epoch: 5 cost time: 26.938811779022217
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0025350
	speed: 0.2318s/iter; left time: 9071.0095s
	iters: 200, epoch: 6 | loss: 0.0174104
	speed: 0.0391s/iter; left time: 1526.5765s
	iters: 300, epoch: 6 | loss: 0.0210442
	speed: 0.0483s/iter; left time: 1880.9074s
	iters: 400, epoch: 6 | loss: 0.0954084
	speed: 0.0493s/iter; left time: 1914.8885s
Epoch: 6 cost time: 19.71981167793274
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.075 Vali Acc: 0.974 Test Loss: 0.075 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0066303
	speed: 0.2320s/iter; left time: 8984.9142s
	iters: 200, epoch: 7 | loss: 0.1238848
	speed: 0.0677s/iter; left time: 2613.3720s
	iters: 300, epoch: 7 | loss: 0.0191050
	speed: 0.0600s/iter; left time: 2312.8230s
	iters: 400, epoch: 7 | loss: 0.0024447
	speed: 0.0538s/iter; left time: 2067.0481s
Epoch: 7 cost time: 26.39550018310547
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.068 Vali Acc: 0.974 Test Loss: 0.068 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0821662
	speed: 0.2475s/iter; left time: 9479.8245s
	iters: 200, epoch: 8 | loss: 0.0001908
	speed: 0.0558s/iter; left time: 2132.2311s
	iters: 300, epoch: 8 | loss: 0.1326519
	speed: 0.0574s/iter; left time: 2188.2423s
	iters: 400, epoch: 8 | loss: 0.0016758
	speed: 0.0542s/iter; left time: 2061.3668s
Epoch: 8 cost time: 24.478846073150635
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.087 Vali Acc: 0.971 Test Loss: 0.087 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0305010
	speed: 0.2524s/iter; left time: 9565.2032s
	iters: 200, epoch: 9 | loss: 0.0994150
	speed: 0.0581s/iter; left time: 2194.1688s
	iters: 300, epoch: 9 | loss: 0.0014278
	speed: 0.0613s/iter; left time: 2309.0497s
	iters: 400, epoch: 9 | loss: 0.0266280
	speed: 0.0552s/iter; left time: 2075.7950s
Epoch: 9 cost time: 26.06436252593994
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0444557
	speed: 0.2860s/iter; left time: 10718.8860s
	iters: 200, epoch: 10 | loss: 0.0005220
	speed: 0.0611s/iter; left time: 2285.8362s
	iters: 300, epoch: 10 | loss: 0.0001085
	speed: 0.0586s/iter; left time: 2186.1856s
	iters: 400, epoch: 10 | loss: 0.0009998
	speed: 0.0566s/iter; left time: 2102.8223s
Epoch: 10 cost time: 25.80217409133911
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0015118
	speed: 0.2512s/iter; left time: 9312.6849s
	iters: 200, epoch: 11 | loss: 0.1301179
	speed: 0.0498s/iter; left time: 1839.5074s
	iters: 300, epoch: 11 | loss: 0.0032047
	speed: 0.0483s/iter; left time: 1782.6644s
	iters: 400, epoch: 11 | loss: 0.0039426
	speed: 0.0502s/iter; left time: 1846.4565s
Epoch: 11 cost time: 21.526463747024536
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0122983
	speed: 0.2713s/iter; left time: 9943.6367s
	iters: 200, epoch: 12 | loss: 0.0476190
	speed: 0.0554s/iter; left time: 2024.5026s
	iters: 300, epoch: 12 | loss: 0.0336547
	speed: 0.0589s/iter; left time: 2148.0450s
	iters: 400, epoch: 12 | loss: 0.0002707
	speed: 0.0593s/iter; left time: 2155.6263s
Epoch: 12 cost time: 25.8605694770813
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0011770
	speed: 0.2524s/iter; left time: 9149.0550s
	iters: 200, epoch: 13 | loss: 0.0012534
	speed: 0.0692s/iter; left time: 2500.1409s
	iters: 300, epoch: 13 | loss: 0.0100681
	speed: 0.0657s/iter; left time: 2368.8497s
	iters: 400, epoch: 13 | loss: 0.0966313
	speed: 0.0616s/iter; left time: 2215.2518s
Epoch: 13 cost time: 26.93004584312439
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el2_dm16_nh4_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 21546
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8773658
	speed: 0.1212s/iter; left time: 4994.2805s
	iters: 200, epoch: 1 | loss: 0.0330137
	speed: 0.0926s/iter; left time: 3805.4040s
	iters: 300, epoch: 1 | loss: 1.2553709
	speed: 0.0866s/iter; left time: 3548.8477s
	iters: 400, epoch: 1 | loss: 0.6045021
	speed: 0.0926s/iter; left time: 3786.7436s
Epoch: 1 cost time: 40.306960105895996
Epoch: 1, Steps: 413 | Train Loss: 0.563 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
Validation loss decreased (inf --> -0.949974).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0461008
	speed: 0.2999s/iter; left time: 12231.8130s
	iters: 200, epoch: 2 | loss: 0.7840191
	speed: 0.0773s/iter; left time: 3145.0262s
	iters: 300, epoch: 2 | loss: 0.0145844
	speed: 0.0758s/iter; left time: 3075.3072s
	iters: 400, epoch: 2 | loss: 0.2771048
	speed: 0.0708s/iter; left time: 2865.7618s
Epoch: 2 cost time: 34.079349756240845
Epoch: 2, Steps: 413 | Train Loss: 0.263 Vali Loss: 0.412 Vali Acc: 0.955 Test Loss: 0.412 Test Acc: 0.955
Validation loss decreased (-0.949974 --> -0.954975).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0084276
	speed: 0.2982s/iter; left time: 12037.8170s
	iters: 200, epoch: 3 | loss: 0.0000220
	speed: 0.0885s/iter; left time: 3564.9657s
	iters: 300, epoch: 3 | loss: 0.0000000
	speed: 0.0921s/iter; left time: 3702.0590s
	iters: 400, epoch: 3 | loss: 0.0000033
	speed: 0.0939s/iter; left time: 3763.9058s
Epoch: 3 cost time: 38.248013973236084
Epoch: 3, Steps: 413 | Train Loss: 0.278 Vali Loss: 0.494 Vali Acc: 0.954 Test Loss: 0.494 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.2856s/iter; left time: 11415.0352s
	iters: 200, epoch: 4 | loss: 0.0000000
	speed: 0.0844s/iter; left time: 3364.5318s
	iters: 300, epoch: 4 | loss: 0.6600847
	speed: 0.0961s/iter; left time: 3821.1853s
	iters: 400, epoch: 4 | loss: 0.0549595
	speed: 0.0874s/iter; left time: 3465.7990s
Epoch: 4 cost time: 37.63279581069946
Epoch: 4, Steps: 413 | Train Loss: 0.251 Vali Loss: 1.097 Vali Acc: 0.929 Test Loss: 1.097 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000001
	speed: 0.2929s/iter; left time: 11585.6099s
	iters: 200, epoch: 5 | loss: 1.0488398
	speed: 0.0721s/iter; left time: 2842.3937s
	iters: 300, epoch: 5 | loss: 0.0000001
	speed: 0.0760s/iter; left time: 2992.1669s
	iters: 400, epoch: 5 | loss: 0.7796155
	speed: 0.0688s/iter; left time: 2698.5551s
Epoch: 5 cost time: 31.95626735687256
Epoch: 5, Steps: 413 | Train Loss: 0.239 Vali Loss: 1.277 Vali Acc: 0.935 Test Loss: 1.277 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000004
	speed: 0.2932s/iter; left time: 11475.4437s
	iters: 200, epoch: 6 | loss: 0.2127242
	speed: 0.0938s/iter; left time: 3663.4352s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0964s/iter; left time: 3753.4205s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0994s/iter; left time: 3861.9961s
Epoch: 6 cost time: 40.466063499450684
Epoch: 6, Steps: 413 | Train Loss: 0.267 Vali Loss: 0.755 Vali Acc: 0.966 Test Loss: 0.755 Test Acc: 0.966
Validation loss decreased (-0.954975 --> -0.965886).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2848s/iter; left time: 11027.0988s
	iters: 200, epoch: 7 | loss: 2.4729090
	speed: 0.0729s/iter; left time: 2817.4380s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 3349.7360s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0807s/iter; left time: 3099.4757s
Epoch: 7 cost time: 34.50147533416748
Epoch: 7, Steps: 413 | Train Loss: 0.350 Vali Loss: 1.000 Vali Acc: 0.955 Test Loss: 1.000 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2937s/iter; left time: 11250.7240s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0868s/iter; left time: 3315.8575s
	iters: 300, epoch: 8 | loss: 0.0135384
	speed: 0.0900s/iter; left time: 3428.7658s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0828s/iter; left time: 3147.8044s
Epoch: 8 cost time: 36.92726135253906
Epoch: 8, Steps: 413 | Train Loss: 0.246 Vali Loss: 1.055 Vali Acc: 0.963 Test Loss: 1.055 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0693070
	speed: 0.2704s/iter; left time: 10247.7989s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0646s/iter; left time: 2440.1740s
	iters: 300, epoch: 9 | loss: 0.0007895
	speed: 0.0555s/iter; left time: 2092.3317s
	iters: 400, epoch: 9 | loss: 1.5568609
	speed: 0.0555s/iter; left time: 2087.9555s
Epoch: 9 cost time: 27.20043706893921
Epoch: 9, Steps: 413 | Train Loss: 0.255 Vali Loss: 1.229 Vali Acc: 0.959 Test Loss: 1.229 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2749s/iter; left time: 10305.1079s
	iters: 200, epoch: 10 | loss: 0.1318373
	speed: 0.0688s/iter; left time: 2570.3448s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0719s/iter; left time: 2680.6777s
	iters: 400, epoch: 10 | loss: 2.4913118
	speed: 0.0772s/iter; left time: 2868.8165s
Epoch: 10 cost time: 30.823817253112793
Epoch: 10, Steps: 413 | Train Loss: 0.289 Vali Loss: 1.020 Vali Acc: 0.955 Test Loss: 1.020 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2988s/iter; left time: 11076.2608s
	iters: 200, epoch: 11 | loss: 0.4720196
	speed: 0.0845s/iter; left time: 3125.6989s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0847s/iter; left time: 3123.0929s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0828s/iter; left time: 3045.9652s
Epoch: 11 cost time: 35.79952335357666
Epoch: 11, Steps: 413 | Train Loss: 0.176 Vali Loss: 0.877 Vali Acc: 0.971 Test Loss: 0.877 Test Acc: 0.971
Validation loss decreased (-0.965886 --> -0.970887).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2568s/iter; left time: 9415.1636s
	iters: 200, epoch: 12 | loss: 2.6588173
	speed: 0.0675s/iter; left time: 2469.2236s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 2697.8972s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0731s/iter; left time: 2657.7877s
Epoch: 12 cost time: 30.079455137252808
Epoch: 12, Steps: 413 | Train Loss: 0.242 Vali Loss: 1.219 Vali Acc: 0.965 Test Loss: 1.219 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2726s/iter; left time: 9878.7506s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0690s/iter; left time: 2494.7876s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0648s/iter; left time: 2334.3883s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0635s/iter; left time: 2282.7281s
Epoch: 13 cost time: 29.630025386810303
Epoch: 13, Steps: 413 | Train Loss: 0.181 Vali Loss: 1.451 Vali Acc: 0.968 Test Loss: 1.451 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2725s/iter; left time: 9765.1464s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 2846.6649s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0637s/iter; left time: 2270.3896s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 2225.5238s
Epoch: 14 cost time: 30.8102126121521
Epoch: 14, Steps: 413 | Train Loss: 0.171 Vali Loss: 1.058 Vali Acc: 0.966 Test Loss: 1.058 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.1670958
	speed: 0.2805s/iter; left time: 9936.0248s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0755s/iter; left time: 2665.3102s
	iters: 300, epoch: 15 | loss: 0.0001362
	speed: 0.0720s/iter; left time: 2536.3169s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 2687.3155s
Epoch: 15 cost time: 32.54420208930969
Epoch: 15, Steps: 413 | Train Loss: 0.212 Vali Loss: 1.513 Vali Acc: 0.966 Test Loss: 1.513 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2807s/iter; left time: 9827.2213s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0754s/iter; left time: 2631.9568s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0953s/iter; left time: 3316.8920s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 2565.4989s
Epoch: 16 cost time: 34.36973738670349
Epoch: 16, Steps: 413 | Train Loss: 0.139 Vali Loss: 1.450 Vali Acc: 0.962 Test Loss: 1.450 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1971s/iter; left time: 6817.7139s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0446s/iter; left time: 1537.2531s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0446s/iter; left time: 1532.8212s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 1494.1356s
Epoch: 17 cost time: 18.89871859550476
Epoch: 17, Steps: 413 | Train Loss: 0.244 Vali Loss: 1.145 Vali Acc: 0.966 Test Loss: 1.145 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1107s/iter; left time: 3783.6567s
	iters: 200, epoch: 18 | loss: 1.2421660
	speed: 0.0444s/iter; left time: 1513.2306s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 1511.8168s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0453s/iter; left time: 1535.8868s
Epoch: 18 cost time: 18.69070601463318
Epoch: 18, Steps: 413 | Train Loss: 0.219 Vali Loss: 1.534 Vali Acc: 0.965 Test Loss: 1.534 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1111s/iter; left time: 3752.4826s
	iters: 200, epoch: 19 | loss: 0.0000047
	speed: 0.0448s/iter; left time: 1507.3802s
	iters: 300, epoch: 19 | loss: 0.6885777
	speed: 0.0431s/iter; left time: 1445.5162s
	iters: 400, epoch: 19 | loss: 0.5302263
	speed: 0.0452s/iter; left time: 1512.2498s
Epoch: 19 cost time: 18.695030212402344
Epoch: 19, Steps: 413 | Train Loss: 0.113 Vali Loss: 1.266 Vali Acc: 0.964 Test Loss: 1.266 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1092s/iter; left time: 3641.1644s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1508.1232s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0455s/iter; left time: 1507.2851s
	iters: 400, epoch: 20 | loss: 0.0072786
	speed: 0.0439s/iter; left time: 1451.2713s
Epoch: 20 cost time: 18.91293740272522
Epoch: 20, Steps: 413 | Train Loss: 0.153 Vali Loss: 1.235 Vali Acc: 0.970 Test Loss: 1.235 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0101664
	speed: 0.1110s/iter; left time: 3655.8266s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 1447.5713s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 1466.8082s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0446s/iter; left time: 1454.1621s
Epoch: 21 cost time: 18.76454496383667
Epoch: 21, Steps: 413 | Train Loss: 0.167 Vali Loss: 1.675 Vali Acc: 0.962 Test Loss: 1.675 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9708958617553434
model parameter : 915210
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0276345
	speed: 0.0480s/iter; left time: 1976.5944s
	iters: 200, epoch: 1 | loss: 0.0181867
	speed: 0.0336s/iter; left time: 1379.2462s
	iters: 300, epoch: 1 | loss: 1.6980995
	speed: 0.0331s/iter; left time: 1355.2868s
	iters: 400, epoch: 1 | loss: 0.0862844
	speed: 0.0330s/iter; left time: 1350.5150s
Epoch: 1 cost time: 15.255122661590576
Epoch: 1, Steps: 413 | Train Loss: 0.497 Vali Loss: 0.346 Vali Acc: 0.953 Test Loss: 0.346 Test Acc: 0.953
Validation loss decreased (inf --> -0.952702).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0098554
	speed: 0.0931s/iter; left time: 3797.6202s
	iters: 200, epoch: 2 | loss: 0.0194493
	speed: 0.0333s/iter; left time: 1354.5701s
	iters: 300, epoch: 2 | loss: 0.0150798
	speed: 0.0343s/iter; left time: 1390.9639s
	iters: 400, epoch: 2 | loss: 0.1279746
	speed: 0.0340s/iter; left time: 1376.2882s
Epoch: 2 cost time: 14.21553373336792
Epoch: 2, Steps: 413 | Train Loss: 0.251 Vali Loss: 0.510 Vali Acc: 0.946 Test Loss: 0.510 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9920391
	speed: 0.0940s/iter; left time: 3796.1347s
	iters: 200, epoch: 3 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 1371.4851s
	iters: 300, epoch: 3 | loss: 0.0000109
	speed: 0.0331s/iter; left time: 1329.9355s
	iters: 400, epoch: 3 | loss: 0.1500576
	speed: 0.0330s/iter; left time: 1324.1758s
Epoch: 3 cost time: 14.135395050048828
Epoch: 3, Steps: 413 | Train Loss: 0.230 Vali Loss: 0.557 Vali Acc: 0.936 Test Loss: 0.557 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.7096900
	speed: 0.0951s/iter; left time: 3800.5142s
	iters: 200, epoch: 4 | loss: 0.0000012
	speed: 0.0330s/iter; left time: 1314.1063s
	iters: 300, epoch: 4 | loss: 0.0000001
	speed: 0.0341s/iter; left time: 1357.5648s
	iters: 400, epoch: 4 | loss: 0.1736170
	speed: 0.0350s/iter; left time: 1389.3699s
Epoch: 4 cost time: 14.320883989334106
Epoch: 4, Steps: 413 | Train Loss: 0.198 Vali Loss: 0.464 Vali Acc: 0.957 Test Loss: 0.464 Test Acc: 0.957
Validation loss decreased (-0.952702 --> -0.957249).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000064
	speed: 0.0937s/iter; left time: 3705.5313s
	iters: 200, epoch: 5 | loss: 0.0000314
	speed: 0.0353s/iter; left time: 1391.1285s
	iters: 300, epoch: 5 | loss: 0.0000016
	speed: 0.0347s/iter; left time: 1363.7503s
	iters: 400, epoch: 5 | loss: 0.0000008
	speed: 0.0337s/iter; left time: 1321.4608s
Epoch: 5 cost time: 14.494504451751709
Epoch: 5, Steps: 413 | Train Loss: 0.200 Vali Loss: 0.705 Vali Acc: 0.953 Test Loss: 0.705 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000042
	speed: 0.0927s/iter; left time: 3627.3758s
	iters: 200, epoch: 6 | loss: 0.0000125
	speed: 0.0332s/iter; left time: 1294.7421s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 1289.4843s
	iters: 400, epoch: 6 | loss: 0.0000652
	speed: 0.0340s/iter; left time: 1321.8128s
Epoch: 6 cost time: 14.128454446792603
Epoch: 6, Steps: 413 | Train Loss: 0.172 Vali Loss: 0.981 Vali Acc: 0.952 Test Loss: 0.981 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.0953s/iter; left time: 3689.0661s
	iters: 200, epoch: 7 | loss: 0.0941040
	speed: 0.0339s/iter; left time: 1307.7526s
	iters: 300, epoch: 7 | loss: 0.0909733
	speed: 0.0278s/iter; left time: 1069.9185s
	iters: 400, epoch: 7 | loss: 0.0000158
	speed: 0.0272s/iter; left time: 1044.6754s
Epoch: 7 cost time: 12.950088024139404
Epoch: 7, Steps: 413 | Train Loss: 0.223 Vali Loss: 0.693 Vali Acc: 0.968 Test Loss: 0.693 Test Acc: 0.968
Validation loss decreased (-0.957249 --> -0.967706).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0001914
	speed: 0.0906s/iter; left time: 3471.6501s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0304s/iter; left time: 1161.4167s
	iters: 300, epoch: 8 | loss: 2.2341094
	speed: 0.0287s/iter; left time: 1092.8955s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 1069.6953s
Epoch: 8 cost time: 12.497586965560913
Epoch: 8, Steps: 413 | Train Loss: 0.318 Vali Loss: 0.705 Vali Acc: 0.965 Test Loss: 0.705 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.0877s/iter; left time: 3323.2964s
	iters: 200, epoch: 9 | loss: 0.5278561
	speed: 0.0284s/iter; left time: 1074.0376s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 1066.5467s
	iters: 400, epoch: 9 | loss: 0.0000132
	speed: 0.0287s/iter; left time: 1080.6208s
Epoch: 9 cost time: 12.039300441741943
Epoch: 9, Steps: 413 | Train Loss: 0.196 Vali Loss: 0.724 Vali Acc: 0.963 Test Loss: 0.724 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0890s/iter; left time: 3335.6276s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 1047.2512s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0300s/iter; left time: 1118.7079s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0296s/iter; left time: 1102.3464s
Epoch: 10 cost time: 12.29727578163147
Epoch: 10, Steps: 413 | Train Loss: 0.186 Vali Loss: 0.563 Vali Acc: 0.965 Test Loss: 0.563 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.0917s/iter; left time: 3398.3894s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0295s/iter; left time: 1090.6845s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0286s/iter; left time: 1054.9707s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 1019.2150s
Epoch: 11 cost time: 12.147523403167725
Epoch: 11, Steps: 413 | Train Loss: 0.167 Vali Loss: 0.672 Vali Acc: 0.966 Test Loss: 0.672 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.0895s/iter; left time: 3279.3173s
	iters: 200, epoch: 12 | loss: 1.4805355
	speed: 0.0257s/iter; left time: 940.3921s
	iters: 300, epoch: 12 | loss: 2.1765814
	speed: 0.0205s/iter; left time: 745.8776s
	iters: 400, epoch: 12 | loss: 1.5718613
	speed: 0.0280s/iter; left time: 1018.3334s
Epoch: 12 cost time: 11.117297887802124
Epoch: 12, Steps: 413 | Train Loss: 0.273 Vali Loss: 0.640 Vali Acc: 0.971 Test Loss: 0.640 Test Acc: 0.971
Validation loss decreased (-0.967706 --> -0.970889).  Saving model ...
	iters: 100, epoch: 13 | loss: 3.1657403
	speed: 0.0880s/iter; left time: 3190.9389s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 1019.3103s
	iters: 300, epoch: 13 | loss: 2.5054398
	speed: 0.0296s/iter; left time: 1067.6401s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0302s/iter; left time: 1084.8435s
Epoch: 13 cost time: 12.329251527786255
Epoch: 13, Steps: 413 | Train Loss: 0.160 Vali Loss: 1.049 Vali Acc: 0.963 Test Loss: 1.049 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0886s/iter; left time: 3176.0216s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 1076.5181s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0303s/iter; left time: 1079.3081s
	iters: 400, epoch: 14 | loss: 0.0000019
	speed: 0.0292s/iter; left time: 1037.2516s
Epoch: 14 cost time: 12.55298137664795
Epoch: 14, Steps: 413 | Train Loss: 0.167 Vali Loss: 0.742 Vali Acc: 0.971 Test Loss: 0.742 Test Acc: 0.971
Validation loss decreased (-0.970889 --> -0.971343).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0910s/iter; left time: 3224.6533s
	iters: 200, epoch: 15 | loss: 0.0501149
	speed: 0.0307s/iter; left time: 1085.7498s
	iters: 300, epoch: 15 | loss: 0.0667883
	speed: 0.0300s/iter; left time: 1056.9763s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0296s/iter; left time: 1039.1720s
Epoch: 15 cost time: 12.851146697998047
Epoch: 15, Steps: 413 | Train Loss: 0.129 Vali Loss: 1.269 Vali Acc: 0.965 Test Loss: 1.269 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0892s/iter; left time: 3124.1351s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0292s/iter; left time: 1020.6475s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0298s/iter; left time: 1037.8884s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 1074.2811s
Epoch: 16 cost time: 12.695072889328003
Epoch: 16, Steps: 413 | Train Loss: 0.185 Vali Loss: 1.473 Vali Acc: 0.953 Test Loss: 1.473 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0880s/iter; left time: 3042.9352s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 901.0957s
	iters: 300, epoch: 17 | loss: 0.0000025
	speed: 0.0292s/iter; left time: 1002.5848s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 1168.4750s
Epoch: 17 cost time: 12.697190046310425
Epoch: 17, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.917 Vali Acc: 0.973 Test Loss: 0.917 Test Acc: 0.973
Validation loss decreased (-0.971343 --> -0.972706).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0992s/iter; left time: 3389.4783s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 1190.6546s
	iters: 300, epoch: 18 | loss: 1.8952341
	speed: 0.0337s/iter; left time: 1145.1593s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 1165.4964s
Epoch: 18 cost time: 14.565625429153442
Epoch: 18, Steps: 413 | Train Loss: 0.179 Vali Loss: 1.150 Vali Acc: 0.967 Test Loss: 1.150 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0997s/iter; left time: 3368.1112s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 1121.5022s
	iters: 300, epoch: 19 | loss: 3.6443446
	speed: 0.0336s/iter; left time: 1127.9557s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 1152.6727s
Epoch: 19 cost time: 14.2358078956604
Epoch: 19, Steps: 413 | Train Loss: 0.182 Vali Loss: 1.130 Vali Acc: 0.969 Test Loss: 1.130 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0018775
	speed: 0.0962s/iter; left time: 3208.2981s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0334s/iter; left time: 1110.3371s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0322s/iter; left time: 1067.9176s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.0320s/iter; left time: 1057.1437s
Epoch: 20 cost time: 13.821250915527344
Epoch: 20, Steps: 413 | Train Loss: 0.088 Vali Loss: 1.077 Vali Acc: 0.970 Test Loss: 1.077 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0943s/iter; left time: 3105.2236s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 1142.2406s
	iters: 300, epoch: 21 | loss: 0.1749855
	speed: 0.0336s/iter; left time: 1100.2713s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 1092.5159s
Epoch: 21 cost time: 14.596609354019165
Epoch: 21, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.866 Vali Acc: 0.977 Test Loss: 0.866 Test Acc: 0.977
Validation loss decreased (-0.972706 --> -0.976799).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0982s/iter; left time: 3192.6531s
	iters: 200, epoch: 22 | loss: 0.5262079
	speed: 0.0327s/iter; left time: 1061.3808s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 1063.0597s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 1070.4089s
Epoch: 22 cost time: 14.01243782043457
Epoch: 22, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.964 Vali Acc: 0.972 Test Loss: 0.964 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1014s/iter; left time: 3256.8723s
	iters: 200, epoch: 23 | loss: 0.2866565
	speed: 0.0321s/iter; left time: 1027.7873s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 1073.7895s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0334s/iter; left time: 1063.6321s
Epoch: 23 cost time: 13.948310852050781
Epoch: 23, Steps: 413 | Train Loss: 0.118 Vali Loss: 1.167 Vali Acc: 0.970 Test Loss: 1.167 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1046s/iter; left time: 3314.9352s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 1057.8079s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 1037.4389s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0327s/iter; left time: 1025.7263s
Epoch: 24 cost time: 14.000524520874023
Epoch: 24, Steps: 413 | Train Loss: 0.151 Vali Loss: 0.707 Vali Acc: 0.976 Test Loss: 0.707 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1073s/iter; left time: 3357.7563s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 1025.7197s
	iters: 300, epoch: 25 | loss: 0.0001989
	speed: 0.0325s/iter; left time: 1011.2961s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 1027.8822s
Epoch: 25 cost time: 14.014326572418213
Epoch: 25, Steps: 413 | Train Loss: 0.157 Vali Loss: 1.034 Vali Acc: 0.970 Test Loss: 1.034 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1042s/iter; left time: 3218.1382s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0328s/iter; left time: 1008.9133s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 1031.3772s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0339s/iter; left time: 1037.8027s
Epoch: 26 cost time: 14.115455389022827
Epoch: 26, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.684 Vali Acc: 0.978 Test Loss: 0.684 Test Acc: 0.978
Validation loss decreased (-0.976799 --> -0.977710).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1082s/iter; left time: 3295.1623s
	iters: 200, epoch: 27 | loss: 0.7560467
	speed: 0.0339s/iter; left time: 1028.6050s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0337s/iter; left time: 1020.9032s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0326s/iter; left time: 983.8844s
Epoch: 27 cost time: 14.194983005523682
Epoch: 27, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.696 Vali Acc: 0.975 Test Loss: 0.696 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1120s/iter; left time: 3365.5600s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 1004.4782s
	iters: 300, epoch: 28 | loss: 1.5788345
	speed: 0.0331s/iter; left time: 989.1722s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0323s/iter; left time: 962.3765s
Epoch: 28 cost time: 14.146775484085083
Epoch: 28, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.930 Vali Acc: 0.975 Test Loss: 0.930 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1094s/iter; left time: 3241.4940s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 943.0635s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0326s/iter; left time: 958.6446s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0326s/iter; left time: 956.3780s
Epoch: 29 cost time: 13.871148109436035
Epoch: 29, Steps: 413 | Train Loss: 0.132 Vali Loss: 1.137 Vali Acc: 0.971 Test Loss: 1.137 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.0946s/iter; left time: 2763.5152s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 788.4947s
	iters: 300, epoch: 30 | loss: 0.0000954
	speed: 0.0276s/iter; left time: 802.1003s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 816.3841s
Epoch: 30 cost time: 11.788637638092041
Epoch: 30, Steps: 413 | Train Loss: 0.107 Vali Loss: 1.074 Vali Acc: 0.979 Test Loss: 1.074 Test Acc: 0.979
Validation loss decreased (-0.977710 --> -0.978616).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1062s/iter; left time: 3060.1369s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 802.0729s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 816.7301s
	iters: 400, epoch: 31 | loss: 1.2595377
	speed: 0.0289s/iter; left time: 823.4848s
Epoch: 31 cost time: 12.067904710769653
Epoch: 31, Steps: 413 | Train Loss: 0.068 Vali Loss: 1.203 Vali Acc: 0.968 Test Loss: 1.203 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1067s/iter; left time: 3030.3995s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0288s/iter; left time: 813.6068s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0286s/iter; left time: 805.5757s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 811.9627s
Epoch: 32 cost time: 12.309529781341553
Epoch: 32, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.699 Vali Acc: 0.980 Test Loss: 0.699 Test Acc: 0.980
Validation loss decreased (-0.978616 --> -0.979984).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1065s/iter; left time: 2980.1320s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 789.6978s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 791.6103s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 777.6695s
Epoch: 33 cost time: 11.920604467391968
Epoch: 33, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.961 Vali Acc: 0.978 Test Loss: 0.961 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1062s/iter; left time: 2927.1296s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 781.2689s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0273s/iter; left time: 746.3353s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 723.1645s
Epoch: 34 cost time: 11.959280729293823
Epoch: 34, Steps: 413 | Train Loss: 0.097 Vali Loss: 1.062 Vali Acc: 0.973 Test Loss: 1.062 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1003s/iter; left time: 2724.3325s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0295s/iter; left time: 797.6485s
	iters: 300, epoch: 35 | loss: 0.3347620
	speed: 0.0289s/iter; left time: 778.4895s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 738.9609s
Epoch: 35 cost time: 12.172629833221436
Epoch: 35, Steps: 413 | Train Loss: 0.087 Vali Loss: 1.149 Vali Acc: 0.972 Test Loss: 1.149 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.0990s/iter; left time: 2648.6259s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 756.5502s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 744.5987s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 719.6927s
Epoch: 36 cost time: 11.91706657409668
Epoch: 36, Steps: 413 | Train Loss: 0.055 Vali Loss: 1.138 Vali Acc: 0.973 Test Loss: 1.138 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1017s/iter; left time: 2679.3752s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 720.4369s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 737.3994s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 740.5347s
Epoch: 37 cost time: 12.153871297836304
Epoch: 37, Steps: 413 | Train Loss: 0.073 Vali Loss: 1.412 Vali Acc: 0.971 Test Loss: 1.412 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.0998s/iter; left time: 2586.7287s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 669.9086s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 713.6655s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0304s/iter; left time: 778.2116s
Epoch: 38 cost time: 11.877184391021729
Epoch: 38, Steps: 413 | Train Loss: 0.089 Vali Loss: 1.131 Vali Acc: 0.976 Test Loss: 1.131 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.1009s/iter; left time: 2572.5152s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 689.8813s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0286s/iter; left time: 722.5550s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 708.5485s
Epoch: 39 cost time: 11.810047149658203
Epoch: 39, Steps: 413 | Train Loss: 0.093 Vali Loss: 1.236 Vali Acc: 0.972 Test Loss: 1.236 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0053204
	speed: 0.1070s/iter; left time: 2686.0020s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 854.5254s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 852.3834s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0320s/iter; left time: 794.6085s
Epoch: 40 cost time: 14.234283685684204
Epoch: 40, Steps: 413 | Train Loss: 0.069 Vali Loss: 1.039 Vali Acc: 0.978 Test Loss: 1.039 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.1186s/iter; left time: 2928.3134s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 799.6622s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0327s/iter; left time: 801.5543s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0324s/iter; left time: 790.3223s
Epoch: 41 cost time: 13.95447063446045
Epoch: 41, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.981 Vali Acc: 0.978 Test Loss: 0.981 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.1140s/iter; left time: 2767.1039s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.0328s/iter; left time: 792.9236s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0327s/iter; left time: 787.8502s
	iters: 400, epoch: 42 | loss: 0.1491600
	speed: 0.0336s/iter; left time: 804.3497s
Epoch: 42 cost time: 13.997581481933594
Epoch: 42, Steps: 413 | Train Loss: 0.094 Vali Loss: 1.135 Vali Acc: 0.976 Test Loss: 1.135 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 649226
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0343002
	speed: 0.0547s/iter; left time: 2255.4990s
	iters: 200, epoch: 1 | loss: 0.4194557
	speed: 0.0317s/iter; left time: 1302.8876s
	iters: 300, epoch: 1 | loss: 0.0245514
	speed: 0.0307s/iter; left time: 1259.7751s
	iters: 400, epoch: 1 | loss: 0.0000889
	speed: 0.0304s/iter; left time: 1243.6885s
Epoch: 1 cost time: 15.22403860092163
Epoch: 1, Steps: 413 | Train Loss: 0.409 Vali Loss: 0.397 Vali Acc: 0.935 Test Loss: 0.397 Test Acc: 0.935
Validation loss decreased (inf --> -0.934966).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4580453
	speed: 0.1066s/iter; left time: 4347.6627s
	iters: 200, epoch: 2 | loss: 0.1422070
	speed: 0.0318s/iter; left time: 1294.9677s
	iters: 300, epoch: 2 | loss: 0.3437788
	speed: 0.0311s/iter; left time: 1263.4940s
	iters: 400, epoch: 2 | loss: 0.2561331
	speed: 0.0301s/iter; left time: 1220.3779s
Epoch: 2 cost time: 13.323649406433105
Epoch: 2, Steps: 413 | Train Loss: 0.219 Vali Loss: 0.325 Vali Acc: 0.959 Test Loss: 0.325 Test Acc: 0.959
Validation loss decreased (-0.934966 --> -0.959069).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7190337
	speed: 0.1067s/iter; left time: 4308.7950s
	iters: 200, epoch: 3 | loss: 0.0331779
	speed: 0.0312s/iter; left time: 1255.6654s
	iters: 300, epoch: 3 | loss: 0.0684954
	speed: 0.0317s/iter; left time: 1273.4793s
	iters: 400, epoch: 3 | loss: 0.0001161
	speed: 0.0314s/iter; left time: 1258.4900s
Epoch: 3 cost time: 13.450664043426514
Epoch: 3, Steps: 413 | Train Loss: 0.225 Vali Loss: 0.511 Vali Acc: 0.942 Test Loss: 0.511 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0164564
	speed: 0.1059s/iter; left time: 4230.4956s
	iters: 200, epoch: 4 | loss: 0.0113419
	speed: 0.0302s/iter; left time: 1204.2844s
	iters: 300, epoch: 4 | loss: 0.0117886
	speed: 0.0308s/iter; left time: 1225.1374s
	iters: 400, epoch: 4 | loss: 0.0000006
	speed: 0.0329s/iter; left time: 1303.7661s
Epoch: 4 cost time: 13.518930912017822
Epoch: 4, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.481 Vali Acc: 0.936 Test Loss: 0.481 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7555568
	speed: 0.1350s/iter; left time: 5339.9737s
	iters: 200, epoch: 5 | loss: 0.0000044
	speed: 0.0378s/iter; left time: 1490.2838s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 1484.1229s
	iters: 400, epoch: 5 | loss: 0.0000003
	speed: 0.0393s/iter; left time: 1541.3753s
Epoch: 5 cost time: 16.410562992095947
Epoch: 5, Steps: 413 | Train Loss: 0.170 Vali Loss: 0.874 Vali Acc: 0.933 Test Loss: 0.874 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0058205
	speed: 0.1393s/iter; left time: 5451.8429s
	iters: 200, epoch: 6 | loss: 1.3353510
	speed: 0.0402s/iter; left time: 1567.9710s
	iters: 300, epoch: 6 | loss: 1.3763467
	speed: 0.0385s/iter; left time: 1499.1367s
	iters: 400, epoch: 6 | loss: 0.0000002
	speed: 0.0382s/iter; left time: 1483.9450s
Epoch: 6 cost time: 16.971351623535156
Epoch: 6, Steps: 413 | Train Loss: 0.231 Vali Loss: 0.402 Vali Acc: 0.971 Test Loss: 0.402 Test Acc: 0.971
Validation loss decreased (-0.959069 --> -0.971347).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1390s/iter; left time: 5383.8334s
	iters: 200, epoch: 7 | loss: 0.1185898
	speed: 0.0377s/iter; left time: 1457.4231s
	iters: 300, epoch: 7 | loss: 0.3138522
	speed: 0.0379s/iter; left time: 1461.7469s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 1454.9783s
Epoch: 7 cost time: 16.85407328605652
Epoch: 7, Steps: 413 | Train Loss: 0.147 Vali Loss: 0.428 Vali Acc: 0.959 Test Loss: 0.428 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000258
	speed: 0.1388s/iter; left time: 5316.0107s
	iters: 200, epoch: 8 | loss: 0.8800655
	speed: 0.0409s/iter; left time: 1562.3176s
	iters: 300, epoch: 8 | loss: 0.4720625
	speed: 0.0380s/iter; left time: 1449.7925s
	iters: 400, epoch: 8 | loss: 0.0013107
	speed: 0.0375s/iter; left time: 1424.4571s
Epoch: 8 cost time: 17.104418516159058
Epoch: 8, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.916 Vali Acc: 0.953 Test Loss: 0.916 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0177524
	speed: 0.1268s/iter; left time: 4805.9557s
	iters: 200, epoch: 9 | loss: 0.3669353
	speed: 0.0419s/iter; left time: 1583.1826s
	iters: 300, epoch: 9 | loss: 0.0004568
	speed: 0.0311s/iter; left time: 1172.6246s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0330s/iter; left time: 1240.3290s
Epoch: 9 cost time: 15.24594783782959
Epoch: 9, Steps: 413 | Train Loss: 0.187 Vali Loss: 0.637 Vali Acc: 0.960 Test Loss: 0.637 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1230s/iter; left time: 4611.7673s
	iters: 200, epoch: 10 | loss: 0.1768442
	speed: 0.0417s/iter; left time: 1557.4175s
	iters: 300, epoch: 10 | loss: 0.0000002
	speed: 0.0380s/iter; left time: 1417.8290s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 1175.7469s
Epoch: 10 cost time: 16.184431791305542
Epoch: 10, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.354 Vali Acc: 0.976 Test Loss: 0.354 Test Acc: 0.976
Validation loss decreased (-0.971347 --> -0.975895).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3005264
	speed: 0.1139s/iter; left time: 4221.6587s
	iters: 200, epoch: 11 | loss: 0.0000015
	speed: 0.0420s/iter; left time: 1552.2783s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0416s/iter; left time: 1533.3976s
	iters: 400, epoch: 11 | loss: 2.6962755
	speed: 0.0358s/iter; left time: 1316.4673s
Epoch: 11 cost time: 16.288612604141235
Epoch: 11, Steps: 413 | Train Loss: 0.199 Vali Loss: 0.486 Vali Acc: 0.971 Test Loss: 0.486 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000013
	speed: 0.1137s/iter; left time: 4168.1391s
	iters: 200, epoch: 12 | loss: 0.3245091
	speed: 0.0333s/iter; left time: 1218.0747s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 1482.7908s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 1490.7407s
Epoch: 12 cost time: 15.614562273025513
Epoch: 12, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.594 Vali Acc: 0.966 Test Loss: 0.594 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1126s/iter; left time: 4079.7475s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0337s/iter; left time: 1218.1519s
	iters: 300, epoch: 13 | loss: 0.0535849
	speed: 0.0356s/iter; left time: 1284.6649s
	iters: 400, epoch: 13 | loss: 1.0731299
	speed: 0.0424s/iter; left time: 1524.8412s
Epoch: 13 cost time: 15.39678406715393
Epoch: 13, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.494 Vali Acc: 0.972 Test Loss: 0.494 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1059s/iter; left time: 3795.8713s
	iters: 200, epoch: 14 | loss: 0.0071680
	speed: 0.0191s/iter; left time: 680.7161s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0313s/iter; left time: 1114.4800s
	iters: 400, epoch: 14 | loss: 0.0000259
	speed: 0.0318s/iter; left time: 1130.2951s
Epoch: 14 cost time: 11.97764539718628
Epoch: 14, Steps: 413 | Train Loss: 0.155 Vali Loss: 0.935 Vali Acc: 0.958 Test Loss: 0.935 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000021
	speed: 0.1220s/iter; left time: 4321.8971s
	iters: 200, epoch: 15 | loss: 0.4426730
	speed: 0.0320s/iter; left time: 1131.2908s
	iters: 300, epoch: 15 | loss: 0.0000646
	speed: 0.0290s/iter; left time: 1022.9073s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0300s/iter; left time: 1053.6994s
Epoch: 15 cost time: 13.201576232910156
Epoch: 15, Steps: 413 | Train Loss: 0.223 Vali Loss: 0.461 Vali Acc: 0.973 Test Loss: 0.461 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000001
	speed: 0.1189s/iter; left time: 4163.7203s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 1263.0938s
	iters: 300, epoch: 16 | loss: 0.0079612
	speed: 0.0305s/iter; left time: 1061.7586s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0298s/iter; left time: 1033.4843s
Epoch: 16 cost time: 14.549566268920898
Epoch: 16, Steps: 413 | Train Loss: 0.163 Vali Loss: 0.724 Vali Acc: 0.971 Test Loss: 0.724 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.5006095
	speed: 0.1188s/iter; left time: 4111.1354s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0399s/iter; left time: 1375.8016s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0320s/iter; left time: 1099.3262s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0299s/iter; left time: 1024.7190s
Epoch: 17 cost time: 15.041529655456543
Epoch: 17, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.920 Vali Acc: 0.969 Test Loss: 0.920 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1243s/iter; left time: 4248.2585s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0408s/iter; left time: 1391.6326s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0393s/iter; left time: 1334.9356s
	iters: 400, epoch: 18 | loss: 0.6131588
	speed: 0.0283s/iter; left time: 958.8327s
Epoch: 18 cost time: 15.652703523635864
Epoch: 18, Steps: 413 | Train Loss: 0.183 Vali Loss: 1.090 Vali Acc: 0.965 Test Loss: 1.090 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1133s/iter; left time: 3827.1577s
	iters: 200, epoch: 19 | loss: 0.0023350
	speed: 0.0407s/iter; left time: 1370.9738s
	iters: 300, epoch: 19 | loss: 1.2974582
	speed: 0.0355s/iter; left time: 1191.9071s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 1390.0448s
Epoch: 19 cost time: 15.507375955581665
Epoch: 19, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.773 Vali Acc: 0.973 Test Loss: 0.773 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1230s/iter; left time: 4103.3394s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0408s/iter; left time: 1357.7258s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 1466.4324s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 1454.0461s
Epoch: 20 cost time: 17.696805477142334
Epoch: 20, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.864 Vali Acc: 0.965 Test Loss: 0.864 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9758981355161437
model parameter : 516362
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3032435
	speed: 0.0533s/iter; left time: 2197.8235s
	iters: 200, epoch: 1 | loss: 0.5957328
	speed: 0.0338s/iter; left time: 1388.2507s
	iters: 300, epoch: 1 | loss: 0.0038038
	speed: 0.0326s/iter; left time: 1336.2960s
	iters: 400, epoch: 1 | loss: 0.0019974
	speed: 0.0342s/iter; left time: 1398.0952s
Epoch: 1 cost time: 15.915309190750122
Epoch: 1, Steps: 413 | Train Loss: 0.401 Vali Loss: 0.223 Vali Acc: 0.946 Test Loss: 0.223 Test Acc: 0.946
Validation loss decreased (inf --> -0.945882).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0277673
	speed: 0.1164s/iter; left time: 4747.0828s
	iters: 200, epoch: 2 | loss: 0.0093983
	speed: 0.0371s/iter; left time: 1507.6211s
	iters: 300, epoch: 2 | loss: 0.7199940
	speed: 0.0346s/iter; left time: 1404.4871s
	iters: 400, epoch: 2 | loss: 0.2975881
	speed: 0.0332s/iter; left time: 1345.2492s
Epoch: 2 cost time: 15.407260417938232
Epoch: 2, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.373 Vali Acc: 0.951 Test Loss: 0.373 Test Acc: 0.951
Validation loss decreased (-0.945882 --> -0.950883).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0002365
	speed: 0.1146s/iter; left time: 4628.6232s
	iters: 200, epoch: 3 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 1662.7050s
	iters: 300, epoch: 3 | loss: 0.5501606
	speed: 0.0395s/iter; left time: 1585.6680s
	iters: 400, epoch: 3 | loss: 0.0003393
	speed: 0.0347s/iter; left time: 1392.3356s
Epoch: 3 cost time: 16.554394721984863
Epoch: 3, Steps: 413 | Train Loss: 0.174 Vali Loss: 0.345 Vali Acc: 0.955 Test Loss: 0.345 Test Acc: 0.955
Validation loss decreased (-0.950883 --> -0.954521).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.1065s/iter; left time: 4256.0678s
	iters: 200, epoch: 4 | loss: 1.4588680
	speed: 0.0417s/iter; left time: 1662.2424s
	iters: 300, epoch: 4 | loss: 0.0000023
	speed: 0.0414s/iter; left time: 1646.4509s
	iters: 400, epoch: 4 | loss: 0.0027828
	speed: 0.0394s/iter; left time: 1564.3486s
Epoch: 4 cost time: 16.80972123146057
Epoch: 4, Steps: 413 | Train Loss: 0.145 Vali Loss: 0.243 Vali Acc: 0.970 Test Loss: 0.243 Test Acc: 0.970
Validation loss decreased (-0.954521 --> -0.970439).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.1064s/iter; left time: 4207.1861s
	iters: 200, epoch: 5 | loss: 0.1266012
	speed: 0.0353s/iter; left time: 1392.7641s
	iters: 300, epoch: 5 | loss: 2.7684832
	speed: 0.0415s/iter; left time: 1633.1147s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0409s/iter; left time: 1605.7964s
Epoch: 5 cost time: 16.14488935470581
Epoch: 5, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.243 Vali Acc: 0.970 Test Loss: 0.243 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4892478
	speed: 0.1081s/iter; left time: 4231.6490s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 1386.7439s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 1388.8820s
	iters: 400, epoch: 6 | loss: 0.0000760
	speed: 0.0414s/iter; left time: 1609.4925s
Epoch: 6 cost time: 15.599669218063354
Epoch: 6, Steps: 413 | Train Loss: 0.167 Vali Loss: 0.217 Vali Acc: 0.979 Test Loss: 0.217 Test Acc: 0.979
Validation loss decreased (-0.970439 --> -0.979079).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3534514
	speed: 0.1135s/iter; left time: 4395.3737s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 1296.3046s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 1302.9684s
	iters: 400, epoch: 7 | loss: 0.0000010
	speed: 0.0341s/iter; left time: 1308.5057s
Epoch: 7 cost time: 14.319454908370972
Epoch: 7, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.367 Vali Acc: 0.979 Test Loss: 0.367 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2474486
	speed: 0.1173s/iter; left time: 4495.4642s
	iters: 200, epoch: 8 | loss: 0.0000002
	speed: 0.0349s/iter; left time: 1333.7703s
	iters: 300, epoch: 8 | loss: 0.0470923
	speed: 0.0346s/iter; left time: 1319.5604s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 1257.8834s
Epoch: 8 cost time: 15.179726600646973
Epoch: 8, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.514 Vali Acc: 0.965 Test Loss: 0.514 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1202s/iter; left time: 4553.3642s
	iters: 200, epoch: 9 | loss: 1.4844468
	speed: 0.0409s/iter; left time: 1545.0550s
	iters: 300, epoch: 9 | loss: 0.3367970
	speed: 0.0349s/iter; left time: 1314.6535s
	iters: 400, epoch: 9 | loss: 0.0000006
	speed: 0.0342s/iter; left time: 1284.5627s
Epoch: 9 cost time: 16.026023387908936
Epoch: 9, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.625 Vali Acc: 0.962 Test Loss: 0.625 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2228620
	speed: 0.1089s/iter; left time: 4081.7982s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0401s/iter; left time: 1498.1928s
	iters: 300, epoch: 10 | loss: 0.1173232
	speed: 0.0401s/iter; left time: 1495.0949s
	iters: 400, epoch: 10 | loss: 0.9500823
	speed: 0.0390s/iter; left time: 1451.7316s
Epoch: 10 cost time: 16.07617211341858
Epoch: 10, Steps: 413 | Train Loss: 0.156 Vali Loss: 0.380 Vali Acc: 0.970 Test Loss: 0.380 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1094s/iter; left time: 4054.2926s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 1200.3951s
	iters: 300, epoch: 11 | loss: 0.5453266
	speed: 0.0406s/iter; left time: 1495.3831s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0401s/iter; left time: 1475.9158s
Epoch: 11 cost time: 15.654055833816528
Epoch: 11, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.352 Vali Acc: 0.977 Test Loss: 0.352 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000035
	speed: 0.1169s/iter; left time: 4286.6559s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0320s/iter; left time: 1168.7074s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 1272.1250s
	iters: 400, epoch: 12 | loss: 1.9553511
	speed: 0.0363s/iter; left time: 1318.1751s
Epoch: 12 cost time: 14.543806314468384
Epoch: 12, Steps: 413 | Train Loss: 0.156 Vali Loss: 0.402 Vali Acc: 0.974 Test Loss: 0.402 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1058s/iter; left time: 3833.3802s
	iters: 200, epoch: 13 | loss: 0.0000011
	speed: 0.0297s/iter; left time: 1074.0357s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 991.4673s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 1020.9262s
Epoch: 13 cost time: 11.980873823165894
Epoch: 13, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.448 Vali Acc: 0.977 Test Loss: 0.448 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1116s/iter; left time: 3999.3606s
	iters: 200, epoch: 14 | loss: 0.0000202
	speed: 0.0318s/iter; left time: 1137.4281s
	iters: 300, epoch: 14 | loss: 0.0242334
	speed: 0.0298s/iter; left time: 1062.9622s
	iters: 400, epoch: 14 | loss: 0.0000054
	speed: 0.0283s/iter; left time: 1006.7817s
Epoch: 14 cost time: 13.37308931350708
Epoch: 14, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.424 Vali Acc: 0.972 Test Loss: 0.424 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1067s/iter; left time: 3777.4870s
	iters: 200, epoch: 15 | loss: 0.0078322
	speed: 0.0229s/iter; left time: 809.7330s
	iters: 300, epoch: 15 | loss: 1.3881788
	speed: 0.0233s/iter; left time: 819.1322s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0228s/iter; left time: 801.6969s
Epoch: 15 cost time: 11.102339744567871
Epoch: 15, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.754 Vali Acc: 0.976 Test Loss: 0.754 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 2860.6509s
	iters: 200, epoch: 16 | loss: 0.3077737
	speed: 0.0301s/iter; left time: 1050.7740s
	iters: 300, epoch: 16 | loss: 0.0000992
	speed: 0.0326s/iter; left time: 1133.7519s
	iters: 400, epoch: 16 | loss: 0.1064190
	speed: 0.0283s/iter; left time: 982.1444s
Epoch: 16 cost time: 12.20323657989502
Epoch: 16, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.506 Vali Acc: 0.971 Test Loss: 0.506 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
model parameter : 433546
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3941512
	speed: 0.0472s/iter; left time: 1944.7897s
	iters: 200, epoch: 1 | loss: 0.3992571
	speed: 0.0257s/iter; left time: 1054.6559s
	iters: 300, epoch: 1 | loss: 0.0374925
	speed: 0.0299s/iter; left time: 1227.9323s
	iters: 400, epoch: 1 | loss: 0.1075539
	speed: 0.0258s/iter; left time: 1053.8743s
Epoch: 1 cost time: 13.249392747879028
Epoch: 1, Steps: 413 | Train Loss: 0.348 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
Validation loss decreased (inf --> -0.960435).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000333
	speed: 0.0968s/iter; left time: 3947.2142s
	iters: 200, epoch: 2 | loss: 0.8556825
	speed: 0.0322s/iter; left time: 1308.8307s
	iters: 300, epoch: 2 | loss: 0.0014460
	speed: 0.0271s/iter; left time: 1097.9923s
	iters: 400, epoch: 2 | loss: 0.3362506
	speed: 0.0262s/iter; left time: 1058.9333s
Epoch: 2 cost time: 12.310991525650024
Epoch: 2, Steps: 413 | Train Loss: 0.153 Vali Loss: 0.230 Vali Acc: 0.960 Test Loss: 0.230 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000370
	speed: 0.0937s/iter; left time: 3783.6694s
	iters: 200, epoch: 3 | loss: 0.5400469
	speed: 0.0313s/iter; left time: 1261.8216s
	iters: 300, epoch: 3 | loss: 0.4272912
	speed: 0.0258s/iter; left time: 1035.4346s
	iters: 400, epoch: 3 | loss: 0.0000091
	speed: 0.0253s/iter; left time: 1012.4192s
Epoch: 3 cost time: 12.077336549758911
Epoch: 3, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
Validation loss decreased (-0.960435 --> -0.975442).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0232365
	speed: 0.0994s/iter; left time: 3971.2599s
	iters: 200, epoch: 4 | loss: 0.0000179
	speed: 0.0294s/iter; left time: 1170.4082s
	iters: 300, epoch: 4 | loss: 0.5409806
	speed: 0.0269s/iter; left time: 1068.1288s
	iters: 400, epoch: 4 | loss: 0.0155067
	speed: 0.0260s/iter; left time: 1030.0389s
Epoch: 4 cost time: 12.209747314453125
Epoch: 4, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.323 Vali Acc: 0.968 Test Loss: 0.323 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2118808
	speed: 0.0992s/iter; left time: 3922.6024s
	iters: 200, epoch: 5 | loss: 0.0017139
	speed: 0.0264s/iter; left time: 1042.4491s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 1002.5474s
	iters: 400, epoch: 5 | loss: 0.0000001
	speed: 0.0254s/iter; left time: 995.8735s
Epoch: 5 cost time: 11.666542291641235
Epoch: 5, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.181 Vali Acc: 0.981 Test Loss: 0.181 Test Acc: 0.981
Validation loss decreased (-0.975442 --> -0.981353).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.1008s/iter; left time: 3943.7105s
	iters: 200, epoch: 6 | loss: 0.0003381
	speed: 0.0267s/iter; left time: 1040.8616s
	iters: 300, epoch: 6 | loss: 0.0000045
	speed: 0.0250s/iter; left time: 975.0780s
	iters: 400, epoch: 6 | loss: 0.0001596
	speed: 0.0260s/iter; left time: 1010.5561s
Epoch: 6 cost time: 11.499367475509644
Epoch: 6, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.373 Vali Acc: 0.971 Test Loss: 0.373 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000028
	speed: 0.0975s/iter; left time: 3774.0795s
	iters: 200, epoch: 7 | loss: 0.0891511
	speed: 0.0318s/iter; left time: 1229.8147s
	iters: 300, epoch: 7 | loss: 0.0000011
	speed: 0.0296s/iter; left time: 1141.0249s
	iters: 400, epoch: 7 | loss: 0.2072737
	speed: 0.0316s/iter; left time: 1214.3244s
Epoch: 7 cost time: 13.392860412597656
Epoch: 7, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.451 Vali Acc: 0.963 Test Loss: 0.451 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.1052s/iter; left time: 4029.7738s
	iters: 200, epoch: 8 | loss: 0.1266234
	speed: 0.0309s/iter; left time: 1180.0105s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0302s/iter; left time: 1152.5125s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0309s/iter; left time: 1172.9634s
Epoch: 8 cost time: 13.204509973526001
Epoch: 8, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.304 Vali Acc: 0.971 Test Loss: 0.304 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1047s/iter; left time: 3966.6604s
	iters: 200, epoch: 9 | loss: 0.0002578
	speed: 0.0299s/iter; left time: 1131.5812s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 1169.4099s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0320s/iter; left time: 1204.9290s
Epoch: 9 cost time: 13.297492742538452
Epoch: 9, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.465 Vali Acc: 0.966 Test Loss: 0.465 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000263
	speed: 0.1033s/iter; left time: 3870.2686s
	iters: 200, epoch: 10 | loss: 0.0000025
	speed: 0.0302s/iter; left time: 1128.3264s
	iters: 300, epoch: 10 | loss: 0.0066180
	speed: 0.0305s/iter; left time: 1138.8459s
	iters: 400, epoch: 10 | loss: 0.2364026
	speed: 0.0340s/iter; left time: 1264.6146s
Epoch: 10 cost time: 13.488816976547241
Epoch: 10, Steps: 413 | Train Loss: 0.145 Vali Loss: 0.432 Vali Acc: 0.965 Test Loss: 0.432 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000323
	speed: 0.1024s/iter; left time: 3795.0707s
	iters: 200, epoch: 11 | loss: 0.0000070
	speed: 0.0306s/iter; left time: 1131.8817s
	iters: 300, epoch: 11 | loss: 0.4123070
	speed: 0.0293s/iter; left time: 1080.6618s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 1244.6537s
Epoch: 11 cost time: 13.293161630630493
Epoch: 11, Steps: 413 | Train Loss: 0.142 Vali Loss: 0.608 Vali Acc: 0.959 Test Loss: 0.608 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.5217898
	speed: 0.1002s/iter; left time: 3674.6365s
	iters: 200, epoch: 12 | loss: 1.0994107
	speed: 0.0308s/iter; left time: 1126.4569s
	iters: 300, epoch: 12 | loss: 0.4916848
	speed: 0.0307s/iter; left time: 1118.5217s
	iters: 400, epoch: 12 | loss: 0.0000035
	speed: 0.0339s/iter; left time: 1232.7361s
Epoch: 12 cost time: 13.391000509262085
Epoch: 12, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.416 Vali Acc: 0.973 Test Loss: 0.416 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.0981s/iter; left time: 3554.3655s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0295s/iter; left time: 1066.5711s
	iters: 300, epoch: 13 | loss: 0.5834510
	speed: 0.0309s/iter; left time: 1113.4942s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0339s/iter; left time: 1217.4323s
Epoch: 13 cost time: 13.191499710083008
Epoch: 13, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.473 Vali Acc: 0.972 Test Loss: 0.473 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0865339
	speed: 0.0983s/iter; left time: 3523.3392s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0304s/iter; left time: 1087.8737s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0326s/iter; left time: 1160.7966s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 1230.0324s
Epoch: 14 cost time: 13.543299913406372
Epoch: 14, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.439 Vali Acc: 0.972 Test Loss: 0.439 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1024s/iter; left time: 3625.2437s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 1019.4538s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0330s/iter; left time: 1160.8360s
	iters: 400, epoch: 15 | loss: 0.0000011
	speed: 0.0337s/iter; left time: 1184.0394s
Epoch: 15 cost time: 13.350743770599365
Epoch: 15, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.264 Vali Acc: 0.982 Test Loss: 0.264 Test Acc: 0.982
Validation loss decreased (-0.981353 --> -0.981807).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1031s/iter; left time: 3608.6921s
	iters: 200, epoch: 16 | loss: 0.0015746
	speed: 0.0294s/iter; left time: 1025.8593s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 1168.9358s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 1186.7183s
Epoch: 16 cost time: 13.492485523223877
Epoch: 16, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.612 Vali Acc: 0.972 Test Loss: 0.612 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1015s/iter; left time: 3510.1404s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0311s/iter; left time: 1071.7870s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 1171.2256s
	iters: 400, epoch: 17 | loss: 0.2374657
	speed: 0.0322s/iter; left time: 1104.3873s
Epoch: 17 cost time: 13.554036140441895
Epoch: 17, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.381 Vali Acc: 0.974 Test Loss: 0.381 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0992s/iter; left time: 3392.1528s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0317s/iter; left time: 1079.4231s
	iters: 300, epoch: 18 | loss: 0.1135807
	speed: 0.0333s/iter; left time: 1132.9883s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 1049.8430s
Epoch: 18 cost time: 13.336777687072754
Epoch: 18, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.622 Vali Acc: 0.968 Test Loss: 0.622 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0995s/iter; left time: 3359.2078s
	iters: 200, epoch: 19 | loss: 2.3723259
	speed: 0.0331s/iter; left time: 1115.1640s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 1127.4075s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 1030.9746s
Epoch: 19 cost time: 13.558870315551758
Epoch: 19, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.533 Vali Acc: 0.974 Test Loss: 0.533 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1037s/iter; left time: 3459.2067s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 1170.8553s
	iters: 300, epoch: 20 | loss: 0.0000001
	speed: 0.0344s/iter; left time: 1141.6774s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0191s/iter; left time: 631.9107s
Epoch: 20 cost time: 12.71291732788086
Epoch: 20, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.311 Vali Acc: 0.977 Test Loss: 0.311 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0029541
	speed: 0.0992s/iter; left time: 3269.0111s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0317s/iter; left time: 1040.4737s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 929.4833s
	iters: 400, epoch: 21 | loss: 0.8261551
	speed: 0.0257s/iter; left time: 837.6170s
Epoch: 21 cost time: 12.081007242202759
Epoch: 21, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.604 Vali Acc: 0.975 Test Loss: 0.604 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0996s/iter; left time: 3240.4654s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 1006.3439s
	iters: 300, epoch: 22 | loss: 0.3174247
	speed: 0.0270s/iter; left time: 873.6920s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 862.6786s
Epoch: 22 cost time: 12.42999529838562
Epoch: 22, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.598 Vali Acc: 0.967 Test Loss: 0.598 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0944s/iter; left time: 3030.6399s
	iters: 200, epoch: 23 | loss: 0.0040816
	speed: 0.0225s/iter; left time: 719.9259s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0234s/iter; left time: 748.4013s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0226s/iter; left time: 719.0226s
Epoch: 23 cost time: 10.374706983566284
Epoch: 23, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.801 Vali Acc: 0.966 Test Loss: 0.801 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.9471459
	speed: 0.0783s/iter; left time: 2483.8420s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 915.4126s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0295s/iter; left time: 928.9401s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 868.5496s
Epoch: 24 cost time: 11.491458654403687
Epoch: 24, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.684 Vali Acc: 0.973 Test Loss: 0.684 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0893s/iter; left time: 2793.0124s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0296s/iter; left time: 924.7469s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 784.7556s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 806.1990s
Epoch: 25 cost time: 11.623003721237183
Epoch: 25, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.439 Vali Acc: 0.978 Test Loss: 0.439 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 350858
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7038884
	speed: 0.0422s/iter; left time: 1739.2906s
	iters: 200, epoch: 1 | loss: 0.2836976
	speed: 0.0239s/iter; left time: 981.2478s
	iters: 300, epoch: 1 | loss: 0.0062621
	speed: 0.0225s/iter; left time: 924.1017s
	iters: 400, epoch: 1 | loss: 0.0449300
	speed: 0.0235s/iter; left time: 962.7681s
Epoch: 1 cost time: 11.635920524597168
Epoch: 1, Steps: 413 | Train Loss: 0.352 Vali Loss: 0.122 Vali Acc: 0.960 Test Loss: 0.122 Test Acc: 0.960
Validation loss decreased (inf --> -0.959981).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0322490
	speed: 0.0935s/iter; left time: 3815.5101s
	iters: 200, epoch: 2 | loss: 0.0361240
	speed: 0.0231s/iter; left time: 940.5341s
	iters: 300, epoch: 2 | loss: 0.5066589
	speed: 0.0248s/iter; left time: 1005.6173s
	iters: 400, epoch: 2 | loss: 0.0009367
	speed: 0.0265s/iter; left time: 1071.9488s
Epoch: 2 cost time: 10.809565782546997
Epoch: 2, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.959981 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0136593
	speed: 0.0874s/iter; left time: 3530.7582s
	iters: 200, epoch: 3 | loss: 0.0118108
	speed: 0.0245s/iter; left time: 988.3327s
	iters: 300, epoch: 3 | loss: 0.2422940
	speed: 0.0255s/iter; left time: 1022.7342s
	iters: 400, epoch: 3 | loss: 0.1116194
	speed: 0.0269s/iter; left time: 1076.8302s
Epoch: 3 cost time: 10.846571445465088
Epoch: 3, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.970440 --> -0.974987).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000095
	speed: 0.0936s/iter; left time: 3740.9694s
	iters: 200, epoch: 4 | loss: 0.0002329
	speed: 0.0242s/iter; left time: 965.5598s
	iters: 300, epoch: 4 | loss: 0.0000002
	speed: 0.0281s/iter; left time: 1115.4637s
	iters: 400, epoch: 4 | loss: 0.2068196
	speed: 0.0275s/iter; left time: 1091.0549s
Epoch: 4 cost time: 11.003725290298462
Epoch: 4, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.1009s/iter; left time: 3992.2920s
	iters: 200, epoch: 5 | loss: 0.0304126
	speed: 0.0263s/iter; left time: 1038.1583s
	iters: 300, epoch: 5 | loss: 0.0003354
	speed: 0.0269s/iter; left time: 1060.1057s
	iters: 400, epoch: 5 | loss: 0.0004001
	speed: 0.0174s/iter; left time: 681.5711s
Epoch: 5 cost time: 10.529683589935303
Epoch: 5, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.974987 --> -0.975442).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.1005s/iter; left time: 3933.0876s
	iters: 200, epoch: 6 | loss: 0.0000021
	speed: 0.0311s/iter; left time: 1215.7048s
	iters: 300, epoch: 6 | loss: 0.0009045
	speed: 0.0292s/iter; left time: 1136.6783s
	iters: 400, epoch: 6 | loss: 0.0000009
	speed: 0.0287s/iter; left time: 1113.9290s
Epoch: 6 cost time: 12.705329656600952
Epoch: 6, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.233 Vali Acc: 0.969 Test Loss: 0.233 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000527
	speed: 0.1033s/iter; left time: 3999.5414s
	iters: 200, epoch: 7 | loss: 0.0017973
	speed: 0.0302s/iter; left time: 1166.2930s
	iters: 300, epoch: 7 | loss: 0.2718160
	speed: 0.0292s/iter; left time: 1124.0518s
	iters: 400, epoch: 7 | loss: 0.0001042
	speed: 0.0289s/iter; left time: 1109.3225s
Epoch: 7 cost time: 12.917494535446167
Epoch: 7, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.293 Vali Acc: 0.972 Test Loss: 0.293 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000004
	speed: 0.1028s/iter; left time: 3938.6113s
	iters: 200, epoch: 8 | loss: 0.0000099
	speed: 0.0283s/iter; left time: 1080.6495s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0288s/iter; left time: 1097.6952s
	iters: 400, epoch: 8 | loss: 0.0000030
	speed: 0.0294s/iter; left time: 1116.6675s
Epoch: 8 cost time: 12.467371463775635
Epoch: 8, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.235 Vali Acc: 0.974 Test Loss: 0.235 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.0998s/iter; left time: 3781.7109s
	iters: 200, epoch: 9 | loss: 0.0113851
	speed: 0.0291s/iter; left time: 1101.4858s
	iters: 300, epoch: 9 | loss: 0.0000003
	speed: 0.0296s/iter; left time: 1117.2373s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0314s/iter; left time: 1181.2105s
Epoch: 9 cost time: 12.747920751571655
Epoch: 9, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.308 Vali Acc: 0.970 Test Loss: 0.308 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.1003s/iter; left time: 3759.8045s
	iters: 200, epoch: 10 | loss: 0.2628059
	speed: 0.0307s/iter; left time: 1147.0632s
	iters: 300, epoch: 10 | loss: 0.0033513
	speed: 0.0319s/iter; left time: 1188.5692s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 1088.2743s
Epoch: 10 cost time: 13.007827043533325
Epoch: 10, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.627 Vali Acc: 0.951 Test Loss: 0.627 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0061570
	speed: 0.1013s/iter; left time: 3753.9727s
	iters: 200, epoch: 11 | loss: 0.0000055
	speed: 0.0317s/iter; left time: 1170.7993s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 1064.6091s
	iters: 400, epoch: 11 | loss: 0.0000357
	speed: 0.0285s/iter; left time: 1048.8941s
Epoch: 11 cost time: 12.842812776565552
Epoch: 11, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.239 Vali Acc: 0.982 Test Loss: 0.239 Test Acc: 0.982
Validation loss decreased (-0.975442 --> -0.981808).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0046049
	speed: 0.1057s/iter; left time: 3875.6123s
	iters: 200, epoch: 12 | loss: 0.0000125
	speed: 0.0280s/iter; left time: 1021.9111s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 1031.8346s
	iters: 400, epoch: 12 | loss: 0.0000072
	speed: 0.0293s/iter; left time: 1065.4499s
Epoch: 12 cost time: 12.54323148727417
Epoch: 12, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.380 Vali Acc: 0.967 Test Loss: 0.380 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.0988s/iter; left time: 3582.7876s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0292s/iter; left time: 1055.5616s
	iters: 300, epoch: 13 | loss: 0.0025530
	speed: 0.0291s/iter; left time: 1049.6131s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0302s/iter; left time: 1086.7517s
Epoch: 13 cost time: 12.657427549362183
Epoch: 13, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.338 Vali Acc: 0.971 Test Loss: 0.338 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000088
	speed: 0.0977s/iter; left time: 3500.7728s
	iters: 200, epoch: 14 | loss: 0.0000005
	speed: 0.0295s/iter; left time: 1052.9118s
	iters: 300, epoch: 14 | loss: 0.0131123
	speed: 0.0303s/iter; left time: 1080.2625s
	iters: 400, epoch: 14 | loss: 0.0000008
	speed: 0.0322s/iter; left time: 1144.9534s
Epoch: 14 cost time: 12.990403175354004
Epoch: 14, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.451 Vali Acc: 0.971 Test Loss: 0.451 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000053
	speed: 0.0997s/iter; left time: 3532.8226s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 1114.3738s
	iters: 300, epoch: 15 | loss: 0.0000101
	speed: 0.0315s/iter; left time: 1111.0834s
	iters: 400, epoch: 15 | loss: 0.0181480
	speed: 0.0296s/iter; left time: 1038.6145s
Epoch: 15 cost time: 13.03974175453186
Epoch: 15, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.416 Vali Acc: 0.975 Test Loss: 0.416 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1050s/iter; left time: 3676.7307s
	iters: 200, epoch: 16 | loss: 0.0019329
	speed: 0.0317s/iter; left time: 1107.5330s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0292s/iter; left time: 1014.6852s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0327s/iter; left time: 1134.3866s
Epoch: 16 cost time: 13.478328227996826
Epoch: 16, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.522 Vali Acc: 0.972 Test Loss: 0.522 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0123365
	speed: 0.1402s/iter; left time: 4849.0232s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1464.4720s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1478.2477s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 1448.6592s
Epoch: 17 cost time: 18.459621906280518
Epoch: 17, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.312 Vali Acc: 0.977 Test Loss: 0.312 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000014
	speed: 0.1424s/iter; left time: 4866.2326s
	iters: 200, epoch: 18 | loss: 0.0039130
	speed: 0.0443s/iter; left time: 1510.4826s
	iters: 300, epoch: 18 | loss: 0.0000678
	speed: 0.0434s/iter; left time: 1474.2125s
	iters: 400, epoch: 18 | loss: 0.0000177
	speed: 0.0480s/iter; left time: 1625.1560s
Epoch: 18 cost time: 19.06825852394104
Epoch: 18, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.284 Vali Acc: 0.981 Test Loss: 0.284 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1349s/iter; left time: 4556.4436s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 1283.1289s
	iters: 300, epoch: 19 | loss: 0.0022469
	speed: 0.0326s/iter; left time: 1094.7881s
	iters: 400, epoch: 19 | loss: 0.0000025
	speed: 0.0348s/iter; left time: 1166.1681s
Epoch: 19 cost time: 15.630428552627563
Epoch: 19, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.262 Vali Acc: 0.977 Test Loss: 0.262 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1207s/iter; left time: 4026.5450s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0320s/iter; left time: 1063.8186s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 1195.4315s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0343s/iter; left time: 1133.3836s
Epoch: 20 cost time: 14.217421770095825
Epoch: 20, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.301 Vali Acc: 0.980 Test Loss: 0.301 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1129s/iter; left time: 3719.4738s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0306s/iter; left time: 1004.9331s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0303s/iter; left time: 992.0474s
	iters: 400, epoch: 21 | loss: 0.0001648
	speed: 0.0278s/iter; left time: 908.6544s
Epoch: 21 cost time: 12.629638671875
Epoch: 21, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.466 Vali Acc: 0.972 Test Loss: 0.466 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 284938
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2600936
	speed: 0.0524s/iter; left time: 2157.0414s
	iters: 200, epoch: 1 | loss: 0.2076932
	speed: 0.0305s/iter; left time: 1252.4860s
	iters: 300, epoch: 1 | loss: 0.0663387
	speed: 0.0369s/iter; left time: 1514.2935s
	iters: 400, epoch: 1 | loss: 0.0145135
	speed: 0.0338s/iter; left time: 1382.6749s
Epoch: 1 cost time: 15.811299085617065
Epoch: 1, Steps: 413 | Train Loss: 0.345 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
Validation loss decreased (inf --> -0.948611).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5212163
	speed: 0.1340s/iter; left time: 5464.6363s
	iters: 200, epoch: 2 | loss: 0.0001802
	speed: 0.0342s/iter; left time: 1391.3255s
	iters: 300, epoch: 2 | loss: 0.0402692
	speed: 0.0364s/iter; left time: 1477.4413s
	iters: 400, epoch: 2 | loss: 0.0009043
	speed: 0.0293s/iter; left time: 1186.6628s
Epoch: 2 cost time: 14.970925331115723
Epoch: 2, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
Validation loss decreased (-0.948611 --> -0.974533).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1276214
	speed: 0.1286s/iter; left time: 5193.1830s
	iters: 200, epoch: 3 | loss: 0.0778779
	speed: 0.0329s/iter; left time: 1323.9144s
	iters: 300, epoch: 3 | loss: 0.1340344
	speed: 0.0345s/iter; left time: 1386.2064s
	iters: 400, epoch: 3 | loss: 0.4792967
	speed: 0.0308s/iter; left time: 1233.4823s
Epoch: 3 cost time: 13.827319860458374
Epoch: 3, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0095563
	speed: 0.1194s/iter; left time: 4771.1073s
	iters: 200, epoch: 4 | loss: 0.0000025
	speed: 0.0260s/iter; left time: 1037.7379s
	iters: 300, epoch: 4 | loss: 0.0000419
	speed: 0.0276s/iter; left time: 1097.1710s
	iters: 400, epoch: 4 | loss: 0.0016960
	speed: 0.0282s/iter; left time: 1120.2170s
Epoch: 4 cost time: 12.014922142028809
Epoch: 4, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.236 Vali Acc: 0.961 Test Loss: 0.236 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0027513
	speed: 0.1260s/iter; left time: 4981.7483s
	iters: 200, epoch: 5 | loss: 0.0000403
	speed: 0.0308s/iter; left time: 1213.1486s
	iters: 300, epoch: 5 | loss: 0.0000054
	speed: 0.0313s/iter; left time: 1233.2462s
	iters: 400, epoch: 5 | loss: 0.0000021
	speed: 0.0309s/iter; left time: 1214.5320s
Epoch: 5 cost time: 13.24591588973999
Epoch: 5, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1267165
	speed: 0.1237s/iter; left time: 4840.1711s
	iters: 200, epoch: 6 | loss: 0.0000065
	speed: 0.0300s/iter; left time: 1172.7660s
	iters: 300, epoch: 6 | loss: 0.0202684
	speed: 0.0311s/iter; left time: 1209.9598s
	iters: 400, epoch: 6 | loss: 0.0000234
	speed: 0.0297s/iter; left time: 1153.9067s
Epoch: 6 cost time: 12.74536681175232
Epoch: 6, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.232 Vali Acc: 0.975 Test Loss: 0.232 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1266s/iter; left time: 4900.4312s
	iters: 200, epoch: 7 | loss: 0.0000002
	speed: 0.0312s/iter; left time: 1205.8782s
	iters: 300, epoch: 7 | loss: 0.3414575
	speed: 0.0282s/iter; left time: 1085.3690s
	iters: 400, epoch: 7 | loss: 0.0000540
	speed: 0.0339s/iter; left time: 1303.4414s
Epoch: 7 cost time: 13.446242332458496
Epoch: 7, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.188 Vali Acc: 0.970 Test Loss: 0.188 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.0462921
	speed: 0.1332s/iter; left time: 5103.1031s
	iters: 200, epoch: 8 | loss: 0.0004979
	speed: 0.0411s/iter; left time: 1569.4443s
	iters: 300, epoch: 8 | loss: 0.1887354
	speed: 0.0407s/iter; left time: 1551.7655s
	iters: 400, epoch: 8 | loss: 0.1945215
	speed: 0.0416s/iter; left time: 1581.9243s
Epoch: 8 cost time: 17.78169345855713
Epoch: 8, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.258 Vali Acc: 0.967 Test Loss: 0.258 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1362s/iter; left time: 5160.9616s
	iters: 200, epoch: 9 | loss: 0.0155185
	speed: 0.0407s/iter; left time: 1537.0802s
	iters: 300, epoch: 9 | loss: 0.0089844
	speed: 0.0426s/iter; left time: 1604.6169s
	iters: 400, epoch: 9 | loss: 0.0584451
	speed: 0.0438s/iter; left time: 1646.7910s
Epoch: 9 cost time: 17.932771921157837
Epoch: 9, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.374 Vali Acc: 0.969 Test Loss: 0.374 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1211s/iter; left time: 4540.9074s
	iters: 200, epoch: 10 | loss: 0.0000003
	speed: 0.0319s/iter; left time: 1192.8031s
	iters: 300, epoch: 10 | loss: 0.1977915
	speed: 0.0374s/iter; left time: 1394.4933s
	iters: 400, epoch: 10 | loss: 0.0000891
	speed: 0.0377s/iter; left time: 1403.6335s
Epoch: 10 cost time: 14.998853921890259
Epoch: 10, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.514 Vali Acc: 0.958 Test Loss: 0.514 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1272s/iter; left time: 4716.1806s
	iters: 200, epoch: 11 | loss: 0.0000049
	speed: 0.0380s/iter; left time: 1405.8307s
	iters: 300, epoch: 11 | loss: 1.1558387
	speed: 0.0378s/iter; left time: 1392.8417s
	iters: 400, epoch: 11 | loss: 0.0437374
	speed: 0.0346s/iter; left time: 1271.6608s
Epoch: 11 cost time: 15.55963945388794
Epoch: 11, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.381 Vali Acc: 0.963 Test Loss: 0.381 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000076
	speed: 0.1333s/iter; left time: 4887.0900s
	iters: 200, epoch: 12 | loss: 0.0000020
	speed: 0.0373s/iter; left time: 1361.8022s
	iters: 300, epoch: 12 | loss: 0.1419408
	speed: 0.0333s/iter; left time: 1215.2656s
	iters: 400, epoch: 12 | loss: 0.7468520
	speed: 0.0334s/iter; left time: 1214.8578s
Epoch: 12 cost time: 15.105968952178955
Epoch: 12, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.301 Vali Acc: 0.967 Test Loss: 0.301 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9745338790359254
model parameter : 252298
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3325005
	speed: 0.0814s/iter; left time: 3355.0947s
	iters: 200, epoch: 1 | loss: 0.2259803
	speed: 0.0585s/iter; left time: 2404.5531s
	iters: 300, epoch: 1 | loss: 0.7797762
	speed: 0.0583s/iter; left time: 2392.1117s
	iters: 400, epoch: 1 | loss: 0.5518525
	speed: 0.0625s/iter; left time: 2555.0884s
Epoch: 1 cost time: 26.997080087661743
Epoch: 1, Steps: 413 | Train Loss: 0.585 Vali Loss: 0.366 Vali Acc: 0.950 Test Loss: 0.366 Test Acc: 0.950
Validation loss decreased (inf --> -0.949519).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0134122
	speed: 0.1610s/iter; left time: 6566.6644s
	iters: 200, epoch: 2 | loss: 0.4191690
	speed: 0.0608s/iter; left time: 2473.3319s
	iters: 300, epoch: 2 | loss: 0.0013212
	speed: 0.0638s/iter; left time: 2588.9977s
	iters: 400, epoch: 2 | loss: 0.8688775
	speed: 0.0596s/iter; left time: 2414.2615s
Epoch: 2 cost time: 25.048264741897583
Epoch: 2, Steps: 413 | Train Loss: 0.287 Vali Loss: 0.369 Vali Acc: 0.961 Test Loss: 0.369 Test Acc: 0.961
Validation loss decreased (-0.949519 --> -0.961342).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000355
	speed: 0.1665s/iter; left time: 6723.7946s
	iters: 200, epoch: 3 | loss: 0.0008302
	speed: 0.0517s/iter; left time: 2081.2223s
	iters: 300, epoch: 3 | loss: 0.3981056
	speed: 0.0484s/iter; left time: 1945.0181s
	iters: 400, epoch: 3 | loss: 1.0185761
	speed: 0.0500s/iter; left time: 2003.6528s
Epoch: 3 cost time: 21.90552806854248
Epoch: 3, Steps: 413 | Train Loss: 0.281 Vali Loss: 0.428 Vali Acc: 0.955 Test Loss: 0.428 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000114
	speed: 0.1573s/iter; left time: 6287.7482s
	iters: 200, epoch: 4 | loss: 0.0000947
	speed: 0.0517s/iter; left time: 2060.4458s
	iters: 300, epoch: 4 | loss: 0.8773013
	speed: 0.0517s/iter; left time: 2055.2648s
	iters: 400, epoch: 4 | loss: 0.0597666
	speed: 0.0513s/iter; left time: 2032.7456s
Epoch: 4 cost time: 21.51578116416931
Epoch: 4, Steps: 413 | Train Loss: 0.270 Vali Loss: 0.911 Vali Acc: 0.957 Test Loss: 0.911 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000010
	speed: 0.1631s/iter; left time: 6448.5688s
	iters: 200, epoch: 5 | loss: 1.0179524
	speed: 0.0537s/iter; left time: 2117.3973s
	iters: 300, epoch: 5 | loss: 0.0000524
	speed: 0.0498s/iter; left time: 1960.8948s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0499s/iter; left time: 1957.4612s
Epoch: 5 cost time: 21.928479194641113
Epoch: 5, Steps: 413 | Train Loss: 0.265 Vali Loss: 0.661 Vali Acc: 0.955 Test Loss: 0.661 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2641643
	speed: 0.1490s/iter; left time: 5829.8935s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 1919.2531s
	iters: 300, epoch: 6 | loss: 0.2089195
	speed: 0.0594s/iter; left time: 2313.9890s
	iters: 400, epoch: 6 | loss: 0.9205220
	speed: 0.0627s/iter; left time: 2435.5928s
Epoch: 6 cost time: 23.13648772239685
Epoch: 6, Steps: 413 | Train Loss: 0.264 Vali Loss: 1.271 Vali Acc: 0.950 Test Loss: 1.271 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1755s/iter; left time: 6795.9999s
	iters: 200, epoch: 7 | loss: 0.0210329
	speed: 0.0609s/iter; left time: 2353.3512s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0575s/iter; left time: 2214.2093s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 1894.5756s
Epoch: 7 cost time: 24.119731426239014
Epoch: 7, Steps: 413 | Train Loss: 0.260 Vali Loss: 0.800 Vali Acc: 0.969 Test Loss: 0.800 Test Acc: 0.969
Validation loss decreased (-0.961342 --> -0.968614).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1685s/iter; left time: 6454.5639s
	iters: 200, epoch: 8 | loss: 0.0177799
	speed: 0.0518s/iter; left time: 1980.1779s
	iters: 300, epoch: 8 | loss: 0.0000007
	speed: 0.0414s/iter; left time: 1575.8684s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 1811.0054s
Epoch: 8 cost time: 20.46925926208496
Epoch: 8, Steps: 413 | Train Loss: 0.245 Vali Loss: 1.237 Vali Acc: 0.947 Test Loss: 1.237 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.4511833
	speed: 0.1501s/iter; left time: 5688.6261s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1787.3856s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 1623.0397s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1469.2017s
Epoch: 9 cost time: 18.33398747444153
Epoch: 9, Steps: 413 | Train Loss: 0.205 Vali Loss: 1.282 Vali Acc: 0.963 Test Loss: 1.282 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1478s/iter; left time: 5540.9473s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1489.5157s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1456.4230s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 1493.9124s
Epoch: 10 cost time: 17.381619215011597
Epoch: 10, Steps: 413 | Train Loss: 0.288 Vali Loss: 0.759 Vali Acc: 0.969 Test Loss: 0.759 Test Acc: 0.969
Validation loss decreased (-0.968614 --> -0.968615).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1475s/iter; left time: 5466.9057s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 1496.7651s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 1620.2142s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1736.8081s
Epoch: 11 cost time: 18.33906316757202
Epoch: 11, Steps: 413 | Train Loss: 0.159 Vali Loss: 1.130 Vali Acc: 0.962 Test Loss: 1.130 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0271263
	speed: 0.1634s/iter; left time: 5989.0778s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0562s/iter; left time: 2056.2822s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1785.9326s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0529s/iter; left time: 1922.8874s
Epoch: 12 cost time: 22.520835876464844
Epoch: 12, Steps: 413 | Train Loss: 0.247 Vali Loss: 1.166 Vali Acc: 0.969 Test Loss: 1.166 Test Acc: 0.969
Validation loss decreased (-0.968615 --> -0.969065).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1696s/iter; left time: 6147.5066s
	iters: 200, epoch: 13 | loss: 0.0000029
	speed: 0.0538s/iter; left time: 1943.0882s
	iters: 300, epoch: 13 | loss: 2.7965491
	speed: 0.0572s/iter; left time: 2060.5943s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 2130.0101s
Epoch: 13 cost time: 23.774547815322876
Epoch: 13, Steps: 413 | Train Loss: 0.246 Vali Loss: 0.858 Vali Acc: 0.975 Test Loss: 0.858 Test Acc: 0.975
Validation loss decreased (-0.969065 --> -0.974525).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1477s/iter; left time: 5290.6190s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0453s/iter; left time: 1620.4381s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 1433.4745s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0393s/iter; left time: 1396.4714s
Epoch: 14 cost time: 17.592169761657715
Epoch: 14, Steps: 413 | Train Loss: 0.154 Vali Loss: 1.058 Vali Acc: 0.971 Test Loss: 1.058 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1462s/iter; left time: 5179.2321s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 1572.8162s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 1533.8046s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 1617.4050s
Epoch: 15 cost time: 19.15401792526245
Epoch: 15, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.961 Vali Acc: 0.970 Test Loss: 0.961 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1490s/iter; left time: 5217.5412s
	iters: 200, epoch: 16 | loss: 0.1942950
	speed: 0.0448s/iter; left time: 1562.4553s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 1695.6663s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 1584.2707s
Epoch: 16 cost time: 19.519202947616577
Epoch: 16, Steps: 413 | Train Loss: 0.171 Vali Loss: 1.575 Vali Acc: 0.970 Test Loss: 1.575 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1646s/iter; left time: 5694.1929s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 1634.2684s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 2034.0277s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0594s/iter; left time: 2037.0601s
Epoch: 17 cost time: 23.74474000930786
Epoch: 17, Steps: 413 | Train Loss: 0.153 Vali Loss: 1.335 Vali Acc: 0.967 Test Loss: 1.335 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1719s/iter; left time: 5876.0335s
	iters: 200, epoch: 18 | loss: 0.0000012
	speed: 0.0593s/iter; left time: 2021.3207s
	iters: 300, epoch: 18 | loss: 0.0382900
	speed: 0.0587s/iter; left time: 1994.2654s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0543s/iter; left time: 1838.4540s
Epoch: 18 cost time: 24.258936882019043
Epoch: 18, Steps: 413 | Train Loss: 0.103 Vali Loss: 1.385 Vali Acc: 0.970 Test Loss: 1.385 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1659s/iter; left time: 5601.1515s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0466s/iter; left time: 1567.3998s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 1604.2267s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0483s/iter; left time: 1615.2047s
Epoch: 19 cost time: 20.795894861221313
Epoch: 19, Steps: 413 | Train Loss: 0.172 Vali Loss: 2.368 Vali Acc: 0.953 Test Loss: 2.368 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.8531190
	speed: 0.1564s/iter; left time: 5215.4680s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0483s/iter; left time: 1607.4772s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 1708.3622s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 1611.7068s
Epoch: 20 cost time: 20.697314262390137
Epoch: 20, Steps: 413 | Train Loss: 0.118 Vali Loss: 1.357 Vali Acc: 0.970 Test Loss: 1.357 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1634s/iter; left time: 5383.4289s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 1598.1736s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 1593.3123s
	iters: 400, epoch: 21 | loss: 1.5724459
	speed: 0.0477s/iter; left time: 1556.8084s
Epoch: 21 cost time: 20.682238340377808
Epoch: 21, Steps: 413 | Train Loss: 0.173 Vali Loss: 1.804 Vali Acc: 0.961 Test Loss: 1.804 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1617s/iter; left time: 5260.2723s
	iters: 200, epoch: 22 | loss: 0.5583435
	speed: 0.0483s/iter; left time: 1566.3403s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0537s/iter; left time: 1735.3009s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 1827.3774s
Epoch: 22 cost time: 22.049286603927612
Epoch: 22, Steps: 413 | Train Loss: 0.120 Vali Loss: 2.187 Vali Acc: 0.959 Test Loss: 2.187 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1724s/iter; left time: 5535.5208s
	iters: 200, epoch: 23 | loss: 0.0027529
	speed: 0.0584s/iter; left time: 1869.0747s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0573s/iter; left time: 1827.3792s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 1847.8118s
Epoch: 23 cost time: 24.7127628326416
Epoch: 23, Steps: 413 | Train Loss: 0.199 Vali Loss: 1.394 Vali Acc: 0.970 Test Loss: 1.394 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9745338790359254
model parameter : 882314
model size : 5.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8485439
	speed: 0.0663s/iter; left time: 2733.4229s
	iters: 200, epoch: 1 | loss: 0.2310841
	speed: 0.0432s/iter; left time: 1773.8086s
	iters: 300, epoch: 1 | loss: 0.3376269
	speed: 0.0458s/iter; left time: 1877.4249s
	iters: 400, epoch: 1 | loss: 0.0026902
	speed: 0.0492s/iter; left time: 2013.5093s
Epoch: 1 cost time: 21.054717779159546
Epoch: 1, Steps: 413 | Train Loss: 0.487 Vali Loss: 0.422 Vali Acc: 0.935 Test Loss: 0.422 Test Acc: 0.935
Validation loss decreased (inf --> -0.935421).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000035
	speed: 0.1544s/iter; left time: 6297.9582s
	iters: 200, epoch: 2 | loss: 0.1503058
	speed: 0.0469s/iter; left time: 1906.6314s
	iters: 300, epoch: 2 | loss: 0.2198572
	speed: 0.0450s/iter; left time: 1827.4557s
	iters: 400, epoch: 2 | loss: 0.2109643
	speed: 0.0448s/iter; left time: 1814.1093s
Epoch: 2 cost time: 19.618034601211548
Epoch: 2, Steps: 413 | Train Loss: 0.265 Vali Loss: 0.426 Vali Acc: 0.951 Test Loss: 0.426 Test Acc: 0.951
Validation loss decreased (-0.935421 --> -0.951337).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000301
	speed: 0.1431s/iter; left time: 5778.2717s
	iters: 200, epoch: 3 | loss: 0.0110737
	speed: 0.0436s/iter; left time: 1754.5527s
	iters: 300, epoch: 3 | loss: 0.0164211
	speed: 0.0441s/iter; left time: 1770.9404s
	iters: 400, epoch: 3 | loss: 0.3841942
	speed: 0.0490s/iter; left time: 1962.9871s
Epoch: 3 cost time: 18.963063716888428
Epoch: 3, Steps: 413 | Train Loss: 0.240 Vali Loss: 0.889 Vali Acc: 0.929 Test Loss: 0.889 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3277564
	speed: 0.1509s/iter; left time: 6031.7372s
	iters: 200, epoch: 4 | loss: 0.0000316
	speed: 0.0575s/iter; left time: 2292.4065s
	iters: 300, epoch: 4 | loss: 0.4276648
	speed: 0.0584s/iter; left time: 2322.0825s
	iters: 400, epoch: 4 | loss: 0.0023887
	speed: 0.0556s/iter; left time: 2203.6985s
Epoch: 4 cost time: 23.081135749816895
Epoch: 4, Steps: 413 | Train Loss: 0.202 Vali Loss: 0.395 Vali Acc: 0.965 Test Loss: 0.395 Test Acc: 0.965
Validation loss decreased (-0.951337 --> -0.965435).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0004418
	speed: 0.1579s/iter; left time: 6245.9080s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 1876.4732s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 1835.7466s
	iters: 400, epoch: 5 | loss: 0.7269743
	speed: 0.0502s/iter; left time: 1968.9811s
Epoch: 5 cost time: 20.62141180038452
Epoch: 5, Steps: 413 | Train Loss: 0.212 Vali Loss: 0.766 Vali Acc: 0.958 Test Loss: 0.766 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000017
	speed: 0.1497s/iter; left time: 5857.8951s
	iters: 200, epoch: 6 | loss: 0.0000011
	speed: 0.0383s/iter; left time: 1493.3681s
	iters: 300, epoch: 6 | loss: 0.4887785
	speed: 0.0364s/iter; left time: 1416.9803s
	iters: 400, epoch: 6 | loss: 0.0000001
	speed: 0.0345s/iter; left time: 1341.3681s
Epoch: 6 cost time: 15.759002685546875
Epoch: 6, Steps: 413 | Train Loss: 0.237 Vali Loss: 0.625 Vali Acc: 0.966 Test Loss: 0.625 Test Acc: 0.966
Validation loss decreased (-0.965435 --> -0.965887).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1366s/iter; left time: 5288.9856s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0354s/iter; left time: 1368.0036s
	iters: 300, epoch: 7 | loss: 0.5660529
	speed: 0.0365s/iter; left time: 1405.2844s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 1336.8768s
Epoch: 7 cost time: 15.4848952293396
Epoch: 7, Steps: 413 | Train Loss: 0.197 Vali Loss: 0.997 Vali Acc: 0.955 Test Loss: 0.997 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5885553
	speed: 0.1273s/iter; left time: 4875.4331s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 1368.8243s
	iters: 300, epoch: 8 | loss: 0.0000222
	speed: 0.0367s/iter; left time: 1396.9371s
	iters: 400, epoch: 8 | loss: 0.1648604
	speed: 0.0401s/iter; left time: 1522.4812s
Epoch: 8 cost time: 15.755234956741333
Epoch: 8, Steps: 413 | Train Loss: 0.207 Vali Loss: 0.723 Vali Acc: 0.954 Test Loss: 0.723 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1311s/iter; left time: 4966.4259s
	iters: 200, epoch: 9 | loss: 0.3765993
	speed: 0.0397s/iter; left time: 1499.7784s
	iters: 300, epoch: 9 | loss: 0.0000447
	speed: 0.0403s/iter; left time: 1519.0971s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0376s/iter; left time: 1413.3284s
Epoch: 9 cost time: 16.337278604507446
Epoch: 9, Steps: 413 | Train Loss: 0.226 Vali Loss: 0.996 Vali Acc: 0.964 Test Loss: 0.996 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000022
	speed: 0.1438s/iter; left time: 5389.1196s
	iters: 200, epoch: 10 | loss: 0.0000206
	speed: 0.0475s/iter; left time: 1774.0358s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 1673.1159s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 1587.9015s
Epoch: 10 cost time: 19.62774634361267
Epoch: 10, Steps: 413 | Train Loss: 0.145 Vali Loss: 1.253 Vali Acc: 0.951 Test Loss: 1.253 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0179531
	speed: 0.1571s/iter; left time: 5824.7219s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0442s/iter; left time: 1632.5171s
	iters: 300, epoch: 11 | loss: 0.0000003
	speed: 0.0469s/iter; left time: 1728.5686s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 1786.3749s
Epoch: 11 cost time: 19.41530752182007
Epoch: 11, Steps: 413 | Train Loss: 0.149 Vali Loss: 0.981 Vali Acc: 0.960 Test Loss: 0.981 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1364s/iter; left time: 5000.9224s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 1391.0309s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 1277.0905s
	iters: 400, epoch: 12 | loss: 2.7031255
	speed: 0.0343s/iter; left time: 1248.5499s
Epoch: 12 cost time: 15.018614292144775
Epoch: 12, Steps: 413 | Train Loss: 0.180 Vali Loss: 0.945 Vali Acc: 0.960 Test Loss: 0.945 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1370s/iter; left time: 4966.3012s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 1266.0497s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 1261.5118s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 1235.5083s
Epoch: 13 cost time: 15.049666404724121
Epoch: 13, Steps: 413 | Train Loss: 0.140 Vali Loss: 1.014 Vali Acc: 0.969 Test Loss: 1.014 Test Acc: 0.969
Validation loss decreased (-0.965887 --> -0.969067).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1313s/iter; left time: 4703.2535s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0364s/iter; left time: 1299.6069s
	iters: 300, epoch: 14 | loss: 1.1429720
	speed: 0.0345s/iter; left time: 1228.1054s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0305s/iter; left time: 1084.3152s
Epoch: 14 cost time: 14.492501258850098
Epoch: 14, Steps: 413 | Train Loss: 0.138 Vali Loss: 1.365 Vali Acc: 0.964 Test Loss: 1.365 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1529s/iter; left time: 5415.0633s
	iters: 200, epoch: 15 | loss: 0.0038219
	speed: 0.0474s/iter; left time: 1673.2320s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 1619.4505s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 1546.5783s
Epoch: 15 cost time: 19.440468311309814
Epoch: 15, Steps: 413 | Train Loss: 0.166 Vali Loss: 1.067 Vali Acc: 0.972 Test Loss: 1.067 Test Acc: 0.972
Validation loss decreased (-0.969067 --> -0.972249).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1690s/iter; left time: 5915.0824s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 1855.6453s
	iters: 300, epoch: 16 | loss: 0.0000255
	speed: 0.0522s/iter; left time: 1815.8588s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0543s/iter; left time: 1886.0576s
Epoch: 16 cost time: 22.644330978393555
Epoch: 16, Steps: 413 | Train Loss: 0.166 Vali Loss: 0.937 Vali Acc: 0.973 Test Loss: 0.937 Test Acc: 0.973
Validation loss decreased (-0.972249 --> -0.972705).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0251836
	speed: 0.1561s/iter; left time: 5400.7423s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0552s/iter; left time: 1904.1186s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 2008.6294s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0553s/iter; left time: 1897.4653s
Epoch: 17 cost time: 23.10020351409912
Epoch: 17, Steps: 413 | Train Loss: 0.179 Vali Loss: 1.020 Vali Acc: 0.967 Test Loss: 1.020 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1497s/iter; left time: 5117.5562s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0456s/iter; left time: 1552.4665s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0466s/iter; left time: 1582.7185s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 1628.0469s
Epoch: 18 cost time: 20.096795797348022
Epoch: 18, Steps: 413 | Train Loss: 0.149 Vali Loss: 1.091 Vali Acc: 0.974 Test Loss: 1.091 Test Acc: 0.974
Validation loss decreased (-0.972705 --> -0.973613).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0026608
	speed: 0.1558s/iter; left time: 5260.3835s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 1662.5435s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 1679.2185s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 1537.5680s
Epoch: 19 cost time: 20.42436456680298
Epoch: 19, Steps: 413 | Train Loss: 0.100 Vali Loss: 1.151 Vali Acc: 0.972 Test Loss: 1.151 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1546s/iter; left time: 5157.5648s
	iters: 200, epoch: 20 | loss: 1.8765211
	speed: 0.0431s/iter; left time: 1433.8880s
	iters: 300, epoch: 20 | loss: 0.2106896
	speed: 0.0427s/iter; left time: 1414.9623s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1422.8893s
Epoch: 20 cost time: 18.64166760444641
Epoch: 20, Steps: 413 | Train Loss: 0.105 Vali Loss: 1.242 Vali Acc: 0.968 Test Loss: 1.242 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0253998
	speed: 0.1539s/iter; left time: 5070.1211s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 1696.3364s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0557s/iter; left time: 1822.8953s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0573s/iter; left time: 1869.3484s
Epoch: 21 cost time: 22.602019786834717
Epoch: 21, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.955 Vali Acc: 0.968 Test Loss: 0.955 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1680s/iter; left time: 5463.1797s
	iters: 200, epoch: 22 | loss: 0.0000003
	speed: 0.0564s/iter; left time: 1827.7883s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 1767.2204s
	iters: 400, epoch: 22 | loss: 0.7692011
	speed: 0.0554s/iter; left time: 1784.8485s
Epoch: 22 cost time: 23.88436007499695
Epoch: 22, Steps: 413 | Train Loss: 0.120 Vali Loss: 1.477 Vali Acc: 0.970 Test Loss: 1.477 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1594s/iter; left time: 5120.3515s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0471s/iter; left time: 1507.2504s
	iters: 300, epoch: 23 | loss: 0.9187894
	speed: 0.0497s/iter; left time: 1586.8653s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1505.2398s
Epoch: 23 cost time: 19.95550847053528
Epoch: 23, Steps: 413 | Train Loss: 0.166 Vali Loss: 1.807 Vali Acc: 0.958 Test Loss: 1.807 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1880s/iter; left time: 5959.1279s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0625s/iter; left time: 1975.5261s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 1791.9684s
	iters: 400, epoch: 24 | loss: 0.1436899
	speed: 0.0576s/iter; left time: 1808.8379s
Epoch: 24 cost time: 24.946250677108765
Epoch: 24, Steps: 413 | Train Loss: 0.135 Vali Loss: 1.325 Vali Acc: 0.970 Test Loss: 1.325 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1863s/iter; left time: 5828.9143s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 1539.7394s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 1325.4249s
	iters: 400, epoch: 25 | loss: 0.0692096
	speed: 0.0490s/iter; left time: 1518.3085s
Epoch: 25 cost time: 20.915330171585083
Epoch: 25, Steps: 413 | Train Loss: 0.082 Vali Loss: 1.216 Vali Acc: 0.968 Test Loss: 1.216 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1668s/iter; left time: 5150.7396s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0505s/iter; left time: 1554.0051s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 1414.2407s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0508s/iter; left time: 1554.7658s
Epoch: 26 cost time: 20.499589920043945
Epoch: 26, Steps: 413 | Train Loss: 0.098 Vali Loss: 1.372 Vali Acc: 0.965 Test Loss: 1.372 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1830s/iter; left time: 5575.2747s
	iters: 200, epoch: 27 | loss: 0.0696186
	speed: 0.0571s/iter; left time: 1733.8218s
	iters: 300, epoch: 27 | loss: 0.1131627
	speed: 0.0578s/iter; left time: 1749.5518s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0623s/iter; left time: 1878.4367s
Epoch: 27 cost time: 24.89287757873535
Epoch: 27, Steps: 413 | Train Loss: 0.084 Vali Loss: 1.103 Vali Acc: 0.974 Test Loss: 1.103 Test Acc: 0.974
Validation loss decreased (-0.973613 --> -0.974068).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1831s/iter; left time: 5502.2697s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 1485.1398s
	iters: 300, epoch: 28 | loss: 2.9061337
	speed: 0.0473s/iter; left time: 1413.2030s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0339s/iter; left time: 1007.2324s
Epoch: 28 cost time: 19.832542419433594
Epoch: 28, Steps: 413 | Train Loss: 0.182 Vali Loss: 1.125 Vali Acc: 0.971 Test Loss: 1.125 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1542s/iter; left time: 4568.7751s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 1349.2657s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 1211.7843s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 1209.5788s
Epoch: 29 cost time: 18.964022397994995
Epoch: 29, Steps: 413 | Train Loss: 0.112 Vali Loss: 1.198 Vali Acc: 0.968 Test Loss: 1.198 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1516s/iter; left time: 4430.9537s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0417s/iter; left time: 1213.5100s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 1412.9622s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 1534.2421s
Epoch: 30 cost time: 18.94597887992859
Epoch: 30, Steps: 413 | Train Loss: 0.126 Vali Loss: 1.548 Vali Acc: 0.965 Test Loss: 1.548 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1674s/iter; left time: 4822.3401s
	iters: 200, epoch: 31 | loss: 0.0000027
	speed: 0.0492s/iter; left time: 1413.0963s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 1206.5485s
	iters: 400, epoch: 31 | loss: 1.3307233
	speed: 0.0419s/iter; left time: 1193.7650s
Epoch: 31 cost time: 19.521303176879883
Epoch: 31, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.935 Vali Acc: 0.976 Test Loss: 0.935 Test Acc: 0.976
Validation loss decreased (-0.974068 --> -0.976344).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1621s/iter; left time: 4602.1865s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0552s/iter; left time: 1561.6810s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0582s/iter; left time: 1640.3353s
	iters: 400, epoch: 32 | loss: 0.0000435
	speed: 0.0633s/iter; left time: 1777.9171s
Epoch: 32 cost time: 23.635619401931763
Epoch: 32, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.929 Vali Acc: 0.975 Test Loss: 0.929 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1857s/iter; left time: 5198.1689s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0633s/iter; left time: 1765.7389s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 1658.6075s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 1516.5484s
Epoch: 33 cost time: 24.795157432556152
Epoch: 33, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.956 Vali Acc: 0.976 Test Loss: 0.956 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1514s/iter; left time: 4173.0227s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 913.6263s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 1217.2668s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1157.8238s
Epoch: 34 cost time: 17.597848176956177
Epoch: 34, Steps: 413 | Train Loss: 0.087 Vali Loss: 1.215 Vali Acc: 0.970 Test Loss: 1.215 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1784s/iter; left time: 4844.7453s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0613s/iter; left time: 1657.9703s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 1686.9025s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 1578.9937s
Epoch: 35 cost time: 25.51050853729248
Epoch: 35, Steps: 413 | Train Loss: 0.074 Vali Loss: 1.135 Vali Acc: 0.972 Test Loss: 1.135 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.6011251
	speed: 0.1864s/iter; left time: 4984.1665s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0614s/iter; left time: 1637.3000s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 1513.3079s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0564s/iter; left time: 1492.2102s
Epoch: 36 cost time: 25.09661054611206
Epoch: 36, Steps: 413 | Train Loss: 0.114 Vali Loss: 1.424 Vali Acc: 0.966 Test Loss: 1.424 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1715s/iter; left time: 4515.0843s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0587s/iter; left time: 1540.0511s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 1555.8799s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 1731.6260s
Epoch: 37 cost time: 25.7623393535614
Epoch: 37, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.744 Vali Acc: 0.975 Test Loss: 0.744 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2035s/iter; left time: 5275.3569s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0669s/iter; left time: 1728.0997s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0643s/iter; left time: 1653.1394s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0652s/iter; left time: 1670.6972s
Epoch: 38 cost time: 28.595333099365234
Epoch: 38, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.862 Vali Acc: 0.974 Test Loss: 0.862 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.1959s/iter; left time: 4996.8938s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0541s/iter; left time: 1373.9251s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 1414.2882s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1084.6289s
Epoch: 39 cost time: 22.947174072265625
Epoch: 39, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.971 Vali Acc: 0.976 Test Loss: 0.971 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.1895s/iter; left time: 4754.2399s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 1470.5920s
	iters: 300, epoch: 40 | loss: 0.0003036
	speed: 0.0570s/iter; left time: 1419.0898s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0531s/iter; left time: 1317.5062s
Epoch: 40 cost time: 24.456390142440796
Epoch: 40, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.706 Vali Acc: 0.980 Test Loss: 0.706 Test Acc: 0.980
Validation loss decreased (-0.976344 --> -0.980439).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.1804s/iter; left time: 4451.8183s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0553s/iter; left time: 1360.3256s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 1388.6298s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0539s/iter; left time: 1313.4842s
Epoch: 41 cost time: 23.275741815567017
Epoch: 41, Steps: 413 | Train Loss: 0.065 Vali Loss: 1.045 Vali Acc: 0.966 Test Loss: 1.045 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.1798s/iter; left time: 4364.3391s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 1409.3885s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0590s/iter; left time: 1419.0130s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0563s/iter; left time: 1348.3319s
Epoch: 42 cost time: 24.69481921195984
Epoch: 42, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.797 Vali Acc: 0.978 Test Loss: 0.797 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.1980s/iter; left time: 4722.3380s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.0697s/iter; left time: 1656.2501s
	iters: 300, epoch: 43 | loss: 0.0000000
	speed: 0.0720s/iter; left time: 1702.2408s
	iters: 400, epoch: 43 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 1673.5355s
Epoch: 43 cost time: 29.42133331298828
Epoch: 43, Steps: 413 | Train Loss: 0.071 Vali Loss: 1.165 Vali Acc: 0.971 Test Loss: 1.165 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.1917s/iter; left time: 4492.8227s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.0564s/iter; left time: 1316.1808s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.0661s/iter; left time: 1536.8243s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.0718s/iter; left time: 1660.6332s
Epoch: 44 cost time: 26.62849235534668
Epoch: 44, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.946 Vali Acc: 0.972 Test Loss: 0.946 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 1.9832563
	speed: 0.1870s/iter; left time: 4305.2947s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 1366.6758s
	iters: 300, epoch: 45 | loss: 0.0000000
	speed: 0.0609s/iter; left time: 1389.8887s
	iters: 400, epoch: 45 | loss: 0.0000000
	speed: 0.0554s/iter; left time: 1258.7644s
Epoch: 45 cost time: 24.962162494659424
Epoch: 45, Steps: 413 | Train Loss: 0.062 Vali Loss: 1.358 Vali Acc: 0.964 Test Loss: 1.358 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.0000000
	speed: 0.1668s/iter; left time: 3773.2829s
	iters: 200, epoch: 46 | loss: 0.0000000
	speed: 0.0465s/iter; left time: 1045.9532s
	iters: 300, epoch: 46 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 1077.3929s
	iters: 400, epoch: 46 | loss: 0.0000019
	speed: 0.0479s/iter; left time: 1068.8474s
Epoch: 46 cost time: 20.695257663726807
Epoch: 46, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.910 Vali Acc: 0.974 Test Loss: 0.910 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.0000000
	speed: 0.1682s/iter; left time: 3735.0170s
	iters: 200, epoch: 47 | loss: 3.9286180
	speed: 0.0457s/iter; left time: 1009.7707s
	iters: 300, epoch: 47 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 1142.7836s
	iters: 400, epoch: 47 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 1127.7480s
Epoch: 47 cost time: 20.882148027420044
Epoch: 47, Steps: 413 | Train Loss: 0.048 Vali Loss: 1.179 Vali Acc: 0.973 Test Loss: 1.179 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.0000000
	speed: 0.1574s/iter; left time: 3430.7834s
	iters: 200, epoch: 48 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 1116.2535s
	iters: 300, epoch: 48 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 1300.5093s
	iters: 400, epoch: 48 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 1230.0149s
Epoch: 48 cost time: 22.43609046936035
Epoch: 48, Steps: 413 | Train Loss: 0.049 Vali Loss: 1.366 Vali Acc: 0.970 Test Loss: 1.366 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.0000001
	speed: 0.1799s/iter; left time: 3844.7237s
	iters: 200, epoch: 49 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 1164.1849s
	iters: 300, epoch: 49 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 1177.8234s
	iters: 400, epoch: 49 | loss: 0.8733802
	speed: 0.0589s/iter; left time: 1241.2027s
Epoch: 49 cost time: 24.131809949874878
Epoch: 49, Steps: 413 | Train Loss: 0.075 Vali Loss: 1.530 Vali Acc: 0.966 Test Loss: 1.530 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 0.0000000
	speed: 0.1720s/iter; left time: 3605.1611s
	iters: 200, epoch: 50 | loss: 0.0000002
	speed: 0.0418s/iter; left time: 871.7193s
	iters: 300, epoch: 50 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 697.5075s
	iters: 400, epoch: 50 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 559.0697s
Epoch: 50 cost time: 16.559876918792725
Epoch: 50, Steps: 413 | Train Loss: 0.075 Vali Loss: 1.297 Vali Acc: 0.966 Test Loss: 1.297 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 616330
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0942218
	speed: 0.0707s/iter; left time: 2912.6154s
	iters: 200, epoch: 1 | loss: 0.0086969
	speed: 0.0355s/iter; left time: 1458.5404s
	iters: 300, epoch: 1 | loss: 0.2525257
	speed: 0.0395s/iter; left time: 1618.0293s
	iters: 400, epoch: 1 | loss: 0.5066336
	speed: 0.0395s/iter; left time: 1617.3684s
Epoch: 1 cost time: 19.223828077316284
Epoch: 1, Steps: 413 | Train Loss: 0.433 Vali Loss: 0.696 Vali Acc: 0.882 Test Loss: 0.696 Test Acc: 0.882
Validation loss decreased (inf --> -0.881757).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0031168
	speed: 0.1458s/iter; left time: 5946.6284s
	iters: 200, epoch: 2 | loss: 0.0015573
	speed: 0.0413s/iter; left time: 1680.9661s
	iters: 300, epoch: 2 | loss: 1.0808741
	speed: 0.0393s/iter; left time: 1593.5496s
	iters: 400, epoch: 2 | loss: 0.0046784
	speed: 0.0358s/iter; left time: 1450.3655s
Epoch: 2 cost time: 16.829405784606934
Epoch: 2, Steps: 413 | Train Loss: 0.246 Vali Loss: 0.288 Vali Acc: 0.955 Test Loss: 0.288 Test Acc: 0.955
Validation loss decreased (-0.881757 --> -0.955431).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3568109
	speed: 0.1689s/iter; left time: 6818.0339s
	iters: 200, epoch: 3 | loss: 0.0003461
	speed: 0.0585s/iter; left time: 2354.4224s
	iters: 300, epoch: 3 | loss: 0.4479952
	speed: 0.0627s/iter; left time: 2520.3751s
	iters: 400, epoch: 3 | loss: 0.0039353
	speed: 0.0592s/iter; left time: 2371.7616s
Epoch: 3 cost time: 24.226762056350708
Epoch: 3, Steps: 413 | Train Loss: 0.165 Vali Loss: 0.234 Vali Acc: 0.961 Test Loss: 0.234 Test Acc: 0.961
Validation loss decreased (-0.955431 --> -0.961344).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000262
	speed: 0.1838s/iter; left time: 7344.4667s
	iters: 200, epoch: 4 | loss: 0.9509810
	speed: 0.0612s/iter; left time: 2439.1167s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.0578s/iter; left time: 2297.6272s
	iters: 400, epoch: 4 | loss: 0.2025530
	speed: 0.0587s/iter; left time: 2330.1196s
Epoch: 4 cost time: 25.52266263961792
Epoch: 4, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.347 Vali Acc: 0.964 Test Loss: 0.347 Test Acc: 0.964
Validation loss decreased (-0.961344 --> -0.963616).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8035030
	speed: 0.2000s/iter; left time: 7909.7900s
	iters: 200, epoch: 5 | loss: 0.0001112
	speed: 0.0654s/iter; left time: 2581.3940s
	iters: 300, epoch: 5 | loss: 2.7745364
	speed: 0.0580s/iter; left time: 2283.1010s
	iters: 400, epoch: 5 | loss: 0.0000001
	speed: 0.0594s/iter; left time: 2333.0584s
Epoch: 5 cost time: 26.79893922805786
Epoch: 5, Steps: 413 | Train Loss: 0.211 Vali Loss: 0.488 Vali Acc: 0.960 Test Loss: 0.488 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1676979
	speed: 0.1888s/iter; left time: 7387.9420s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 2222.5799s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 2177.7518s
	iters: 400, epoch: 6 | loss: 0.0127684
	speed: 0.0517s/iter; left time: 2007.1571s
Epoch: 6 cost time: 24.4889132976532
Epoch: 6, Steps: 413 | Train Loss: 0.184 Vali Loss: 0.361 Vali Acc: 0.964 Test Loss: 0.361 Test Acc: 0.964
Validation loss decreased (-0.963616 --> -0.964071).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1681s/iter; left time: 6511.1484s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 1975.9338s
	iters: 300, epoch: 7 | loss: 2.5768578
	speed: 0.0582s/iter; left time: 2240.5675s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 2327.9969s
Epoch: 7 cost time: 23.36876916885376
Epoch: 7, Steps: 413 | Train Loss: 0.168 Vali Loss: 0.522 Vali Acc: 0.965 Test Loss: 0.522 Test Acc: 0.965
Validation loss decreased (-0.964071 --> -0.965434).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0078154
	speed: 0.1894s/iter; left time: 7257.4111s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0586s/iter; left time: 2237.9759s
	iters: 300, epoch: 8 | loss: 0.0003372
	speed: 0.0621s/iter; left time: 2367.6640s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0618s/iter; left time: 2350.1646s
Epoch: 8 cost time: 26.254295825958252
Epoch: 8, Steps: 413 | Train Loss: 0.153 Vali Loss: 0.284 Vali Acc: 0.977 Test Loss: 0.284 Test Acc: 0.977
Validation loss decreased (-0.965434 --> -0.976805).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5494802
	speed: 0.2036s/iter; left time: 7716.1711s
	iters: 200, epoch: 9 | loss: 1.9742324
	speed: 0.0675s/iter; left time: 2550.8021s
	iters: 300, epoch: 9 | loss: 0.0000003
	speed: 0.0642s/iter; left time: 2420.1850s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0718s/iter; left time: 2698.5336s
Epoch: 9 cost time: 30.085379362106323
Epoch: 9, Steps: 413 | Train Loss: 0.199 Vali Loss: 0.435 Vali Acc: 0.970 Test Loss: 0.435 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2002s/iter; left time: 7504.0647s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0752s/iter; left time: 2811.6258s
	iters: 300, epoch: 10 | loss: 0.0000236
	speed: 0.0715s/iter; left time: 2666.2808s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0704s/iter; left time: 2618.3993s
Epoch: 10 cost time: 31.020352840423584
Epoch: 10, Steps: 413 | Train Loss: 0.192 Vali Loss: 0.563 Vali Acc: 0.970 Test Loss: 0.563 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2022s/iter; left time: 7495.2518s
	iters: 200, epoch: 11 | loss: 0.0000025
	speed: 0.0689s/iter; left time: 2546.2283s
	iters: 300, epoch: 11 | loss: 1.1106942
	speed: 0.0630s/iter; left time: 2321.9750s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 2191.8902s
Epoch: 11 cost time: 27.973262786865234
Epoch: 11, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.714 Vali Acc: 0.972 Test Loss: 0.714 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1679s/iter; left time: 6153.4810s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 1755.1281s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0608s/iter; left time: 2217.2566s
	iters: 400, epoch: 12 | loss: 0.0034045
	speed: 0.0614s/iter; left time: 2232.0025s
Epoch: 12 cost time: 23.521939039230347
Epoch: 12, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.645 Vali Acc: 0.969 Test Loss: 0.645 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1962s/iter; left time: 7109.9175s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0670s/iter; left time: 2420.5176s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0608s/iter; left time: 2191.7316s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 2080.8388s
Epoch: 13 cost time: 27.06984519958496
Epoch: 13, Steps: 413 | Train Loss: 0.187 Vali Loss: 0.676 Vali Acc: 0.965 Test Loss: 0.676 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000031
	speed: 0.1943s/iter; left time: 6962.8150s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0673s/iter; left time: 2404.1347s
	iters: 300, epoch: 14 | loss: 2.4583211
	speed: 0.0635s/iter; left time: 2263.0418s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 2386.6715s
Epoch: 14 cost time: 28.445475101470947
Epoch: 14, Steps: 413 | Train Loss: 0.193 Vali Loss: 0.728 Vali Acc: 0.967 Test Loss: 0.728 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000038
	speed: 0.1996s/iter; left time: 7069.6040s
	iters: 200, epoch: 15 | loss: 0.7693456
	speed: 0.0781s/iter; left time: 2760.1729s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 2346.3359s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 2325.9671s
Epoch: 15 cost time: 30.472174644470215
Epoch: 15, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.791 Vali Acc: 0.973 Test Loss: 0.791 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2034s/iter; left time: 7120.6373s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 2652.5900s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 2337.3057s
	iters: 400, epoch: 16 | loss: 0.0001651
	speed: 0.0567s/iter; left time: 1966.7770s
Epoch: 16 cost time: 28.68531823158264
Epoch: 16, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.754 Vali Acc: 0.967 Test Loss: 0.754 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1685s/iter; left time: 5827.8059s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0562s/iter; left time: 1938.8722s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 1676.7866s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0409s/iter; left time: 1402.1458s
Epoch: 17 cost time: 21.16915225982666
Epoch: 17, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.821 Vali Acc: 0.971 Test Loss: 0.821 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1823s/iter; left time: 6230.3272s
	iters: 200, epoch: 18 | loss: 0.0573857
	speed: 0.0624s/iter; left time: 2127.3759s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 1711.2882s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 1733.5634s
Epoch: 18 cost time: 23.523609161376953
Epoch: 18, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.726 Vali Acc: 0.973 Test Loss: 0.726 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9768076398362893
model parameter : 483466
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3070204
	speed: 0.0693s/iter; left time: 2853.2727s
	iters: 200, epoch: 1 | loss: 0.5047493
	speed: 0.0428s/iter; left time: 1758.8823s
	iters: 300, epoch: 1 | loss: 0.3063041
	speed: 0.0575s/iter; left time: 2357.1910s
	iters: 400, epoch: 1 | loss: 0.0348055
	speed: 0.0685s/iter; left time: 2803.6493s
Epoch: 1 cost time: 24.628826379776
Epoch: 1, Steps: 413 | Train Loss: 0.402 Vali Loss: 0.390 Vali Acc: 0.923 Test Loss: 0.390 Test Acc: 0.923
Validation loss decreased (inf --> -0.922688).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0057208
	speed: 0.1795s/iter; left time: 7320.4839s
	iters: 200, epoch: 2 | loss: 1.1092100
	speed: 0.0528s/iter; left time: 2146.4678s
	iters: 300, epoch: 2 | loss: 0.0510646
	speed: 0.0543s/iter; left time: 2205.1361s
	iters: 400, epoch: 2 | loss: 0.0005713
	speed: 0.0647s/iter; left time: 2618.5837s
Epoch: 2 cost time: 24.212940454483032
Epoch: 2, Steps: 413 | Train Loss: 0.152 Vali Loss: 0.275 Vali Acc: 0.955 Test Loss: 0.275 Test Acc: 0.955
Validation loss decreased (-0.922688 --> -0.955432).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1853557
	speed: 0.1566s/iter; left time: 6322.8534s
	iters: 200, epoch: 3 | loss: 0.0000597
	speed: 0.0457s/iter; left time: 1840.7344s
	iters: 300, epoch: 3 | loss: 0.5706337
	speed: 0.0437s/iter; left time: 1756.7423s
	iters: 400, epoch: 3 | loss: 0.0001078
	speed: 0.0296s/iter; left time: 1187.4592s
Epoch: 3 cost time: 17.460431575775146
Epoch: 3, Steps: 413 | Train Loss: 0.177 Vali Loss: 0.302 Vali Acc: 0.968 Test Loss: 0.302 Test Acc: 0.968
Validation loss decreased (-0.955432 --> -0.968164).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000033
	speed: 0.1490s/iter; left time: 5954.3096s
	iters: 200, epoch: 4 | loss: 0.2430846
	speed: 0.0455s/iter; left time: 1815.3050s
	iters: 300, epoch: 4 | loss: 0.0001917
	speed: 0.0461s/iter; left time: 1831.2303s
	iters: 400, epoch: 4 | loss: 1.0586773
	speed: 0.0469s/iter; left time: 1858.8703s
Epoch: 4 cost time: 19.486802101135254
Epoch: 4, Steps: 413 | Train Loss: 0.170 Vali Loss: 0.213 Vali Acc: 0.972 Test Loss: 0.213 Test Acc: 0.972
Validation loss decreased (-0.968164 --> -0.971803).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0004928
	speed: 0.1563s/iter; left time: 6183.1852s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 1846.3914s
	iters: 300, epoch: 5 | loss: 0.7730926
	speed: 0.0449s/iter; left time: 1765.2557s
	iters: 400, epoch: 5 | loss: 0.4460567
	speed: 0.0451s/iter; left time: 1771.9463s
Epoch: 5 cost time: 19.336926698684692
Epoch: 5, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.381 Vali Acc: 0.966 Test Loss: 0.381 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0072231
	speed: 0.1592s/iter; left time: 6231.4959s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 1634.2315s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 1676.8860s
	iters: 400, epoch: 6 | loss: 0.0000001
	speed: 0.0418s/iter; left time: 1622.2707s
Epoch: 6 cost time: 18.514766216278076
Epoch: 6, Steps: 413 | Train Loss: 0.195 Vali Loss: 0.628 Vali Acc: 0.960 Test Loss: 0.628 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000096
	speed: 0.1589s/iter; left time: 6152.8874s
	iters: 200, epoch: 7 | loss: 0.3980463
	speed: 0.0540s/iter; left time: 2085.3316s
	iters: 300, epoch: 7 | loss: 1.7789550
	speed: 0.0533s/iter; left time: 2052.0532s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.0587s/iter; left time: 2257.2872s
Epoch: 7 cost time: 22.566134691238403
Epoch: 7, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.592 Vali Acc: 0.965 Test Loss: 0.592 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4816453
	speed: 0.1640s/iter; left time: 6282.3569s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1935.6064s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0571s/iter; left time: 2177.8863s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 2182.3053s
Epoch: 8 cost time: 22.677774906158447
Epoch: 8, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.316 Vali Acc: 0.975 Test Loss: 0.316 Test Acc: 0.975
Validation loss decreased (-0.971803 --> -0.975440).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1401s/iter; left time: 5309.1022s
	iters: 200, epoch: 9 | loss: 0.0000029
	speed: 0.0391s/iter; left time: 1478.7059s
	iters: 300, epoch: 9 | loss: 0.0000096
	speed: 0.0498s/iter; left time: 1876.2815s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 2051.2195s
Epoch: 9 cost time: 19.654313802719116
Epoch: 9, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.560 Vali Acc: 0.969 Test Loss: 0.560 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1664s/iter; left time: 6238.9011s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.0464s/iter; left time: 1735.2064s
	iters: 300, epoch: 10 | loss: 0.0456964
	speed: 0.0566s/iter; left time: 2111.6902s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0529s/iter; left time: 1965.6177s
Epoch: 10 cost time: 21.8427312374115
Epoch: 10, Steps: 413 | Train Loss: 0.174 Vali Loss: 0.491 Vali Acc: 0.971 Test Loss: 0.491 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5288483
	speed: 0.1718s/iter; left time: 6369.3488s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0537s/iter; left time: 1987.1369s
	iters: 300, epoch: 11 | loss: 0.0006817
	speed: 0.0551s/iter; left time: 2031.2435s
	iters: 400, epoch: 11 | loss: 1.2987194
	speed: 0.0557s/iter; left time: 2049.0646s
Epoch: 11 cost time: 23.000107765197754
Epoch: 11, Steps: 413 | Train Loss: 0.165 Vali Loss: 0.239 Vali Acc: 0.978 Test Loss: 0.239 Test Acc: 0.978
Validation loss decreased (-0.975440 --> -0.977715).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1656s/iter; left time: 6072.3129s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 1921.6264s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0328s/iter; left time: 1196.6597s
	iters: 400, epoch: 12 | loss: 0.0004815
	speed: 0.0272s/iter; left time: 987.9371s
Epoch: 12 cost time: 16.97202157974243
Epoch: 12, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.437 Vali Acc: 0.977 Test Loss: 0.437 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.1208s/iter; left time: 4377.7435s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 1488.8293s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 1463.4800s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 1766.4862s
Epoch: 13 cost time: 17.34194040298462
Epoch: 13, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.753 Vali Acc: 0.971 Test Loss: 0.753 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1755s/iter; left time: 6288.8809s
	iters: 200, epoch: 14 | loss: 0.0045190
	speed: 0.0510s/iter; left time: 1822.5182s
	iters: 300, epoch: 14 | loss: 1.1907012
	speed: 0.0480s/iter; left time: 1708.6088s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 1643.3275s
Epoch: 14 cost time: 21.53852081298828
Epoch: 14, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.209 Vali Acc: 0.981 Test Loss: 0.209 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.981353).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1712s/iter; left time: 6065.4353s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1791.7993s
	iters: 300, epoch: 15 | loss: 0.1644716
	speed: 0.0488s/iter; left time: 1719.4894s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 1843.1363s
Epoch: 15 cost time: 21.691921710968018
Epoch: 15, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.590 Vali Acc: 0.968 Test Loss: 0.590 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1701s/iter; left time: 5952.7819s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 1952.7436s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 1833.5778s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0501s/iter; left time: 1739.3610s
Epoch: 16 cost time: 22.725643396377563
Epoch: 16, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.313 Vali Acc: 0.982 Test Loss: 0.313 Test Acc: 0.982
Validation loss decreased (-0.981353 --> -0.982262).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.8155952
	speed: 0.1700s/iter; left time: 5881.1435s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1747.6543s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 1679.1156s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0511s/iter; left time: 1754.0146s
Epoch: 17 cost time: 21.411011219024658
Epoch: 17, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.370 Vali Acc: 0.978 Test Loss: 0.370 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1665s/iter; left time: 5691.2786s
	iters: 200, epoch: 18 | loss: 0.9235764
	speed: 0.0599s/iter; left time: 2040.8677s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 2135.0574s
	iters: 400, epoch: 18 | loss: 2.1174564
	speed: 0.0645s/iter; left time: 2183.5958s
Epoch: 18 cost time: 25.63266944885254
Epoch: 18, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.491 Vali Acc: 0.980 Test Loss: 0.491 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1790s/iter; left time: 6044.3856s
	iters: 200, epoch: 19 | loss: 0.0000764
	speed: 0.0567s/iter; left time: 1909.7779s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 1571.1727s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0524s/iter; left time: 1754.9383s
Epoch: 19 cost time: 23.06031036376953
Epoch: 19, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.634 Vali Acc: 0.974 Test Loss: 0.634 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1689s/iter; left time: 5634.4315s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 1890.5705s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 1766.4259s
	iters: 400, epoch: 20 | loss: 0.7764032
	speed: 0.0534s/iter; left time: 1765.7524s
Epoch: 20 cost time: 23.57169198989868
Epoch: 20, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.498 Vali Acc: 0.979 Test Loss: 0.498 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1604s/iter; left time: 5284.1495s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 1739.2664s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0564s/iter; left time: 1848.1267s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 1787.8222s
Epoch: 21 cost time: 22.72842001914978
Epoch: 21, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.525 Vali Acc: 0.974 Test Loss: 0.525 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1583s/iter; left time: 5148.2027s
	iters: 200, epoch: 22 | loss: 0.0001065
	speed: 0.0520s/iter; left time: 1685.8602s
	iters: 300, epoch: 22 | loss: 1.0499392
	speed: 0.0459s/iter; left time: 1483.6218s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 1430.8156s
Epoch: 22 cost time: 20.65646004676819
Epoch: 22, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.730 Vali Acc: 0.972 Test Loss: 0.730 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1474s/iter; left time: 4732.3026s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 1515.9500s
	iters: 300, epoch: 23 | loss: 0.0000002
	speed: 0.0498s/iter; left time: 1587.9836s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0401s/iter; left time: 1275.2270s
Epoch: 23 cost time: 18.727027893066406
Epoch: 23, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.512 Vali Acc: 0.982 Test Loss: 0.512 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1721s/iter; left time: 5455.0359s
	iters: 200, epoch: 24 | loss: 0.0723824
	speed: 0.0469s/iter; left time: 1481.9018s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 1233.5057s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 1173.1922s
Epoch: 24 cost time: 18.87834119796753
Epoch: 24, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.621 Vali Acc: 0.975 Test Loss: 0.621 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1628s/iter; left time: 5094.3028s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 1797.6873s
	iters: 300, epoch: 25 | loss: 0.0000103
	speed: 0.0549s/iter; left time: 1708.3130s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 1363.1956s
Epoch: 25 cost time: 22.207486152648926
Epoch: 25, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.561 Vali Acc: 0.975 Test Loss: 0.561 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1565s/iter; left time: 4832.6753s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0309s/iter; left time: 949.7455s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 1212.6876s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 1163.1195s
Epoch: 26 cost time: 16.426607847213745
Epoch: 26, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.714 Vali Acc: 0.979 Test Loss: 0.714 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 400650
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3936012
	speed: 0.0654s/iter; left time: 2693.1259s
	iters: 200, epoch: 1 | loss: 0.0496008
	speed: 0.0423s/iter; left time: 1738.8473s
	iters: 300, epoch: 1 | loss: 0.0127624
	speed: 0.0361s/iter; left time: 1481.1079s
	iters: 400, epoch: 1 | loss: 0.0474105
	speed: 0.0410s/iter; left time: 1677.6253s
Epoch: 1 cost time: 18.932369470596313
Epoch: 1, Steps: 413 | Train Loss: 0.349 Vali Loss: 0.337 Vali Acc: 0.921 Test Loss: 0.337 Test Acc: 0.921
Validation loss decreased (inf --> -0.921325).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0005234
	speed: 0.1472s/iter; left time: 6003.8954s
	iters: 200, epoch: 2 | loss: 0.0012358
	speed: 0.0403s/iter; left time: 1639.9881s
	iters: 300, epoch: 2 | loss: 0.0642653
	speed: 0.0411s/iter; left time: 1667.1997s
	iters: 400, epoch: 2 | loss: 0.0004694
	speed: 0.0411s/iter; left time: 1662.8726s
Epoch: 2 cost time: 17.42859435081482
Epoch: 2, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.257 Vali Acc: 0.955 Test Loss: 0.257 Test Acc: 0.955
Validation loss decreased (-0.921325 --> -0.954977).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0007230
	speed: 0.1657s/iter; left time: 6690.4544s
	iters: 200, epoch: 3 | loss: 0.0003318
	speed: 0.0515s/iter; left time: 2074.4424s
	iters: 300, epoch: 3 | loss: 0.0750729
	speed: 0.0410s/iter; left time: 1648.1676s
	iters: 400, epoch: 3 | loss: 0.9325307
	speed: 0.0481s/iter; left time: 1927.5926s
Epoch: 3 cost time: 20.079867124557495
Epoch: 3, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.464 Vali Acc: 0.933 Test Loss: 0.464 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000062
	speed: 0.1389s/iter; left time: 5551.9399s
	iters: 200, epoch: 4 | loss: 0.0012018
	speed: 0.0528s/iter; left time: 2105.0804s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 2004.3451s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1840.7911s
Epoch: 4 cost time: 20.243254899978638
Epoch: 4, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.352 Vali Acc: 0.956 Test Loss: 0.352 Test Acc: 0.956
Validation loss decreased (-0.954977 --> -0.955886).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0010289
	speed: 0.1439s/iter; left time: 5689.5522s
	iters: 200, epoch: 5 | loss: 0.0000131
	speed: 0.0456s/iter; left time: 1799.9755s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 1923.5764s
	iters: 400, epoch: 5 | loss: 0.0000014
	speed: 0.0532s/iter; left time: 2087.1962s
Epoch: 5 cost time: 20.246554851531982
Epoch: 5, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.502 Vali Acc: 0.934 Test Loss: 0.502 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000003
	speed: 0.1498s/iter; left time: 5863.8114s
	iters: 200, epoch: 6 | loss: 0.0000083
	speed: 0.0539s/iter; left time: 2103.9806s
	iters: 300, epoch: 6 | loss: 0.0000004
	speed: 0.0507s/iter; left time: 1972.6750s
	iters: 400, epoch: 6 | loss: 0.0034954
	speed: 0.0480s/iter; left time: 1864.5299s
Epoch: 6 cost time: 21.26059055328369
Epoch: 6, Steps: 413 | Train Loss: 0.153 Vali Loss: 0.341 Vali Acc: 0.972 Test Loss: 0.341 Test Acc: 0.972
Validation loss decreased (-0.955886 --> -0.971802).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1641s/iter; left time: 6354.8605s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0508s/iter; left time: 1962.8324s
	iters: 300, epoch: 7 | loss: 0.0006078
	speed: 0.0478s/iter; left time: 1840.5103s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.0477s/iter; left time: 1833.8866s
Epoch: 7 cost time: 20.990227222442627
Epoch: 7, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.364 Vali Acc: 0.966 Test Loss: 0.364 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0002320
	speed: 0.1753s/iter; left time: 6715.5251s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0586s/iter; left time: 2239.3397s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 2279.7757s
	iters: 400, epoch: 8 | loss: 0.1274412
	speed: 0.0594s/iter; left time: 2255.9055s
Epoch: 8 cost time: 25.198522567749023
Epoch: 8, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.318 Vali Acc: 0.974 Test Loss: 0.318 Test Acc: 0.974
Validation loss decreased (-0.971802 --> -0.973621).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1574s/iter; left time: 5966.7295s
	iters: 200, epoch: 9 | loss: 0.0000015
	speed: 0.0448s/iter; left time: 1694.7073s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 1688.9987s
	iters: 400, epoch: 9 | loss: 0.4844322
	speed: 0.0547s/iter; left time: 2056.1827s
Epoch: 9 cost time: 20.2485773563385
Epoch: 9, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.508 Vali Acc: 0.971 Test Loss: 0.508 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0084991
	speed: 0.1632s/iter; left time: 6118.0953s
	iters: 200, epoch: 10 | loss: 0.0000485
	speed: 0.0477s/iter; left time: 1781.4234s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 1984.0741s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 1927.0754s
Epoch: 10 cost time: 21.59432029724121
Epoch: 10, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.410 Vali Acc: 0.964 Test Loss: 0.410 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0005900
	speed: 0.1645s/iter; left time: 6098.1952s
	iters: 200, epoch: 11 | loss: 0.0158685
	speed: 0.0469s/iter; left time: 1735.6537s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 1898.7728s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 1551.3515s
Epoch: 11 cost time: 20.192020893096924
Epoch: 11, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.394 Vali Acc: 0.966 Test Loss: 0.394 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1529s/iter; left time: 5605.1194s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 1556.5464s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0420s/iter; left time: 1529.6737s
	iters: 400, epoch: 12 | loss: 0.0022988
	speed: 0.0345s/iter; left time: 1255.1372s
Epoch: 12 cost time: 16.71655821800232
Epoch: 12, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.407 Vali Acc: 0.971 Test Loss: 0.407 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1506s/iter; left time: 5458.9915s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0424s/iter; left time: 1531.4096s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 1335.8783s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 1326.3101s
Epoch: 13 cost time: 17.087753772735596
Epoch: 13, Steps: 413 | Train Loss: 0.165 Vali Loss: 0.611 Vali Acc: 0.972 Test Loss: 0.611 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1513s/iter; left time: 5422.4089s
	iters: 200, epoch: 14 | loss: 0.0000156
	speed: 0.0446s/iter; left time: 1593.2030s
	iters: 300, epoch: 14 | loss: 0.0000722
	speed: 0.0415s/iter; left time: 1479.3154s
	iters: 400, epoch: 14 | loss: 0.0019730
	speed: 0.0378s/iter; left time: 1344.5919s
Epoch: 14 cost time: 17.833506107330322
Epoch: 14, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.321 Vali Acc: 0.981 Test Loss: 0.321 Test Acc: 0.981
Validation loss decreased (-0.973621 --> -0.980897).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1319s/iter; left time: 4673.2070s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 1341.0144s
	iters: 300, epoch: 15 | loss: 0.0012199
	speed: 0.0372s/iter; left time: 1311.5477s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 1230.4350s
Epoch: 15 cost time: 15.258634567260742
Epoch: 15, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.665 Vali Acc: 0.968 Test Loss: 0.665 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1522s/iter; left time: 5327.1547s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0508s/iter; left time: 1773.9754s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0455s/iter; left time: 1583.3614s
	iters: 400, epoch: 16 | loss: 0.0000274
	speed: 0.0486s/iter; left time: 1687.6978s
Epoch: 16 cost time: 20.640708923339844
Epoch: 16, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.470 Vali Acc: 0.969 Test Loss: 0.470 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1623s/iter; left time: 5615.8770s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0429s/iter; left time: 1481.1512s
	iters: 300, epoch: 17 | loss: 0.0000047
	speed: 0.0464s/iter; left time: 1594.1776s
	iters: 400, epoch: 17 | loss: 0.0000498
	speed: 0.0527s/iter; left time: 1807.5351s
Epoch: 17 cost time: 20.446035861968994
Epoch: 17, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.596 Vali Acc: 0.972 Test Loss: 0.596 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000013
	speed: 0.1464s/iter; left time: 5002.9058s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0296s/iter; left time: 1008.9833s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 907.8727s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0299s/iter; left time: 1014.0564s
Epoch: 18 cost time: 13.390097856521606
Epoch: 18, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.583 Vali Acc: 0.970 Test Loss: 0.583 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1260s/iter; left time: 4253.5885s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0396s/iter; left time: 1333.4339s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 1484.4043s
	iters: 400, epoch: 19 | loss: 0.0171108
	speed: 0.0343s/iter; left time: 1149.1928s
Epoch: 19 cost time: 15.449064493179321
Epoch: 19, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.532 Vali Acc: 0.975 Test Loss: 0.532 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1614s/iter; left time: 5382.1404s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 1655.4853s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0514s/iter; left time: 1705.5932s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 1652.0759s
Epoch: 20 cost time: 21.224212408065796
Epoch: 20, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.420 Vali Acc: 0.979 Test Loss: 0.420 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 3.4030404
	speed: 0.1675s/iter; left time: 5519.2402s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 2018.7693s
	iters: 300, epoch: 21 | loss: 0.0002738
	speed: 0.0559s/iter; left time: 1830.9616s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 1845.3444s
Epoch: 21 cost time: 24.051307678222656
Epoch: 21, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.484 Vali Acc: 0.977 Test Loss: 0.484 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1793s/iter; left time: 5831.3251s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 1819.7824s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0558s/iter; left time: 1805.4622s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 1837.4593s
Epoch: 22 cost time: 24.20181894302368
Epoch: 22, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.610 Vali Acc: 0.970 Test Loss: 0.610 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1751s/iter; left time: 5622.5792s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 1757.4580s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0501s/iter; left time: 1599.9577s
	iters: 400, epoch: 23 | loss: 0.0000002
	speed: 0.0513s/iter; left time: 1632.1202s
Epoch: 23 cost time: 22.958783626556396
Epoch: 23, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.476 Vali Acc: 0.974 Test Loss: 0.476 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0001899
	speed: 0.1448s/iter; left time: 4591.0914s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0354s/iter; left time: 1118.3481s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 1181.1101s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 1122.5543s
Epoch: 24 cost time: 15.600342273712158
Epoch: 24, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.387 Vali Acc: 0.977 Test Loss: 0.387 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 317962
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0311956
	speed: 0.0708s/iter; left time: 2917.7488s
	iters: 200, epoch: 1 | loss: 0.5799608
	speed: 0.0491s/iter; left time: 2016.8408s
	iters: 300, epoch: 1 | loss: 0.0084524
	speed: 0.0524s/iter; left time: 2149.7002s
	iters: 400, epoch: 1 | loss: 0.1531751
	speed: 0.0534s/iter; left time: 2183.3951s
Epoch: 1 cost time: 23.272579193115234
Epoch: 1, Steps: 413 | Train Loss: 0.347 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
Validation loss decreased (inf --> -0.948157).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0021087
	speed: 0.1606s/iter; left time: 6552.4225s
	iters: 200, epoch: 2 | loss: 0.0797087
	speed: 0.0516s/iter; left time: 2100.2016s
	iters: 300, epoch: 2 | loss: 0.0005007
	speed: 0.0607s/iter; left time: 2461.9629s
	iters: 400, epoch: 2 | loss: 0.0001379
	speed: 0.0569s/iter; left time: 2305.0284s
Epoch: 2 cost time: 22.957400798797607
Epoch: 2, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
Validation loss decreased (-0.948157 --> -0.964983).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0126996
	speed: 0.1666s/iter; left time: 6727.2293s
	iters: 200, epoch: 3 | loss: 0.0492021
	speed: 0.0596s/iter; left time: 2402.0880s
	iters: 300, epoch: 3 | loss: 0.9930710
	speed: 0.0551s/iter; left time: 2212.2484s
	iters: 400, epoch: 3 | loss: 0.4333643
	speed: 0.0497s/iter; left time: 1993.7018s
Epoch: 3 cost time: 23.3735191822052
Epoch: 3, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1214375
	speed: 0.1628s/iter; left time: 6503.8230s
	iters: 200, epoch: 4 | loss: 0.1492741
	speed: 0.0477s/iter; left time: 1900.3065s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 1634.7724s
	iters: 400, epoch: 4 | loss: 0.6280878
	speed: 0.0333s/iter; left time: 1319.8547s
Epoch: 4 cost time: 18.01593780517578
Epoch: 4, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.310 Vali Acc: 0.955 Test Loss: 0.310 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7976583
	speed: 0.1289s/iter; left time: 5097.0714s
	iters: 200, epoch: 5 | loss: 0.0022035
	speed: 0.0279s/iter; left time: 1102.2216s
	iters: 300, epoch: 5 | loss: 0.4124878
	speed: 0.0265s/iter; left time: 1041.1575s
	iters: 400, epoch: 5 | loss: 0.3371811
	speed: 0.0357s/iter; left time: 1399.8641s
Epoch: 5 cost time: 12.797938108444214
Epoch: 5, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.221 Vali Acc: 0.972 Test Loss: 0.221 Test Acc: 0.972
Validation loss decreased (-0.964983 --> -0.972258).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2488353
	speed: 0.1511s/iter; left time: 5912.1173s
	iters: 200, epoch: 6 | loss: 0.0000004
	speed: 0.0346s/iter; left time: 1352.1368s
	iters: 300, epoch: 6 | loss: 0.0001921
	speed: 0.0391s/iter; left time: 1522.0431s
	iters: 400, epoch: 6 | loss: 0.0000027
	speed: 0.0388s/iter; left time: 1504.9215s
Epoch: 6 cost time: 16.06346344947815
Epoch: 6, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.263 Vali Acc: 0.973 Test Loss: 0.263 Test Acc: 0.973
Validation loss decreased (-0.972258 --> -0.972712).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0757279
	speed: 0.1441s/iter; left time: 5580.1957s
	iters: 200, epoch: 7 | loss: 0.0000322
	speed: 0.0366s/iter; left time: 1414.6196s
	iters: 300, epoch: 7 | loss: 0.0452966
	speed: 0.0375s/iter; left time: 1442.9075s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 1436.1939s
Epoch: 7 cost time: 15.658546924591064
Epoch: 7, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.245 Vali Acc: 0.973 Test Loss: 0.245 Test Acc: 0.973
Validation loss decreased (-0.972712 --> -0.973167).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1427s/iter; left time: 5468.2591s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0399s/iter; left time: 1525.4605s
	iters: 300, epoch: 8 | loss: 0.0016678
	speed: 0.0400s/iter; left time: 1525.1373s
	iters: 400, epoch: 8 | loss: 0.0701700
	speed: 0.0344s/iter; left time: 1308.2914s
Epoch: 8 cost time: 15.631628036499023
Epoch: 8, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.263 Vali Acc: 0.970 Test Loss: 0.263 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1676930
	speed: 0.1478s/iter; left time: 5601.9675s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 1776.7571s
	iters: 300, epoch: 9 | loss: 0.0000013
	speed: 0.0516s/iter; left time: 1946.3513s
	iters: 400, epoch: 9 | loss: 0.0000097
	speed: 0.0454s/iter; left time: 1708.3120s
Epoch: 9 cost time: 19.936445236206055
Epoch: 9, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.387 Vali Acc: 0.966 Test Loss: 0.387 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.3040950
	speed: 0.1695s/iter; left time: 6353.0235s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0455s/iter; left time: 1700.7587s
	iters: 300, epoch: 10 | loss: 0.0000005
	speed: 0.0422s/iter; left time: 1574.1596s
	iters: 400, epoch: 10 | loss: 0.2521375
	speed: 0.0448s/iter; left time: 1667.4423s
Epoch: 10 cost time: 19.541972875595093
Epoch: 10, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.425 Vali Acc: 0.963 Test Loss: 0.425 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1429s/iter; left time: 5297.0645s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 1326.3857s
	iters: 300, epoch: 11 | loss: 0.0000024
	speed: 0.0401s/iter; left time: 1477.9008s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 1217.8025s
Epoch: 11 cost time: 15.892662048339844
Epoch: 11, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.465 Vali Acc: 0.964 Test Loss: 0.465 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000013
	speed: 0.1517s/iter; left time: 5562.6025s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0483s/iter; left time: 1766.4543s
	iters: 300, epoch: 12 | loss: 0.0000416
	speed: 0.0487s/iter; left time: 1775.9631s
	iters: 400, epoch: 12 | loss: 0.0000005
	speed: 0.0482s/iter; left time: 1750.6977s
Epoch: 12 cost time: 20.38330364227295
Epoch: 12, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.275 Vali Acc: 0.973 Test Loss: 0.275 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1539s/iter; left time: 5578.8227s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 1480.6042s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1748.8779s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 1768.5592s
Epoch: 13 cost time: 20.104670524597168
Epoch: 13, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.320 Vali Acc: 0.972 Test Loss: 0.320 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000051
	speed: 0.1600s/iter; left time: 5733.2022s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 1538.3252s
	iters: 300, epoch: 14 | loss: 0.0000008
	speed: 0.0363s/iter; left time: 1293.8662s
	iters: 400, epoch: 14 | loss: 0.0000002
	speed: 0.0361s/iter; left time: 1283.5382s
Epoch: 14 cost time: 17.467908143997192
Epoch: 14, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.486 Vali Acc: 0.969 Test Loss: 0.486 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.1523s/iter; left time: 5395.4373s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0600s/iter; left time: 2118.9897s
	iters: 300, epoch: 15 | loss: 0.0000002
	speed: 0.0566s/iter; left time: 1993.3712s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0551s/iter; left time: 1934.1272s
Epoch: 15 cost time: 23.870803833007812
Epoch: 15, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.362 Vali Acc: 0.964 Test Loss: 0.362 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0002095
	speed: 0.1713s/iter; left time: 5995.7566s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0611s/iter; left time: 2134.2474s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0554s/iter; left time: 1927.9565s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0552s/iter; left time: 1916.0870s
Epoch: 16 cost time: 24.82877826690674
Epoch: 16, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.408 Vali Acc: 0.972 Test Loss: 0.408 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1588s/iter; left time: 5493.6046s
	iters: 200, epoch: 17 | loss: 0.0203167
	speed: 0.0486s/iter; left time: 1674.7209s
	iters: 300, epoch: 17 | loss: 0.0029607
	speed: 0.0477s/iter; left time: 1640.1860s
	iters: 400, epoch: 17 | loss: 0.5709086
	speed: 0.0454s/iter; left time: 1556.9929s
Epoch: 17 cost time: 20.36796760559082
Epoch: 17, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.378 Vali Acc: 0.968 Test Loss: 0.378 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9731696225557072
model parameter : 252042
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2640958
	speed: 0.0692s/iter; left time: 2852.9651s
	iters: 200, epoch: 1 | loss: 0.2375778
	speed: 0.0451s/iter; left time: 1854.1865s
	iters: 300, epoch: 1 | loss: 0.1774935
	speed: 0.0407s/iter; left time: 1669.1741s
	iters: 400, epoch: 1 | loss: 0.1744769
	speed: 0.0472s/iter; left time: 1928.7949s
Epoch: 1 cost time: 20.802743196487427
Epoch: 1, Steps: 413 | Train Loss: 0.355 Vali Loss: 0.117 Vali Acc: 0.963 Test Loss: 0.117 Test Acc: 0.963
Validation loss decreased (inf --> -0.963164).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1284681
	speed: 0.1412s/iter; left time: 5761.1330s
	iters: 200, epoch: 2 | loss: 0.0009988
	speed: 0.0320s/iter; left time: 1303.4557s
	iters: 300, epoch: 2 | loss: 0.0003276
	speed: 0.0326s/iter; left time: 1322.4215s
	iters: 400, epoch: 2 | loss: 0.0042756
	speed: 0.0222s/iter; left time: 900.4510s
Epoch: 2 cost time: 13.376124858856201
Epoch: 2, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.963164 --> -0.968166).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0006255
	speed: 0.1114s/iter; left time: 4498.0127s
	iters: 200, epoch: 3 | loss: 0.0012345
	speed: 0.0411s/iter; left time: 1656.6629s
	iters: 300, epoch: 3 | loss: 0.0000125
	speed: 0.0466s/iter; left time: 1871.8185s
	iters: 400, epoch: 3 | loss: 0.0017094
	speed: 0.0485s/iter; left time: 1945.2769s
Epoch: 3 cost time: 17.504541873931885
Epoch: 3, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
Validation loss decreased (-0.968166 --> -0.973623).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000017
	speed: 0.1395s/iter; left time: 5575.8472s
	iters: 200, epoch: 4 | loss: 0.0136251
	speed: 0.0446s/iter; left time: 1778.2608s
	iters: 300, epoch: 4 | loss: 0.0002024
	speed: 0.0477s/iter; left time: 1897.9343s
	iters: 400, epoch: 4 | loss: 0.0000166
	speed: 0.0520s/iter; left time: 2061.5277s
Epoch: 4 cost time: 19.06976294517517
Epoch: 4, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.189 Vali Acc: 0.964 Test Loss: 0.189 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0487999
	speed: 0.1464s/iter; left time: 5791.6469s
	iters: 200, epoch: 5 | loss: 0.5653530
	speed: 0.0481s/iter; left time: 1899.0880s
	iters: 300, epoch: 5 | loss: 0.0012059
	speed: 0.0411s/iter; left time: 1615.5200s
	iters: 400, epoch: 5 | loss: 0.0003422
	speed: 0.0351s/iter; left time: 1376.3699s
Epoch: 5 cost time: 18.07900905609131
Epoch: 5, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.174 Vali Acc: 0.969 Test Loss: 0.174 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0151601
	speed: 0.1350s/iter; left time: 5282.4865s
	iters: 200, epoch: 6 | loss: 0.0000414
	speed: 0.0420s/iter; left time: 1639.0024s
	iters: 300, epoch: 6 | loss: 0.0004012
	speed: 0.0366s/iter; left time: 1425.1985s
	iters: 400, epoch: 6 | loss: 0.0000256
	speed: 0.0316s/iter; left time: 1228.6934s
Epoch: 6 cost time: 15.497000217437744
Epoch: 6, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.226 Vali Acc: 0.974 Test Loss: 0.226 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1418s/iter; left time: 5490.0042s
	iters: 200, epoch: 7 | loss: 0.3194608
	speed: 0.0344s/iter; left time: 1328.3262s
	iters: 300, epoch: 7 | loss: 0.0187778
	speed: 0.0388s/iter; left time: 1495.1260s
	iters: 400, epoch: 7 | loss: 0.0000005
	speed: 0.0295s/iter; left time: 1131.8830s
Epoch: 7 cost time: 14.900172710418701
Epoch: 7, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.353 Vali Acc: 0.963 Test Loss: 0.353 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1356s/iter; left time: 5196.1655s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0364s/iter; left time: 1391.0973s
	iters: 300, epoch: 8 | loss: 0.0665623
	speed: 0.0311s/iter; left time: 1186.7558s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 986.5697s
Epoch: 8 cost time: 13.972030878067017
Epoch: 8, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.293 Vali Acc: 0.963 Test Loss: 0.293 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000141
	speed: 0.1107s/iter; left time: 4195.6037s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0247s/iter; left time: 933.2272s
	iters: 300, epoch: 9 | loss: 0.6405078
	speed: 0.0242s/iter; left time: 912.2539s
	iters: 400, epoch: 9 | loss: 0.0124168
	speed: 0.0269s/iter; left time: 1011.2988s
Epoch: 9 cost time: 11.041750192642212
Epoch: 9, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.314 Vali Acc: 0.965 Test Loss: 0.314 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.1181015
	speed: 0.1373s/iter; left time: 5146.2227s
	iters: 200, epoch: 10 | loss: 0.2690199
	speed: 0.0490s/iter; left time: 1831.0336s
	iters: 300, epoch: 10 | loss: 0.0000007
	speed: 0.0463s/iter; left time: 1724.9958s
	iters: 400, epoch: 10 | loss: 0.1673258
	speed: 0.0448s/iter; left time: 1665.9464s
Epoch: 10 cost time: 19.278966903686523
Epoch: 10, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.246 Vali Acc: 0.968 Test Loss: 0.246 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0002644
	speed: 0.1396s/iter; left time: 5174.7424s
	iters: 200, epoch: 11 | loss: 0.0576201
	speed: 0.0528s/iter; left time: 1951.8188s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0536s/iter; left time: 1975.1182s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 1900.0046s
Epoch: 11 cost time: 20.801693439483643
Epoch: 11, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.286 Vali Acc: 0.970 Test Loss: 0.286 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.3146375
	speed: 0.1542s/iter; left time: 5652.3668s
	iters: 200, epoch: 12 | loss: 0.0002508
	speed: 0.0414s/iter; left time: 1511.7986s
	iters: 300, epoch: 12 | loss: 0.9236259
	speed: 0.0446s/iter; left time: 1626.1655s
	iters: 400, epoch: 12 | loss: 0.5381858
	speed: 0.0458s/iter; left time: 1665.9139s
Epoch: 12 cost time: 19.243761777877808
Epoch: 12, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.367 Vali Acc: 0.964 Test Loss: 0.367 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1433s/iter; left time: 5194.4537s
	iters: 200, epoch: 13 | loss: 0.0000008
	speed: 0.0445s/iter; left time: 1607.9839s
	iters: 300, epoch: 13 | loss: 0.4384963
	speed: 0.0417s/iter; left time: 1504.5087s
	iters: 400, epoch: 13 | loss: 0.0000090
	speed: 0.0435s/iter; left time: 1562.3396s
Epoch: 13 cost time: 18.55907702445984
Epoch: 13, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.318 Vali Acc: 0.978 Test Loss: 0.318 Test Acc: 0.978
Validation loss decreased (-0.973623 --> -0.977714).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1308s/iter; left time: 4685.2307s
	iters: 200, epoch: 14 | loss: 1.3568223
	speed: 0.0331s/iter; left time: 1182.2997s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0334s/iter; left time: 1190.9482s
	iters: 400, epoch: 14 | loss: 0.2569543
	speed: 0.0352s/iter; left time: 1252.2351s
Epoch: 14 cost time: 14.519559621810913
Epoch: 14, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.291 Vali Acc: 0.974 Test Loss: 0.291 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1474s/iter; left time: 5222.2367s
	iters: 200, epoch: 15 | loss: 0.0000069
	speed: 0.0440s/iter; left time: 1553.5254s
	iters: 300, epoch: 15 | loss: 0.0000011
	speed: 0.0486s/iter; left time: 1711.3497s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1721.6251s
Epoch: 15 cost time: 19.55374312400818
Epoch: 15, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.424 Vali Acc: 0.962 Test Loss: 0.424 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3689256
	speed: 0.1582s/iter; left time: 5538.5200s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0582s/iter; left time: 2032.7746s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 2075.0974s
	iters: 400, epoch: 16 | loss: 0.0000877
	speed: 0.0540s/iter; left time: 1872.8556s
Epoch: 16 cost time: 23.94729256629944
Epoch: 16, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.368 Vali Acc: 0.975 Test Loss: 0.368 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1650s/iter; left time: 5706.8900s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 1833.4149s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0537s/iter; left time: 1845.8519s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 1790.8741s
Epoch: 17 cost time: 22.28934645652771
Epoch: 17, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.339 Vali Acc: 0.969 Test Loss: 0.339 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000279
	speed: 0.1601s/iter; left time: 5473.3500s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.0418s/iter; left time: 1426.0955s
	iters: 300, epoch: 18 | loss: 0.0000019
	speed: 0.0408s/iter; left time: 1386.9047s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1539.1685s
Epoch: 18 cost time: 19.16236662864685
Epoch: 18, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.464 Vali Acc: 0.968 Test Loss: 0.464 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1235s/iter; left time: 4171.3416s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0317s/iter; left time: 1068.6760s
	iters: 300, epoch: 19 | loss: 0.3999308
	speed: 0.0319s/iter; left time: 1070.1268s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 1209.0078s
Epoch: 19 cost time: 14.703154563903809
Epoch: 19, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.362 Vali Acc: 0.972 Test Loss: 0.362 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.2516451
	speed: 0.1213s/iter; left time: 4046.7114s
	iters: 200, epoch: 20 | loss: 0.0000100
	speed: 0.0322s/iter; left time: 1069.1565s
	iters: 300, epoch: 20 | loss: 0.0000061
	speed: 0.0270s/iter; left time: 893.6658s
	iters: 400, epoch: 20 | loss: 0.0000390
	speed: 0.0345s/iter; left time: 1141.7339s
Epoch: 20 cost time: 13.178405046463013
Epoch: 20, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.302 Vali Acc: 0.978 Test Loss: 0.302 Test Acc: 0.978
Validation loss decreased (-0.977714 --> -0.978169).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.2792107
	speed: 0.1214s/iter; left time: 3998.1390s
	iters: 200, epoch: 21 | loss: 0.0000002
	speed: 0.0309s/iter; left time: 1014.7769s
	iters: 300, epoch: 21 | loss: 1.2014477
	speed: 0.0324s/iter; left time: 1060.0725s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.0291s/iter; left time: 949.5904s
Epoch: 21 cost time: 13.147116422653198
Epoch: 21, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0001021
	speed: 0.1296s/iter; left time: 4215.1013s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0354s/iter; left time: 1147.2917s
	iters: 300, epoch: 22 | loss: 0.0001326
	speed: 0.0276s/iter; left time: 893.3160s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 918.5103s
Epoch: 22 cost time: 13.481423377990723
Epoch: 22, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.516 Vali Acc: 0.968 Test Loss: 0.516 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.0853720
	speed: 0.1442s/iter; left time: 4631.9711s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 1198.9742s
	iters: 300, epoch: 23 | loss: 0.4399473
	speed: 0.0429s/iter; left time: 1369.3324s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0424s/iter; left time: 1347.7006s
Epoch: 23 cost time: 18.085013389587402
Epoch: 23, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.469 Vali Acc: 0.968 Test Loss: 0.469 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1405s/iter; left time: 4453.8906s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 1123.7150s
	iters: 300, epoch: 24 | loss: 0.0000023
	speed: 0.0328s/iter; left time: 1032.2533s
	iters: 400, epoch: 24 | loss: 0.0000001
	speed: 0.0323s/iter; left time: 1015.4982s
Epoch: 24 cost time: 14.90168833732605
Epoch: 24, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.446 Vali Acc: 0.968 Test Loss: 0.446 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1170s/iter; left time: 3660.9888s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 878.4249s
	iters: 300, epoch: 25 | loss: 0.0191048
	speed: 0.0271s/iter; left time: 841.8984s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0302s/iter; left time: 936.5857s
Epoch: 25 cost time: 11.916964292526245
Epoch: 25, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.335 Vali Acc: 0.975 Test Loss: 0.335 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1133s/iter; left time: 3496.7128s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 819.6655s
	iters: 300, epoch: 26 | loss: 0.0000002
	speed: 0.0295s/iter; left time: 903.5169s
	iters: 400, epoch: 26 | loss: 0.0074895
	speed: 0.0336s/iter; left time: 1026.5588s
Epoch: 26 cost time: 12.58623719215393
Epoch: 26, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.480 Vali Acc: 0.970 Test Loss: 0.480 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1224s/iter; left time: 3730.0591s
	iters: 200, epoch: 27 | loss: 0.4391623
	speed: 0.0281s/iter; left time: 851.7022s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0321s/iter; left time: 972.1674s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0321s/iter; left time: 968.0221s
Epoch: 27 cost time: 13.002962112426758
Epoch: 27, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.368 Vali Acc: 0.976 Test Loss: 0.368 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1208s/iter; left time: 3630.8776s
	iters: 200, epoch: 28 | loss: 0.0000001
	speed: 0.0274s/iter; left time: 822.0771s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 857.0295s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 863.6989s
Epoch: 28 cost time: 12.419482231140137
Epoch: 28, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.428 Vali Acc: 0.974 Test Loss: 0.428 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000503
	speed: 0.1362s/iter; left time: 4038.0115s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 1188.3875s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 1205.7882s
	iters: 400, epoch: 29 | loss: 0.0105592
	speed: 0.0434s/iter; left time: 1271.9121s
Epoch: 29 cost time: 17.79083776473999
Epoch: 29, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.413 Vali Acc: 0.968 Test Loss: 0.413 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000001
	speed: 0.1540s/iter; left time: 4501.0144s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 1399.4938s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 1587.4588s
	iters: 400, epoch: 30 | loss: 0.2846918
	speed: 0.0535s/iter; left time: 1546.2962s
Epoch: 30 cost time: 21.670649528503418
Epoch: 30, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.436 Vali Acc: 0.968 Test Loss: 0.436 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 219402
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8247154
	speed: 0.0724s/iter; left time: 2982.2392s
	iters: 200, epoch: 1 | loss: 0.3659384
	speed: 0.0508s/iter; left time: 2086.1737s
	iters: 300, epoch: 1 | loss: 1.7365330
	speed: 0.0536s/iter; left time: 2197.5122s
	iters: 400, epoch: 1 | loss: 0.0367390
	speed: 0.0498s/iter; left time: 2035.4809s
Epoch: 1 cost time: 23.232592344284058
Epoch: 1, Steps: 413 | Train Loss: 0.557 Vali Loss: 0.469 Vali Acc: 0.931 Test Loss: 0.469 Test Acc: 0.931
Validation loss decreased (inf --> -0.931328).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3501393
	speed: 0.1640s/iter; left time: 6688.1711s
	iters: 200, epoch: 2 | loss: 0.0923499
	speed: 0.0564s/iter; left time: 2294.7945s
	iters: 300, epoch: 2 | loss: 0.0000125
	speed: 0.0517s/iter; left time: 2098.5086s
	iters: 400, epoch: 2 | loss: 0.3310570
	speed: 0.0522s/iter; left time: 2112.2858s
Epoch: 2 cost time: 22.706883907318115
Epoch: 2, Steps: 413 | Train Loss: 0.298 Vali Loss: 0.741 Vali Acc: 0.933 Test Loss: 0.741 Test Acc: 0.933
Validation loss decreased (-0.931328 --> -0.932689).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.1673s/iter; left time: 6753.7630s
	iters: 200, epoch: 3 | loss: 0.0000584
	speed: 0.0525s/iter; left time: 2115.9992s
	iters: 300, epoch: 3 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 2215.3716s
	iters: 400, epoch: 3 | loss: 0.0600204
	speed: 0.0544s/iter; left time: 2178.1519s
Epoch: 3 cost time: 22.977763652801514
Epoch: 3, Steps: 413 | Train Loss: 0.301 Vali Loss: 0.675 Vali Acc: 0.958 Test Loss: 0.675 Test Acc: 0.958
Validation loss decreased (-0.932689 --> -0.958156).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.1716s/iter; left time: 6857.9300s
	iters: 200, epoch: 4 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 2100.9143s
	iters: 300, epoch: 4 | loss: 0.3402235
	speed: 0.0559s/iter; left time: 2221.9381s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 2094.3069s
Epoch: 4 cost time: 22.906914710998535
Epoch: 4, Steps: 413 | Train Loss: 0.284 Vali Loss: 0.518 Vali Acc: 0.953 Test Loss: 0.518 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000005
	speed: 0.1877s/iter; left time: 7424.3108s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0679s/iter; left time: 2677.2402s
	iters: 300, epoch: 5 | loss: 1.3598826
	speed: 0.0592s/iter; left time: 2328.9881s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1990.8818s
Epoch: 5 cost time: 25.244895696640015
Epoch: 5, Steps: 413 | Train Loss: 0.273 Vali Loss: 0.668 Vali Acc: 0.963 Test Loss: 0.668 Test Acc: 0.963
Validation loss decreased (-0.958156 --> -0.963158).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.1747s/iter; left time: 6835.2622s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 1784.0211s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1907.4292s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 2006.0704s
Epoch: 6 cost time: 22.401682376861572
Epoch: 6, Steps: 413 | Train Loss: 0.255 Vali Loss: 0.578 Vali Acc: 0.968 Test Loss: 0.578 Test Acc: 0.968
Validation loss decreased (-0.963158 --> -0.967707).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0002334
	speed: 0.1542s/iter; left time: 5972.1713s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0393s/iter; left time: 1518.7488s
	iters: 300, epoch: 7 | loss: 0.8917787
	speed: 0.0343s/iter; left time: 1321.1846s
	iters: 400, epoch: 7 | loss: 0.0535802
	speed: 0.0411s/iter; left time: 1580.3560s
Epoch: 7 cost time: 16.491812705993652
Epoch: 7, Steps: 413 | Train Loss: 0.281 Vali Loss: 0.495 Vali Acc: 0.979 Test Loss: 0.495 Test Acc: 0.979
Validation loss decreased (-0.967707 --> -0.978622).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1400s/iter; left time: 5364.3667s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 1505.8924s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 1500.1417s
	iters: 400, epoch: 8 | loss: 0.1015865
	speed: 0.0453s/iter; left time: 1721.6780s
Epoch: 8 cost time: 16.886680841445923
Epoch: 8, Steps: 413 | Train Loss: 0.240 Vali Loss: 1.303 Vali Acc: 0.961 Test Loss: 1.303 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1372s/iter; left time: 5198.9070s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 1411.1868s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0424s/iter; left time: 1599.1891s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 1636.8689s
Epoch: 9 cost time: 16.97417712211609
Epoch: 9, Steps: 413 | Train Loss: 0.221 Vali Loss: 0.945 Vali Acc: 0.975 Test Loss: 0.945 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0003679
	speed: 0.1339s/iter; left time: 5019.1181s
	iters: 200, epoch: 10 | loss: 0.0000016
	speed: 0.0343s/iter; left time: 1281.4820s
	iters: 300, epoch: 10 | loss: 0.0000029
	speed: 0.0384s/iter; left time: 1433.5691s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 1616.6841s
Epoch: 10 cost time: 16.10817050933838
Epoch: 10, Steps: 413 | Train Loss: 0.190 Vali Loss: 0.922 Vali Acc: 0.968 Test Loss: 0.922 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000857
	speed: 0.1417s/iter; left time: 5252.6609s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 1700.0102s
	iters: 300, epoch: 11 | loss: 0.0000203
	speed: 0.0540s/iter; left time: 1992.7730s
	iters: 400, epoch: 11 | loss: 4.4279928
	speed: 0.0515s/iter; left time: 1893.4943s
Epoch: 11 cost time: 20.55025291442871
Epoch: 11, Steps: 413 | Train Loss: 0.187 Vali Loss: 0.724 Vali Acc: 0.980 Test Loss: 0.724 Test Acc: 0.980
Validation loss decreased (-0.978622 --> -0.979529).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1746s/iter; left time: 6399.3991s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 2006.3714s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 1755.9784s
	iters: 400, epoch: 12 | loss: 1.6813731
	speed: 0.0482s/iter; left time: 1750.9013s
Epoch: 12 cost time: 22.455843210220337
Epoch: 12, Steps: 413 | Train Loss: 0.248 Vali Loss: 1.202 Vali Acc: 0.965 Test Loss: 1.202 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1530s/iter; left time: 5545.4518s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0382s/iter; left time: 1381.7733s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 1413.0373s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0408s/iter; left time: 1467.2439s
Epoch: 13 cost time: 17.035475969314575
Epoch: 13, Steps: 413 | Train Loss: 0.175 Vali Loss: 1.234 Vali Acc: 0.967 Test Loss: 1.234 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0683347
	speed: 0.1359s/iter; left time: 4868.4876s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 1451.6780s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1807.3885s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 1866.2101s
Epoch: 14 cost time: 19.43553876876831
Epoch: 14, Steps: 413 | Train Loss: 0.210 Vali Loss: 1.157 Vali Acc: 0.970 Test Loss: 1.157 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1693s/iter; left time: 5994.9355s
	iters: 200, epoch: 15 | loss: 1.0945640
	speed: 0.0536s/iter; left time: 1894.4767s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 1881.8543s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0513s/iter; left time: 1802.9788s
Epoch: 15 cost time: 22.38727378845215
Epoch: 15, Steps: 413 | Train Loss: 0.151 Vali Loss: 0.778 Vali Acc: 0.976 Test Loss: 0.778 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1525s/iter; left time: 5337.8183s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 1528.9234s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0502s/iter; left time: 1748.5543s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 2166.0338s
Epoch: 16 cost time: 21.71955370903015
Epoch: 16, Steps: 413 | Train Loss: 0.104 Vali Loss: 1.820 Vali Acc: 0.958 Test Loss: 1.820 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 2.0647483
	speed: 0.1870s/iter; left time: 6470.5236s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0614s/iter; left time: 2117.3528s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0641s/iter; left time: 2204.7080s
	iters: 400, epoch: 17 | loss: 0.0030061
	speed: 0.0675s/iter; left time: 2315.1262s
Epoch: 17 cost time: 26.913270950317383
Epoch: 17, Steps: 413 | Train Loss: 0.143 Vali Loss: 1.445 Vali Acc: 0.971 Test Loss: 1.445 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1869s/iter; left time: 6389.0996s
	iters: 200, epoch: 18 | loss: 1.7571039
	speed: 0.0634s/iter; left time: 2160.3605s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0652s/iter; left time: 2216.7973s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 1802.9097s
Epoch: 18 cost time: 25.59232807159424
Epoch: 18, Steps: 413 | Train Loss: 0.122 Vali Loss: 1.553 Vali Acc: 0.969 Test Loss: 1.553 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1690s/iter; left time: 5706.4051s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0536s/iter; left time: 1805.3630s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 1717.7792s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 1727.8452s
Epoch: 19 cost time: 22.26141381263733
Epoch: 19, Steps: 413 | Train Loss: 0.134 Vali Loss: 2.002 Vali Acc: 0.960 Test Loss: 2.002 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1485s/iter; left time: 4953.8498s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 1377.8252s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 1397.6109s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 1708.5849s
Epoch: 20 cost time: 18.626123666763306
Epoch: 20, Steps: 413 | Train Loss: 0.216 Vali Loss: 1.277 Vali Acc: 0.973 Test Loss: 1.277 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1682s/iter; left time: 5540.8680s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 1711.7390s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 1820.7194s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0560s/iter; left time: 1826.6735s
Epoch: 21 cost time: 22.94879984855652
Epoch: 21, Steps: 413 | Train Loss: 0.188 Vali Loss: 1.575 Vali Acc: 0.966 Test Loss: 1.575 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 865866
model size : 5.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.6169271
	speed: 0.0654s/iter; left time: 2693.5609s
	iters: 200, epoch: 1 | loss: 0.0007739
	speed: 0.0468s/iter; left time: 1922.2103s
	iters: 300, epoch: 1 | loss: 0.2086252
	speed: 0.0495s/iter; left time: 2029.9840s
	iters: 400, epoch: 1 | loss: 0.0291995
	speed: 0.0481s/iter; left time: 1967.6906s
Epoch: 1 cost time: 21.959378004074097
Epoch: 1, Steps: 413 | Train Loss: 0.478 Vali Loss: 0.313 Vali Acc: 0.952 Test Loss: 0.313 Test Acc: 0.952
Validation loss decreased (inf --> -0.952248).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4522505
	speed: 0.1605s/iter; left time: 6548.3028s
	iters: 200, epoch: 2 | loss: 0.3525633
	speed: 0.0448s/iter; left time: 1821.1346s
	iters: 300, epoch: 2 | loss: 0.0072631
	speed: 0.0352s/iter; left time: 1430.1060s
	iters: 400, epoch: 2 | loss: 0.0000201
	speed: 0.0362s/iter; left time: 1465.0073s
Epoch: 2 cost time: 17.607765913009644
Epoch: 2, Steps: 413 | Train Loss: 0.271 Vali Loss: 0.336 Vali Acc: 0.960 Test Loss: 0.336 Test Acc: 0.960
Validation loss decreased (-0.952248 --> -0.960433).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000105
	speed: 0.1263s/iter; left time: 5098.3676s
	iters: 200, epoch: 3 | loss: 0.0027332
	speed: 0.0295s/iter; left time: 1186.2300s
	iters: 300, epoch: 3 | loss: 1.1392355
	speed: 0.0302s/iter; left time: 1212.4459s
	iters: 400, epoch: 3 | loss: 0.9326996
	speed: 0.0264s/iter; left time: 1056.3619s
Epoch: 3 cost time: 12.569020748138428
Epoch: 3, Steps: 413 | Train Loss: 0.218 Vali Loss: 0.459 Vali Acc: 0.955 Test Loss: 0.459 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000023
	speed: 0.1391s/iter; left time: 5558.9660s
	iters: 200, epoch: 4 | loss: 1.6683187
	speed: 0.0348s/iter; left time: 1388.1761s
	iters: 300, epoch: 4 | loss: 0.0000001
	speed: 0.0305s/iter; left time: 1214.5490s
	iters: 400, epoch: 4 | loss: 0.0128090
	speed: 0.0302s/iter; left time: 1199.0163s
Epoch: 4 cost time: 14.357641458511353
Epoch: 4, Steps: 413 | Train Loss: 0.209 Vali Loss: 0.457 Vali Acc: 0.963 Test Loss: 0.457 Test Acc: 0.963
Validation loss decreased (-0.960433 --> -0.963161).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9083613
	speed: 0.1437s/iter; left time: 5684.1243s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 1256.4960s
	iters: 300, epoch: 5 | loss: 0.2256249
	speed: 0.0306s/iter; left time: 1204.8293s
	iters: 400, epoch: 5 | loss: 0.0007497
	speed: 0.0356s/iter; left time: 1396.5696s
Epoch: 5 cost time: 14.382682800292969
Epoch: 5, Steps: 413 | Train Loss: 0.194 Vali Loss: 0.535 Vali Acc: 0.962 Test Loss: 0.535 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.1419s/iter; left time: 5552.4048s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 1269.3597s
	iters: 300, epoch: 6 | loss: 0.5200376
	speed: 0.0339s/iter; left time: 1321.7325s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 1366.4422s
Epoch: 6 cost time: 14.28997015953064
Epoch: 6, Steps: 413 | Train Loss: 0.196 Vali Loss: 0.627 Vali Acc: 0.967 Test Loss: 0.627 Test Acc: 0.967
Validation loss decreased (-0.963161 --> -0.967252).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1461s/iter; left time: 5657.3674s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1538.5241s
	iters: 300, epoch: 7 | loss: 0.1797945
	speed: 0.0438s/iter; left time: 1685.8416s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1746.0189s
Epoch: 7 cost time: 18.197149753570557
Epoch: 7, Steps: 413 | Train Loss: 0.241 Vali Loss: 0.745 Vali Acc: 0.965 Test Loss: 0.745 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1497s/iter; left time: 5735.4640s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1623.7508s
	iters: 300, epoch: 8 | loss: 1.1977005
	speed: 0.0461s/iter; left time: 1755.4145s
	iters: 400, epoch: 8 | loss: 1.3597556
	speed: 0.0461s/iter; left time: 1751.4535s
Epoch: 8 cost time: 18.702502489089966
Epoch: 8, Steps: 413 | Train Loss: 0.199 Vali Loss: 0.750 Vali Acc: 0.960 Test Loss: 0.750 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0036005
	speed: 0.1440s/iter; left time: 5455.7459s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1503.8206s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1725.2123s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1745.2694s
Epoch: 9 cost time: 18.002666473388672
Epoch: 9, Steps: 413 | Train Loss: 0.188 Vali Loss: 0.342 Vali Acc: 0.978 Test Loss: 0.342 Test Acc: 0.978
Validation loss decreased (-0.967252 --> -0.978168).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1588s/iter; left time: 5951.1208s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 1783.1630s
	iters: 300, epoch: 10 | loss: 0.1488780
	speed: 0.0466s/iter; left time: 1738.0457s
	iters: 400, epoch: 10 | loss: 0.3322646
	speed: 0.0462s/iter; left time: 1719.1088s
Epoch: 10 cost time: 19.879262685775757
Epoch: 10, Steps: 413 | Train Loss: 0.167 Vali Loss: 0.630 Vali Acc: 0.974 Test Loss: 0.630 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1534s/iter; left time: 5687.1794s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0502s/iter; left time: 1855.3143s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 1809.7445s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 1773.6398s
Epoch: 11 cost time: 21.151462078094482
Epoch: 11, Steps: 413 | Train Loss: 0.156 Vali Loss: 0.514 Vali Acc: 0.976 Test Loss: 0.514 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1641s/iter; left time: 6016.4450s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0501s/iter; left time: 1832.0279s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 1996.9681s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0613s/iter; left time: 2228.9814s
Epoch: 12 cost time: 23.0384681224823
Epoch: 12, Steps: 413 | Train Loss: 0.169 Vali Loss: 1.068 Vali Acc: 0.967 Test Loss: 1.068 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1857s/iter; left time: 6731.8061s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 2255.3498s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 1753.4765s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0465s/iter; left time: 1670.5276s
Epoch: 13 cost time: 22.839136600494385
Epoch: 13, Steps: 413 | Train Loss: 0.215 Vali Loss: 0.849 Vali Acc: 0.966 Test Loss: 0.849 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1722s/iter; left time: 6169.0168s
	iters: 200, epoch: 14 | loss: 0.0000065
	speed: 0.0572s/iter; left time: 2045.6392s
	iters: 300, epoch: 14 | loss: 0.5308427
	speed: 0.0508s/iter; left time: 1811.2040s
	iters: 400, epoch: 14 | loss: 0.2574761
	speed: 0.0459s/iter; left time: 1631.8124s
Epoch: 14 cost time: 22.801122188568115
Epoch: 14, Steps: 413 | Train Loss: 0.178 Vali Loss: 0.698 Vali Acc: 0.975 Test Loss: 0.698 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1622s/iter; left time: 5746.6762s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 1685.4572s
	iters: 300, epoch: 15 | loss: 0.0004460
	speed: 0.0477s/iter; left time: 1680.1119s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 1723.4698s
Epoch: 15 cost time: 20.250078916549683
Epoch: 15, Steps: 413 | Train Loss: 0.159 Vali Loss: 1.100 Vali Acc: 0.963 Test Loss: 1.100 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1529s/iter; left time: 5353.4402s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0408s/iter; left time: 1423.9813s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 1725.0061s
	iters: 400, epoch: 16 | loss: 1.5253644
	speed: 0.0471s/iter; left time: 1633.5317s
Epoch: 16 cost time: 18.908499002456665
Epoch: 16, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.924 Vali Acc: 0.969 Test Loss: 0.924 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1278s/iter; left time: 4420.1958s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0297s/iter; left time: 1024.4645s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0360s/iter; left time: 1238.1312s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 1181.2959s
Epoch: 17 cost time: 14.20614767074585
Epoch: 17, Steps: 413 | Train Loss: 0.154 Vali Loss: 1.096 Vali Acc: 0.971 Test Loss: 1.096 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1314s/iter; left time: 4492.5286s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0292s/iter; left time: 994.2316s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 983.0801s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 1225.7000s
Epoch: 18 cost time: 13.509411096572876
Epoch: 18, Steps: 413 | Train Loss: 0.138 Vali Loss: 1.199 Vali Acc: 0.971 Test Loss: 1.199 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1344s/iter; left time: 4537.2651s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 1494.7931s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 1638.3591s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 1530.5918s
Epoch: 19 cost time: 18.63198494911194
Epoch: 19, Steps: 413 | Train Loss: 0.079 Vali Loss: 1.033 Vali Acc: 0.971 Test Loss: 1.033 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 599882
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7530099
	speed: 0.0537s/iter; left time: 2214.1850s
	iters: 200, epoch: 1 | loss: 0.0131811
	speed: 0.0289s/iter; left time: 1187.6464s
	iters: 300, epoch: 1 | loss: 0.3988740
	speed: 0.0315s/iter; left time: 1292.3947s
	iters: 400, epoch: 1 | loss: 0.0012029
	speed: 0.0329s/iter; left time: 1344.3443s
Epoch: 1 cost time: 15.127933502197266
Epoch: 1, Steps: 413 | Train Loss: 0.422 Vali Loss: 0.289 Vali Acc: 0.951 Test Loss: 0.289 Test Acc: 0.951
Validation loss decreased (inf --> -0.950884).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0264756
	speed: 0.1211s/iter; left time: 4940.9955s
	iters: 200, epoch: 2 | loss: 0.0000400
	speed: 0.0304s/iter; left time: 1235.6944s
	iters: 300, epoch: 2 | loss: 0.1876793
	speed: 0.0303s/iter; left time: 1229.8197s
	iters: 400, epoch: 2 | loss: 0.0000094
	speed: 0.0286s/iter; left time: 1158.8538s
Epoch: 2 cost time: 13.0407075881958
Epoch: 2, Steps: 413 | Train Loss: 0.216 Vali Loss: 0.213 Vali Acc: 0.964 Test Loss: 0.213 Test Acc: 0.964
Validation loss decreased (-0.950884 --> -0.964072).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000049
	speed: 0.1191s/iter; left time: 4808.6617s
	iters: 200, epoch: 3 | loss: 0.7886571
	speed: 0.0287s/iter; left time: 1154.0655s
	iters: 300, epoch: 3 | loss: 0.0000658
	speed: 0.0255s/iter; left time: 1023.7729s
	iters: 400, epoch: 3 | loss: 0.0000023
	speed: 0.0275s/iter; left time: 1103.8357s
Epoch: 3 cost time: 12.02852988243103
Epoch: 3, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.795 Vali Acc: 0.927 Test Loss: 0.795 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0011241
	speed: 0.1210s/iter; left time: 4835.5924s
	iters: 200, epoch: 4 | loss: 0.0000056
	speed: 0.0301s/iter; left time: 1200.3335s
	iters: 300, epoch: 4 | loss: 0.0274842
	speed: 0.0281s/iter; left time: 1116.9880s
	iters: 400, epoch: 4 | loss: 0.0000011
	speed: 0.0265s/iter; left time: 1049.9394s
Epoch: 4 cost time: 12.243255853652954
Epoch: 4, Steps: 413 | Train Loss: 0.195 Vali Loss: 0.275 Vali Acc: 0.970 Test Loss: 0.275 Test Acc: 0.970
Validation loss decreased (-0.964072 --> -0.970438).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000018
	speed: 0.1095s/iter; left time: 4329.9904s
	iters: 200, epoch: 5 | loss: 0.0040265
	speed: 0.0226s/iter; left time: 890.7450s
	iters: 300, epoch: 5 | loss: 0.0981009
	speed: 0.0233s/iter; left time: 915.5132s
	iters: 400, epoch: 5 | loss: 0.5223900
	speed: 0.0235s/iter; left time: 923.1267s
Epoch: 5 cost time: 10.518125057220459
Epoch: 5, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.316 Vali Acc: 0.973 Test Loss: 0.316 Test Acc: 0.973
Validation loss decreased (-0.970438 --> -0.973166).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000679
	speed: 0.1519s/iter; left time: 5945.3711s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 1872.2953s
	iters: 300, epoch: 6 | loss: 0.5988028
	speed: 0.0494s/iter; left time: 1924.5567s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 2002.1498s
Epoch: 6 cost time: 20.84951114654541
Epoch: 6, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.411 Vali Acc: 0.971 Test Loss: 0.411 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0008258
	speed: 0.1578s/iter; left time: 6111.8908s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 1988.1289s
	iters: 300, epoch: 7 | loss: 0.0849527
	speed: 0.0530s/iter; left time: 2042.2319s
	iters: 400, epoch: 7 | loss: 0.0000006
	speed: 0.0542s/iter; left time: 2081.5113s
Epoch: 7 cost time: 22.008803844451904
Epoch: 7, Steps: 413 | Train Loss: 0.193 Vali Loss: 0.578 Vali Acc: 0.959 Test Loss: 0.578 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1437s/iter; left time: 5503.5224s
	iters: 200, epoch: 8 | loss: 0.6811890
	speed: 0.0431s/iter; left time: 1647.8682s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 1649.1690s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 1638.4082s
Epoch: 8 cost time: 18.09132671356201
Epoch: 8, Steps: 413 | Train Loss: 0.154 Vali Loss: 0.407 Vali Acc: 0.974 Test Loss: 0.407 Test Acc: 0.974
Validation loss decreased (-0.973166 --> -0.974075).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1410s/iter; left time: 5342.8598s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1753.7288s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 1735.1807s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 1511.5608s
Epoch: 9 cost time: 18.67901921272278
Epoch: 9, Steps: 413 | Train Loss: 0.174 Vali Loss: 0.459 Vali Acc: 0.973 Test Loss: 0.459 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1389s/iter; left time: 5208.2848s
	iters: 200, epoch: 10 | loss: 0.0000037
	speed: 0.0353s/iter; left time: 1321.2367s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0347s/iter; left time: 1294.9901s
	iters: 400, epoch: 10 | loss: 0.2059305
	speed: 0.0344s/iter; left time: 1279.0977s
Epoch: 10 cost time: 15.28148102760315
Epoch: 10, Steps: 413 | Train Loss: 0.131 Vali Loss: 0.793 Vali Acc: 0.961 Test Loss: 0.793 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1002174
	speed: 0.1471s/iter; left time: 5452.3175s
	iters: 200, epoch: 11 | loss: 0.0000006
	speed: 0.0448s/iter; left time: 1655.4943s
	iters: 300, epoch: 11 | loss: 0.0084821
	speed: 0.0439s/iter; left time: 1617.2211s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 1586.3849s
Epoch: 11 cost time: 18.53535223007202
Epoch: 11, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.620 Vali Acc: 0.975 Test Loss: 0.620 Test Acc: 0.975
Validation loss decreased (-0.974075 --> -0.974982).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1488s/iter; left time: 5455.3165s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 1996.0158s
	iters: 300, epoch: 12 | loss: 0.0045732
	speed: 0.0540s/iter; left time: 1968.4847s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 1982.7833s
Epoch: 12 cost time: 22.903573751449585
Epoch: 12, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.745 Vali Acc: 0.968 Test Loss: 0.745 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1583s/iter; left time: 5736.6986s
	iters: 200, epoch: 13 | loss: 1.6135600
	speed: 0.0537s/iter; left time: 1940.4904s
	iters: 300, epoch: 13 | loss: 0.0461865
	speed: 0.0531s/iter; left time: 1913.3353s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 1978.9029s
Epoch: 13 cost time: 22.439077138900757
Epoch: 13, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.658 Vali Acc: 0.970 Test Loss: 0.658 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1585s/iter; left time: 5679.1694s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0295s/iter; left time: 1053.3258s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 1290.3544s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 1264.5878s
Epoch: 14 cost time: 16.155229806900024
Epoch: 14, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.840 Vali Acc: 0.972 Test Loss: 0.840 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000033
	speed: 0.1237s/iter; left time: 4381.3791s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0251s/iter; left time: 887.8776s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0267s/iter; left time: 941.2366s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 994.3078s
Epoch: 15 cost time: 11.683537483215332
Epoch: 15, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.941 Vali Acc: 0.965 Test Loss: 0.941 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1191s/iter; left time: 4170.4524s
	iters: 200, epoch: 16 | loss: 0.0001880
	speed: 0.0302s/iter; left time: 1054.1971s
	iters: 300, epoch: 16 | loss: 0.0021052
	speed: 0.0333s/iter; left time: 1158.5449s
	iters: 400, epoch: 16 | loss: 0.0000099
	speed: 0.0303s/iter; left time: 1052.2962s
Epoch: 16 cost time: 13.642459869384766
Epoch: 16, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.645 Vali Acc: 0.976 Test Loss: 0.645 Test Acc: 0.976
Validation loss decreased (-0.974982 --> -0.976346).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1236s/iter; left time: 4275.5439s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 982.3077s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0327s/iter; left time: 1124.0474s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0317s/iter; left time: 1085.4664s
Epoch: 17 cost time: 13.059367656707764
Epoch: 17, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.601 Vali Acc: 0.972 Test Loss: 0.601 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000028
	speed: 0.1333s/iter; left time: 4557.5680s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 868.8358s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 988.3615s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 1050.6800s
Epoch: 18 cost time: 12.481787204742432
Epoch: 18, Steps: 413 | Train Loss: 0.129 Vali Loss: 1.159 Vali Acc: 0.962 Test Loss: 1.159 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0041932
	speed: 0.1310s/iter; left time: 4423.3221s
	iters: 200, epoch: 19 | loss: 0.0000005
	speed: 0.0413s/iter; left time: 1389.2832s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0409s/iter; left time: 1371.8910s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 1358.7474s
Epoch: 19 cost time: 17.102730989456177
Epoch: 19, Steps: 413 | Train Loss: 0.180 Vali Loss: 1.063 Vali Acc: 0.965 Test Loss: 1.063 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1449s/iter; left time: 4831.8920s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 1243.4560s
	iters: 300, epoch: 20 | loss: 0.0000030
	speed: 0.0421s/iter; left time: 1396.7948s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 1407.2508s
Epoch: 20 cost time: 17.371262311935425
Epoch: 20, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.806 Vali Acc: 0.975 Test Loss: 0.806 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1300s/iter; left time: 4281.9295s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 821.4778s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 855.2904s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0244s/iter; left time: 796.0358s
Epoch: 21 cost time: 11.318958044052124
Epoch: 21, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.808 Vali Acc: 0.966 Test Loss: 0.808 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000171
	speed: 0.1245s/iter; left time: 4048.3163s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0304s/iter; left time: 986.9697s
	iters: 300, epoch: 22 | loss: 0.0025122
	speed: 0.0344s/iter; left time: 1113.0617s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0317s/iter; left time: 1021.9193s
Epoch: 22 cost time: 14.053661108016968
Epoch: 22, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.816 Vali Acc: 0.975 Test Loss: 0.816 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1428s/iter; left time: 4585.9513s
	iters: 200, epoch: 23 | loss: 0.0000016
	speed: 0.0442s/iter; left time: 1416.3441s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 1401.6592s
	iters: 400, epoch: 23 | loss: 0.0011527
	speed: 0.0427s/iter; left time: 1358.2648s
Epoch: 23 cost time: 18.52063298225403
Epoch: 23, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.994 Vali Acc: 0.965 Test Loss: 0.994 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1462s/iter; left time: 4633.4305s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 1452.2469s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0465s/iter; left time: 1463.3100s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 1299.8643s
Epoch: 24 cost time: 18.884684562683105
Epoch: 24, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.951 Vali Acc: 0.967 Test Loss: 0.951 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1461s/iter; left time: 4571.5658s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 1367.0948s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 1394.5818s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1504.3373s
Epoch: 25 cost time: 19.2025146484375
Epoch: 25, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.785 Vali Acc: 0.976 Test Loss: 0.785 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1635s/iter; left time: 5048.9179s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 1594.1171s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 1569.9163s
	iters: 400, epoch: 26 | loss: 0.9271864
	speed: 0.0445s/iter; left time: 1362.0206s
Epoch: 26 cost time: 21.0111985206604
Epoch: 26, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.614 Vali Acc: 0.980 Test Loss: 0.614 Test Acc: 0.980
Validation loss decreased (-0.976346 --> -0.979985).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.4522151
	speed: 0.1387s/iter; left time: 4224.2331s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0505s/iter; left time: 1534.1420s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1533.9644s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0446s/iter; left time: 1345.0795s
Epoch: 27 cost time: 19.915725708007812
Epoch: 27, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.786 Vali Acc: 0.977 Test Loss: 0.786 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1430s/iter; left time: 4297.9761s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0382s/iter; left time: 1143.0584s
	iters: 300, epoch: 28 | loss: 1.4199705
	speed: 0.0410s/iter; left time: 1225.1610s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 1251.7507s
Epoch: 28 cost time: 17.49096441268921
Epoch: 28, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.716 Vali Acc: 0.982 Test Loss: 0.716 Test Acc: 0.982
Validation loss decreased (-0.979985 --> -0.982258).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1541s/iter; left time: 4566.2970s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 1262.1414s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 1279.6555s
	iters: 400, epoch: 29 | loss: 0.6188081
	speed: 0.0441s/iter; left time: 1293.2871s
Epoch: 29 cost time: 18.156648874282837
Epoch: 29, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.738 Vali Acc: 0.974 Test Loss: 0.738 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1526s/iter; left time: 4460.5189s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0397s/iter; left time: 1155.2079s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 1279.6739s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 1283.8787s
Epoch: 30 cost time: 17.99088740348816
Epoch: 30, Steps: 413 | Train Loss: 0.061 Vali Loss: 1.220 Vali Acc: 0.968 Test Loss: 1.220 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1389s/iter; left time: 4002.7431s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0304s/iter; left time: 871.4441s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0298s/iter; left time: 852.8801s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0330s/iter; left time: 939.9317s
Epoch: 31 cost time: 13.400430917739868
Epoch: 31, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.824 Vali Acc: 0.975 Test Loss: 0.824 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1361s/iter; left time: 3865.9691s
	iters: 200, epoch: 32 | loss: 0.0001395
	speed: 0.0347s/iter; left time: 981.6375s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 943.2335s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 1024.5002s
Epoch: 32 cost time: 14.794959783554077
Epoch: 32, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.756 Vali Acc: 0.975 Test Loss: 0.756 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1408s/iter; left time: 3938.9397s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 1144.3203s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 1230.1474s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 1145.3247s
Epoch: 33 cost time: 17.77865505218506
Epoch: 33, Steps: 413 | Train Loss: 0.107 Vali Loss: 1.060 Vali Acc: 0.973 Test Loss: 1.060 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1373s/iter; left time: 3786.5024s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0313s/iter; left time: 859.1685s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 946.9234s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 749.5242s
Epoch: 34 cost time: 13.785536050796509
Epoch: 34, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.839 Vali Acc: 0.975 Test Loss: 0.839 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1373s/iter; left time: 3728.4347s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 705.6042s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 905.9739s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 856.6409s
Epoch: 35 cost time: 13.601459980010986
Epoch: 35, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.639 Vali Acc: 0.983 Test Loss: 0.639 Test Acc: 0.983
Validation loss decreased (-0.982258 --> -0.982713).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.1253s/iter; left time: 3350.1798s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 763.9104s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0305s/iter; left time: 809.2013s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 737.9193s
Epoch: 36 cost time: 12.156802654266357
Epoch: 36, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.817 Vali Acc: 0.976 Test Loss: 0.817 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1306s/iter; left time: 3439.0689s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 758.3846s
	iters: 300, epoch: 37 | loss: 0.0000935
	speed: 0.0285s/iter; left time: 743.5132s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 806.0872s
Epoch: 37 cost time: 12.596001863479614
Epoch: 37, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.850 Vali Acc: 0.979 Test Loss: 0.850 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.1365s/iter; left time: 3537.5770s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 749.9827s
	iters: 300, epoch: 38 | loss: 0.6168255
	speed: 0.0290s/iter; left time: 745.1433s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 648.8298s
Epoch: 38 cost time: 12.67691421508789
Epoch: 38, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.707 Vali Acc: 0.981 Test Loss: 0.707 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.1255s/iter; left time: 3200.3416s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0304s/iter; left time: 772.1052s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 933.0312s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 1076.6759s
Epoch: 39 cost time: 15.362112998962402
Epoch: 39, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.720 Vali Acc: 0.977 Test Loss: 0.720 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.1758s/iter; left time: 4411.0259s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 1325.2524s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 1408.0859s
	iters: 400, epoch: 40 | loss: 0.8579479
	speed: 0.0572s/iter; left time: 1418.7020s
Epoch: 40 cost time: 23.6380832195282
Epoch: 40, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.551 Vali Acc: 0.981 Test Loss: 0.551 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.1760s/iter; left time: 4344.6784s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0466s/iter; left time: 1144.7106s
	iters: 300, epoch: 41 | loss: 0.6199977
	speed: 0.0451s/iter; left time: 1104.0073s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 1160.1586s
Epoch: 41 cost time: 19.89509081840515
Epoch: 41, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.607 Vali Acc: 0.980 Test Loss: 0.607 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.1704s/iter; left time: 4135.7192s
	iters: 200, epoch: 42 | loss: 0.0001215
	speed: 0.0478s/iter; left time: 1154.1718s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 1129.1535s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0475s/iter; left time: 1137.5763s
Epoch: 42 cost time: 20.67975902557373
Epoch: 42, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.638 Vali Acc: 0.976 Test Loss: 0.638 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.1620s/iter; left time: 3865.6937s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1204.6665s
	iters: 300, epoch: 43 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 1167.8450s
	iters: 400, epoch: 43 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 1127.6848s
Epoch: 43 cost time: 21.388237237930298
Epoch: 43, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.562 Vali Acc: 0.976 Test Loss: 0.562 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.1580s/iter; left time: 3704.4741s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 1075.7761s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.0502s/iter; left time: 1166.7955s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 1084.6275s
Epoch: 44 cost time: 20.7523136138916
Epoch: 44, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.683 Vali Acc: 0.981 Test Loss: 0.683 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.0000000
	speed: 0.1726s/iter; left time: 3974.5514s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 1503.0724s
	iters: 300, epoch: 45 | loss: 0.0000000
	speed: 0.0629s/iter; left time: 1436.3482s
	iters: 400, epoch: 45 | loss: 0.0000000
	speed: 0.0635s/iter; left time: 1442.2438s
Epoch: 45 cost time: 26.83228588104248
Epoch: 45, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.824 Vali Acc: 0.979 Test Loss: 0.824 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 467018
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0801721
	speed: 0.0797s/iter; left time: 3281.7610s
	iters: 200, epoch: 1 | loss: 0.4773169
	speed: 0.0575s/iter; left time: 2362.6916s
	iters: 300, epoch: 1 | loss: 0.0024428
	speed: 0.0593s/iter; left time: 2432.4935s
	iters: 400, epoch: 1 | loss: 0.0001193
	speed: 0.0630s/iter; left time: 2577.9086s
Epoch: 1 cost time: 26.61940836906433
Epoch: 1, Steps: 413 | Train Loss: 0.374 Vali Loss: 0.308 Vali Acc: 0.945 Test Loss: 0.308 Test Acc: 0.945
Validation loss decreased (inf --> -0.945427).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1082876
	speed: 0.1695s/iter; left time: 6914.2523s
	iters: 200, epoch: 2 | loss: 0.0000310
	speed: 0.0490s/iter; left time: 1994.1197s
	iters: 300, epoch: 2 | loss: 0.2361204
	speed: 0.0500s/iter; left time: 2030.2826s
	iters: 400, epoch: 2 | loss: 0.0173606
	speed: 0.0563s/iter; left time: 2279.3019s
Epoch: 2 cost time: 21.71998405456543
Epoch: 2, Steps: 413 | Train Loss: 0.203 Vali Loss: 0.388 Vali Acc: 0.948 Test Loss: 0.388 Test Acc: 0.948
Validation loss decreased (-0.945427 --> -0.948154).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000135
	speed: 0.1429s/iter; left time: 5768.3537s
	iters: 200, epoch: 3 | loss: 0.0008663
	speed: 0.0323s/iter; left time: 1300.6321s
	iters: 300, epoch: 3 | loss: 0.0000004
	speed: 0.0325s/iter; left time: 1304.3775s
	iters: 400, epoch: 3 | loss: 0.0125956
	speed: 0.0397s/iter; left time: 1590.9615s
Epoch: 3 cost time: 14.883180379867554
Epoch: 3, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.348 Vali Acc: 0.959 Test Loss: 0.348 Test Acc: 0.959
Validation loss decreased (-0.948154 --> -0.958614).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0020813
	speed: 0.1481s/iter; left time: 5919.1201s
	iters: 200, epoch: 4 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 1574.3187s
	iters: 300, epoch: 4 | loss: 0.0009109
	speed: 0.0385s/iter; left time: 1531.8620s
	iters: 400, epoch: 4 | loss: 0.0000688
	speed: 0.0418s/iter; left time: 1659.0310s
Epoch: 4 cost time: 16.900625705718994
Epoch: 4, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.471 Vali Acc: 0.956 Test Loss: 0.471 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5096811
	speed: 0.1544s/iter; left time: 6107.5636s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0400s/iter; left time: 1578.5152s
	iters: 300, epoch: 5 | loss: 0.0155100
	speed: 0.0412s/iter; left time: 1620.1070s
	iters: 400, epoch: 5 | loss: 0.0000017
	speed: 0.0426s/iter; left time: 1673.3524s
Epoch: 5 cost time: 16.974281072616577
Epoch: 5, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.375 Vali Acc: 0.970 Test Loss: 0.375 Test Acc: 0.970
Validation loss decreased (-0.958614 --> -0.969528).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000034
	speed: 0.1678s/iter; left time: 6567.4172s
	iters: 200, epoch: 6 | loss: 0.5295919
	speed: 0.0490s/iter; left time: 1914.3633s
	iters: 300, epoch: 6 | loss: 0.0000005
	speed: 0.0483s/iter; left time: 1880.0084s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0495s/iter; left time: 1922.3258s
Epoch: 6 cost time: 21.03454279899597
Epoch: 6, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.770 Vali Acc: 0.955 Test Loss: 0.770 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0028525
	speed: 0.1757s/iter; left time: 6804.1410s
	iters: 200, epoch: 7 | loss: 0.0032342
	speed: 0.0512s/iter; left time: 1978.3015s
	iters: 300, epoch: 7 | loss: 0.1747734
	speed: 0.0487s/iter; left time: 1876.4049s
	iters: 400, epoch: 7 | loss: 0.0001119
	speed: 0.0490s/iter; left time: 1884.3655s
Epoch: 7 cost time: 21.579885005950928
Epoch: 7, Steps: 413 | Train Loss: 0.154 Vali Loss: 0.420 Vali Acc: 0.972 Test Loss: 0.420 Test Acc: 0.972
Validation loss decreased (-0.969528 --> -0.972256).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000505
	speed: 0.1496s/iter; left time: 5732.8880s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 1208.4046s
	iters: 300, epoch: 8 | loss: 0.0000004
	speed: 0.0304s/iter; left time: 1159.6619s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0327s/iter; left time: 1243.7489s
Epoch: 8 cost time: 14.59462022781372
Epoch: 8, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.367 Vali Acc: 0.975 Test Loss: 0.367 Test Acc: 0.975
Validation loss decreased (-0.972256 --> -0.974530).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1964406
	speed: 0.1536s/iter; left time: 5822.6462s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 1491.5136s
	iters: 300, epoch: 9 | loss: 0.0000005
	speed: 0.0392s/iter; left time: 1476.7908s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 1390.1724s
Epoch: 9 cost time: 17.090043306350708
Epoch: 9, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.532 Vali Acc: 0.968 Test Loss: 0.532 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.7321190
	speed: 0.1430s/iter; left time: 5359.0307s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0323s/iter; left time: 1208.7966s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 1339.5167s
	iters: 400, epoch: 10 | loss: 0.0129096
	speed: 0.0349s/iter; left time: 1297.0506s
Epoch: 10 cost time: 14.368497610092163
Epoch: 10, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.662 Vali Acc: 0.965 Test Loss: 0.662 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.1435s/iter; left time: 5318.4105s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 1759.3837s
	iters: 300, epoch: 11 | loss: 0.0000638
	speed: 0.0437s/iter; left time: 1612.0008s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 1660.4313s
Epoch: 11 cost time: 18.193495988845825
Epoch: 11, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.363 Vali Acc: 0.975 Test Loss: 0.363 Test Acc: 0.975
Validation loss decreased (-0.974530 --> -0.974530).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000081
	speed: 0.1698s/iter; left time: 6223.5482s
	iters: 200, epoch: 12 | loss: 0.0000003
	speed: 0.0507s/iter; left time: 1852.3016s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 1824.4874s
	iters: 400, epoch: 12 | loss: 0.0000002
	speed: 0.0520s/iter; left time: 1891.4428s
Epoch: 12 cost time: 21.133788347244263
Epoch: 12, Steps: 413 | Train Loss: 0.148 Vali Loss: 0.450 Vali Acc: 0.971 Test Loss: 0.450 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1608s/iter; left time: 5829.4263s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 1558.5143s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 1616.5301s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 1593.8097s
Epoch: 13 cost time: 18.958378314971924
Epoch: 13, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.651 Vali Acc: 0.966 Test Loss: 0.651 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.1593008
	speed: 0.1653s/iter; left time: 5923.3020s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 1716.9394s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 1367.4005s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0452s/iter; left time: 1604.5750s
Epoch: 14 cost time: 19.78419280052185
Epoch: 14, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.446 Vali Acc: 0.977 Test Loss: 0.446 Test Acc: 0.977
Validation loss decreased (-0.974530 --> -0.976803).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1660s/iter; left time: 5878.9196s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 1549.1408s
	iters: 300, epoch: 15 | loss: 0.0004722
	speed: 0.0466s/iter; left time: 1639.5600s
	iters: 400, epoch: 15 | loss: 0.0000013
	speed: 0.0482s/iter; left time: 1691.7257s
Epoch: 15 cost time: 19.63091230392456
Epoch: 15, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.783 Vali Acc: 0.962 Test Loss: 0.783 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.6249206
	speed: 0.1592s/iter; left time: 5574.5268s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 1570.4909s
	iters: 300, epoch: 16 | loss: 0.0068906
	speed: 0.0501s/iter; left time: 1745.3954s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 1727.4190s
Epoch: 16 cost time: 19.850281238555908
Epoch: 16, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.480 Vali Acc: 0.975 Test Loss: 0.480 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1513s/iter; left time: 5232.8655s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 1618.7383s
	iters: 300, epoch: 17 | loss: 0.2272874
	speed: 0.0481s/iter; left time: 1654.6912s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0466s/iter; left time: 1597.7026s
Epoch: 17 cost time: 19.673601865768433
Epoch: 17, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.591 Vali Acc: 0.974 Test Loss: 0.591 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1501s/iter; left time: 5130.5521s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 1724.0438s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 1650.2287s
	iters: 400, epoch: 18 | loss: 0.0000082
	speed: 0.0540s/iter; left time: 1830.6755s
Epoch: 18 cost time: 20.80818462371826
Epoch: 18, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.712 Vali Acc: 0.976 Test Loss: 0.712 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1688s/iter; left time: 5699.0439s
	iters: 200, epoch: 19 | loss: 1.6069055
	speed: 0.0491s/iter; left time: 1653.5363s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 1405.0245s
	iters: 400, epoch: 19 | loss: 0.0024818
	speed: 0.0438s/iter; left time: 1465.3819s
Epoch: 19 cost time: 20.304187536239624
Epoch: 19, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.596 Vali Acc: 0.973 Test Loss: 0.596 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1619s/iter; left time: 5400.2818s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0404s/iter; left time: 1342.7436s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 1222.9455s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 1045.6348s
Epoch: 20 cost time: 17.25768256187439
Epoch: 20, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.545 Vali Acc: 0.971 Test Loss: 0.545 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1446s/iter; left time: 4764.6654s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 1145.2782s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 1148.0293s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 1166.3759s
Epoch: 21 cost time: 15.202379941940308
Epoch: 21, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.436 Vali Acc: 0.976 Test Loss: 0.436 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1446s/iter; left time: 4703.3979s
	iters: 200, epoch: 22 | loss: 0.0000002
	speed: 0.0362s/iter; left time: 1172.5427s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 1168.5610s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 1078.6086s
Epoch: 22 cost time: 15.456561803817749
Epoch: 22, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.556 Vali Acc: 0.974 Test Loss: 0.556 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1497s/iter; left time: 4806.0497s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0328s/iter; left time: 1049.3640s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 960.9117s
	iters: 400, epoch: 23 | loss: 0.0000732
	speed: 0.0360s/iter; left time: 1143.9881s
Epoch: 23 cost time: 14.336116075515747
Epoch: 23, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.734 Vali Acc: 0.976 Test Loss: 0.734 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1308s/iter; left time: 4146.2643s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 896.4792s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 947.5324s
	iters: 400, epoch: 24 | loss: 1.9128051
	speed: 0.0430s/iter; left time: 1348.9840s
Epoch: 24 cost time: 14.01385760307312
Epoch: 24, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.867 Vali Acc: 0.966 Test Loss: 0.867 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9768076398362893
model parameter : 384202
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0523734
	speed: 0.0652s/iter; left time: 2687.5431s
	iters: 200, epoch: 1 | loss: 0.8521454
	speed: 0.0398s/iter; left time: 1636.6765s
	iters: 300, epoch: 1 | loss: 0.8115240
	speed: 0.0371s/iter; left time: 1519.3230s
	iters: 400, epoch: 1 | loss: 0.3909112
	speed: 0.0446s/iter; left time: 1822.9882s
Epoch: 1 cost time: 19.641108512878418
Epoch: 1, Steps: 413 | Train Loss: 0.350 Vali Loss: 0.218 Vali Acc: 0.947 Test Loss: 0.218 Test Acc: 0.947
Validation loss decreased (inf --> -0.946792).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0107703
	speed: 0.1454s/iter; left time: 5930.4939s
	iters: 200, epoch: 2 | loss: 0.0241452
	speed: 0.0312s/iter; left time: 1269.7350s
	iters: 300, epoch: 2 | loss: 0.0002457
	speed: 0.0352s/iter; left time: 1429.9209s
	iters: 400, epoch: 2 | loss: 0.0013915
	speed: 0.0381s/iter; left time: 1543.3087s
Epoch: 2 cost time: 14.862308740615845
Epoch: 2, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.244 Vali Acc: 0.956 Test Loss: 0.244 Test Acc: 0.956
Validation loss decreased (-0.946792 --> -0.955887).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2133013
	speed: 0.1580s/iter; left time: 6378.8014s
	iters: 200, epoch: 3 | loss: 0.0000202
	speed: 0.0413s/iter; left time: 1662.7850s
	iters: 300, epoch: 3 | loss: 0.0066430
	speed: 0.0478s/iter; left time: 1921.0062s
	iters: 400, epoch: 3 | loss: 0.7365956
	speed: 0.0475s/iter; left time: 1902.0318s
Epoch: 3 cost time: 18.91005778312683
Epoch: 3, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.240 Vali Acc: 0.966 Test Loss: 0.240 Test Acc: 0.966
Validation loss decreased (-0.955887 --> -0.965891).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0042809
	speed: 0.1499s/iter; left time: 5991.6387s
	iters: 200, epoch: 4 | loss: 0.0040819
	speed: 0.0446s/iter; left time: 1778.8915s
	iters: 300, epoch: 4 | loss: 0.0000178
	speed: 0.0468s/iter; left time: 1859.3671s
	iters: 400, epoch: 4 | loss: 0.0000757
	speed: 0.0379s/iter; left time: 1504.7332s
Epoch: 4 cost time: 18.263286113739014
Epoch: 4, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.380 Vali Acc: 0.960 Test Loss: 0.380 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000017
	speed: 0.1423s/iter; left time: 5626.6028s
	iters: 200, epoch: 5 | loss: 0.0000016
	speed: 0.0338s/iter; left time: 1332.0039s
	iters: 300, epoch: 5 | loss: 0.0102569
	speed: 0.0401s/iter; left time: 1578.8617s
	iters: 400, epoch: 5 | loss: 0.1784247
	speed: 0.0371s/iter; left time: 1457.8085s
Epoch: 5 cost time: 15.845094919204712
Epoch: 5, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.235 Vali Acc: 0.970 Test Loss: 0.235 Test Acc: 0.970
Validation loss decreased (-0.965891 --> -0.969529).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000617
	speed: 0.1534s/iter; left time: 6001.7596s
	iters: 200, epoch: 6 | loss: 0.7231457
	speed: 0.0539s/iter; left time: 2102.9433s
	iters: 300, epoch: 6 | loss: 0.6837273
	speed: 0.0490s/iter; left time: 1908.2435s
	iters: 400, epoch: 6 | loss: 0.0013155
	speed: 0.0472s/iter; left time: 1832.4965s
Epoch: 6 cost time: 21.59581995010376
Epoch: 6, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.228 Vali Acc: 0.977 Test Loss: 0.228 Test Acc: 0.977
Validation loss decreased (-0.969529 --> -0.977260).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1621s/iter; left time: 6275.8708s
	iters: 200, epoch: 7 | loss: 0.0001207
	speed: 0.0501s/iter; left time: 1933.1117s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0489s/iter; left time: 1882.1827s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 1879.0023s
Epoch: 7 cost time: 21.012078285217285
Epoch: 7, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.396 Vali Acc: 0.972 Test Loss: 0.396 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1557s/iter; left time: 5963.6001s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 1554.1112s
	iters: 300, epoch: 8 | loss: 0.0004576
	speed: 0.0412s/iter; left time: 1569.6097s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 1680.2544s
Epoch: 8 cost time: 18.054566621780396
Epoch: 8, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.352 Vali Acc: 0.972 Test Loss: 0.352 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000016
	speed: 0.1611s/iter; left time: 6105.1420s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0430s/iter; left time: 1623.5928s
	iters: 300, epoch: 9 | loss: 0.0000128
	speed: 0.0442s/iter; left time: 1666.7585s
	iters: 400, epoch: 9 | loss: 0.0000120
	speed: 0.0431s/iter; left time: 1619.1616s
Epoch: 9 cost time: 18.26371145248413
Epoch: 9, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.307 Vali Acc: 0.974 Test Loss: 0.307 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1503s/iter; left time: 5632.7357s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 1422.6196s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0230s/iter; left time: 859.1927s
	iters: 400, epoch: 10 | loss: 0.3843802
	speed: 0.0272s/iter; left time: 1012.0097s
Epoch: 10 cost time: 13.530707836151123
Epoch: 10, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.486 Vali Acc: 0.957 Test Loss: 0.486 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1352s/iter; left time: 5012.7257s
	iters: 200, epoch: 11 | loss: 0.2431014
	speed: 0.0332s/iter; left time: 1227.2004s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 1219.8844s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 1069.7576s
Epoch: 11 cost time: 13.712905645370483
Epoch: 11, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.347 Vali Acc: 0.978 Test Loss: 0.347 Test Acc: 0.978
Validation loss decreased (-0.977260 --> -0.978168).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2451900
	speed: 0.1390s/iter; left time: 5094.7415s
	iters: 200, epoch: 12 | loss: 0.0658961
	speed: 0.0334s/iter; left time: 1220.3209s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0392s/iter; left time: 1429.1536s
	iters: 400, epoch: 12 | loss: 0.0000066
	speed: 0.0405s/iter; left time: 1472.3495s
Epoch: 12 cost time: 15.647974252700806
Epoch: 12, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.338 Vali Acc: 0.975 Test Loss: 0.338 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2819426
	speed: 0.1435s/iter; left time: 5199.9830s
	iters: 200, epoch: 13 | loss: 0.0000258
	speed: 0.0404s/iter; left time: 1459.4002s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0390s/iter; left time: 1406.4910s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0400s/iter; left time: 1437.9209s
Epoch: 13 cost time: 17.28841543197632
Epoch: 13, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.430 Vali Acc: 0.976 Test Loss: 0.430 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1440s/iter; left time: 5160.9080s
	iters: 200, epoch: 14 | loss: 0.2378897
	speed: 0.0386s/iter; left time: 1378.1974s
	iters: 300, epoch: 14 | loss: 0.0234862
	speed: 0.0286s/iter; left time: 1020.6985s
	iters: 400, epoch: 14 | loss: 0.0298360
	speed: 0.0297s/iter; left time: 1053.9074s
Epoch: 14 cost time: 14.695740938186646
Epoch: 14, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.542 Vali Acc: 0.967 Test Loss: 0.542 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1361s/iter; left time: 4819.8299s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0277s/iter; left time: 978.1373s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 1003.1531s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0298s/iter; left time: 1047.3449s
Epoch: 15 cost time: 12.482175588607788
Epoch: 15, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.425 Vali Acc: 0.970 Test Loss: 0.425 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1483s/iter; left time: 5192.2594s
	iters: 200, epoch: 16 | loss: 0.6235273
	speed: 0.0327s/iter; left time: 1142.7697s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 1143.8344s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0292s/iter; left time: 1014.4137s
Epoch: 16 cost time: 13.797815322875977
Epoch: 16, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.561 Vali Acc: 0.966 Test Loss: 0.561 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.4174444
	speed: 0.1389s/iter; left time: 4804.8612s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 1233.7124s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 1162.0347s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0337s/iter; left time: 1155.4074s
Epoch: 17 cost time: 14.68311882019043
Epoch: 17, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.473 Vali Acc: 0.977 Test Loss: 0.473 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1531s/iter; left time: 5232.4074s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0297s/iter; left time: 1013.7661s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 1147.1214s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 1391.4227s
Epoch: 18 cost time: 14.7455472946167
Epoch: 18, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.606 Vali Acc: 0.975 Test Loss: 0.606 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.3429889
	speed: 0.1568s/iter; left time: 5293.2967s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 1723.5421s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 1678.6507s
	iters: 400, epoch: 19 | loss: 0.2029581
	speed: 0.0525s/iter; left time: 1758.6760s
Epoch: 19 cost time: 21.848991870880127
Epoch: 19, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.495 Vali Acc: 0.969 Test Loss: 0.495 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1511s/iter; left time: 5040.2032s
	iters: 200, epoch: 20 | loss: 0.0000059
	speed: 0.0429s/iter; left time: 1426.4661s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 1515.6841s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0463s/iter; left time: 1530.8662s
Epoch: 20 cost time: 18.876681566238403
Epoch: 20, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.391 Vali Acc: 0.975 Test Loss: 0.391 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1578s/iter; left time: 5198.4363s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 1420.5241s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 1396.2197s
	iters: 400, epoch: 21 | loss: 0.0023969
	speed: 0.0404s/iter; left time: 1317.4858s
Epoch: 21 cost time: 17.903077363967896
Epoch: 21, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.510 Vali Acc: 0.977 Test Loss: 0.510 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 301514
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2171885
	speed: 0.0674s/iter; left time: 2777.3026s
	iters: 200, epoch: 1 | loss: 0.1034472
	speed: 0.0410s/iter; left time: 1685.8312s
	iters: 300, epoch: 1 | loss: 0.2013474
	speed: 0.0382s/iter; left time: 1567.2275s
	iters: 400, epoch: 1 | loss: 0.0083972
	speed: 0.0399s/iter; left time: 1632.7808s
Epoch: 1 cost time: 19.39481496810913
Epoch: 1, Steps: 413 | Train Loss: 0.345 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
Validation loss decreased (inf --> -0.959071).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0644883
	speed: 0.1428s/iter; left time: 5825.7018s
	iters: 200, epoch: 2 | loss: 0.0030015
	speed: 0.0395s/iter; left time: 1607.3639s
	iters: 300, epoch: 2 | loss: 0.0002777
	speed: 0.0358s/iter; left time: 1453.9915s
	iters: 400, epoch: 2 | loss: 0.7520309
	speed: 0.0345s/iter; left time: 1394.9047s
Epoch: 2 cost time: 15.803606986999512
Epoch: 2, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
Validation loss decreased (-0.959071 --> -0.963163).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0009037
	speed: 0.1461s/iter; left time: 5897.1010s
	iters: 200, epoch: 3 | loss: 0.0004084
	speed: 0.0462s/iter; left time: 1861.3819s
	iters: 300, epoch: 3 | loss: 0.0046604
	speed: 0.0483s/iter; left time: 1939.1479s
	iters: 400, epoch: 3 | loss: 0.0000026
	speed: 0.0514s/iter; left time: 2058.5057s
Epoch: 3 cost time: 20.262569189071655
Epoch: 3, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.211 Vali Acc: 0.963 Test Loss: 0.211 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1459077
	speed: 0.1636s/iter; left time: 6537.5372s
	iters: 200, epoch: 4 | loss: 1.0292330
	speed: 0.0484s/iter; left time: 1929.0512s
	iters: 300, epoch: 4 | loss: 0.1854111
	speed: 0.0359s/iter; left time: 1429.4147s
	iters: 400, epoch: 4 | loss: 1.3280412
	speed: 0.0392s/iter; left time: 1555.4394s
Epoch: 4 cost time: 18.28846788406372
Epoch: 4, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.261 Vali Acc: 0.963 Test Loss: 0.261 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000005
	speed: 0.1471s/iter; left time: 5815.8164s
	iters: 200, epoch: 5 | loss: 0.0000716
	speed: 0.0330s/iter; left time: 1300.3972s
	iters: 300, epoch: 5 | loss: 0.5658439
	speed: 0.0324s/iter; left time: 1275.6737s
	iters: 400, epoch: 5 | loss: 0.0000003
	speed: 0.0326s/iter; left time: 1281.0880s
Epoch: 5 cost time: 14.077686309814453
Epoch: 5, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.346 Vali Acc: 0.960 Test Loss: 0.346 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0004008
	speed: 0.1328s/iter; left time: 5196.8237s
	iters: 200, epoch: 6 | loss: 0.0000288
	speed: 0.0312s/iter; left time: 1218.0736s
	iters: 300, epoch: 6 | loss: 0.0000044
	speed: 0.0336s/iter; left time: 1309.0378s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 1313.0051s
Epoch: 6 cost time: 13.857279777526855
Epoch: 6, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.238 Vali Acc: 0.968 Test Loss: 0.238 Test Acc: 0.968
Validation loss decreased (-0.963163 --> -0.968165).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0111803
	speed: 0.1389s/iter; left time: 5379.6568s
	iters: 200, epoch: 7 | loss: 0.0000808
	speed: 0.0261s/iter; left time: 1009.5922s
	iters: 300, epoch: 7 | loss: 0.0162786
	speed: 0.0244s/iter; left time: 940.7347s
	iters: 400, epoch: 7 | loss: 0.0000631
	speed: 0.0265s/iter; left time: 1018.2673s
Epoch: 7 cost time: 11.29065465927124
Epoch: 7, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.400 Vali Acc: 0.961 Test Loss: 0.400 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000006
	speed: 0.1317s/iter; left time: 5044.9733s
	iters: 200, epoch: 8 | loss: 0.5259397
	speed: 0.0272s/iter; left time: 1039.4361s
	iters: 300, epoch: 8 | loss: 0.0001838
	speed: 0.0302s/iter; left time: 1150.3237s
	iters: 400, epoch: 8 | loss: 0.0063433
	speed: 0.0305s/iter; left time: 1160.8414s
Epoch: 8 cost time: 12.804027557373047
Epoch: 8, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.441 Vali Acc: 0.955 Test Loss: 0.441 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000061
	speed: 0.1384s/iter; left time: 5246.3199s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0326s/iter; left time: 1233.2366s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0337s/iter; left time: 1271.2399s
	iters: 400, epoch: 9 | loss: 0.9198995
	speed: 0.0405s/iter; left time: 1522.5059s
Epoch: 9 cost time: 15.168102979660034
Epoch: 9, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.353 Vali Acc: 0.966 Test Loss: 0.353 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000073
	speed: 0.1401s/iter; left time: 5250.7689s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 1425.5622s
	iters: 300, epoch: 10 | loss: 0.2295650
	speed: 0.0390s/iter; left time: 1454.2231s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 1530.4199s
Epoch: 10 cost time: 16.824453353881836
Epoch: 10, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.326 Vali Acc: 0.968 Test Loss: 0.326 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1383s/iter; left time: 5126.4463s
	iters: 200, epoch: 11 | loss: 0.0490761
	speed: 0.0414s/iter; left time: 1529.5008s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 1377.4913s
	iters: 400, epoch: 11 | loss: 0.0000029
	speed: 0.0273s/iter; left time: 1004.7651s
Epoch: 11 cost time: 15.023584365844727
Epoch: 11, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.346 Vali Acc: 0.971 Test Loss: 0.346 Test Acc: 0.971
Validation loss decreased (-0.968165 --> -0.971347).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.3240907
	speed: 0.1398s/iter; left time: 5124.6827s
	iters: 200, epoch: 12 | loss: 0.1024671
	speed: 0.0374s/iter; left time: 1366.8066s
	iters: 300, epoch: 12 | loss: 0.3727652
	speed: 0.0396s/iter; left time: 1443.3919s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0399s/iter; left time: 1450.7373s
Epoch: 12 cost time: 15.48171591758728
Epoch: 12, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.375 Vali Acc: 0.975 Test Loss: 0.375 Test Acc: 0.975
Validation loss decreased (-0.971347 --> -0.974530).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1439s/iter; left time: 5216.5524s
	iters: 200, epoch: 13 | loss: 0.4380843
	speed: 0.0377s/iter; left time: 1363.2904s
	iters: 300, epoch: 13 | loss: 0.0554981
	speed: 0.0395s/iter; left time: 1422.0665s
	iters: 400, epoch: 13 | loss: 0.0005300
	speed: 0.0388s/iter; left time: 1395.1764s
Epoch: 13 cost time: 16.8102867603302
Epoch: 13, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.339 Vali Acc: 0.974 Test Loss: 0.339 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0933061
	speed: 0.1462s/iter; left time: 5238.4596s
	iters: 200, epoch: 14 | loss: 0.0000441
	speed: 0.0380s/iter; left time: 1357.8984s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0401s/iter; left time: 1427.2394s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0413s/iter; left time: 1466.3249s
Epoch: 14 cost time: 17.1605441570282
Epoch: 14, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.297 Vali Acc: 0.976 Test Loss: 0.297 Test Acc: 0.976
Validation loss decreased (-0.974530 --> -0.976350).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1519s/iter; left time: 5381.7294s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1406.9700s
	iters: 300, epoch: 15 | loss: 0.4631320
	speed: 0.0420s/iter; left time: 1478.9660s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 1540.7717s
Epoch: 15 cost time: 17.79468059539795
Epoch: 15, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.282 Vali Acc: 0.974 Test Loss: 0.282 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0011772
	speed: 0.1464s/iter; left time: 5123.7361s
	iters: 200, epoch: 16 | loss: 0.0002101
	speed: 0.0470s/iter; left time: 1640.3429s
	iters: 300, epoch: 16 | loss: 0.0000044
	speed: 0.0488s/iter; left time: 1698.2792s
	iters: 400, epoch: 16 | loss: 1.3433685
	speed: 0.0455s/iter; left time: 1577.9335s
Epoch: 16 cost time: 19.364462852478027
Epoch: 16, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.590 Vali Acc: 0.958 Test Loss: 0.590 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1595s/iter; left time: 5517.6415s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 1694.6792s
	iters: 300, epoch: 17 | loss: 0.0000002
	speed: 0.0484s/iter; left time: 1663.6689s
	iters: 400, epoch: 17 | loss: 0.0066467
	speed: 0.0416s/iter; left time: 1425.8264s
Epoch: 17 cost time: 20.02311611175537
Epoch: 17, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.676 Vali Acc: 0.966 Test Loss: 0.676 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1595s/iter; left time: 5451.9021s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 1291.4873s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 1316.8659s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 1394.9487s
Epoch: 18 cost time: 16.87525701522827
Epoch: 18, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.342 Vali Acc: 0.975 Test Loss: 0.342 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1514s/iter; left time: 5113.4076s
	iters: 200, epoch: 19 | loss: 0.3359498
	speed: 0.0387s/iter; left time: 1304.3965s
	iters: 300, epoch: 19 | loss: 0.0000315
	speed: 0.0416s/iter; left time: 1395.5384s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 1445.6422s
Epoch: 19 cost time: 17.005459785461426
Epoch: 19, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.529 Vali Acc: 0.970 Test Loss: 0.529 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1409s/iter; left time: 4699.7926s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 1024.5702s
	iters: 300, epoch: 20 | loss: 0.0002701
	speed: 0.0294s/iter; left time: 975.3434s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0307s/iter; left time: 1013.2686s
Epoch: 20 cost time: 12.992368698120117
Epoch: 20, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.672 Vali Acc: 0.962 Test Loss: 0.672 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000007
	speed: 0.1522s/iter; left time: 5013.3980s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0299s/iter; left time: 983.1049s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0296s/iter; left time: 967.5215s
	iters: 400, epoch: 21 | loss: 1.0127411
	speed: 0.0378s/iter; left time: 1233.0089s
Epoch: 21 cost time: 14.646178483963013
Epoch: 21, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.406 Vali Acc: 0.971 Test Loss: 0.406 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1452s/iter; left time: 4721.7423s
	iters: 200, epoch: 22 | loss: 0.0000225
	speed: 0.0298s/iter; left time: 966.4821s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 1170.2188s
	iters: 400, epoch: 22 | loss: 0.0523236
	speed: 0.0338s/iter; left time: 1089.9057s
Epoch: 22 cost time: 14.301603078842163
Epoch: 22, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.344 Vali Acc: 0.980 Test Loss: 0.344 Test Acc: 0.980
Validation loss decreased (-0.976350 --> -0.979533).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1197s/iter; left time: 3843.6107s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 964.5354s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0288s/iter; left time: 918.7953s
	iters: 400, epoch: 23 | loss: 0.0014003
	speed: 0.0278s/iter; left time: 885.3508s
Epoch: 23 cost time: 12.449313879013062
Epoch: 23, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.584 Vali Acc: 0.967 Test Loss: 0.584 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1327s/iter; left time: 4206.5831s
	iters: 200, epoch: 24 | loss: 0.0000049
	speed: 0.0280s/iter; left time: 883.5833s
	iters: 300, epoch: 24 | loss: 0.0000043
	speed: 0.0319s/iter; left time: 1006.3408s
	iters: 400, epoch: 24 | loss: 1.1095448
	speed: 0.0351s/iter; left time: 1102.4710s
Epoch: 24 cost time: 13.445575952529907
Epoch: 24, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.574 Vali Acc: 0.970 Test Loss: 0.574 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.5039705
	speed: 0.1396s/iter; left time: 4366.5905s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 1201.2812s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 1123.9800s
	iters: 400, epoch: 25 | loss: 0.4009465
	speed: 0.0351s/iter; left time: 1087.9392s
Epoch: 25 cost time: 15.754539012908936
Epoch: 25, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.411 Vali Acc: 0.973 Test Loss: 0.411 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1527s/iter; left time: 4715.2203s
	iters: 200, epoch: 26 | loss: 0.6510712
	speed: 0.0334s/iter; left time: 1027.9329s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 900.1874s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 896.8216s
Epoch: 26 cost time: 14.22471022605896
Epoch: 26, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.470 Vali Acc: 0.975 Test Loss: 0.470 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000059
	speed: 0.1461s/iter; left time: 4449.6544s
	iters: 200, epoch: 27 | loss: 0.6296014
	speed: 0.0292s/iter; left time: 885.9646s
	iters: 300, epoch: 27 | loss: 0.0000001
	speed: 0.0308s/iter; left time: 931.8890s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0314s/iter; left time: 948.0515s
Epoch: 27 cost time: 13.048584938049316
Epoch: 27, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.544 Vali Acc: 0.969 Test Loss: 0.544 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 1.0424178
	speed: 0.1458s/iter; left time: 4381.7209s
	iters: 200, epoch: 28 | loss: 0.0007547
	speed: 0.0373s/iter; left time: 1118.6105s
	iters: 300, epoch: 28 | loss: 1.2846973
	speed: 0.0352s/iter; left time: 1051.9346s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 1068.1329s
Epoch: 28 cost time: 15.826031684875488
Epoch: 28, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.489 Vali Acc: 0.973 Test Loss: 0.489 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000007
	speed: 0.1295s/iter; left time: 3837.4626s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0386s/iter; left time: 1140.9653s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0393s/iter; left time: 1158.1192s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0376s/iter; left time: 1101.6875s
Epoch: 29 cost time: 15.675365924835205
Epoch: 29, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.600 Vali Acc: 0.972 Test Loss: 0.600 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1303s/iter; left time: 3808.4796s
	iters: 200, epoch: 30 | loss: 0.0000082
	speed: 0.0209s/iter; left time: 608.1122s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0217s/iter; left time: 630.0981s
	iters: 400, epoch: 30 | loss: 0.0002222
	speed: 0.0237s/iter; left time: 684.7425s
Epoch: 30 cost time: 10.02316403388977
Epoch: 30, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.566 Vali Acc: 0.972 Test Loss: 0.566 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1117s/iter; left time: 3218.7913s
	iters: 200, epoch: 31 | loss: 0.1770387
	speed: 0.0227s/iter; left time: 652.7162s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 729.4850s
	iters: 400, epoch: 31 | loss: 0.0000468
	speed: 0.0236s/iter; left time: 673.7118s
Epoch: 31 cost time: 10.48024845123291
Epoch: 31, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.446 Vali Acc: 0.977 Test Loss: 0.446 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1347s/iter; left time: 3826.4286s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 1306.2570s
	iters: 300, epoch: 32 | loss: 0.0000037
	speed: 0.0354s/iter; left time: 997.0157s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0390s/iter; left time: 1095.1859s
Epoch: 32 cost time: 17.653926134109497
Epoch: 32, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.661 Vali Acc: 0.967 Test Loss: 0.661 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 235594
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3704886
	speed: 0.0585s/iter; left time: 2410.2986s
	iters: 200, epoch: 1 | loss: 0.0129229
	speed: 0.0386s/iter; left time: 1586.6147s
	iters: 300, epoch: 1 | loss: 0.0394196
	speed: 0.0364s/iter; left time: 1490.5066s
	iters: 400, epoch: 1 | loss: 0.0949570
	speed: 0.0347s/iter; left time: 1420.0521s
Epoch: 1 cost time: 17.317296028137207
Epoch: 1, Steps: 413 | Train Loss: 0.360 Vali Loss: 0.117 Vali Acc: 0.964 Test Loss: 0.117 Test Acc: 0.964
Validation loss decreased (inf --> -0.964073).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0053566
	speed: 0.1434s/iter; left time: 5850.4049s
	iters: 200, epoch: 2 | loss: 0.6559166
	speed: 0.0363s/iter; left time: 1475.4132s
	iters: 300, epoch: 2 | loss: 0.0278470
	speed: 0.0339s/iter; left time: 1375.5446s
	iters: 400, epoch: 2 | loss: 0.0063413
	speed: 0.0323s/iter; left time: 1307.2016s
Epoch: 2 cost time: 15.00729489326477
Epoch: 2, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
Validation loss decreased (-0.964073 --> -0.971349).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0018186
	speed: 0.1384s/iter; left time: 5586.7312s
	iters: 200, epoch: 3 | loss: 0.0714441
	speed: 0.0364s/iter; left time: 1467.3345s
	iters: 300, epoch: 3 | loss: 0.0240494
	speed: 0.0345s/iter; left time: 1386.7537s
	iters: 400, epoch: 3 | loss: 0.0007532
	speed: 0.0316s/iter; left time: 1267.2793s
Epoch: 3 cost time: 15.366698980331421
Epoch: 3, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.258 Vali Acc: 0.954 Test Loss: 0.258 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0212167
	speed: 0.1591s/iter; left time: 6359.1674s
	iters: 200, epoch: 4 | loss: 0.0001301
	speed: 0.0427s/iter; left time: 1701.3911s
	iters: 300, epoch: 4 | loss: 0.4663448
	speed: 0.0431s/iter; left time: 1714.4171s
	iters: 400, epoch: 4 | loss: 0.0485028
	speed: 0.0447s/iter; left time: 1771.0462s
Epoch: 4 cost time: 18.60164165496826
Epoch: 4, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.299 Vali Acc: 0.951 Test Loss: 0.299 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000202
	speed: 0.1338s/iter; left time: 5291.1275s
	iters: 200, epoch: 5 | loss: 0.0210582
	speed: 0.0373s/iter; left time: 1469.8914s
	iters: 300, epoch: 5 | loss: 0.2133821
	speed: 0.0413s/iter; left time: 1626.7200s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 1736.7233s
Epoch: 5 cost time: 17.083991050720215
Epoch: 5, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
Validation loss decreased (-0.971349 --> -0.982264).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0001714
	speed: 0.1147s/iter; left time: 4487.3898s
	iters: 200, epoch: 6 | loss: 0.0011933
	speed: 0.0264s/iter; left time: 1029.0840s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0243s/iter; left time: 946.9331s
	iters: 400, epoch: 6 | loss: 0.0000003
	speed: 0.0219s/iter; left time: 849.8289s
Epoch: 6 cost time: 10.575507640838623
Epoch: 6, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1451604
	speed: 0.1119s/iter; left time: 4334.6693s
	iters: 200, epoch: 7 | loss: 0.0140983
	speed: 0.0265s/iter; left time: 1021.6504s
	iters: 300, epoch: 7 | loss: 0.0002137
	speed: 0.0220s/iter; left time: 847.6007s
	iters: 400, epoch: 7 | loss: 0.1630122
	speed: 0.0247s/iter; left time: 948.4650s
Epoch: 7 cost time: 10.603558778762817
Epoch: 7, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.265 Vali Acc: 0.975 Test Loss: 0.265 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1235s/iter; left time: 4730.1818s
	iters: 200, epoch: 8 | loss: 0.0001195
	speed: 0.0257s/iter; left time: 983.1604s
	iters: 300, epoch: 8 | loss: 0.0000017
	speed: 0.0248s/iter; left time: 945.6008s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 998.1061s
Epoch: 8 cost time: 11.288345575332642
Epoch: 8, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.239 Vali Acc: 0.969 Test Loss: 0.239 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000050
	speed: 0.1138s/iter; left time: 4313.7302s
	iters: 200, epoch: 9 | loss: 0.0001102
	speed: 0.0233s/iter; left time: 879.6309s
	iters: 300, epoch: 9 | loss: 0.0000002
	speed: 0.0259s/iter; left time: 977.0041s
	iters: 400, epoch: 9 | loss: 0.0001698
	speed: 0.0242s/iter; left time: 909.1872s
Epoch: 9 cost time: 10.66300368309021
Epoch: 9, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.166 Vali Acc: 0.977 Test Loss: 0.166 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3585775
	speed: 0.1136s/iter; left time: 4256.5498s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0195s/iter; left time: 730.1652s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0199s/iter; left time: 741.2118s
	iters: 400, epoch: 10 | loss: 0.2010952
	speed: 0.0216s/iter; left time: 803.6986s
Epoch: 10 cost time: 9.24121642112732
Epoch: 10, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.407 Vali Acc: 0.966 Test Loss: 0.407 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0012850
	speed: 0.1085s/iter; left time: 4022.6344s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0243s/iter; left time: 896.6134s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0321s/iter; left time: 1184.9365s
	iters: 400, epoch: 11 | loss: 0.0000347
	speed: 0.0333s/iter; left time: 1226.0443s
Epoch: 11 cost time: 12.45501971244812
Epoch: 11, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.237 Vali Acc: 0.976 Test Loss: 0.237 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000002
	speed: 0.1303s/iter; left time: 4775.0954s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 1214.1802s
	iters: 300, epoch: 12 | loss: 2.2054026
	speed: 0.0324s/iter; left time: 1179.8624s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0343s/iter; left time: 1248.2823s
Epoch: 12 cost time: 14.30408239364624
Epoch: 12, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.286 Vali Acc: 0.976 Test Loss: 0.286 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.1282s/iter; left time: 4646.7205s
	iters: 200, epoch: 13 | loss: 0.0011204
	speed: 0.0274s/iter; left time: 990.6260s
	iters: 300, epoch: 13 | loss: 0.0000132
	speed: 0.0262s/iter; left time: 943.6201s
	iters: 400, epoch: 13 | loss: 0.2623097
	speed: 0.0253s/iter; left time: 909.1155s
Epoch: 13 cost time: 11.70937705039978
Epoch: 13, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.267 Vali Acc: 0.976 Test Loss: 0.267 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000416
	speed: 0.1400s/iter; left time: 5015.1381s
	iters: 200, epoch: 14 | loss: 0.0000011
	speed: 0.0350s/iter; left time: 1252.1989s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0332s/iter; left time: 1183.5962s
	iters: 400, epoch: 14 | loss: 0.0000009
	speed: 0.0351s/iter; left time: 1246.5172s
Epoch: 14 cost time: 14.7806077003479
Epoch: 14, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.321 Vali Acc: 0.976 Test Loss: 0.321 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.1365s/iter; left time: 4833.0643s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 1238.3178s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 1273.9727s
	iters: 400, epoch: 15 | loss: 0.0089606
	speed: 0.0349s/iter; left time: 1226.5530s
Epoch: 15 cost time: 15.12856674194336
Epoch: 15, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.453 Vali Acc: 0.970 Test Loss: 0.453 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm128_nh16_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 202954
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0679942
	speed: 0.0715s/iter; left time: 2944.7197s
	iters: 200, epoch: 1 | loss: 0.2999356
	speed: 0.0439s/iter; left time: 1806.1519s
	iters: 300, epoch: 1 | loss: 0.4904979
	speed: 0.0423s/iter; left time: 1732.5476s
	iters: 400, epoch: 1 | loss: 0.8166016
	speed: 0.0427s/iter; left time: 1745.6793s
Epoch: 1 cost time: 20.605624198913574
Epoch: 1, Steps: 413 | Train Loss: 0.429 Vali Loss: 0.328 Vali Acc: 0.942 Test Loss: 0.328 Test Acc: 0.942
Validation loss decreased (inf --> -0.941788).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0300361
	speed: 0.1695s/iter; left time: 6913.1147s
	iters: 200, epoch: 2 | loss: 0.0295811
	speed: 0.0556s/iter; left time: 2260.7229s
	iters: 300, epoch: 2 | loss: 0.0741357
	speed: 0.0543s/iter; left time: 2203.0401s
	iters: 400, epoch: 2 | loss: 0.4046389
	speed: 0.0547s/iter; left time: 2215.5101s
Epoch: 2 cost time: 23.114807844161987
Epoch: 2, Steps: 413 | Train Loss: 0.263 Vali Loss: 0.506 Vali Acc: 0.945 Test Loss: 0.506 Test Acc: 0.945
Validation loss decreased (-0.941788 --> -0.945425).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0031566
	speed: 0.1798s/iter; left time: 7258.2456s
	iters: 200, epoch: 3 | loss: 0.0012703
	speed: 0.0576s/iter; left time: 2320.8539s
	iters: 300, epoch: 3 | loss: 0.0775531
	speed: 0.0577s/iter; left time: 2316.3147s
	iters: 400, epoch: 3 | loss: 0.6927213
	speed: 0.0542s/iter; left time: 2170.0835s
Epoch: 3 cost time: 23.683611631393433
Epoch: 3, Steps: 413 | Train Loss: 0.142 Vali Loss: 0.542 Vali Acc: 0.948 Test Loss: 0.542 Test Acc: 0.948
Validation loss decreased (-0.945425 --> -0.948153).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0001175
	speed: 0.1625s/iter; left time: 6493.9921s
	iters: 200, epoch: 4 | loss: 0.0000002
	speed: 0.0472s/iter; left time: 1882.1671s
	iters: 300, epoch: 4 | loss: 0.0004971
	speed: 0.0339s/iter; left time: 1345.9497s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 1374.1033s
Epoch: 4 cost time: 17.239553689956665
Epoch: 4, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.462 Vali Acc: 0.964 Test Loss: 0.462 Test Acc: 0.964
Validation loss decreased (-0.948153 --> -0.964070).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8105051
	speed: 0.1394s/iter; left time: 5514.7129s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0322s/iter; left time: 1271.0587s
	iters: 300, epoch: 5 | loss: 0.0332306
	speed: 0.0365s/iter; left time: 1438.1244s
	iters: 400, epoch: 5 | loss: 0.0003565
	speed: 0.0351s/iter; left time: 1377.7676s
Epoch: 5 cost time: 14.727009057998657
Epoch: 5, Steps: 413 | Train Loss: 0.147 Vali Loss: 0.558 Vali Acc: 0.960 Test Loss: 0.558 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.1329s/iter; left time: 5202.6597s
	iters: 200, epoch: 6 | loss: 0.0008028
	speed: 0.0336s/iter; left time: 1313.3886s
	iters: 300, epoch: 6 | loss: 0.8435047
	speed: 0.0274s/iter; left time: 1067.5774s
	iters: 400, epoch: 6 | loss: 0.0000448
	speed: 0.0305s/iter; left time: 1186.2313s
Epoch: 6 cost time: 13.330788135528564
Epoch: 6, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.428 Vali Acc: 0.968 Test Loss: 0.428 Test Acc: 0.968
Validation loss decreased (-0.964070 --> -0.967708).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1243s/iter; left time: 4813.1129s
	iters: 200, epoch: 7 | loss: 0.0000184
	speed: 0.0277s/iter; left time: 1071.1860s
	iters: 300, epoch: 7 | loss: 0.6999571
	speed: 0.0271s/iter; left time: 1045.0289s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 1087.6041s
Epoch: 7 cost time: 12.156141996383667
Epoch: 7, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.347 Vali Acc: 0.969 Test Loss: 0.347 Test Acc: 0.969
Validation loss decreased (-0.967708 --> -0.969073).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000005
	speed: 0.1315s/iter; left time: 5039.3644s
	iters: 200, epoch: 8 | loss: 0.0386326
	speed: 0.0410s/iter; left time: 1568.2499s
	iters: 300, epoch: 8 | loss: 0.0804614
	speed: 0.0451s/iter; left time: 1716.9678s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 1680.9564s
Epoch: 8 cost time: 18.232478141784668
Epoch: 8, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.748 Vali Acc: 0.955 Test Loss: 0.748 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1572s/iter; left time: 5957.9511s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 1807.5152s
	iters: 300, epoch: 9 | loss: 0.9956448
	speed: 0.0492s/iter; left time: 1855.1939s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 1671.1735s
Epoch: 9 cost time: 19.658287286758423
Epoch: 9, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.817 Vali Acc: 0.960 Test Loss: 0.817 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1469s/iter; left time: 5507.3728s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 1326.3438s
	iters: 300, epoch: 10 | loss: 0.3082325
	speed: 0.0336s/iter; left time: 1251.0099s
	iters: 400, epoch: 10 | loss: 0.0000212
	speed: 0.0351s/iter; left time: 1306.3338s
Epoch: 10 cost time: 14.671544551849365
Epoch: 10, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.971 Vali Acc: 0.959 Test Loss: 0.971 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000094
	speed: 0.1428s/iter; left time: 5293.9087s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0303s/iter; left time: 1120.5756s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0255s/iter; left time: 938.8352s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0347s/iter; left time: 1274.8381s
Epoch: 11 cost time: 13.423384189605713
Epoch: 11, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.591 Vali Acc: 0.967 Test Loss: 0.591 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1411s/iter; left time: 5171.3798s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 1528.1339s
	iters: 300, epoch: 12 | loss: 0.0000172
	speed: 0.0425s/iter; left time: 1548.0015s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 1582.5190s
Epoch: 12 cost time: 17.790741443634033
Epoch: 12, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.493 Vali Acc: 0.971 Test Loss: 0.493 Test Acc: 0.971
Validation loss decreased (-0.969073 --> -0.971346).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1527s/iter; left time: 5535.2998s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 1538.1267s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 1716.7573s
	iters: 400, epoch: 13 | loss: 0.6410015
	speed: 0.0448s/iter; left time: 1609.4335s
Epoch: 13 cost time: 18.9523983001709
Epoch: 13, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.840 Vali Acc: 0.963 Test Loss: 0.840 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.6765259
	speed: 0.1800s/iter; left time: 6451.3012s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0555s/iter; left time: 1981.5413s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 1953.9565s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 1976.8239s
Epoch: 14 cost time: 22.721524238586426
Epoch: 14, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.885 Vali Acc: 0.965 Test Loss: 0.885 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.3022682
	speed: 0.1810s/iter; left time: 6409.1859s
	iters: 200, epoch: 15 | loss: 0.1752130
	speed: 0.0532s/iter; left time: 1877.7719s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0495s/iter; left time: 1744.0796s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1660.7219s
Epoch: 15 cost time: 21.700740575790405
Epoch: 15, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.804 Vali Acc: 0.958 Test Loss: 0.804 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1597s/iter; left time: 5588.8783s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 1510.7717s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 1537.8719s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 1593.9190s
Epoch: 16 cost time: 19.051533222198486
Epoch: 16, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.776 Vali Acc: 0.967 Test Loss: 0.776 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1640s/iter; left time: 5674.5535s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0447s/iter; left time: 1540.5903s
	iters: 300, epoch: 17 | loss: 0.0000005
	speed: 0.0446s/iter; left time: 1534.7847s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 1648.4970s
Epoch: 17 cost time: 19.393650770187378
Epoch: 17, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.677 Vali Acc: 0.971 Test Loss: 0.677 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1482s/iter; left time: 5064.5898s
	iters: 200, epoch: 18 | loss: 0.0000590
	speed: 0.0299s/iter; left time: 1019.5258s
	iters: 300, epoch: 18 | loss: 0.1383191
	speed: 0.0321s/iter; left time: 1092.3457s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0326s/iter; left time: 1106.1059s
Epoch: 18 cost time: 14.009682655334473
Epoch: 18, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.894 Vali Acc: 0.962 Test Loss: 0.894 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1350s/iter; left time: 4557.9081s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 940.8688s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0317s/iter; left time: 1063.4234s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 1113.9244s
Epoch: 19 cost time: 13.176576614379883
Epoch: 19, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.705 Vali Acc: 0.970 Test Loss: 0.705 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1290s/iter; left time: 4301.6316s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0312s/iter; left time: 1037.5644s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 1390.7196s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 1254.3117s
Epoch: 20 cost time: 15.154387712478638
Epoch: 20, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.718 Vali Acc: 0.971 Test Loss: 0.718 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1632s/iter; left time: 5376.6062s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0453s/iter; left time: 1486.1081s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 1398.6728s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1300.4072s
Epoch: 21 cost time: 18.35026240348816
Epoch: 21, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.693 Vali Acc: 0.970 Test Loss: 0.693 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1564s/iter; left time: 5086.4877s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0309s/iter; left time: 1001.8676s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 1049.1573s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 1108.7687s
Epoch: 22 cost time: 14.756385326385498
Epoch: 22, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.695 Vali Acc: 0.973 Test Loss: 0.695 Test Acc: 0.973
Validation loss decreased (-0.971346 --> -0.973163).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000067
	speed: 0.1477s/iter; left time: 4741.9921s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 1108.1359s
	iters: 300, epoch: 23 | loss: 0.0710078
	speed: 0.0349s/iter; left time: 1113.2035s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 1131.5673s
Epoch: 23 cost time: 15.119468688964844
Epoch: 23, Steps: 413 | Train Loss: 0.066 Vali Loss: 1.072 Vali Acc: 0.961 Test Loss: 1.072 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0002074
	speed: 0.1375s/iter; left time: 4357.4525s
	iters: 200, epoch: 24 | loss: 0.0000237
	speed: 0.0321s/iter; left time: 1013.8693s
	iters: 300, epoch: 24 | loss: 0.0018628
	speed: 0.0311s/iter; left time: 978.9772s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 991.8102s
Epoch: 24 cost time: 13.91677975654602
Epoch: 24, Steps: 413 | Train Loss: 0.065 Vali Loss: 1.029 Vali Acc: 0.965 Test Loss: 1.029 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1526s/iter; left time: 4775.6238s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 1483.0640s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 1513.7248s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0465s/iter; left time: 1442.1246s
Epoch: 25 cost time: 20.0677170753479
Epoch: 25, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.748 Vali Acc: 0.969 Test Loss: 0.748 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1712s/iter; left time: 5286.6476s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0550s/iter; left time: 1692.2368s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 1753.5212s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 1661.8146s
Epoch: 26 cost time: 23.262666940689087
Epoch: 26, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.784 Vali Acc: 0.964 Test Loss: 0.784 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1775s/iter; left time: 5406.8233s
	iters: 200, epoch: 27 | loss: 0.9872216
	speed: 0.0548s/iter; left time: 1662.6668s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 1722.5631s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0542s/iter; left time: 1636.2661s
Epoch: 27 cost time: 23.35407829284668
Epoch: 27, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.808 Vali Acc: 0.962 Test Loss: 0.808 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1573s/iter; left time: 4727.6819s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 1148.4707s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0376s/iter; left time: 1122.8016s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 1158.0167s
Epoch: 28 cost time: 16.602367401123047
Epoch: 28, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.658 Vali Acc: 0.969 Test Loss: 0.658 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1682s/iter; left time: 4984.5613s
	iters: 200, epoch: 29 | loss: 0.4001884
	speed: 0.0451s/iter; left time: 1331.3658s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1346.8667s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 1350.6679s
Epoch: 29 cost time: 19.800880908966064
Epoch: 29, Steps: 413 | Train Loss: 0.061 Vali Loss: 1.392 Vali Acc: 0.951 Test Loss: 1.392 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1620s/iter; left time: 4735.3056s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 1312.2963s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 1216.7132s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 1272.7333s
Epoch: 30 cost time: 18.81818699836731
Epoch: 30, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.758 Vali Acc: 0.970 Test Loss: 0.758 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1659s/iter; left time: 4779.4438s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1235.3044s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 861.9007s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0326s/iter; left time: 929.9091s
Epoch: 31 cost time: 16.126961946487427
Epoch: 31, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.706 Vali Acc: 0.972 Test Loss: 0.706 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1475s/iter; left time: 4187.6461s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0387s/iter; left time: 1094.8895s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 1053.7711s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 1048.2499s
Epoch: 32 cost time: 16.837578773498535
Epoch: 32, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.830 Vali Acc: 0.969 Test Loss: 0.830 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9731696225557072
model parameter : 441354
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0364395
	speed: 0.0607s/iter; left time: 2502.6317s
	iters: 200, epoch: 1 | loss: 0.3290849
	speed: 0.0299s/iter; left time: 1230.4327s
	iters: 300, epoch: 1 | loss: 0.1726426
	speed: 0.0338s/iter; left time: 1384.6049s
	iters: 400, epoch: 1 | loss: 0.0022910
	speed: 0.0360s/iter; left time: 1470.5600s
Epoch: 1 cost time: 16.495074033737183
Epoch: 1, Steps: 413 | Train Loss: 0.363 Vali Loss: 0.274 Vali Acc: 0.934 Test Loss: 0.274 Test Acc: 0.934
Validation loss decreased (inf --> -0.934058).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5121205
	speed: 0.1431s/iter; left time: 5834.9186s
	iters: 200, epoch: 2 | loss: 0.0042723
	speed: 0.0344s/iter; left time: 1401.0649s
	iters: 300, epoch: 2 | loss: 0.0230528
	speed: 0.0330s/iter; left time: 1337.6883s
	iters: 400, epoch: 2 | loss: 0.0000001
	speed: 0.0291s/iter; left time: 1176.9097s
Epoch: 2 cost time: 13.843729257583618
Epoch: 2, Steps: 413 | Train Loss: 0.176 Vali Loss: 0.242 Vali Acc: 0.963 Test Loss: 0.242 Test Acc: 0.963
Validation loss decreased (-0.934058 --> -0.962708).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0025819
	speed: 0.1438s/iter; left time: 5807.3524s
	iters: 200, epoch: 3 | loss: 0.0002285
	speed: 0.0356s/iter; left time: 1432.4694s
	iters: 300, epoch: 3 | loss: 0.0001020
	speed: 0.0325s/iter; left time: 1305.8750s
	iters: 400, epoch: 3 | loss: 0.0000844
	speed: 0.0330s/iter; left time: 1323.8326s
Epoch: 3 cost time: 14.379613876342773
Epoch: 3, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.243 Vali Acc: 0.967 Test Loss: 0.243 Test Acc: 0.967
Validation loss decreased (-0.962708 --> -0.967255).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000198
	speed: 0.1518s/iter; left time: 6066.9746s
	iters: 200, epoch: 4 | loss: 0.0014963
	speed: 0.0286s/iter; left time: 1139.6262s
	iters: 300, epoch: 4 | loss: 0.0001553
	speed: 0.0280s/iter; left time: 1114.1797s
	iters: 400, epoch: 4 | loss: 0.0000776
	speed: 0.0277s/iter; left time: 1100.4182s
Epoch: 4 cost time: 12.16787600517273
Epoch: 4, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.355 Vali Acc: 0.959 Test Loss: 0.355 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0069953
	speed: 0.1403s/iter; left time: 5549.4037s
	iters: 200, epoch: 5 | loss: 0.0000005
	speed: 0.0279s/iter; left time: 1101.1176s
	iters: 300, epoch: 5 | loss: 0.0000833
	speed: 0.0361s/iter; left time: 1419.8371s
	iters: 400, epoch: 5 | loss: 0.0107085
	speed: 0.0434s/iter; left time: 1701.5982s
Epoch: 5 cost time: 15.202481031417847
Epoch: 5, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.549 Vali Acc: 0.951 Test Loss: 0.549 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.1776s/iter; left time: 6951.2821s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0542s/iter; left time: 2116.8526s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 2118.1706s
	iters: 400, epoch: 6 | loss: 0.0000164
	speed: 0.0520s/iter; left time: 2018.4876s
Epoch: 6 cost time: 22.857341766357422
Epoch: 6, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.525 Vali Acc: 0.958 Test Loss: 0.525 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1674s/iter; left time: 6480.4875s
	iters: 200, epoch: 7 | loss: 0.1392596
	speed: 0.0436s/iter; left time: 1683.7897s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0401s/iter; left time: 1544.3998s
	iters: 400, epoch: 7 | loss: 0.0000022
	speed: 0.0501s/iter; left time: 1925.6322s
Epoch: 7 cost time: 19.81045126914978
Epoch: 7, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.495 Vali Acc: 0.962 Test Loss: 0.495 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1631s/iter; left time: 6249.0228s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1635.5236s
	iters: 300, epoch: 8 | loss: 0.0000010
	speed: 0.0426s/iter; left time: 1624.0638s
	iters: 400, epoch: 8 | loss: 0.0020181
	speed: 0.0450s/iter; left time: 1710.6137s
Epoch: 8 cost time: 18.564022302627563
Epoch: 8, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.477 Vali Acc: 0.969 Test Loss: 0.477 Test Acc: 0.969
Validation loss decreased (-0.967255 --> -0.969072).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000173
	speed: 0.1825s/iter; left time: 6917.0311s
	iters: 200, epoch: 9 | loss: 0.0000012
	speed: 0.0489s/iter; left time: 1849.3265s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1726.1911s
	iters: 400, epoch: 9 | loss: 2.1058462
	speed: 0.0530s/iter; left time: 1993.0735s
Epoch: 9 cost time: 21.319122791290283
Epoch: 9, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.757 Vali Acc: 0.957 Test Loss: 0.757 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1751s/iter; left time: 6565.2158s
	iters: 200, epoch: 10 | loss: 0.0000011
	speed: 0.0478s/iter; left time: 1785.6607s
	iters: 300, epoch: 10 | loss: 0.0062458
	speed: 0.0487s/iter; left time: 1814.6943s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 2022.4542s
Epoch: 10 cost time: 21.79026508331299
Epoch: 10, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.557 Vali Acc: 0.966 Test Loss: 0.557 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0006599
	speed: 0.1854s/iter; left time: 6873.6667s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 2115.9344s
	iters: 300, epoch: 11 | loss: 0.0000002
	speed: 0.0587s/iter; left time: 2165.5166s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 2228.2891s
Epoch: 11 cost time: 25.22231912612915
Epoch: 11, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.394 Vali Acc: 0.971 Test Loss: 0.394 Test Acc: 0.971
Validation loss decreased (-0.969072 --> -0.970892).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.8976231
	speed: 0.1778s/iter; left time: 6518.3085s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 2083.6523s
	iters: 300, epoch: 12 | loss: 1.3798207
	speed: 0.0465s/iter; left time: 1694.1324s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 2080.3837s
Epoch: 12 cost time: 23.190417051315308
Epoch: 12, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.634 Vali Acc: 0.969 Test Loss: 0.634 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1512s/iter; left time: 5480.4654s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 1175.1489s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 1418.5091s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1429.9909s
Epoch: 13 cost time: 16.131808757781982
Epoch: 13, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.690 Vali Acc: 0.955 Test Loss: 0.690 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1534s/iter; left time: 5495.6614s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0345s/iter; left time: 1231.3904s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0387s/iter; left time: 1378.3519s
	iters: 400, epoch: 14 | loss: 0.3380260
	speed: 0.0439s/iter; left time: 1558.6767s
Epoch: 14 cost time: 15.948624610900879
Epoch: 14, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.497 Vali Acc: 0.970 Test Loss: 0.497 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000012
	speed: 0.1496s/iter; left time: 5299.2169s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0323s/iter; left time: 1141.9739s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 1213.2717s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0400s/iter; left time: 1405.5397s
Epoch: 15 cost time: 15.411413669586182
Epoch: 15, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.728 Vali Acc: 0.964 Test Loss: 0.728 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1447s/iter; left time: 5065.4179s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0327s/iter; left time: 1141.1189s
	iters: 300, epoch: 16 | loss: 0.0000101
	speed: 0.0330s/iter; left time: 1148.4696s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 1393.9932s
Epoch: 16 cost time: 15.123051166534424
Epoch: 16, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.484 Vali Acc: 0.973 Test Loss: 0.484 Test Acc: 0.973
Validation loss decreased (-0.970892 --> -0.973165).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1694s/iter; left time: 5860.2885s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 1422.4274s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 1384.1900s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 1867.6261s
Epoch: 17 cost time: 19.313712120056152
Epoch: 17, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.539 Vali Acc: 0.972 Test Loss: 0.539 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.5632343
	speed: 0.1603s/iter; left time: 5479.9045s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0417s/iter; left time: 1421.4267s
	iters: 300, epoch: 18 | loss: 2.0420914
	speed: 0.0406s/iter; left time: 1380.1949s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 1675.1825s
Epoch: 18 cost time: 18.651315450668335
Epoch: 18, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.582 Vali Acc: 0.970 Test Loss: 0.582 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1532s/iter; left time: 5173.9670s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 975.2561s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0393s/iter; left time: 1320.5279s
	iters: 400, epoch: 19 | loss: 0.0000035
	speed: 0.0469s/iter; left time: 1570.1494s
Epoch: 19 cost time: 16.39492654800415
Epoch: 19, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.686 Vali Acc: 0.968 Test Loss: 0.686 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1621s/iter; left time: 5406.3888s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0397s/iter; left time: 1319.7156s
	iters: 300, epoch: 20 | loss: 0.1334453
	speed: 0.0414s/iter; left time: 1372.1953s
	iters: 400, epoch: 20 | loss: 0.0145044
	speed: 0.0406s/iter; left time: 1341.3152s
Epoch: 20 cost time: 17.73951745033264
Epoch: 20, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.445 Vali Acc: 0.973 Test Loss: 0.445 Test Acc: 0.973
Validation loss decreased (-0.973165 --> -0.973165).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.0520290
	speed: 0.1676s/iter; left time: 5519.7465s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0465s/iter; left time: 1528.7476s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 1496.7682s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 1563.0796s
Epoch: 21 cost time: 20.029926776885986
Epoch: 21, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.769 Vali Acc: 0.966 Test Loss: 0.769 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1760s/iter; left time: 5723.9018s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 1411.4890s
	iters: 300, epoch: 22 | loss: 0.0000994
	speed: 0.0448s/iter; left time: 1448.6988s
	iters: 400, epoch: 22 | loss: 0.4007646
	speed: 0.0509s/iter; left time: 1641.7438s
Epoch: 22 cost time: 20.048295497894287
Epoch: 22, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.772 Vali Acc: 0.961 Test Loss: 0.772 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1825s/iter; left time: 5860.8924s
	iters: 200, epoch: 23 | loss: 0.0000005
	speed: 0.0575s/iter; left time: 1841.2485s
	iters: 300, epoch: 23 | loss: 1.9002213
	speed: 0.0600s/iter; left time: 1916.3196s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0651s/iter; left time: 2072.4976s
Epoch: 23 cost time: 25.55959939956665
Epoch: 23, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.750 Vali Acc: 0.968 Test Loss: 0.750 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1815s/iter; left time: 5754.9593s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 1660.5528s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 1717.2577s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0608s/iter; left time: 1910.5209s
Epoch: 24 cost time: 23.15532684326172
Epoch: 24, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.651 Vali Acc: 0.970 Test Loss: 0.651 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1705s/iter; left time: 5335.2724s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 1438.2697s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 1491.4133s
	iters: 400, epoch: 25 | loss: 0.0000308
	speed: 0.0508s/iter; left time: 1572.7048s
Epoch: 25 cost time: 20.795620679855347
Epoch: 25, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.668 Vali Acc: 0.975 Test Loss: 0.668 Test Acc: 0.975
Validation loss decreased (-0.973165 --> -0.975437).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1622s/iter; left time: 5008.3974s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 1000.1890s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 1072.3639s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0323s/iter; left time: 986.1963s
Epoch: 26 cost time: 15.135570764541626
Epoch: 26, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.814 Vali Acc: 0.970 Test Loss: 0.814 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1514s/iter; left time: 4611.6801s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0312s/iter; left time: 946.2978s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0306s/iter; left time: 925.5726s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 1052.3355s
Epoch: 27 cost time: 14.210905313491821
Epoch: 27, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.468 Vali Acc: 0.976 Test Loss: 0.468 Test Acc: 0.976
Validation loss decreased (-0.975437 --> -0.975893).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1601s/iter; left time: 4811.2131s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0317s/iter; left time: 948.2680s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0326s/iter; left time: 972.2012s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0307s/iter; left time: 912.0998s
Epoch: 28 cost time: 13.986407041549683
Epoch: 28, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.753 Vali Acc: 0.970 Test Loss: 0.753 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1534s/iter; left time: 4547.6780s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 1188.9617s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1252.2512s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 1263.3673s
Epoch: 29 cost time: 18.095653772354126
Epoch: 29, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.749 Vali Acc: 0.975 Test Loss: 0.749 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1622s/iter; left time: 4739.5077s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0420s/iter; left time: 1222.6833s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 1216.1711s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1151.0182s
Epoch: 30 cost time: 17.8044536113739
Epoch: 30, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.818 Vali Acc: 0.965 Test Loss: 0.818 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1562s/iter; left time: 4499.3889s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0317s/iter; left time: 911.5692s
	iters: 300, epoch: 31 | loss: 0.4596362
	speed: 0.0347s/iter; left time: 992.3888s
	iters: 400, epoch: 31 | loss: 0.9510164
	speed: 0.0331s/iter; left time: 943.7428s
Epoch: 31 cost time: 14.590835094451904
Epoch: 31, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.728 Vali Acc: 0.971 Test Loss: 0.728 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1530s/iter; left time: 4344.9697s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0360s/iter; left time: 1017.3622s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 991.2285s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 1106.5893s
Epoch: 32 cost time: 15.632720470428467
Epoch: 32, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.915 Vali Acc: 0.965 Test Loss: 0.915 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1486s/iter; left time: 4157.1883s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0305s/iter; left time: 850.6501s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 1413.8053s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 1563.5926s
Epoch: 33 cost time: 18.00728487968445
Epoch: 33, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.757 Vali Acc: 0.974 Test Loss: 0.757 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1681s/iter; left time: 4634.4929s
	iters: 200, epoch: 34 | loss: 0.3698213
	speed: 0.0452s/iter; left time: 1241.4746s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 1415.5543s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 1552.2843s
Epoch: 34 cost time: 21.2091543674469
Epoch: 34, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.401 Vali Acc: 0.975 Test Loss: 0.401 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1793s/iter; left time: 4868.4295s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0564s/iter; left time: 1526.8839s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 1796.7751s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0638s/iter; left time: 1714.7245s
Epoch: 35 cost time: 25.480188369750977
Epoch: 35, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.708 Vali Acc: 0.971 Test Loss: 0.708 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.1775s/iter; left time: 4746.2121s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 1522.9644s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0648s/iter; left time: 1719.4703s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 1389.9521s
Epoch: 36 cost time: 24.13082718849182
Epoch: 36, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.625 Vali Acc: 0.970 Test Loss: 0.625 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1564s/iter; left time: 4119.6506s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0387s/iter; left time: 1014.2262s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0541s/iter; left time: 1414.9304s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 1418.1578s
Epoch: 37 cost time: 19.937134742736816
Epoch: 37, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.618 Vali Acc: 0.974 Test Loss: 0.618 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9758981355161437
model parameter : 308362
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3407724
	speed: 0.0665s/iter; left time: 2739.1916s
	iters: 200, epoch: 1 | loss: 0.1256540
	speed: 0.0419s/iter; left time: 1721.8739s
	iters: 300, epoch: 1 | loss: 0.0191958
	speed: 0.0407s/iter; left time: 1670.1563s
	iters: 400, epoch: 1 | loss: 0.4505036
	speed: 0.0427s/iter; left time: 1747.9507s
Epoch: 1 cost time: 19.841912746429443
Epoch: 1, Steps: 413 | Train Loss: 0.375 Vali Loss: 0.239 Vali Acc: 0.940 Test Loss: 0.239 Test Acc: 0.940
Validation loss decreased (inf --> -0.939970).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0004763
	speed: 0.1691s/iter; left time: 6895.6197s
	iters: 200, epoch: 2 | loss: 0.0842555
	speed: 0.0297s/iter; left time: 1209.3698s
	iters: 300, epoch: 2 | loss: 0.7660258
	speed: 0.0314s/iter; left time: 1275.2585s
	iters: 400, epoch: 2 | loss: 0.0095126
	speed: 0.0314s/iter; left time: 1270.9182s
Epoch: 2 cost time: 13.774263620376587
Epoch: 2, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.239 Vali Acc: 0.962 Test Loss: 0.239 Test Acc: 0.962
Validation loss decreased (-0.939970 --> -0.961798).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0175922
	speed: 0.1491s/iter; left time: 6020.5360s
	iters: 200, epoch: 3 | loss: 1.0067033
	speed: 0.0359s/iter; left time: 1444.3235s
	iters: 300, epoch: 3 | loss: 0.1176333
	speed: 0.0349s/iter; left time: 1400.6108s
	iters: 400, epoch: 3 | loss: 0.0000967
	speed: 0.0329s/iter; left time: 1318.4521s
Epoch: 3 cost time: 14.964562177658081
Epoch: 3, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.438 Vali Acc: 0.931 Test Loss: 0.438 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000110
	speed: 0.1415s/iter; left time: 5654.3987s
	iters: 200, epoch: 4 | loss: 0.0000020
	speed: 0.0336s/iter; left time: 1339.0955s
	iters: 300, epoch: 4 | loss: 0.0002872
	speed: 0.0344s/iter; left time: 1368.8155s
	iters: 400, epoch: 4 | loss: 0.0001059
	speed: 0.0376s/iter; left time: 1490.2438s
Epoch: 4 cost time: 14.882310390472412
Epoch: 4, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.345 Vali Acc: 0.958 Test Loss: 0.345 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000955
	speed: 0.1391s/iter; left time: 5500.7211s
	iters: 200, epoch: 5 | loss: 0.6181382
	speed: 0.0294s/iter; left time: 1158.6028s
	iters: 300, epoch: 5 | loss: 0.0000799
	speed: 0.0274s/iter; left time: 1079.5281s
	iters: 400, epoch: 5 | loss: 0.0000682
	speed: 0.0335s/iter; left time: 1314.6884s
Epoch: 5 cost time: 13.292038917541504
Epoch: 5, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.519 Vali Acc: 0.953 Test Loss: 0.519 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.1343s/iter; left time: 5256.5173s
	iters: 200, epoch: 6 | loss: 0.0000053
	speed: 0.0270s/iter; left time: 1052.1863s
	iters: 300, epoch: 6 | loss: 0.0008383
	speed: 0.0311s/iter; left time: 1211.4735s
	iters: 400, epoch: 6 | loss: 0.0006793
	speed: 0.0330s/iter; left time: 1280.2369s
Epoch: 6 cost time: 13.018838167190552
Epoch: 6, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.448 Vali Acc: 0.958 Test Loss: 0.448 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1588387
	speed: 0.1403s/iter; left time: 5431.3692s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 1034.3631s
	iters: 300, epoch: 7 | loss: 0.0755836
	speed: 0.0319s/iter; left time: 1229.1957s
	iters: 400, epoch: 7 | loss: 0.0006557
	speed: 0.0341s/iter; left time: 1311.5217s
Epoch: 7 cost time: 13.510720014572144
Epoch: 7, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.317 Vali Acc: 0.965 Test Loss: 0.317 Test Acc: 0.965
Validation loss decreased (-0.961798 --> -0.964981).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0178767
	speed: 0.1465s/iter; left time: 5610.6046s
	iters: 200, epoch: 8 | loss: 0.3220509
	speed: 0.0363s/iter; left time: 1385.8531s
	iters: 300, epoch: 8 | loss: 0.0001977
	speed: 0.0333s/iter; left time: 1269.8094s
	iters: 400, epoch: 8 | loss: 0.0056555
	speed: 0.0315s/iter; left time: 1198.3458s
Epoch: 8 cost time: 14.353110790252686
Epoch: 8, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.348 Vali Acc: 0.968 Test Loss: 0.348 Test Acc: 0.968
Validation loss decreased (-0.964981 --> -0.967709).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1519s/iter; left time: 5755.7917s
	iters: 200, epoch: 9 | loss: 0.0000002
	speed: 0.0488s/iter; left time: 1845.0964s
	iters: 300, epoch: 9 | loss: 0.0262515
	speed: 0.0461s/iter; left time: 1737.4645s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0423s/iter; left time: 1589.9046s
Epoch: 9 cost time: 19.454047918319702
Epoch: 9, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.291 Vali Acc: 0.970 Test Loss: 0.291 Test Acc: 0.970
Validation loss decreased (-0.967709 --> -0.970438).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000306
	speed: 0.1799s/iter; left time: 6742.1411s
	iters: 200, epoch: 10 | loss: 0.0087781
	speed: 0.0491s/iter; left time: 1835.0883s
	iters: 300, epoch: 10 | loss: 1.0700948
	speed: 0.0475s/iter; left time: 1771.8664s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1822.8998s
Epoch: 10 cost time: 21.2132306098938
Epoch: 10, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.408 Vali Acc: 0.967 Test Loss: 0.408 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1530s/iter; left time: 5672.0726s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 1447.7657s
	iters: 300, epoch: 11 | loss: 0.0000641
	speed: 0.0364s/iter; left time: 1343.0669s
	iters: 400, epoch: 11 | loss: 0.0005727
	speed: 0.0395s/iter; left time: 1453.5463s
Epoch: 11 cost time: 16.50072145462036
Epoch: 11, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.369 Vali Acc: 0.973 Test Loss: 0.369 Test Acc: 0.973
Validation loss decreased (-0.970438 --> -0.973166).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1483s/iter; left time: 5435.1585s
	iters: 200, epoch: 12 | loss: 0.0000003
	speed: 0.0380s/iter; left time: 1389.2644s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0376s/iter; left time: 1371.9686s
	iters: 400, epoch: 12 | loss: 0.0000046
	speed: 0.0377s/iter; left time: 1372.1921s
Epoch: 12 cost time: 16.305763244628906
Epoch: 12, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.313 Vali Acc: 0.969 Test Loss: 0.313 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000017
	speed: 0.1488s/iter; left time: 5393.4666s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 1352.6091s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 1314.9288s
	iters: 400, epoch: 13 | loss: 0.0002152
	speed: 0.0370s/iter; left time: 1330.2937s
Epoch: 13 cost time: 15.915033340454102
Epoch: 13, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.372 Vali Acc: 0.973 Test Loss: 0.372 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.1522s/iter; left time: 5455.0633s
	iters: 200, epoch: 14 | loss: 0.0000114
	speed: 0.0345s/iter; left time: 1233.2381s
	iters: 300, epoch: 14 | loss: 0.2010981
	speed: 0.0349s/iter; left time: 1242.8657s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 1326.2124s
Epoch: 14 cost time: 15.701615333557129
Epoch: 14, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.431 Vali Acc: 0.975 Test Loss: 0.431 Test Acc: 0.975
Validation loss decreased (-0.973166 --> -0.975439).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1460s/iter; left time: 5170.8446s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 1025.6648s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0299s/iter; left time: 1054.7170s
	iters: 400, epoch: 15 | loss: 0.0000076
	speed: 0.0331s/iter; left time: 1162.2376s
Epoch: 15 cost time: 13.747704982757568
Epoch: 15, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.409 Vali Acc: 0.970 Test Loss: 0.409 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1537s/iter; left time: 5379.9049s
	iters: 200, epoch: 16 | loss: 0.6319479
	speed: 0.0341s/iter; left time: 1190.1854s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 1404.0072s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1473.8712s
Epoch: 16 cost time: 16.635411739349365
Epoch: 16, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.580 Vali Acc: 0.967 Test Loss: 0.580 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1450s/iter; left time: 5016.9051s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0309s/iter; left time: 1066.2928s
	iters: 300, epoch: 17 | loss: 0.0000284
	speed: 0.0315s/iter; left time: 1081.6897s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 1173.4331s
Epoch: 17 cost time: 13.902622699737549
Epoch: 17, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.433 Vali Acc: 0.973 Test Loss: 0.433 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1415s/iter; left time: 4837.8433s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0309s/iter; left time: 1052.1672s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 1141.6270s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 1160.2000s
Epoch: 18 cost time: 13.957355499267578
Epoch: 18, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.207 Vali Acc: 0.983 Test Loss: 0.207 Test Acc: 0.983
Validation loss decreased (-0.975439 --> -0.983172).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1458s/iter; left time: 4923.8628s
	iters: 200, epoch: 19 | loss: 0.0000004
	speed: 0.0314s/iter; left time: 1057.5909s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 1040.1005s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0299s/iter; left time: 1000.1216s
Epoch: 19 cost time: 13.56415319442749
Epoch: 19, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.525 Vali Acc: 0.970 Test Loss: 0.525 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1409s/iter; left time: 4700.9107s
	iters: 200, epoch: 20 | loss: 0.0000011
	speed: 0.0321s/iter; left time: 1066.5200s
	iters: 300, epoch: 20 | loss: 0.0000212
	speed: 0.0291s/iter; left time: 964.9040s
	iters: 400, epoch: 20 | loss: 0.0000012
	speed: 0.0301s/iter; left time: 995.4566s
Epoch: 20 cost time: 12.614523649215698
Epoch: 20, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.476 Vali Acc: 0.976 Test Loss: 0.476 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1497s/iter; left time: 4932.0750s
	iters: 200, epoch: 21 | loss: 0.1953085
	speed: 0.0274s/iter; left time: 899.0463s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 984.5183s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 947.2868s
Epoch: 21 cost time: 12.537588119506836
Epoch: 21, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.263 Vali Acc: 0.980 Test Loss: 0.263 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1637s/iter; left time: 5323.5596s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 1161.9916s
	iters: 300, epoch: 22 | loss: 0.0087741
	speed: 0.0458s/iter; left time: 1480.7395s
	iters: 400, epoch: 22 | loss: 0.0003226
	speed: 0.0456s/iter; left time: 1470.9729s
Epoch: 22 cost time: 17.959879398345947
Epoch: 22, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.385 Vali Acc: 0.978 Test Loss: 0.385 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1713s/iter; left time: 5502.7543s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 1458.5751s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 1493.1884s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 1177.2612s
Epoch: 23 cost time: 18.990564823150635
Epoch: 23, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.397 Vali Acc: 0.975 Test Loss: 0.397 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1560s/iter; left time: 4944.9923s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 1122.2664s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0378s/iter; left time: 1192.2198s
	iters: 400, epoch: 24 | loss: 0.0000005
	speed: 0.0374s/iter; left time: 1174.1520s
Epoch: 24 cost time: 16.265230894088745
Epoch: 24, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.360 Vali Acc: 0.974 Test Loss: 0.360 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1619s/iter; left time: 5066.1163s
	iters: 200, epoch: 25 | loss: 0.0000022
	speed: 0.0383s/iter; left time: 1195.6110s
	iters: 300, epoch: 25 | loss: 0.1451680
	speed: 0.0382s/iter; left time: 1187.8122s
	iters: 400, epoch: 25 | loss: 0.0000015
	speed: 0.0378s/iter; left time: 1171.8014s
Epoch: 25 cost time: 16.583892345428467
Epoch: 25, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.315 Vali Acc: 0.980 Test Loss: 0.315 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1418s/iter; left time: 4376.7489s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 982.1172s
	iters: 300, epoch: 26 | loss: 0.0126996
	speed: 0.0347s/iter; left time: 1064.1938s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0376s/iter; left time: 1148.5590s
Epoch: 26 cost time: 14.75574541091919
Epoch: 26, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.418 Vali Acc: 0.976 Test Loss: 0.418 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1457s/iter; left time: 4436.9641s
	iters: 200, epoch: 27 | loss: 0.0000039
	speed: 0.0393s/iter; left time: 1193.9663s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 1186.4357s
	iters: 400, epoch: 27 | loss: 0.0000003
	speed: 0.0449s/iter; left time: 1355.6632s
Epoch: 27 cost time: 17.624975204467773
Epoch: 27, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.457 Vali Acc: 0.977 Test Loss: 0.457 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1642s/iter; left time: 4934.8467s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 1456.5427s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 1560.8817s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 1420.9905s
Epoch: 28 cost time: 20.794008255004883
Epoch: 28, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.503 Vali Acc: 0.980 Test Loss: 0.503 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 241930
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2363538
	speed: 0.0569s/iter; left time: 2343.8987s
	iters: 200, epoch: 1 | loss: 0.3417984
	speed: 0.0297s/iter; left time: 1219.8866s
	iters: 300, epoch: 1 | loss: 0.2346964
	speed: 0.0290s/iter; left time: 1188.4714s
	iters: 400, epoch: 1 | loss: 0.2088447
	speed: 0.0309s/iter; left time: 1263.8790s
Epoch: 1 cost time: 15.256104230880737
Epoch: 1, Steps: 413 | Train Loss: 0.369 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
Validation loss decreased (inf --> -0.959980).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1131921
	speed: 0.1375s/iter; left time: 5608.8341s
	iters: 200, epoch: 2 | loss: 0.0007821
	speed: 0.0260s/iter; left time: 1057.9647s
	iters: 300, epoch: 2 | loss: 0.0019020
	speed: 0.0263s/iter; left time: 1066.2333s
	iters: 400, epoch: 2 | loss: 0.7941360
	speed: 0.0272s/iter; left time: 1102.5441s
Epoch: 2 cost time: 11.547271728515625
Epoch: 2, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.171 Vali Acc: 0.955 Test Loss: 0.171 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6086801
	speed: 0.1375s/iter; left time: 5551.4862s
	iters: 200, epoch: 3 | loss: 0.0002694
	speed: 0.0266s/iter; left time: 1069.8102s
	iters: 300, epoch: 3 | loss: 0.0023747
	speed: 0.0297s/iter; left time: 1192.1816s
	iters: 400, epoch: 3 | loss: 0.0000405
	speed: 0.0275s/iter; left time: 1102.9892s
Epoch: 3 cost time: 11.6361563205719
Epoch: 3, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.235 Vali Acc: 0.955 Test Loss: 0.235 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000004
	speed: 0.1284s/iter; left time: 5130.0052s
	iters: 200, epoch: 4 | loss: 0.5369079
	speed: 0.0270s/iter; left time: 1077.3330s
	iters: 300, epoch: 4 | loss: 0.0016318
	speed: 0.0303s/iter; left time: 1203.3055s
	iters: 400, epoch: 4 | loss: 0.0000002
	speed: 0.0289s/iter; left time: 1145.5506s
Epoch: 4 cost time: 11.981416463851929
Epoch: 4, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.214 Vali Acc: 0.973 Test Loss: 0.214 Test Acc: 0.973
Validation loss decreased (-0.959980 --> -0.972713).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000099
	speed: 0.1506s/iter; left time: 5955.4675s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0339s/iter; left time: 1335.3550s
	iters: 300, epoch: 5 | loss: 0.2754913
	speed: 0.0336s/iter; left time: 1322.3729s
	iters: 400, epoch: 5 | loss: 0.0005904
	speed: 0.0321s/iter; left time: 1258.9312s
Epoch: 5 cost time: 14.50620698928833
Epoch: 5, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
Validation loss decreased (-0.972713 --> -0.972713).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.1406s/iter; left time: 5500.5854s
	iters: 200, epoch: 6 | loss: 0.0000001
	speed: 0.0325s/iter; left time: 1268.2671s
	iters: 300, epoch: 6 | loss: 0.0001081
	speed: 0.0337s/iter; left time: 1311.1188s
	iters: 400, epoch: 6 | loss: 0.0000042
	speed: 0.0354s/iter; left time: 1376.2897s
Epoch: 6 cost time: 14.259260654449463
Epoch: 6, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.217 Vali Acc: 0.972 Test Loss: 0.217 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0225529
	speed: 0.1450s/iter; left time: 5614.6324s
	iters: 200, epoch: 7 | loss: 0.0171539
	speed: 0.0390s/iter; left time: 1507.7778s
	iters: 300, epoch: 7 | loss: 0.0000029
	speed: 0.0382s/iter; left time: 1469.8815s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 1544.5906s
Epoch: 7 cost time: 16.54225206375122
Epoch: 7, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.255 Vali Acc: 0.973 Test Loss: 0.255 Test Acc: 0.973
Validation loss decreased (-0.972713 --> -0.973167).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000007
	speed: 0.1585s/iter; left time: 6072.4521s
	iters: 200, epoch: 8 | loss: 0.0002502
	speed: 0.0375s/iter; left time: 1431.6399s
	iters: 300, epoch: 8 | loss: 0.0168009
	speed: 0.0390s/iter; left time: 1485.9016s
	iters: 400, epoch: 8 | loss: 0.0000003
	speed: 0.0375s/iter; left time: 1425.3883s
Epoch: 8 cost time: 16.47377061843872
Epoch: 8, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.243 Vali Acc: 0.972 Test Loss: 0.243 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000728
	speed: 0.1511s/iter; left time: 5724.3592s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 1491.7458s
	iters: 300, epoch: 9 | loss: 0.0000293
	speed: 0.0367s/iter; left time: 1385.3316s
	iters: 400, epoch: 9 | loss: 0.0395342
	speed: 0.0352s/iter; left time: 1323.8149s
Epoch: 9 cost time: 16.149521827697754
Epoch: 9, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.314 Vali Acc: 0.972 Test Loss: 0.314 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000114
	speed: 0.1491s/iter; left time: 5590.5509s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0366s/iter; left time: 1369.9332s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0345s/iter; left time: 1287.8627s
	iters: 400, epoch: 10 | loss: 0.1729990
	speed: 0.0347s/iter; left time: 1289.6421s
Epoch: 10 cost time: 15.422236919403076
Epoch: 10, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.174 Vali Acc: 0.980 Test Loss: 0.174 Test Acc: 0.980
Validation loss decreased (-0.973167 --> -0.979534).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000076
	speed: 0.1622s/iter; left time: 6013.2077s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 1644.8834s
	iters: 300, epoch: 11 | loss: 0.0000020
	speed: 0.0454s/iter; left time: 1675.1167s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 1605.9469s
Epoch: 11 cost time: 19.371607542037964
Epoch: 11, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.251 Vali Acc: 0.977 Test Loss: 0.251 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1636s/iter; left time: 5997.5160s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 1627.9123s
	iters: 300, epoch: 12 | loss: 0.0061043
	speed: 0.0448s/iter; left time: 1634.7715s
	iters: 400, epoch: 12 | loss: 0.0230522
	speed: 0.0462s/iter; left time: 1681.2535s
Epoch: 12 cost time: 19.595157623291016
Epoch: 12, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.192 Vali Acc: 0.985 Test Loss: 0.192 Test Acc: 0.985
Validation loss decreased (-0.979534 --> -0.984991).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1449s/iter; left time: 5253.3945s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 1058.3541s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 981.2290s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 1009.5441s
Epoch: 13 cost time: 12.430933713912964
Epoch: 13, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.216 Vali Acc: 0.979 Test Loss: 0.216 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2838685
	speed: 0.1413s/iter; left time: 5063.9186s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0294s/iter; left time: 1052.0957s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 1031.6534s
	iters: 400, epoch: 14 | loss: 0.0017487
	speed: 0.0291s/iter; left time: 1034.5893s
Epoch: 14 cost time: 13.00275993347168
Epoch: 14, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.317 Vali Acc: 0.980 Test Loss: 0.317 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1358s/iter; left time: 4809.6680s
	iters: 200, epoch: 15 | loss: 0.0000051
	speed: 0.0265s/iter; left time: 936.4139s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0294s/iter; left time: 1035.7968s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0260s/iter; left time: 914.2307s
Epoch: 15 cost time: 11.913131713867188
Epoch: 15, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.396 Vali Acc: 0.976 Test Loss: 0.396 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000003
	speed: 0.1358s/iter; left time: 4754.5048s
	iters: 200, epoch: 16 | loss: 0.0000901
	speed: 0.0265s/iter; left time: 925.2342s
	iters: 300, epoch: 16 | loss: 0.0005093
	speed: 0.0292s/iter; left time: 1015.9245s
	iters: 400, epoch: 16 | loss: 0.6824021
	speed: 0.0271s/iter; left time: 941.2099s
Epoch: 16 cost time: 11.953460216522217
Epoch: 16, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.381 Vali Acc: 0.975 Test Loss: 0.381 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1299s/iter; left time: 4492.6708s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 1000.9061s
	iters: 300, epoch: 17 | loss: 0.0000052
	speed: 0.0293s/iter; left time: 1008.5819s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0318s/iter; left time: 1090.8262s
Epoch: 17 cost time: 12.996652841567993
Epoch: 17, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.282 Vali Acc: 0.977 Test Loss: 0.282 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1334s/iter; left time: 4560.1078s
	iters: 200, epoch: 18 | loss: 0.0000004
	speed: 0.0349s/iter; left time: 1188.8568s
	iters: 300, epoch: 18 | loss: 0.5025423
	speed: 0.0325s/iter; left time: 1103.3103s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0340s/iter; left time: 1151.8887s
Epoch: 18 cost time: 14.506042718887329
Epoch: 18, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.329 Vali Acc: 0.977 Test Loss: 0.329 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1443s/iter; left time: 4870.9063s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 1131.4295s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 921.1944s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 918.3112s
Epoch: 19 cost time: 13.173015117645264
Epoch: 19, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.420 Vali Acc: 0.970 Test Loss: 0.420 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1352s/iter; left time: 4509.6539s
	iters: 200, epoch: 20 | loss: 0.0000998
	speed: 0.0272s/iter; left time: 903.2506s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 940.9120s
	iters: 400, epoch: 20 | loss: 0.0000003
	speed: 0.0392s/iter; left time: 1296.2418s
Epoch: 20 cost time: 13.596915245056152
Epoch: 20, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.485 Vali Acc: 0.960 Test Loss: 0.485 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1670s/iter; left time: 5501.2776s
	iters: 200, epoch: 21 | loss: 0.7607127
	speed: 0.0372s/iter; left time: 1220.0845s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 1273.5105s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 1311.7714s
Epoch: 21 cost time: 16.7286159992218
Epoch: 21, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.470 Vali Acc: 0.966 Test Loss: 0.470 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1429s/iter; left time: 4648.4669s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0327s/iter; left time: 1059.3198s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1263.5110s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 1135.1592s
Epoch: 22 cost time: 15.343209743499756
Epoch: 22, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.429 Vali Acc: 0.973 Test Loss: 0.429 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 200522
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6524464
	speed: 0.0746s/iter; left time: 3073.3943s
	iters: 200, epoch: 1 | loss: 0.1048878
	speed: 0.0401s/iter; left time: 1646.4780s
	iters: 300, epoch: 1 | loss: 0.3887368
	speed: 0.0463s/iter; left time: 1898.2317s
	iters: 400, epoch: 1 | loss: 0.5417619
	speed: 0.0465s/iter; left time: 1900.1898s
Epoch: 1 cost time: 21.41226053237915
Epoch: 1, Steps: 413 | Train Loss: 0.369 Vali Loss: 0.158 Vali Acc: 0.953 Test Loss: 0.158 Test Acc: 0.953
Validation loss decreased (inf --> -0.952704).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0810059
	speed: 0.1523s/iter; left time: 6211.0653s
	iters: 200, epoch: 2 | loss: 0.0156967
	speed: 0.0444s/iter; left time: 1808.1227s
	iters: 300, epoch: 2 | loss: 0.0382224
	speed: 0.0483s/iter; left time: 1960.3247s
	iters: 400, epoch: 2 | loss: 0.1329950
	speed: 0.0449s/iter; left time: 1817.6534s
Epoch: 2 cost time: 19.197333812713623
Epoch: 2, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.952704 --> -0.967711).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2534748
	speed: 0.1544s/iter; left time: 6232.2358s
	iters: 200, epoch: 3 | loss: 0.0000156
	speed: 0.0361s/iter; left time: 1454.1195s
	iters: 300, epoch: 3 | loss: 0.2796805
	speed: 0.0382s/iter; left time: 1536.5066s
	iters: 400, epoch: 3 | loss: 0.1085436
	speed: 0.0385s/iter; left time: 1541.3592s
Epoch: 3 cost time: 15.677672386169434
Epoch: 3, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.967711 --> -0.974987).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1137912
	speed: 0.1233s/iter; left time: 4926.7315s
	iters: 200, epoch: 4 | loss: 0.1401184
	speed: 0.0225s/iter; left time: 898.3441s
	iters: 300, epoch: 4 | loss: 0.0013765
	speed: 0.0278s/iter; left time: 1105.4999s
	iters: 400, epoch: 4 | loss: 0.0206516
	speed: 0.0258s/iter; left time: 1025.1867s
Epoch: 4 cost time: 10.873978853225708
Epoch: 4, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0123063
	speed: 0.1213s/iter; left time: 4799.2615s
	iters: 200, epoch: 5 | loss: 0.0000010
	speed: 0.0248s/iter; left time: 978.3518s
	iters: 300, epoch: 5 | loss: 0.0004037
	speed: 0.0244s/iter; left time: 960.2538s
	iters: 400, epoch: 5 | loss: 0.0000465
	speed: 0.0248s/iter; left time: 973.1627s
Epoch: 5 cost time: 10.924017429351807
Epoch: 5, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974987 --> -0.975442).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000378
	speed: 0.1290s/iter; left time: 5047.1283s
	iters: 200, epoch: 6 | loss: 0.0000032
	speed: 0.0216s/iter; left time: 844.8895s
	iters: 300, epoch: 6 | loss: 0.0000163
	speed: 0.0247s/iter; left time: 961.9692s
	iters: 400, epoch: 6 | loss: 0.0177743
	speed: 0.0225s/iter; left time: 874.8493s
Epoch: 6 cost time: 10.304589033126831
Epoch: 6, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.259 Vali Acc: 0.968 Test Loss: 0.259 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0030426
	speed: 0.1215s/iter; left time: 4706.1356s
	iters: 200, epoch: 7 | loss: 0.0000037
	speed: 0.0274s/iter; left time: 1057.3112s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0239s/iter; left time: 919.5899s
	iters: 400, epoch: 7 | loss: 0.0000002
	speed: 0.0230s/iter; left time: 883.3207s
Epoch: 7 cost time: 11.14687705039978
Epoch: 7, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.248 Vali Acc: 0.965 Test Loss: 0.248 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000216
	speed: 0.1350s/iter; left time: 5171.0565s
	iters: 200, epoch: 8 | loss: 0.0000001
	speed: 0.0276s/iter; left time: 1056.0093s
	iters: 300, epoch: 8 | loss: 0.0000002
	speed: 0.0259s/iter; left time: 985.8418s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 1026.2718s
Epoch: 8 cost time: 11.945090532302856
Epoch: 8, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.228 Vali Acc: 0.973 Test Loss: 0.228 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0089827
	speed: 0.1354s/iter; left time: 5132.5046s
	iters: 200, epoch: 9 | loss: 0.0003278
	speed: 0.0290s/iter; left time: 1095.0031s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 1054.1957s
	iters: 400, epoch: 9 | loss: 0.0000002
	speed: 0.0277s/iter; left time: 1040.3266s
Epoch: 9 cost time: 12.701591968536377
Epoch: 9, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.235 Vali Acc: 0.977 Test Loss: 0.235 Test Acc: 0.977
Validation loss decreased (-0.975442 --> -0.977260).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0065976
	speed: 0.1423s/iter; left time: 5335.4097s
	iters: 200, epoch: 10 | loss: 0.0000131
	speed: 0.0314s/iter; left time: 1172.1293s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 946.9064s
	iters: 400, epoch: 10 | loss: 0.0001446
	speed: 0.0264s/iter; left time: 981.0059s
Epoch: 10 cost time: 12.395610094070435
Epoch: 10, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000010
	speed: 0.1193s/iter; left time: 4423.6673s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 978.8848s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 993.9312s
	iters: 400, epoch: 11 | loss: 0.0000025
	speed: 0.0275s/iter; left time: 1012.3789s
Epoch: 11 cost time: 11.549751043319702
Epoch: 11, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.309 Vali Acc: 0.974 Test Loss: 0.309 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.3006826
	speed: 0.1391s/iter; left time: 5098.1902s
	iters: 200, epoch: 12 | loss: 0.0000008
	speed: 0.0345s/iter; left time: 1260.6389s
	iters: 300, epoch: 12 | loss: 0.0000233
	speed: 0.0407s/iter; left time: 1482.9570s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 2275.3237s
Epoch: 12 cost time: 18.503535747528076
Epoch: 12, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.468 Vali Acc: 0.962 Test Loss: 0.468 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1658s/iter; left time: 6008.3957s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 1275.2935s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 1396.7687s
	iters: 400, epoch: 13 | loss: 0.0000003
	speed: 0.0337s/iter; left time: 1210.2614s
Epoch: 13 cost time: 15.501837015151978
Epoch: 13, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.320 Vali Acc: 0.974 Test Loss: 0.320 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1362s/iter; left time: 4879.4929s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0340s/iter; left time: 1215.9557s
	iters: 300, epoch: 14 | loss: 0.0000364
	speed: 0.0351s/iter; left time: 1250.9974s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 1133.5549s
Epoch: 14 cost time: 14.283316135406494
Epoch: 14, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.249 Vali Acc: 0.978 Test Loss: 0.249 Test Acc: 0.978
Validation loss decreased (-0.977260 --> -0.977715).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1575s/iter; left time: 5578.5846s
	iters: 200, epoch: 15 | loss: 0.0000003
	speed: 0.0485s/iter; left time: 1713.7315s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 1679.5112s
	iters: 400, epoch: 15 | loss: 0.0000024
	speed: 0.0433s/iter; left time: 1519.5942s
Epoch: 15 cost time: 18.600014686584473
Epoch: 15, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.182 Vali Acc: 0.980 Test Loss: 0.182 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979534).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0003522
	speed: 0.1621s/iter; left time: 5674.6818s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 1715.0671s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 1651.3677s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0446s/iter; left time: 1546.4712s
Epoch: 16 cost time: 20.17438316345215
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.982 Test Loss: 0.192 Test Acc: 0.982
Validation loss decreased (-0.979534 --> -0.982263).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1588s/iter; left time: 5494.1031s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 1294.0792s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 1188.8609s
	iters: 400, epoch: 17 | loss: 0.0000047
	speed: 0.0366s/iter; left time: 1255.3409s
Epoch: 17 cost time: 16.54490828514099
Epoch: 17, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.378 Vali Acc: 0.970 Test Loss: 0.378 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1568s/iter; left time: 5359.2745s
	iters: 200, epoch: 18 | loss: 0.0000003
	speed: 0.0384s/iter; left time: 1310.3483s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 790.1628s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0258s/iter; left time: 875.0824s
Epoch: 18 cost time: 13.848527908325195
Epoch: 18, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.228 Vali Acc: 0.980 Test Loss: 0.228 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1159s/iter; left time: 3912.7501s
	iters: 200, epoch: 19 | loss: 0.0000199
	speed: 0.0264s/iter; left time: 888.3413s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 910.7635s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0227s/iter; left time: 761.1622s
Epoch: 19 cost time: 10.84094524383545
Epoch: 19, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.386 Vali Acc: 0.974 Test Loss: 0.386 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.1246s/iter; left time: 4157.4350s
	iters: 200, epoch: 20 | loss: 0.0000005
	speed: 0.0209s/iter; left time: 694.4109s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0245s/iter; left time: 812.9707s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0240s/iter; left time: 792.1021s
Epoch: 20 cost time: 10.198834419250488
Epoch: 20, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.484 Vali Acc: 0.970 Test Loss: 0.484 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1151s/iter; left time: 3790.5717s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.0257s/iter; left time: 842.7331s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0256s/iter; left time: 836.9960s
	iters: 400, epoch: 21 | loss: 0.0025502
	speed: 0.0256s/iter; left time: 835.5623s
Epoch: 21 cost time: 11.224165678024292
Epoch: 21, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.360 Vali Acc: 0.973 Test Loss: 0.360 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1270s/iter; left time: 4130.6340s
	iters: 200, epoch: 22 | loss: 0.0847723
	speed: 0.0232s/iter; left time: 751.8536s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0273s/iter; left time: 883.7585s
	iters: 400, epoch: 22 | loss: 0.1526027
	speed: 0.0235s/iter; left time: 758.8427s
Epoch: 22 cost time: 10.826241970062256
Epoch: 22, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.329 Vali Acc: 0.976 Test Loss: 0.329 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1284s/iter; left time: 4122.4034s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0305s/iter; left time: 977.6587s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 984.4258s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 933.5376s
Epoch: 23 cost time: 12.97462797164917
Epoch: 23, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.245 Vali Acc: 0.977 Test Loss: 0.245 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1550s/iter; left time: 4912.5675s
	iters: 200, epoch: 24 | loss: 0.0411263
	speed: 0.0478s/iter; left time: 1509.0030s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 1044.7565s
	iters: 400, epoch: 24 | loss: 0.0001602
	speed: 0.0329s/iter; left time: 1032.2983s
Epoch: 24 cost time: 17.34129548072815
Epoch: 24, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.352 Vali Acc: 0.979 Test Loss: 0.352 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1233s/iter; left time: 3858.3040s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 1152.7484s
	iters: 300, epoch: 25 | loss: 0.0001958
	speed: 0.0354s/iter; left time: 1099.4490s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 1058.4338s
Epoch: 25 cost time: 14.152563333511353
Epoch: 25, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.319 Vali Acc: 0.978 Test Loss: 0.319 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000001
	speed: 0.1513s/iter; left time: 4672.2233s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 1314.6950s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 1291.0850s
	iters: 400, epoch: 26 | loss: 0.0067995
	speed: 0.0386s/iter; left time: 1178.8866s
Epoch: 26 cost time: 16.937474727630615
Epoch: 26, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.298 Vali Acc: 0.980 Test Loss: 0.298 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 159178
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3086264
	speed: 0.0712s/iter; left time: 2935.3516s
	iters: 200, epoch: 1 | loss: 0.1766232
	speed: 0.0393s/iter; left time: 1616.6246s
	iters: 300, epoch: 1 | loss: 0.0716106
	speed: 0.0412s/iter; left time: 1687.9971s
	iters: 400, epoch: 1 | loss: 0.2334295
	speed: 0.0435s/iter; left time: 1779.6924s
Epoch: 1 cost time: 20.242480278015137
Epoch: 1, Steps: 413 | Train Loss: 0.417 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
Validation loss decreased (inf --> -0.958616).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0256015
	speed: 0.1954s/iter; left time: 7971.2040s
	iters: 200, epoch: 2 | loss: 0.0095319
	speed: 0.0375s/iter; left time: 1525.5525s
	iters: 300, epoch: 2 | loss: 0.2063482
	speed: 0.0337s/iter; left time: 1368.8831s
	iters: 400, epoch: 2 | loss: 0.1689609
	speed: 0.0331s/iter; left time: 1341.7594s
Epoch: 2 cost time: 15.653992176055908
Epoch: 2, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.958616 --> -0.961800).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0080974
	speed: 0.1640s/iter; left time: 6621.2838s
	iters: 200, epoch: 3 | loss: 0.0107607
	speed: 0.0443s/iter; left time: 1784.7029s
	iters: 300, epoch: 3 | loss: 0.2776940
	speed: 0.0476s/iter; left time: 1911.1217s
	iters: 400, epoch: 3 | loss: 0.0242171
	speed: 0.0481s/iter; left time: 1928.8256s
Epoch: 3 cost time: 19.11953639984131
Epoch: 3, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.961800 --> -0.973623).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0047238
	speed: 0.1856s/iter; left time: 7415.7198s
	iters: 200, epoch: 4 | loss: 0.0001203
	speed: 0.0385s/iter; left time: 1536.5515s
	iters: 300, epoch: 4 | loss: 0.0262619
	speed: 0.0367s/iter; left time: 1460.0009s
	iters: 400, epoch: 4 | loss: 0.5835307
	speed: 0.0338s/iter; left time: 1340.5107s
Epoch: 4 cost time: 16.26826047897339
Epoch: 4, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.188 Vali Acc: 0.959 Test Loss: 0.188 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0960160
	speed: 0.1732s/iter; left time: 6848.4741s
	iters: 200, epoch: 5 | loss: 0.0335347
	speed: 0.0412s/iter; left time: 1625.2611s
	iters: 300, epoch: 5 | loss: 0.0064685
	speed: 0.0421s/iter; left time: 1656.1714s
	iters: 400, epoch: 5 | loss: 0.0004532
	speed: 0.0406s/iter; left time: 1591.8548s
Epoch: 5 cost time: 17.401442527770996
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0004853
	speed: 0.1648s/iter; left time: 6449.1261s
	iters: 200, epoch: 6 | loss: 0.0001137
	speed: 0.0340s/iter; left time: 1325.8523s
	iters: 300, epoch: 6 | loss: 0.0000004
	speed: 0.0389s/iter; left time: 1515.6587s
	iters: 400, epoch: 6 | loss: 0.0000006
	speed: 0.0404s/iter; left time: 1569.5675s
Epoch: 6 cost time: 15.877525329589844
Epoch: 6, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.174 Vali Acc: 0.971 Test Loss: 0.174 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.3847087
	speed: 0.1795s/iter; left time: 6952.5411s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 1361.8246s
	iters: 300, epoch: 7 | loss: 0.0000005
	speed: 0.0301s/iter; left time: 1160.1935s
	iters: 400, epoch: 7 | loss: 0.0000034
	speed: 0.0311s/iter; left time: 1194.1576s
Epoch: 7 cost time: 14.304495573043823
Epoch: 7, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.211 Vali Acc: 0.967 Test Loss: 0.211 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0677000
	speed: 0.1529s/iter; left time: 5859.0052s
	iters: 200, epoch: 8 | loss: 0.0000644
	speed: 0.0344s/iter; left time: 1312.7504s
	iters: 300, epoch: 8 | loss: 0.0000352
	speed: 0.0317s/iter; left time: 1208.6857s
	iters: 400, epoch: 8 | loss: 0.0081752
	speed: 0.0301s/iter; left time: 1145.0446s
Epoch: 8 cost time: 13.56597900390625
Epoch: 8, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.234 Vali Acc: 0.971 Test Loss: 0.234 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000117
	speed: 0.1541s/iter; left time: 5840.1421s
	iters: 200, epoch: 9 | loss: 0.0004093
	speed: 0.0277s/iter; left time: 1046.2681s
	iters: 300, epoch: 9 | loss: 0.0180682
	speed: 0.0327s/iter; left time: 1233.4793s
	iters: 400, epoch: 9 | loss: 0.5371361
	speed: 0.0273s/iter; left time: 1026.7577s
Epoch: 9 cost time: 13.238137006759644
Epoch: 9, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.262 Vali Acc: 0.970 Test Loss: 0.262 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000664
	speed: 0.1632s/iter; left time: 6116.5616s
	iters: 200, epoch: 10 | loss: 0.0000060
	speed: 0.0364s/iter; left time: 1359.2341s
	iters: 300, epoch: 10 | loss: 0.5015103
	speed: 0.0344s/iter; left time: 1282.0396s
	iters: 400, epoch: 10 | loss: 0.0010925
	speed: 0.0274s/iter; left time: 1017.8909s
Epoch: 10 cost time: 14.885889053344727
Epoch: 10, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.279 Vali Acc: 0.963 Test Loss: 0.279 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000391
	speed: 0.1562s/iter; left time: 5791.0473s
	iters: 200, epoch: 11 | loss: 0.0000096
	speed: 0.0304s/iter; left time: 1124.2503s
	iters: 300, epoch: 11 | loss: 0.0000009
	speed: 0.0356s/iter; left time: 1313.0077s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 1593.0135s
Epoch: 11 cost time: 15.21473503112793
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.211 Vali Acc: 0.973 Test Loss: 0.211 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.1737s/iter; left time: 6365.7946s
	iters: 200, epoch: 12 | loss: 0.0030801
	speed: 0.0354s/iter; left time: 1294.6485s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 1184.7130s
	iters: 400, epoch: 12 | loss: 0.0000613
	speed: 0.0302s/iter; left time: 1099.0292s
Epoch: 12 cost time: 14.884865045547485
Epoch: 12, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.199 Vali Acc: 0.972 Test Loss: 0.199 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.1539s/iter; left time: 5577.5940s
	iters: 200, epoch: 13 | loss: 0.4301894
	speed: 0.0306s/iter; left time: 1106.6343s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0318s/iter; left time: 1145.0735s
	iters: 400, epoch: 13 | loss: 0.0000084
	speed: 0.0319s/iter; left time: 1148.1728s
Epoch: 13 cost time: 13.399603843688965
Epoch: 13, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.268 Vali Acc: 0.971 Test Loss: 0.268 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9736243747157799
model parameter : 126218
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6537867
	speed: 0.0568s/iter; left time: 2341.7228s
	iters: 200, epoch: 1 | loss: 1.2173270
	speed: 0.0253s/iter; left time: 1040.8512s
	iters: 300, epoch: 1 | loss: 0.1336587
	speed: 0.0252s/iter; left time: 1031.5117s
	iters: 400, epoch: 1 | loss: 0.0169237
	speed: 0.0258s/iter; left time: 1055.9448s
Epoch: 1 cost time: 13.753488779067993
Epoch: 1, Steps: 413 | Train Loss: 0.442 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
Validation loss decreased (inf --> -0.953614).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0270850
	speed: 0.1579s/iter; left time: 6438.7448s
	iters: 200, epoch: 2 | loss: 0.0710266
	speed: 0.0363s/iter; left time: 1476.2772s
	iters: 300, epoch: 2 | loss: 0.3236551
	speed: 0.0290s/iter; left time: 1177.0471s
	iters: 400, epoch: 2 | loss: 0.0079489
	speed: 0.0310s/iter; left time: 1254.4482s
Epoch: 2 cost time: 14.305622339248657
Epoch: 2, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.090 Vali Acc: 0.966 Test Loss: 0.090 Test Acc: 0.966
Validation loss decreased (-0.953614 --> -0.966347).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0007827
	speed: 0.1569s/iter; left time: 6334.5438s
	iters: 200, epoch: 3 | loss: 0.2208614
	speed: 0.0341s/iter; left time: 1373.7928s
	iters: 300, epoch: 3 | loss: 0.1378267
	speed: 0.0378s/iter; left time: 1519.6276s
	iters: 400, epoch: 3 | loss: 0.1643969
	speed: 0.0352s/iter; left time: 1409.6408s
Epoch: 3 cost time: 15.484046936035156
Epoch: 3, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0316205
	speed: 0.1856s/iter; left time: 7417.8938s
	iters: 200, epoch: 4 | loss: 0.0002716
	speed: 0.0408s/iter; left time: 1627.0931s
	iters: 300, epoch: 4 | loss: 0.0110283
	speed: 0.0342s/iter; left time: 1361.5655s
	iters: 400, epoch: 4 | loss: 0.0225819
	speed: 0.0380s/iter; left time: 1505.7325s
Epoch: 4 cost time: 16.561524868011475
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
Validation loss decreased (-0.966347 --> -0.974533).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0121943
	speed: 0.1826s/iter; left time: 7221.2575s
	iters: 200, epoch: 5 | loss: 0.0001477
	speed: 0.0468s/iter; left time: 1845.9775s
	iters: 300, epoch: 5 | loss: 0.0023682
	speed: 0.0411s/iter; left time: 1615.9137s
	iters: 400, epoch: 5 | loss: 0.0000578
	speed: 0.0403s/iter; left time: 1581.2177s
Epoch: 5 cost time: 17.27063012123108
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.238 Vali Acc: 0.957 Test Loss: 0.238 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0009155
	speed: 0.1739s/iter; left time: 6807.3602s
	iters: 200, epoch: 6 | loss: 0.0015823
	speed: 0.0406s/iter; left time: 1584.7862s
	iters: 300, epoch: 6 | loss: 0.0090274
	speed: 0.0392s/iter; left time: 1525.0884s
	iters: 400, epoch: 6 | loss: 0.0000001
	speed: 0.0375s/iter; left time: 1456.8368s
Epoch: 6 cost time: 17.083112716674805
Epoch: 6, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000695
	speed: 0.1616s/iter; left time: 6259.0545s
	iters: 200, epoch: 7 | loss: 0.0000101
	speed: 0.0406s/iter; left time: 1566.7375s
	iters: 300, epoch: 7 | loss: 0.1506905
	speed: 0.0346s/iter; left time: 1331.8944s
	iters: 400, epoch: 7 | loss: 0.0015717
	speed: 0.0344s/iter; left time: 1321.3922s
Epoch: 7 cost time: 15.842413663864136
Epoch: 7, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4945125
	speed: 0.1683s/iter; left time: 6446.8131s
	iters: 200, epoch: 8 | loss: 0.0000175
	speed: 0.0344s/iter; left time: 1316.0319s
	iters: 300, epoch: 8 | loss: 0.0041811
	speed: 0.0321s/iter; left time: 1224.6125s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.0325s/iter; left time: 1235.2295s
Epoch: 8 cost time: 14.034919738769531
Epoch: 8, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.175 Vali Acc: 0.971 Test Loss: 0.175 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000191
	speed: 0.1725s/iter; left time: 6536.7431s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0381s/iter; left time: 1440.3184s
	iters: 300, epoch: 9 | loss: 0.0019514
	speed: 0.0387s/iter; left time: 1459.8098s
	iters: 400, epoch: 9 | loss: 0.0000239
	speed: 0.0357s/iter; left time: 1340.9150s
Epoch: 9 cost time: 16.613001823425293
Epoch: 9, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.974533 --> -0.980444).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1893s/iter; left time: 7095.6702s
	iters: 200, epoch: 10 | loss: 0.0000503
	speed: 0.0385s/iter; left time: 1440.8445s
	iters: 300, epoch: 10 | loss: 0.0000005
	speed: 0.0338s/iter; left time: 1260.8812s
	iters: 400, epoch: 10 | loss: 0.0000054
	speed: 0.0448s/iter; left time: 1666.9001s
Epoch: 10 cost time: 17.477598667144775
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.223 Vali Acc: 0.972 Test Loss: 0.223 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0299111
	speed: 0.2034s/iter; left time: 7538.4953s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 1224.3610s
	iters: 300, epoch: 11 | loss: 0.0068033
	speed: 0.0358s/iter; left time: 1321.2930s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0313s/iter; left time: 1149.2843s
Epoch: 11 cost time: 16.020351886749268
Epoch: 11, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.338 Vali Acc: 0.958 Test Loss: 0.338 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000074
	speed: 0.1696s/iter; left time: 6218.1158s
	iters: 200, epoch: 12 | loss: 0.0000005
	speed: 0.0401s/iter; left time: 1465.6242s
	iters: 300, epoch: 12 | loss: 0.0000019
	speed: 0.0410s/iter; left time: 1495.6805s
	iters: 400, epoch: 12 | loss: 0.0000003
	speed: 0.0387s/iter; left time: 1405.7577s
Epoch: 12 cost time: 16.843295574188232
Epoch: 12, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0015619
	speed: 0.1793s/iter; left time: 6499.9512s
	iters: 200, epoch: 13 | loss: 0.0000103
	speed: 0.0348s/iter; left time: 1256.1663s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0306s/iter; left time: 1104.4944s
	iters: 400, epoch: 13 | loss: 0.0000145
	speed: 0.0327s/iter; left time: 1176.4464s
Epoch: 13 cost time: 14.701339721679688
Epoch: 13, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.231 Vali Acc: 0.967 Test Loss: 0.231 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000005
	speed: 0.1844s/iter; left time: 6607.6316s
	iters: 200, epoch: 14 | loss: 0.0047807
	speed: 0.0372s/iter; left time: 1327.6563s
	iters: 300, epoch: 14 | loss: 0.0971831
	speed: 0.0393s/iter; left time: 1400.1236s
	iters: 400, epoch: 14 | loss: 0.0000002
	speed: 0.0383s/iter; left time: 1359.8158s
Epoch: 14 cost time: 16.376817226409912
Epoch: 14, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1754s/iter; left time: 6212.4669s
	iters: 200, epoch: 15 | loss: 0.5566809
	speed: 0.0369s/iter; left time: 1304.8568s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0357s/iter; left time: 1257.3521s
	iters: 400, epoch: 15 | loss: 0.0000002
	speed: 0.0384s/iter; left time: 1349.5799s
Epoch: 15 cost time: 16.142317533493042
Epoch: 15, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.239 Vali Acc: 0.971 Test Loss: 0.239 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1826s/iter; left time: 6393.1091s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0303s/iter; left time: 1057.7300s
	iters: 300, epoch: 16 | loss: 0.1278746
	speed: 0.0350s/iter; left time: 1218.8215s
	iters: 400, epoch: 16 | loss: 0.0039787
	speed: 0.0357s/iter; left time: 1238.8062s
Epoch: 16 cost time: 14.628074884414673
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0021181
	speed: 0.1866s/iter; left time: 6455.7252s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 1274.6148s
	iters: 300, epoch: 17 | loss: 0.0001868
	speed: 0.0389s/iter; left time: 1336.7053s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0326s/iter; left time: 1117.5595s
Epoch: 17 cost time: 15.596034049987793
Epoch: 17, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.269 Vali Acc: 0.965 Test Loss: 0.269 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1688s/iter; left time: 5769.1823s
	iters: 200, epoch: 18 | loss: 0.0000014
	speed: 0.0329s/iter; left time: 1122.0765s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0289s/iter; left time: 981.7977s
	iters: 400, epoch: 18 | loss: 0.0405777
	speed: 0.0376s/iter; left time: 1274.4113s
Epoch: 18 cost time: 14.531829118728638
Epoch: 18, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 0.1831s/iter; left time: 6183.9942s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 1063.7110s
	iters: 300, epoch: 19 | loss: 0.0015394
	speed: 0.0326s/iter; left time: 1093.8422s
	iters: 400, epoch: 19 | loss: 0.0000002
	speed: 0.0263s/iter; left time: 879.5981s
Epoch: 19 cost time: 13.763149738311768
Epoch: 19, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 109898
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4670941
	speed: 0.0972s/iter; left time: 4005.3718s
	iters: 200, epoch: 1 | loss: 0.6022332
	speed: 0.0629s/iter; left time: 2584.1317s
	iters: 300, epoch: 1 | loss: 0.2791733
	speed: 0.0595s/iter; left time: 2441.0607s
	iters: 400, epoch: 1 | loss: 0.0003927
	speed: 0.0541s/iter; left time: 2212.0295s
Epoch: 1 cost time: 28.408236742019653
Epoch: 1, Steps: 413 | Train Loss: 0.455 Vali Loss: 0.504 Vali Acc: 0.932 Test Loss: 0.504 Test Acc: 0.932
Validation loss decreased (inf --> -0.932237).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2730460
	speed: 0.2081s/iter; left time: 8489.4453s
	iters: 200, epoch: 2 | loss: 0.3825822
	speed: 0.0614s/iter; left time: 2496.5210s
	iters: 300, epoch: 2 | loss: 0.0012651
	speed: 0.0613s/iter; left time: 2489.3999s
	iters: 400, epoch: 2 | loss: 0.0000002
	speed: 0.0620s/iter; left time: 2508.6130s
Epoch: 2 cost time: 25.386828660964966
Epoch: 2, Steps: 413 | Train Loss: 0.203 Vali Loss: 0.311 Vali Acc: 0.957 Test Loss: 0.311 Test Acc: 0.957
Validation loss decreased (-0.932237 --> -0.956795).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0015454
	speed: 0.2308s/iter; left time: 9318.3186s
	iters: 200, epoch: 3 | loss: 1.1713719
	speed: 0.0545s/iter; left time: 2196.4844s
	iters: 300, epoch: 3 | loss: 0.5725582
	speed: 0.0583s/iter; left time: 2342.6022s
	iters: 400, epoch: 3 | loss: 1.8018569
	speed: 0.0592s/iter; left time: 2373.0131s
Epoch: 3 cost time: 23.955806493759155
Epoch: 3, Steps: 413 | Train Loss: 0.193 Vali Loss: 0.521 Vali Acc: 0.948 Test Loss: 0.521 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6282970
	speed: 0.2420s/iter; left time: 9670.1762s
	iters: 200, epoch: 4 | loss: 0.0398591
	speed: 0.0673s/iter; left time: 2683.9856s
	iters: 300, epoch: 4 | loss: 0.0004322
	speed: 0.0696s/iter; left time: 2766.6863s
	iters: 400, epoch: 4 | loss: 0.0000160
	speed: 0.0654s/iter; left time: 2595.1858s
Epoch: 4 cost time: 29.491979122161865
Epoch: 4, Steps: 413 | Train Loss: 0.151 Vali Loss: 0.404 Vali Acc: 0.955 Test Loss: 0.404 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0019128
	speed: 0.2204s/iter; left time: 8718.1632s
	iters: 200, epoch: 5 | loss: 0.5756959
	speed: 0.0578s/iter; left time: 2279.2722s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 2347.3826s
	iters: 400, epoch: 5 | loss: 0.0000004
	speed: 0.0626s/iter; left time: 2458.6286s
Epoch: 5 cost time: 25.543331384658813
Epoch: 5, Steps: 413 | Train Loss: 0.142 Vali Loss: 0.522 Vali Acc: 0.960 Test Loss: 0.522 Test Acc: 0.960
Validation loss decreased (-0.956795 --> -0.959977).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2310s/iter; left time: 9042.1120s
	iters: 200, epoch: 6 | loss: 0.0000003
	speed: 0.0543s/iter; left time: 2118.3157s
	iters: 300, epoch: 6 | loss: 0.0032001
	speed: 0.0689s/iter; left time: 2682.7443s
	iters: 400, epoch: 6 | loss: 0.9032691
	speed: 0.0623s/iter; left time: 2420.9062s
Epoch: 6 cost time: 25.345208883285522
Epoch: 6, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.513 Vali Acc: 0.963 Test Loss: 0.513 Test Acc: 0.963
Validation loss decreased (-0.959977 --> -0.963160).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2309s/iter; left time: 8942.1017s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1871.8465s
	iters: 300, epoch: 7 | loss: 0.0000030
	speed: 0.0464s/iter; left time: 1787.2079s
	iters: 400, epoch: 7 | loss: 0.4260597
	speed: 0.0471s/iter; left time: 1808.0663s
Epoch: 7 cost time: 20.862178564071655
Epoch: 7, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.553 Vali Acc: 0.966 Test Loss: 0.553 Test Acc: 0.966
Validation loss decreased (-0.963160 --> -0.966343).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0002050
	speed: 0.2420s/iter; left time: 9270.8226s
	iters: 200, epoch: 8 | loss: 0.0048999
	speed: 0.0602s/iter; left time: 2299.0081s
	iters: 300, epoch: 8 | loss: 1.1033417
	speed: 0.0597s/iter; left time: 2276.8738s
	iters: 400, epoch: 8 | loss: 0.0341928
	speed: 0.0491s/iter; left time: 1866.7892s
Epoch: 8 cost time: 23.90617299079895
Epoch: 8, Steps: 413 | Train Loss: 0.170 Vali Loss: 0.455 Vali Acc: 0.970 Test Loss: 0.455 Test Acc: 0.970
Validation loss decreased (-0.966343 --> -0.969982).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.1078711
	speed: 0.2174s/iter; left time: 8239.2484s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0505s/iter; left time: 1907.8016s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1710.1401s
	iters: 400, epoch: 9 | loss: 0.3948092
	speed: 0.0421s/iter; left time: 1583.8136s
Epoch: 9 cost time: 21.225828170776367
Epoch: 9, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.568 Vali Acc: 0.968 Test Loss: 0.568 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0509295
	speed: 0.2343s/iter; left time: 8781.2670s
	iters: 200, epoch: 10 | loss: 0.0000004
	speed: 0.0667s/iter; left time: 2495.0858s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0618s/iter; left time: 2303.4816s
	iters: 400, epoch: 10 | loss: 0.3135301
	speed: 0.0479s/iter; left time: 1781.8951s
Epoch: 10 cost time: 25.815295696258545
Epoch: 10, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.549 Vali Acc: 0.968 Test Loss: 0.549 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000056
	speed: 0.2305s/iter; left time: 8543.0179s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0604s/iter; left time: 2234.6236s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0575s/iter; left time: 2120.7702s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 1874.7580s
Epoch: 11 cost time: 24.609458446502686
Epoch: 11, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.581 Vali Acc: 0.970 Test Loss: 0.581 Test Acc: 0.970
Validation loss decreased (-0.969982 --> -0.970435).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2111s/iter; left time: 7737.0675s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 2296.6240s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 2289.3040s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 2274.2539s
Epoch: 12 cost time: 24.763896465301514
Epoch: 12, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.715 Vali Acc: 0.970 Test Loss: 0.715 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0006922
	speed: 0.2157s/iter; left time: 7817.5465s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0502s/iter; left time: 1816.2680s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0573s/iter; left time: 2066.0995s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 2209.5562s
Epoch: 13 cost time: 24.931357383728027
Epoch: 13, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.590 Vali Acc: 0.970 Test Loss: 0.590 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2404s/iter; left time: 8612.2872s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0613s/iter; left time: 2191.0344s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0646s/iter; left time: 2303.3860s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 2066.0648s
Epoch: 14 cost time: 25.57507610321045
Epoch: 14, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.761 Vali Acc: 0.962 Test Loss: 0.761 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2489s/iter; left time: 8814.5290s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 2112.5795s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0537s/iter; left time: 1891.9827s
	iters: 400, epoch: 15 | loss: 0.0425083
	speed: 0.0615s/iter; left time: 2159.1484s
Epoch: 15 cost time: 26.217077493667603
Epoch: 15, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.544 Vali Acc: 0.973 Test Loss: 0.544 Test Acc: 0.973
Validation loss decreased (-0.970435 --> -0.973164).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2470s/iter; left time: 8646.0647s
	iters: 200, epoch: 16 | loss: 0.0006450
	speed: 0.0590s/iter; left time: 2060.8432s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 2094.8456s
	iters: 400, epoch: 16 | loss: 0.0000055
	speed: 0.0645s/iter; left time: 2236.8528s
Epoch: 16 cost time: 25.843909740447998
Epoch: 16, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.591 Vali Acc: 0.972 Test Loss: 0.591 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2625s/iter; left time: 9080.5904s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0874s/iter; left time: 3015.8952s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0724s/iter; left time: 2488.9250s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0722s/iter; left time: 2476.7232s
Epoch: 17 cost time: 32.44328832626343
Epoch: 17, Steps: 413 | Train Loss: 0.051 Vali Loss: 1.054 Vali Acc: 0.965 Test Loss: 1.054 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2794s/iter; left time: 9550.9702s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0831s/iter; left time: 2830.9066s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 2709.1869s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 2800.6830s
Epoch: 18 cost time: 35.15470623970032
Epoch: 18, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.664 Vali Acc: 0.971 Test Loss: 0.664 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2411s/iter; left time: 8141.2543s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0667s/iter; left time: 2245.8986s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0822s/iter; left time: 2759.9352s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0679s/iter; left time: 2272.8507s
Epoch: 19 cost time: 28.59975838661194
Epoch: 19, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.809 Vali Acc: 0.970 Test Loss: 0.809 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2351s/iter; left time: 7841.2452s
	iters: 200, epoch: 20 | loss: 0.0000008
	speed: 0.0533s/iter; left time: 1772.3866s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 2044.3508s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 2032.6530s
Epoch: 20 cost time: 25.04098892211914
Epoch: 20, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.671 Vali Acc: 0.968 Test Loss: 0.671 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000004
	speed: 0.2266s/iter; left time: 7465.2473s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 1693.2709s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 1760.8108s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 2161.7082s
Epoch: 21 cost time: 23.772831439971924
Epoch: 21, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.588 Vali Acc: 0.974 Test Loss: 0.588 Test Acc: 0.974
Validation loss decreased (-0.973164 --> -0.974073).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2390s/iter; left time: 7774.5159s
	iters: 200, epoch: 22 | loss: 0.0007515
	speed: 0.0532s/iter; left time: 1726.2208s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0582s/iter; left time: 1880.9245s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0495s/iter; left time: 1594.9337s
Epoch: 22 cost time: 23.471330642700195
Epoch: 22, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.830 Vali Acc: 0.966 Test Loss: 0.830 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2596s/iter; left time: 8336.8250s
	iters: 200, epoch: 23 | loss: 0.0277284
	speed: 0.0511s/iter; left time: 1635.5183s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 1675.0701s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0641s/iter; left time: 2039.0751s
Epoch: 23 cost time: 24.02540111541748
Epoch: 23, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.521 Vali Acc: 0.978 Test Loss: 0.521 Test Acc: 0.978
Validation loss decreased (-0.974073 --> -0.977712).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2643s/iter; left time: 8379.2089s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 2132.2538s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0627s/iter; left time: 1975.7628s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0637s/iter; left time: 1998.8252s
Epoch: 24 cost time: 28.150972604751587
Epoch: 24, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.703 Vali Acc: 0.966 Test Loss: 0.703 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2213s/iter; left time: 6924.9463s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0650s/iter; left time: 2028.7911s
	iters: 300, epoch: 25 | loss: 1.7260871
	speed: 0.0519s/iter; left time: 1612.4867s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 1354.3684s
Epoch: 25 cost time: 23.113905906677246
Epoch: 25, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.544 Vali Acc: 0.974 Test Loss: 0.544 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.8373972
	speed: 0.2257s/iter; left time: 6967.4773s
	iters: 200, epoch: 26 | loss: 0.2190770
	speed: 0.0591s/iter; left time: 1818.1505s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1314.1602s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 1998.2992s
Epoch: 26 cost time: 23.646539211273193
Epoch: 26, Steps: 413 | Train Loss: 0.075 Vali Loss: 1.127 Vali Acc: 0.963 Test Loss: 1.127 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2375s/iter; left time: 7234.1431s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 1672.8192s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0645s/iter; left time: 1951.5912s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0849s/iter; left time: 2560.4008s
Epoch: 27 cost time: 27.430579900741577
Epoch: 27, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.856 Vali Acc: 0.975 Test Loss: 0.856 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0007570
	speed: 0.2476s/iter; left time: 7441.5502s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0616s/iter; left time: 1844.0187s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0554s/iter; left time: 1653.4208s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1350.2732s
Epoch: 28 cost time: 23.9647958278656
Epoch: 28, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.865 Vali Acc: 0.972 Test Loss: 0.865 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1986s/iter; left time: 5885.6183s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0424s/iter; left time: 1251.0717s
	iters: 300, epoch: 29 | loss: 0.0001682
	speed: 0.0443s/iter; left time: 1303.7860s
	iters: 400, epoch: 29 | loss: 0.0127004
	speed: 0.0481s/iter; left time: 1410.5501s
Epoch: 29 cost time: 19.520123720169067
Epoch: 29, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.889 Vali Acc: 0.975 Test Loss: 0.889 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2263s/iter; left time: 6614.6265s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0620s/iter; left time: 1804.9562s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 1593.2827s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0748s/iter; left time: 2163.8844s
Epoch: 30 cost time: 26.227628469467163
Epoch: 30, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.575 Vali Acc: 0.977 Test Loss: 0.575 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2540s/iter; left time: 7317.2726s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0653s/iter; left time: 1874.2842s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0542s/iter; left time: 1550.5275s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1345.7021s
Epoch: 31 cost time: 24.92834782600403
Epoch: 31, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.595 Vali Acc: 0.973 Test Loss: 0.595 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2367s/iter; left time: 6722.9477s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0690s/iter; left time: 1953.3972s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0728s/iter; left time: 2052.4846s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 1990.7477s
Epoch: 32 cost time: 28.678998231887817
Epoch: 32, Steps: 413 | Train Loss: 0.041 Vali Loss: 1.308 Vali Acc: 0.953 Test Loss: 1.308 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2393s/iter; left time: 6697.2434s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 1745.1705s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0613s/iter; left time: 1703.7233s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 2028.4209s
Epoch: 33 cost time: 27.917560577392578
Epoch: 33, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.893 Vali Acc: 0.970 Test Loss: 0.893 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 424842
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1749684
	speed: 0.1136s/iter; left time: 4678.6324s
	iters: 200, epoch: 1 | loss: 0.5527451
	speed: 0.0692s/iter; left time: 2844.2419s
	iters: 300, epoch: 1 | loss: 0.2446011
	speed: 0.0681s/iter; left time: 2791.8092s
	iters: 400, epoch: 1 | loss: 1.9398346
	speed: 0.0816s/iter; left time: 3335.9782s
Epoch: 1 cost time: 34.348780155181885
Epoch: 1, Steps: 413 | Train Loss: 0.374 Vali Loss: 0.217 Vali Acc: 0.953 Test Loss: 0.217 Test Acc: 0.953
Validation loss decreased (inf --> -0.952704).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0006150
	speed: 0.2403s/iter; left time: 9802.9720s
	iters: 200, epoch: 2 | loss: 0.0018918
	speed: 0.0577s/iter; left time: 2346.0378s
	iters: 300, epoch: 2 | loss: 0.3034106
	speed: 0.0557s/iter; left time: 2262.3432s
	iters: 400, epoch: 2 | loss: 0.0085853
	speed: 0.0475s/iter; left time: 1924.9397s
Epoch: 2 cost time: 23.380813121795654
Epoch: 2, Steps: 413 | Train Loss: 0.190 Vali Loss: 0.198 Vali Acc: 0.961 Test Loss: 0.198 Test Acc: 0.961
Validation loss decreased (-0.952704 --> -0.961344).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0067030
	speed: 0.2500s/iter; left time: 10095.3150s
	iters: 200, epoch: 3 | loss: 0.9490571
	speed: 0.0520s/iter; left time: 2094.5170s
	iters: 300, epoch: 3 | loss: 0.0000024
	speed: 0.0400s/iter; left time: 1606.8798s
	iters: 400, epoch: 3 | loss: 0.4484333
	speed: 0.0453s/iter; left time: 1815.9028s
Epoch: 3 cost time: 23.406139850616455
Epoch: 3, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.254 Vali Acc: 0.965 Test Loss: 0.254 Test Acc: 0.965
Validation loss decreased (-0.961344 --> -0.965436).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0353289
	speed: 0.2208s/iter; left time: 8821.6197s
	iters: 200, epoch: 4 | loss: 0.3542417
	speed: 0.0609s/iter; left time: 2426.9067s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.0682s/iter; left time: 2711.3810s
	iters: 400, epoch: 4 | loss: 0.0006161
	speed: 0.0764s/iter; left time: 3030.8349s
Epoch: 4 cost time: 27.715794563293457
Epoch: 4, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.405 Vali Acc: 0.954 Test Loss: 0.405 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0022357
	speed: 0.2149s/iter; left time: 8498.5791s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 2165.7804s
	iters: 300, epoch: 5 | loss: 0.0000477
	speed: 0.0454s/iter; left time: 1787.1315s
	iters: 400, epoch: 5 | loss: 0.0475165
	speed: 0.0547s/iter; left time: 2147.4679s
Epoch: 5 cost time: 21.537363052368164
Epoch: 5, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.367 Vali Acc: 0.959 Test Loss: 0.367 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2214s/iter; left time: 8664.6973s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 1793.5062s
	iters: 300, epoch: 6 | loss: 0.0001936
	speed: 0.0404s/iter; left time: 1572.0878s
	iters: 400, epoch: 6 | loss: 0.0012487
	speed: 0.0485s/iter; left time: 1883.8490s
Epoch: 6 cost time: 19.768479585647583
Epoch: 6, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.327 Vali Acc: 0.964 Test Loss: 0.327 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2429s/iter; left time: 9407.3356s
	iters: 200, epoch: 7 | loss: 0.0001220
	speed: 0.0674s/iter; left time: 2602.2381s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 2055.5109s
	iters: 400, epoch: 7 | loss: 0.0005097
	speed: 0.0540s/iter; left time: 2073.2996s
Epoch: 7 cost time: 25.870322704315186
Epoch: 7, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.356 Vali Acc: 0.961 Test Loss: 0.356 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000006
	speed: 0.2443s/iter; left time: 9357.2535s
	iters: 200, epoch: 8 | loss: 0.0283992
	speed: 0.0883s/iter; left time: 3372.7364s
	iters: 300, epoch: 8 | loss: 0.0000983
	speed: 0.0934s/iter; left time: 3560.7251s
	iters: 400, epoch: 8 | loss: 0.0000003
	speed: 0.0793s/iter; left time: 3012.5268s
Epoch: 8 cost time: 34.48768877983093
Epoch: 8, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.677 Vali Acc: 0.956 Test Loss: 0.677 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000267
	speed: 0.2536s/iter; left time: 9610.8494s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0602s/iter; left time: 2274.2790s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 2672.3969s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 3259.4285s
Epoch: 9 cost time: 30.702001810073853
Epoch: 9, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.487 Vali Acc: 0.970 Test Loss: 0.487 Test Acc: 0.970
Validation loss decreased (-0.965436 --> -0.969527).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0118351
	speed: 0.2280s/iter; left time: 8546.8358s
	iters: 200, epoch: 10 | loss: 0.0000004
	speed: 0.0508s/iter; left time: 1899.2508s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0661s/iter; left time: 2464.3291s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0725s/iter; left time: 2696.7291s
Epoch: 10 cost time: 25.857605934143066
Epoch: 10, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.650 Vali Acc: 0.960 Test Loss: 0.650 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2642s/iter; left time: 9794.5366s
	iters: 200, epoch: 11 | loss: 0.0000089
	speed: 0.0605s/iter; left time: 2237.7667s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0616s/iter; left time: 2269.9343s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0554s/iter; left time: 2038.4869s
Epoch: 11 cost time: 27.91072702407837
Epoch: 11, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.463 Vali Acc: 0.971 Test Loss: 0.463 Test Acc: 0.971
Validation loss decreased (-0.969527 --> -0.970891).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000257
	speed: 0.2475s/iter; left time: 9072.7936s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0719s/iter; left time: 2627.9192s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0749s/iter; left time: 2729.3701s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 2763.7184s
Epoch: 12 cost time: 30.311532258987427
Epoch: 12, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.451 Vali Acc: 0.967 Test Loss: 0.451 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1309792
	speed: 0.2271s/iter; left time: 8229.7966s
	iters: 200, epoch: 13 | loss: 0.4338183
	speed: 0.0848s/iter; left time: 3064.7493s
	iters: 300, epoch: 13 | loss: 0.0000445
	speed: 0.0822s/iter; left time: 2963.2469s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 2840.0170s
Epoch: 13 cost time: 32.763367652893066
Epoch: 13, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.589 Vali Acc: 0.967 Test Loss: 0.589 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000399
	speed: 0.2412s/iter; left time: 8641.9440s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 1887.8376s
	iters: 300, epoch: 14 | loss: 0.7248677
	speed: 0.0537s/iter; left time: 1912.1297s
	iters: 400, epoch: 14 | loss: 0.0000083
	speed: 0.0876s/iter; left time: 3112.6142s
Epoch: 14 cost time: 26.42908215522766
Epoch: 14, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.500 Vali Acc: 0.974 Test Loss: 0.500 Test Acc: 0.974
Validation loss decreased (-0.970891 --> -0.974074).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2265s/iter; left time: 8021.9629s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0396s/iter; left time: 1399.1142s
	iters: 300, epoch: 15 | loss: 0.0000357
	speed: 0.0374s/iter; left time: 1316.4478s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 1514.7595s
Epoch: 15 cost time: 17.799884557724
Epoch: 15, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.531 Vali Acc: 0.972 Test Loss: 0.531 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2267s/iter; left time: 7936.1366s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0555s/iter; left time: 1935.6565s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 1855.7551s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 2068.5465s
Epoch: 16 cost time: 23.860172510147095
Epoch: 16, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.551 Vali Acc: 0.972 Test Loss: 0.551 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2078s/iter; left time: 7186.7200s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 1754.9076s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 2249.9922s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0680s/iter; left time: 2331.3814s
Epoch: 17 cost time: 23.991688013076782
Epoch: 17, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.578 Vali Acc: 0.972 Test Loss: 0.578 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.1295542
	speed: 0.2199s/iter; left time: 7517.7211s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 1384.6046s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0447s/iter; left time: 1517.4930s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 1930.1677s
Epoch: 18 cost time: 21.013856172561646
Epoch: 18, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.489 Vali Acc: 0.974 Test Loss: 0.489 Test Acc: 0.974
Validation loss decreased (-0.974074 --> -0.974074).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2197s/iter; left time: 7419.4843s
	iters: 200, epoch: 19 | loss: 0.5239294
	speed: 0.0423s/iter; left time: 1425.6909s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 1648.7123s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 2224.4367s
Epoch: 19 cost time: 22.1446852684021
Epoch: 19, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.481 Vali Acc: 0.980 Test Loss: 0.481 Test Acc: 0.980
Validation loss decreased (-0.974074 --> -0.979531).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2735s/iter; left time: 9121.1776s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0955s/iter; left time: 3176.1542s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0711s/iter; left time: 2356.5674s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0719s/iter; left time: 2376.5099s
Epoch: 20 cost time: 34.24877715110779
Epoch: 20, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.462 Vali Acc: 0.973 Test Loss: 0.462 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2628s/iter; left time: 8657.1249s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0814s/iter; left time: 2671.7349s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0741s/iter; left time: 2425.1694s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0931s/iter; left time: 3037.4778s
Epoch: 21 cost time: 33.585002183914185
Epoch: 21, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.810 Vali Acc: 0.963 Test Loss: 0.810 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2605s/iter; left time: 8472.5196s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0661s/iter; left time: 2144.3434s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 2550.3760s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 2288.5134s
Epoch: 22 cost time: 29.88237428665161
Epoch: 22, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.893 Vali Acc: 0.960 Test Loss: 0.893 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2270s/iter; left time: 7291.5289s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 2005.3223s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0737s/iter; left time: 2353.2263s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0859s/iter; left time: 2732.8514s
Epoch: 23 cost time: 29.49895477294922
Epoch: 23, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.628 Vali Acc: 0.971 Test Loss: 0.628 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0003214
	speed: 0.2255s/iter; left time: 7147.5141s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0621s/iter; left time: 1961.9004s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 1808.0078s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0616s/iter; left time: 1934.8900s
Epoch: 24 cost time: 25.03610920906067
Epoch: 24, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.776 Vali Acc: 0.969 Test Loss: 0.776 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2581s/iter; left time: 8075.5515s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 2479.5578s
	iters: 300, epoch: 25 | loss: 0.3161515
	speed: 0.0788s/iter; left time: 2449.7082s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0683s/iter; left time: 2116.2814s
Epoch: 25 cost time: 31.68420672416687
Epoch: 25, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.550 Vali Acc: 0.979 Test Loss: 0.550 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.7346764
	speed: 0.2651s/iter; left time: 8185.1226s
	iters: 200, epoch: 26 | loss: 0.0007225
	speed: 0.0623s/iter; left time: 1918.7907s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0770s/iter; left time: 2361.9933s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 1786.4914s
Epoch: 26 cost time: 30.487847566604614
Epoch: 26, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.538 Vali Acc: 0.977 Test Loss: 0.538 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2020s/iter; left time: 6153.9086s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 1371.3257s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0646s/iter; left time: 1956.2055s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0721s/iter; left time: 2173.8465s
Epoch: 27 cost time: 24.194339990615845
Epoch: 27, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.458 Vali Acc: 0.978 Test Loss: 0.458 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2185s/iter; left time: 6565.1081s
	iters: 200, epoch: 28 | loss: 0.0036270
	speed: 0.0455s/iter; left time: 1362.2241s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 1304.1579s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 1312.0530s
Epoch: 28 cost time: 18.74095368385315
Epoch: 28, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.686 Vali Acc: 0.975 Test Loss: 0.686 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2198s/iter; left time: 6513.7356s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0399s/iter; left time: 1178.4331s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 1304.7527s
	iters: 400, epoch: 29 | loss: 0.3697533
	speed: 0.0640s/iter; left time: 1878.8866s
Epoch: 29 cost time: 20.661148071289062
Epoch: 29, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.467 Vali Acc: 0.981 Test Loss: 0.467 Test Acc: 0.981
Validation loss decreased (-0.979531 --> -0.981350).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2435s/iter; left time: 7116.3934s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1321.6198s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 1374.3015s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 1065.3545s
Epoch: 30 cost time: 20.64962124824524
Epoch: 30, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.605 Vali Acc: 0.975 Test Loss: 0.605 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2662s/iter; left time: 7668.6975s
	iters: 200, epoch: 31 | loss: 0.0000034
	speed: 0.0910s/iter; left time: 2611.5306s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0999s/iter; left time: 2857.7274s
	iters: 400, epoch: 31 | loss: 0.0000680
	speed: 0.0763s/iter; left time: 2174.7856s
Epoch: 31 cost time: 36.209280252456665
Epoch: 31, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.572 Vali Acc: 0.980 Test Loss: 0.572 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2617s/iter; left time: 7430.6284s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0812s/iter; left time: 2299.1382s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0822s/iter; left time: 2319.2784s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 2133.7089s
Epoch: 32 cost time: 33.13754439353943
Epoch: 32, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.750 Vali Acc: 0.967 Test Loss: 0.750 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2006s/iter; left time: 5612.6501s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0608s/iter; left time: 1696.0659s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0712s/iter; left time: 1978.2981s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 1575.1404s
Epoch: 33 cost time: 25.3269944190979
Epoch: 33, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.857 Vali Acc: 0.969 Test Loss: 0.857 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2346s/iter; left time: 6468.3846s
	iters: 200, epoch: 34 | loss: 0.4333177
	speed: 0.0596s/iter; left time: 1636.7814s
	iters: 300, epoch: 34 | loss: 1.4849343
	speed: 0.0513s/iter; left time: 1405.4704s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0560s/iter; left time: 1527.4079s
Epoch: 34 cost time: 24.718454122543335
Epoch: 34, Steps: 413 | Train Loss: 0.029 Vali Loss: 1.074 Vali Acc: 0.958 Test Loss: 1.074 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2259s/iter; left time: 6134.4139s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 1482.4155s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 2097.8909s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0752s/iter; left time: 2018.4838s
Epoch: 35 cost time: 28.549048900604248
Epoch: 35, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.657 Vali Acc: 0.974 Test Loss: 0.657 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2367s/iter; left time: 6330.1046s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 1529.8825s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 1175.4324s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 1144.1735s
Epoch: 36 cost time: 21.908230304718018
Epoch: 36, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.581 Vali Acc: 0.975 Test Loss: 0.581 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.2489s/iter; left time: 6554.3248s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 1385.6264s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 1696.2624s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 1459.7311s
Epoch: 37 cost time: 24.909271478652954
Epoch: 37, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.644 Vali Acc: 0.970 Test Loss: 0.644 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2644s/iter; left time: 6853.8397s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0657s/iter; left time: 1696.1851s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 1063.4612s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1101.6916s
Epoch: 38 cost time: 25.356696128845215
Epoch: 38, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.717 Vali Acc: 0.973 Test Loss: 0.717 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.2045s/iter; left time: 5215.8104s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 1355.9405s
	iters: 300, epoch: 39 | loss: 0.1375960
	speed: 0.0516s/iter; left time: 1305.1083s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 1678.7602s
Epoch: 39 cost time: 22.663816690444946
Epoch: 39, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.568 Vali Acc: 0.975 Test Loss: 0.568 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 291850
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1514421
	speed: 0.0745s/iter; left time: 3067.9491s
	iters: 200, epoch: 1 | loss: 0.4885120
	speed: 0.0365s/iter; left time: 1499.6009s
	iters: 300, epoch: 1 | loss: 0.0693854
	speed: 0.0352s/iter; left time: 1441.8691s
	iters: 400, epoch: 1 | loss: 0.0049252
	speed: 0.0380s/iter; left time: 1556.2399s
Epoch: 1 cost time: 19.363008499145508
Epoch: 1, Steps: 413 | Train Loss: 0.375 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
Validation loss decreased (inf --> -0.948611).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4534407
	speed: 0.1873s/iter; left time: 7639.4345s
	iters: 200, epoch: 2 | loss: 0.0941931
	speed: 0.0374s/iter; left time: 1521.6757s
	iters: 300, epoch: 2 | loss: 0.0054914
	speed: 0.0349s/iter; left time: 1418.0535s
	iters: 400, epoch: 2 | loss: 0.4007819
	speed: 0.0421s/iter; left time: 1705.9574s
Epoch: 2 cost time: 17.64892292022705
Epoch: 2, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
Validation loss decreased (-0.948611 --> -0.964528).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0039262
	speed: 0.2639s/iter; left time: 10655.1938s
	iters: 200, epoch: 3 | loss: 0.0000426
	speed: 0.0761s/iter; left time: 3066.5720s
	iters: 300, epoch: 3 | loss: 0.1798197
	speed: 0.0702s/iter; left time: 2821.6428s
	iters: 400, epoch: 3 | loss: 0.0042435
	speed: 0.0737s/iter; left time: 2952.8016s
Epoch: 3 cost time: 33.56077599525452
Epoch: 3, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.330 Vali Acc: 0.959 Test Loss: 0.330 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000039
	speed: 0.2369s/iter; left time: 9468.6745s
	iters: 200, epoch: 4 | loss: 0.0797182
	speed: 0.0632s/iter; left time: 2518.9324s
	iters: 300, epoch: 4 | loss: 0.0065924
	speed: 0.0902s/iter; left time: 3587.2645s
	iters: 400, epoch: 4 | loss: 0.0960659
	speed: 0.0814s/iter; left time: 3228.7995s
Epoch: 4 cost time: 32.04201316833496
Epoch: 4, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.250 Vali Acc: 0.963 Test Loss: 0.250 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0002739
	speed: 0.2480s/iter; left time: 9807.7832s
	iters: 200, epoch: 5 | loss: 0.0000260
	speed: 0.0605s/iter; left time: 2386.5276s
	iters: 300, epoch: 5 | loss: 0.0032437
	speed: 0.0515s/iter; left time: 2026.8493s
	iters: 400, epoch: 5 | loss: 0.0244670
	speed: 0.0568s/iter; left time: 2227.4924s
Epoch: 5 cost time: 25.546037197113037
Epoch: 5, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.187 Vali Acc: 0.974 Test Loss: 0.187 Test Acc: 0.974
Validation loss decreased (-0.964528 --> -0.974077).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0003447
	speed: 0.2368s/iter; left time: 9266.0488s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 2275.6166s
	iters: 300, epoch: 6 | loss: 0.0643040
	speed: 0.0552s/iter; left time: 2148.6617s
	iters: 400, epoch: 6 | loss: 0.3347723
	speed: 0.0514s/iter; left time: 1996.1674s
Epoch: 6 cost time: 25.20024538040161
Epoch: 6, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.341 Vali Acc: 0.962 Test Loss: 0.341 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2406s/iter; left time: 9317.7353s
	iters: 200, epoch: 7 | loss: 0.3142565
	speed: 0.0664s/iter; left time: 2562.7762s
	iters: 300, epoch: 7 | loss: 0.0000008
	speed: 0.0822s/iter; left time: 3164.8527s
	iters: 400, epoch: 7 | loss: 0.2716467
	speed: 0.0673s/iter; left time: 2586.9550s
Epoch: 7 cost time: 30.108121395111084
Epoch: 7, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.277 Vali Acc: 0.970 Test Loss: 0.277 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2085s/iter; left time: 7987.2614s
	iters: 200, epoch: 8 | loss: 0.2888686
	speed: 0.0411s/iter; left time: 1569.5612s
	iters: 300, epoch: 8 | loss: 0.0000001
	speed: 0.0259s/iter; left time: 987.6955s
	iters: 400, epoch: 8 | loss: 0.0000562
	speed: 0.0386s/iter; left time: 1467.2748s
Epoch: 8 cost time: 16.38925790786743
Epoch: 8, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.516 Vali Acc: 0.957 Test Loss: 0.516 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2075s/iter; left time: 7863.9424s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 1899.3816s
	iters: 300, epoch: 9 | loss: 0.0000622
	speed: 0.0441s/iter; left time: 1663.3443s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 1525.6454s
Epoch: 9 cost time: 21.075392246246338
Epoch: 9, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.210 Vali Acc: 0.976 Test Loss: 0.210 Test Acc: 0.976
Validation loss decreased (-0.974077 --> -0.975896).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2074282
	speed: 0.2214s/iter; left time: 8300.2233s
	iters: 200, epoch: 10 | loss: 0.3658466
	speed: 0.0528s/iter; left time: 1975.4448s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 1745.8806s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 1676.2116s
Epoch: 10 cost time: 21.860042572021484
Epoch: 10, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.494 Vali Acc: 0.954 Test Loss: 0.494 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.2062s/iter; left time: 7645.0621s
	iters: 200, epoch: 11 | loss: 0.0000174
	speed: 0.0498s/iter; left time: 1842.7408s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 2069.0171s
	iters: 400, epoch: 11 | loss: 0.0000504
	speed: 0.0474s/iter; left time: 1744.0828s
Epoch: 11 cost time: 21.38712739944458
Epoch: 11, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.2068s/iter; left time: 7579.2234s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 1340.9283s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0429s/iter; left time: 1565.3397s
	iters: 400, epoch: 12 | loss: 0.0196669
	speed: 0.0400s/iter; left time: 1455.6415s
Epoch: 12 cost time: 17.55778217315674
Epoch: 12, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.300 Vali Acc: 0.974 Test Loss: 0.300 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2035s/iter; left time: 7374.4266s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0408s/iter; left time: 1475.7572s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 1412.8953s
	iters: 400, epoch: 13 | loss: 0.0007833
	speed: 0.0491s/iter; left time: 1764.8443s
Epoch: 13 cost time: 19.094655513763428
Epoch: 13, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.445 Vali Acc: 0.973 Test Loss: 0.445 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000219
	speed: 0.1856s/iter; left time: 6651.9015s
	iters: 200, epoch: 14 | loss: 0.0023949
	speed: 0.0569s/iter; left time: 2033.3625s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 2128.1251s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0536s/iter; left time: 1904.5530s
Epoch: 14 cost time: 22.231857538223267
Epoch: 14, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.262 Vali Acc: 0.983 Test Loss: 0.262 Test Acc: 0.983
Validation loss decreased (-0.975896 --> -0.982717).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000002
	speed: 0.2102s/iter; left time: 7445.5298s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0449s/iter; left time: 1586.6027s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 1975.0747s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0633s/iter; left time: 2222.6384s
Epoch: 15 cost time: 23.565597534179688
Epoch: 15, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.287 Vali Acc: 0.980 Test Loss: 0.287 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4904730
	speed: 0.2406s/iter; left time: 8424.0766s
	iters: 200, epoch: 16 | loss: 0.0000018
	speed: 0.0684s/iter; left time: 2386.1447s
	iters: 300, epoch: 16 | loss: 0.0000039
	speed: 0.0759s/iter; left time: 2641.6547s
	iters: 400, epoch: 16 | loss: 0.0000008
	speed: 0.0632s/iter; left time: 2194.6973s
Epoch: 16 cost time: 29.167614698410034
Epoch: 16, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.515 Vali Acc: 0.960 Test Loss: 0.515 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2778s/iter; left time: 9611.1077s
	iters: 200, epoch: 17 | loss: 0.0003186
	speed: 0.0730s/iter; left time: 2519.5498s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0513s/iter; left time: 1765.8785s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0575s/iter; left time: 1970.5416s
Epoch: 17 cost time: 29.224085330963135
Epoch: 17, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.399 Vali Acc: 0.975 Test Loss: 0.399 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2524s/iter; left time: 8626.2414s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0756s/iter; left time: 2577.5413s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0731s/iter; left time: 2484.9756s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0636s/iter; left time: 2154.7106s
Epoch: 18 cost time: 30.005731105804443
Epoch: 18, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.328 Vali Acc: 0.975 Test Loss: 0.328 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2176s/iter; left time: 7348.4095s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0551s/iter; left time: 1854.4617s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0600s/iter; left time: 2015.4144s
	iters: 400, epoch: 19 | loss: 0.0012082
	speed: 0.0583s/iter; left time: 1951.0901s
Epoch: 19 cost time: 25.371798038482666
Epoch: 19, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.443 Vali Acc: 0.977 Test Loss: 0.443 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2195s/iter; left time: 7321.8735s
	iters: 200, epoch: 20 | loss: 0.9121943
	speed: 0.0569s/iter; left time: 1891.4150s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 1621.8951s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 1272.2648s
Epoch: 20 cost time: 20.893444538116455
Epoch: 20, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.729 Vali Acc: 0.956 Test Loss: 0.729 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2176s/iter; left time: 7168.8545s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 1237.4137s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1278.6545s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 1199.7853s
Epoch: 21 cost time: 17.306813716888428
Epoch: 21, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.420 Vali Acc: 0.976 Test Loss: 0.420 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2095s/iter; left time: 6815.2343s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 2302.8871s
	iters: 300, epoch: 22 | loss: 0.0000104
	speed: 0.0632s/iter; left time: 2042.6266s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 1928.0099s
Epoch: 22 cost time: 28.132729053497314
Epoch: 22, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.458 Vali Acc: 0.979 Test Loss: 0.458 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2017s/iter; left time: 6478.7101s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1250.7610s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 1438.9104s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 1389.2352s
Epoch: 23 cost time: 19.00010371208191
Epoch: 23, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.261 Vali Acc: 0.979 Test Loss: 0.261 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1881s/iter; left time: 5962.7548s
	iters: 200, epoch: 24 | loss: 0.0001487
	speed: 0.0425s/iter; left time: 1342.1458s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 1561.5529s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 1206.3503s
Epoch: 24 cost time: 18.18458867073059
Epoch: 24, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.356 Vali Acc: 0.978 Test Loss: 0.356 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 225418
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4112830
	speed: 0.0765s/iter; left time: 3151.9874s
	iters: 200, epoch: 1 | loss: 0.0268421
	speed: 0.0407s/iter; left time: 1673.2296s
	iters: 300, epoch: 1 | loss: 0.1850667
	speed: 0.0509s/iter; left time: 2086.8537s
	iters: 400, epoch: 1 | loss: 0.0346654
	speed: 0.0719s/iter; left time: 2938.7556s
Epoch: 1 cost time: 24.810590982437134
Epoch: 1, Steps: 413 | Train Loss: 0.370 Vali Loss: 0.172 Vali Acc: 0.947 Test Loss: 0.172 Test Acc: 0.947
Validation loss decreased (inf --> -0.946792).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0052186
	speed: 0.2227s/iter; left time: 9082.9003s
	iters: 200, epoch: 2 | loss: 0.0970493
	speed: 0.0691s/iter; left time: 2813.0832s
	iters: 300, epoch: 2 | loss: 0.0043270
	speed: 0.0626s/iter; left time: 2539.7889s
	iters: 400, epoch: 2 | loss: 0.0006593
	speed: 0.0546s/iter; left time: 2211.9167s
Epoch: 2 cost time: 25.702288389205933
Epoch: 2, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
Validation loss decreased (-0.946792 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0004747
	speed: 0.2479s/iter; left time: 10010.5055s
	iters: 200, epoch: 3 | loss: 0.0001730
	speed: 0.0488s/iter; left time: 1965.7167s
	iters: 300, epoch: 3 | loss: 0.0068758
	speed: 0.0505s/iter; left time: 2029.7532s
	iters: 400, epoch: 3 | loss: 0.0000061
	speed: 0.0465s/iter; left time: 1863.1226s
Epoch: 3 cost time: 22.31991672515869
Epoch: 3, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.205 Vali Acc: 0.960 Test Loss: 0.205 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1399964
	speed: 0.2636s/iter; left time: 10535.9065s
	iters: 200, epoch: 4 | loss: 0.2102121
	speed: 0.0859s/iter; left time: 3422.4355s
	iters: 300, epoch: 4 | loss: 0.0004516
	speed: 0.0795s/iter; left time: 3161.9705s
	iters: 400, epoch: 4 | loss: 0.0010798
	speed: 0.0625s/iter; left time: 2479.1662s
Epoch: 4 cost time: 31.53508424758911
Epoch: 4, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
Validation loss decreased (-0.968621 --> -0.971803).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000576
	speed: 0.2303s/iter; left time: 9109.6229s
	iters: 200, epoch: 5 | loss: 0.0000012
	speed: 0.0694s/iter; left time: 2736.8243s
	iters: 300, epoch: 5 | loss: 0.0070030
	speed: 0.0640s/iter; left time: 2516.7204s
	iters: 400, epoch: 5 | loss: 0.0000001
	speed: 0.0639s/iter; left time: 2509.0583s
Epoch: 5 cost time: 27.088022708892822
Epoch: 5, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
Validation loss decreased (-0.971803 --> -0.974532).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000004
	speed: 0.2282s/iter; left time: 8929.7051s
	iters: 200, epoch: 6 | loss: 0.3296688
	speed: 0.0524s/iter; left time: 2045.8483s
	iters: 300, epoch: 6 | loss: 0.0001561
	speed: 0.0657s/iter; left time: 2556.9976s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0536s/iter; left time: 2080.8314s
Epoch: 6 cost time: 24.19267988204956
Epoch: 6, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.227 Vali Acc: 0.966 Test Loss: 0.227 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6998348
	speed: 0.2163s/iter; left time: 8377.0055s
	iters: 200, epoch: 7 | loss: 0.0018631
	speed: 0.0450s/iter; left time: 1739.5900s
	iters: 300, epoch: 7 | loss: 0.0001190
	speed: 0.0433s/iter; left time: 1667.8017s
	iters: 400, epoch: 7 | loss: 0.0000013
	speed: 0.0396s/iter; left time: 1523.0709s
Epoch: 7 cost time: 20.19581151008606
Epoch: 7, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.326 Vali Acc: 0.965 Test Loss: 0.326 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1844s/iter; left time: 7064.2502s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0376s/iter; left time: 1437.2799s
	iters: 300, epoch: 8 | loss: 0.0018193
	speed: 0.0402s/iter; left time: 1531.1985s
	iters: 400, epoch: 8 | loss: 0.0000004
	speed: 0.0388s/iter; left time: 1474.5533s
Epoch: 8 cost time: 16.3220534324646
Epoch: 8, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.204 Vali Acc: 0.978 Test Loss: 0.204 Test Acc: 0.978
Validation loss decreased (-0.974532 --> -0.978170).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1791s/iter; left time: 6788.2751s
	iters: 200, epoch: 9 | loss: 0.6732659
	speed: 0.0330s/iter; left time: 1247.4654s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 1585.8291s
	iters: 400, epoch: 9 | loss: 0.0004674
	speed: 0.0398s/iter; left time: 1496.6676s
Epoch: 9 cost time: 16.22684335708618
Epoch: 9, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.267 Vali Acc: 0.971 Test Loss: 0.267 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2036s/iter; left time: 7630.4307s
	iters: 200, epoch: 10 | loss: 0.2003990
	speed: 0.0376s/iter; left time: 1404.8477s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0420s/iter; left time: 1564.5338s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 1470.4367s
Epoch: 10 cost time: 18.07537055015564
Epoch: 10, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.220 Vali Acc: 0.980 Test Loss: 0.220 Test Acc: 0.980
Validation loss decreased (-0.978170 --> -0.980443).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000054
	speed: 0.2149s/iter; left time: 7967.9436s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1794.4126s
	iters: 300, epoch: 11 | loss: 0.0000097
	speed: 0.0444s/iter; left time: 1637.4907s
	iters: 400, epoch: 11 | loss: 0.0004574
	speed: 0.0430s/iter; left time: 1579.9395s
Epoch: 11 cost time: 19.63715171813965
Epoch: 11, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.512 Vali Acc: 0.957 Test Loss: 0.512 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2052s/iter; left time: 7522.9791s
	iters: 200, epoch: 12 | loss: 0.0000074
	speed: 0.0442s/iter; left time: 1614.4205s
	iters: 300, epoch: 12 | loss: 0.0000002
	speed: 0.0644s/iter; left time: 2348.2400s
	iters: 400, epoch: 12 | loss: 1.0414660
	speed: 0.0491s/iter; left time: 1785.2679s
Epoch: 12 cost time: 21.49854278564453
Epoch: 12, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.364 Vali Acc: 0.973 Test Loss: 0.364 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000004
	speed: 0.1982s/iter; left time: 7183.3014s
	iters: 200, epoch: 13 | loss: 0.1341326
	speed: 0.0430s/iter; left time: 1552.8922s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 1815.4814s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 1821.1447s
Epoch: 13 cost time: 19.792505979537964
Epoch: 13, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.508 Vali Acc: 0.965 Test Loss: 0.508 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2242s/iter; left time: 8034.0809s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1685.7505s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 1818.7965s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 2015.7872s
Epoch: 14 cost time: 21.56114912033081
Epoch: 14, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.378 Vali Acc: 0.975 Test Loss: 0.378 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2635s/iter; left time: 9333.3921s
	iters: 200, epoch: 15 | loss: 0.0037372
	speed: 0.0536s/iter; left time: 1894.6175s
	iters: 300, epoch: 15 | loss: 0.0000028
	speed: 0.0630s/iter; left time: 2217.5275s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 2052.2725s
Epoch: 15 cost time: 26.724970817565918
Epoch: 15, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.588 Vali Acc: 0.966 Test Loss: 0.588 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2722s/iter; left time: 9527.3102s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0786s/iter; left time: 2744.7646s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0608s/iter; left time: 2116.6924s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 2039.3646s
Epoch: 16 cost time: 30.32753896713257
Epoch: 16, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.425 Vali Acc: 0.974 Test Loss: 0.425 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2246s/iter; left time: 7768.7626s
	iters: 200, epoch: 17 | loss: 0.0000009
	speed: 0.0626s/iter; left time: 2158.9352s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0641s/iter; left time: 2204.3657s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0726s/iter; left time: 2488.2868s
Epoch: 17 cost time: 28.150686264038086
Epoch: 17, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.494 Vali Acc: 0.970 Test Loss: 0.494 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2299s/iter; left time: 7857.1708s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0634s/iter; left time: 2161.4871s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0681s/iter; left time: 2314.8253s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 1583.9108s
Epoch: 18 cost time: 25.036330938339233
Epoch: 18, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.479 Vali Acc: 0.968 Test Loss: 0.479 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2105s/iter; left time: 7107.9836s
	iters: 200, epoch: 19 | loss: 0.5248551
	speed: 0.0486s/iter; left time: 1636.2259s
	iters: 300, epoch: 19 | loss: 0.0001907
	speed: 0.0452s/iter; left time: 1518.5399s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0548s/iter; left time: 1833.4260s
Epoch: 19 cost time: 20.818687677383423
Epoch: 19, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.280 Vali Acc: 0.978 Test Loss: 0.280 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2316s/iter; left time: 7723.9099s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 1490.4556s
	iters: 300, epoch: 20 | loss: 0.0000006
	speed: 0.0471s/iter; left time: 1561.2346s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0540s/iter; left time: 1785.3265s
Epoch: 20 cost time: 21.472216367721558
Epoch: 20, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.511 Vali Acc: 0.976 Test Loss: 0.511 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 184010
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1917640
	speed: 0.0803s/iter; left time: 3307.4935s
	iters: 200, epoch: 1 | loss: 0.0267284
	speed: 0.0392s/iter; left time: 1613.1128s
	iters: 300, epoch: 1 | loss: 0.0617067
	speed: 0.0455s/iter; left time: 1864.6358s
	iters: 400, epoch: 1 | loss: 0.0177249
	speed: 0.0437s/iter; left time: 1786.7081s
Epoch: 1 cost time: 21.455178022384644
Epoch: 1, Steps: 413 | Train Loss: 0.364 Vali Loss: 0.120 Vali Acc: 0.961 Test Loss: 0.120 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0165043
	speed: 0.2222s/iter; left time: 9063.0253s
	iters: 200, epoch: 2 | loss: 0.3129324
	speed: 0.0372s/iter; left time: 1512.7644s
	iters: 300, epoch: 2 | loss: 0.2366277
	speed: 0.0345s/iter; left time: 1399.5437s
	iters: 400, epoch: 2 | loss: 0.0015688
	speed: 0.0400s/iter; left time: 1620.5719s
Epoch: 2 cost time: 16.611996173858643
Epoch: 2, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.960890 --> -0.976352).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2451760
	speed: 0.2201s/iter; left time: 8885.4264s
	iters: 200, epoch: 3 | loss: 0.0020344
	speed: 0.0432s/iter; left time: 1741.4038s
	iters: 300, epoch: 3 | loss: 0.5761663
	speed: 0.0440s/iter; left time: 1768.6116s
	iters: 400, epoch: 3 | loss: 0.0003687
	speed: 0.0506s/iter; left time: 2027.0982s
Epoch: 3 cost time: 19.889864206314087
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000279
	speed: 0.2419s/iter; left time: 9668.7400s
	iters: 200, epoch: 4 | loss: 0.0064953
	speed: 0.0605s/iter; left time: 2411.7403s
	iters: 300, epoch: 4 | loss: 0.0000645
	speed: 0.0523s/iter; left time: 2080.9493s
	iters: 400, epoch: 4 | loss: 0.0045229
	speed: 0.0521s/iter; left time: 2067.7065s
Epoch: 4 cost time: 24.34313678741455
Epoch: 4, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000153
	speed: 0.2379s/iter; left time: 9410.3473s
	iters: 200, epoch: 5 | loss: 0.0248051
	speed: 0.0690s/iter; left time: 2722.4348s
	iters: 300, epoch: 5 | loss: 0.0000018
	speed: 0.0819s/iter; left time: 3220.8087s
	iters: 400, epoch: 5 | loss: 0.1613775
	speed: 0.0566s/iter; left time: 2222.0025s
Epoch: 5 cost time: 28.36918354034424
Epoch: 5, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0512801
	speed: 0.2363s/iter; left time: 9248.9602s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0669s/iter; left time: 2613.4175s
	iters: 300, epoch: 6 | loss: 0.0038790
	speed: 0.0608s/iter; left time: 2369.0949s
	iters: 400, epoch: 6 | loss: 0.0000008
	speed: 0.0735s/iter; left time: 2853.5797s
Epoch: 6 cost time: 27.863893747329712
Epoch: 6, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.242 Vali Acc: 0.969 Test Loss: 0.242 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0002693
	speed: 0.2298s/iter; left time: 8898.5003s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 1899.0869s
	iters: 300, epoch: 7 | loss: 0.0000005
	speed: 0.0616s/iter; left time: 2371.2990s
	iters: 400, epoch: 7 | loss: 0.0117224
	speed: 0.0725s/iter; left time: 2786.3439s
Epoch: 7 cost time: 25.045307636260986
Epoch: 7, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.238 Vali Acc: 0.968 Test Loss: 0.238 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0499408
	speed: 0.2162s/iter; left time: 8282.4422s
	iters: 200, epoch: 8 | loss: 0.0000084
	speed: 0.0557s/iter; left time: 2129.9334s
	iters: 300, epoch: 8 | loss: 0.0000003
	speed: 0.0365s/iter; left time: 1392.4268s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 1330.8924s
Epoch: 8 cost time: 19.59107518196106
Epoch: 8, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.237 Vali Acc: 0.966 Test Loss: 0.237 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.2145s/iter; left time: 8127.5165s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 1397.6285s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 1436.8810s
	iters: 400, epoch: 9 | loss: 0.0001371
	speed: 0.0418s/iter; left time: 1573.0273s
Epoch: 9 cost time: 17.311063528060913
Epoch: 9, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.377 Vali Acc: 0.962 Test Loss: 0.377 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000010
	speed: 0.1942s/iter; left time: 7277.9223s
	iters: 200, epoch: 10 | loss: 0.0349929
	speed: 0.0463s/iter; left time: 1729.3507s
	iters: 300, epoch: 10 | loss: 0.0455908
	speed: 0.0439s/iter; left time: 1636.4580s
	iters: 400, epoch: 10 | loss: 0.0000169
	speed: 0.0376s/iter; left time: 1398.5347s
Epoch: 10 cost time: 18.86607575416565
Epoch: 10, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.218 Vali Acc: 0.977 Test Loss: 0.218 Test Acc: 0.977
Validation loss decreased (-0.976352 --> -0.977260).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2000s/iter; left time: 7414.0582s
	iters: 200, epoch: 11 | loss: 0.0095427
	speed: 0.0585s/iter; left time: 2162.7683s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0541s/iter; left time: 1992.9192s
	iters: 400, epoch: 11 | loss: 0.0103881
	speed: 0.0551s/iter; left time: 2025.1703s
Epoch: 11 cost time: 22.548081159591675
Epoch: 11, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.377 Vali Acc: 0.970 Test Loss: 0.377 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000002
	speed: 0.1929s/iter; left time: 7071.1597s
	iters: 200, epoch: 12 | loss: 0.0000041
	speed: 0.0393s/iter; left time: 1436.7995s
	iters: 300, epoch: 12 | loss: 0.0002122
	speed: 0.0467s/iter; left time: 1704.2570s
	iters: 400, epoch: 12 | loss: 0.0000005
	speed: 0.0594s/iter; left time: 2160.3637s
Epoch: 12 cost time: 19.82624387741089
Epoch: 12, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.247 Vali Acc: 0.977 Test Loss: 0.247 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0101994
	speed: 0.2179s/iter; left time: 7896.4563s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 1283.2934s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 1580.3298s
	iters: 400, epoch: 13 | loss: 0.2593939
	speed: 0.0417s/iter; left time: 1497.2400s
Epoch: 13 cost time: 17.36737871170044
Epoch: 13, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.308 Vali Acc: 0.974 Test Loss: 0.308 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2146s/iter; left time: 7691.2913s
	iters: 200, epoch: 14 | loss: 0.0000052
	speed: 0.0377s/iter; left time: 1348.5617s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 1583.4759s
	iters: 400, epoch: 14 | loss: 0.1713971
	speed: 0.0478s/iter; left time: 1698.2169s
Epoch: 14 cost time: 19.085452795028687
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.267 Vali Acc: 0.970 Test Loss: 0.267 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2398s/iter; left time: 8493.9592s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 2033.8834s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0514s/iter; left time: 1809.8210s
	iters: 400, epoch: 15 | loss: 0.2943681
	speed: 0.0572s/iter; left time: 2007.7958s
Epoch: 15 cost time: 24.74836826324463
Epoch: 15, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.436 Vali Acc: 0.966 Test Loss: 0.436 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0003483
	speed: 0.2175s/iter; left time: 7612.1965s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 2075.5853s
	iters: 300, epoch: 16 | loss: 0.3246468
	speed: 0.0588s/iter; left time: 2047.5306s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 2067.6490s
Epoch: 16 cost time: 26.2186336517334
Epoch: 16, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.302 Vali Acc: 0.977 Test Loss: 0.302 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2420s/iter; left time: 8372.8096s
	iters: 200, epoch: 17 | loss: 0.0000004
	speed: 0.0668s/iter; left time: 2303.1962s
	iters: 300, epoch: 17 | loss: 0.0000067
	speed: 0.0611s/iter; left time: 2101.4004s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 2061.9612s
Epoch: 17 cost time: 27.35098123550415
Epoch: 17, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.309 Vali Acc: 0.972 Test Loss: 0.309 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2298s/iter; left time: 7856.1422s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0535s/iter; left time: 1822.1918s
	iters: 300, epoch: 18 | loss: 0.0000024
	speed: 0.0770s/iter; left time: 2617.4587s
	iters: 400, epoch: 18 | loss: 0.2124842
	speed: 0.0794s/iter; left time: 2688.9412s
Epoch: 18 cost time: 28.416513681411743
Epoch: 18, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.332 Vali Acc: 0.973 Test Loss: 0.332 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2292s/iter; left time: 7738.7962s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 1522.6398s
	iters: 300, epoch: 19 | loss: 0.0000004
	speed: 0.0359s/iter; left time: 1203.5265s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 1120.1870s
Epoch: 19 cost time: 18.76604175567627
Epoch: 19, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.331 Vali Acc: 0.980 Test Loss: 0.331 Test Acc: 0.980
Validation loss decreased (-0.977260 --> -0.979988).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2096s/iter; left time: 6991.4632s
	iters: 200, epoch: 20 | loss: 0.9126405
	speed: 0.0415s/iter; left time: 1380.5256s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0382s/iter; left time: 1267.2521s
	iters: 400, epoch: 20 | loss: 0.0080987
	speed: 0.0451s/iter; left time: 1491.7835s
Epoch: 20 cost time: 17.370306968688965
Epoch: 20, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.275 Vali Acc: 0.976 Test Loss: 0.275 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1160518
	speed: 0.2141s/iter; left time: 7053.7796s
	iters: 200, epoch: 21 | loss: 0.7261952
	speed: 0.0445s/iter; left time: 1460.7068s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.0378s/iter; left time: 1236.7194s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0390s/iter; left time: 1272.6589s
Epoch: 21 cost time: 18.288578033447266
Epoch: 21, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.365 Vali Acc: 0.975 Test Loss: 0.365 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000007
	speed: 0.2209s/iter; left time: 7186.7201s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 1131.3382s
	iters: 300, epoch: 22 | loss: 0.0000035
	speed: 0.0436s/iter; left time: 1408.3951s
	iters: 400, epoch: 22 | loss: 0.0000012
	speed: 0.0382s/iter; left time: 1230.4764s
Epoch: 22 cost time: 16.963003635406494
Epoch: 22, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.373 Vali Acc: 0.974 Test Loss: 0.373 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1957s/iter; left time: 6286.2569s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 1216.9730s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 1250.6046s
	iters: 400, epoch: 23 | loss: 0.0780208
	speed: 0.0423s/iter; left time: 1344.4578s
Epoch: 23 cost time: 17.777911901474
Epoch: 23, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.308 Vali Acc: 0.976 Test Loss: 0.308 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2074s/iter; left time: 6575.0067s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 1442.6700s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 1456.6672s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0386s/iter; left time: 1211.8351s
Epoch: 24 cost time: 18.619918823242188
Epoch: 24, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.328 Vali Acc: 0.977 Test Loss: 0.328 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1998s/iter; left time: 6251.1416s
	iters: 200, epoch: 25 | loss: 0.0000167
	speed: 0.0414s/iter; left time: 1291.5831s
	iters: 300, epoch: 25 | loss: 0.0006594
	speed: 0.0445s/iter; left time: 1382.0414s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1419.5591s
Epoch: 25 cost time: 18.544371366500854
Epoch: 25, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.406 Vali Acc: 0.974 Test Loss: 0.406 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0017670
	speed: 0.2304s/iter; left time: 7113.8026s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 1841.7023s
	iters: 300, epoch: 26 | loss: 0.0000011
	speed: 0.0501s/iter; left time: 1537.9302s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 1510.3344s
Epoch: 26 cost time: 23.96464729309082
Epoch: 26, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.273 Vali Acc: 0.974 Test Loss: 0.273 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1845s/iter; left time: 5619.9135s
	iters: 200, epoch: 27 | loss: 0.0093556
	speed: 0.0582s/iter; left time: 1767.7630s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 1965.0902s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 1839.7754s
Epoch: 27 cost time: 24.58906388282776
Epoch: 27, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.388 Vali Acc: 0.975 Test Loss: 0.388 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2200s/iter; left time: 6611.1837s
	iters: 200, epoch: 28 | loss: 0.0000037
	speed: 0.0479s/iter; left time: 1435.9669s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 1298.8493s
	iters: 400, epoch: 28 | loss: 0.0000002
	speed: 0.0523s/iter; left time: 1555.5640s
Epoch: 28 cost time: 21.877320766448975
Epoch: 28, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.241 Vali Acc: 0.978 Test Loss: 0.241 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2315s/iter; left time: 6860.3499s
	iters: 200, epoch: 29 | loss: 0.0000002
	speed: 0.0595s/iter; left time: 1757.6978s
	iters: 300, epoch: 29 | loss: 0.1845052
	speed: 0.0723s/iter; left time: 2129.6468s
	iters: 400, epoch: 29 | loss: 0.0000001
	speed: 0.0679s/iter; left time: 1990.9476s
Epoch: 29 cost time: 27.87014126777649
Epoch: 29, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.280 Vali Acc: 0.976 Test Loss: 0.280 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 142666
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4177033
	speed: 0.0812s/iter; left time: 3343.6041s
	iters: 200, epoch: 1 | loss: 0.0547813
	speed: 0.0346s/iter; left time: 1421.3480s
	iters: 300, epoch: 1 | loss: 0.1340126
	speed: 0.0306s/iter; left time: 1256.4597s
	iters: 400, epoch: 1 | loss: 0.0205036
	speed: 0.0355s/iter; left time: 1451.6797s
Epoch: 1 cost time: 18.724315404891968
Epoch: 1, Steps: 413 | Train Loss: 0.396 Vali Loss: 0.124 Vali Acc: 0.958 Test Loss: 0.124 Test Acc: 0.958
Validation loss decreased (inf --> -0.957707).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0425500
	speed: 0.1662s/iter; left time: 6777.2008s
	iters: 200, epoch: 2 | loss: 0.3770181
	speed: 0.0317s/iter; left time: 1290.8562s
	iters: 300, epoch: 2 | loss: 0.0641163
	speed: 0.0318s/iter; left time: 1289.7841s
	iters: 400, epoch: 2 | loss: 0.0330378
	speed: 0.0293s/iter; left time: 1187.4868s
Epoch: 2 cost time: 13.80181622505188
Epoch: 2, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
Validation loss decreased (-0.957707 --> -0.965438).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1324601
	speed: 0.1759s/iter; left time: 7102.4357s
	iters: 200, epoch: 3 | loss: 0.0010010
	speed: 0.0316s/iter; left time: 1273.6899s
	iters: 300, epoch: 3 | loss: 0.0027073
	speed: 0.0366s/iter; left time: 1470.9099s
	iters: 400, epoch: 3 | loss: 0.0005943
	speed: 0.0378s/iter; left time: 1514.6817s
Epoch: 3 cost time: 15.116322994232178
Epoch: 3, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0035201
	speed: 0.1859s/iter; left time: 7430.4434s
	iters: 200, epoch: 4 | loss: 0.0879394
	speed: 0.0369s/iter; left time: 1471.0023s
	iters: 300, epoch: 4 | loss: 0.0012446
	speed: 0.0365s/iter; left time: 1451.6355s
	iters: 400, epoch: 4 | loss: 0.0491968
	speed: 0.0335s/iter; left time: 1327.1163s
Epoch: 4 cost time: 15.466127872467041
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.965438 --> -0.969530).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0003631
	speed: 0.1816s/iter; left time: 7183.9172s
	iters: 200, epoch: 5 | loss: 0.0000263
	speed: 0.0389s/iter; left time: 1533.4614s
	iters: 300, epoch: 5 | loss: 0.0253769
	speed: 0.0330s/iter; left time: 1299.4779s
	iters: 400, epoch: 5 | loss: 0.0198363
	speed: 0.0322s/iter; left time: 1263.6445s
Epoch: 5 cost time: 15.733651161193848
Epoch: 5, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.969530 --> -0.973168).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4596691
	speed: 0.1871s/iter; left time: 7321.2710s
	iters: 200, epoch: 6 | loss: 0.0000005
	speed: 0.0363s/iter; left time: 1417.7198s
	iters: 300, epoch: 6 | loss: 0.9104941
	speed: 0.0354s/iter; left time: 1376.7590s
	iters: 400, epoch: 6 | loss: 0.0000005
	speed: 0.0355s/iter; left time: 1378.2060s
Epoch: 6 cost time: 15.46106505393982
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.973168 --> -0.979990).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000005
	speed: 0.1844s/iter; left time: 7139.9671s
	iters: 200, epoch: 7 | loss: 0.0000217
	speed: 0.0422s/iter; left time: 1628.0237s
	iters: 300, epoch: 7 | loss: 0.0001463
	speed: 0.0471s/iter; left time: 1815.4546s
	iters: 400, epoch: 7 | loss: 0.0019859
	speed: 0.0472s/iter; left time: 1813.7164s
Epoch: 7 cost time: 18.828548431396484
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.215 Vali Acc: 0.963 Test Loss: 0.215 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0008440
	speed: 0.1881s/iter; left time: 7205.4553s
	iters: 200, epoch: 8 | loss: 0.0139916
	speed: 0.0397s/iter; left time: 1518.3882s
	iters: 300, epoch: 8 | loss: 0.0097148
	speed: 0.0466s/iter; left time: 1775.1605s
	iters: 400, epoch: 8 | loss: 0.0001072
	speed: 0.0390s/iter; left time: 1483.0910s
Epoch: 8 cost time: 17.200908184051514
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.213 Vali Acc: 0.969 Test Loss: 0.213 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000178
	speed: 0.1885s/iter; left time: 7144.9108s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1478.0721s
	iters: 300, epoch: 9 | loss: 0.0188730
	speed: 0.0351s/iter; left time: 1323.1579s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0371s/iter; left time: 1396.4856s
Epoch: 9 cost time: 16.416622638702393
Epoch: 9, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.231 Vali Acc: 0.964 Test Loss: 0.231 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000231
	speed: 0.1886s/iter; left time: 7069.7571s
	iters: 200, epoch: 10 | loss: 0.0003231
	speed: 0.0439s/iter; left time: 1640.8196s
	iters: 300, epoch: 10 | loss: 0.0000019
	speed: 0.0440s/iter; left time: 1641.6925s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 1368.5156s
Epoch: 10 cost time: 18.12703275680542
Epoch: 10, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000026
	speed: 0.1907s/iter; left time: 7069.4029s
	iters: 200, epoch: 11 | loss: 0.0000482
	speed: 0.0353s/iter; left time: 1305.3743s
	iters: 300, epoch: 11 | loss: 0.0001978
	speed: 0.0372s/iter; left time: 1372.0680s
	iters: 400, epoch: 11 | loss: 0.0000021
	speed: 0.0341s/iter; left time: 1255.3395s
Epoch: 11 cost time: 16.00917959213257
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.972 Test Loss: 0.189 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000005
	speed: 0.2093s/iter; left time: 7672.4242s
	iters: 200, epoch: 12 | loss: 0.0000057
	speed: 0.0331s/iter; left time: 1210.1266s
	iters: 300, epoch: 12 | loss: 0.0000036
	speed: 0.0367s/iter; left time: 1337.1989s
	iters: 400, epoch: 12 | loss: 0.0000014
	speed: 0.0349s/iter; left time: 1267.5789s
Epoch: 12 cost time: 15.3346266746521
Epoch: 12, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0081650
	speed: 0.1904s/iter; left time: 6900.2574s
	iters: 200, epoch: 13 | loss: 0.0000002
	speed: 0.0406s/iter; left time: 1467.6898s
	iters: 300, epoch: 13 | loss: 0.0000002
	speed: 0.0421s/iter; left time: 1518.0567s
	iters: 400, epoch: 13 | loss: 0.0046639
	speed: 0.0330s/iter; left time: 1185.9486s
Epoch: 13 cost time: 17.0090651512146
Epoch: 13, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.251 Vali Acc: 0.971 Test Loss: 0.251 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1998s/iter; left time: 7157.8077s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1536.4733s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 1618.7326s
	iters: 400, epoch: 14 | loss: 0.0142841
	speed: 0.0452s/iter; left time: 1606.5388s
Epoch: 14 cost time: 18.55301308631897
Epoch: 14, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.291 Vali Acc: 0.968 Test Loss: 0.291 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0050128
	speed: 0.1947s/iter; left time: 6894.5639s
	iters: 200, epoch: 15 | loss: 0.0001730
	speed: 0.0408s/iter; left time: 1441.0304s
	iters: 300, epoch: 15 | loss: 0.3126114
	speed: 0.0353s/iter; left time: 1242.2451s
	iters: 400, epoch: 15 | loss: 0.0001049
	speed: 0.0331s/iter; left time: 1162.7497s
Epoch: 15 cost time: 16.26018190383911
Epoch: 15, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.265 Vali Acc: 0.973 Test Loss: 0.265 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000013
	speed: 0.1895s/iter; left time: 6632.5524s
	iters: 200, epoch: 16 | loss: 0.0041047
	speed: 0.0329s/iter; left time: 1148.2106s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0332s/iter; left time: 1156.5020s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0363s/iter; left time: 1258.8642s
Epoch: 16 cost time: 15.122530460357666
Epoch: 16, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.296 Vali Acc: 0.973 Test Loss: 0.296 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 109706
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4169562
	speed: 0.0662s/iter; left time: 2729.1050s
	iters: 200, epoch: 1 | loss: 0.1645642
	speed: 0.0323s/iter; left time: 1327.0856s
	iters: 300, epoch: 1 | loss: 0.0696533
	speed: 0.0333s/iter; left time: 1363.3100s
	iters: 400, epoch: 1 | loss: 0.0385589
	speed: 0.0335s/iter; left time: 1370.6783s
Epoch: 1 cost time: 17.359649658203125
Epoch: 1, Steps: 413 | Train Loss: 0.448 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
Validation loss decreased (inf --> -0.964528).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0199352
	speed: 0.1725s/iter; left time: 7034.0314s
	iters: 200, epoch: 2 | loss: 0.0058419
	speed: 0.0359s/iter; left time: 1461.7105s
	iters: 300, epoch: 2 | loss: 0.0222687
	speed: 0.0366s/iter; left time: 1484.7436s
	iters: 400, epoch: 2 | loss: 0.0594130
	speed: 0.0396s/iter; left time: 1602.9634s
Epoch: 2 cost time: 15.470333099365234
Epoch: 2, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
Validation loss decreased (-0.964528 --> -0.971804).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0211027
	speed: 0.1920s/iter; left time: 7753.6480s
	iters: 200, epoch: 3 | loss: 0.0073930
	speed: 0.0322s/iter; left time: 1295.2991s
	iters: 300, epoch: 3 | loss: 0.6131750
	speed: 0.0368s/iter; left time: 1478.0201s
	iters: 400, epoch: 3 | loss: 0.0052673
	speed: 0.0465s/iter; left time: 1864.8517s
Epoch: 3 cost time: 16.468326568603516
Epoch: 3, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
Validation loss decreased (-0.971804 --> -0.974078).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0074369
	speed: 0.1801s/iter; left time: 7196.4393s
	iters: 200, epoch: 4 | loss: 0.1636470
	speed: 0.0362s/iter; left time: 1444.3916s
	iters: 300, epoch: 4 | loss: 0.0003582
	speed: 0.0444s/iter; left time: 1766.4320s
	iters: 400, epoch: 4 | loss: 0.0017584
	speed: 0.0431s/iter; left time: 1709.8721s
Epoch: 4 cost time: 17.372217416763306
Epoch: 4, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0546230
	speed: 0.1806s/iter; left time: 7142.7983s
	iters: 200, epoch: 5 | loss: 0.0000065
	speed: 0.0352s/iter; left time: 1388.4478s
	iters: 300, epoch: 5 | loss: 0.0003831
	speed: 0.0398s/iter; left time: 1564.2120s
	iters: 400, epoch: 5 | loss: 0.0023673
	speed: 0.0399s/iter; left time: 1566.1399s
Epoch: 5 cost time: 15.742520570755005
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.974078 --> -0.975442).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0159952
	speed: 0.1855s/iter; left time: 7258.1014s
	iters: 200, epoch: 6 | loss: 0.0201534
	speed: 0.0365s/iter; left time: 1423.7155s
	iters: 300, epoch: 6 | loss: 0.0000084
	speed: 0.0407s/iter; left time: 1584.1983s
	iters: 400, epoch: 6 | loss: 0.2054648
	speed: 0.0362s/iter; left time: 1406.8032s
Epoch: 6 cost time: 16.23002529144287
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.975442 --> -0.977716).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1723514
	speed: 0.1855s/iter; left time: 7184.0885s
	iters: 200, epoch: 7 | loss: 0.0000035
	speed: 0.0438s/iter; left time: 1689.9151s
	iters: 300, epoch: 7 | loss: 0.0000025
	speed: 0.0374s/iter; left time: 1439.5706s
	iters: 400, epoch: 7 | loss: 0.0003771
	speed: 0.0333s/iter; left time: 1278.7443s
Epoch: 7 cost time: 16.9185471534729
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000858
	speed: 0.1706s/iter; left time: 6535.0293s
	iters: 200, epoch: 8 | loss: 0.0024093
	speed: 0.0360s/iter; left time: 1377.1792s
	iters: 300, epoch: 8 | loss: 0.0000094
	speed: 0.0329s/iter; left time: 1254.9753s
	iters: 400, epoch: 8 | loss: 0.0003628
	speed: 0.0352s/iter; left time: 1339.2770s
Epoch: 8 cost time: 14.786054134368896
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2375252
	speed: 0.1777s/iter; left time: 6734.0730s
	iters: 200, epoch: 9 | loss: 0.0001026
	speed: 0.0285s/iter; left time: 1075.7465s
	iters: 300, epoch: 9 | loss: 0.1456461
	speed: 0.0301s/iter; left time: 1135.1793s
	iters: 400, epoch: 9 | loss: 0.0605631
	speed: 0.0310s/iter; left time: 1165.1394s
Epoch: 9 cost time: 13.235888242721558
Epoch: 9, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0002814
	speed: 0.1832s/iter; left time: 6865.6345s
	iters: 200, epoch: 10 | loss: 0.5866077
	speed: 0.0396s/iter; left time: 1481.6117s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0372s/iter; left time: 1386.0408s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 1412.8086s
Epoch: 10 cost time: 16.6302433013916
Epoch: 10, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000026
	speed: 0.1610s/iter; left time: 5966.9338s
	iters: 200, epoch: 11 | loss: 0.2684972
	speed: 0.0288s/iter; left time: 1064.6165s
	iters: 300, epoch: 11 | loss: 0.0010942
	speed: 0.0387s/iter; left time: 1425.5732s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 1378.0476s
Epoch: 11 cost time: 14.803288459777832
Epoch: 11, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.979990).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000371
	speed: 0.1862s/iter; left time: 6826.9795s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 1256.0096s
	iters: 300, epoch: 12 | loss: 0.3005709
	speed: 0.0361s/iter; left time: 1317.7016s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 1048.9631s
Epoch: 12 cost time: 14.411056518554688
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0002153
	speed: 0.1889s/iter; left time: 6845.1522s
	iters: 200, epoch: 13 | loss: 0.2175077
	speed: 0.0312s/iter; left time: 1127.6417s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 1241.5864s
	iters: 400, epoch: 13 | loss: 0.0000411
	speed: 0.0298s/iter; left time: 1070.5107s
Epoch: 13 cost time: 14.500764846801758
Epoch: 13, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.258 Vali Acc: 0.971 Test Loss: 0.258 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1869s/iter; left time: 6695.8379s
	iters: 200, epoch: 14 | loss: 0.0000022
	speed: 0.0355s/iter; left time: 1268.8201s
	iters: 300, epoch: 14 | loss: 0.0000003
	speed: 0.0354s/iter; left time: 1260.1175s
	iters: 400, epoch: 14 | loss: 0.0062423
	speed: 0.0368s/iter; left time: 1308.5757s
Epoch: 14 cost time: 15.432361602783203
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.1678s/iter; left time: 5943.9461s
	iters: 200, epoch: 15 | loss: 0.0000476
	speed: 0.0328s/iter; left time: 1158.0193s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0343s/iter; left time: 1208.7904s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0360s/iter; left time: 1265.1283s
Epoch: 15 cost time: 14.469709396362305
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1896s/iter; left time: 6637.6388s
	iters: 200, epoch: 16 | loss: 0.0000033
	speed: 0.0391s/iter; left time: 1364.8974s
	iters: 300, epoch: 16 | loss: 0.0012431
	speed: 0.0365s/iter; left time: 1269.7155s
	iters: 400, epoch: 16 | loss: 0.2310773
	speed: 0.0357s/iter; left time: 1240.0626s
Epoch: 16 cost time: 15.7785964012146
Epoch: 16, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.265 Vali Acc: 0.968 Test Loss: 0.265 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0649377
	speed: 0.1817s/iter; left time: 6284.6845s
	iters: 200, epoch: 17 | loss: 0.0001609
	speed: 0.0394s/iter; left time: 1359.8749s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 1400.9644s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 1230.9058s
Epoch: 17 cost time: 16.373811960220337
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1892s/iter; left time: 6466.9548s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.0421s/iter; left time: 1435.3670s
	iters: 300, epoch: 18 | loss: 0.0000489
	speed: 0.0405s/iter; left time: 1377.3113s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 1333.7805s
Epoch: 18 cost time: 17.481112957000732
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.217 Vali Acc: 0.973 Test Loss: 0.217 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000026
	speed: 0.1795s/iter; left time: 6060.8052s
	iters: 200, epoch: 19 | loss: 0.0021381
	speed: 0.0367s/iter; left time: 1236.8585s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 1291.4786s
	iters: 400, epoch: 19 | loss: 0.0000784
	speed: 0.0326s/iter; left time: 1092.3341s
Epoch: 19 cost time: 16.2677960395813
Epoch: 19, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.224 Vali Acc: 0.977 Test Loss: 0.224 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000237
	speed: 0.1745s/iter; left time: 5820.7165s
	iters: 200, epoch: 20 | loss: 0.0000053
	speed: 0.0348s/iter; left time: 1158.0828s
	iters: 300, epoch: 20 | loss: 0.2838368
	speed: 0.0306s/iter; left time: 1013.0499s
	iters: 400, epoch: 20 | loss: 0.2802252
	speed: 0.0344s/iter; left time: 1137.1287s
Epoch: 20 cost time: 14.747043132781982
Epoch: 20, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.153 Vali Acc: 0.980 Test Loss: 0.153 Test Acc: 0.980
Validation loss decreased (-0.979990 --> -0.980444).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1902s/iter; left time: 6265.6529s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 1230.9367s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.0330s/iter; left time: 1080.1969s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0314s/iter; left time: 1023.4013s
Epoch: 21 cost time: 15.513534545898438
Epoch: 21, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.1590s/iter; left time: 5172.3463s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0292s/iter; left time: 947.9205s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 1074.0369s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 1107.2358s
Epoch: 22 cost time: 13.880137920379639
Epoch: 22, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.224 Vali Acc: 0.976 Test Loss: 0.224 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000001
	speed: 0.1812s/iter; left time: 5820.6591s
	iters: 200, epoch: 23 | loss: 0.0000124
	speed: 0.0341s/iter; left time: 1091.9199s
	iters: 300, epoch: 23 | loss: 0.0000010
	speed: 0.0417s/iter; left time: 1329.9103s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1264.8911s
Epoch: 23 cost time: 16.802045583724976
Epoch: 23, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.242 Vali Acc: 0.977 Test Loss: 0.242 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0001408
	speed: 0.1921s/iter; left time: 6088.6141s
	iters: 200, epoch: 24 | loss: 0.0000141
	speed: 0.0382s/iter; left time: 1207.1872s
	iters: 300, epoch: 24 | loss: 0.0000088
	speed: 0.0272s/iter; left time: 857.3426s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1344.7028s
Epoch: 24 cost time: 15.830312490463257
Epoch: 24, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.304 Vali Acc: 0.975 Test Loss: 0.304 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1872s/iter; left time: 5856.2081s
	iters: 200, epoch: 25 | loss: 0.0000006
	speed: 0.0377s/iter; left time: 1175.4421s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0330s/iter; left time: 1024.8407s
	iters: 400, epoch: 25 | loss: 0.0000009
	speed: 0.0376s/iter; left time: 1164.0333s
Epoch: 25 cost time: 15.472778558731079
Epoch: 25, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.173 Vali Acc: 0.980 Test Loss: 0.173 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000166
	speed: 0.2032s/iter; left time: 6273.4909s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1408.8705s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 1294.1711s
	iters: 400, epoch: 26 | loss: 0.0000008
	speed: 0.0405s/iter; left time: 1239.5699s
Epoch: 26 cost time: 18.198589324951172
Epoch: 26, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.281 Vali Acc: 0.975 Test Loss: 0.281 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1987s/iter; left time: 6054.1757s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0345s/iter; left time: 1048.3834s
	iters: 300, epoch: 27 | loss: 0.0000470
	speed: 0.0362s/iter; left time: 1094.4279s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0345s/iter; left time: 1040.0324s
Epoch: 27 cost time: 16.10988974571228
Epoch: 27, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.270 Vali Acc: 0.978 Test Loss: 0.270 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0001484
	speed: 0.1935s/iter; left time: 5815.3677s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 1172.9566s
	iters: 300, epoch: 28 | loss: 0.0766176
	speed: 0.0354s/iter; left time: 1056.0303s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0315s/iter; left time: 937.9820s
Epoch: 28 cost time: 15.925618886947632
Epoch: 28, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.106 Vali Acc: 0.986 Test Loss: 0.106 Test Acc: 0.986
Validation loss decreased (-0.980444 --> -0.986356).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000004
	speed: 0.1947s/iter; left time: 5770.1179s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 1226.3906s
	iters: 300, epoch: 29 | loss: 0.0000049
	speed: 0.0416s/iter; left time: 1223.6536s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0409s/iter; left time: 1201.0779s
Epoch: 29 cost time: 17.753121852874756
Epoch: 29, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.297 Vali Acc: 0.973 Test Loss: 0.297 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0001759
	speed: 0.1938s/iter; left time: 5663.0982s
	iters: 200, epoch: 30 | loss: 0.2044846
	speed: 0.0383s/iter; left time: 1116.4911s
	iters: 300, epoch: 30 | loss: 0.0099321
	speed: 0.0370s/iter; left time: 1074.3311s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 1178.3832s
Epoch: 30 cost time: 16.778585195541382
Epoch: 30, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.301 Vali Acc: 0.978 Test Loss: 0.301 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1969s/iter; left time: 5671.5835s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 1116.7991s
	iters: 300, epoch: 31 | loss: 0.9939768
	speed: 0.0361s/iter; left time: 1032.1534s
	iters: 400, epoch: 31 | loss: 0.4903852
	speed: 0.0420s/iter; left time: 1196.1151s
Epoch: 31 cost time: 17.31559944152832
Epoch: 31, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.979 Test Loss: 0.203 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1775s/iter; left time: 5041.0124s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0387s/iter; left time: 1095.0695s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0390s/iter; left time: 1100.9899s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1195.1124s
Epoch: 32 cost time: 16.90188431739807
Epoch: 32, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1865s/iter; left time: 5218.9681s
	iters: 200, epoch: 33 | loss: 0.0000133
	speed: 0.0455s/iter; left time: 1268.8726s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1189.2703s
	iters: 400, epoch: 33 | loss: 0.0328119
	speed: 0.0435s/iter; left time: 1203.2233s
Epoch: 33 cost time: 18.674795150756836
Epoch: 33, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.169 Vali Acc: 0.984 Test Loss: 0.169 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0000021
	speed: 0.2022s/iter; left time: 5575.2855s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0499s/iter; left time: 1369.8579s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 1199.6443s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0399s/iter; left time: 1087.0983s
Epoch: 34 cost time: 19.331656217575073
Epoch: 34, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.331 Vali Acc: 0.973 Test Loss: 0.331 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0000231
	speed: 0.1815s/iter; left time: 4928.6484s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 813.3592s
	iters: 300, epoch: 35 | loss: 0.0096004
	speed: 0.0308s/iter; left time: 830.1563s
	iters: 400, epoch: 35 | loss: 0.0007507
	speed: 0.0309s/iter; left time: 831.0581s
Epoch: 35 cost time: 14.04770541191101
Epoch: 35, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.202 Vali Acc: 0.981 Test Loss: 0.202 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.2647043
	speed: 0.1911s/iter; left time: 5109.9789s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0347s/iter; left time: 923.4411s
	iters: 300, epoch: 36 | loss: 0.0000027
	speed: 0.0336s/iter; left time: 892.2201s
	iters: 400, epoch: 36 | loss: 0.0024328
	speed: 0.0321s/iter; left time: 849.7179s
Epoch: 36 cost time: 15.098994016647339
Epoch: 36, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.308 Vali Acc: 0.973 Test Loss: 0.308 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1944s/iter; left time: 5118.4674s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0311s/iter; left time: 815.7940s
	iters: 300, epoch: 37 | loss: 0.0000770
	speed: 0.0383s/iter; left time: 1001.9737s
	iters: 400, epoch: 37 | loss: 0.0007583
	speed: 0.0374s/iter; left time: 974.7554s
Epoch: 37 cost time: 15.802660465240479
Epoch: 37, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.1835s/iter; left time: 4755.1614s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0294s/iter; left time: 758.3768s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 899.2891s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 909.8381s
Epoch: 38 cost time: 14.706837177276611
Epoch: 38, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.239 Vali Acc: 0.980 Test Loss: 0.239 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 93386
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1754765
	speed: 0.0817s/iter; left time: 3366.7968s
	iters: 200, epoch: 1 | loss: 0.0032321
	speed: 0.0450s/iter; left time: 1848.5351s
	iters: 300, epoch: 1 | loss: 0.8704328
	speed: 0.0455s/iter; left time: 1865.0183s
	iters: 400, epoch: 1 | loss: 0.1031908
	speed: 0.0627s/iter; left time: 2563.5551s
Epoch: 1 cost time: 24.821455001831055
Epoch: 1, Steps: 413 | Train Loss: 0.440 Vali Loss: 0.439 Vali Acc: 0.934 Test Loss: 0.439 Test Acc: 0.934
Validation loss decreased (inf --> -0.933602).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2565404
	speed: 0.2509s/iter; left time: 10234.3600s
	iters: 200, epoch: 2 | loss: 0.3280796
	speed: 0.0436s/iter; left time: 1772.3285s
	iters: 300, epoch: 2 | loss: 0.0002244
	speed: 0.0555s/iter; left time: 2251.7298s
	iters: 400, epoch: 2 | loss: 0.8348380
	speed: 0.0691s/iter; left time: 2797.8429s
Epoch: 2 cost time: 23.760581254959106
Epoch: 2, Steps: 413 | Train Loss: 0.264 Vali Loss: 0.253 Vali Acc: 0.964 Test Loss: 0.253 Test Acc: 0.964
Validation loss decreased (-0.933602 --> -0.964072).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0018175
	speed: 0.2615s/iter; left time: 10559.7236s
	iters: 200, epoch: 3 | loss: 0.0051850
	speed: 0.0542s/iter; left time: 2183.0243s
	iters: 300, epoch: 3 | loss: 0.0000260
	speed: 0.0539s/iter; left time: 2164.5738s
	iters: 400, epoch: 3 | loss: 0.0000000
	speed: 0.0557s/iter; left time: 2232.3199s
Epoch: 3 cost time: 25.145411491394043
Epoch: 3, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.378 Vali Acc: 0.958 Test Loss: 0.378 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000001
	speed: 0.2581s/iter; left time: 10315.2731s
	iters: 200, epoch: 4 | loss: 0.0003447
	speed: 0.0562s/iter; left time: 2242.1465s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.0599s/iter; left time: 2382.4644s
	iters: 400, epoch: 4 | loss: 0.7886330
	speed: 0.0671s/iter; left time: 2660.0691s
Epoch: 4 cost time: 26.824416160583496
Epoch: 4, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.386 Vali Acc: 0.959 Test Loss: 0.386 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3701141
	speed: 0.3000s/iter; left time: 11863.2457s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 2743.0351s
	iters: 300, epoch: 5 | loss: 0.0000003
	speed: 0.0624s/iter; left time: 2453.9291s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0637s/iter; left time: 2501.3387s
Epoch: 5 cost time: 30.314456939697266
Epoch: 5, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.340 Vali Acc: 0.967 Test Loss: 0.340 Test Acc: 0.967
Validation loss decreased (-0.964072 --> -0.966800).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000083
	speed: 0.3035s/iter; left time: 11877.9515s
	iters: 200, epoch: 6 | loss: 0.2891394
	speed: 0.0712s/iter; left time: 2778.5282s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 2589.6401s
	iters: 400, epoch: 6 | loss: 0.0000361
	speed: 0.0670s/iter; left time: 2603.6863s
Epoch: 6 cost time: 31.349138259887695
Epoch: 6, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.672 Vali Acc: 0.947 Test Loss: 0.672 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000001
	speed: 0.2787s/iter; left time: 10792.8906s
	iters: 200, epoch: 7 | loss: 0.0002092
	speed: 0.0690s/iter; left time: 2663.7418s
	iters: 300, epoch: 7 | loss: 0.0011595
	speed: 0.0497s/iter; left time: 1912.9230s
	iters: 400, epoch: 7 | loss: 0.0019397
	speed: 0.0604s/iter; left time: 2320.6391s
Epoch: 7 cost time: 29.293253421783447
Epoch: 7, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.907 Vali Acc: 0.937 Test Loss: 0.907 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2567s/iter; left time: 9835.1358s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0753s/iter; left time: 2876.3096s
	iters: 300, epoch: 8 | loss: 0.0000017
	speed: 0.0565s/iter; left time: 2151.8961s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 2786.4669s
Epoch: 8 cost time: 29.86735224723816
Epoch: 8, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.619 Vali Acc: 0.970 Test Loss: 0.619 Test Acc: 0.970
Validation loss decreased (-0.966800 --> -0.969525).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2846s/iter; left time: 10786.8585s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 2032.8182s
	iters: 300, epoch: 9 | loss: 0.1384816
	speed: 0.0497s/iter; left time: 1872.4686s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1824.3379s
Epoch: 9 cost time: 25.016647815704346
Epoch: 9, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.546 Vali Acc: 0.970 Test Loss: 0.546 Test Acc: 0.970
Validation loss decreased (-0.969525 --> -0.970436).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2413s/iter; left time: 9044.1144s
	iters: 200, epoch: 10 | loss: 0.3998168
	speed: 0.0515s/iter; left time: 1923.6162s
	iters: 300, epoch: 10 | loss: 0.0077837
	speed: 0.0471s/iter; left time: 1755.0998s
	iters: 400, epoch: 10 | loss: 0.6571956
	speed: 0.0579s/iter; left time: 2154.4015s
Epoch: 10 cost time: 23.583223819732666
Epoch: 10, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.707 Vali Acc: 0.969 Test Loss: 0.707 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2125s/iter; left time: 7875.8337s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0471s/iter; left time: 1741.3394s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 1569.2583s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 1286.1270s
Epoch: 11 cost time: 17.907644987106323
Epoch: 11, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.653 Vali Acc: 0.967 Test Loss: 0.653 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2014s/iter; left time: 7383.1674s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 1582.3546s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 1301.2221s
	iters: 400, epoch: 12 | loss: 1.8971255
	speed: 0.0373s/iter; left time: 1354.3495s
Epoch: 12 cost time: 17.39357590675354
Epoch: 12, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.755 Vali Acc: 0.964 Test Loss: 0.755 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2250s/iter; left time: 8155.6462s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0839s/iter; left time: 3034.2259s
	iters: 300, epoch: 13 | loss: 2.0365806
	speed: 0.1085s/iter; left time: 3909.9341s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0954s/iter; left time: 3428.7927s
Epoch: 13 cost time: 37.64353704452515
Epoch: 13, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.908 Vali Acc: 0.954 Test Loss: 0.908 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2612s/iter; left time: 9361.1003s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 2603.6646s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0953s/iter; left time: 3394.4335s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0981s/iter; left time: 3486.3162s
Epoch: 14 cost time: 36.354899644851685
Epoch: 14, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.642 Vali Acc: 0.974 Test Loss: 0.642 Test Acc: 0.974
Validation loss decreased (-0.970436 --> -0.974073).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2629s/iter; left time: 9310.2520s
	iters: 200, epoch: 15 | loss: 0.7678232
	speed: 0.0799s/iter; left time: 2821.4223s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0898s/iter; left time: 3162.5397s
	iters: 400, epoch: 15 | loss: 0.7683228
	speed: 0.0779s/iter; left time: 2735.5838s
Epoch: 15 cost time: 33.31637501716614
Epoch: 15, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.783 Vali Acc: 0.966 Test Loss: 0.783 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.4250236
	speed: 0.2505s/iter; left time: 8770.0703s
	iters: 200, epoch: 16 | loss: 0.0000142
	speed: 0.0612s/iter; left time: 2136.1428s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0865s/iter; left time: 3010.4053s
	iters: 400, epoch: 16 | loss: 0.7522086
	speed: 0.0786s/iter; left time: 2727.4055s
Epoch: 16 cost time: 30.483396530151367
Epoch: 16, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.885 Vali Acc: 0.962 Test Loss: 0.885 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2785s/iter; left time: 9632.4357s
	iters: 200, epoch: 17 | loss: 0.0000002
	speed: 0.0846s/iter; left time: 2917.8616s
	iters: 300, epoch: 17 | loss: 0.4330118
	speed: 0.0737s/iter; left time: 2533.1661s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0620s/iter; left time: 2124.4950s
Epoch: 17 cost time: 31.140082836151123
Epoch: 17, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.781 Vali Acc: 0.965 Test Loss: 0.781 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.1768045
	speed: 0.2198s/iter; left time: 7512.8180s
	iters: 200, epoch: 18 | loss: 0.0024381
	speed: 0.0718s/iter; left time: 2448.3290s
	iters: 300, epoch: 18 | loss: 0.0004298
	speed: 0.0867s/iter; left time: 2946.0146s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0828s/iter; left time: 2805.7897s
Epoch: 18 cost time: 31.226624727249146
Epoch: 18, Steps: 413 | Train Loss: 0.058 Vali Loss: 1.098 Vali Acc: 0.958 Test Loss: 1.098 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2836s/iter; left time: 9577.6690s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0841s/iter; left time: 2831.7894s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0758s/iter; left time: 2545.1032s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0643s/iter; left time: 2150.7716s
Epoch: 19 cost time: 32.94585418701172
Epoch: 19, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.566 Vali Acc: 0.973 Test Loss: 0.566 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000041
	speed: 0.2680s/iter; left time: 8937.8376s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 2619.1581s
	iters: 300, epoch: 20 | loss: 0.0004221
	speed: 0.0508s/iter; left time: 1685.2464s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 1356.5136s
Epoch: 20 cost time: 26.22488498687744
Epoch: 20, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.715 Vali Acc: 0.971 Test Loss: 0.715 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2206s/iter; left time: 7266.3483s
	iters: 200, epoch: 21 | loss: 2.0012321
	speed: 0.0634s/iter; left time: 2080.8936s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0609s/iter; left time: 1995.5585s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 1339.9843s
Epoch: 21 cost time: 24.59319233894348
Epoch: 21, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.743 Vali Acc: 0.967 Test Loss: 0.743 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2401s/iter; left time: 7808.8691s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0663s/iter; left time: 2149.7937s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0707s/iter; left time: 2284.8421s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 1720.9874s
Epoch: 22 cost time: 26.578076124191284
Epoch: 22, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.769 Vali Acc: 0.975 Test Loss: 0.769 Test Acc: 0.975
Validation loss decreased (-0.974073 --> -0.974981).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000197
	speed: 0.2607s/iter; left time: 8372.6488s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0746s/iter; left time: 2388.3813s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0800s/iter; left time: 2552.8348s
	iters: 400, epoch: 23 | loss: 0.0000001
	speed: 0.0779s/iter; left time: 2477.7186s
Epoch: 23 cost time: 32.574283838272095
Epoch: 23, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.621 Vali Acc: 0.976 Test Loss: 0.621 Test Acc: 0.976
Validation loss decreased (-0.974981 --> -0.976347).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2530s/iter; left time: 8019.3717s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0979s/iter; left time: 3093.2395s
	iters: 300, epoch: 24 | loss: 0.0461962
	speed: 0.0914s/iter; left time: 2878.1956s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0955s/iter; left time: 3000.3907s
Epoch: 24 cost time: 37.17028546333313
Epoch: 24, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.623 Vali Acc: 0.975 Test Loss: 0.623 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2502s/iter; left time: 7829.3946s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0738s/iter; left time: 2302.7131s
	iters: 300, epoch: 25 | loss: 0.0001158
	speed: 0.0791s/iter; left time: 2459.9598s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0944s/iter; left time: 2924.6854s
Epoch: 25 cost time: 33.11505174636841
Epoch: 25, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.727 Vali Acc: 0.972 Test Loss: 0.727 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2645s/iter; left time: 8167.5032s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0640s/iter; left time: 1971.2027s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0775s/iter; left time: 2376.7531s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0848s/iter; left time: 2592.7406s
Epoch: 26 cost time: 31.230045795440674
Epoch: 26, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.835 Vali Acc: 0.974 Test Loss: 0.835 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2721s/iter; left time: 8288.4267s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0748s/iter; left time: 2271.0026s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 2624.0540s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 1565.5572s
Epoch: 27 cost time: 30.51912760734558
Epoch: 27, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.982 Vali Acc: 0.965 Test Loss: 0.982 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2353s/iter; left time: 7070.6672s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0553s/iter; left time: 1657.3466s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 1753.9562s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1363.6390s
Epoch: 28 cost time: 23.807268619537354
Epoch: 28, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.607 Vali Acc: 0.975 Test Loss: 0.607 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2320s/iter; left time: 6875.3109s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 1626.1472s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0785s/iter; left time: 2311.1837s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0638s/iter; left time: 1871.2935s
Epoch: 29 cost time: 26.759254693984985
Epoch: 29, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.728 Vali Acc: 0.968 Test Loss: 0.728 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2263s/iter; left time: 6612.5732s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 2003.2361s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0732s/iter; left time: 2124.0724s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0471s/iter; left time: 1362.4146s
Epoch: 30 cost time: 26.435117483139038
Epoch: 30, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.570 Vali Acc: 0.973 Test Loss: 0.570 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2249s/iter; left time: 6478.4148s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 1770.3935s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0634s/iter; left time: 1815.0128s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0578s/iter; left time: 1646.9504s
Epoch: 31 cost time: 25.06269383430481
Epoch: 31, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.753 Vali Acc: 0.972 Test Loss: 0.753 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2298s/iter; left time: 6524.4749s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 1303.3397s
	iters: 300, epoch: 32 | loss: 0.0043150
	speed: 0.0584s/iter; left time: 1645.5348s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 1459.8649s
Epoch: 32 cost time: 23.025360107421875
Epoch: 32, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.579 Vali Acc: 0.977 Test Loss: 0.579 Test Acc: 0.977
Validation loss decreased (-0.976347 --> -0.976802).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2327s/iter; left time: 6512.5579s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 1610.0046s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 2116.2216s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0720s/iter; left time: 1992.4185s
Epoch: 33 cost time: 28.474175453186035
Epoch: 33, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.770 Vali Acc: 0.969 Test Loss: 0.770 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2572s/iter; left time: 7091.5345s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 1432.3072s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0708s/iter; left time: 1936.7157s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0725s/iter; left time: 1976.4180s
Epoch: 34 cost time: 28.1282639503479
Epoch: 34, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.812 Vali Acc: 0.974 Test Loss: 0.812 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2265s/iter; left time: 6152.7879s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0682s/iter; left time: 1844.6938s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0962s/iter; left time: 2592.5040s
	iters: 400, epoch: 35 | loss: 2.0431299
	speed: 0.0895s/iter; left time: 2403.5279s
Epoch: 35 cost time: 32.69827365875244
Epoch: 35, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.602 Vali Acc: 0.977 Test Loss: 0.602 Test Acc: 0.977
Validation loss decreased (-0.976802 --> -0.977256).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2788s/iter; left time: 7456.7837s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0796s/iter; left time: 2122.1031s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0907s/iter; left time: 2407.4998s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0772s/iter; left time: 2040.9703s
Epoch: 36 cost time: 34.93380165100098
Epoch: 36, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.551 Vali Acc: 0.982 Test Loss: 0.551 Test Acc: 0.982
Validation loss decreased (-0.977256 --> -0.981804).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.2394s/iter; left time: 6303.1404s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0664s/iter; left time: 1742.2189s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0571s/iter; left time: 1491.6299s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 1428.6438s
Epoch: 37 cost time: 25.356087923049927
Epoch: 37, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.885 Vali Acc: 0.975 Test Loss: 0.885 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.1963s/iter; left time: 5087.1505s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 1017.5650s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 1097.6969s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 1289.5137s
Epoch: 38 cost time: 18.958621501922607
Epoch: 38, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.926 Vali Acc: 0.971 Test Loss: 0.926 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.2083s/iter; left time: 5312.7665s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0396s/iter; left time: 1007.2086s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 931.7936s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 1233.0555s
Epoch: 39 cost time: 18.577319622039795
Epoch: 39, Steps: 413 | Train Loss: 0.055 Vali Loss: 1.005 Vali Acc: 0.968 Test Loss: 1.005 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.2165s/iter; left time: 5433.5364s
	iters: 200, epoch: 40 | loss: 1.3377657
	speed: 0.0455s/iter; left time: 1137.8440s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0409s/iter; left time: 1017.9418s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0387s/iter; left time: 958.5887s
Epoch: 40 cost time: 18.41044545173645
Epoch: 40, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.918 Vali Acc: 0.970 Test Loss: 0.918 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.2083s/iter; left time: 5140.4277s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 1159.4769s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0484s/iter; left time: 1184.6108s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 1415.1601s
Epoch: 41 cost time: 21.981164693832397
Epoch: 41, Steps: 413 | Train Loss: 0.042 Vali Loss: 1.101 Vali Acc: 0.967 Test Loss: 1.101 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.2267s/iter; left time: 5501.7342s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.0552s/iter; left time: 1335.1860s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0396s/iter; left time: 953.2135s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 844.0277s
Epoch: 42 cost time: 19.442705154418945
Epoch: 42, Steps: 413 | Train Loss: 0.011 Vali Loss: 1.175 Vali Acc: 0.967 Test Loss: 1.175 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.2262s/iter; left time: 5396.7880s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 1141.5575s
	iters: 300, epoch: 43 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 1192.1429s
	iters: 400, epoch: 43 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 1144.3087s
Epoch: 43 cost time: 21.96960711479187
Epoch: 43, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.727 Vali Acc: 0.973 Test Loss: 0.727 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.0000010
	speed: 0.2485s/iter; left time: 5824.3021s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 1387.8650s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 1433.1162s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 1317.6365s
Epoch: 44 cost time: 25.073724031448364
Epoch: 44, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.751 Vali Acc: 0.972 Test Loss: 0.751 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.0000001
	speed: 0.2669s/iter; left time: 6146.1774s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.0754s/iter; left time: 1728.8204s
	iters: 300, epoch: 45 | loss: 0.0000000
	speed: 0.0603s/iter; left time: 1376.6363s
	iters: 400, epoch: 45 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 1192.4381s
Epoch: 45 cost time: 28.485593795776367
Epoch: 45, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.744 Vali Acc: 0.974 Test Loss: 0.744 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.0000000
	speed: 0.2484s/iter; left time: 5617.4146s
	iters: 200, epoch: 46 | loss: 0.0000000
	speed: 0.0880s/iter; left time: 1981.5643s
	iters: 300, epoch: 46 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 1753.0019s
	iters: 400, epoch: 46 | loss: 0.0000000
	speed: 0.0655s/iter; left time: 1462.1203s
Epoch: 46 cost time: 32.07454061508179
Epoch: 46, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.645 Vali Acc: 0.975 Test Loss: 0.645 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 416586
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5164779
	speed: 0.0759s/iter; left time: 3126.3490s
	iters: 200, epoch: 1 | loss: 0.0340352
	speed: 0.0343s/iter; left time: 1407.7440s
	iters: 300, epoch: 1 | loss: 0.0354532
	speed: 0.0340s/iter; left time: 1395.4073s
	iters: 400, epoch: 1 | loss: 0.0038208
	speed: 0.0417s/iter; left time: 1706.5366s
Epoch: 1 cost time: 19.353779077529907
Epoch: 1, Steps: 413 | Train Loss: 0.372 Vali Loss: 0.309 Vali Acc: 0.935 Test Loss: 0.309 Test Acc: 0.935
Validation loss decreased (inf --> -0.934513).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1321682
	speed: 0.2163s/iter; left time: 8822.0532s
	iters: 200, epoch: 2 | loss: 0.0002158
	speed: 0.0380s/iter; left time: 1546.4882s
	iters: 300, epoch: 2 | loss: 0.5960304
	speed: 0.0426s/iter; left time: 1727.7437s
	iters: 400, epoch: 2 | loss: 1.7442386
	speed: 0.0464s/iter; left time: 1876.6260s
Epoch: 2 cost time: 19.166974544525146
Epoch: 2, Steps: 413 | Train Loss: 0.197 Vali Loss: 0.221 Vali Acc: 0.963 Test Loss: 0.221 Test Acc: 0.963
Validation loss decreased (-0.934513 --> -0.963163).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4876773
	speed: 0.2450s/iter; left time: 9891.8016s
	iters: 200, epoch: 3 | loss: 0.0094761
	speed: 0.0489s/iter; left time: 1969.7253s
	iters: 300, epoch: 3 | loss: 0.0000339
	speed: 0.0374s/iter; left time: 1501.6738s
	iters: 400, epoch: 3 | loss: 0.0000367
	speed: 0.0538s/iter; left time: 2157.3442s
Epoch: 3 cost time: 20.581493616104126
Epoch: 3, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.192 Vali Acc: 0.966 Test Loss: 0.192 Test Acc: 0.966
Validation loss decreased (-0.963163 --> -0.966346).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000003
	speed: 0.2292s/iter; left time: 9160.9547s
	iters: 200, epoch: 4 | loss: 0.8681148
	speed: 0.0389s/iter; left time: 1551.8245s
	iters: 300, epoch: 4 | loss: 0.0000008
	speed: 0.0412s/iter; left time: 1638.6335s
	iters: 400, epoch: 4 | loss: 0.0000017
	speed: 0.0460s/iter; left time: 1822.5349s
Epoch: 4 cost time: 18.03113341331482
Epoch: 4, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.311 Vali Acc: 0.963 Test Loss: 0.311 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0004109
	speed: 0.2374s/iter; left time: 9389.8093s
	iters: 200, epoch: 5 | loss: 0.2178288
	speed: 0.0477s/iter; left time: 1883.3597s
	iters: 300, epoch: 5 | loss: 0.4821624
	speed: 0.0574s/iter; left time: 2259.5640s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0571s/iter; left time: 2240.3914s
Epoch: 5 cost time: 21.90617346763611
Epoch: 5, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.513 Vali Acc: 0.948 Test Loss: 0.513 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1107409
	speed: 0.2144s/iter; left time: 8390.0593s
	iters: 200, epoch: 6 | loss: 0.0015671
	speed: 0.0476s/iter; left time: 1856.6987s
	iters: 300, epoch: 6 | loss: 0.0000001
	speed: 0.0438s/iter; left time: 1703.6518s
	iters: 400, epoch: 6 | loss: 0.0000002
	speed: 0.0522s/iter; left time: 2027.3133s
Epoch: 6 cost time: 21.114529371261597
Epoch: 6, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.380 Vali Acc: 0.962 Test Loss: 0.380 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000009
	speed: 0.2202s/iter; left time: 8528.0350s
	iters: 200, epoch: 7 | loss: 0.0000057
	speed: 0.0566s/iter; left time: 2185.9856s
	iters: 300, epoch: 7 | loss: 0.5799487
	speed: 0.0634s/iter; left time: 2441.1670s
	iters: 400, epoch: 7 | loss: 0.0110060
	speed: 0.0721s/iter; left time: 2771.8846s
Epoch: 7 cost time: 26.56389856338501
Epoch: 7, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.469 Vali Acc: 0.960 Test Loss: 0.469 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000056
	speed: 0.2314s/iter; left time: 8863.1855s
	iters: 200, epoch: 8 | loss: 0.0000001
	speed: 0.0520s/iter; left time: 1985.4963s
	iters: 300, epoch: 8 | loss: 0.0000011
	speed: 0.0607s/iter; left time: 2312.5839s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 2626.3134s
Epoch: 8 cost time: 24.884907722473145
Epoch: 8, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.549 Vali Acc: 0.959 Test Loss: 0.549 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2330s/iter; left time: 8828.6494s
	iters: 200, epoch: 9 | loss: 0.5392030
	speed: 0.0535s/iter; left time: 2023.0383s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0505s/iter; left time: 1904.2623s
	iters: 400, epoch: 9 | loss: 0.2947677
	speed: 0.0512s/iter; left time: 1926.0644s
Epoch: 9 cost time: 22.029444456100464
Epoch: 9, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.611 Vali Acc: 0.961 Test Loss: 0.611 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2443s/iter; left time: 9157.0826s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 1754.8452s
	iters: 300, epoch: 10 | loss: 0.0000013
	speed: 0.0445s/iter; left time: 1659.8237s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0428s/iter; left time: 1589.8643s
Epoch: 10 cost time: 20.41535758972168
Epoch: 10, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.619 Vali Acc: 0.964 Test Loss: 0.619 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.2347s/iter; left time: 8698.9587s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 1847.0455s
	iters: 300, epoch: 11 | loss: 0.4212290
	speed: 0.0512s/iter; left time: 1889.5738s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0605s/iter; left time: 2222.9534s
Epoch: 11 cost time: 22.707664728164673
Epoch: 11, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.593 Vali Acc: 0.964 Test Loss: 0.593 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2225s/iter; left time: 8155.6193s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0393s/iter; left time: 1438.4197s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 1493.5822s
	iters: 400, epoch: 12 | loss: 0.0035913
	speed: 0.0420s/iter; left time: 1527.5950s
Epoch: 12 cost time: 18.285343647003174
Epoch: 12, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.803 Vali Acc: 0.964 Test Loss: 0.803 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2248s/iter; left time: 8147.9453s
	iters: 200, epoch: 13 | loss: 0.9530888
	speed: 0.0640s/iter; left time: 2311.5608s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 1653.1525s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0397s/iter; left time: 1427.3977s
Epoch: 13 cost time: 22.667038440704346
Epoch: 13, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.903 Vali Acc: 0.961 Test Loss: 0.903 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9663483401546157
model parameter : 283594
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2040957
	speed: 0.0749s/iter; left time: 3084.9663s
	iters: 200, epoch: 1 | loss: 0.0062514
	speed: 0.0410s/iter; left time: 1686.3305s
	iters: 300, epoch: 1 | loss: 0.4006465
	speed: 0.0402s/iter; left time: 1646.7590s
	iters: 400, epoch: 1 | loss: 0.2599570
	speed: 0.0576s/iter; left time: 2354.1331s
Epoch: 1 cost time: 22.103834629058838
Epoch: 1, Steps: 413 | Train Loss: 0.392 Vali Loss: 0.257 Vali Acc: 0.932 Test Loss: 0.257 Test Acc: 0.932
Validation loss decreased (inf --> -0.931785).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0201956
	speed: 0.2199s/iter; left time: 8968.6453s
	iters: 200, epoch: 2 | loss: 0.0125903
	speed: 0.0417s/iter; left time: 1695.4700s
	iters: 300, epoch: 2 | loss: 0.0080114
	speed: 0.0340s/iter; left time: 1381.3690s
	iters: 400, epoch: 2 | loss: 0.1062168
	speed: 0.0425s/iter; left time: 1719.6946s
Epoch: 2 cost time: 17.696105241775513
Epoch: 2, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.226 Vali Acc: 0.959 Test Loss: 0.226 Test Acc: 0.959
Validation loss decreased (-0.931785 --> -0.959070).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0353529
	speed: 0.2031s/iter; left time: 8200.7793s
	iters: 200, epoch: 3 | loss: 0.2731607
	speed: 0.0411s/iter; left time: 1657.2691s
	iters: 300, epoch: 3 | loss: 0.0000025
	speed: 0.0445s/iter; left time: 1786.1007s
	iters: 400, epoch: 3 | loss: 0.1368260
	speed: 0.0429s/iter; left time: 1719.6153s
Epoch: 3 cost time: 18.454506158828735
Epoch: 3, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.187 Vali Acc: 0.970 Test Loss: 0.187 Test Acc: 0.970
Validation loss decreased (-0.959070 --> -0.969984).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0003020
	speed: 0.2235s/iter; left time: 8931.4267s
	iters: 200, epoch: 4 | loss: 0.0000073
	speed: 0.0449s/iter; left time: 1788.0994s
	iters: 300, epoch: 4 | loss: 0.1172875
	speed: 0.0464s/iter; left time: 1844.6056s
	iters: 400, epoch: 4 | loss: 0.2595862
	speed: 0.0605s/iter; left time: 2399.5897s
Epoch: 4 cost time: 21.364830017089844
Epoch: 4, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.400 Vali Acc: 0.956 Test Loss: 0.400 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0007537
	speed: 0.2422s/iter; left time: 9578.9177s
	iters: 200, epoch: 5 | loss: 0.0000433
	speed: 0.0717s/iter; left time: 2829.2323s
	iters: 300, epoch: 5 | loss: 0.0000243
	speed: 0.0563s/iter; left time: 2214.8695s
	iters: 400, epoch: 5 | loss: 0.2456924
	speed: 0.0560s/iter; left time: 2197.0656s
Epoch: 5 cost time: 25.922970294952393
Epoch: 5, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.295 Vali Acc: 0.957 Test Loss: 0.295 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2491290
	speed: 0.2573s/iter; left time: 10071.2599s
	iters: 200, epoch: 6 | loss: 0.0000020
	speed: 0.0560s/iter; left time: 2186.4395s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0495s/iter; left time: 1925.7322s
	iters: 400, epoch: 6 | loss: 0.0001393
	speed: 0.0433s/iter; left time: 1680.3103s
Epoch: 6 cost time: 23.84251093864441
Epoch: 6, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.453 Vali Acc: 0.959 Test Loss: 0.453 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000050
	speed: 0.2337s/iter; left time: 9047.7428s
	iters: 200, epoch: 7 | loss: 0.0067383
	speed: 0.0530s/iter; left time: 2047.1427s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0501s/iter; left time: 1929.3147s
	iters: 400, epoch: 7 | loss: 1.3300477
	speed: 0.0571s/iter; left time: 2192.1718s
Epoch: 7 cost time: 23.30769419670105
Epoch: 7, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.285 Vali Acc: 0.969 Test Loss: 0.285 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0009711
	speed: 0.2398s/iter; left time: 9186.6333s
	iters: 200, epoch: 8 | loss: 0.0000439
	speed: 0.0683s/iter; left time: 2610.4331s
	iters: 300, epoch: 8 | loss: 0.0000301
	speed: 0.0521s/iter; left time: 1986.5280s
	iters: 400, epoch: 8 | loss: 0.0000002
	speed: 0.0476s/iter; left time: 1808.7949s
Epoch: 8 cost time: 24.969016075134277
Epoch: 8, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.420 Vali Acc: 0.960 Test Loss: 0.420 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0003786
	speed: 0.2247s/iter; left time: 8515.5417s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 1883.9464s
	iters: 300, epoch: 9 | loss: 0.1996510
	speed: 0.0502s/iter; left time: 1891.1159s
	iters: 400, epoch: 9 | loss: 0.3272862
	speed: 0.0463s/iter; left time: 1741.1012s
Epoch: 9 cost time: 20.92789316177368
Epoch: 9, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.384 Vali Acc: 0.966 Test Loss: 0.384 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0015778
	speed: 0.2109s/iter; left time: 7907.0583s
	iters: 200, epoch: 10 | loss: 0.0000130
	speed: 0.0407s/iter; left time: 1521.7430s
	iters: 300, epoch: 10 | loss: 0.0020415
	speed: 0.0385s/iter; left time: 1434.7447s
	iters: 400, epoch: 10 | loss: 0.0000002
	speed: 0.0328s/iter; left time: 1220.2048s
Epoch: 10 cost time: 16.613540172576904
Epoch: 10, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.527 Vali Acc: 0.965 Test Loss: 0.527 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1905s/iter; left time: 7060.8840s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0404s/iter; left time: 1492.2102s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 1284.2939s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0401s/iter; left time: 1475.4227s
Epoch: 11 cost time: 17.165750741958618
Epoch: 11, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.456 Vali Acc: 0.960 Test Loss: 0.456 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1873s/iter; left time: 6866.8872s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 1433.4652s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 1555.0146s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 1282.4489s
Epoch: 12 cost time: 17.01973795890808
Epoch: 12, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.474 Vali Acc: 0.971 Test Loss: 0.474 Test Acc: 0.971
Validation loss decreased (-0.969984 --> -0.971346).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1958s/iter; left time: 7095.9917s
	iters: 200, epoch: 13 | loss: 0.0010679
	speed: 0.0377s/iter; left time: 1363.3040s
	iters: 300, epoch: 13 | loss: 0.0000007
	speed: 0.0447s/iter; left time: 1609.4566s
	iters: 400, epoch: 13 | loss: 0.0000687
	speed: 0.0481s/iter; left time: 1729.3074s
Epoch: 13 cost time: 18.580444812774658
Epoch: 13, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.464 Vali Acc: 0.973 Test Loss: 0.464 Test Acc: 0.973
Validation loss decreased (-0.971346 --> -0.972710).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1960691
	speed: 0.2088s/iter; left time: 7482.2023s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 1333.5623s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0399s/iter; left time: 1420.8053s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 1562.7751s
Epoch: 14 cost time: 17.310840606689453
Epoch: 14, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.413 Vali Acc: 0.974 Test Loss: 0.413 Test Acc: 0.974
Validation loss decreased (-0.972710 --> -0.973620).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2071s/iter; left time: 7335.3876s
	iters: 200, epoch: 15 | loss: 0.3342724
	speed: 0.0495s/iter; left time: 1748.3585s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 1688.8873s
	iters: 400, epoch: 15 | loss: 0.0004995
	speed: 0.0531s/iter; left time: 1864.6910s
Epoch: 15 cost time: 20.457054138183594
Epoch: 15, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.378 Vali Acc: 0.973 Test Loss: 0.378 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2114s/iter; left time: 7400.3718s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0471s/iter; left time: 1645.6472s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1704.0763s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 1791.6251s
Epoch: 16 cost time: 20.537246704101562
Epoch: 16, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.506 Vali Acc: 0.968 Test Loss: 0.506 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2129s/iter; left time: 7364.4963s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0693s/iter; left time: 2390.1083s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0513s/iter; left time: 1765.7224s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0578s/iter; left time: 1982.4592s
Epoch: 17 cost time: 25.15386724472046
Epoch: 17, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.362 Vali Acc: 0.978 Test Loss: 0.362 Test Acc: 0.978
Validation loss decreased (-0.973620 --> -0.978168).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2272s/iter; left time: 7765.6629s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.0711s/iter; left time: 2422.1804s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0724s/iter; left time: 2458.7003s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 2073.9667s
Epoch: 18 cost time: 27.636571407318115
Epoch: 18, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.417 Vali Acc: 0.975 Test Loss: 0.417 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2088s/iter; left time: 7050.7785s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 2385.3855s
	iters: 300, epoch: 19 | loss: 0.0000369
	speed: 0.0581s/iter; left time: 1951.2870s
	iters: 400, epoch: 19 | loss: 0.0000013
	speed: 0.0532s/iter; left time: 1782.0409s
Epoch: 19 cost time: 25.074897527694702
Epoch: 19, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.410 Vali Acc: 0.978 Test Loss: 0.410 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2153s/iter; left time: 7180.1315s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 1254.1262s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 1489.7921s
	iters: 400, epoch: 20 | loss: 0.0000784
	speed: 0.0447s/iter; left time: 1478.3668s
Epoch: 20 cost time: 18.325040340423584
Epoch: 20, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.412 Vali Acc: 0.979 Test Loss: 0.412 Test Acc: 0.979
Validation loss decreased (-0.978168 --> -0.978623).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1974s/iter; left time: 6501.7334s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 1264.5565s
	iters: 300, epoch: 21 | loss: 0.0000440
	speed: 0.0408s/iter; left time: 1334.4907s
	iters: 400, epoch: 21 | loss: 0.0000194
	speed: 0.0546s/iter; left time: 1781.9426s
Epoch: 21 cost time: 18.244839429855347
Epoch: 21, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.411 Vali Acc: 0.974 Test Loss: 0.411 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2148s/iter; left time: 6986.1110s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 1302.2371s
	iters: 300, epoch: 22 | loss: 0.0005138
	speed: 0.0454s/iter; left time: 1466.5324s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0404s/iter; left time: 1302.4610s
Epoch: 22 cost time: 18.18321418762207
Epoch: 22, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.515 Vali Acc: 0.974 Test Loss: 0.515 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1938s/iter; left time: 6223.5457s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 1320.1626s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 1256.5355s
	iters: 400, epoch: 23 | loss: 0.6280184
	speed: 0.0336s/iter; left time: 1069.2083s
Epoch: 23 cost time: 16.366283416748047
Epoch: 23, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.445 Vali Acc: 0.977 Test Loss: 0.445 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000007
	speed: 0.2147s/iter; left time: 6805.5899s
	iters: 200, epoch: 24 | loss: 0.9810297
	speed: 0.0476s/iter; left time: 1504.7228s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0364s/iter; left time: 1145.6847s
	iters: 400, epoch: 24 | loss: 0.0000439
	speed: 0.0527s/iter; left time: 1654.7872s
Epoch: 24 cost time: 21.159517288208008
Epoch: 24, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.386 Vali Acc: 0.980 Test Loss: 0.386 Test Acc: 0.980
Validation loss decreased (-0.978623 --> -0.979987).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1924s/iter; left time: 6020.3111s
	iters: 200, epoch: 25 | loss: 0.0091366
	speed: 0.0514s/iter; left time: 1601.6603s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 1566.6156s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 1286.1846s
Epoch: 25 cost time: 19.46221375465393
Epoch: 25, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.394 Vali Acc: 0.975 Test Loss: 0.394 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1904s/iter; left time: 5878.7902s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1316.4890s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 1490.8287s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 1837.6072s
Epoch: 26 cost time: 20.188394784927368
Epoch: 26, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.330 Vali Acc: 0.981 Test Loss: 0.330 Test Acc: 0.981
Validation loss decreased (-0.979987 --> -0.980897).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2192s/iter; left time: 6677.9429s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 1223.0760s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 1499.8055s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 1316.3953s
Epoch: 27 cost time: 19.504570960998535
Epoch: 27, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.496 Vali Acc: 0.975 Test Loss: 0.496 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0310060
	speed: 0.2244s/iter; left time: 6742.1829s
	iters: 200, epoch: 28 | loss: 0.0013204
	speed: 0.0432s/iter; left time: 1292.6893s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 1561.1121s
	iters: 400, epoch: 28 | loss: 2.1617393
	speed: 0.0510s/iter; left time: 1517.3441s
Epoch: 28 cost time: 21.233630895614624
Epoch: 28, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.633 Vali Acc: 0.965 Test Loss: 0.633 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2421s/iter; left time: 7175.1357s
	iters: 200, epoch: 29 | loss: 0.0009968
	speed: 0.0571s/iter; left time: 1686.2895s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 1394.3915s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 1284.9131s
Epoch: 29 cost time: 23.691452980041504
Epoch: 29, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.426 Vali Acc: 0.979 Test Loss: 0.426 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2334s/iter; left time: 6819.9208s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 1964.6582s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 1931.2333s
	iters: 400, epoch: 30 | loss: 0.0088241
	speed: 0.0529s/iter; left time: 1531.2826s
Epoch: 30 cost time: 27.234243154525757
Epoch: 30, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.521 Vali Acc: 0.976 Test Loss: 0.521 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1977s/iter; left time: 5694.6357s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1392.4586s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0603s/iter; left time: 1724.2204s
	iters: 400, epoch: 31 | loss: 0.0000045
	speed: 0.0548s/iter; left time: 1563.3722s
Epoch: 31 cost time: 22.313417434692383
Epoch: 31, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.548 Vali Acc: 0.974 Test Loss: 0.548 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0003057
	speed: 0.1897s/iter; left time: 5386.0964s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 1024.5618s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 1028.2310s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1201.7626s
Epoch: 32 cost time: 17.03762650489807
Epoch: 32, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.271 Vali Acc: 0.982 Test Loss: 0.271 Test Acc: 0.982
Validation loss decreased (-0.980897 --> -0.982262).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2179s/iter; left time: 6098.5699s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 1153.2450s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1086.5838s
	iters: 400, epoch: 33 | loss: 0.0000002
	speed: 0.0472s/iter; left time: 1307.7721s
Epoch: 33 cost time: 18.936701774597168
Epoch: 33, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.513 Vali Acc: 0.972 Test Loss: 0.513 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2178s/iter; left time: 6005.1974s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 1286.6547s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1163.8860s
	iters: 400, epoch: 34 | loss: 0.0960870
	speed: 0.0390s/iter; left time: 1063.6502s
Epoch: 34 cost time: 18.66001868247986
Epoch: 34, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.650 Vali Acc: 0.967 Test Loss: 0.650 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2141s/iter; left time: 5814.4784s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 979.8960s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 1164.8212s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 1018.4205s
Epoch: 35 cost time: 17.81543493270874
Epoch: 35, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.464 Vali Acc: 0.979 Test Loss: 0.464 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2074s/iter; left time: 5546.3789s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 1084.6793s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0386s/iter; left time: 1024.3232s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 1170.2871s
Epoch: 36 cost time: 18.352685689926147
Epoch: 36, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.367 Vali Acc: 0.978 Test Loss: 0.367 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0000517
	speed: 0.2040s/iter; left time: 5371.9649s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 1941.9658s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 1814.1688s
	iters: 400, epoch: 37 | loss: 0.0000001
	speed: 0.0545s/iter; left time: 1418.0336s
Epoch: 37 cost time: 26.119486331939697
Epoch: 37, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.369 Vali Acc: 0.981 Test Loss: 0.369 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2242s/iter; left time: 5810.5611s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 1299.1026s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 1456.2114s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 1478.1703s
Epoch: 38 cost time: 23.341501235961914
Epoch: 38, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.376 Vali Acc: 0.979 Test Loss: 0.376 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.2166s/iter; left time: 5524.6601s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 1325.9862s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 1566.2725s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0630s/iter; left time: 1587.5124s
Epoch: 39 cost time: 24.340850114822388
Epoch: 39, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.343 Vali Acc: 0.978 Test Loss: 0.343 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.2301s/iter; left time: 5773.1614s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1160.8917s
	iters: 300, epoch: 40 | loss: 0.3501798
	speed: 0.0506s/iter; left time: 1258.7462s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0562s/iter; left time: 1394.0337s
Epoch: 40 cost time: 22.41059684753418
Epoch: 40, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.665 Vali Acc: 0.970 Test Loss: 0.665 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.2115s/iter; left time: 5221.1083s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0408s/iter; left time: 1003.1639s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 1064.1506s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0575s/iter; left time: 1400.7997s
Epoch: 41 cost time: 20.65816044807434
Epoch: 41, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.439 Vali Acc: 0.977 Test Loss: 0.439 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.2082s/iter; left time: 5053.2642s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 951.8877s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 970.2800s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 890.0944s
Epoch: 42 cost time: 16.2072856426239
Epoch: 42, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.389 Vali Acc: 0.980 Test Loss: 0.389 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 217162
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1614198
	speed: 0.0859s/iter; left time: 3539.1236s
	iters: 200, epoch: 1 | loss: 0.1028698
	speed: 0.0488s/iter; left time: 2006.5367s
	iters: 300, epoch: 1 | loss: 0.0162544
	speed: 0.0493s/iter; left time: 2022.8727s
	iters: 400, epoch: 1 | loss: 0.1111146
	speed: 0.0390s/iter; left time: 1596.8015s
Epoch: 1 cost time: 22.92127561569214
Epoch: 1, Steps: 413 | Train Loss: 0.363 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (inf --> -0.944064).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8217884
	speed: 0.2004s/iter; left time: 8175.5242s
	iters: 200, epoch: 2 | loss: 0.0074806
	speed: 0.0352s/iter; left time: 1433.5808s
	iters: 300, epoch: 2 | loss: 0.0179020
	speed: 0.0389s/iter; left time: 1576.9021s
	iters: 400, epoch: 2 | loss: 0.0006405
	speed: 0.0383s/iter; left time: 1552.1400s
Epoch: 2 cost time: 16.439462661743164
Epoch: 2, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
Validation loss decreased (-0.944064 --> -0.964528).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0013540
	speed: 0.2062s/iter; left time: 8325.0603s
	iters: 200, epoch: 3 | loss: 0.0000615
	speed: 0.0339s/iter; left time: 1366.2618s
	iters: 300, epoch: 3 | loss: 0.0009309
	speed: 0.0335s/iter; left time: 1347.0450s
	iters: 400, epoch: 3 | loss: 0.0007915
	speed: 0.0340s/iter; left time: 1363.8150s
Epoch: 3 cost time: 15.277460813522339
Epoch: 3, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.293 Vali Acc: 0.948 Test Loss: 0.293 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0003562
	speed: 0.1844s/iter; left time: 7367.3434s
	iters: 200, epoch: 4 | loss: 0.1957119
	speed: 0.0360s/iter; left time: 1436.9977s
	iters: 300, epoch: 4 | loss: 0.2468009
	speed: 0.0334s/iter; left time: 1327.1958s
	iters: 400, epoch: 4 | loss: 0.1859163
	speed: 0.0355s/iter; left time: 1409.4152s
Epoch: 4 cost time: 15.11152458190918
Epoch: 4, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.233 Vali Acc: 0.966 Test Loss: 0.233 Test Acc: 0.966
Validation loss decreased (-0.964528 --> -0.965891).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0011510
	speed: 0.1942s/iter; left time: 7679.3103s
	iters: 200, epoch: 5 | loss: 0.0005202
	speed: 0.0443s/iter; left time: 1749.4786s
	iters: 300, epoch: 5 | loss: 0.0000009
	speed: 0.0542s/iter; left time: 2133.3240s
	iters: 400, epoch: 5 | loss: 0.3872869
	speed: 0.0485s/iter; left time: 1903.1219s
Epoch: 5 cost time: 20.176449298858643
Epoch: 5, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000028
	speed: 0.2333s/iter; left time: 9131.0899s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0708s/iter; left time: 2764.4779s
	iters: 300, epoch: 6 | loss: 0.0000118
	speed: 0.0527s/iter; left time: 2050.3478s
	iters: 400, epoch: 6 | loss: 0.6535695
	speed: 0.0527s/iter; left time: 2044.7277s
Epoch: 6 cost time: 26.817360639572144
Epoch: 6, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.292 Vali Acc: 0.967 Test Loss: 0.292 Test Acc: 0.967
Validation loss decreased (-0.965891 --> -0.966800).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2094s/iter; left time: 8108.4985s
	iters: 200, epoch: 7 | loss: 0.2574146
	speed: 0.0594s/iter; left time: 2292.7296s
	iters: 300, epoch: 7 | loss: 0.0001118
	speed: 0.0690s/iter; left time: 2659.2893s
	iters: 400, epoch: 7 | loss: 0.0000018
	speed: 0.0686s/iter; left time: 2634.5975s
Epoch: 7 cost time: 26.381031036376953
Epoch: 7, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.262 Vali Acc: 0.970 Test Loss: 0.262 Test Acc: 0.970
Validation loss decreased (-0.966800 --> -0.969984).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4993728
	speed: 0.2273s/iter; left time: 8709.0016s
	iters: 200, epoch: 8 | loss: 0.0117756
	speed: 0.0499s/iter; left time: 1905.4971s
	iters: 300, epoch: 8 | loss: 0.5280476
	speed: 0.0562s/iter; left time: 2143.2528s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 2154.0795s
Epoch: 8 cost time: 23.323216438293457
Epoch: 8, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
Validation loss decreased (-0.969984 --> -0.975441).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000118
	speed: 0.2144s/iter; left time: 8126.2884s
	iters: 200, epoch: 9 | loss: 0.0000210
	speed: 0.0440s/iter; left time: 1661.6366s
	iters: 300, epoch: 9 | loss: 0.0014234
	speed: 0.0474s/iter; left time: 1786.5539s
	iters: 400, epoch: 9 | loss: 0.1812172
	speed: 0.0414s/iter; left time: 1555.7771s
Epoch: 9 cost time: 19.302165985107422
Epoch: 9, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.193 Vali Acc: 0.974 Test Loss: 0.193 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1999s/iter; left time: 7492.2458s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0397s/iter; left time: 1483.9745s
	iters: 300, epoch: 10 | loss: 0.0000028
	speed: 0.0403s/iter; left time: 1502.6545s
	iters: 400, epoch: 10 | loss: 0.0000014
	speed: 0.0396s/iter; left time: 1473.5862s
Epoch: 10 cost time: 17.24721074104309
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.263 Vali Acc: 0.972 Test Loss: 0.263 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0005537
	speed: 0.2088s/iter; left time: 7742.0434s
	iters: 200, epoch: 11 | loss: 0.0153087
	speed: 0.0424s/iter; left time: 1568.8605s
	iters: 300, epoch: 11 | loss: 0.0001148
	speed: 0.0426s/iter; left time: 1569.8551s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1465.0635s
Epoch: 11 cost time: 18.456088304519653
Epoch: 11, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.279 Vali Acc: 0.974 Test Loss: 0.279 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0703771
	speed: 0.2087s/iter; left time: 7650.1175s
	iters: 200, epoch: 12 | loss: 0.0049020
	speed: 0.0467s/iter; left time: 1706.5035s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 1404.3645s
	iters: 400, epoch: 12 | loss: 0.0000152
	speed: 0.0410s/iter; left time: 1492.3296s
Epoch: 12 cost time: 18.348297595977783
Epoch: 12, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.436 Vali Acc: 0.970 Test Loss: 0.436 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2009s/iter; left time: 7281.9911s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 1915.3503s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 2119.9333s
	iters: 400, epoch: 13 | loss: 0.0005968
	speed: 0.0414s/iter; left time: 1487.5105s
Epoch: 13 cost time: 21.70157742500305
Epoch: 13, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.389 Vali Acc: 0.973 Test Loss: 0.389 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1856s/iter; left time: 6650.4100s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 1246.8336s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 1396.1436s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 1393.6651s
Epoch: 14 cost time: 16.54985523223877
Epoch: 14, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.375 Vali Acc: 0.969 Test Loss: 0.375 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1993s/iter; left time: 7058.0662s
	iters: 200, epoch: 15 | loss: 0.0000040
	speed: 0.0417s/iter; left time: 1471.7647s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 1454.1893s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 1555.2315s
Epoch: 15 cost time: 17.63211965560913
Epoch: 15, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.361 Vali Acc: 0.973 Test Loss: 0.361 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2151s/iter; left time: 7528.1353s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.0485s/iter; left time: 1692.5744s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 1857.3265s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 2104.4216s
Epoch: 16 cost time: 22.48225450515747
Epoch: 16, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.432 Vali Acc: 0.970 Test Loss: 0.432 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2297s/iter; left time: 7947.3968s
	iters: 200, epoch: 17 | loss: 0.0000007
	speed: 0.0522s/iter; left time: 1800.9928s
	iters: 300, epoch: 17 | loss: 0.1384023
	speed: 0.0502s/iter; left time: 1725.4719s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 1878.4448s
Epoch: 17 cost time: 22.652489185333252
Epoch: 17, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.316 Vali Acc: 0.977 Test Loss: 0.316 Test Acc: 0.977
Validation loss decreased (-0.975441 --> -0.977259).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0003662
	speed: 0.2229s/iter; left time: 7620.0758s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 1622.0953s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1556.1153s
	iters: 400, epoch: 18 | loss: 0.0000099
	speed: 0.0476s/iter; left time: 1612.7785s
Epoch: 18 cost time: 20.373023986816406
Epoch: 18, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.262 Vali Acc: 0.981 Test Loss: 0.262 Test Acc: 0.981
Validation loss decreased (-0.977259 --> -0.980898).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2315s/iter; left time: 7815.6652s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0471s/iter; left time: 1584.5646s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 1764.9710s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 1501.6736s
Epoch: 19 cost time: 21.691906452178955
Epoch: 19, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.301 Vali Acc: 0.981 Test Loss: 0.301 Test Acc: 0.981
Validation loss decreased (-0.980898 --> -0.981352).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0012970
	speed: 0.2319s/iter; left time: 7734.2462s
	iters: 200, epoch: 20 | loss: 0.0001713
	speed: 0.0564s/iter; left time: 1876.5149s
	iters: 300, epoch: 20 | loss: 0.0000021
	speed: 0.0483s/iter; left time: 1602.6253s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0453s/iter; left time: 1497.9925s
Epoch: 20 cost time: 22.972111701965332
Epoch: 20, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.296 Vali Acc: 0.980 Test Loss: 0.296 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.3284377
	speed: 0.2097s/iter; left time: 6909.0322s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0404s/iter; left time: 1326.8846s
	iters: 300, epoch: 21 | loss: 0.0000159
	speed: 0.0468s/iter; left time: 1530.7266s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0393s/iter; left time: 1283.0912s
Epoch: 21 cost time: 17.987500429153442
Epoch: 21, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.351 Vali Acc: 0.976 Test Loss: 0.351 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2043s/iter; left time: 6644.1356s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0372s/iter; left time: 1207.7930s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0424s/iter; left time: 1371.3636s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 1629.2871s
Epoch: 22 cost time: 18.255120992660522
Epoch: 22, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.339 Vali Acc: 0.980 Test Loss: 0.339 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1974s/iter; left time: 6340.7548s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 1476.3785s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0543s/iter; left time: 1731.7893s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0564s/iter; left time: 1792.8528s
Epoch: 23 cost time: 21.51222848892212
Epoch: 23, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.339 Vali Acc: 0.982 Test Loss: 0.339 Test Acc: 0.982
Validation loss decreased (-0.981352 --> -0.981807).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000001
	speed: 0.2057s/iter; left time: 6520.3912s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0483s/iter; left time: 1525.3895s
	iters: 300, epoch: 24 | loss: 0.0000070
	speed: 0.0650s/iter; left time: 2047.8009s
	iters: 400, epoch: 24 | loss: 0.0000071
	speed: 0.0586s/iter; left time: 1841.1766s
Epoch: 24 cost time: 23.32560420036316
Epoch: 24, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.363 Vali Acc: 0.977 Test Loss: 0.363 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2075s/iter; left time: 6492.0392s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 1174.4690s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 1150.9698s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 1280.4445s
Epoch: 25 cost time: 16.77239465713501
Epoch: 25, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.385 Vali Acc: 0.972 Test Loss: 0.385 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2083s/iter; left time: 6430.4641s
	iters: 200, epoch: 26 | loss: 1.3297343
	speed: 0.0467s/iter; left time: 1437.8158s
	iters: 300, epoch: 26 | loss: 0.0000007
	speed: 0.0338s/iter; left time: 1036.3708s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 1408.0121s
Epoch: 26 cost time: 18.736666679382324
Epoch: 26, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.291 Vali Acc: 0.981 Test Loss: 0.291 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2137s/iter; left time: 6509.1460s
	iters: 200, epoch: 27 | loss: 0.2801902
	speed: 0.0445s/iter; left time: 1352.1277s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 1394.0914s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 1337.8755s
Epoch: 27 cost time: 19.498323917388916
Epoch: 27, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.304 Vali Acc: 0.976 Test Loss: 0.304 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2320s/iter; left time: 6972.1507s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0592s/iter; left time: 1773.4857s
	iters: 300, epoch: 28 | loss: 0.6273295
	speed: 0.0405s/iter; left time: 1208.5978s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 1409.1730s
Epoch: 28 cost time: 22.78356099128723
Epoch: 28, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.368 Vali Acc: 0.977 Test Loss: 0.368 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2375s/iter; left time: 7039.8715s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 2114.3533s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0609s/iter; left time: 1793.6025s
	iters: 400, epoch: 29 | loss: 0.0000001
	speed: 0.0668s/iter; left time: 1959.3040s
Epoch: 29 cost time: 28.631582736968994
Epoch: 29, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.418 Vali Acc: 0.975 Test Loss: 0.418 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2348s/iter; left time: 6862.8231s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 2303.8992s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 1905.1394s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 1505.7720s
Epoch: 30 cost time: 27.816771030426025
Epoch: 30, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.382 Vali Acc: 0.977 Test Loss: 0.382 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000260
	speed: 0.2110s/iter; left time: 6078.6340s
	iters: 200, epoch: 31 | loss: 0.0005865
	speed: 0.0546s/iter; left time: 1567.1847s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 1071.6098s
	iters: 400, epoch: 31 | loss: 0.5873706
	speed: 0.0447s/iter; left time: 1274.5511s
Epoch: 31 cost time: 19.94564175605774
Epoch: 31, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.319 Vali Acc: 0.980 Test Loss: 0.319 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1925s/iter; left time: 5465.9067s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0330s/iter; left time: 934.2288s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 1009.7669s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 1039.4794s
Epoch: 32 cost time: 15.848700523376465
Epoch: 32, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.282 Vali Acc: 0.981 Test Loss: 0.282 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1806s/iter; left time: 5055.3768s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0286s/iter; left time: 798.8265s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0300s/iter; left time: 834.8826s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0314s/iter; left time: 869.3406s
Epoch: 33 cost time: 13.343382358551025
Epoch: 33, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.417 Vali Acc: 0.975 Test Loss: 0.417 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 175754
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2204465
	speed: 0.0714s/iter; left time: 2940.9508s
	iters: 200, epoch: 1 | loss: 0.4645027
	speed: 0.0613s/iter; left time: 2520.6678s
	iters: 300, epoch: 1 | loss: 0.0177127
	speed: 0.0543s/iter; left time: 2227.2900s
	iters: 400, epoch: 1 | loss: 0.0247514
	speed: 0.0418s/iter; left time: 1707.7171s
Epoch: 1 cost time: 23.479713678359985
Epoch: 1, Steps: 413 | Train Loss: 0.374 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
Validation loss decreased (inf --> -0.945883).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9955755
	speed: 0.1924s/iter; left time: 7847.5158s
	iters: 200, epoch: 2 | loss: 0.0011528
	speed: 0.0370s/iter; left time: 1506.0645s
	iters: 300, epoch: 2 | loss: 0.0130228
	speed: 0.0387s/iter; left time: 1568.8033s
	iters: 400, epoch: 2 | loss: 0.5753626
	speed: 0.0356s/iter; left time: 1440.4163s
Epoch: 2 cost time: 16.633882761001587
Epoch: 2, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
Validation loss decreased (-0.945883 --> -0.969076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0191454
	speed: 0.1723s/iter; left time: 6957.5085s
	iters: 200, epoch: 3 | loss: 0.0014478
	speed: 0.0320s/iter; left time: 1287.8588s
	iters: 300, epoch: 3 | loss: 0.0002474
	speed: 0.0327s/iter; left time: 1313.9168s
	iters: 400, epoch: 3 | loss: 0.0381690
	speed: 0.0425s/iter; left time: 1704.8566s
Epoch: 3 cost time: 15.617044448852539
Epoch: 3, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.241 Vali Acc: 0.953 Test Loss: 0.241 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0003065
	speed: 0.2133s/iter; left time: 8523.0463s
	iters: 200, epoch: 4 | loss: 0.0000023
	speed: 0.0376s/iter; left time: 1500.3883s
	iters: 300, epoch: 4 | loss: 0.0000685
	speed: 0.0464s/iter; left time: 1844.7819s
	iters: 400, epoch: 4 | loss: 0.1199488
	speed: 0.0516s/iter; left time: 2045.5751s
Epoch: 4 cost time: 20.100194931030273
Epoch: 4, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.153 Vali Acc: 0.977 Test Loss: 0.153 Test Acc: 0.977
Validation loss decreased (-0.969076 --> -0.977261).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0033032
	speed: 0.1949s/iter; left time: 7706.1983s
	iters: 200, epoch: 5 | loss: 0.0848380
	speed: 0.0625s/iter; left time: 2467.3344s
	iters: 300, epoch: 5 | loss: 0.0021389
	speed: 0.0529s/iter; left time: 2082.6102s
	iters: 400, epoch: 5 | loss: 0.0108747
	speed: 0.0477s/iter; left time: 1872.8740s
Epoch: 5 cost time: 22.118951559066772
Epoch: 5, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3798885
	speed: 0.2052s/iter; left time: 8031.8923s
	iters: 200, epoch: 6 | loss: 0.0000002
	speed: 0.0480s/iter; left time: 1875.2476s
	iters: 300, epoch: 6 | loss: 0.0285236
	speed: 0.0502s/iter; left time: 1953.1015s
	iters: 400, epoch: 6 | loss: 0.0000007
	speed: 0.0487s/iter; left time: 1889.9716s
Epoch: 6 cost time: 20.693430423736572
Epoch: 6, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.223 Vali Acc: 0.972 Test Loss: 0.223 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000855
	speed: 0.2209s/iter; left time: 8553.4919s
	iters: 200, epoch: 7 | loss: 0.0062855
	speed: 0.0499s/iter; left time: 1926.7393s
	iters: 300, epoch: 7 | loss: 0.0207044
	speed: 0.0589s/iter; left time: 2268.5432s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0673s/iter; left time: 2584.4207s
Epoch: 7 cost time: 23.871135234832764
Epoch: 7, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.185 Vali Acc: 0.973 Test Loss: 0.185 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0083222
	speed: 0.2180s/iter; left time: 8352.8145s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1873.8479s
	iters: 300, epoch: 8 | loss: 0.0000056
	speed: 0.0329s/iter; left time: 1255.3490s
	iters: 400, epoch: 8 | loss: 0.0000004
	speed: 0.0381s/iter; left time: 1448.6261s
Epoch: 8 cost time: 18.858526706695557
Epoch: 8, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0034999
	speed: 0.1781s/iter; left time: 6750.7169s
	iters: 200, epoch: 9 | loss: 0.2548357
	speed: 0.0299s/iter; left time: 1131.8419s
	iters: 300, epoch: 9 | loss: 0.0000009
	speed: 0.0303s/iter; left time: 1142.4476s
	iters: 400, epoch: 9 | loss: 0.0000718
	speed: 0.0336s/iter; left time: 1264.2808s
Epoch: 9 cost time: 13.552729368209839
Epoch: 9, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.276 Vali Acc: 0.970 Test Loss: 0.276 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1699s/iter; left time: 6366.7352s
	iters: 200, epoch: 10 | loss: 0.1061598
	speed: 0.0364s/iter; left time: 1359.1569s
	iters: 300, epoch: 10 | loss: 0.0001003
	speed: 0.0341s/iter; left time: 1272.6139s
	iters: 400, epoch: 10 | loss: 0.0001578
	speed: 0.0348s/iter; left time: 1292.3311s
Epoch: 10 cost time: 15.504660606384277
Epoch: 10, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.300 Vali Acc: 0.972 Test Loss: 0.300 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0028217
	speed: 0.1625s/iter; left time: 6023.7662s
	iters: 200, epoch: 11 | loss: 0.0156109
	speed: 0.0378s/iter; left time: 1397.9262s
	iters: 300, epoch: 11 | loss: 0.0000006
	speed: 0.0399s/iter; left time: 1471.0302s
	iters: 400, epoch: 11 | loss: 0.0000017
	speed: 0.0495s/iter; left time: 1821.4176s
Epoch: 11 cost time: 16.936408519744873
Epoch: 11, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.258 Vali Acc: 0.974 Test Loss: 0.258 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1787s/iter; left time: 6550.2673s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0340s/iter; left time: 1241.2910s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 1028.4112s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 1436.2911s
Epoch: 12 cost time: 14.89599895477295
Epoch: 12, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.225 Vali Acc: 0.979 Test Loss: 0.225 Test Acc: 0.979
Validation loss decreased (-0.977261 --> -0.979079).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000741
	speed: 0.1990s/iter; left time: 7213.9489s
	iters: 200, epoch: 13 | loss: 0.0000999
	speed: 0.0318s/iter; left time: 1149.2246s
	iters: 300, epoch: 13 | loss: 0.0000068
	speed: 0.0370s/iter; left time: 1333.3286s
	iters: 400, epoch: 13 | loss: 0.0001053
	speed: 0.0349s/iter; left time: 1253.1117s
Epoch: 13 cost time: 15.224063396453857
Epoch: 13, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.240 Vali Acc: 0.978 Test Loss: 0.240 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.3788329
	speed: 0.2000s/iter; left time: 7165.3922s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 1315.8424s
	iters: 300, epoch: 14 | loss: 0.0028576
	speed: 0.0337s/iter; left time: 1200.4978s
	iters: 400, epoch: 14 | loss: 0.0003520
	speed: 0.0359s/iter; left time: 1273.8677s
Epoch: 14 cost time: 16.73021650314331
Epoch: 14, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.307 Vali Acc: 0.977 Test Loss: 0.307 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1959s/iter; left time: 6939.6843s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 2005.3991s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 2097.9199s
	iters: 400, epoch: 15 | loss: 0.3330225
	speed: 0.0361s/iter; left time: 1269.5395s
Epoch: 15 cost time: 21.730523109436035
Epoch: 15, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.401 Vali Acc: 0.970 Test Loss: 0.401 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1459812
	speed: 0.1608s/iter; left time: 5630.5423s
	iters: 200, epoch: 16 | loss: 0.1125136
	speed: 0.0347s/iter; left time: 1210.5803s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 1468.6395s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 1812.9565s
Epoch: 16 cost time: 17.46679925918579
Epoch: 16, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.344 Vali Acc: 0.973 Test Loss: 0.344 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1481s/iter; left time: 5122.2548s
	iters: 200, epoch: 17 | loss: 0.0577407
	speed: 0.0271s/iter; left time: 934.0101s
	iters: 300, epoch: 17 | loss: 0.0100807
	speed: 0.0311s/iter; left time: 1068.2016s
	iters: 400, epoch: 17 | loss: 0.0000795
	speed: 0.0275s/iter; left time: 944.4537s
Epoch: 17 cost time: 12.3423593044281
Epoch: 17, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.294 Vali Acc: 0.973 Test Loss: 0.294 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1543s/iter; left time: 5275.4220s
	iters: 200, epoch: 18 | loss: 0.4021944
	speed: 0.0260s/iter; left time: 885.5581s
	iters: 300, epoch: 18 | loss: 0.1506539
	speed: 0.0335s/iter; left time: 1139.7635s
	iters: 400, epoch: 18 | loss: 0.0000291
	speed: 0.0321s/iter; left time: 1087.4256s
Epoch: 18 cost time: 13.286623001098633
Epoch: 18, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.214 Vali Acc: 0.976 Test Loss: 0.214 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1609s/iter; left time: 5434.6048s
	iters: 200, epoch: 19 | loss: 0.8811278
	speed: 0.0320s/iter; left time: 1078.1690s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 1211.1705s
	iters: 400, epoch: 19 | loss: 0.0001781
	speed: 0.0392s/iter; left time: 1311.7622s
Epoch: 19 cost time: 15.493547916412354
Epoch: 19, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.297 Vali Acc: 0.979 Test Loss: 0.297 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1880s/iter; left time: 6271.0088s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0655s/iter; left time: 2177.5520s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0536s/iter; left time: 1775.7270s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 1521.6578s
Epoch: 20 cost time: 22.970840215682983
Epoch: 20, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.268 Vali Acc: 0.974 Test Loss: 0.268 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1923s/iter; left time: 6336.1181s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0465s/iter; left time: 1526.9130s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0539s/iter; left time: 1765.1416s
	iters: 400, epoch: 21 | loss: 0.3605307
	speed: 0.0498s/iter; left time: 1625.6024s
Epoch: 21 cost time: 20.94887351989746
Epoch: 21, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.417 Vali Acc: 0.972 Test Loss: 0.417 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1915s/iter; left time: 6227.6588s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 1280.0939s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 1197.9212s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 1351.3016s
Epoch: 22 cost time: 17.534761905670166
Epoch: 22, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.248 Vali Acc: 0.983 Test Loss: 0.248 Test Acc: 0.983
Validation loss decreased (-0.979079 --> -0.982717).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000122
	speed: 0.1910s/iter; left time: 6132.9226s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1369.6868s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 1262.1975s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 1221.4459s
Epoch: 23 cost time: 17.060627937316895
Epoch: 23, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.294 Vali Acc: 0.976 Test Loss: 0.294 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1904s/iter; left time: 6037.6311s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0560s/iter; left time: 1768.7322s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 1345.5791s
	iters: 400, epoch: 24 | loss: 0.0002260
	speed: 0.0387s/iter; left time: 1215.6521s
Epoch: 24 cost time: 19.76863145828247
Epoch: 24, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.254 Vali Acc: 0.976 Test Loss: 0.254 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1858s/iter; left time: 5814.8659s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0409s/iter; left time: 1276.0666s
	iters: 300, epoch: 25 | loss: 0.0885143
	speed: 0.0426s/iter; left time: 1323.0092s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 1286.3501s
Epoch: 25 cost time: 17.526161909103394
Epoch: 25, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1818s/iter; left time: 5611.7803s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0340s/iter; left time: 1046.8459s
	iters: 300, epoch: 26 | loss: 0.0000050
	speed: 0.0339s/iter; left time: 1039.6648s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 1086.4675s
Epoch: 26 cost time: 15.062424182891846
Epoch: 26, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.397 Vali Acc: 0.966 Test Loss: 0.397 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1725s/iter; left time: 5255.4213s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 1020.9184s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 850.3256s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 1226.4843s
Epoch: 27 cost time: 14.905121326446533
Epoch: 27, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.224 Vali Acc: 0.976 Test Loss: 0.224 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000001
	speed: 0.1866s/iter; left time: 5606.1369s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 1369.3264s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 1081.8775s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0378s/iter; left time: 1125.7055s
Epoch: 28 cost time: 17.533262729644775
Epoch: 28, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.199 Vali Acc: 0.978 Test Loss: 0.199 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.1754921
	speed: 0.1895s/iter; left time: 5615.3496s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 1261.2832s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0387s/iter; left time: 1140.4681s
	iters: 400, epoch: 29 | loss: 0.0132624
	speed: 0.0382s/iter; left time: 1121.4601s
Epoch: 29 cost time: 17.71885347366333
Epoch: 29, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.250 Vali Acc: 0.980 Test Loss: 0.250 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.7224728
	speed: 0.1811s/iter; left time: 5291.5969s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0323s/iter; left time: 941.7476s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1328.5257s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 1511.3356s
Epoch: 30 cost time: 18.059154510498047
Epoch: 30, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.178 Vali Acc: 0.986 Test Loss: 0.178 Test Acc: 0.986
Validation loss decreased (-0.982717 --> -0.985901).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1983s/iter; left time: 5712.2029s
	iters: 200, epoch: 31 | loss: 0.0078200
	speed: 0.0369s/iter; left time: 1059.8728s
	iters: 300, epoch: 31 | loss: 0.0017939
	speed: 0.0429s/iter; left time: 1226.3739s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0455s/iter; left time: 1297.4163s
Epoch: 31 cost time: 17.51999521255493
Epoch: 31, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.228 Vali Acc: 0.982 Test Loss: 0.228 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1929s/iter; left time: 5477.6757s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0475s/iter; left time: 1343.0244s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 1074.7912s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 970.9672s
Epoch: 32 cost time: 18.0329372882843
Epoch: 32, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.259 Vali Acc: 0.977 Test Loss: 0.259 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1880s/iter; left time: 5261.7332s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 1153.0703s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 971.9550s
	iters: 400, epoch: 33 | loss: 0.8967229
	speed: 0.0390s/iter; left time: 1080.8224s
Epoch: 33 cost time: 16.906455755233765
Epoch: 33, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.175 Vali Acc: 0.985 Test Loss: 0.175 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1761s/iter; left time: 4855.9802s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 1040.5758s
	iters: 300, epoch: 34 | loss: 0.0006209
	speed: 0.0488s/iter; left time: 1334.9077s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 1439.3745s
Epoch: 34 cost time: 19.33786964416504
Epoch: 34, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.238 Vali Acc: 0.980 Test Loss: 0.238 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1795s/iter; left time: 4875.5971s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 1038.8024s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 922.3549s
	iters: 400, epoch: 35 | loss: 0.0001266
	speed: 0.0301s/iter; left time: 807.5353s
Epoch: 35 cost time: 14.932286739349365
Epoch: 35, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.292 Vali Acc: 0.979 Test Loss: 0.292 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0000001
	speed: 0.1728s/iter; left time: 4621.9092s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0322s/iter; left time: 857.0830s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0322s/iter; left time: 853.8365s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 928.7671s
Epoch: 36 cost time: 14.745897054672241
Epoch: 36, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.369 Vali Acc: 0.978 Test Loss: 0.369 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1640s/iter; left time: 4317.9109s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 913.7124s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 939.2017s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0420s/iter; left time: 1092.3107s
Epoch: 37 cost time: 15.881722688674927
Epoch: 37, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.187 Vali Acc: 0.982 Test Loss: 0.187 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.1673s/iter; left time: 4335.6787s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0295s/iter; left time: 762.7347s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 1001.3686s
	iters: 400, epoch: 38 | loss: 0.2745450
	speed: 0.0362s/iter; left time: 926.4626s
Epoch: 38 cost time: 14.77544641494751
Epoch: 38, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.242 Vali Acc: 0.980 Test Loss: 0.242 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.1789s/iter; left time: 4563.7220s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0311s/iter; left time: 790.4546s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0313s/iter; left time: 791.5923s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 890.0403s
Epoch: 39 cost time: 14.292022705078125
Epoch: 39, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.344 Vali Acc: 0.979 Test Loss: 0.344 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.1745s/iter; left time: 4378.6454s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 901.9280s
	iters: 300, epoch: 40 | loss: 0.0000846
	speed: 0.0331s/iter; left time: 825.1794s
	iters: 400, epoch: 40 | loss: 0.0000001
	speed: 0.0415s/iter; left time: 1029.5002s
Epoch: 40 cost time: 16.19095230102539
Epoch: 40, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.260 Vali Acc: 0.981 Test Loss: 0.260 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 134410
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1530328
	speed: 0.0803s/iter; left time: 3310.4462s
	iters: 200, epoch: 1 | loss: 0.0759321
	speed: 0.0359s/iter; left time: 1475.3772s
	iters: 300, epoch: 1 | loss: 0.1198029
	speed: 0.0351s/iter; left time: 1440.6583s
	iters: 400, epoch: 1 | loss: 0.4438761
	speed: 0.0350s/iter; left time: 1432.6944s
Epoch: 1 cost time: 19.338693141937256
Epoch: 1, Steps: 413 | Train Loss: 0.410 Vali Loss: 0.131 Vali Acc: 0.955 Test Loss: 0.131 Test Acc: 0.955
Validation loss decreased (inf --> -0.955433).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0027431
	speed: 0.2193s/iter; left time: 8943.4833s
	iters: 200, epoch: 2 | loss: 0.0080626
	speed: 0.0383s/iter; left time: 1558.3450s
	iters: 300, epoch: 2 | loss: 0.0219361
	speed: 0.0391s/iter; left time: 1586.4542s
	iters: 400, epoch: 2 | loss: 0.0394746
	speed: 0.0364s/iter; left time: 1474.6865s
Epoch: 2 cost time: 17.402087926864624
Epoch: 2, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.124 Vali Acc: 0.958 Test Loss: 0.124 Test Acc: 0.958
Validation loss decreased (-0.955433 --> -0.957707).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1330261
	speed: 0.2039s/iter; left time: 8230.4455s
	iters: 200, epoch: 3 | loss: 0.0013544
	speed: 0.0361s/iter; left time: 1453.6592s
	iters: 300, epoch: 3 | loss: 0.0071114
	speed: 0.0415s/iter; left time: 1667.0519s
	iters: 400, epoch: 3 | loss: 0.0089707
	speed: 0.0343s/iter; left time: 1373.6408s
Epoch: 3 cost time: 16.374962329864502
Epoch: 3, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.957707 --> -0.965438).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0332935
	speed: 0.1945s/iter; left time: 7773.1740s
	iters: 200, epoch: 4 | loss: 0.0000435
	speed: 0.0433s/iter; left time: 1725.5825s
	iters: 300, epoch: 4 | loss: 0.0385943
	speed: 0.0475s/iter; left time: 1890.3932s
	iters: 400, epoch: 4 | loss: 0.0017079
	speed: 0.0391s/iter; left time: 1550.2500s
Epoch: 4 cost time: 18.423531532287598
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
Validation loss decreased (-0.965438 --> -0.975442).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0835882
	speed: 0.1906s/iter; left time: 7537.3545s
	iters: 200, epoch: 5 | loss: 0.0001218
	speed: 0.0336s/iter; left time: 1327.1413s
	iters: 300, epoch: 5 | loss: 0.1545773
	speed: 0.0362s/iter; left time: 1424.2227s
	iters: 400, epoch: 5 | loss: 0.0908465
	speed: 0.0454s/iter; left time: 1780.8319s
Epoch: 5 cost time: 16.112109184265137
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.168 Vali Acc: 0.964 Test Loss: 0.168 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0005828
	speed: 0.2019s/iter; left time: 7901.8954s
	iters: 200, epoch: 6 | loss: 0.0000107
	speed: 0.0323s/iter; left time: 1262.4763s
	iters: 300, epoch: 6 | loss: 0.0015612
	speed: 0.0392s/iter; left time: 1527.0407s
	iters: 400, epoch: 6 | loss: 0.0059862
	speed: 0.0379s/iter; left time: 1472.3988s
Epoch: 6 cost time: 16.083903789520264
Epoch: 6, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.154 Vali Acc: 0.971 Test Loss: 0.154 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000071
	speed: 0.2176s/iter; left time: 8424.5289s
	iters: 200, epoch: 7 | loss: 0.0000010
	speed: 0.0307s/iter; left time: 1185.1804s
	iters: 300, epoch: 7 | loss: 0.1122126
	speed: 0.0330s/iter; left time: 1272.5001s
	iters: 400, epoch: 7 | loss: 0.0063977
	speed: 0.0359s/iter; left time: 1379.7203s
Epoch: 7 cost time: 15.493793487548828
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.161 Vali Acc: 0.971 Test Loss: 0.161 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0006224
	speed: 0.1939s/iter; left time: 7428.8153s
	iters: 200, epoch: 8 | loss: 0.0087966
	speed: 0.0336s/iter; left time: 1283.8928s
	iters: 300, epoch: 8 | loss: 0.2627369
	speed: 0.0390s/iter; left time: 1487.7800s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 1353.7839s
Epoch: 8 cost time: 16.051244020462036
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.287 Vali Acc: 0.965 Test Loss: 0.287 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1875s/iter; left time: 7105.4632s
	iters: 200, epoch: 9 | loss: 0.0000022
	speed: 0.0376s/iter; left time: 1420.2250s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0417s/iter; left time: 1573.2250s
	iters: 400, epoch: 9 | loss: 0.0000011
	speed: 0.0429s/iter; left time: 1612.8717s
Epoch: 9 cost time: 17.27019190788269
Epoch: 9, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.979 Test Loss: 0.131 Test Acc: 0.979
Validation loss decreased (-0.975442 --> -0.978625).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000743
	speed: 0.1958s/iter; left time: 7339.2551s
	iters: 200, epoch: 10 | loss: 0.0000003
	speed: 0.0343s/iter; left time: 1281.0335s
	iters: 300, epoch: 10 | loss: 0.0000007
	speed: 0.0379s/iter; left time: 1413.8039s
	iters: 400, epoch: 10 | loss: 0.4004285
	speed: 0.0483s/iter; left time: 1794.9509s
Epoch: 10 cost time: 17.254993200302124
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.301 Vali Acc: 0.969 Test Loss: 0.301 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.2224s/iter; left time: 8243.9633s
	iters: 200, epoch: 11 | loss: 0.1747909
	speed: 0.0376s/iter; left time: 1388.5286s
	iters: 300, epoch: 11 | loss: 0.2715943
	speed: 0.0391s/iter; left time: 1443.3096s
	iters: 400, epoch: 11 | loss: 0.0000061
	speed: 0.0380s/iter; left time: 1397.2097s
Epoch: 11 cost time: 16.78920602798462
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.257 Vali Acc: 0.967 Test Loss: 0.257 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.2290s/iter; left time: 8395.0192s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0391s/iter; left time: 1429.1183s
	iters: 300, epoch: 12 | loss: 0.0000074
	speed: 0.0382s/iter; left time: 1391.5728s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 1291.7762s
Epoch: 12 cost time: 17.215447425842285
Epoch: 12, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.149 Vali Acc: 0.980 Test Loss: 0.149 Test Acc: 0.980
Validation loss decreased (-0.978625 --> -0.979989).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000139
	speed: 0.2231s/iter; left time: 8087.1030s
	iters: 200, epoch: 13 | loss: 0.0002224
	speed: 0.0465s/iter; left time: 1680.9332s
	iters: 300, epoch: 13 | loss: 0.2953360
	speed: 0.0421s/iter; left time: 1519.1693s
	iters: 400, epoch: 13 | loss: 0.0000006
	speed: 0.0352s/iter; left time: 1264.9899s
Epoch: 13 cost time: 17.698925018310547
Epoch: 13, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.180 Vali Acc: 0.980 Test Loss: 0.180 Test Acc: 0.980
Validation loss decreased (-0.979989 --> -0.980444).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0009478
	speed: 0.1987s/iter; left time: 7121.2484s
	iters: 200, epoch: 14 | loss: 0.0032891
	speed: 0.0377s/iter; left time: 1348.1568s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0434s/iter; left time: 1544.9738s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 1331.4004s
Epoch: 14 cost time: 17.490476608276367
Epoch: 14, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.271 Vali Acc: 0.973 Test Loss: 0.271 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0071703
	speed: 0.2123s/iter; left time: 7518.5447s
	iters: 200, epoch: 15 | loss: 0.0000059
	speed: 0.0468s/iter; left time: 1651.7631s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0421s/iter; left time: 1483.6087s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 1587.3506s
Epoch: 15 cost time: 19.737833261489868
Epoch: 15, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.235 Vali Acc: 0.974 Test Loss: 0.235 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1815s/iter; left time: 6354.5259s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 1295.8267s
	iters: 300, epoch: 16 | loss: 0.0000043
	speed: 0.0410s/iter; left time: 1428.5150s
	iters: 400, epoch: 16 | loss: 0.0000264
	speed: 0.0374s/iter; left time: 1298.2340s
Epoch: 16 cost time: 16.48025870323181
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.238 Vali Acc: 0.970 Test Loss: 0.238 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1949s/iter; left time: 6742.4130s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 1204.8492s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 1131.6942s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 1201.7849s
Epoch: 17 cost time: 14.90284538269043
Epoch: 17, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.277 Vali Acc: 0.971 Test Loss: 0.277 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1783s/iter; left time: 6092.9821s
	iters: 200, epoch: 18 | loss: 0.0000113
	speed: 0.0326s/iter; left time: 1112.4043s
	iters: 300, epoch: 18 | loss: 0.0000315
	speed: 0.0359s/iter; left time: 1219.4155s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 1244.1077s
Epoch: 18 cost time: 15.623766422271729
Epoch: 18, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.275 Vali Acc: 0.972 Test Loss: 0.275 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000004
	speed: 0.1894s/iter; left time: 6394.3748s
	iters: 200, epoch: 19 | loss: 0.0004096
	speed: 0.0458s/iter; left time: 1540.7543s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 1470.4870s
	iters: 400, epoch: 19 | loss: 0.0000080
	speed: 0.0411s/iter; left time: 1373.8320s
Epoch: 19 cost time: 18.710383892059326
Epoch: 19, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.200 Vali Acc: 0.979 Test Loss: 0.200 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1819s/iter; left time: 6068.5538s
	iters: 200, epoch: 20 | loss: 0.0081063
	speed: 0.0399s/iter; left time: 1326.4610s
	iters: 300, epoch: 20 | loss: 0.0176493
	speed: 0.0377s/iter; left time: 1248.2906s
	iters: 400, epoch: 20 | loss: 0.0724296
	speed: 0.0432s/iter; left time: 1428.6133s
Epoch: 20 cost time: 17.028019905090332
Epoch: 20, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.287 Vali Acc: 0.972 Test Loss: 0.287 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0004827
	speed: 0.1840s/iter; left time: 6060.7481s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0345s/iter; left time: 1134.2434s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 1168.0650s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 1142.6285s
Epoch: 21 cost time: 15.301705598831177
Epoch: 21, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.294 Vali Acc: 0.974 Test Loss: 0.294 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2227s/iter; left time: 7242.6570s
	iters: 200, epoch: 22 | loss: 0.0000349
	speed: 0.0365s/iter; left time: 1183.0660s
	iters: 300, epoch: 22 | loss: 0.0000003
	speed: 0.0381s/iter; left time: 1232.2353s
	iters: 400, epoch: 22 | loss: 0.0000005
	speed: 0.0406s/iter; left time: 1307.8225s
Epoch: 22 cost time: 16.972641468048096
Epoch: 22, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.258 Vali Acc: 0.980 Test Loss: 0.258 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000012
	speed: 0.2184s/iter; left time: 7013.7107s
	iters: 200, epoch: 23 | loss: 0.0003364
	speed: 0.0436s/iter; left time: 1395.5860s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0340s/iter; left time: 1085.4712s
	iters: 400, epoch: 23 | loss: 0.0003539
	speed: 0.0346s/iter; left time: 1099.7670s
Epoch: 23 cost time: 16.63228178024292
Epoch: 23, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 101450
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2099120
	speed: 0.0794s/iter; left time: 3270.9509s
	iters: 200, epoch: 1 | loss: 0.0645571
	speed: 0.0467s/iter; left time: 1917.6439s
	iters: 300, epoch: 1 | loss: 0.1338247
	speed: 0.0413s/iter; left time: 1695.1691s
	iters: 400, epoch: 1 | loss: 0.0975233
	speed: 0.0424s/iter; left time: 1732.6523s
Epoch: 1 cost time: 21.61374068260193
Epoch: 1, Steps: 413 | Train Loss: 0.441 Vali Loss: 0.120 Vali Acc: 0.958 Test Loss: 0.120 Test Acc: 0.958
Validation loss decreased (inf --> -0.958162).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0106749
	speed: 0.2082s/iter; left time: 8491.9524s
	iters: 200, epoch: 2 | loss: 0.0332809
	speed: 0.0436s/iter; left time: 1774.2798s
	iters: 300, epoch: 2 | loss: 0.0662232
	speed: 0.0418s/iter; left time: 1696.0217s
	iters: 400, epoch: 2 | loss: 0.0497181
	speed: 0.0375s/iter; left time: 1517.3830s
Epoch: 2 cost time: 17.825145483016968
Epoch: 2, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
Validation loss decreased (-0.958162 --> -0.961800).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0008869
	speed: 0.2048s/iter; left time: 8268.2835s
	iters: 200, epoch: 3 | loss: 0.0413663
	speed: 0.0392s/iter; left time: 1578.1000s
	iters: 300, epoch: 3 | loss: 0.0003885
	speed: 0.0339s/iter; left time: 1361.3567s
	iters: 400, epoch: 3 | loss: 0.0967451
	speed: 0.0372s/iter; left time: 1489.7487s
Epoch: 3 cost time: 16.128483533859253
Epoch: 3, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0014367
	speed: 0.2088s/iter; left time: 8345.4756s
	iters: 200, epoch: 4 | loss: 0.0027627
	speed: 0.0329s/iter; left time: 1312.4832s
	iters: 300, epoch: 4 | loss: 0.0712168
	speed: 0.0315s/iter; left time: 1251.7739s
	iters: 400, epoch: 4 | loss: 0.0163956
	speed: 0.0321s/iter; left time: 1273.8867s
Epoch: 4 cost time: 14.949770450592041
Epoch: 4, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.961800 --> -0.969530).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1311345
	speed: 0.1888s/iter; left time: 7468.5839s
	iters: 200, epoch: 5 | loss: 0.0166799
	speed: 0.0356s/iter; left time: 1402.4528s
	iters: 300, epoch: 5 | loss: 0.0002891
	speed: 0.0361s/iter; left time: 1418.8662s
	iters: 400, epoch: 5 | loss: 0.0065768
	speed: 0.0343s/iter; left time: 1346.2330s
Epoch: 5 cost time: 15.67416000366211
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000387
	speed: 0.1876s/iter; left time: 7343.3213s
	iters: 200, epoch: 6 | loss: 0.0005064
	speed: 0.0404s/iter; left time: 1575.4851s
	iters: 300, epoch: 6 | loss: 0.3572468
	speed: 0.0442s/iter; left time: 1722.0681s
	iters: 400, epoch: 6 | loss: 0.0000012
	speed: 0.0414s/iter; left time: 1607.4489s
Epoch: 6 cost time: 17.738052129745483
Epoch: 6, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0007954
	speed: 0.1968s/iter; left time: 7621.0410s
	iters: 200, epoch: 7 | loss: 0.0000366
	speed: 0.0367s/iter; left time: 1417.1120s
	iters: 300, epoch: 7 | loss: 0.1838325
	speed: 0.0331s/iter; left time: 1276.9674s
	iters: 400, epoch: 7 | loss: 0.0020359
	speed: 0.0464s/iter; left time: 1781.4932s
Epoch: 7 cost time: 17.013885021209717
Epoch: 7, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0034286
	speed: 0.2142s/iter; left time: 8207.5956s
	iters: 200, epoch: 8 | loss: 0.0001284
	speed: 0.0354s/iter; left time: 1353.2815s
	iters: 300, epoch: 8 | loss: 0.0008766
	speed: 0.0403s/iter; left time: 1534.5998s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 1359.0074s
Epoch: 8 cost time: 16.14325451850891
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000643
	speed: 0.2183s/iter; left time: 8274.7246s
	iters: 200, epoch: 9 | loss: 0.0000256
	speed: 0.0461s/iter; left time: 1741.2789s
	iters: 300, epoch: 9 | loss: 0.0001108
	speed: 0.0391s/iter; left time: 1472.6295s
	iters: 400, epoch: 9 | loss: 0.0000252
	speed: 0.0299s/iter; left time: 1125.4341s
Epoch: 9 cost time: 17.364917516708374
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
Validation loss decreased (-0.969530 --> -0.973623).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0173655
	speed: 0.1920s/iter; left time: 7196.7156s
	iters: 200, epoch: 10 | loss: 0.0059034
	speed: 0.0399s/iter; left time: 1490.3002s
	iters: 300, epoch: 10 | loss: 0.0000830
	speed: 0.0444s/iter; left time: 1655.8641s
	iters: 400, epoch: 10 | loss: 0.0017564
	speed: 0.0468s/iter; left time: 1741.5871s
Epoch: 10 cost time: 18.20668911933899
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
Validation loss decreased (-0.973623 --> -0.977716).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2178819
	speed: 0.1874s/iter; left time: 6946.2328s
	iters: 200, epoch: 11 | loss: 0.3386094
	speed: 0.0338s/iter; left time: 1248.7677s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0429s/iter; left time: 1580.1869s
	iters: 400, epoch: 11 | loss: 0.0000105
	speed: 0.0452s/iter; left time: 1663.0243s
Epoch: 11 cost time: 17.1968514919281
Epoch: 11, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000029
	speed: 0.1890s/iter; left time: 6929.8093s
	iters: 200, epoch: 12 | loss: 0.0366356
	speed: 0.0322s/iter; left time: 1177.2152s
	iters: 300, epoch: 12 | loss: 0.0658867
	speed: 0.0342s/iter; left time: 1248.0167s
	iters: 400, epoch: 12 | loss: 0.0003584
	speed: 0.0316s/iter; left time: 1149.8259s
Epoch: 12 cost time: 14.172910928726196
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.208 Vali Acc: 0.972 Test Loss: 0.208 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0008505
	speed: 0.2074s/iter; left time: 7516.6380s
	iters: 200, epoch: 13 | loss: 0.0797779
	speed: 0.0344s/iter; left time: 1244.2387s
	iters: 300, epoch: 13 | loss: 0.0008795
	speed: 0.0362s/iter; left time: 1305.1986s
	iters: 400, epoch: 13 | loss: 0.0000014
	speed: 0.0429s/iter; left time: 1543.3425s
Epoch: 13 cost time: 17.38138222694397
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.251 Vali Acc: 0.967 Test Loss: 0.251 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000003
	speed: 0.1971s/iter; left time: 7062.6853s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0435s/iter; left time: 1554.7498s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 1434.5830s
	iters: 400, epoch: 14 | loss: 0.0000015
	speed: 0.0327s/iter; left time: 1160.9860s
Epoch: 14 cost time: 16.465035438537598
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.287 Vali Acc: 0.965 Test Loss: 0.287 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000002
	speed: 0.1912s/iter; left time: 6770.6128s
	iters: 200, epoch: 15 | loss: 0.0000804
	speed: 0.0422s/iter; left time: 1492.1534s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 1424.7509s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 1120.3641s
Epoch: 15 cost time: 16.956692934036255
Epoch: 15, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.244 Vali Acc: 0.965 Test Loss: 0.244 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1875s/iter; left time: 6563.6896s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 1157.7817s
	iters: 300, epoch: 16 | loss: 0.0000002
	speed: 0.0387s/iter; left time: 1346.7425s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 1233.9750s
Epoch: 16 cost time: 15.008837699890137
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0009781
	speed: 0.2067s/iter; left time: 7150.3032s
	iters: 200, epoch: 17 | loss: 0.0000002
	speed: 0.0322s/iter; left time: 1110.5427s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0360s/iter; left time: 1238.0554s
	iters: 400, epoch: 17 | loss: 0.0000048
	speed: 0.0315s/iter; left time: 1081.0985s
Epoch: 17 cost time: 15.351634740829468
Epoch: 17, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.122 Vali Acc: 0.982 Test Loss: 0.122 Test Acc: 0.982
Validation loss decreased (-0.977716 --> -0.981809).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.2169s/iter; left time: 7414.0151s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0424s/iter; left time: 1446.6118s
	iters: 300, epoch: 18 | loss: 0.0250749
	speed: 0.0357s/iter; left time: 1211.5973s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0386s/iter; left time: 1307.8282s
Epoch: 18 cost time: 17.70313048362732
Epoch: 18, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 0.978 Test Loss: 0.180 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0132653
	speed: 0.1985s/iter; left time: 6701.3272s
	iters: 200, epoch: 19 | loss: 0.0000006
	speed: 0.0439s/iter; left time: 1476.9654s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 1404.2397s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 1345.7878s
Epoch: 19 cost time: 18.80231738090515
Epoch: 19, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.974 Test Loss: 0.187 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2024s/iter; left time: 6752.0699s
	iters: 200, epoch: 20 | loss: 0.0020448
	speed: 0.0409s/iter; left time: 1360.0522s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 1349.8779s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1512.6775s
Epoch: 20 cost time: 18.743277311325073
Epoch: 20, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.272 Vali Acc: 0.969 Test Loss: 0.272 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1989s/iter; left time: 6551.4143s
	iters: 200, epoch: 21 | loss: 0.0377952
	speed: 0.0421s/iter; left time: 1383.6925s
	iters: 300, epoch: 21 | loss: 0.0000073
	speed: 0.0376s/iter; left time: 1232.2174s
	iters: 400, epoch: 21 | loss: 0.0011972
	speed: 0.0337s/iter; left time: 1098.9973s
Epoch: 21 cost time: 17.0226571559906
Epoch: 21, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.176 Vali Acc: 0.979 Test Loss: 0.176 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2085s/iter; left time: 6781.6078s
	iters: 200, epoch: 22 | loss: 0.0001206
	speed: 0.0422s/iter; left time: 1367.8331s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 1230.0619s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0378s/iter; left time: 1217.0579s
Epoch: 22 cost time: 17.43597435951233
Epoch: 22, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.182 Vali Acc: 0.981 Test Loss: 0.182 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0100012
	speed: 0.1944s/iter; left time: 6241.7677s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 1125.0604s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 1333.5451s
	iters: 400, epoch: 23 | loss: 0.0000005
	speed: 0.0424s/iter; left time: 1348.7972s
Epoch: 23 cost time: 17.1366868019104
Epoch: 23, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.292 Vali Acc: 0.975 Test Loss: 0.292 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.4306754
	speed: 0.1916s/iter; left time: 6075.2872s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 1227.9780s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 1208.3243s
	iters: 400, epoch: 24 | loss: 0.0025389
	speed: 0.0368s/iter; left time: 1156.5874s
Epoch: 24 cost time: 17.074977159500122
Epoch: 24, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.232 Vali Acc: 0.976 Test Loss: 0.232 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.1896s/iter; left time: 5933.1379s
	iters: 200, epoch: 25 | loss: 0.0029451
	speed: 0.0417s/iter; left time: 1301.2051s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 1227.0369s
	iters: 400, epoch: 25 | loss: 0.0005846
	speed: 0.0438s/iter; left time: 1355.8174s
Epoch: 25 cost time: 17.923651933670044
Epoch: 25, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.331 Vali Acc: 0.971 Test Loss: 0.331 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0002978
	speed: 0.2071s/iter; left time: 6393.7066s
	iters: 200, epoch: 26 | loss: 0.0015850
	speed: 0.0395s/iter; left time: 1214.3012s
	iters: 300, epoch: 26 | loss: 0.0000112
	speed: 0.0397s/iter; left time: 1218.6236s
	iters: 400, epoch: 26 | loss: 0.0533133
	speed: 0.0423s/iter; left time: 1294.6716s
Epoch: 26 cost time: 17.815755128860474
Epoch: 26, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.211 Vali Acc: 0.977 Test Loss: 0.211 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000002
	speed: 0.2046s/iter; left time: 6234.0264s
	iters: 200, epoch: 27 | loss: 0.0011454
	speed: 0.0446s/iter; left time: 1354.8316s
	iters: 300, epoch: 27 | loss: 0.0000057
	speed: 0.0393s/iter; left time: 1190.4725s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 1116.5643s
Epoch: 27 cost time: 17.47766876220703
Epoch: 27, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.279 Vali Acc: 0.973 Test Loss: 0.279 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm64_nh16_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 85130
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3578104
	speed: 0.0689s/iter; left time: 2839.9254s
	iters: 200, epoch: 1 | loss: 0.2517393
	speed: 0.0385s/iter; left time: 1582.9072s
	iters: 300, epoch: 1 | loss: 0.0809611
	speed: 0.0381s/iter; left time: 1560.4274s
	iters: 400, epoch: 1 | loss: 0.6956447
	speed: 0.0402s/iter; left time: 1645.1250s
Epoch: 1 cost time: 19.210025310516357
Epoch: 1, Steps: 413 | Train Loss: 0.387 Vali Loss: 0.238 Vali Acc: 0.945 Test Loss: 0.238 Test Acc: 0.945
Validation loss decreased (inf --> -0.944973).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3378469
	speed: 0.1802s/iter; left time: 7350.9976s
	iters: 200, epoch: 2 | loss: 0.0324675
	speed: 0.0483s/iter; left time: 1966.5967s
	iters: 300, epoch: 2 | loss: 0.0309012
	speed: 0.0427s/iter; left time: 1732.7344s
	iters: 400, epoch: 2 | loss: 0.1575068
	speed: 0.0413s/iter; left time: 1674.1483s
Epoch: 2 cost time: 18.650463819503784
Epoch: 2, Steps: 413 | Train Loss: 0.154 Vali Loss: 0.212 Vali Acc: 0.960 Test Loss: 0.212 Test Acc: 0.960
Validation loss decreased (-0.944973 --> -0.959980).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000675
	speed: 0.1847s/iter; left time: 7457.3259s
	iters: 200, epoch: 3 | loss: 0.0064057
	speed: 0.0327s/iter; left time: 1317.3959s
	iters: 300, epoch: 3 | loss: 0.0000058
	speed: 0.0406s/iter; left time: 1629.6739s
	iters: 400, epoch: 3 | loss: 0.0000005
	speed: 0.0438s/iter; left time: 1753.9393s
Epoch: 3 cost time: 16.778903007507324
Epoch: 3, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.281 Vali Acc: 0.954 Test Loss: 0.281 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0001168
	speed: 0.1825s/iter; left time: 7292.6112s
	iters: 200, epoch: 4 | loss: 0.1034666
	speed: 0.0440s/iter; left time: 1755.7338s
	iters: 300, epoch: 4 | loss: 0.0000063
	speed: 0.0411s/iter; left time: 1632.8390s
	iters: 400, epoch: 4 | loss: 0.0000310
	speed: 0.0402s/iter; left time: 1596.0382s
Epoch: 4 cost time: 17.53196358680725
Epoch: 4, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.303 Vali Acc: 0.952 Test Loss: 0.303 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000417
	speed: 0.1775s/iter; left time: 7020.9742s
	iters: 200, epoch: 5 | loss: 0.0553902
	speed: 0.0412s/iter; left time: 1627.1211s
	iters: 300, epoch: 5 | loss: 0.0000001
	speed: 0.0473s/iter; left time: 1861.2344s
	iters: 400, epoch: 5 | loss: 0.1267326
	speed: 0.0426s/iter; left time: 1673.4270s
Epoch: 5 cost time: 17.968915939331055
Epoch: 5, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.325 Vali Acc: 0.963 Test Loss: 0.325 Test Acc: 0.963
Validation loss decreased (-0.959980 --> -0.962707).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2897578
	speed: 0.1790s/iter; left time: 7004.7025s
	iters: 200, epoch: 6 | loss: 0.0019934
	speed: 0.0351s/iter; left time: 1371.9875s
	iters: 300, epoch: 6 | loss: 0.0000115
	speed: 0.0337s/iter; left time: 1312.7577s
	iters: 400, epoch: 6 | loss: 0.0000044
	speed: 0.0385s/iter; left time: 1493.7880s
Epoch: 6 cost time: 15.374475717544556
Epoch: 6, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.290 Vali Acc: 0.963 Test Loss: 0.290 Test Acc: 0.963
Validation loss decreased (-0.962707 --> -0.962707).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1826s/iter; left time: 7070.7966s
	iters: 200, epoch: 7 | loss: 0.0039139
	speed: 0.0382s/iter; left time: 1476.5501s
	iters: 300, epoch: 7 | loss: 0.0001023
	speed: 0.0324s/iter; left time: 1247.9281s
	iters: 400, epoch: 7 | loss: 0.0066687
	speed: 0.0313s/iter; left time: 1204.2028s
Epoch: 7 cost time: 15.139108896255493
Epoch: 7, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.444 Vali Acc: 0.957 Test Loss: 0.444 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0088079
	speed: 0.1826s/iter; left time: 6995.5701s
	iters: 200, epoch: 8 | loss: 0.0000001
	speed: 0.0342s/iter; left time: 1308.1083s
	iters: 300, epoch: 8 | loss: 0.0000006
	speed: 0.0363s/iter; left time: 1385.2583s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0315s/iter; left time: 1196.7465s
Epoch: 8 cost time: 15.583885669708252
Epoch: 8, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.436 Vali Acc: 0.962 Test Loss: 0.436 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0442471
	speed: 0.1729s/iter; left time: 6552.4718s
	iters: 200, epoch: 9 | loss: 0.0000021
	speed: 0.0374s/iter; left time: 1413.6907s
	iters: 300, epoch: 9 | loss: 0.0000003
	speed: 0.0403s/iter; left time: 1520.3479s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0360s/iter; left time: 1353.2179s
Epoch: 9 cost time: 16.031619548797607
Epoch: 9, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.425 Vali Acc: 0.962 Test Loss: 0.425 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0004957
	speed: 0.1859s/iter; left time: 6968.8323s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.0333s/iter; left time: 1244.5108s
	iters: 300, epoch: 10 | loss: 0.0409754
	speed: 0.0338s/iter; left time: 1260.7322s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 1271.2216s
Epoch: 10 cost time: 14.91149640083313
Epoch: 10, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.338 Vali Acc: 0.974 Test Loss: 0.338 Test Acc: 0.974
Validation loss decreased (-0.962707 --> -0.974076).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000021
	speed: 0.1982s/iter; left time: 7347.4838s
	iters: 200, epoch: 11 | loss: 0.0000007
	speed: 0.0391s/iter; left time: 1444.3289s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1442.4495s
	iters: 400, epoch: 11 | loss: 0.0000149
	speed: 0.0379s/iter; left time: 1393.2404s
Epoch: 11 cost time: 17.65630006790161
Epoch: 11, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.372 Vali Acc: 0.969 Test Loss: 0.372 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1892s/iter; left time: 6936.7434s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 1508.4821s
	iters: 300, epoch: 12 | loss: 0.0697388
	speed: 0.0463s/iter; left time: 1689.1636s
	iters: 400, epoch: 12 | loss: 0.0000010
	speed: 0.0468s/iter; left time: 1702.0614s
Epoch: 12 cost time: 19.323533296585083
Epoch: 12, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.303 Vali Acc: 0.973 Test Loss: 0.303 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1856s/iter; left time: 6725.3714s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 1471.6369s
	iters: 300, epoch: 13 | loss: 0.0000003
	speed: 0.0392s/iter; left time: 1414.7490s
	iters: 400, epoch: 13 | loss: 0.2660122
	speed: 0.0365s/iter; left time: 1313.4336s
Epoch: 13 cost time: 16.56593632698059
Epoch: 13, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.511 Vali Acc: 0.966 Test Loss: 0.511 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000010
	speed: 0.1894s/iter; left time: 6788.2251s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0330s/iter; left time: 1180.7230s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0340s/iter; left time: 1210.9086s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 1102.6500s
Epoch: 14 cost time: 15.025000095367432
Epoch: 14, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.341 Vali Acc: 0.967 Test Loss: 0.341 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1808s/iter; left time: 6403.1223s
	iters: 200, epoch: 15 | loss: 0.0000015
	speed: 0.0318s/iter; left time: 1124.2152s
	iters: 300, epoch: 15 | loss: 0.0000004
	speed: 0.0349s/iter; left time: 1228.9480s
	iters: 400, epoch: 15 | loss: 0.1561329
	speed: 0.0340s/iter; left time: 1195.1941s
Epoch: 15 cost time: 15.232218027114868
Epoch: 15, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.614 Vali Acc: 0.957 Test Loss: 0.614 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0004488
	speed: 0.1700s/iter; left time: 5951.0484s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 1282.2609s
	iters: 300, epoch: 16 | loss: 0.0000017
	speed: 0.0383s/iter; left time: 1332.7943s
	iters: 400, epoch: 16 | loss: 0.0000002
	speed: 0.0426s/iter; left time: 1477.2437s
Epoch: 16 cost time: 16.234307050704956
Epoch: 16, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.563 Vali Acc: 0.960 Test Loss: 0.563 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0902337
	speed: 0.1753s/iter; left time: 6064.0734s
	iters: 200, epoch: 17 | loss: 0.0033443
	speed: 0.0399s/iter; left time: 1374.9655s
	iters: 300, epoch: 17 | loss: 0.0000097
	speed: 0.0382s/iter; left time: 1314.4203s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 1343.7619s
Epoch: 17 cost time: 17.0320782661438
Epoch: 17, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.511 Vali Acc: 0.965 Test Loss: 0.511 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1914s/iter; left time: 6542.4290s
	iters: 200, epoch: 18 | loss: 0.0000049
	speed: 0.0323s/iter; left time: 1100.8205s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 1228.9993s
	iters: 400, epoch: 18 | loss: 0.0000002
	speed: 0.0375s/iter; left time: 1269.2217s
Epoch: 18 cost time: 15.3646981716156
Epoch: 18, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.650 Vali Acc: 0.963 Test Loss: 0.650 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1982s/iter; left time: 6693.4674s
	iters: 200, epoch: 19 | loss: 0.0002024
	speed: 0.0388s/iter; left time: 1304.9446s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 1272.1722s
	iters: 400, epoch: 19 | loss: 0.0008463
	speed: 0.0399s/iter; left time: 1336.6994s
Epoch: 19 cost time: 17.18635129928589
Epoch: 19, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.538 Vali Acc: 0.966 Test Loss: 0.538 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.4380896
	speed: 0.2014s/iter; left time: 6716.5720s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 1106.6878s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 924.4441s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 1136.8886s
Epoch: 20 cost time: 14.972450971603394
Epoch: 20, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.518 Vali Acc: 0.969 Test Loss: 0.518 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9740791268758526
model parameter : 216714
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1807702
	speed: 0.0764s/iter; left time: 3146.7874s
	iters: 200, epoch: 1 | loss: 0.5381551
	speed: 0.0445s/iter; left time: 1828.3612s
	iters: 300, epoch: 1 | loss: 0.0788327
	speed: 0.0411s/iter; left time: 1685.9351s
	iters: 400, epoch: 1 | loss: 0.1886547
	speed: 0.0471s/iter; left time: 1924.8240s
Epoch: 1 cost time: 21.613774061203003
Epoch: 1, Steps: 413 | Train Loss: 0.370 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (inf --> -0.943609).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0022079
	speed: 0.2136s/iter; left time: 8712.3528s
	iters: 200, epoch: 2 | loss: 0.0291435
	speed: 0.0511s/iter; left time: 2079.4592s
	iters: 300, epoch: 2 | loss: 0.0330460
	speed: 0.0465s/iter; left time: 1887.8518s
	iters: 400, epoch: 2 | loss: 0.2980987
	speed: 0.0389s/iter; left time: 1576.3317s
Epoch: 2 cost time: 19.7937490940094
Epoch: 2, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.162 Vali Acc: 0.966 Test Loss: 0.162 Test Acc: 0.966
Validation loss decreased (-0.943609 --> -0.965892).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2441711
	speed: 0.1994s/iter; left time: 8051.8991s
	iters: 200, epoch: 3 | loss: 0.0001949
	speed: 0.0404s/iter; left time: 1627.9388s
	iters: 300, epoch: 3 | loss: 0.0001406
	speed: 0.0396s/iter; left time: 1591.2687s
	iters: 400, epoch: 3 | loss: 0.0008523
	speed: 0.0527s/iter; left time: 2113.5418s
Epoch: 3 cost time: 19.574925899505615
Epoch: 3, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.256 Vali Acc: 0.952 Test Loss: 0.256 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000003
	speed: 0.1975s/iter; left time: 7892.1023s
	iters: 200, epoch: 4 | loss: 0.0005544
	speed: 0.0431s/iter; left time: 1717.3250s
	iters: 300, epoch: 4 | loss: 0.0000388
	speed: 0.0406s/iter; left time: 1615.6936s
	iters: 400, epoch: 4 | loss: 0.0000104
	speed: 0.0465s/iter; left time: 1845.1533s
Epoch: 4 cost time: 18.69202971458435
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.278 Vali Acc: 0.955 Test Loss: 0.278 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000056
	speed: 0.2038s/iter; left time: 8058.8971s
	iters: 200, epoch: 5 | loss: 0.4243924
	speed: 0.0417s/iter; left time: 1643.3551s
	iters: 300, epoch: 5 | loss: 0.0311352
	speed: 0.0418s/iter; left time: 1645.9756s
	iters: 400, epoch: 5 | loss: 0.0338134
	speed: 0.0399s/iter; left time: 1567.6571s
Epoch: 5 cost time: 18.141714334487915
Epoch: 5, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.297 Vali Acc: 0.961 Test Loss: 0.297 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0005032
	speed: 0.2093s/iter; left time: 8189.2516s
	iters: 200, epoch: 6 | loss: 0.0000007
	speed: 0.0397s/iter; left time: 1548.2914s
	iters: 300, epoch: 6 | loss: 0.0027527
	speed: 0.0353s/iter; left time: 1373.9298s
	iters: 400, epoch: 6 | loss: 0.0400373
	speed: 0.0332s/iter; left time: 1289.1983s
Epoch: 6 cost time: 16.50724482536316
Epoch: 6, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.278 Vali Acc: 0.960 Test Loss: 0.278 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000030
	speed: 0.1873s/iter; left time: 7251.4728s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.0357s/iter; left time: 1376.9501s
	iters: 300, epoch: 7 | loss: 0.0000715
	speed: 0.0428s/iter; left time: 1647.1551s
	iters: 400, epoch: 7 | loss: 0.0000076
	speed: 0.0407s/iter; left time: 1562.5125s
Epoch: 7 cost time: 17.7568039894104
Epoch: 7, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.303 Vali Acc: 0.963 Test Loss: 0.303 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0001760
	speed: 0.1938s/iter; left time: 7425.4115s
	iters: 200, epoch: 8 | loss: 0.2055398
	speed: 0.0367s/iter; left time: 1400.5976s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 1359.0632s
	iters: 400, epoch: 8 | loss: 0.4773834
	speed: 0.0395s/iter; left time: 1502.3300s
Epoch: 8 cost time: 16.334522247314453
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.334 Vali Acc: 0.962 Test Loss: 0.334 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000018
	speed: 0.1752s/iter; left time: 6637.8638s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0415s/iter; left time: 1567.1642s
	iters: 300, epoch: 9 | loss: 0.0000016
	speed: 0.0442s/iter; left time: 1667.1715s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 1388.5477s
Epoch: 9 cost time: 16.831549167633057
Epoch: 9, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.264 Vali Acc: 0.964 Test Loss: 0.264 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.3029477
	speed: 0.2098s/iter; left time: 7863.7192s
	iters: 200, epoch: 10 | loss: 0.0000122
	speed: 0.0425s/iter; left time: 1587.6027s
	iters: 300, epoch: 10 | loss: 0.0002287
	speed: 0.0378s/iter; left time: 1409.0106s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 1258.0697s
Epoch: 10 cost time: 17.942909479141235
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.381 Vali Acc: 0.963 Test Loss: 0.381 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000072
	speed: 0.1931s/iter; left time: 7159.0125s
	iters: 200, epoch: 11 | loss: 0.6516178
	speed: 0.0331s/iter; left time: 1223.3585s
	iters: 300, epoch: 11 | loss: 0.0000008
	speed: 0.0348s/iter; left time: 1282.6892s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 1283.6488s
Epoch: 11 cost time: 15.479953527450562
Epoch: 11, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.457 Vali Acc: 0.958 Test Loss: 0.457 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1863s/iter; left time: 6829.2601s
	iters: 200, epoch: 12 | loss: 0.0000007
	speed: 0.0368s/iter; left time: 1346.8168s
	iters: 300, epoch: 12 | loss: 0.0354200
	speed: 0.0436s/iter; left time: 1589.7800s
	iters: 400, epoch: 12 | loss: 0.0050557
	speed: 0.0432s/iter; left time: 1569.3097s
Epoch: 12 cost time: 17.529442310333252
Epoch: 12, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.403 Vali Acc: 0.963 Test Loss: 0.403 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.965893587994543
model parameter : 150218
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2816616
	speed: 0.0758s/iter; left time: 3125.0227s
	iters: 200, epoch: 1 | loss: 0.1291080
	speed: 0.0461s/iter; left time: 1893.8341s
	iters: 300, epoch: 1 | loss: 0.0352242
	speed: 0.0476s/iter; left time: 1952.7006s
	iters: 400, epoch: 1 | loss: 0.0577831
	speed: 0.0420s/iter; left time: 1716.7015s
Epoch: 1 cost time: 21.756526231765747
Epoch: 1, Steps: 413 | Train Loss: 0.390 Vali Loss: 0.132 Vali Acc: 0.956 Test Loss: 0.132 Test Acc: 0.956
Validation loss decreased (inf --> -0.955888).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5609781
	speed: 0.1898s/iter; left time: 7739.5348s
	iters: 200, epoch: 2 | loss: 0.1798604
	speed: 0.0379s/iter; left time: 1544.0218s
	iters: 300, epoch: 2 | loss: 0.0258651
	speed: 0.0577s/iter; left time: 2341.9956s
	iters: 400, epoch: 2 | loss: 0.0031478
	speed: 0.0578s/iter; left time: 2338.9189s
Epoch: 2 cost time: 20.478114128112793
Epoch: 2, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.955888 --> -0.964528).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0005225
	speed: 0.1992s/iter; left time: 8041.1076s
	iters: 200, epoch: 3 | loss: 0.0948792
	speed: 0.0435s/iter; left time: 1750.3961s
	iters: 300, epoch: 3 | loss: 0.0055398
	speed: 0.0444s/iter; left time: 1782.4292s
	iters: 400, epoch: 3 | loss: 0.0032647
	speed: 0.0303s/iter; left time: 1213.5938s
Epoch: 3 cost time: 17.75324010848999
Epoch: 3, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000120
	speed: 0.1847s/iter; left time: 7380.6165s
	iters: 200, epoch: 4 | loss: 0.0050462
	speed: 0.0378s/iter; left time: 1505.4508s
	iters: 300, epoch: 4 | loss: 0.0005780
	speed: 0.0396s/iter; left time: 1573.3043s
	iters: 400, epoch: 4 | loss: 0.0000486
	speed: 0.0397s/iter; left time: 1575.7421s
Epoch: 4 cost time: 16.480759859085083
Epoch: 4, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.964528 --> -0.967711).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0001608
	speed: 0.1843s/iter; left time: 7290.0050s
	iters: 200, epoch: 5 | loss: 0.0016460
	speed: 0.0337s/iter; left time: 1330.5154s
	iters: 300, epoch: 5 | loss: 0.0040981
	speed: 0.0368s/iter; left time: 1447.8870s
	iters: 400, epoch: 5 | loss: 0.0000333
	speed: 0.0350s/iter; left time: 1374.8010s
Epoch: 5 cost time: 15.227858304977417
Epoch: 5, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.166 Vali Acc: 0.971 Test Loss: 0.166 Test Acc: 0.971
Validation loss decreased (-0.967711 --> -0.971349).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0011207
	speed: 0.1875s/iter; left time: 7337.2138s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0302s/iter; left time: 1178.6908s
	iters: 300, epoch: 6 | loss: 0.0124291
	speed: 0.0386s/iter; left time: 1502.4879s
	iters: 400, epoch: 6 | loss: 0.0003162
	speed: 0.0348s/iter; left time: 1349.9700s
Epoch: 6 cost time: 14.869674444198608
Epoch: 6, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.220 Vali Acc: 0.964 Test Loss: 0.220 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000001
	speed: 0.1876s/iter; left time: 7264.6529s
	iters: 200, epoch: 7 | loss: 0.2994707
	speed: 0.0326s/iter; left time: 1259.0165s
	iters: 300, epoch: 7 | loss: 0.0000024
	speed: 0.0326s/iter; left time: 1254.5303s
	iters: 400, epoch: 7 | loss: 0.1861905
	speed: 0.0305s/iter; left time: 1170.1117s
Epoch: 7 cost time: 13.903301239013672
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.269 Vali Acc: 0.961 Test Loss: 0.269 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000084
	speed: 0.1890s/iter; left time: 7242.4955s
	iters: 200, epoch: 8 | loss: 0.0000016
	speed: 0.0317s/iter; left time: 1210.6264s
	iters: 300, epoch: 8 | loss: 0.0013554
	speed: 0.0316s/iter; left time: 1204.1871s
	iters: 400, epoch: 8 | loss: 0.0001266
	speed: 0.0376s/iter; left time: 1427.5912s
Epoch: 8 cost time: 15.457083702087402
Epoch: 8, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.154 Vali Acc: 0.976 Test Loss: 0.154 Test Acc: 0.976
Validation loss decreased (-0.971349 --> -0.976351).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000323
	speed: 0.1908s/iter; left time: 7230.5486s
	iters: 200, epoch: 9 | loss: 0.4413984
	speed: 0.0520s/iter; left time: 1965.5994s
	iters: 300, epoch: 9 | loss: 0.0000010
	speed: 0.0538s/iter; left time: 2028.0704s
	iters: 400, epoch: 9 | loss: 0.5988374
	speed: 0.0504s/iter; left time: 1895.8208s
Epoch: 9 cost time: 21.886592149734497
Epoch: 9, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.300 Vali Acc: 0.960 Test Loss: 0.300 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000010
	speed: 0.1968s/iter; left time: 7376.5838s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 1618.8717s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0607s/iter; left time: 2264.7581s
	iters: 400, epoch: 10 | loss: 0.0000335
	speed: 0.0556s/iter; left time: 2067.1642s
Epoch: 10 cost time: 21.14702343940735
Epoch: 10, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.357 Vali Acc: 0.956 Test Loss: 0.357 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1943s/iter; left time: 7204.3523s
	iters: 200, epoch: 11 | loss: 0.0000052
	speed: 0.0433s/iter; left time: 1602.2692s
	iters: 300, epoch: 11 | loss: 0.0003643
	speed: 0.0376s/iter; left time: 1387.0860s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 1408.5064s
Epoch: 11 cost time: 17.076048374176025
Epoch: 11, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.281 Vali Acc: 0.970 Test Loss: 0.281 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000143
	speed: 0.2073s/iter; left time: 7599.2592s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0386s/iter; left time: 1410.7269s
	iters: 300, epoch: 12 | loss: 0.0000432
	speed: 0.0382s/iter; left time: 1394.3827s
	iters: 400, epoch: 12 | loss: 0.0000818
	speed: 0.0373s/iter; left time: 1354.6081s
Epoch: 12 cost time: 17.075695514678955
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.441 Vali Acc: 0.956 Test Loss: 0.441 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1816s/iter; left time: 6582.2249s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0354s/iter; left time: 1279.7082s
	iters: 300, epoch: 13 | loss: 0.0000058
	speed: 0.0329s/iter; left time: 1186.3928s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0340s/iter; left time: 1221.8624s
Epoch: 13 cost time: 15.569837808609009
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.235 Vali Acc: 0.971 Test Loss: 0.235 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0207327
	speed: 0.1708s/iter; left time: 6121.6865s
	iters: 200, epoch: 14 | loss: 0.0000065
	speed: 0.0327s/iter; left time: 1167.8821s
	iters: 300, epoch: 14 | loss: 0.0066599
	speed: 0.0334s/iter; left time: 1189.6583s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0320s/iter; left time: 1135.4054s
Epoch: 14 cost time: 14.326348543167114
Epoch: 14, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.280 Vali Acc: 0.973 Test Loss: 0.280 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1801s/iter; left time: 6378.5361s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0306s/iter; left time: 1082.1907s
	iters: 300, epoch: 15 | loss: 0.0000010
	speed: 0.0372s/iter; left time: 1309.8490s
	iters: 400, epoch: 15 | loss: 0.0002198
	speed: 0.0360s/iter; left time: 1265.2592s
Epoch: 15 cost time: 14.928792953491211
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.246 Vali Acc: 0.973 Test Loss: 0.246 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000005
	speed: 0.1651s/iter; left time: 5779.7810s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0397s/iter; left time: 1385.7888s
	iters: 300, epoch: 16 | loss: 0.0001260
	speed: 0.0317s/iter; left time: 1102.3626s
	iters: 400, epoch: 16 | loss: 0.0003928
	speed: 0.0316s/iter; left time: 1097.0155s
Epoch: 16 cost time: 15.085214138031006
Epoch: 16, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.187 Vali Acc: 0.977 Test Loss: 0.187 Test Acc: 0.977
Validation loss decreased (-0.976351 --> -0.976806).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000005
	speed: 0.1670s/iter; left time: 5777.1634s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0363s/iter; left time: 1250.6166s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 1034.9284s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 983.5660s
Epoch: 17 cost time: 13.417999982833862
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.249 Vali Acc: 0.980 Test Loss: 0.249 Test Acc: 0.980
Validation loss decreased (-0.976806 --> -0.979534).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1691s/iter; left time: 5780.8315s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0322s/iter; left time: 1098.1128s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0298s/iter; left time: 1011.1444s
	iters: 400, epoch: 18 | loss: 0.0000044
	speed: 0.0293s/iter; left time: 994.0957s
Epoch: 18 cost time: 14.035561323165894
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.356 Vali Acc: 0.970 Test Loss: 0.356 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000249
	speed: 0.1732s/iter; left time: 5848.0878s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 856.5002s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 1035.2027s
	iters: 400, epoch: 19 | loss: 0.0000056
	speed: 0.0364s/iter; left time: 1218.0334s
Epoch: 19 cost time: 13.794341802597046
Epoch: 19, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.263 Vali Acc: 0.971 Test Loss: 0.263 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1775s/iter; left time: 5921.6713s
	iters: 200, epoch: 20 | loss: 0.0016698
	speed: 0.0397s/iter; left time: 1320.8032s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 1394.3123s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 1283.7143s
Epoch: 20 cost time: 17.237502813339233
Epoch: 20, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.436 Vali Acc: 0.967 Test Loss: 0.436 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1836s/iter; left time: 6047.8888s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 1237.9485s
	iters: 300, epoch: 21 | loss: 2.1581748
	speed: 0.0447s/iter; left time: 1463.6515s
	iters: 400, epoch: 21 | loss: 0.0000035
	speed: 0.0458s/iter; left time: 1493.7038s
Epoch: 21 cost time: 18.099578857421875
Epoch: 21, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.260 Vali Acc: 0.975 Test Loss: 0.260 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1878s/iter; left time: 6109.8613s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 1231.9252s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 1302.6421s
	iters: 400, epoch: 22 | loss: 0.0050858
	speed: 0.0373s/iter; left time: 1203.1291s
Epoch: 22 cost time: 16.63288640975952
Epoch: 22, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.410 Vali Acc: 0.966 Test Loss: 0.410 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000005
	speed: 0.1896s/iter; left time: 6089.2205s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0363s/iter; left time: 1162.3773s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0399s/iter; left time: 1274.0165s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 1166.1829s
Epoch: 23 cost time: 17.301105737686157
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.221 Vali Acc: 0.976 Test Loss: 0.221 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000634
	speed: 0.1774s/iter; left time: 5623.8139s
	iters: 200, epoch: 24 | loss: 0.7821967
	speed: 0.0356s/iter; left time: 1125.4576s
	iters: 300, epoch: 24 | loss: 1.0170038
	speed: 0.0407s/iter; left time: 1280.7578s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 1047.1639s
Epoch: 24 cost time: 15.036638975143433
Epoch: 24, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.249 Vali Acc: 0.972 Test Loss: 0.249 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0038089
	speed: 0.1753s/iter; left time: 5485.2487s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0364s/iter; left time: 1136.4675s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0387s/iter; left time: 1203.7180s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 1176.7068s
Epoch: 25 cost time: 16.507347106933594
Epoch: 25, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.287 Vali Acc: 0.972 Test Loss: 0.287 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1890s/iter; left time: 5836.6961s
	iters: 200, epoch: 26 | loss: 0.0000015
	speed: 0.0317s/iter; left time: 974.9165s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0307s/iter; left time: 941.0067s
	iters: 400, epoch: 26 | loss: 0.0000590
	speed: 0.0264s/iter; left time: 807.9311s
Epoch: 26 cost time: 13.788635730743408
Epoch: 26, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000016
	speed: 0.1749s/iter; left time: 5328.4774s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0311s/iter; left time: 945.1388s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0311s/iter; left time: 939.9046s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 835.0485s
Epoch: 27 cost time: 13.18676495552063
Epoch: 27, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.185 Vali Acc: 0.976 Test Loss: 0.185 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 117002
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2970835
	speed: 0.0661s/iter; left time: 2722.1956s
	iters: 200, epoch: 1 | loss: 0.0614124
	speed: 0.0382s/iter; left time: 1570.3535s
	iters: 300, epoch: 1 | loss: 0.9860722
	speed: 0.0356s/iter; left time: 1461.5897s
	iters: 400, epoch: 1 | loss: 0.1214139
	speed: 0.0340s/iter; left time: 1389.8942s
Epoch: 1 cost time: 18.104365825653076
Epoch: 1, Steps: 413 | Train Loss: 0.398 Vali Loss: 0.171 Vali Acc: 0.942 Test Loss: 0.171 Test Acc: 0.942
Validation loss decreased (inf --> -0.942245).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0133080
	speed: 0.1986s/iter; left time: 8100.8894s
	iters: 200, epoch: 2 | loss: 0.0048350
	speed: 0.0334s/iter; left time: 1357.1375s
	iters: 300, epoch: 2 | loss: 0.0012756
	speed: 0.0367s/iter; left time: 1490.4603s
	iters: 400, epoch: 2 | loss: 0.0031053
	speed: 0.0430s/iter; left time: 1740.0968s
Epoch: 2 cost time: 16.167727947235107
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
Validation loss decreased (-0.942245 --> -0.961800).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0062099
	speed: 0.2005s/iter; left time: 8093.2353s
	iters: 200, epoch: 3 | loss: 0.0046190
	speed: 0.0332s/iter; left time: 1337.4282s
	iters: 300, epoch: 3 | loss: 0.1713970
	speed: 0.0362s/iter; left time: 1455.1813s
	iters: 400, epoch: 3 | loss: 0.0230778
	speed: 0.0452s/iter; left time: 1810.4401s
Epoch: 3 cost time: 16.190266609191895
Epoch: 3, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.961800 --> -0.965437).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0003718
	speed: 0.2267s/iter; left time: 9058.5825s
	iters: 200, epoch: 4 | loss: 0.0001500
	speed: 0.0333s/iter; left time: 1328.3296s
	iters: 300, epoch: 4 | loss: 0.0658510
	speed: 0.0358s/iter; left time: 1422.0660s
	iters: 400, epoch: 4 | loss: 0.0005138
	speed: 0.0342s/iter; left time: 1356.7486s
Epoch: 4 cost time: 16.664612531661987
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0066886
	speed: 0.2269s/iter; left time: 8972.3304s
	iters: 200, epoch: 5 | loss: 0.0026145
	speed: 0.0395s/iter; left time: 1559.1513s
	iters: 300, epoch: 5 | loss: 0.0006729
	speed: 0.0376s/iter; left time: 1480.4719s
	iters: 400, epoch: 5 | loss: 0.0002058
	speed: 0.0358s/iter; left time: 1407.0384s
Epoch: 5 cost time: 16.888062715530396
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
Validation loss decreased (-0.965437 --> -0.969530).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0001081
	speed: 0.2071s/iter; left time: 8104.7435s
	iters: 200, epoch: 6 | loss: 0.0021059
	speed: 0.0378s/iter; left time: 1476.9453s
	iters: 300, epoch: 6 | loss: 0.0000176
	speed: 0.0346s/iter; left time: 1346.8706s
	iters: 400, epoch: 6 | loss: 0.0000321
	speed: 0.0341s/iter; left time: 1323.9059s
Epoch: 6 cost time: 16.04107141494751
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.203 Vali Acc: 0.969 Test Loss: 0.203 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2017s/iter; left time: 7810.5593s
	iters: 200, epoch: 7 | loss: 0.0047368
	speed: 0.0372s/iter; left time: 1438.6063s
	iters: 300, epoch: 7 | loss: 0.0000202
	speed: 0.0380s/iter; left time: 1462.5525s
	iters: 400, epoch: 7 | loss: 0.0000036
	speed: 0.0356s/iter; left time: 1368.0420s
Epoch: 7 cost time: 15.931988954544067
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.187 Vali Acc: 0.968 Test Loss: 0.187 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000611
	speed: 0.1811s/iter; left time: 6936.7444s
	iters: 200, epoch: 8 | loss: 0.0004012
	speed: 0.0358s/iter; left time: 1368.4181s
	iters: 300, epoch: 8 | loss: 0.0000946
	speed: 0.0348s/iter; left time: 1324.7998s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 1259.4098s
Epoch: 8 cost time: 15.050686597824097
Epoch: 8, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000433
	speed: 0.1923s/iter; left time: 7286.1837s
	iters: 200, epoch: 9 | loss: 0.0021042
	speed: 0.0352s/iter; left time: 1330.0036s
	iters: 300, epoch: 9 | loss: 0.0003776
	speed: 0.0350s/iter; left time: 1319.5294s
	iters: 400, epoch: 9 | loss: 0.4234603
	speed: 0.0318s/iter; left time: 1194.3078s
Epoch: 9 cost time: 15.212600469589233
Epoch: 9, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.183 Vali Acc: 0.973 Test Loss: 0.183 Test Acc: 0.973
Validation loss decreased (-0.969530 --> -0.972713).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000101
	speed: 0.1951s/iter; left time: 7313.2172s
	iters: 200, epoch: 10 | loss: 0.0000023
	speed: 0.0384s/iter; left time: 1433.9321s
	iters: 300, epoch: 10 | loss: 0.0031412
	speed: 0.0353s/iter; left time: 1316.0237s
	iters: 400, epoch: 10 | loss: 0.2958910
	speed: 0.0329s/iter; left time: 1224.0606s
Epoch: 10 cost time: 15.663476705551147
Epoch: 10, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
Validation loss decreased (-0.972713 --> -0.974987).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0186508
	speed: 0.1802s/iter; left time: 6679.8954s
	iters: 200, epoch: 11 | loss: 0.0006209
	speed: 0.0404s/iter; left time: 1492.3154s
	iters: 300, epoch: 11 | loss: 0.0000128
	speed: 0.0411s/iter; left time: 1514.7836s
	iters: 400, epoch: 11 | loss: 0.0000374
	speed: 0.0425s/iter; left time: 1563.6161s
Epoch: 11 cost time: 17.171908140182495
Epoch: 11, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974987 --> -0.975442).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000006
	speed: 0.1876s/iter; left time: 6878.7915s
	iters: 200, epoch: 12 | loss: 0.0000056
	speed: 0.0440s/iter; left time: 1609.9022s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 1586.2039s
	iters: 400, epoch: 12 | loss: 0.0000024
	speed: 0.0402s/iter; left time: 1461.3699s
Epoch: 12 cost time: 18.446732759475708
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.336 Vali Acc: 0.961 Test Loss: 0.336 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1954s/iter; left time: 7082.7639s
	iters: 200, epoch: 13 | loss: 0.0000006
	speed: 0.0380s/iter; left time: 1373.7461s
	iters: 300, epoch: 13 | loss: 0.0228036
	speed: 0.0446s/iter; left time: 1607.3630s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0378s/iter; left time: 1359.3481s
Epoch: 13 cost time: 17.131652116775513
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.183 Vali Acc: 0.974 Test Loss: 0.183 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0022282
	speed: 0.1862s/iter; left time: 6673.4720s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0327s/iter; left time: 1169.7740s
	iters: 300, epoch: 14 | loss: 0.0000148
	speed: 0.0394s/iter; left time: 1403.3924s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0375s/iter; left time: 1332.4252s
Epoch: 14 cost time: 15.389250755310059
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.247 Vali Acc: 0.973 Test Loss: 0.247 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1933s/iter; left time: 6847.8707s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0370s/iter; left time: 1308.4635s
	iters: 300, epoch: 15 | loss: 0.0000151
	speed: 0.0404s/iter; left time: 1423.1987s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 1521.4297s
Epoch: 15 cost time: 17.060670614242554
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.173 Vali Acc: 0.977 Test Loss: 0.173 Test Acc: 0.977
Validation loss decreased (-0.975442 --> -0.976806).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000089
	speed: 0.1994s/iter; left time: 6981.2873s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0347s/iter; left time: 1210.8738s
	iters: 300, epoch: 16 | loss: 0.0082544
	speed: 0.0362s/iter; left time: 1258.2530s
	iters: 400, epoch: 16 | loss: 0.0000006
	speed: 0.0383s/iter; left time: 1329.8779s
Epoch: 16 cost time: 16.15845227241516
Epoch: 16, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.187 Vali Acc: 0.978 Test Loss: 0.187 Test Acc: 0.978
Validation loss decreased (-0.976806 --> -0.977715).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1900s/iter; left time: 6573.0966s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 1219.1779s
	iters: 300, epoch: 17 | loss: 0.0069968
	speed: 0.0341s/iter; left time: 1172.1260s
	iters: 400, epoch: 17 | loss: 0.0000003
	speed: 0.0344s/iter; left time: 1179.7971s
Epoch: 17 cost time: 14.737687110900879
Epoch: 17, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1844s/iter; left time: 6303.9841s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 1426.3587s
	iters: 300, epoch: 18 | loss: 0.0024802
	speed: 0.0371s/iter; left time: 1261.8162s
	iters: 400, epoch: 18 | loss: 0.0000008
	speed: 0.0339s/iter; left time: 1147.4452s
Epoch: 18 cost time: 16.08212661743164
Epoch: 18, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.225 Vali Acc: 0.977 Test Loss: 0.225 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000016
	speed: 0.1863s/iter; left time: 6290.3246s
	iters: 200, epoch: 19 | loss: 0.0008975
	speed: 0.0317s/iter; left time: 1067.4579s
	iters: 300, epoch: 19 | loss: 0.0006207
	speed: 0.0348s/iter; left time: 1167.3336s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 1386.1601s
Epoch: 19 cost time: 16.055397033691406
Epoch: 19, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.207 Vali Acc: 0.980 Test Loss: 0.207 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979534).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1799s/iter; left time: 6001.0961s
	iters: 200, epoch: 20 | loss: 0.0000110
	speed: 0.0312s/iter; left time: 1039.1821s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0305s/iter; left time: 1012.3821s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 1135.5450s
Epoch: 20 cost time: 14.246168851852417
Epoch: 20, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.406 Vali Acc: 0.966 Test Loss: 0.406 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0168871
	speed: 0.1968s/iter; left time: 6481.6057s
	iters: 200, epoch: 21 | loss: 0.0000021
	speed: 0.0280s/iter; left time: 918.0298s
	iters: 300, epoch: 21 | loss: 0.0000014
	speed: 0.0351s/iter; left time: 1148.7606s
	iters: 400, epoch: 21 | loss: 0.0001745
	speed: 0.0374s/iter; left time: 1219.2360s
Epoch: 21 cost time: 14.621133089065552
Epoch: 21, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.362 Vali Acc: 0.970 Test Loss: 0.362 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2021s/iter; left time: 6573.4043s
	iters: 200, epoch: 22 | loss: 0.0000066
	speed: 0.0370s/iter; left time: 1201.1418s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 1194.3387s
	iters: 400, epoch: 22 | loss: 0.0292477
	speed: 0.0367s/iter; left time: 1181.2210s
Epoch: 22 cost time: 17.0920672416687
Epoch: 22, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.299 Vali Acc: 0.973 Test Loss: 0.299 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2003s/iter; left time: 6433.1735s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0382s/iter; left time: 1221.7043s
	iters: 300, epoch: 23 | loss: 0.0001567
	speed: 0.0389s/iter; left time: 1242.4765s
	iters: 400, epoch: 23 | loss: 0.0000026
	speed: 0.0395s/iter; left time: 1256.3562s
Epoch: 23 cost time: 17.37485909461975
Epoch: 23, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.257 Vali Acc: 0.973 Test Loss: 0.257 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0309591
	speed: 0.1976s/iter; left time: 6264.9711s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 1230.5188s
	iters: 300, epoch: 24 | loss: 0.0032237
	speed: 0.0315s/iter; left time: 991.9546s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0305s/iter; left time: 957.3366s
Epoch: 24 cost time: 15.568685054779053
Epoch: 24, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.264 Vali Acc: 0.980 Test Loss: 0.264 Test Acc: 0.980
Validation loss decreased (-0.979534 --> -0.979988).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2010s/iter; left time: 6289.9463s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 1346.2900s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 1362.0089s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 1366.8750s
Epoch: 25 cost time: 18.465139389038086
Epoch: 25, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.257 Vali Acc: 0.973 Test Loss: 0.257 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2306s/iter; left time: 7118.5887s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0312s/iter; left time: 960.2520s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0334s/iter; left time: 1023.5587s
	iters: 400, epoch: 26 | loss: 0.4450169
	speed: 0.0376s/iter; left time: 1148.4838s
Epoch: 26 cost time: 15.751700639724731
Epoch: 26, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.978 Test Loss: 0.255 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000001
	speed: 0.2041s/iter; left time: 6217.0839s
	iters: 200, epoch: 27 | loss: 0.0000297
	speed: 0.0364s/iter; left time: 1106.2326s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 1014.1568s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0311s/iter; left time: 936.9752s
Epoch: 27 cost time: 15.187738418579102
Epoch: 27, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.294 Vali Acc: 0.979 Test Loss: 0.294 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1894s/iter; left time: 5692.1463s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 1312.8052s
	iters: 300, epoch: 28 | loss: 0.0000018
	speed: 0.0406s/iter; left time: 1212.7764s
	iters: 400, epoch: 28 | loss: 0.0000009
	speed: 0.0268s/iter; left time: 798.5389s
Epoch: 28 cost time: 16.925312280654907
Epoch: 28, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.317 Vali Acc: 0.970 Test Loss: 0.317 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1872s/iter; left time: 5548.3134s
	iters: 200, epoch: 29 | loss: 0.0000017
	speed: 0.0357s/iter; left time: 1055.6101s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 1326.8807s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 1028.1081s
Epoch: 29 cost time: 16.536497354507446
Epoch: 29, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.272 Vali Acc: 0.976 Test Loss: 0.272 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000008
	speed: 0.1873s/iter; left time: 5474.7566s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 1208.6436s
	iters: 300, epoch: 30 | loss: 0.0000648
	speed: 0.0377s/iter; left time: 1095.0333s
	iters: 400, epoch: 30 | loss: 0.0000020
	speed: 0.0359s/iter; left time: 1036.9623s
Epoch: 30 cost time: 16.590567588806152
Epoch: 30, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.235 Vali Acc: 0.979 Test Loss: 0.235 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1961s/iter; left time: 5649.8735s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 1155.4695s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 1206.6100s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1135.4980s
Epoch: 31 cost time: 17.570486307144165
Epoch: 31, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.307 Vali Acc: 0.977 Test Loss: 0.307 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0000056
	speed: 0.2070s/iter; left time: 5879.0986s
	iters: 200, epoch: 32 | loss: 0.0000153
	speed: 0.0396s/iter; left time: 1120.1334s
	iters: 300, epoch: 32 | loss: 0.0000003
	speed: 0.0431s/iter; left time: 1216.1541s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 1046.6829s
Epoch: 32 cost time: 17.47934865951538
Epoch: 32, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.338 Vali Acc: 0.975 Test Loss: 0.338 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0000085
	speed: 0.2182s/iter; left time: 6106.6344s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 1122.4589s
	iters: 300, epoch: 33 | loss: 0.0024295
	speed: 0.0374s/iter; left time: 1039.8297s
	iters: 400, epoch: 33 | loss: 0.0025424
	speed: 0.0393s/iter; left time: 1087.1159s
Epoch: 33 cost time: 16.899195432662964
Epoch: 33, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.331 Vali Acc: 0.973 Test Loss: 0.331 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0000003
	speed: 0.2005s/iter; left time: 5528.7726s
	iters: 200, epoch: 34 | loss: 0.0454380
	speed: 0.0371s/iter; left time: 1019.2323s
	iters: 300, epoch: 34 | loss: 0.0019779
	speed: 0.0426s/iter; left time: 1164.9906s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0354s/iter; left time: 966.2965s
Epoch: 34 cost time: 16.204473972320557
Epoch: 34, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.328 Vali Acc: 0.978 Test Loss: 0.328 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 96298
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3354355
	speed: 0.0698s/iter; left time: 2874.8028s
	iters: 200, epoch: 1 | loss: 0.1484337
	speed: 0.0349s/iter; left time: 1435.8830s
	iters: 300, epoch: 1 | loss: 0.0595004
	speed: 0.0294s/iter; left time: 1207.0865s
	iters: 400, epoch: 1 | loss: 0.0990201
	speed: 0.0330s/iter; left time: 1351.5067s
Epoch: 1 cost time: 17.310506343841553
Epoch: 1, Steps: 413 | Train Loss: 0.461 Vali Loss: 0.100 Vali Acc: 0.963 Test Loss: 0.100 Test Acc: 0.963
Validation loss decreased (inf --> -0.963164).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0509973
	speed: 0.1873s/iter; left time: 7641.4032s
	iters: 200, epoch: 2 | loss: 0.0309978
	speed: 0.0391s/iter; left time: 1592.3766s
	iters: 300, epoch: 2 | loss: 0.0036399
	speed: 0.0353s/iter; left time: 1433.8086s
	iters: 400, epoch: 2 | loss: 0.0036125
	speed: 0.0390s/iter; left time: 1580.5646s
Epoch: 2 cost time: 16.525298595428467
Epoch: 2, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.097 Vali Acc: 0.967 Test Loss: 0.097 Test Acc: 0.967
Validation loss decreased (-0.963164 --> -0.966802).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0528040
	speed: 0.1797s/iter; left time: 7254.4468s
	iters: 200, epoch: 3 | loss: 0.0033170
	speed: 0.0386s/iter; left time: 1556.5208s
	iters: 300, epoch: 3 | loss: 0.0901610
	speed: 0.0351s/iter; left time: 1411.0564s
	iters: 400, epoch: 3 | loss: 0.0000920
	speed: 0.0309s/iter; left time: 1240.1562s
Epoch: 3 cost time: 15.425954341888428
Epoch: 3, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.078 Vali Acc: 0.972 Test Loss: 0.078 Test Acc: 0.972
Validation loss decreased (-0.966802 --> -0.971805).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0003427
	speed: 0.1769s/iter; left time: 7070.6024s
	iters: 200, epoch: 4 | loss: 0.0133927
	speed: 0.0337s/iter; left time: 1344.4652s
	iters: 300, epoch: 4 | loss: 0.0081627
	speed: 0.0435s/iter; left time: 1730.0527s
	iters: 400, epoch: 4 | loss: 0.0017696
	speed: 0.0404s/iter; left time: 1601.5164s
Epoch: 4 cost time: 16.681614637374878
Epoch: 4, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.128 Vali Acc: 0.958 Test Loss: 0.128 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2177878
	speed: 0.2086s/iter; left time: 8251.0081s
	iters: 200, epoch: 5 | loss: 0.0123153
	speed: 0.0323s/iter; left time: 1272.9358s
	iters: 300, epoch: 5 | loss: 0.0000392
	speed: 0.0414s/iter; left time: 1630.0014s
	iters: 400, epoch: 5 | loss: 0.0415417
	speed: 0.0384s/iter; left time: 1507.7475s
Epoch: 5 cost time: 16.505403518676758
Epoch: 5, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0302525
	speed: 0.1927s/iter; left time: 7539.9329s
	iters: 200, epoch: 6 | loss: 0.0009481
	speed: 0.0371s/iter; left time: 1449.3331s
	iters: 300, epoch: 6 | loss: 0.0003581
	speed: 0.0364s/iter; left time: 1415.7423s
	iters: 400, epoch: 6 | loss: 0.0004919
	speed: 0.0385s/iter; left time: 1494.7686s
Epoch: 6 cost time: 16.025367498397827
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0004135
	speed: 0.1946s/iter; left time: 7534.4699s
	iters: 200, epoch: 7 | loss: 0.0005187
	speed: 0.0427s/iter; left time: 1648.3594s
	iters: 300, epoch: 7 | loss: 0.0036416
	speed: 0.0370s/iter; left time: 1426.4004s
	iters: 400, epoch: 7 | loss: 0.0000760
	speed: 0.0362s/iter; left time: 1389.3837s
Epoch: 7 cost time: 16.959359407424927
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.207 Vali Acc: 0.965 Test Loss: 0.207 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1134101
	speed: 0.2004s/iter; left time: 7678.9499s
	iters: 200, epoch: 8 | loss: 0.3314869
	speed: 0.0412s/iter; left time: 1574.3918s
	iters: 300, epoch: 8 | loss: 0.0025369
	speed: 0.0397s/iter; left time: 1511.7117s
	iters: 400, epoch: 8 | loss: 0.0067315
	speed: 0.0372s/iter; left time: 1414.8214s
Epoch: 8 cost time: 17.7643780708313
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.185 Vali Acc: 0.968 Test Loss: 0.185 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000172
	speed: 0.1879s/iter; left time: 7121.5286s
	iters: 200, epoch: 9 | loss: 0.0431654
	speed: 0.0421s/iter; left time: 1591.3966s
	iters: 300, epoch: 9 | loss: 0.0331774
	speed: 0.0447s/iter; left time: 1685.0217s
	iters: 400, epoch: 9 | loss: 0.0000182
	speed: 0.0380s/iter; left time: 1430.3448s
Epoch: 9 cost time: 17.855605125427246
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000004
	speed: 0.1801s/iter; left time: 6749.2397s
	iters: 200, epoch: 10 | loss: 0.0000158
	speed: 0.0320s/iter; left time: 1195.2083s
	iters: 300, epoch: 10 | loss: 0.0000228
	speed: 0.0397s/iter; left time: 1479.0466s
	iters: 400, epoch: 10 | loss: 0.0000013
	speed: 0.0366s/iter; left time: 1359.7329s
Epoch: 10 cost time: 15.821336507797241
Epoch: 10, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0003277
	speed: 0.2056s/iter; left time: 7622.0702s
	iters: 200, epoch: 11 | loss: 0.0000154
	speed: 0.0361s/iter; left time: 1335.5848s
	iters: 300, epoch: 11 | loss: 0.0000127
	speed: 0.0409s/iter; left time: 1509.8325s
	iters: 400, epoch: 11 | loss: 0.0005998
	speed: 0.0385s/iter; left time: 1416.8346s
Epoch: 11 cost time: 17.002196550369263
Epoch: 11, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.228 Vali Acc: 0.968 Test Loss: 0.228 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0407002
	speed: 0.2088s/iter; left time: 7653.5967s
	iters: 200, epoch: 12 | loss: 0.0000009
	speed: 0.0386s/iter; left time: 1411.7679s
	iters: 300, epoch: 12 | loss: 0.0157580
	speed: 0.0432s/iter; left time: 1575.9970s
	iters: 400, epoch: 12 | loss: 0.0012408
	speed: 0.0375s/iter; left time: 1361.8847s
Epoch: 12 cost time: 17.17474126815796
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.280 Vali Acc: 0.964 Test Loss: 0.280 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.1954s/iter; left time: 7081.7463s
	iters: 200, epoch: 13 | loss: 0.0000007
	speed: 0.0392s/iter; left time: 1417.2383s
	iters: 300, epoch: 13 | loss: 0.0000008
	speed: 0.0409s/iter; left time: 1474.1243s
	iters: 400, epoch: 13 | loss: 0.0004663
	speed: 0.0329s/iter; left time: 1183.1078s
Epoch: 13 cost time: 15.992793321609497
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.186 Vali Acc: 0.974 Test Loss: 0.186 Test Acc: 0.974
Validation loss decreased (-0.971805 --> -0.973623).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000013
	speed: 0.1951s/iter; left time: 6991.0228s
	iters: 200, epoch: 14 | loss: 0.2737136
	speed: 0.0377s/iter; left time: 1347.7533s
	iters: 300, epoch: 14 | loss: 0.1663743
	speed: 0.0368s/iter; left time: 1310.9130s
	iters: 400, epoch: 14 | loss: 0.0002386
	speed: 0.0344s/iter; left time: 1221.1440s
Epoch: 14 cost time: 15.749922752380371
Epoch: 14, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0028699
	speed: 0.1923s/iter; left time: 6812.5832s
	iters: 200, epoch: 15 | loss: 0.0000480
	speed: 0.0355s/iter; left time: 1254.4306s
	iters: 300, epoch: 15 | loss: 0.0000004
	speed: 0.0388s/iter; left time: 1366.8613s
	iters: 400, epoch: 15 | loss: 0.0004613
	speed: 0.0326s/iter; left time: 1143.5029s
Epoch: 15 cost time: 15.793815851211548
Epoch: 15, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.268 Vali Acc: 0.964 Test Loss: 0.268 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1220724
	speed: 0.1971s/iter; left time: 6898.4017s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 1434.4960s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 1483.9438s
	iters: 400, epoch: 16 | loss: 0.0000005
	speed: 0.0390s/iter; left time: 1355.0997s
Epoch: 16 cost time: 16.91600799560547
Epoch: 16, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.973623 --> -0.977261).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000004
	speed: 0.2041s/iter; left time: 7060.3575s
	iters: 200, epoch: 17 | loss: 0.0004108
	speed: 0.0420s/iter; left time: 1449.4610s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0393s/iter; left time: 1351.0478s
	iters: 400, epoch: 17 | loss: 0.0000030
	speed: 0.0431s/iter; left time: 1476.3286s
Epoch: 17 cost time: 17.912965297698975
Epoch: 17, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.977 Test Loss: 0.186 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2041s/iter; left time: 6975.3408s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 1335.5313s
	iters: 300, epoch: 18 | loss: 0.0051778
	speed: 0.0387s/iter; left time: 1314.0083s
	iters: 400, epoch: 18 | loss: 0.0000895
	speed: 0.0404s/iter; left time: 1368.4799s
Epoch: 18 cost time: 17.483622789382935
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.289 Vali Acc: 0.964 Test Loss: 0.289 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 0.2130s/iter; left time: 7191.3908s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 1356.0485s
	iters: 300, epoch: 19 | loss: 0.0000200
	speed: 0.0472s/iter; left time: 1582.7902s
	iters: 400, epoch: 19 | loss: 0.0000002
	speed: 0.0396s/iter; left time: 1323.8744s
Epoch: 19 cost time: 18.43317198753357
Epoch: 19, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000004
	speed: 0.2015s/iter; left time: 6721.4882s
	iters: 200, epoch: 20 | loss: 0.0006011
	speed: 0.0386s/iter; left time: 1284.3205s
	iters: 300, epoch: 20 | loss: 0.0008805
	speed: 0.0387s/iter; left time: 1282.5226s
	iters: 400, epoch: 20 | loss: 0.0000538
	speed: 0.0421s/iter; left time: 1390.7018s
Epoch: 20 cost time: 17.439921140670776
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.297 Vali Acc: 0.968 Test Loss: 0.297 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1959s/iter; left time: 6454.4894s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 1109.1430s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 1036.0847s
	iters: 400, epoch: 21 | loss: 0.0000017
	speed: 0.0393s/iter; left time: 1281.8562s
Epoch: 21 cost time: 15.621450424194336
Epoch: 21, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.344 Vali Acc: 0.965 Test Loss: 0.344 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0001173
	speed: 0.1935s/iter; left time: 6295.6788s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 1095.9794s
	iters: 300, epoch: 22 | loss: 0.0000005
	speed: 0.0265s/iter; left time: 855.9085s
	iters: 400, epoch: 22 | loss: 0.0000101
	speed: 0.0292s/iter; left time: 941.6527s
Epoch: 22 cost time: 13.586198329925537
Epoch: 22, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.240 Vali Acc: 0.969 Test Loss: 0.240 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000599
	speed: 0.1905s/iter; left time: 6117.0377s
	iters: 200, epoch: 23 | loss: 0.0519572
	speed: 0.0370s/iter; left time: 1185.0634s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 960.4246s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0305s/iter; left time: 969.4853s
Epoch: 23 cost time: 14.790056943893433
Epoch: 23, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000072
	speed: 0.1699s/iter; left time: 5386.5761s
	iters: 200, epoch: 24 | loss: 0.0000007
	speed: 0.0372s/iter; left time: 1176.9744s
	iters: 300, epoch: 24 | loss: 0.0000002
	speed: 0.0315s/iter; left time: 993.0857s
	iters: 400, epoch: 24 | loss: 0.0000388
	speed: 0.0320s/iter; left time: 1005.1075s
Epoch: 24 cost time: 15.412546634674072
Epoch: 24, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.238 Vali Acc: 0.976 Test Loss: 0.238 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1822s/iter; left time: 5699.4096s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0307s/iter; left time: 957.1689s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 1125.0495s
	iters: 400, epoch: 25 | loss: 0.0000044
	speed: 0.0345s/iter; left time: 1068.6924s
Epoch: 25 cost time: 15.112639427185059
Epoch: 25, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.162 Vali Acc: 0.980 Test Loss: 0.162 Test Acc: 0.980
Validation loss decreased (-0.977261 --> -0.979535).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1869s/iter; left time: 5771.0630s
	iters: 200, epoch: 26 | loss: 0.0000014
	speed: 0.0344s/iter; left time: 1057.3660s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.0341s/iter; left time: 1046.1457s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.0365s/iter; left time: 1116.7297s
Epoch: 26 cost time: 15.540668249130249
Epoch: 26, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.273 Vali Acc: 0.974 Test Loss: 0.273 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0256938
	speed: 0.1947s/iter; left time: 5931.3362s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 1195.9448s
	iters: 300, epoch: 27 | loss: 0.2463717
	speed: 0.0415s/iter; left time: 1255.0397s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0387s/iter; left time: 1168.2908s
Epoch: 27 cost time: 17.07816219329834
Epoch: 27, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.402 Vali Acc: 0.964 Test Loss: 0.402 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1884s/iter; left time: 5659.9176s
	iters: 200, epoch: 28 | loss: 0.0000001
	speed: 0.0380s/iter; left time: 1137.1773s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 1162.0973s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 1022.0126s
Epoch: 28 cost time: 16.418978691101074
Epoch: 28, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.266 Vali Acc: 0.976 Test Loss: 0.266 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0000001
	speed: 0.1906s/iter; left time: 5648.7383s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0400s/iter; left time: 1182.6808s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 1091.3520s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0386s/iter; left time: 1132.6900s
Epoch: 29 cost time: 16.409950733184814
Epoch: 29, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.292 Vali Acc: 0.970 Test Loss: 0.292 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0000091
	speed: 0.1974s/iter; left time: 5768.1354s
	iters: 200, epoch: 30 | loss: 0.0000001
	speed: 0.0371s/iter; left time: 1079.2829s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 1076.0605s
	iters: 400, epoch: 30 | loss: 0.0034770
	speed: 0.0404s/iter; left time: 1168.6795s
Epoch: 30 cost time: 16.585689544677734
Epoch: 30, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.279 Vali Acc: 0.972 Test Loss: 0.279 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0000831
	speed: 0.1813s/iter; left time: 5222.8195s
	iters: 200, epoch: 31 | loss: 0.0000002
	speed: 0.0378s/iter; left time: 1085.3539s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0298s/iter; left time: 853.4597s
	iters: 400, epoch: 31 | loss: 0.0002917
	speed: 0.0313s/iter; left time: 892.3220s
Epoch: 31 cost time: 14.906533241271973
Epoch: 31, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.278 Vali Acc: 0.969 Test Loss: 0.278 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0125230
	speed: 0.1716s/iter; left time: 4872.3052s
	iters: 200, epoch: 32 | loss: 0.0000006
	speed: 0.0322s/iter; left time: 912.2011s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 983.8407s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 934.4126s
Epoch: 32 cost time: 14.90828537940979
Epoch: 32, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.171 Vali Acc: 0.980 Test Loss: 0.171 Test Acc: 0.980
Validation loss decreased (-0.979535 --> -0.979989).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0000009
	speed: 0.1805s/iter; left time: 5051.1539s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 775.3768s
	iters: 300, epoch: 33 | loss: 0.0000004
	speed: 0.0366s/iter; left time: 1016.3075s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 926.3654s
Epoch: 33 cost time: 14.237722635269165
Epoch: 33, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1832s/iter; left time: 5052.1612s
	iters: 200, epoch: 34 | loss: 0.0009921
	speed: 0.0395s/iter; left time: 1085.3494s
	iters: 300, epoch: 34 | loss: 0.0000033
	speed: 0.0342s/iter; left time: 935.7108s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 788.5658s
Epoch: 34 cost time: 15.729872465133667
Epoch: 34, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.349 Vali Acc: 0.973 Test Loss: 0.349 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1835s/iter; left time: 4984.1121s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 954.9053s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 912.1364s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 1041.7919s
Epoch: 35 cost time: 15.847175121307373
Epoch: 35, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0000064
	speed: 0.1802s/iter; left time: 4820.6534s
	iters: 200, epoch: 36 | loss: 0.0004330
	speed: 0.0393s/iter; left time: 1046.0433s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 934.7303s
	iters: 400, epoch: 36 | loss: 0.0012696
	speed: 0.0308s/iter; left time: 814.0762s
Epoch: 36 cost time: 14.996651411056519
Epoch: 36, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.301 Vali Acc: 0.974 Test Loss: 0.301 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0000006
	speed: 0.2037s/iter; left time: 5362.7683s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 984.2309s
	iters: 300, epoch: 37 | loss: 0.0000092
	speed: 0.0436s/iter; left time: 1140.2727s
	iters: 400, epoch: 37 | loss: 0.5739085
	speed: 0.0383s/iter; left time: 996.2499s
Epoch: 37 cost time: 17.692485094070435
Epoch: 37, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.264 Vali Acc: 0.976 Test Loss: 0.264 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2302s/iter; left time: 5965.4980s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 868.4475s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 1062.1046s
	iters: 400, epoch: 38 | loss: 0.0003687
	speed: 0.0393s/iter; left time: 1006.4934s
Epoch: 38 cost time: 17.72162675857544
Epoch: 38, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.193 Vali Acc: 0.978 Test Loss: 0.193 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.2257s/iter; left time: 5755.8797s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0390s/iter; left time: 991.8855s
	iters: 300, epoch: 39 | loss: 0.0000093
	speed: 0.0370s/iter; left time: 936.7149s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0408s/iter; left time: 1028.3400s
Epoch: 39 cost time: 16.844489336013794
Epoch: 39, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.311 Vali Acc: 0.971 Test Loss: 0.311 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.2130s/iter; left time: 5344.2524s
	iters: 200, epoch: 40 | loss: 0.0726448
	speed: 0.0445s/iter; left time: 1111.5631s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 972.4697s
	iters: 400, epoch: 40 | loss: 0.0120547
	speed: 0.0316s/iter; left time: 783.7327s
Epoch: 40 cost time: 17.185068368911743
Epoch: 40, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.347 Vali Acc: 0.974 Test Loss: 0.347 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.1921s/iter; left time: 4741.2998s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 1084.2423s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 993.4282s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 839.3744s
Epoch: 41 cost time: 16.9581937789917
Epoch: 41, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.979 Test Loss: 0.204 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0151697
	speed: 0.2009s/iter; left time: 4875.1515s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 940.9222s
	iters: 300, epoch: 42 | loss: 0.0000037
	speed: 0.0377s/iter; left time: 907.2902s
	iters: 400, epoch: 42 | loss: 0.2091866
	speed: 0.0440s/iter; left time: 1055.7245s
Epoch: 42 cost time: 17.88113260269165
Epoch: 42, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.223 Vali Acc: 0.979 Test Loss: 0.223 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 75626
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4705118
	speed: 0.0744s/iter; left time: 3064.2045s
	iters: 200, epoch: 1 | loss: 0.1524878
	speed: 0.0396s/iter; left time: 1625.9644s
	iters: 300, epoch: 1 | loss: 0.1133329
	speed: 0.0368s/iter; left time: 1508.8992s
	iters: 400, epoch: 1 | loss: 0.0530939
	speed: 0.0383s/iter; left time: 1564.6633s
Epoch: 1 cost time: 19.62719225883484
Epoch: 1, Steps: 413 | Train Loss: 0.522 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
Validation loss decreased (inf --> -0.967257).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1634840
	speed: 0.1985s/iter; left time: 8097.3401s
	iters: 200, epoch: 2 | loss: 0.3344756
	speed: 0.0355s/iter; left time: 1442.9552s
	iters: 300, epoch: 2 | loss: 0.1396053
	speed: 0.0333s/iter; left time: 1352.1988s
	iters: 400, epoch: 2 | loss: 0.0199818
	speed: 0.0345s/iter; left time: 1396.7635s
Epoch: 2 cost time: 15.701386451721191
Epoch: 2, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.075 Vali Acc: 0.972 Test Loss: 0.075 Test Acc: 0.972
Validation loss decreased (-0.967257 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1245658
	speed: 0.2018s/iter; left time: 8146.7015s
	iters: 200, epoch: 3 | loss: 0.1416911
	speed: 0.0370s/iter; left time: 1491.3890s
	iters: 300, epoch: 3 | loss: 0.0005106
	speed: 0.0338s/iter; left time: 1358.1214s
	iters: 400, epoch: 3 | loss: 0.0056383
	speed: 0.0373s/iter; left time: 1493.1503s
Epoch: 3 cost time: 15.827063083648682
Epoch: 3, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0017276
	speed: 0.1925s/iter; left time: 7693.9442s
	iters: 200, epoch: 4 | loss: 0.0793357
	speed: 0.0369s/iter; left time: 1472.7333s
	iters: 300, epoch: 4 | loss: 0.0015380
	speed: 0.0347s/iter; left time: 1380.4108s
	iters: 400, epoch: 4 | loss: 0.0380333
	speed: 0.0326s/iter; left time: 1293.1113s
Epoch: 4 cost time: 15.09595274925232
Epoch: 4, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.058 Vali Acc: 0.975 Test Loss: 0.058 Test Acc: 0.975
Validation loss decreased (-0.972259 --> -0.975443).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0003836
	speed: 0.1885s/iter; left time: 7455.5686s
	iters: 200, epoch: 5 | loss: 0.0171999
	speed: 0.0391s/iter; left time: 1543.2528s
	iters: 300, epoch: 5 | loss: 0.0004234
	speed: 0.0407s/iter; left time: 1600.7058s
	iters: 400, epoch: 5 | loss: 0.0418392
	speed: 0.0341s/iter; left time: 1336.9490s
Epoch: 5 cost time: 16.3267879486084
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0031796
	speed: 0.1877s/iter; left time: 7343.8705s
	iters: 200, epoch: 6 | loss: 0.1827965
	speed: 0.0374s/iter; left time: 1459.9150s
	iters: 300, epoch: 6 | loss: 0.0081961
	speed: 0.0344s/iter; left time: 1338.5100s
	iters: 400, epoch: 6 | loss: 0.0002463
	speed: 0.0366s/iter; left time: 1420.0925s
Epoch: 6 cost time: 16.160088777542114
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1255940
	speed: 0.1819s/iter; left time: 7042.9943s
	iters: 200, epoch: 7 | loss: 0.0163484
	speed: 0.0401s/iter; left time: 1548.0809s
	iters: 300, epoch: 7 | loss: 0.0354367
	speed: 0.0324s/iter; left time: 1246.4293s
	iters: 400, epoch: 7 | loss: 0.0038202
	speed: 0.0358s/iter; left time: 1377.3121s
Epoch: 7 cost time: 15.836817026138306
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0081307
	speed: 0.1885s/iter; left time: 7222.6639s
	iters: 200, epoch: 8 | loss: 0.0010831
	speed: 0.0428s/iter; left time: 1635.7698s
	iters: 300, epoch: 8 | loss: 0.1085645
	speed: 0.0385s/iter; left time: 1465.8372s
	iters: 400, epoch: 8 | loss: 0.0007691
	speed: 0.0367s/iter; left time: 1396.4064s
Epoch: 8 cost time: 17.118826389312744
Epoch: 8, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.183 Vali Acc: 0.963 Test Loss: 0.183 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000086
	speed: 0.2039s/iter; left time: 7728.6148s
	iters: 200, epoch: 9 | loss: 0.0097526
	speed: 0.0396s/iter; left time: 1495.0267s
	iters: 300, epoch: 9 | loss: 0.0003291
	speed: 0.0422s/iter; left time: 1590.5813s
	iters: 400, epoch: 9 | loss: 0.0101908
	speed: 0.0365s/iter; left time: 1371.0882s
Epoch: 9 cost time: 17.438676595687866
Epoch: 9, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0224043
	speed: 0.1983s/iter; left time: 7432.7478s
	iters: 200, epoch: 10 | loss: 0.0097548
	speed: 0.0356s/iter; left time: 1330.4741s
	iters: 300, epoch: 10 | loss: 0.0043316
	speed: 0.0354s/iter; left time: 1319.7256s
	iters: 400, epoch: 10 | loss: 0.1094918
	speed: 0.0408s/iter; left time: 1518.6907s
Epoch: 10 cost time: 16.412895441055298
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0001336
	speed: 0.1923s/iter; left time: 7130.5571s
	iters: 200, epoch: 11 | loss: 0.0000028
	speed: 0.0353s/iter; left time: 1304.9918s
	iters: 300, epoch: 11 | loss: 0.0756865
	speed: 0.0350s/iter; left time: 1292.1195s
	iters: 400, epoch: 11 | loss: 0.0000100
	speed: 0.0358s/iter; left time: 1314.7540s
Epoch: 11 cost time: 15.735979318618774
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000149
	speed: 0.2080s/iter; left time: 7625.8281s
	iters: 200, epoch: 12 | loss: 0.0268349
	speed: 0.0428s/iter; left time: 1564.7497s
	iters: 300, epoch: 12 | loss: 0.0000012
	speed: 0.0372s/iter; left time: 1355.3538s
	iters: 400, epoch: 12 | loss: 0.0000074
	speed: 0.0384s/iter; left time: 1397.9472s
Epoch: 12 cost time: 17.41522526741028
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
Validation loss decreased (-0.975443 --> -0.981809).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2027s/iter; left time: 7346.0102s
	iters: 200, epoch: 13 | loss: 0.7388950
	speed: 0.0390s/iter; left time: 1408.7044s
	iters: 300, epoch: 13 | loss: 0.0152355
	speed: 0.0341s/iter; left time: 1229.6326s
	iters: 400, epoch: 13 | loss: 0.0000059
	speed: 0.0364s/iter; left time: 1309.7302s
Epoch: 13 cost time: 16.135379791259766
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000026
	speed: 0.2018s/iter; left time: 7230.6260s
	iters: 200, epoch: 14 | loss: 0.0026895
	speed: 0.0376s/iter; left time: 1341.9378s
	iters: 300, epoch: 14 | loss: 0.3660077
	speed: 0.0423s/iter; left time: 1507.3603s
	iters: 400, epoch: 14 | loss: 0.0000002
	speed: 0.0397s/iter; left time: 1411.6772s
Epoch: 14 cost time: 17.291340351104736
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0001508
	speed: 0.1998s/iter; left time: 7075.2190s
	iters: 200, epoch: 15 | loss: 0.0000007
	speed: 0.0330s/iter; left time: 1164.5265s
	iters: 300, epoch: 15 | loss: 0.0000012
	speed: 0.0395s/iter; left time: 1391.9739s
	iters: 400, epoch: 15 | loss: 0.4919563
	speed: 0.0339s/iter; left time: 1190.3624s
Epoch: 15 cost time: 16.122217655181885
Epoch: 15, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.200 Vali Acc: 0.965 Test Loss: 0.200 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000003
	speed: 0.2013s/iter; left time: 7047.6424s
	iters: 200, epoch: 16 | loss: 0.0000034
	speed: 0.0377s/iter; left time: 1315.7206s
	iters: 300, epoch: 16 | loss: 0.0000069
	speed: 0.0381s/iter; left time: 1327.5178s
	iters: 400, epoch: 16 | loss: 0.0114025
	speed: 0.0347s/iter; left time: 1204.6836s
Epoch: 16 cost time: 16.862735748291016
Epoch: 16, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000029
	speed: 0.1875s/iter; left time: 6484.7037s
	iters: 200, epoch: 17 | loss: 0.0000056
	speed: 0.0381s/iter; left time: 1315.6356s
	iters: 300, epoch: 17 | loss: 0.0000008
	speed: 0.0385s/iter; left time: 1322.6606s
	iters: 400, epoch: 17 | loss: 0.0005660
	speed: 0.0353s/iter; left time: 1210.6413s
Epoch: 17 cost time: 16.186914682388306
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.211 Vali Acc: 0.971 Test Loss: 0.211 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0003121
	speed: 0.2036s/iter; left time: 6959.7558s
	iters: 200, epoch: 18 | loss: 0.3820133
	speed: 0.0363s/iter; left time: 1237.9069s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0385s/iter; left time: 1309.2267s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0395s/iter; left time: 1339.9046s
Epoch: 18 cost time: 16.97538447380066
Epoch: 18, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.222 Vali Acc: 0.974 Test Loss: 0.222 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000578
	speed: 0.2090s/iter; left time: 7057.6146s
	iters: 200, epoch: 19 | loss: 0.0350218
	speed: 0.0375s/iter; left time: 1260.9591s
	iters: 300, epoch: 19 | loss: 0.0000006
	speed: 0.0375s/iter; left time: 1259.3502s
	iters: 400, epoch: 19 | loss: 0.0036592
	speed: 0.0373s/iter; left time: 1249.8212s
Epoch: 19 cost time: 17.07869863510132
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000004
	speed: 0.2027s/iter; left time: 6762.3397s
	iters: 200, epoch: 20 | loss: 0.0034569
	speed: 0.0374s/iter; left time: 1244.2041s
	iters: 300, epoch: 20 | loss: 0.0000122
	speed: 0.0426s/iter; left time: 1411.8908s
	iters: 400, epoch: 20 | loss: 0.0000007
	speed: 0.0400s/iter; left time: 1322.1673s
Epoch: 20 cost time: 17.796492099761963
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.985 Test Loss: 0.084 Test Acc: 0.985
Validation loss decreased (-0.981809 --> -0.985447).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2170s/iter; left time: 7147.0936s
	iters: 200, epoch: 21 | loss: 0.0000501
	speed: 0.0444s/iter; left time: 1458.8699s
	iters: 300, epoch: 21 | loss: 0.0000122
	speed: 0.0374s/iter; left time: 1223.4583s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.0361s/iter; left time: 1179.2226s
Epoch: 21 cost time: 17.74130153656006
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.140 Vali Acc: 0.980 Test Loss: 0.140 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0038973
	speed: 0.2046s/iter; left time: 6655.8931s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0360s/iter; left time: 1167.8666s
	iters: 300, epoch: 22 | loss: 0.0002354
	speed: 0.0413s/iter; left time: 1334.9389s
	iters: 400, epoch: 22 | loss: 0.0000006
	speed: 0.0358s/iter; left time: 1152.2540s
Epoch: 22 cost time: 16.49548602104187
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.973 Test Loss: 0.176 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1910s/iter; left time: 6132.7511s
	iters: 200, epoch: 23 | loss: 0.0744364
	speed: 0.0346s/iter; left time: 1107.1613s
	iters: 300, epoch: 23 | loss: 0.1162277
	speed: 0.0339s/iter; left time: 1081.5082s
	iters: 400, epoch: 23 | loss: 0.0000803
	speed: 0.0368s/iter; left time: 1171.8525s
Epoch: 23 cost time: 14.968823432922363
Epoch: 23, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1836s/iter; left time: 5818.9099s
	iters: 200, epoch: 24 | loss: 0.0000008
	speed: 0.0369s/iter; left time: 1167.3771s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.0335s/iter; left time: 1054.6682s
	iters: 400, epoch: 24 | loss: 0.0010313
	speed: 0.0344s/iter; left time: 1079.0434s
Epoch: 24 cost time: 15.01356840133667
Epoch: 24, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.214 Vali Acc: 0.968 Test Loss: 0.214 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000014
	speed: 0.1765s/iter; left time: 5523.4174s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 1013.0086s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 1034.2248s
	iters: 400, epoch: 25 | loss: 0.0000019
	speed: 0.0371s/iter; left time: 1148.3901s
Epoch: 25 cost time: 14.521359920501709
Epoch: 25, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1896s/iter; left time: 5855.0352s
	iters: 200, epoch: 26 | loss: 0.0000021
	speed: 0.0345s/iter; left time: 1062.8359s
	iters: 300, epoch: 26 | loss: 0.3133851
	speed: 0.0359s/iter; left time: 1102.4875s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0313s/iter; left time: 955.9853s
Epoch: 26 cost time: 14.878170728683472
Epoch: 26, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.268 Vali Acc: 0.965 Test Loss: 0.268 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1916s/iter; left time: 5835.8438s
	iters: 200, epoch: 27 | loss: 0.0000264
	speed: 0.0403s/iter; left time: 1223.4916s
	iters: 300, epoch: 27 | loss: 0.0000475
	speed: 0.0408s/iter; left time: 1234.7448s
	iters: 400, epoch: 27 | loss: 0.0000151
	speed: 0.0361s/iter; left time: 1088.4933s
Epoch: 27 cost time: 17.2603702545166
Epoch: 27, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.199 Vali Acc: 0.974 Test Loss: 0.199 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000001
	speed: 0.1840s/iter; left time: 5529.6651s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 1228.9762s
	iters: 300, epoch: 28 | loss: 0.0000001
	speed: 0.0372s/iter; left time: 1109.1697s
	iters: 400, epoch: 28 | loss: 0.0006122
	speed: 0.0433s/iter; left time: 1287.0686s
Epoch: 28 cost time: 17.35953998565674
Epoch: 28, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.980 Test Loss: 0.151 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1932s/iter; left time: 5725.4238s
	iters: 200, epoch: 29 | loss: 0.0000033
	speed: 0.0401s/iter; left time: 1185.8421s
	iters: 300, epoch: 29 | loss: 0.0000012
	speed: 0.0366s/iter; left time: 1076.3884s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 1210.9755s
Epoch: 29 cost time: 17.32165288925171
Epoch: 29, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.978 Test Loss: 0.155 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.8188363
	speed: 0.2102s/iter; left time: 6141.6202s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0354s/iter; left time: 1030.3626s
	iters: 300, epoch: 30 | loss: 0.0000002
	speed: 0.0415s/iter; left time: 1204.1407s
	iters: 400, epoch: 30 | loss: 0.0127634
	speed: 0.0418s/iter; left time: 1207.8364s
Epoch: 30 cost time: 17.602400541305542
Epoch: 30, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.262 Vali Acc: 0.969 Test Loss: 0.262 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 59146
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4369318
	speed: 0.0669s/iter; left time: 2755.7610s
	iters: 200, epoch: 1 | loss: 0.2053839
	speed: 0.0329s/iter; left time: 1351.3101s
	iters: 300, epoch: 1 | loss: 0.2281184
	speed: 0.0285s/iter; left time: 1167.1086s
	iters: 400, epoch: 1 | loss: 0.6501411
	speed: 0.0296s/iter; left time: 1211.8229s
Epoch: 1 cost time: 16.20797872543335
Epoch: 1, Steps: 413 | Train Loss: 0.568 Vali Loss: 0.116 Vali Acc: 0.960 Test Loss: 0.116 Test Acc: 0.960
Validation loss decreased (inf --> -0.960435).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0555271
	speed: 0.1882s/iter; left time: 7678.3323s
	iters: 200, epoch: 2 | loss: 0.0672228
	speed: 0.0334s/iter; left time: 1360.5424s
	iters: 300, epoch: 2 | loss: 0.0769208
	speed: 0.0365s/iter; left time: 1480.5095s
	iters: 400, epoch: 2 | loss: 0.0414685
	speed: 0.0354s/iter; left time: 1433.6471s
Epoch: 2 cost time: 15.582464933395386
Epoch: 2, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.078 Vali Acc: 0.974 Test Loss: 0.078 Test Acc: 0.974
Validation loss decreased (-0.960435 --> -0.974078).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0078656
	speed: 0.1763s/iter; left time: 7119.9788s
	iters: 200, epoch: 3 | loss: 0.0421605
	speed: 0.0394s/iter; left time: 1587.7597s
	iters: 300, epoch: 3 | loss: 0.1347458
	speed: 0.0364s/iter; left time: 1460.9404s
	iters: 400, epoch: 3 | loss: 0.0011385
	speed: 0.0297s/iter; left time: 1191.3828s
Epoch: 3 cost time: 15.558384656906128
Epoch: 3, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.092 Vali Acc: 0.967 Test Loss: 0.092 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0083923
	speed: 0.1701s/iter; left time: 6796.8605s
	iters: 200, epoch: 4 | loss: 0.0244175
	speed: 0.0341s/iter; left time: 1361.2148s
	iters: 300, epoch: 4 | loss: 0.0073487
	speed: 0.0437s/iter; left time: 1737.8285s
	iters: 400, epoch: 4 | loss: 0.0360249
	speed: 0.0302s/iter; left time: 1198.6503s
Epoch: 4 cost time: 15.259793758392334
Epoch: 4, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0017245
	speed: 0.1729s/iter; left time: 6837.4975s
	iters: 200, epoch: 5 | loss: 0.0716786
	speed: 0.0334s/iter; left time: 1315.9748s
	iters: 300, epoch: 5 | loss: 0.1221247
	speed: 0.0311s/iter; left time: 1221.9630s
	iters: 400, epoch: 5 | loss: 0.0001745
	speed: 0.0356s/iter; left time: 1395.5233s
Epoch: 5 cost time: 14.28222131729126
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0191429
	speed: 0.1741s/iter; left time: 6812.0386s
	iters: 200, epoch: 6 | loss: 0.0011946
	speed: 0.0355s/iter; left time: 1385.7978s
	iters: 300, epoch: 6 | loss: 0.0311676
	speed: 0.0316s/iter; left time: 1228.5817s
	iters: 400, epoch: 6 | loss: 0.0009848
	speed: 0.0299s/iter; left time: 1159.9267s
Epoch: 6 cost time: 14.595406532287598
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
Validation loss decreased (-0.974078 --> -0.974533).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0008716
	speed: 0.1790s/iter; left time: 6931.0914s
	iters: 200, epoch: 7 | loss: 0.0033932
	speed: 0.0356s/iter; left time: 1374.9887s
	iters: 300, epoch: 7 | loss: 0.0002907
	speed: 0.0371s/iter; left time: 1427.3539s
	iters: 400, epoch: 7 | loss: 0.4680541
	speed: 0.0382s/iter; left time: 1469.6742s
Epoch: 7 cost time: 16.031610250473022
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.174 Vali Acc: 0.964 Test Loss: 0.174 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0884051
	speed: 0.1556s/iter; left time: 5962.1931s
	iters: 200, epoch: 8 | loss: 0.0180450
	speed: 0.0324s/iter; left time: 1236.0942s
	iters: 300, epoch: 8 | loss: 0.0015897
	speed: 0.0402s/iter; left time: 1532.1878s
	iters: 400, epoch: 8 | loss: 0.0001662
	speed: 0.0365s/iter; left time: 1386.7982s
Epoch: 8 cost time: 15.155483722686768
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.092 Vali Acc: 0.972 Test Loss: 0.092 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0001257
	speed: 0.1811s/iter; left time: 6862.1998s
	iters: 200, epoch: 9 | loss: 0.0000527
	speed: 0.0346s/iter; left time: 1306.0593s
	iters: 300, epoch: 9 | loss: 0.0009161
	speed: 0.0384s/iter; left time: 1447.3390s
	iters: 400, epoch: 9 | loss: 0.0002423
	speed: 0.0408s/iter; left time: 1533.5743s
Epoch: 9 cost time: 16.04901385307312
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0057325
	speed: 0.1861s/iter; left time: 6975.4875s
	iters: 200, epoch: 10 | loss: 0.0000043
	speed: 0.0336s/iter; left time: 1254.7276s
	iters: 300, epoch: 10 | loss: 0.0008277
	speed: 0.0314s/iter; left time: 1170.9142s
	iters: 400, epoch: 10 | loss: 0.0001053
	speed: 0.0339s/iter; left time: 1259.0375s
Epoch: 10 cost time: 14.715943336486816
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000012
	speed: 0.1940s/iter; left time: 7190.9941s
	iters: 200, epoch: 11 | loss: 0.0018995
	speed: 0.0333s/iter; left time: 1232.9593s
	iters: 300, epoch: 11 | loss: 0.1354249
	speed: 0.0305s/iter; left time: 1124.8349s
	iters: 400, epoch: 11 | loss: 0.0002593
	speed: 0.0300s/iter; left time: 1103.5604s
Epoch: 11 cost time: 14.083391666412354
Epoch: 11, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0010257
	speed: 0.1771s/iter; left time: 6491.0150s
	iters: 200, epoch: 12 | loss: 0.0049217
	speed: 0.0378s/iter; left time: 1380.8240s
	iters: 300, epoch: 12 | loss: 0.0178103
	speed: 0.0307s/iter; left time: 1117.7823s
	iters: 400, epoch: 12 | loss: 0.0088416
	speed: 0.0350s/iter; left time: 1271.4357s
Epoch: 12 cost time: 14.851486444473267
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000574
	speed: 0.1636s/iter; left time: 5928.1770s
	iters: 200, epoch: 13 | loss: 0.0001022
	speed: 0.0326s/iter; left time: 1177.4774s
	iters: 300, epoch: 13 | loss: 0.0002011
	speed: 0.0370s/iter; left time: 1335.3180s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0386s/iter; left time: 1386.5123s
Epoch: 13 cost time: 15.552060842514038
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000530
	speed: 0.1762s/iter; left time: 6313.5023s
	iters: 200, epoch: 14 | loss: 0.0000057
	speed: 0.0333s/iter; left time: 1189.0511s
	iters: 300, epoch: 14 | loss: 0.0329767
	speed: 0.0315s/iter; left time: 1120.9856s
	iters: 400, epoch: 14 | loss: 0.0012354
	speed: 0.0338s/iter; left time: 1201.7971s
Epoch: 14 cost time: 13.98183012008667
Epoch: 14, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000391
	speed: 0.1756s/iter; left time: 6218.3244s
	iters: 200, epoch: 15 | loss: 0.1567056
	speed: 0.0282s/iter; left time: 996.4554s
	iters: 300, epoch: 15 | loss: 0.0000324
	speed: 0.0262s/iter; left time: 921.8142s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0260s/iter; left time: 912.9887s
Epoch: 15 cost time: 12.251643180847168
Epoch: 15, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000037
	speed: 0.1832s/iter; left time: 6412.6108s
	iters: 200, epoch: 16 | loss: 0.0006760
	speed: 0.0330s/iter; left time: 1153.1449s
	iters: 300, epoch: 16 | loss: 0.2948454
	speed: 0.0316s/iter; left time: 1098.7245s
	iters: 400, epoch: 16 | loss: 0.0214102
	speed: 0.0273s/iter; left time: 949.0616s
Epoch: 16 cost time: 14.229466676712036
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.974533 --> -0.978626).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000214
	speed: 0.1729s/iter; left time: 5982.5279s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 1141.6655s
	iters: 300, epoch: 17 | loss: 0.0327823
	speed: 0.0336s/iter; left time: 1154.3683s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 1217.3648s
Epoch: 17 cost time: 15.071455240249634
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0002580
	speed: 0.1638s/iter; left time: 5599.7619s
	iters: 200, epoch: 18 | loss: 0.0030718
	speed: 0.0317s/iter; left time: 1078.6636s
	iters: 300, epoch: 18 | loss: 0.0000183
	speed: 0.0344s/iter; left time: 1170.4935s
	iters: 400, epoch: 18 | loss: 0.0000027
	speed: 0.0340s/iter; left time: 1153.6049s
Epoch: 18 cost time: 14.878232479095459
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
Validation loss decreased (-0.978626 --> -0.979535).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000697
	speed: 0.1733s/iter; left time: 5850.4450s
	iters: 200, epoch: 19 | loss: 0.0000218
	speed: 0.0329s/iter; left time: 1106.2759s
	iters: 300, epoch: 19 | loss: 0.0028165
	speed: 0.0292s/iter; left time: 980.8318s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0355s/iter; left time: 1188.5558s
Epoch: 19 cost time: 14.067734956741333
Epoch: 19, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.093 Vali Acc: 0.982 Test Loss: 0.093 Test Acc: 0.982
Validation loss decreased (-0.979535 --> -0.982264).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000002
	speed: 0.1873s/iter; left time: 6246.5671s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 1104.2788s
	iters: 300, epoch: 20 | loss: 0.0000902
	speed: 0.0357s/iter; left time: 1183.5705s
	iters: 400, epoch: 20 | loss: 0.0000259
	speed: 0.0346s/iter; left time: 1144.4089s
Epoch: 20 cost time: 14.775628566741943
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.126 Vali Acc: 0.979 Test Loss: 0.126 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000367
	speed: 0.1847s/iter; left time: 6085.4387s
	iters: 200, epoch: 21 | loss: 0.0000215
	speed: 0.0325s/iter; left time: 1068.6501s
	iters: 300, epoch: 21 | loss: 0.0000047
	speed: 0.0285s/iter; left time: 934.3292s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 1170.5475s
Epoch: 21 cost time: 14.852004289627075
Epoch: 21, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1791s/iter; left time: 5824.9388s
	iters: 200, epoch: 22 | loss: 0.0000683
	speed: 0.0355s/iter; left time: 1151.0333s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 995.2224s
	iters: 400, epoch: 22 | loss: 0.3243999
	speed: 0.0362s/iter; left time: 1167.1313s
Epoch: 22 cost time: 15.823752641677856
Epoch: 22, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.226 Vali Acc: 0.970 Test Loss: 0.226 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1368195
	speed: 0.1815s/iter; left time: 5830.0131s
	iters: 200, epoch: 23 | loss: 0.0086755
	speed: 0.0382s/iter; left time: 1223.1794s
	iters: 300, epoch: 23 | loss: 0.0012606
	speed: 0.0349s/iter; left time: 1113.6765s
	iters: 400, epoch: 23 | loss: 0.0000038
	speed: 0.0364s/iter; left time: 1157.5881s
Epoch: 23 cost time: 15.458632946014404
Epoch: 23, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.152 Vali Acc: 0.976 Test Loss: 0.152 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000274
	speed: 0.1753s/iter; left time: 5557.9145s
	iters: 200, epoch: 24 | loss: 0.0039806
	speed: 0.0396s/iter; left time: 1252.8384s
	iters: 300, epoch: 24 | loss: 0.0000274
	speed: 0.0366s/iter; left time: 1154.5066s
	iters: 400, epoch: 24 | loss: 0.1877451
	speed: 0.0336s/iter; left time: 1053.8182s
Epoch: 24 cost time: 15.497170448303223
Epoch: 24, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.217 Vali Acc: 0.968 Test Loss: 0.217 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.3587005
	speed: 0.1854s/iter; left time: 5802.4019s
	iters: 200, epoch: 25 | loss: 0.0008963
	speed: 0.0363s/iter; left time: 1131.2343s
	iters: 300, epoch: 25 | loss: 0.0000203
	speed: 0.0329s/iter; left time: 1021.4679s
	iters: 400, epoch: 25 | loss: 0.0001035
	speed: 0.0313s/iter; left time: 968.7896s
Epoch: 25 cost time: 14.972131967544556
Epoch: 25, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000005
	speed: 0.1846s/iter; left time: 5699.0315s
	iters: 200, epoch: 26 | loss: 0.0483194
	speed: 0.0380s/iter; left time: 1169.6981s
	iters: 300, epoch: 26 | loss: 0.0001978
	speed: 0.0357s/iter; left time: 1095.2315s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.0303s/iter; left time: 926.6944s
Epoch: 26 cost time: 15.809872388839722
Epoch: 26, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1845s/iter; left time: 5620.7448s
	iters: 200, epoch: 27 | loss: 0.0000001
	speed: 0.0364s/iter; left time: 1105.1665s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 1225.4523s
	iters: 400, epoch: 27 | loss: 0.0000001
	speed: 0.0362s/iter; left time: 1090.5101s
Epoch: 27 cost time: 16.9621901512146
Epoch: 27, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.136 Vali Acc: 0.981 Test Loss: 0.136 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000799
	speed: 0.1774s/iter; left time: 5331.2626s
	iters: 200, epoch: 28 | loss: 0.0000238
	speed: 0.0379s/iter; left time: 1134.8733s
	iters: 300, epoch: 28 | loss: 0.0176048
	speed: 0.0349s/iter; left time: 1042.3225s
	iters: 400, epoch: 28 | loss: 0.0000001
	speed: 0.0350s/iter; left time: 1041.1053s
Epoch: 28 cost time: 15.199531555175781
Epoch: 28, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.164 Vali Acc: 0.974 Test Loss: 0.164 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000006
	speed: 0.1907s/iter; left time: 5651.7234s
	iters: 200, epoch: 29 | loss: 0.0000004
	speed: 0.0370s/iter; left time: 1093.1694s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 1120.3058s
	iters: 400, epoch: 29 | loss: 0.0000072
	speed: 0.0338s/iter; left time: 992.5432s
Epoch: 29 cost time: 15.716123342514038
Epoch: 29, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.979 Test Loss: 0.187 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 50986
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2851883
	speed: 0.0875s/iter; left time: 3605.3860s
	iters: 200, epoch: 1 | loss: 0.2643888
	speed: 0.0508s/iter; left time: 2088.2272s
	iters: 300, epoch: 1 | loss: 0.0978646
	speed: 0.0498s/iter; left time: 2042.4247s
	iters: 400, epoch: 1 | loss: 0.0131108
	speed: 0.0398s/iter; left time: 1627.1283s
Epoch: 1 cost time: 23.416560173034668
Epoch: 1, Steps: 413 | Train Loss: 0.389 Vali Loss: 0.301 Vali Acc: 0.936 Test Loss: 0.301 Test Acc: 0.936
Validation loss decreased (inf --> -0.935877).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0032611
	speed: 0.1977s/iter; left time: 8064.6723s
	iters: 200, epoch: 2 | loss: 0.0041247
	speed: 0.0380s/iter; left time: 1546.5678s
	iters: 300, epoch: 2 | loss: 0.0003631
	speed: 0.0396s/iter; left time: 1607.2526s
	iters: 400, epoch: 2 | loss: 0.0110699
	speed: 0.0449s/iter; left time: 1818.1163s
Epoch: 2 cost time: 17.720272541046143
Epoch: 2, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.289 Vali Acc: 0.945 Test Loss: 0.289 Test Acc: 0.945
Validation loss decreased (-0.935877 --> -0.945427).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0473317
	speed: 0.2069s/iter; left time: 8352.1107s
	iters: 200, epoch: 3 | loss: 0.0017838
	speed: 0.0285s/iter; left time: 1148.6989s
	iters: 300, epoch: 3 | loss: 0.0028299
	speed: 0.0374s/iter; left time: 1502.3315s
	iters: 400, epoch: 3 | loss: 0.0246294
	speed: 0.0403s/iter; left time: 1613.5549s
Epoch: 3 cost time: 16.445005178451538
Epoch: 3, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.280 Vali Acc: 0.959 Test Loss: 0.280 Test Acc: 0.959
Validation loss decreased (-0.945427 --> -0.959070).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000167
	speed: 0.2196s/iter; left time: 8777.5721s
	iters: 200, epoch: 4 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 1623.0335s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 1367.7886s
	iters: 400, epoch: 4 | loss: 0.6681542
	speed: 0.0347s/iter; left time: 1378.1558s
Epoch: 4 cost time: 16.336515188217163
Epoch: 4, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.282 Vali Acc: 0.966 Test Loss: 0.282 Test Acc: 0.966
Validation loss decreased (-0.959070 --> -0.965891).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0012734
	speed: 0.1961s/iter; left time: 7755.1673s
	iters: 200, epoch: 5 | loss: 0.0000036
	speed: 0.0295s/iter; left time: 1165.6267s
	iters: 300, epoch: 5 | loss: 0.0010740
	speed: 0.0367s/iter; left time: 1442.2068s
	iters: 400, epoch: 5 | loss: 0.0000004
	speed: 0.0338s/iter; left time: 1326.6635s
Epoch: 5 cost time: 14.935674667358398
Epoch: 5, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.351 Vali Acc: 0.955 Test Loss: 0.351 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000017
	speed: 0.1875s/iter; left time: 7337.4402s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 1518.9216s
	iters: 300, epoch: 6 | loss: 0.0008060
	speed: 0.0346s/iter; left time: 1349.1297s
	iters: 400, epoch: 6 | loss: 0.2624081
	speed: 0.0298s/iter; left time: 1158.9357s
Epoch: 6 cost time: 15.331616163253784
Epoch: 6, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.381 Vali Acc: 0.955 Test Loss: 0.381 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0048229
	speed: 0.1816s/iter; left time: 7032.6380s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0372s/iter; left time: 1436.3408s
	iters: 300, epoch: 7 | loss: 0.2598128
	speed: 0.0452s/iter; left time: 1742.6461s
	iters: 400, epoch: 7 | loss: 0.0000002
	speed: 0.0431s/iter; left time: 1657.1264s
Epoch: 7 cost time: 17.67911958694458
Epoch: 7, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.459 Vali Acc: 0.959 Test Loss: 0.459 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000074
	speed: 0.1853s/iter; left time: 7098.7523s
	iters: 200, epoch: 8 | loss: 0.0000010
	speed: 0.0388s/iter; left time: 1484.4579s
	iters: 300, epoch: 8 | loss: 0.0002758
	speed: 0.0428s/iter; left time: 1632.6872s
	iters: 400, epoch: 8 | loss: 0.0002362
	speed: 0.0383s/iter; left time: 1457.3580s
Epoch: 8 cost time: 16.901861667633057
Epoch: 8, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.445 Vali Acc: 0.960 Test Loss: 0.445 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1906s/iter; left time: 7224.9988s
	iters: 200, epoch: 9 | loss: 0.2511752
	speed: 0.0419s/iter; left time: 1584.1993s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0378s/iter; left time: 1425.6047s
	iters: 400, epoch: 9 | loss: 0.4248964
	speed: 0.0388s/iter; left time: 1457.8315s
Epoch: 9 cost time: 16.8746976852417
Epoch: 9, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.477 Vali Acc: 0.962 Test Loss: 0.477 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0002792
	speed: 0.2049s/iter; left time: 7681.5993s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1462.8867s
	iters: 300, epoch: 10 | loss: 0.0000007
	speed: 0.0383s/iter; left time: 1428.2635s
	iters: 400, epoch: 10 | loss: 0.0000651
	speed: 0.0414s/iter; left time: 1537.8981s
Epoch: 10 cost time: 17.830291748046875
Epoch: 10, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.422 Vali Acc: 0.957 Test Loss: 0.422 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1857s/iter; left time: 6882.2684s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 1499.4509s
	iters: 300, epoch: 11 | loss: 0.9733005
	speed: 0.0384s/iter; left time: 1416.6095s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 1569.3194s
Epoch: 11 cost time: 17.022961616516113
Epoch: 11, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.358 Vali Acc: 0.965 Test Loss: 0.358 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000043
	speed: 0.1909s/iter; left time: 6999.3068s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 1245.2762s
	iters: 300, epoch: 12 | loss: 0.0000051
	speed: 0.0424s/iter; left time: 1546.6179s
	iters: 400, epoch: 12 | loss: 0.0007068
	speed: 0.0384s/iter; left time: 1395.7556s
Epoch: 12 cost time: 17.055006742477417
Epoch: 12, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.734 Vali Acc: 0.955 Test Loss: 0.734 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0001942
	speed: 0.1848s/iter; left time: 6697.3423s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 1357.2332s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0321s/iter; left time: 1156.6736s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0313s/iter; left time: 1125.7936s
Epoch: 13 cost time: 14.543198823928833
Epoch: 13, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.603 Vali Acc: 0.960 Test Loss: 0.603 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1998s/iter; left time: 7159.7226s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 1468.1485s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 1356.0915s
	iters: 400, epoch: 14 | loss: 0.0172232
	speed: 0.0350s/iter; left time: 1244.9967s
Epoch: 14 cost time: 16.902798891067505
Epoch: 14, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.404 Vali Acc: 0.967 Test Loss: 0.404 Test Acc: 0.967
Validation loss decreased (-0.965891 --> -0.966799).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4361385
	speed: 0.1940s/iter; left time: 6871.6500s
	iters: 200, epoch: 15 | loss: 0.0000391
	speed: 0.0399s/iter; left time: 1410.0525s
	iters: 300, epoch: 15 | loss: 0.1874401
	speed: 0.0403s/iter; left time: 1419.3461s
	iters: 400, epoch: 15 | loss: 0.0000041
	speed: 0.0358s/iter; left time: 1257.3434s
Epoch: 15 cost time: 16.936500787734985
Epoch: 15, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.575 Vali Acc: 0.959 Test Loss: 0.575 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1731s/iter; left time: 6059.7685s
	iters: 200, epoch: 16 | loss: 0.0000150
	speed: 0.0356s/iter; left time: 1242.8548s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0386s/iter; left time: 1344.5884s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1492.4991s
Epoch: 16 cost time: 16.45315718650818
Epoch: 16, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.500 Vali Acc: 0.967 Test Loss: 0.500 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1781s/iter; left time: 6159.9317s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1483.4683s
	iters: 300, epoch: 17 | loss: 0.0000842
	speed: 0.0384s/iter; left time: 1320.4624s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0382s/iter; left time: 1309.2464s
Epoch: 17 cost time: 17.033567905426025
Epoch: 17, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.576 Vali Acc: 0.963 Test Loss: 0.576 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1889s/iter; left time: 6457.5353s
	iters: 200, epoch: 18 | loss: 1.1507906
	speed: 0.0349s/iter; left time: 1190.2969s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0372s/iter; left time: 1264.6703s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 1265.0025s
Epoch: 18 cost time: 16.210769414901733
Epoch: 18, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.472 Vali Acc: 0.971 Test Loss: 0.472 Test Acc: 0.971
Validation loss decreased (-0.966799 --> -0.970891).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2124s/iter; left time: 7172.9114s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 1497.9990s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0401s/iter; left time: 1346.3233s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 1398.8756s
Epoch: 19 cost time: 18.20282244682312
Epoch: 19, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.419 Vali Acc: 0.971 Test Loss: 0.419 Test Acc: 0.971
Validation loss decreased (-0.970891 --> -0.970892).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1878s/iter; left time: 6262.2373s
	iters: 200, epoch: 20 | loss: 0.2578917
	speed: 0.0454s/iter; left time: 1508.1719s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 1443.1700s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 1543.1497s
Epoch: 20 cost time: 18.901235818862915
Epoch: 20, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.451 Vali Acc: 0.967 Test Loss: 0.451 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000005
	speed: 0.1994s/iter; left time: 6569.4764s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 1401.4893s
	iters: 300, epoch: 21 | loss: 0.0156993
	speed: 0.0418s/iter; left time: 1369.4493s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0502s/iter; left time: 1638.0930s
Epoch: 21 cost time: 19.293760776519775
Epoch: 21, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.420 Vali Acc: 0.972 Test Loss: 0.420 Test Acc: 0.972
Validation loss decreased (-0.970892 --> -0.971801).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2090s/iter; left time: 6799.6674s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 1212.3285s
	iters: 300, epoch: 22 | loss: 0.0617157
	speed: 0.0325s/iter; left time: 1050.2161s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0363s/iter; left time: 1170.5685s
Epoch: 22 cost time: 16.03440523147583
Epoch: 22, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.435 Vali Acc: 0.971 Test Loss: 0.435 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0004731
	speed: 0.2195s/iter; left time: 7050.0391s
	iters: 200, epoch: 23 | loss: 0.0001813
	speed: 0.0401s/iter; left time: 1284.1758s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 1191.8278s
	iters: 400, epoch: 23 | loss: 0.0000001
	speed: 0.0314s/iter; left time: 997.7005s
Epoch: 23 cost time: 16.404589414596558
Epoch: 23, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.564 Vali Acc: 0.971 Test Loss: 0.564 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1849s/iter; left time: 5861.9172s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1343.2386s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 1084.3327s
	iters: 400, epoch: 24 | loss: 0.0000002
	speed: 0.0359s/iter; left time: 1127.2535s
Epoch: 24 cost time: 16.285667419433594
Epoch: 24, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.622 Vali Acc: 0.962 Test Loss: 0.622 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1823s/iter; left time: 5702.6413s
	iters: 200, epoch: 25 | loss: 0.2048291
	speed: 0.0330s/iter; left time: 1029.4436s
	iters: 300, epoch: 25 | loss: 0.8739870
	speed: 0.0412s/iter; left time: 1279.4431s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 1168.7724s
Epoch: 25 cost time: 16.132439851760864
Epoch: 25, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.464 Vali Acc: 0.971 Test Loss: 0.464 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1789s/iter; left time: 5522.3897s
	iters: 200, epoch: 26 | loss: 0.0000002
	speed: 0.0390s/iter; left time: 1201.3270s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 1102.5745s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 1351.2137s
Epoch: 26 cost time: 16.91356110572815
Epoch: 26, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.552 Vali Acc: 0.966 Test Loss: 0.552 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2012s/iter; left time: 6130.5069s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0314s/iter; left time: 952.8494s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0340s/iter; left time: 1029.4608s
	iters: 400, epoch: 27 | loss: 0.0003781
	speed: 0.0371s/iter; left time: 1119.7022s
Epoch: 27 cost time: 15.586236715316772
Epoch: 27, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.624 Vali Acc: 0.971 Test Loss: 0.624 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1992s/iter; left time: 5984.6603s
	iters: 200, epoch: 28 | loss: 0.0262857
	speed: 0.0402s/iter; left time: 1203.2060s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0364s/iter; left time: 1087.4612s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0429s/iter; left time: 1275.5995s
Epoch: 28 cost time: 17.154662132263184
Epoch: 28, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.460 Vali Acc: 0.975 Test Loss: 0.460 Test Acc: 0.975
Validation loss decreased (-0.971801 --> -0.974529).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0367726
	speed: 0.2069s/iter; left time: 6133.2042s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 1118.2260s
	iters: 300, epoch: 29 | loss: 0.1551196
	speed: 0.0417s/iter; left time: 1226.2930s
	iters: 400, epoch: 29 | loss: 0.0000003
	speed: 0.0336s/iter; left time: 986.0555s
Epoch: 29 cost time: 16.846399307250977
Epoch: 29, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.710 Vali Acc: 0.967 Test Loss: 0.710 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.0707452
	speed: 0.2171s/iter; left time: 6344.1402s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0386s/iter; left time: 1124.8037s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0364s/iter; left time: 1056.2240s
	iters: 400, epoch: 30 | loss: 1.0181236
	speed: 0.0348s/iter; left time: 1005.2001s
Epoch: 30 cost time: 17.258689880371094
Epoch: 30, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.428 Vali Acc: 0.975 Test Loss: 0.428 Test Acc: 0.975
Validation loss decreased (-0.974529 --> -0.974984).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1880s/iter; left time: 5415.2661s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 1088.7278s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 1178.9746s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 1097.2215s
Epoch: 31 cost time: 16.87273120880127
Epoch: 31, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.588 Vali Acc: 0.970 Test Loss: 0.588 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1962s/iter; left time: 5570.8798s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 1041.2821s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0339s/iter; left time: 957.2664s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 923.8486s
Epoch: 32 cost time: 15.173936128616333
Epoch: 32, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.661 Vali Acc: 0.966 Test Loss: 0.661 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0007944
	speed: 0.1855s/iter; left time: 5192.2819s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 1024.1229s
	iters: 300, epoch: 33 | loss: 0.0000001
	speed: 0.0379s/iter; left time: 1053.0338s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 1024.6566s
Epoch: 33 cost time: 15.947788953781128
Epoch: 33, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.531 Vali Acc: 0.971 Test Loss: 0.531 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1780s/iter; left time: 4906.5688s
	iters: 200, epoch: 34 | loss: 0.0000427
	speed: 0.0397s/iter; left time: 1090.3547s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0315s/iter; left time: 863.1805s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0312s/iter; left time: 849.5857s
Epoch: 34 cost time: 14.830476760864258
Epoch: 34, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.670 Vali Acc: 0.967 Test Loss: 0.670 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1807s/iter; left time: 4906.4650s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 1024.8748s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0390s/iter; left time: 1051.4655s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0323s/iter; left time: 866.4590s
Epoch: 35 cost time: 16.033193111419678
Epoch: 35, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.549 Vali Acc: 0.968 Test Loss: 0.549 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.1939s/iter; left time: 5186.3156s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0304s/iter; left time: 808.7168s
	iters: 300, epoch: 36 | loss: 0.0000215
	speed: 0.0309s/iter; left time: 819.4007s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 1005.8490s
Epoch: 36 cost time: 15.010677814483643
Epoch: 36, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.762 Vali Acc: 0.963 Test Loss: 0.762 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1969s/iter; left time: 5184.2503s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0360s/iter; left time: 943.4353s
	iters: 300, epoch: 37 | loss: 0.5119990
	speed: 0.0425s/iter; left time: 1109.7845s
	iters: 400, epoch: 37 | loss: 0.0000009
	speed: 0.0395s/iter; left time: 1027.8266s
Epoch: 37 cost time: 16.844412088394165
Epoch: 37, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.617 Vali Acc: 0.968 Test Loss: 0.617 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2095s/iter; left time: 5429.6838s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1198.1438s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0424s/iter; left time: 1089.5409s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0404s/iter; left time: 1035.9448s
Epoch: 38 cost time: 18.482482194900513
Epoch: 38, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.681 Vali Acc: 0.969 Test Loss: 0.681 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0637900
	speed: 0.2093s/iter; left time: 5338.6308s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 1041.5644s
	iters: 300, epoch: 39 | loss: 0.0002773
	speed: 0.0439s/iter; left time: 1111.8360s
	iters: 400, epoch: 39 | loss: 0.0000001
	speed: 0.0411s/iter; left time: 1035.5080s
Epoch: 39 cost time: 18.048609972000122
Epoch: 39, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.560 Vali Acc: 0.971 Test Loss: 0.560 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.2017s/iter; left time: 5061.9459s
	iters: 200, epoch: 40 | loss: 0.0000001
	speed: 0.0352s/iter; left time: 879.7980s
	iters: 300, epoch: 40 | loss: 0.0000104
	speed: 0.0411s/iter; left time: 1022.5027s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 934.5458s
Epoch: 40 cost time: 16.640235900878906
Epoch: 40, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.566 Vali Acc: 0.972 Test Loss: 0.566 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9749886311959982
model parameter : 208394
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1848758
	speed: 0.0714s/iter; left time: 2939.8710s
	iters: 200, epoch: 1 | loss: 0.4176452
	speed: 0.0403s/iter; left time: 1655.5488s
	iters: 300, epoch: 1 | loss: 0.0147467
	speed: 0.0391s/iter; left time: 1602.2620s
	iters: 400, epoch: 1 | loss: 0.0969289
	speed: 0.0385s/iter; left time: 1575.7899s
Epoch: 1 cost time: 19.620704174041748
Epoch: 1, Steps: 413 | Train Loss: 0.354 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
Validation loss decreased (inf --> -0.924963).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1062088
	speed: 0.1989s/iter; left time: 8112.4130s
	iters: 200, epoch: 2 | loss: 0.0153202
	speed: 0.0383s/iter; left time: 1558.5404s
	iters: 300, epoch: 2 | loss: 0.0034654
	speed: 0.0378s/iter; left time: 1535.2107s
	iters: 400, epoch: 2 | loss: 0.0008069
	speed: 0.0380s/iter; left time: 1539.1148s
Epoch: 2 cost time: 16.052298069000244
Epoch: 2, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.223 Vali Acc: 0.945 Test Loss: 0.223 Test Acc: 0.945
Validation loss decreased (-0.924963 --> -0.945428).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0088335
	speed: 0.1865s/iter; left time: 7531.0264s
	iters: 200, epoch: 3 | loss: 0.1177691
	speed: 0.0372s/iter; left time: 1497.2495s
	iters: 300, epoch: 3 | loss: 0.0000494
	speed: 0.0401s/iter; left time: 1611.4155s
	iters: 400, epoch: 3 | loss: 0.0000366
	speed: 0.0371s/iter; left time: 1485.8246s
Epoch: 3 cost time: 16.39400625228882
Epoch: 3, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.945428 --> -0.969530).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0099164
	speed: 0.1950s/iter; left time: 7791.0778s
	iters: 200, epoch: 4 | loss: 0.0080087
	speed: 0.0315s/iter; left time: 1254.3020s
	iters: 300, epoch: 4 | loss: 0.0005229
	speed: 0.0321s/iter; left time: 1275.1919s
	iters: 400, epoch: 4 | loss: 0.4578629
	speed: 0.0379s/iter; left time: 1501.4172s
Epoch: 4 cost time: 14.91648817062378
Epoch: 4, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.233 Vali Acc: 0.962 Test Loss: 0.233 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2012027
	speed: 0.2004s/iter; left time: 7927.5410s
	iters: 200, epoch: 5 | loss: 0.0000041
	speed: 0.0313s/iter; left time: 1235.3116s
	iters: 300, epoch: 5 | loss: 0.0000115
	speed: 0.0318s/iter; left time: 1252.9898s
	iters: 400, epoch: 5 | loss: 0.0000021
	speed: 0.0270s/iter; left time: 1059.5215s
Epoch: 5 cost time: 14.752321720123291
Epoch: 5, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
Validation loss decreased (-0.969530 --> -0.972259).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000127
	speed: 0.1863s/iter; left time: 7291.5166s
	iters: 200, epoch: 6 | loss: 0.0025171
	speed: 0.0505s/iter; left time: 1970.1997s
	iters: 300, epoch: 6 | loss: 0.0001334
	speed: 0.0509s/iter; left time: 1982.1107s
	iters: 400, epoch: 6 | loss: 0.0000151
	speed: 0.0534s/iter; left time: 2072.2539s
Epoch: 6 cost time: 21.229342699050903
Epoch: 6, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.197 Vali Acc: 0.966 Test Loss: 0.197 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0074046
	speed: 0.2135s/iter; left time: 8269.2784s
	iters: 200, epoch: 7 | loss: 0.0000023
	speed: 0.0408s/iter; left time: 1576.2498s
	iters: 300, epoch: 7 | loss: 0.3018220
	speed: 0.0408s/iter; left time: 1573.1276s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1883.7689s
Epoch: 7 cost time: 19.170532703399658
Epoch: 7, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.372 Vali Acc: 0.960 Test Loss: 0.372 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0739743
	speed: 0.2232s/iter; left time: 8549.5565s
	iters: 200, epoch: 8 | loss: 0.0000002
	speed: 0.0389s/iter; left time: 1485.3723s
	iters: 300, epoch: 8 | loss: 0.0000006
	speed: 0.0451s/iter; left time: 1719.5816s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 1447.8597s
Epoch: 8 cost time: 18.12279176712036
Epoch: 8, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.296 Vali Acc: 0.966 Test Loss: 0.296 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2170s/iter; left time: 8224.2363s
	iters: 200, epoch: 9 | loss: 0.0000415
	speed: 0.0455s/iter; left time: 1719.2240s
	iters: 300, epoch: 9 | loss: 0.0045300
	speed: 0.0441s/iter; left time: 1662.9630s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0382s/iter; left time: 1435.9521s
Epoch: 9 cost time: 19.00548791885376
Epoch: 9, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.292 Vali Acc: 0.968 Test Loss: 0.292 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6729176
	speed: 0.2135s/iter; left time: 8003.4130s
	iters: 200, epoch: 10 | loss: 0.0000005
	speed: 0.0445s/iter; left time: 1664.2915s
	iters: 300, epoch: 10 | loss: 0.0000033
	speed: 0.0415s/iter; left time: 1548.4765s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 1329.4827s
Epoch: 10 cost time: 18.16594648361206
Epoch: 10, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.407 Vali Acc: 0.955 Test Loss: 0.407 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000143
	speed: 0.1952s/iter; left time: 7237.6599s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0378s/iter; left time: 1397.0371s
	iters: 300, epoch: 11 | loss: 0.0000165
	speed: 0.0445s/iter; left time: 1642.5519s
	iters: 400, epoch: 11 | loss: 0.0000092
	speed: 0.0376s/iter; left time: 1383.5759s
Epoch: 11 cost time: 17.275046825408936
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.287 Vali Acc: 0.967 Test Loss: 0.287 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0856974
	speed: 0.1792s/iter; left time: 6568.4185s
	iters: 200, epoch: 12 | loss: 0.0000280
	speed: 0.0421s/iter; left time: 1540.6595s
	iters: 300, epoch: 12 | loss: 0.0010740
	speed: 0.0421s/iter; left time: 1534.0441s
	iters: 400, epoch: 12 | loss: 0.0000002
	speed: 0.0400s/iter; left time: 1452.8220s
Epoch: 12 cost time: 17.365023851394653
Epoch: 12, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.296 Vali Acc: 0.969 Test Loss: 0.296 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0007279
	speed: 0.1878s/iter; left time: 6805.4677s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0337s/iter; left time: 1218.2657s
	iters: 300, epoch: 13 | loss: 0.0031476
	speed: 0.0459s/iter; left time: 1655.6358s
	iters: 400, epoch: 13 | loss: 0.0000054
	speed: 0.0321s/iter; left time: 1153.4077s
Epoch: 13 cost time: 15.678512811660767
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.331 Vali Acc: 0.972 Test Loss: 0.331 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000024
	speed: 0.1831s/iter; left time: 6560.7264s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 1199.5941s
	iters: 300, epoch: 14 | loss: 0.0002391
	speed: 0.0397s/iter; left time: 1413.2897s
	iters: 400, epoch: 14 | loss: 0.2384488
	speed: 0.0446s/iter; left time: 1582.9865s
Epoch: 14 cost time: 16.8443820476532
Epoch: 14, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.256 Vali Acc: 0.974 Test Loss: 0.256 Test Acc: 0.974
Validation loss decreased (-0.972259 --> -0.974077).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000003
	speed: 0.2074s/iter; left time: 7345.1061s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0463s/iter; left time: 1635.9419s
	iters: 300, epoch: 15 | loss: 0.0000008
	speed: 0.0447s/iter; left time: 1575.8324s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1705.0175s
Epoch: 15 cost time: 20.49628257751465
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.297 Vali Acc: 0.970 Test Loss: 0.297 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2055s/iter; left time: 7192.5554s
	iters: 200, epoch: 16 | loss: 0.0000016
	speed: 0.0445s/iter; left time: 1552.3512s
	iters: 300, epoch: 16 | loss: 0.0000007
	speed: 0.0443s/iter; left time: 1543.3385s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0499s/iter; left time: 1730.4068s
Epoch: 16 cost time: 19.635941743850708
Epoch: 16, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.409 Vali Acc: 0.968 Test Loss: 0.409 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000434
	speed: 0.2075s/iter; left time: 7179.2286s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0348s/iter; left time: 1200.0798s
	iters: 300, epoch: 17 | loss: 0.5399078
	speed: 0.0382s/iter; left time: 1312.8412s
	iters: 400, epoch: 17 | loss: 0.0673898
	speed: 0.0394s/iter; left time: 1351.1764s
Epoch: 17 cost time: 16.59950351715088
Epoch: 17, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.309 Vali Acc: 0.971 Test Loss: 0.309 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2096s/iter; left time: 7164.9935s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0416s/iter; left time: 1418.7621s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 1292.8157s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0390s/iter; left time: 1321.4654s
Epoch: 18 cost time: 17.31084132194519
Epoch: 18, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.443 Vali Acc: 0.970 Test Loss: 0.443 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0003067
	speed: 0.1990s/iter; left time: 6720.7753s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 1236.1203s
	iters: 300, epoch: 19 | loss: 0.0000465
	speed: 0.0396s/iter; left time: 1328.7634s
	iters: 400, epoch: 19 | loss: 0.0000035
	speed: 0.0398s/iter; left time: 1331.9884s
Epoch: 19 cost time: 16.04211139678955
Epoch: 19, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.310 Vali Acc: 0.972 Test Loss: 0.310 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.3900705
	speed: 0.2103s/iter; left time: 7015.8810s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 1279.3875s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1319.7150s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 1252.5779s
Epoch: 20 cost time: 16.775104761123657
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.341 Vali Acc: 0.973 Test Loss: 0.341 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0002388
	speed: 0.2040s/iter; left time: 6720.1601s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 1164.5481s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0401s/iter; left time: 1313.0047s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0463s/iter; left time: 1512.1243s
Epoch: 21 cost time: 17.882722854614258
Epoch: 21, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.369 Vali Acc: 0.970 Test Loss: 0.369 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000006
	speed: 0.2095s/iter; left time: 6814.5629s
	iters: 200, epoch: 22 | loss: 0.0000090
	speed: 0.0335s/iter; left time: 1087.3554s
	iters: 300, epoch: 22 | loss: 0.0000151
	speed: 0.0305s/iter; left time: 985.4208s
	iters: 400, epoch: 22 | loss: 0.0001070
	speed: 0.0424s/iter; left time: 1365.5717s
Epoch: 22 cost time: 15.713228940963745
Epoch: 22, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.436 Vali Acc: 0.969 Test Loss: 0.436 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1820s/iter; left time: 5845.7806s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 1245.7487s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 1164.4460s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 1136.0241s
Epoch: 23 cost time: 15.25813364982605
Epoch: 23, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.381 Vali Acc: 0.971 Test Loss: 0.381 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1917s/iter; left time: 6077.9128s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1447.5244s
	iters: 300, epoch: 24 | loss: 0.0005512
	speed: 0.0433s/iter; left time: 1362.8565s
	iters: 400, epoch: 24 | loss: 0.0000001
	speed: 0.0412s/iter; left time: 1294.8515s
Epoch: 24 cost time: 18.499236345291138
Epoch: 24, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.580 Vali Acc: 0.966 Test Loss: 0.580 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9740791268758526
model parameter : 141898
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5670716
	speed: 0.0772s/iter; left time: 3181.9027s
	iters: 200, epoch: 1 | loss: 0.2419948
	speed: 0.0364s/iter; left time: 1496.3341s
	iters: 300, epoch: 1 | loss: 0.0754241
	speed: 0.0318s/iter; left time: 1304.7186s
	iters: 400, epoch: 1 | loss: 0.0110243
	speed: 0.0384s/iter; left time: 1571.5614s
Epoch: 1 cost time: 19.030012845993042
Epoch: 1, Steps: 413 | Train Loss: 0.396 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
Validation loss decreased (inf --> -0.956797).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1948265
	speed: 0.1823s/iter; left time: 7435.9984s
	iters: 200, epoch: 2 | loss: 0.0355408
	speed: 0.0404s/iter; left time: 1643.4523s
	iters: 300, epoch: 2 | loss: 0.8086902
	speed: 0.0375s/iter; left time: 1522.5195s
	iters: 400, epoch: 2 | loss: 0.2509922
	speed: 0.0400s/iter; left time: 1618.8905s
Epoch: 2 cost time: 16.892704486846924
Epoch: 2, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.244 Vali Acc: 0.936 Test Loss: 0.244 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4969610
	speed: 0.1729s/iter; left time: 6982.0600s
	iters: 200, epoch: 3 | loss: 0.1501765
	speed: 0.0314s/iter; left time: 1266.1432s
	iters: 300, epoch: 3 | loss: 0.0068529
	speed: 0.0337s/iter; left time: 1353.2658s
	iters: 400, epoch: 3 | loss: 0.0006336
	speed: 0.0330s/iter; left time: 1321.2419s
Epoch: 3 cost time: 14.266536235809326
Epoch: 3, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
Validation loss decreased (-0.956797 --> -0.960890).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0001198
	speed: 0.1807s/iter; left time: 7222.1921s
	iters: 200, epoch: 4 | loss: 0.0002288
	speed: 0.0327s/iter; left time: 1305.2507s
	iters: 300, epoch: 4 | loss: 0.0050968
	speed: 0.0323s/iter; left time: 1285.0130s
	iters: 400, epoch: 4 | loss: 0.0000140
	speed: 0.0283s/iter; left time: 1122.0213s
Epoch: 4 cost time: 13.877380609512329
Epoch: 4, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.251 Vali Acc: 0.956 Test Loss: 0.251 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0066928
	speed: 0.1608s/iter; left time: 6357.8243s
	iters: 200, epoch: 5 | loss: 0.3070072
	speed: 0.0329s/iter; left time: 1299.2698s
	iters: 300, epoch: 5 | loss: 0.0000060
	speed: 0.0343s/iter; left time: 1350.7575s
	iters: 400, epoch: 5 | loss: 0.0399176
	speed: 0.0257s/iter; left time: 1007.1441s
Epoch: 5 cost time: 13.52983808517456
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.200 Vali Acc: 0.963 Test Loss: 0.200 Test Acc: 0.963
Validation loss decreased (-0.960890 --> -0.963163).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1637122
	speed: 0.1647s/iter; left time: 6446.7933s
	iters: 200, epoch: 6 | loss: 0.0854975
	speed: 0.0337s/iter; left time: 1316.6993s
	iters: 300, epoch: 6 | loss: 0.2899376
	speed: 0.0360s/iter; left time: 1403.4092s
	iters: 400, epoch: 6 | loss: 0.0026965
	speed: 0.0349s/iter; left time: 1354.3778s
Epoch: 6 cost time: 15.331988334655762
Epoch: 6, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.963163 --> -0.970440).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0278115
	speed: 0.1604s/iter; left time: 6210.9819s
	iters: 200, epoch: 7 | loss: 0.0000276
	speed: 0.0379s/iter; left time: 1465.4861s
	iters: 300, epoch: 7 | loss: 0.3652306
	speed: 0.0338s/iter; left time: 1300.7728s
	iters: 400, epoch: 7 | loss: 0.0000165
	speed: 0.0361s/iter; left time: 1386.7665s
Epoch: 7 cost time: 15.118387699127197
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.216 Vali Acc: 0.967 Test Loss: 0.216 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0531983
	speed: 0.1742s/iter; left time: 6673.8679s
	iters: 200, epoch: 8 | loss: 0.0001702
	speed: 0.0322s/iter; left time: 1229.0883s
	iters: 300, epoch: 8 | loss: 0.0000613
	speed: 0.0323s/iter; left time: 1232.1535s
	iters: 400, epoch: 8 | loss: 0.0000120
	speed: 0.0354s/iter; left time: 1346.1997s
Epoch: 8 cost time: 14.672949075698853
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
Validation loss decreased (-0.970440 --> -0.975897).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000984
	speed: 0.1849s/iter; left time: 7007.6165s
	iters: 200, epoch: 9 | loss: 0.0011234
	speed: 0.0384s/iter; left time: 1451.1826s
	iters: 300, epoch: 9 | loss: 0.1711467
	speed: 0.0405s/iter; left time: 1526.6827s
	iters: 400, epoch: 9 | loss: 0.0000328
	speed: 0.0376s/iter; left time: 1412.6910s
Epoch: 9 cost time: 17.11440420150757
Epoch: 9, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0023986
	speed: 0.1881s/iter; left time: 7052.3694s
	iters: 200, epoch: 10 | loss: 0.0000536
	speed: 0.0417s/iter; left time: 1559.4679s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 1710.5520s
	iters: 400, epoch: 10 | loss: 0.0001215
	speed: 0.0417s/iter; left time: 1551.3746s
Epoch: 10 cost time: 18.368446826934814
Epoch: 10, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3000637
	speed: 0.2007s/iter; left time: 7439.0945s
	iters: 200, epoch: 11 | loss: 0.0000002
	speed: 0.0386s/iter; left time: 1428.3065s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0424s/iter; left time: 1561.8963s
	iters: 400, epoch: 11 | loss: 0.0001180
	speed: 0.0441s/iter; left time: 1621.5900s
Epoch: 11 cost time: 18.090460538864136
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.262 Vali Acc: 0.970 Test Loss: 0.262 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0030054
	speed: 0.2155s/iter; left time: 7899.1858s
	iters: 200, epoch: 12 | loss: 0.0000003
	speed: 0.0412s/iter; left time: 1507.0483s
	iters: 300, epoch: 12 | loss: 0.1382243
	speed: 0.0377s/iter; left time: 1373.4944s
	iters: 400, epoch: 12 | loss: 0.0018266
	speed: 0.0377s/iter; left time: 1371.9414s
Epoch: 12 cost time: 16.741708755493164
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.218 Vali Acc: 0.974 Test Loss: 0.218 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1953s/iter; left time: 7078.3394s
	iters: 200, epoch: 13 | loss: 0.0349577
	speed: 0.0320s/iter; left time: 1156.1158s
	iters: 300, epoch: 13 | loss: 0.0000003
	speed: 0.0377s/iter; left time: 1360.2978s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 1231.0581s
Epoch: 13 cost time: 15.223325729370117
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.259 Vali Acc: 0.973 Test Loss: 0.259 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0066951
	speed: 0.1952s/iter; left time: 6995.4566s
	iters: 200, epoch: 14 | loss: 0.0111283
	speed: 0.0363s/iter; left time: 1296.6972s
	iters: 300, epoch: 14 | loss: 0.0000122
	speed: 0.0323s/iter; left time: 1151.9597s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0349s/iter; left time: 1238.6383s
Epoch: 14 cost time: 15.350359916687012
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.334 Vali Acc: 0.970 Test Loss: 0.334 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0006825
	speed: 0.1851s/iter; left time: 6557.2547s
	iters: 200, epoch: 15 | loss: 0.0000048
	speed: 0.0438s/iter; left time: 1548.2963s
	iters: 300, epoch: 15 | loss: 0.0064202
	speed: 0.0398s/iter; left time: 1400.9796s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 1237.3419s
Epoch: 15 cost time: 17.2557852268219
Epoch: 15, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.357 Vali Acc: 0.969 Test Loss: 0.357 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000006
	speed: 0.1732s/iter; left time: 6062.5102s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0400s/iter; left time: 1397.3048s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 1244.3928s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0296s/iter; left time: 1026.1583s
Epoch: 16 cost time: 14.975207328796387
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.978 Test Loss: 0.206 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.977715).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000017
	speed: 0.1714s/iter; left time: 5928.0351s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0328s/iter; left time: 1132.4237s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0311s/iter; left time: 1068.1897s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 1187.1101s
Epoch: 17 cost time: 14.414615154266357
Epoch: 17, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.348 Vali Acc: 0.970 Test Loss: 0.348 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1921s/iter; left time: 6565.4539s
	iters: 200, epoch: 18 | loss: 0.0000003
	speed: 0.0386s/iter; left time: 1315.5137s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0303s/iter; left time: 1028.6390s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0284s/iter; left time: 963.6830s
Epoch: 18 cost time: 15.10421371459961
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.268 Vali Acc: 0.973 Test Loss: 0.268 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1844s/iter; left time: 6227.4186s
	iters: 200, epoch: 19 | loss: 0.1582172
	speed: 0.0403s/iter; left time: 1357.5851s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 1349.2461s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 1187.3371s
Epoch: 19 cost time: 16.61697268486023
Epoch: 19, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.374 Vali Acc: 0.967 Test Loss: 0.374 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0009226
	speed: 0.1764s/iter; left time: 5885.0719s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 1338.7431s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 1273.3622s
	iters: 400, epoch: 20 | loss: 0.0025841
	speed: 0.0327s/iter; left time: 1080.0133s
Epoch: 20 cost time: 15.825867414474487
Epoch: 20, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.461 Vali Acc: 0.962 Test Loss: 0.461 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000229
	speed: 0.1891s/iter; left time: 6228.3662s
	iters: 200, epoch: 21 | loss: 0.0148481
	speed: 0.0413s/iter; left time: 1356.3447s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0386s/iter; left time: 1264.2894s
	iters: 400, epoch: 21 | loss: 0.0708307
	speed: 0.0378s/iter; left time: 1232.7163s
Epoch: 21 cost time: 17.020676612854004
Epoch: 21, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.406 Vali Acc: 0.965 Test Loss: 0.406 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2076s/iter; left time: 6752.1538s
	iters: 200, epoch: 22 | loss: 0.0000751
	speed: 0.0477s/iter; left time: 1546.2676s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 1350.6241s
	iters: 400, epoch: 22 | loss: 0.0000002
	speed: 0.0419s/iter; left time: 1351.3215s
Epoch: 22 cost time: 19.59956407546997
Epoch: 22, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.371 Vali Acc: 0.968 Test Loss: 0.371 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1892s/iter; left time: 6075.9982s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 1392.2667s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 1183.6439s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 1142.6917s
Epoch: 23 cost time: 16.620659112930298
Epoch: 23, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.396 Vali Acc: 0.971 Test Loss: 0.396 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1855s/iter; left time: 5881.3370s
	iters: 200, epoch: 24 | loss: 0.0000302
	speed: 0.0387s/iter; left time: 1222.8386s
	iters: 300, epoch: 24 | loss: 0.0000002
	speed: 0.0338s/iter; left time: 1065.0786s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 1178.0878s
Epoch: 24 cost time: 16.110193014144897
Epoch: 24, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.291 Vali Acc: 0.975 Test Loss: 0.291 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1697s/iter; left time: 5309.9929s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0305s/iter; left time: 950.4384s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0318s/iter; left time: 988.5408s
	iters: 400, epoch: 25 | loss: 0.0002645
	speed: 0.0308s/iter; left time: 955.1827s
Epoch: 25 cost time: 14.194997549057007
Epoch: 25, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.349 Vali Acc: 0.968 Test Loss: 0.349 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000008
	speed: 0.1715s/iter; left time: 5296.3586s
	iters: 200, epoch: 26 | loss: 0.0011949
	speed: 0.0380s/iter; left time: 1169.7279s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0313s/iter; left time: 960.9802s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0343s/iter; left time: 1048.5781s
Epoch: 26 cost time: 14.887290000915527
Epoch: 26, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.282 Vali Acc: 0.973 Test Loss: 0.282 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 108682
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0500555
	speed: 0.0746s/iter; left time: 3074.3781s
	iters: 200, epoch: 1 | loss: 0.1162455
	speed: 0.0309s/iter; left time: 1271.1238s
	iters: 300, epoch: 1 | loss: 0.8421856
	speed: 0.0309s/iter; left time: 1266.8060s
	iters: 400, epoch: 1 | loss: 0.3676240
	speed: 0.0321s/iter; left time: 1314.5573s
Epoch: 1 cost time: 17.439707040786743
Epoch: 1, Steps: 413 | Train Loss: 0.429 Vali Loss: 0.165 Vali Acc: 0.940 Test Loss: 0.165 Test Acc: 0.940
Validation loss decreased (inf --> -0.939971).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0288454
	speed: 0.1779s/iter; left time: 7256.6551s
	iters: 200, epoch: 2 | loss: 0.7576869
	speed: 0.0406s/iter; left time: 1651.4362s
	iters: 300, epoch: 2 | loss: 0.0014792
	speed: 0.0356s/iter; left time: 1446.9582s
	iters: 400, epoch: 2 | loss: 0.0953786
	speed: 0.0370s/iter; left time: 1499.7498s
Epoch: 2 cost time: 15.90790843963623
Epoch: 2, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.939971 --> -0.964983).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0117265
	speed: 0.1836s/iter; left time: 7411.9198s
	iters: 200, epoch: 3 | loss: 0.0031632
	speed: 0.0396s/iter; left time: 1595.2553s
	iters: 300, epoch: 3 | loss: 0.0015057
	speed: 0.0332s/iter; left time: 1332.6592s
	iters: 400, epoch: 3 | loss: 0.0148785
	speed: 0.0361s/iter; left time: 1445.5138s
Epoch: 3 cost time: 16.036983251571655
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0072625
	speed: 0.1780s/iter; left time: 7111.4886s
	iters: 200, epoch: 4 | loss: 0.0217868
	speed: 0.0320s/iter; left time: 1277.2759s
	iters: 300, epoch: 4 | loss: 0.5174053
	speed: 0.0374s/iter; left time: 1488.4857s
	iters: 400, epoch: 4 | loss: 0.0014575
	speed: 0.0345s/iter; left time: 1368.4019s
Epoch: 4 cost time: 15.142128229141235
Epoch: 4, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0001264
	speed: 0.1893s/iter; left time: 7484.7254s
	iters: 200, epoch: 5 | loss: 0.0257819
	speed: 0.0427s/iter; left time: 1684.2112s
	iters: 300, epoch: 5 | loss: 0.0827952
	speed: 0.0372s/iter; left time: 1463.4257s
	iters: 400, epoch: 5 | loss: 0.0065400
	speed: 0.0328s/iter; left time: 1287.9010s
Epoch: 5 cost time: 16.085778951644897
Epoch: 5, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.964983 --> -0.974987).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0967980
	speed: 0.1823s/iter; left time: 7134.7122s
	iters: 200, epoch: 6 | loss: 0.0000492
	speed: 0.0401s/iter; left time: 1565.1525s
	iters: 300, epoch: 6 | loss: 0.0002783
	speed: 0.0362s/iter; left time: 1411.2266s
	iters: 400, epoch: 6 | loss: 0.0671534
	speed: 0.0333s/iter; left time: 1292.0300s
Epoch: 6 cost time: 15.638129711151123
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0007597
	speed: 0.1821s/iter; left time: 7051.7675s
	iters: 200, epoch: 7 | loss: 0.1616101
	speed: 0.0301s/iter; left time: 1163.0514s
	iters: 300, epoch: 7 | loss: 0.2491085
	speed: 0.0317s/iter; left time: 1219.7653s
	iters: 400, epoch: 7 | loss: 0.0000080
	speed: 0.0320s/iter; left time: 1229.8763s
Epoch: 7 cost time: 13.918880701065063
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.166 Vali Acc: 0.971 Test Loss: 0.166 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000002
	speed: 0.1859s/iter; left time: 7120.4912s
	iters: 200, epoch: 8 | loss: 0.0007958
	speed: 0.0292s/iter; left time: 1115.9775s
	iters: 300, epoch: 8 | loss: 0.0002039
	speed: 0.0305s/iter; left time: 1161.5601s
	iters: 400, epoch: 8 | loss: 0.0263850
	speed: 0.0312s/iter; left time: 1185.6867s
Epoch: 8 cost time: 13.413590431213379
Epoch: 8, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.211 Vali Acc: 0.971 Test Loss: 0.211 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0006100
	speed: 0.1867s/iter; left time: 7073.5556s
	iters: 200, epoch: 9 | loss: 0.0009416
	speed: 0.0322s/iter; left time: 1215.2624s
	iters: 300, epoch: 9 | loss: 0.0093656
	speed: 0.0334s/iter; left time: 1259.2837s
	iters: 400, epoch: 9 | loss: 0.0295170
	speed: 0.0316s/iter; left time: 1186.2418s
Epoch: 9 cost time: 14.61946415901184
Epoch: 9, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.287 Vali Acc: 0.961 Test Loss: 0.287 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1549291
	speed: 0.1663s/iter; left time: 6234.1936s
	iters: 200, epoch: 10 | loss: 0.0029691
	speed: 0.0317s/iter; left time: 1183.4400s
	iters: 300, epoch: 10 | loss: 0.0048904
	speed: 0.0331s/iter; left time: 1234.4225s
	iters: 400, epoch: 10 | loss: 0.0000034
	speed: 0.0311s/iter; left time: 1154.6232s
Epoch: 10 cost time: 14.028182744979858
Epoch: 10, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
Validation loss decreased (-0.974987 --> -0.975442).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000005
	speed: 0.1757s/iter; left time: 6513.4749s
	iters: 200, epoch: 11 | loss: 0.0007030
	speed: 0.0394s/iter; left time: 1457.5057s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0336s/iter; left time: 1239.6285s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0397s/iter; left time: 1458.6825s
Epoch: 11 cost time: 16.31135606765747
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0003094
	speed: 0.1737s/iter; left time: 6367.6148s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0360s/iter; left time: 1314.3351s
	iters: 300, epoch: 12 | loss: 0.0000025
	speed: 0.0379s/iter; left time: 1382.5845s
	iters: 400, epoch: 12 | loss: 0.0669395
	speed: 0.0373s/iter; left time: 1355.2092s
Epoch: 12 cost time: 15.636720180511475
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.190 Vali Acc: 0.977 Test Loss: 0.190 Test Acc: 0.977
Validation loss decreased (-0.975442 --> -0.977260).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000003
	speed: 0.1741s/iter; left time: 6310.3386s
	iters: 200, epoch: 13 | loss: 0.0000044
	speed: 0.0276s/iter; left time: 998.8680s
	iters: 300, epoch: 13 | loss: 0.0003657
	speed: 0.0336s/iter; left time: 1211.1438s
	iters: 400, epoch: 13 | loss: 0.0768986
	speed: 0.0334s/iter; left time: 1199.0122s
Epoch: 13 cost time: 13.799121141433716
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.296 Vali Acc: 0.973 Test Loss: 0.296 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000096
	speed: 0.1762s/iter; left time: 6313.1105s
	iters: 200, epoch: 14 | loss: 0.0017073
	speed: 0.0320s/iter; left time: 1143.9689s
	iters: 300, epoch: 14 | loss: 0.0000008
	speed: 0.0343s/iter; left time: 1220.7777s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0268s/iter; left time: 953.3828s
Epoch: 14 cost time: 13.82027554512024
Epoch: 14, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.277 Vali Acc: 0.968 Test Loss: 0.277 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1661s/iter; left time: 5882.3843s
	iters: 200, epoch: 15 | loss: 0.0001564
	speed: 0.0332s/iter; left time: 1173.0689s
	iters: 300, epoch: 15 | loss: 0.0780078
	speed: 0.0305s/iter; left time: 1072.6088s
	iters: 400, epoch: 15 | loss: 0.0013656
	speed: 0.0275s/iter; left time: 967.0038s
Epoch: 15 cost time: 13.60770869255066
Epoch: 15, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.281 Vali Acc: 0.972 Test Loss: 0.281 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0011003
	speed: 0.1624s/iter; left time: 5683.3387s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0340s/iter; left time: 1187.0162s
	iters: 300, epoch: 16 | loss: 0.0000139
	speed: 0.0327s/iter; left time: 1138.0511s
	iters: 400, epoch: 16 | loss: 0.0001622
	speed: 0.0306s/iter; left time: 1062.4350s
Epoch: 16 cost time: 14.305740118026733
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.316 Vali Acc: 0.967 Test Loss: 0.316 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1749s/iter; left time: 6050.6018s
	iters: 200, epoch: 17 | loss: 0.0000004
	speed: 0.0373s/iter; left time: 1285.5065s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 1222.7615s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 1198.1528s
Epoch: 17 cost time: 15.829524278640747
Epoch: 17, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.981 Test Loss: 0.168 Test Acc: 0.981
Validation loss decreased (-0.977260 --> -0.981353).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000115
	speed: 0.1650s/iter; left time: 5639.9720s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 1107.2409s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 961.9539s
	iters: 400, epoch: 18 | loss: 0.0011088
	speed: 0.0298s/iter; left time: 1009.5276s
Epoch: 18 cost time: 13.743058443069458
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.235 Vali Acc: 0.974 Test Loss: 0.235 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1671s/iter; left time: 5642.5359s
	iters: 200, epoch: 19 | loss: 0.1570060
	speed: 0.0266s/iter; left time: 895.0865s
	iters: 300, epoch: 19 | loss: 0.0000008
	speed: 0.0310s/iter; left time: 1039.9371s
	iters: 400, epoch: 19 | loss: 0.0000164
	speed: 0.0306s/iter; left time: 1025.1331s
Epoch: 19 cost time: 13.142672538757324
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.259 Vali Acc: 0.978 Test Loss: 0.259 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0182420
	speed: 0.1522s/iter; left time: 5077.8655s
	iters: 200, epoch: 20 | loss: 0.7100154
	speed: 0.0261s/iter; left time: 869.0200s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0297s/iter; left time: 985.9034s
	iters: 400, epoch: 20 | loss: 0.0000049
	speed: 0.0304s/iter; left time: 1003.7679s
Epoch: 20 cost time: 12.326010942459106
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.248 Vali Acc: 0.978 Test Loss: 0.248 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1664s/iter; left time: 5479.8766s
	iters: 200, epoch: 21 | loss: 0.0001072
	speed: 0.0306s/iter; left time: 1004.9862s
	iters: 300, epoch: 21 | loss: 0.0000018
	speed: 0.0280s/iter; left time: 915.2428s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 1083.0991s
Epoch: 21 cost time: 13.30487608909607
Epoch: 21, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.218 Vali Acc: 0.974 Test Loss: 0.218 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1705s/iter; left time: 5546.7828s
	iters: 200, epoch: 22 | loss: 0.0010490
	speed: 0.0314s/iter; left time: 1019.8514s
	iters: 300, epoch: 22 | loss: 0.0000056
	speed: 0.0277s/iter; left time: 894.8307s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0272s/iter; left time: 875.2138s
Epoch: 22 cost time: 13.336806058883667
Epoch: 22, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.196 Vali Acc: 0.978 Test Loss: 0.196 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1634s/iter; left time: 5248.5335s
	iters: 200, epoch: 23 | loss: 0.0120467
	speed: 0.0289s/iter; left time: 925.5289s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 890.2599s
	iters: 400, epoch: 23 | loss: 0.0000022
	speed: 0.0268s/iter; left time: 852.2672s
Epoch: 23 cost time: 12.635982275009155
Epoch: 23, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.266 Vali Acc: 0.974 Test Loss: 0.266 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000001
	speed: 0.1440s/iter; left time: 4564.1940s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 1028.2448s
	iters: 300, epoch: 24 | loss: 0.0000219
	speed: 0.0315s/iter; left time: 992.2291s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0306s/iter; left time: 959.8813s
Epoch: 24 cost time: 13.620109796524048
Epoch: 24, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.276 Vali Acc: 0.976 Test Loss: 0.276 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000284
	speed: 0.1584s/iter; left time: 4957.1480s
	iters: 200, epoch: 25 | loss: 0.0000005
	speed: 0.0368s/iter; left time: 1147.6084s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0302s/iter; left time: 937.3544s
	iters: 400, epoch: 25 | loss: 0.0000006
	speed: 0.0316s/iter; left time: 978.6799s
Epoch: 25 cost time: 13.884185075759888
Epoch: 25, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.322 Vali Acc: 0.977 Test Loss: 0.322 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1584s/iter; left time: 4891.9249s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0306s/iter; left time: 941.2445s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 857.2786s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0311s/iter; left time: 949.6588s
Epoch: 26 cost time: 13.409751653671265
Epoch: 26, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.273 Vali Acc: 0.975 Test Loss: 0.273 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1505s/iter; left time: 4584.4730s
	iters: 200, epoch: 27 | loss: 0.2684626
	speed: 0.0258s/iter; left time: 784.2294s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 814.4024s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 808.1376s
Epoch: 27 cost time: 11.754072904586792
Epoch: 27, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.255 Vali Acc: 0.978 Test Loss: 0.255 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 87978
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3889818
	speed: 0.0574s/iter; left time: 2365.5874s
	iters: 200, epoch: 1 | loss: 0.1361531
	speed: 0.0262s/iter; left time: 1075.2612s
	iters: 300, epoch: 1 | loss: 0.1302146
	speed: 0.0262s/iter; left time: 1074.0247s
	iters: 400, epoch: 1 | loss: 0.0942373
	speed: 0.0278s/iter; left time: 1136.8168s
Epoch: 1 cost time: 14.397701978683472
Epoch: 1, Steps: 413 | Train Loss: 0.448 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
Validation loss decreased (inf --> -0.951340).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2602196
	speed: 0.1608s/iter; left time: 6556.6758s
	iters: 200, epoch: 2 | loss: 0.0053936
	speed: 0.0338s/iter; left time: 1376.1102s
	iters: 300, epoch: 2 | loss: 0.0929523
	speed: 0.0320s/iter; left time: 1300.3953s
	iters: 400, epoch: 2 | loss: 0.0260574
	speed: 0.0313s/iter; left time: 1265.8924s
Epoch: 2 cost time: 14.305700540542603
Epoch: 2, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
Validation loss decreased (-0.951340 --> -0.965438).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1010755
	speed: 0.1639s/iter; left time: 6617.2388s
	iters: 200, epoch: 3 | loss: 0.0028467
	speed: 0.0357s/iter; left time: 1439.0711s
	iters: 300, epoch: 3 | loss: 0.0089367
	speed: 0.0348s/iter; left time: 1397.6275s
	iters: 400, epoch: 3 | loss: 0.0086464
	speed: 0.0321s/iter; left time: 1287.2095s
Epoch: 3 cost time: 14.407077074050903
Epoch: 3, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.094 Vali Acc: 0.967 Test Loss: 0.094 Test Acc: 0.967
Validation loss decreased (-0.965438 --> -0.966802).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2431388
	speed: 0.1557s/iter; left time: 6221.1484s
	iters: 200, epoch: 4 | loss: 0.3092764
	speed: 0.0340s/iter; left time: 1357.1926s
	iters: 300, epoch: 4 | loss: 0.0003259
	speed: 0.0319s/iter; left time: 1270.1951s
	iters: 400, epoch: 4 | loss: 0.0064879
	speed: 0.0313s/iter; left time: 1240.1900s
Epoch: 4 cost time: 13.97606086730957
Epoch: 4, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
Validation loss decreased (-0.966802 --> -0.971350).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0008046
	speed: 0.1634s/iter; left time: 6462.6819s
	iters: 200, epoch: 5 | loss: 0.0003793
	speed: 0.0353s/iter; left time: 1394.1868s
	iters: 300, epoch: 5 | loss: 0.2195954
	speed: 0.0400s/iter; left time: 1575.8969s
	iters: 400, epoch: 5 | loss: 0.0066224
	speed: 0.0372s/iter; left time: 1459.3184s
Epoch: 5 cost time: 15.304037094116211
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0036866
	speed: 0.1786s/iter; left time: 6988.0304s
	iters: 200, epoch: 6 | loss: 0.0000077
	speed: 0.0308s/iter; left time: 1202.7598s
	iters: 300, epoch: 6 | loss: 0.0000115
	speed: 0.0322s/iter; left time: 1252.3603s
	iters: 400, epoch: 6 | loss: 0.0005142
	speed: 0.0324s/iter; left time: 1258.1677s
Epoch: 6 cost time: 14.381612777709961
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0568150
	speed: 0.1890s/iter; left time: 7317.2695s
	iters: 200, epoch: 7 | loss: 0.0002814
	speed: 0.0313s/iter; left time: 1207.0095s
	iters: 300, epoch: 7 | loss: 0.0004271
	speed: 0.0319s/iter; left time: 1230.0095s
	iters: 400, epoch: 7 | loss: 0.0006248
	speed: 0.0298s/iter; left time: 1144.4610s
Epoch: 7 cost time: 14.07611608505249
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
Validation loss decreased (-0.971350 --> -0.972259).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0003093
	speed: 0.1830s/iter; left time: 7012.0028s
	iters: 200, epoch: 8 | loss: 0.0000265
	speed: 0.0375s/iter; left time: 1433.4230s
	iters: 300, epoch: 8 | loss: 0.1345568
	speed: 0.0326s/iter; left time: 1242.5845s
	iters: 400, epoch: 8 | loss: 0.0001977
	speed: 0.0356s/iter; left time: 1354.0160s
Epoch: 8 cost time: 15.301283597946167
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.197 Vali Acc: 0.964 Test Loss: 0.197 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0013169
	speed: 0.1824s/iter; left time: 6912.3301s
	iters: 200, epoch: 9 | loss: 0.0082953
	speed: 0.0413s/iter; left time: 1560.8863s
	iters: 300, epoch: 9 | loss: 0.2949739
	speed: 0.0293s/iter; left time: 1105.9892s
	iters: 400, epoch: 9 | loss: 0.0028720
	speed: 0.0299s/iter; left time: 1125.5823s
Epoch: 9 cost time: 15.190462589263916
Epoch: 9, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
Validation loss decreased (-0.972259 --> -0.976352).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0109228
	speed: 0.1546s/iter; left time: 5793.8172s
	iters: 200, epoch: 10 | loss: 0.0011293
	speed: 0.0341s/iter; left time: 1274.0489s
	iters: 300, epoch: 10 | loss: 0.0036218
	speed: 0.0343s/iter; left time: 1277.6005s
	iters: 400, epoch: 10 | loss: 0.0033128
	speed: 0.0279s/iter; left time: 1036.2284s
Epoch: 10 cost time: 13.97750973701477
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.196 Vali Acc: 0.966 Test Loss: 0.196 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000148
	speed: 0.1756s/iter; left time: 6509.7531s
	iters: 200, epoch: 11 | loss: 0.0000047
	speed: 0.0314s/iter; left time: 1160.5121s
	iters: 300, epoch: 11 | loss: 0.0018055
	speed: 0.0318s/iter; left time: 1171.3348s
	iters: 400, epoch: 11 | loss: 0.0004557
	speed: 0.0281s/iter; left time: 1033.6317s
Epoch: 11 cost time: 13.671284437179565
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.275 Vali Acc: 0.958 Test Loss: 0.275 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1694s/iter; left time: 6211.1845s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.0281s/iter; left time: 1027.2529s
	iters: 300, epoch: 12 | loss: 0.0000009
	speed: 0.0341s/iter; left time: 1242.5785s
	iters: 400, epoch: 12 | loss: 0.0000003
	speed: 0.0301s/iter; left time: 1096.1436s
Epoch: 12 cost time: 14.045125722885132
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.191 Vali Acc: 0.968 Test Loss: 0.191 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000102
	speed: 0.1750s/iter; left time: 6341.1199s
	iters: 200, epoch: 13 | loss: 0.0000459
	speed: 0.0302s/iter; left time: 1090.7501s
	iters: 300, epoch: 13 | loss: 0.0000106
	speed: 0.0292s/iter; left time: 1051.3970s
	iters: 400, epoch: 13 | loss: 0.0000083
	speed: 0.0325s/iter; left time: 1168.4753s
Epoch: 13 cost time: 14.285380840301514
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.272 Vali Acc: 0.966 Test Loss: 0.272 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000010
	speed: 0.1623s/iter; left time: 5816.7954s
	iters: 200, epoch: 14 | loss: 0.0000042
	speed: 0.0300s/iter; left time: 1073.5436s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 1030.3866s
	iters: 400, epoch: 14 | loss: 0.0000064
	speed: 0.0262s/iter; left time: 930.0958s
Epoch: 14 cost time: 12.911218404769897
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.208 Vali Acc: 0.970 Test Loss: 0.208 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1473s/iter; left time: 5218.7752s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 988.2018s
	iters: 300, epoch: 15 | loss: 0.0000003
	speed: 0.0330s/iter; left time: 1163.2012s
	iters: 400, epoch: 15 | loss: 0.0003377
	speed: 0.0264s/iter; left time: 926.6666s
Epoch: 15 cost time: 12.69193720817566
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.219 Vali Acc: 0.967 Test Loss: 0.219 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000002
	speed: 0.1444s/iter; left time: 5056.4457s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 940.0696s
	iters: 300, epoch: 16 | loss: 0.0345426
	speed: 0.0268s/iter; left time: 934.4674s
	iters: 400, epoch: 16 | loss: 0.0002102
	speed: 0.0256s/iter; left time: 887.7525s
Epoch: 16 cost time: 11.472955465316772
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.145 Vali Acc: 0.972 Test Loss: 0.145 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0001367
	speed: 0.1619s/iter; left time: 5601.4156s
	iters: 200, epoch: 17 | loss: 0.0005466
	speed: 0.0364s/iter; left time: 1256.1586s
	iters: 300, epoch: 17 | loss: 0.2815536
	speed: 0.0337s/iter; left time: 1160.4642s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 1198.2332s
Epoch: 17 cost time: 15.238699436187744
Epoch: 17, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.269 Vali Acc: 0.968 Test Loss: 0.269 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000146
	speed: 0.1811s/iter; left time: 6190.2158s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0318s/iter; left time: 1084.8872s
	iters: 300, epoch: 18 | loss: 0.0000118
	speed: 0.0298s/iter; left time: 1012.4492s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0309s/iter; left time: 1045.3033s
Epoch: 18 cost time: 14.249192237854004
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.209 Vali Acc: 0.974 Test Loss: 0.209 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000287
	speed: 0.1892s/iter; left time: 6388.6825s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 1186.4230s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 1071.0419s
	iters: 400, epoch: 19 | loss: 0.0001613
	speed: 0.0325s/iter; left time: 1086.1292s
Epoch: 19 cost time: 15.514315843582153
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.204 Vali Acc: 0.976 Test Loss: 0.204 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 67306
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9805731
	speed: 0.0744s/iter; left time: 3065.1126s
	iters: 200, epoch: 1 | loss: 0.6344066
	speed: 0.0337s/iter; left time: 1384.9103s
	iters: 300, epoch: 1 | loss: 0.1027121
	speed: 0.0341s/iter; left time: 1396.9464s
	iters: 400, epoch: 1 | loss: 0.1955717
	speed: 0.0378s/iter; left time: 1547.5830s
Epoch: 1 cost time: 18.629668474197388
Epoch: 1, Steps: 413 | Train Loss: 0.521 Vali Loss: 0.123 Vali Acc: 0.955 Test Loss: 0.123 Test Acc: 0.955
Validation loss decreased (inf --> -0.955433).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2764709
	speed: 0.1706s/iter; left time: 6959.0443s
	iters: 200, epoch: 2 | loss: 0.0101012
	speed: 0.0372s/iter; left time: 1512.1431s
	iters: 300, epoch: 2 | loss: 0.0322275
	speed: 0.0362s/iter; left time: 1469.6571s
	iters: 400, epoch: 2 | loss: 0.0369576
	speed: 0.0369s/iter; left time: 1492.0496s
Epoch: 2 cost time: 15.785668849945068
Epoch: 2, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
Validation loss decreased (-0.955433 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0059691
	speed: 0.1833s/iter; left time: 7399.6774s
	iters: 200, epoch: 3 | loss: 0.0114274
	speed: 0.0324s/iter; left time: 1303.8216s
	iters: 300, epoch: 3 | loss: 0.0395678
	speed: 0.0331s/iter; left time: 1328.4524s
	iters: 400, epoch: 3 | loss: 0.0176908
	speed: 0.0345s/iter; left time: 1383.1350s
Epoch: 3 cost time: 14.408491849899292
Epoch: 3, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
Validation loss decreased (-0.968621 --> -0.974533).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0003854
	speed: 0.1990s/iter; left time: 7953.2067s
	iters: 200, epoch: 4 | loss: 0.1235274
	speed: 0.0358s/iter; left time: 1428.1696s
	iters: 300, epoch: 4 | loss: 0.0377861
	speed: 0.0372s/iter; left time: 1479.1519s
	iters: 400, epoch: 4 | loss: 0.0830544
	speed: 0.0400s/iter; left time: 1585.3828s
Epoch: 4 cost time: 16.425244331359863
Epoch: 4, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0024140
	speed: 0.1869s/iter; left time: 7390.5777s
	iters: 200, epoch: 5 | loss: 0.0016151
	speed: 0.0383s/iter; left time: 1510.4279s
	iters: 300, epoch: 5 | loss: 0.0000321
	speed: 0.0430s/iter; left time: 1692.7949s
	iters: 400, epoch: 5 | loss: 0.1175743
	speed: 0.0361s/iter; left time: 1414.9429s
Epoch: 5 cost time: 16.812368631362915
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.095 Vali Acc: 0.969 Test Loss: 0.095 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0005177
	speed: 0.2053s/iter; left time: 8036.1133s
	iters: 200, epoch: 6 | loss: 0.2928473
	speed: 0.0363s/iter; left time: 1416.2978s
	iters: 300, epoch: 6 | loss: 0.1754117
	speed: 0.0364s/iter; left time: 1416.3000s
	iters: 400, epoch: 6 | loss: 0.0009068
	speed: 0.0370s/iter; left time: 1435.6884s
Epoch: 6 cost time: 16.43285608291626
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0008400
	speed: 0.1994s/iter; left time: 7719.5291s
	iters: 200, epoch: 7 | loss: 0.0000166
	speed: 0.0386s/iter; left time: 1491.7857s
	iters: 300, epoch: 7 | loss: 0.0004336
	speed: 0.0401s/iter; left time: 1546.4593s
	iters: 400, epoch: 7 | loss: 0.0045100
	speed: 0.0378s/iter; left time: 1454.0037s
Epoch: 7 cost time: 16.851191759109497
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0031965
	speed: 0.1904s/iter; left time: 7294.6893s
	iters: 200, epoch: 8 | loss: 0.0001627
	speed: 0.0367s/iter; left time: 1404.2132s
	iters: 300, epoch: 8 | loss: 0.0001105
	speed: 0.0364s/iter; left time: 1385.6822s
	iters: 400, epoch: 8 | loss: 0.0002351
	speed: 0.0349s/iter; left time: 1327.7368s
Epoch: 8 cost time: 15.51021432876587
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.974533 --> -0.974988).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0019204
	speed: 0.1926s/iter; left time: 7297.5855s
	iters: 200, epoch: 9 | loss: 0.0000156
	speed: 0.0406s/iter; left time: 1534.3761s
	iters: 300, epoch: 9 | loss: 0.0037402
	speed: 0.0428s/iter; left time: 1615.1360s
	iters: 400, epoch: 9 | loss: 0.0000004
	speed: 0.0382s/iter; left time: 1434.4569s
Epoch: 9 cost time: 17.73687767982483
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
Validation loss decreased (-0.974988 --> -0.977716).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1859578
	speed: 0.1968s/iter; left time: 7375.9533s
	iters: 200, epoch: 10 | loss: 0.0008283
	speed: 0.0353s/iter; left time: 1319.6690s
	iters: 300, epoch: 10 | loss: 0.0989579
	speed: 0.0386s/iter; left time: 1440.1274s
	iters: 400, epoch: 10 | loss: 0.2569399
	speed: 0.0425s/iter; left time: 1579.7991s
Epoch: 10 cost time: 16.714662551879883
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.4351692
	speed: 0.1983s/iter; left time: 7351.6708s
	iters: 200, epoch: 11 | loss: 0.0000018
	speed: 0.0396s/iter; left time: 1465.1920s
	iters: 300, epoch: 11 | loss: 0.0000038
	speed: 0.0458s/iter; left time: 1687.9368s
	iters: 400, epoch: 11 | loss: 0.0318978
	speed: 0.0393s/iter; left time: 1444.8247s
Epoch: 11 cost time: 17.252838850021362
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000003
	speed: 0.2006s/iter; left time: 7355.0478s
	iters: 200, epoch: 12 | loss: 0.3502853
	speed: 0.0361s/iter; left time: 1319.0582s
	iters: 300, epoch: 12 | loss: 0.0000018
	speed: 0.0401s/iter; left time: 1461.2024s
	iters: 400, epoch: 12 | loss: 0.0000025
	speed: 0.0385s/iter; left time: 1399.4758s
Epoch: 12 cost time: 17.139075994491577
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000791
	speed: 0.2017s/iter; left time: 7311.1557s
	iters: 200, epoch: 13 | loss: 0.0243043
	speed: 0.0329s/iter; left time: 1188.1661s
	iters: 300, epoch: 13 | loss: 0.0000017
	speed: 0.0376s/iter; left time: 1354.7674s
	iters: 400, epoch: 13 | loss: 0.0003258
	speed: 0.0413s/iter; left time: 1485.3955s
Epoch: 13 cost time: 16.551477670669556
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000227
	speed: 0.2078s/iter; left time: 7447.2945s
	iters: 200, epoch: 14 | loss: 0.0000061
	speed: 0.0384s/iter; left time: 1373.5494s
	iters: 300, epoch: 14 | loss: 0.0757341
	speed: 0.0372s/iter; left time: 1325.3860s
	iters: 400, epoch: 14 | loss: 0.0048304
	speed: 0.0354s/iter; left time: 1258.3859s
Epoch: 14 cost time: 16.0246684551239
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000014
	speed: 0.1983s/iter; left time: 7023.7748s
	iters: 200, epoch: 15 | loss: 0.0023885
	speed: 0.0351s/iter; left time: 1240.1696s
	iters: 300, epoch: 15 | loss: 0.0001287
	speed: 0.0333s/iter; left time: 1174.1807s
	iters: 400, epoch: 15 | loss: 0.0036072
	speed: 0.0360s/iter; left time: 1264.0310s
Epoch: 15 cost time: 15.605809926986694
Epoch: 15, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.180 Vali Acc: 0.969 Test Loss: 0.180 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1953s/iter; left time: 6835.3899s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.0348s/iter; left time: 1214.3620s
	iters: 300, epoch: 16 | loss: 0.0000098
	speed: 0.0381s/iter; left time: 1325.3796s
	iters: 400, epoch: 16 | loss: 0.0000049
	speed: 0.0376s/iter; left time: 1305.8802s
Epoch: 16 cost time: 16.308133602142334
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.2640503
	speed: 0.1859s/iter; left time: 6431.3636s
	iters: 200, epoch: 17 | loss: 0.0000521
	speed: 0.0310s/iter; left time: 1068.2291s
	iters: 300, epoch: 17 | loss: 0.0006208
	speed: 0.0346s/iter; left time: 1189.4773s
	iters: 400, epoch: 17 | loss: 0.0010446
	speed: 0.0361s/iter; left time: 1236.8119s
Epoch: 17 cost time: 14.893117666244507
Epoch: 17, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000067
	speed: 0.1824s/iter; left time: 6232.7317s
	iters: 200, epoch: 18 | loss: 0.0000037
	speed: 0.0356s/iter; left time: 1211.6274s
	iters: 300, epoch: 18 | loss: 0.0000016
	speed: 0.0358s/iter; left time: 1214.9457s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 1290.3093s
Epoch: 18 cost time: 15.574930667877197
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000043
	speed: 0.1785s/iter; left time: 6027.4146s
	iters: 200, epoch: 19 | loss: 0.0000194
	speed: 0.0333s/iter; left time: 1119.5075s
	iters: 300, epoch: 19 | loss: 0.0000028
	speed: 0.0340s/iter; left time: 1141.6765s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 1266.9669s
Epoch: 19 cost time: 15.304409980773926
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.176 Vali Acc: 0.969 Test Loss: 0.176 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 50826
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6022504
	speed: 0.0781s/iter; left time: 3218.7330s
	iters: 200, epoch: 1 | loss: 0.3997849
	speed: 0.0426s/iter; left time: 1749.3818s
	iters: 300, epoch: 1 | loss: 0.2480085
	speed: 0.0395s/iter; left time: 1618.2137s
	iters: 400, epoch: 1 | loss: 0.0597556
	speed: 0.0445s/iter; left time: 1821.6116s
Epoch: 1 cost time: 21.080429315567017
Epoch: 1, Steps: 413 | Train Loss: 0.574 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
Validation loss decreased (inf --> -0.953614).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0638011
	speed: 0.1952s/iter; left time: 7959.9803s
	iters: 200, epoch: 2 | loss: 0.0077891
	speed: 0.0437s/iter; left time: 1776.8175s
	iters: 300, epoch: 2 | loss: 0.1963363
	speed: 0.0393s/iter; left time: 1595.8121s
	iters: 400, epoch: 2 | loss: 0.0364505
	speed: 0.0445s/iter; left time: 1801.2294s
Epoch: 2 cost time: 18.07237672805786
Epoch: 2, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.094 Vali Acc: 0.969 Test Loss: 0.094 Test Acc: 0.969
Validation loss decreased (-0.953614 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0241764
	speed: 0.2009s/iter; left time: 8112.8465s
	iters: 200, epoch: 3 | loss: 0.1059527
	speed: 0.0356s/iter; left time: 1435.3559s
	iters: 300, epoch: 3 | loss: 0.0241336
	speed: 0.0376s/iter; left time: 1510.9472s
	iters: 400, epoch: 3 | loss: 0.0044398
	speed: 0.0430s/iter; left time: 1722.4356s
Epoch: 3 cost time: 17.114055395126343
Epoch: 3, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0071203
	speed: 0.2128s/iter; left time: 8504.0174s
	iters: 200, epoch: 4 | loss: 0.0065064
	speed: 0.0411s/iter; left time: 1637.8549s
	iters: 300, epoch: 4 | loss: 0.0043209
	speed: 0.0389s/iter; left time: 1545.3316s
	iters: 400, epoch: 4 | loss: 0.0001859
	speed: 0.0403s/iter; left time: 1599.1710s
Epoch: 4 cost time: 17.846324682235718
Epoch: 4, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.070 Vali Acc: 0.972 Test Loss: 0.070 Test Acc: 0.972
Validation loss decreased (-0.968621 --> -0.972259).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0085812
	speed: 0.2057s/iter; left time: 8133.8268s
	iters: 200, epoch: 5 | loss: 0.0014499
	speed: 0.0362s/iter; left time: 1427.5569s
	iters: 300, epoch: 5 | loss: 0.0005576
	speed: 0.0400s/iter; left time: 1575.2429s
	iters: 400, epoch: 5 | loss: 0.0027893
	speed: 0.0435s/iter; left time: 1706.3132s
Epoch: 5 cost time: 17.059587240219116
Epoch: 5, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.068 Vali Acc: 0.978 Test Loss: 0.068 Test Acc: 0.978
Validation loss decreased (-0.972259 --> -0.977716).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0009486
	speed: 0.2210s/iter; left time: 8647.9416s
	iters: 200, epoch: 6 | loss: 0.0349012
	speed: 0.0465s/iter; left time: 1816.7112s
	iters: 300, epoch: 6 | loss: 0.0000493
	speed: 0.0429s/iter; left time: 1671.6569s
	iters: 400, epoch: 6 | loss: 0.2949502
	speed: 0.0433s/iter; left time: 1681.3521s
Epoch: 6 cost time: 18.743631601333618
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0651568
	speed: 0.2262s/iter; left time: 8759.8307s
	iters: 200, epoch: 7 | loss: 0.0013905
	speed: 0.0421s/iter; left time: 1627.9381s
	iters: 300, epoch: 7 | loss: 0.0020020
	speed: 0.0418s/iter; left time: 1609.4713s
	iters: 400, epoch: 7 | loss: 0.0220494
	speed: 0.0408s/iter; left time: 1568.5806s
Epoch: 7 cost time: 18.643917560577393
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0328456
	speed: 0.2200s/iter; left time: 8427.1068s
	iters: 200, epoch: 8 | loss: 0.0011983
	speed: 0.0452s/iter; left time: 1726.1272s
	iters: 300, epoch: 8 | loss: 0.0000031
	speed: 0.0447s/iter; left time: 1702.2895s
	iters: 400, epoch: 8 | loss: 0.0014890
	speed: 0.0420s/iter; left time: 1597.1509s
Epoch: 8 cost time: 18.79048991203308
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1401027
	speed: 0.2303s/iter; left time: 8728.2713s
	iters: 200, epoch: 9 | loss: 0.0036994
	speed: 0.0468s/iter; left time: 1767.6353s
	iters: 300, epoch: 9 | loss: 0.0000854
	speed: 0.0412s/iter; left time: 1553.5565s
	iters: 400, epoch: 9 | loss: 0.0002478
	speed: 0.0458s/iter; left time: 1721.9133s
Epoch: 9 cost time: 19.627182483673096
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0002351
	speed: 0.2378s/iter; left time: 8915.3633s
	iters: 200, epoch: 10 | loss: 0.0000780
	speed: 0.0422s/iter; left time: 1578.6365s
	iters: 300, epoch: 10 | loss: 0.0257241
	speed: 0.0391s/iter; left time: 1459.4968s
	iters: 400, epoch: 10 | loss: 0.0000103
	speed: 0.0496s/iter; left time: 1845.5694s
Epoch: 10 cost time: 18.860658407211304
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2733496
	speed: 0.2246s/iter; left time: 8326.5454s
	iters: 200, epoch: 11 | loss: 0.0046288
	speed: 0.0497s/iter; left time: 1838.8381s
	iters: 300, epoch: 11 | loss: 0.0000047
	speed: 0.0416s/iter; left time: 1534.3535s
	iters: 400, epoch: 11 | loss: 0.0663020
	speed: 0.0404s/iter; left time: 1484.5547s
Epoch: 11 cost time: 19.701268911361694
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000401
	speed: 0.2354s/iter; left time: 8629.3258s
	iters: 200, epoch: 12 | loss: 0.0000191
	speed: 0.0464s/iter; left time: 1694.8563s
	iters: 300, epoch: 12 | loss: 0.0007811
	speed: 0.0462s/iter; left time: 1685.5086s
	iters: 400, epoch: 12 | loss: 0.0003434
	speed: 0.0434s/iter; left time: 1579.3303s
Epoch: 12 cost time: 19.53959846496582
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.5209602
	speed: 0.2261s/iter; left time: 8196.1599s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 1620.4613s
	iters: 300, epoch: 13 | loss: 0.0808281
	speed: 0.0416s/iter; left time: 1498.9133s
	iters: 400, epoch: 13 | loss: 0.0001886
	speed: 0.0392s/iter; left time: 1409.2449s
Epoch: 13 cost time: 18.79060983657837
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.146 Vali Acc: 0.974 Test Loss: 0.146 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000338
	speed: 0.2198s/iter; left time: 7874.5574s
	iters: 200, epoch: 14 | loss: 0.0000006
	speed: 0.0371s/iter; left time: 1327.3814s
	iters: 300, epoch: 14 | loss: 0.0000253
	speed: 0.0443s/iter; left time: 1578.1601s
	iters: 400, epoch: 14 | loss: 0.0004946
	speed: 0.0419s/iter; left time: 1487.9600s
Epoch: 14 cost time: 18.323806762695312
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000167
	speed: 0.2240s/iter; left time: 7932.1161s
	iters: 200, epoch: 15 | loss: 0.0001264
	speed: 0.0406s/iter; left time: 1434.3077s
	iters: 300, epoch: 15 | loss: 0.0000056
	speed: 0.0455s/iter; left time: 1602.5652s
	iters: 400, epoch: 15 | loss: 0.0000007
	speed: 0.0449s/iter; left time: 1575.3429s
Epoch: 15 cost time: 18.433390378952026
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 42666
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1462868
	speed: 0.0864s/iter; left time: 3561.4690s
	iters: 200, epoch: 1 | loss: 0.0568707
	speed: 0.0555s/iter; left time: 2282.5630s
	iters: 300, epoch: 1 | loss: 0.1222563
	speed: 0.0530s/iter; left time: 2171.2285s
	iters: 400, epoch: 1 | loss: 0.1066159
	speed: 0.0584s/iter; left time: 2389.1569s
Epoch: 1 cost time: 26.281294584274292
Epoch: 1, Steps: 413 | Train Loss: 0.413 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (inf --> -0.931330).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0018571
	speed: 0.2337s/iter; left time: 9532.2486s
	iters: 200, epoch: 2 | loss: 0.0040344
	speed: 0.0678s/iter; left time: 2760.2479s
	iters: 300, epoch: 2 | loss: 0.0006891
	speed: 0.0485s/iter; left time: 1968.9928s
	iters: 400, epoch: 2 | loss: 0.2368919
	speed: 0.0451s/iter; left time: 1825.6726s
Epoch: 2 cost time: 23.96891212463379
Epoch: 2, Steps: 413 | Train Loss: 0.153 Vali Loss: 0.215 Vali Acc: 0.960 Test Loss: 0.215 Test Acc: 0.960
Validation loss decreased (-0.931330 --> -0.960434).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0032820
	speed: 0.1989s/iter; left time: 8029.9192s
	iters: 200, epoch: 3 | loss: 0.0000121
	speed: 0.0422s/iter; left time: 1700.0637s
	iters: 300, epoch: 3 | loss: 0.2225877
	speed: 0.0398s/iter; left time: 1600.8674s
	iters: 400, epoch: 3 | loss: 0.0065653
	speed: 0.0504s/iter; left time: 2018.6759s
Epoch: 3 cost time: 19.44907855987549
Epoch: 3, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.219 Vali Acc: 0.960 Test Loss: 0.219 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1024830
	speed: 0.1908s/iter; left time: 7625.7399s
	iters: 200, epoch: 4 | loss: 0.0209600
	speed: 0.0395s/iter; left time: 1576.3639s
	iters: 300, epoch: 4 | loss: 0.0091858
	speed: 0.0389s/iter; left time: 1545.3564s
	iters: 400, epoch: 4 | loss: 0.1148401
	speed: 0.0353s/iter; left time: 1399.0800s
Epoch: 4 cost time: 16.714198350906372
Epoch: 4, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.305 Vali Acc: 0.961 Test Loss: 0.305 Test Acc: 0.961
Validation loss decreased (-0.960434 --> -0.960888).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000173
	speed: 0.2087s/iter; left time: 8252.8143s
	iters: 200, epoch: 5 | loss: 0.0000254
	speed: 0.0474s/iter; left time: 1871.2653s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0417s/iter; left time: 1639.7754s
	iters: 400, epoch: 5 | loss: 0.0014724
	speed: 0.0473s/iter; left time: 1856.7503s
Epoch: 5 cost time: 20.126768589019775
Epoch: 5, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.311 Vali Acc: 0.965 Test Loss: 0.311 Test Acc: 0.965
Validation loss decreased (-0.960888 --> -0.964981).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0189934
	speed: 0.1902s/iter; left time: 7443.9045s
	iters: 200, epoch: 6 | loss: 0.0000321
	speed: 0.0448s/iter; left time: 1748.4725s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 1681.3799s
	iters: 400, epoch: 6 | loss: 0.0000162
	speed: 0.0444s/iter; left time: 1725.7830s
Epoch: 6 cost time: 19.13684892654419
Epoch: 6, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.236 Vali Acc: 0.974 Test Loss: 0.236 Test Acc: 0.974
Validation loss decreased (-0.964981 --> -0.973622).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000041
	speed: 0.1822s/iter; left time: 7056.6513s
	iters: 200, epoch: 7 | loss: 0.0000030
	speed: 0.0393s/iter; left time: 1518.0558s
	iters: 300, epoch: 7 | loss: 0.2636532
	speed: 0.0380s/iter; left time: 1463.0852s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0400s/iter; left time: 1537.6253s
Epoch: 7 cost time: 17.051520824432373
Epoch: 7, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.444 Vali Acc: 0.965 Test Loss: 0.444 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2135s/iter; left time: 8180.1680s
	iters: 200, epoch: 8 | loss: 0.0002244
	speed: 0.0445s/iter; left time: 1698.8168s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 1896.8015s
	iters: 400, epoch: 8 | loss: 0.2953712
	speed: 0.0430s/iter; left time: 1634.9089s
Epoch: 8 cost time: 20.668187618255615
Epoch: 8, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.463 Vali Acc: 0.961 Test Loss: 0.463 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2171s/iter; left time: 8228.7945s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 2075.9621s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1602.1771s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1468.8289s
Epoch: 9 cost time: 21.20051908493042
Epoch: 9, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.423 Vali Acc: 0.968 Test Loss: 0.423 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2030s/iter; left time: 7610.4922s
	iters: 200, epoch: 10 | loss: 0.0001594
	speed: 0.0457s/iter; left time: 1707.8161s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 1601.4504s
	iters: 400, epoch: 10 | loss: 0.0001981
	speed: 0.0481s/iter; left time: 1787.6446s
Epoch: 10 cost time: 19.648751497268677
Epoch: 10, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.426 Vali Acc: 0.959 Test Loss: 0.426 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0001506
	speed: 0.2105s/iter; left time: 7804.5083s
	iters: 200, epoch: 11 | loss: 0.6063795
	speed: 0.0424s/iter; left time: 1566.5268s
	iters: 300, epoch: 11 | loss: 0.2463749
	speed: 0.0446s/iter; left time: 1645.7546s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 1661.9792s
Epoch: 11 cost time: 19.53575348854065
Epoch: 11, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.433 Vali Acc: 0.966 Test Loss: 0.433 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2087s/iter; left time: 7648.9447s
	iters: 200, epoch: 12 | loss: 0.0000005
	speed: 0.0426s/iter; left time: 1557.2435s
	iters: 300, epoch: 12 | loss: 0.0000004
	speed: 0.0388s/iter; left time: 1415.4995s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0408s/iter; left time: 1484.7278s
Epoch: 12 cost time: 18.050968408584595
Epoch: 12, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.553 Vali Acc: 0.960 Test Loss: 0.553 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2020s/iter; left time: 7319.9484s
	iters: 200, epoch: 13 | loss: 0.0002145
	speed: 0.0441s/iter; left time: 1594.0020s
	iters: 300, epoch: 13 | loss: 0.1191764
	speed: 0.0389s/iter; left time: 1403.5394s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 1461.3491s
Epoch: 13 cost time: 17.906492710113525
Epoch: 13, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.611 Vali Acc: 0.962 Test Loss: 0.611 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1909s/iter; left time: 6839.3457s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 1703.2646s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0447s/iter; left time: 1594.4790s
	iters: 400, epoch: 14 | loss: 0.0515001
	speed: 0.0370s/iter; left time: 1314.4893s
Epoch: 14 cost time: 18.427479028701782
Epoch: 14, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.378 Vali Acc: 0.971 Test Loss: 0.378 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000450
	speed: 0.1972s/iter; left time: 6984.5127s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 1511.4883s
	iters: 300, epoch: 15 | loss: 0.0000051
	speed: 0.0417s/iter; left time: 1468.3394s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0321s/iter; left time: 1127.9757s
Epoch: 15 cost time: 17.39261245727539
Epoch: 15, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.542 Vali Acc: 0.959 Test Loss: 0.542 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000883
	speed: 0.2030s/iter; left time: 7106.6149s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 1471.1087s
	iters: 300, epoch: 16 | loss: 0.0000013
	speed: 0.0461s/iter; left time: 1603.4237s
	iters: 400, epoch: 16 | loss: 0.7959547
	speed: 0.0477s/iter; left time: 1654.3410s
Epoch: 16 cost time: 19.575846910476685
Epoch: 16, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.475 Vali Acc: 0.966 Test Loss: 0.475 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9736243747157799
model parameter : 204234
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1311623
	speed: 0.0833s/iter; left time: 3432.4727s
	iters: 200, epoch: 1 | loss: 0.2844073
	speed: 0.0482s/iter; left time: 1979.9796s
	iters: 300, epoch: 1 | loss: 0.0268579
	speed: 0.0543s/iter; left time: 2228.1897s
	iters: 400, epoch: 1 | loss: 0.1405964
	speed: 0.0516s/iter; left time: 2110.2202s
Epoch: 1 cost time: 24.531368732452393
Epoch: 1, Steps: 413 | Train Loss: 0.369 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (inf --> -0.952249).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0039635
	speed: 0.2377s/iter; left time: 9696.1004s
	iters: 200, epoch: 2 | loss: 0.0196719
	speed: 0.0526s/iter; left time: 2140.8001s
	iters: 300, epoch: 2 | loss: 0.0018018
	speed: 0.0477s/iter; left time: 1935.3129s
	iters: 400, epoch: 2 | loss: 0.0001260
	speed: 0.0453s/iter; left time: 1833.2583s
Epoch: 2 cost time: 22.080771446228027
Epoch: 2, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.229 Vali Acc: 0.946 Test Loss: 0.229 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0042477
	speed: 0.2185s/iter; left time: 8820.4987s
	iters: 200, epoch: 3 | loss: 0.0021500
	speed: 0.0617s/iter; left time: 2486.1830s
	iters: 300, epoch: 3 | loss: 0.0116726
	speed: 0.0604s/iter; left time: 2428.5477s
	iters: 400, epoch: 3 | loss: 0.1216093
	speed: 0.0559s/iter; left time: 2242.0556s
Epoch: 3 cost time: 25.44726800918579
Epoch: 3, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
Validation loss decreased (-0.952249 --> -0.967256).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0208398
	speed: 0.2391s/iter; left time: 9556.5912s
	iters: 200, epoch: 4 | loss: 0.0004311
	speed: 0.0539s/iter; left time: 2150.1423s
	iters: 300, epoch: 4 | loss: 0.0000064
	speed: 0.0694s/iter; left time: 2760.2691s
	iters: 400, epoch: 4 | loss: 0.1885438
	speed: 0.0665s/iter; left time: 2639.0651s
Epoch: 4 cost time: 26.86816668510437
Epoch: 4, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
Validation loss decreased (-0.967256 --> -0.972713).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1027432
	speed: 0.2255s/iter; left time: 8917.9067s
	iters: 200, epoch: 5 | loss: 0.0629215
	speed: 0.0489s/iter; left time: 1929.5053s
	iters: 300, epoch: 5 | loss: 0.0013294
	speed: 0.0500s/iter; left time: 1967.9397s
	iters: 400, epoch: 5 | loss: 0.0001427
	speed: 0.0533s/iter; left time: 2093.3037s
Epoch: 5 cost time: 21.90697956085205
Epoch: 5, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.274 Vali Acc: 0.965 Test Loss: 0.274 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2209s/iter; left time: 8645.7137s
	iters: 200, epoch: 6 | loss: 0.0092190
	speed: 0.0492s/iter; left time: 1922.1490s
	iters: 300, epoch: 6 | loss: 0.0140058
	speed: 0.0567s/iter; left time: 2207.2618s
	iters: 400, epoch: 6 | loss: 1.1787379
	speed: 0.0508s/iter; left time: 1972.2453s
Epoch: 6 cost time: 21.98319363594055
Epoch: 6, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.308 Vali Acc: 0.962 Test Loss: 0.308 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2224s/iter; left time: 8613.3625s
	iters: 200, epoch: 7 | loss: 0.0001602
	speed: 0.0591s/iter; left time: 2281.4267s
	iters: 300, epoch: 7 | loss: 0.0006083
	speed: 0.0570s/iter; left time: 2197.2338s
	iters: 400, epoch: 7 | loss: 0.0600171
	speed: 0.0495s/iter; left time: 1901.3738s
Epoch: 7 cost time: 24.318841695785522
Epoch: 7, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.314 Vali Acc: 0.966 Test Loss: 0.314 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000009
	speed: 0.2265s/iter; left time: 8677.9109s
	iters: 200, epoch: 8 | loss: 0.0439655
	speed: 0.0522s/iter; left time: 1996.2527s
	iters: 300, epoch: 8 | loss: 0.0002862
	speed: 0.0657s/iter; left time: 2502.2668s
	iters: 400, epoch: 8 | loss: 0.2520809
	speed: 0.0586s/iter; left time: 2227.2114s
Epoch: 8 cost time: 24.156496286392212
Epoch: 8, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.330 Vali Acc: 0.964 Test Loss: 0.330 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.2448s/iter; left time: 9277.8576s
	iters: 200, epoch: 9 | loss: 0.0000035
	speed: 0.0519s/iter; left time: 1960.2583s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0575s/iter; left time: 2169.0026s
	iters: 400, epoch: 9 | loss: 0.0009378
	speed: 0.0659s/iter; left time: 2477.3666s
Epoch: 9 cost time: 25.137353897094727
Epoch: 9, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.415 Vali Acc: 0.959 Test Loss: 0.415 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000277
	speed: 0.2360s/iter; left time: 8844.5479s
	iters: 200, epoch: 10 | loss: 0.4362142
	speed: 0.0459s/iter; left time: 1714.3333s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 1652.8652s
	iters: 400, epoch: 10 | loss: 0.0000026
	speed: 0.0439s/iter; left time: 1631.9117s
Epoch: 10 cost time: 20.360799312591553
Epoch: 10, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.321 Vali Acc: 0.966 Test Loss: 0.321 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2174s/iter; left time: 8059.4366s
	iters: 200, epoch: 11 | loss: 0.0000738
	speed: 0.0464s/iter; left time: 1713.9990s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 1519.8821s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 1524.1307s
Epoch: 11 cost time: 19.977654457092285
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.437 Vali Acc: 0.960 Test Loss: 0.437 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000518
	speed: 0.2287s/iter; left time: 8385.2283s
	iters: 200, epoch: 12 | loss: 0.2404220
	speed: 0.0529s/iter; left time: 1932.8492s
	iters: 300, epoch: 12 | loss: 0.0001689
	speed: 0.0466s/iter; left time: 1699.0389s
	iters: 400, epoch: 12 | loss: 0.0014861
	speed: 0.0378s/iter; left time: 1375.8481s
Epoch: 12 cost time: 20.795400142669678
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.460 Vali Acc: 0.966 Test Loss: 0.460 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2399s/iter; left time: 8694.8864s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1438.4888s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 1519.2090s
	iters: 400, epoch: 13 | loss: 0.0000010
	speed: 0.0501s/iter; left time: 1799.4206s
Epoch: 13 cost time: 20.057478189468384
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.543 Vali Acc: 0.959 Test Loss: 0.543 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000053
	speed: 0.2245s/iter; left time: 8046.0581s
	iters: 200, epoch: 14 | loss: 0.0000017
	speed: 0.0381s/iter; left time: 1361.9017s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 1448.1673s
	iters: 400, epoch: 14 | loss: 0.0004865
	speed: 0.0435s/iter; left time: 1546.3327s
Epoch: 14 cost time: 18.70156717300415
Epoch: 14, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.464 Vali Acc: 0.963 Test Loss: 0.464 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9727148703956344
model parameter : 137738
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6552029
	speed: 0.0833s/iter; left time: 3431.2714s
	iters: 200, epoch: 1 | loss: 0.0591013
	speed: 0.0547s/iter; left time: 2246.3663s
	iters: 300, epoch: 1 | loss: 0.1992410
	speed: 0.0614s/iter; left time: 2516.1860s
	iters: 400, epoch: 1 | loss: 0.0329822
	speed: 0.0530s/iter; left time: 2166.4135s
Epoch: 1 cost time: 25.93643593788147
Epoch: 1, Steps: 413 | Train Loss: 0.405 Vali Loss: 0.118 Vali Acc: 0.961 Test Loss: 0.118 Test Acc: 0.961
Validation loss decreased (inf --> -0.961345).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0412291
	speed: 0.2155s/iter; left time: 8790.0320s
	iters: 200, epoch: 2 | loss: 0.0275242
	speed: 0.0434s/iter; left time: 1763.9214s
	iters: 300, epoch: 2 | loss: 0.0018405
	speed: 0.0501s/iter; left time: 2034.7155s
	iters: 400, epoch: 2 | loss: 0.1115752
	speed: 0.0581s/iter; left time: 2352.5832s
Epoch: 2 cost time: 20.980909824371338
Epoch: 2, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1029483
	speed: 0.2211s/iter; left time: 8927.0391s
	iters: 200, epoch: 3 | loss: 0.0033047
	speed: 0.0352s/iter; left time: 1416.1635s
	iters: 300, epoch: 3 | loss: 0.0185233
	speed: 0.0422s/iter; left time: 1697.2438s
	iters: 400, epoch: 3 | loss: 0.0000121
	speed: 0.0422s/iter; left time: 1692.8734s
Epoch: 3 cost time: 18.62488293647766
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
Validation loss decreased (-0.961345 --> -0.962709).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0001418
	speed: 0.2230s/iter; left time: 8912.7685s
	iters: 200, epoch: 4 | loss: 0.0669422
	speed: 0.0447s/iter; left time: 1782.8761s
	iters: 300, epoch: 4 | loss: 0.3692213
	speed: 0.0425s/iter; left time: 1690.4890s
	iters: 400, epoch: 4 | loss: 0.0829663
	speed: 0.0432s/iter; left time: 1712.8023s
Epoch: 4 cost time: 18.756098747253418
Epoch: 4, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.215 Vali Acc: 0.953 Test Loss: 0.215 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0011795
	speed: 0.2210s/iter; left time: 8739.3198s
	iters: 200, epoch: 5 | loss: 0.0056054
	speed: 0.0484s/iter; left time: 1909.1122s
	iters: 300, epoch: 5 | loss: 0.1400650
	speed: 0.0406s/iter; left time: 1597.6056s
	iters: 400, epoch: 5 | loss: 0.0000076
	speed: 0.0464s/iter; left time: 1820.8595s
Epoch: 5 cost time: 20.264320373535156
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.206 Vali Acc: 0.964 Test Loss: 0.206 Test Acc: 0.964
Validation loss decreased (-0.962709 --> -0.964073).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0150460
	speed: 0.2083s/iter; left time: 8151.9221s
	iters: 200, epoch: 6 | loss: 0.0001818
	speed: 0.0514s/iter; left time: 2006.0931s
	iters: 300, epoch: 6 | loss: 0.1228983
	speed: 0.0528s/iter; left time: 2054.4398s
	iters: 400, epoch: 6 | loss: 0.1325178
	speed: 0.0437s/iter; left time: 1699.0064s
Epoch: 6 cost time: 20.38833999633789
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.203 Vali Acc: 0.969 Test Loss: 0.203 Test Acc: 0.969
Validation loss decreased (-0.964073 --> -0.968620).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0272973
	speed: 0.2205s/iter; left time: 8537.9225s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 1970.8746s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0616s/iter; left time: 2372.5726s
	iters: 400, epoch: 7 | loss: 0.0009983
	speed: 0.0628s/iter; left time: 2413.9669s
Epoch: 7 cost time: 24.879287004470825
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.233 Vali Acc: 0.966 Test Loss: 0.233 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2208s/iter; left time: 8459.2809s
	iters: 200, epoch: 8 | loss: 0.0000009
	speed: 0.0574s/iter; left time: 2191.9191s
	iters: 300, epoch: 8 | loss: 0.0000033
	speed: 0.0635s/iter; left time: 2420.5927s
	iters: 400, epoch: 8 | loss: 0.0005957
	speed: 0.0611s/iter; left time: 2323.7606s
Epoch: 8 cost time: 25.137104749679565
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.242 Vali Acc: 0.962 Test Loss: 0.242 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000011
	speed: 0.2299s/iter; left time: 8712.8599s
	iters: 200, epoch: 9 | loss: 0.0000005
	speed: 0.0524s/iter; left time: 1980.4380s
	iters: 300, epoch: 9 | loss: 0.0000126
	speed: 0.0487s/iter; left time: 1836.6067s
	iters: 400, epoch: 9 | loss: 0.0604545
	speed: 0.0519s/iter; left time: 1950.0007s
Epoch: 9 cost time: 22.309584140777588
Epoch: 9, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.309 Vali Acc: 0.963 Test Loss: 0.309 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0006297
	speed: 0.2380s/iter; left time: 8919.8552s
	iters: 200, epoch: 10 | loss: 0.0000010
	speed: 0.0620s/iter; left time: 2319.1457s
	iters: 300, epoch: 10 | loss: 0.0000964
	speed: 0.0516s/iter; left time: 1923.2395s
	iters: 400, epoch: 10 | loss: 0.0013621
	speed: 0.0488s/iter; left time: 1815.6301s
Epoch: 10 cost time: 23.52212953567505
Epoch: 10, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.268 Vali Acc: 0.963 Test Loss: 0.268 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000087
	speed: 0.2225s/iter; left time: 8248.7462s
	iters: 200, epoch: 11 | loss: 0.0000003
	speed: 0.0518s/iter; left time: 1915.0384s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 1911.8828s
	iters: 400, epoch: 11 | loss: 0.0000220
	speed: 0.0555s/iter; left time: 2039.2379s
Epoch: 11 cost time: 22.73310899734497
Epoch: 11, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.321 Vali Acc: 0.963 Test Loss: 0.321 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.2271s/iter; left time: 8324.6071s
	iters: 200, epoch: 12 | loss: 0.0045007
	speed: 0.0501s/iter; left time: 1830.8260s
	iters: 300, epoch: 12 | loss: 0.0000186
	speed: 0.0575s/iter; left time: 2097.8096s
	iters: 400, epoch: 12 | loss: 0.0000064
	speed: 0.0547s/iter; left time: 1987.1529s
Epoch: 12 cost time: 23.313316822052002
Epoch: 12, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.286 Vali Acc: 0.968 Test Loss: 0.286 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2163s/iter; left time: 7841.5433s
	iters: 200, epoch: 13 | loss: 0.0003844
	speed: 0.0449s/iter; left time: 1623.5881s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0513s/iter; left time: 1847.5214s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 1865.9258s
Epoch: 13 cost time: 22.119091272354126
Epoch: 13, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.289 Vali Acc: 0.970 Test Loss: 0.289 Test Acc: 0.970
Validation loss decreased (-0.968620 --> -0.969529).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.2243s/iter; left time: 8036.6569s
	iters: 200, epoch: 14 | loss: 0.0000030
	speed: 0.0560s/iter; left time: 2000.4157s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0554s/iter; left time: 1973.4692s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 1871.6566s
Epoch: 14 cost time: 24.372723817825317
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.317 Vali Acc: 0.968 Test Loss: 0.317 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2353s/iter; left time: 8333.0114s
	iters: 200, epoch: 15 | loss: 0.0001772
	speed: 0.0558s/iter; left time: 1971.5490s
	iters: 300, epoch: 15 | loss: 0.0000049
	speed: 0.0581s/iter; left time: 2045.9233s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 1877.0472s
Epoch: 15 cost time: 25.182035207748413
Epoch: 15, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.369 Vali Acc: 0.971 Test Loss: 0.369 Test Acc: 0.971
Validation loss decreased (-0.969529 --> -0.970892).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000017
	speed: 0.2455s/iter; left time: 8595.6813s
	iters: 200, epoch: 16 | loss: 0.0010324
	speed: 0.0486s/iter; left time: 1697.1742s
	iters: 300, epoch: 16 | loss: 0.0000008
	speed: 0.0588s/iter; left time: 2045.4265s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 2015.9694s
Epoch: 16 cost time: 23.77482771873474
Epoch: 16, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.272 Vali Acc: 0.974 Test Loss: 0.272 Test Acc: 0.974
Validation loss decreased (-0.970892 --> -0.974076).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2359s/iter; left time: 8160.6208s
	iters: 200, epoch: 17 | loss: 0.0197717
	speed: 0.0505s/iter; left time: 1740.6691s
	iters: 300, epoch: 17 | loss: 0.0000103
	speed: 0.0446s/iter; left time: 1532.4840s
	iters: 400, epoch: 17 | loss: 0.0010139
	speed: 0.0516s/iter; left time: 1770.2513s
Epoch: 17 cost time: 21.57990598678589
Epoch: 17, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.394 Vali Acc: 0.967 Test Loss: 0.394 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000004
	speed: 0.2375s/iter; left time: 8118.8150s
	iters: 200, epoch: 18 | loss: 0.0000033
	speed: 0.0515s/iter; left time: 1756.0176s
	iters: 300, epoch: 18 | loss: 0.0000425
	speed: 0.0532s/iter; left time: 1808.9804s
	iters: 400, epoch: 18 | loss: 0.0003349
	speed: 0.0488s/iter; left time: 1654.7000s
Epoch: 18 cost time: 22.42443585395813
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.488 Vali Acc: 0.969 Test Loss: 0.488 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000183
	speed: 0.2362s/iter; left time: 7974.5306s
	iters: 200, epoch: 19 | loss: 0.0000082
	speed: 0.0436s/iter; left time: 1466.6415s
	iters: 300, epoch: 19 | loss: 0.0016159
	speed: 0.0452s/iter; left time: 1518.0902s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0465s/iter; left time: 1554.5544s
Epoch: 19 cost time: 19.483494758605957
Epoch: 19, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.386 Vali Acc: 0.970 Test Loss: 0.386 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2387s/iter; left time: 7961.5828s
	iters: 200, epoch: 20 | loss: 0.0000003
	speed: 0.0479s/iter; left time: 1592.1162s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 1475.3191s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0453s/iter; left time: 1496.5895s
Epoch: 20 cost time: 21.436002254486084
Epoch: 20, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.363 Vali Acc: 0.972 Test Loss: 0.363 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2433s/iter; left time: 8014.2764s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.0511s/iter; left time: 1677.8278s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 1658.0361s
	iters: 400, epoch: 21 | loss: 0.0000007
	speed: 0.0483s/iter; left time: 1578.1315s
Epoch: 21 cost time: 22.997836112976074
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.308 Vali Acc: 0.973 Test Loss: 0.308 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0002950
	speed: 0.2412s/iter; left time: 7844.7541s
	iters: 200, epoch: 22 | loss: 0.0017776
	speed: 0.0451s/iter; left time: 1462.3513s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 1667.8454s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 1435.1165s
Epoch: 22 cost time: 21.072731733322144
Epoch: 22, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.266 Vali Acc: 0.978 Test Loss: 0.266 Test Acc: 0.978
Validation loss decreased (-0.974076 --> -0.978169).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000516
	speed: 0.2261s/iter; left time: 7262.6644s
	iters: 200, epoch: 23 | loss: 0.0075548
	speed: 0.0488s/iter; left time: 1563.3494s
	iters: 300, epoch: 23 | loss: 0.1808906
	speed: 0.0474s/iter; left time: 1512.1620s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 1505.8506s
Epoch: 23 cost time: 21.610942602157593
Epoch: 23, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2281s/iter; left time: 7231.2192s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 1659.8543s
	iters: 300, epoch: 24 | loss: 0.0000050
	speed: 0.0465s/iter; left time: 1466.1917s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0396s/iter; left time: 1244.1680s
Epoch: 24 cost time: 21.049282789230347
Epoch: 24, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.341 Vali Acc: 0.971 Test Loss: 0.341 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2217s/iter; left time: 6937.9916s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0505s/iter; left time: 1575.2404s
	iters: 300, epoch: 25 | loss: 0.0000001
	speed: 0.0492s/iter; left time: 1530.1056s
	iters: 400, epoch: 25 | loss: 0.0001609
	speed: 0.0431s/iter; left time: 1336.2530s
Epoch: 25 cost time: 21.102033853530884
Epoch: 25, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.359 Vali Acc: 0.968 Test Loss: 0.359 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2221s/iter; left time: 6857.5327s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0590s/iter; left time: 1815.2832s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 1780.6177s
	iters: 400, epoch: 26 | loss: 0.0000282
	speed: 0.0556s/iter; left time: 1699.1708s
Epoch: 26 cost time: 23.405761241912842
Epoch: 26, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.433 Vali Acc: 0.970 Test Loss: 0.433 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000351
	speed: 0.2174s/iter; left time: 6623.2021s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 1757.1974s
	iters: 300, epoch: 27 | loss: 0.0000001
	speed: 0.0585s/iter; left time: 1769.2380s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0604s/iter; left time: 1822.3094s
Epoch: 27 cost time: 24.230621576309204
Epoch: 27, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.418 Vali Acc: 0.966 Test Loss: 0.418 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0004110
	speed: 0.2263s/iter; left time: 6800.0132s
	iters: 200, epoch: 28 | loss: 0.2227366
	speed: 0.0478s/iter; left time: 1432.0352s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 1538.3303s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1379.5054s
Epoch: 28 cost time: 20.608107089996338
Epoch: 28, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.388 Vali Acc: 0.973 Test Loss: 0.388 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2043s/iter; left time: 6055.1068s
	iters: 200, epoch: 29 | loss: 0.0000001
	speed: 0.0436s/iter; left time: 1286.4495s
	iters: 300, epoch: 29 | loss: 0.0009811
	speed: 0.0475s/iter; left time: 1398.0658s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 1519.9312s
Epoch: 29 cost time: 19.962127923965454
Epoch: 29, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.466 Vali Acc: 0.967 Test Loss: 0.466 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000003
	speed: 0.2122s/iter; left time: 6200.7844s
	iters: 200, epoch: 30 | loss: 0.2430188
	speed: 0.0478s/iter; left time: 1392.6614s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 1086.0874s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 1317.7568s
Epoch: 30 cost time: 19.287977933883667
Epoch: 30, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.337 Vali Acc: 0.973 Test Loss: 0.337 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2252s/iter; left time: 6488.5112s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 1392.8926s
	iters: 300, epoch: 31 | loss: 0.0000484
	speed: 0.0521s/iter; left time: 1491.2045s
	iters: 400, epoch: 31 | loss: 0.0580313
	speed: 0.0550s/iter; left time: 1566.9161s
Epoch: 31 cost time: 22.935388803482056
Epoch: 31, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.326 Vali Acc: 0.977 Test Loss: 0.326 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2310s/iter; left time: 6559.0347s
	iters: 200, epoch: 32 | loss: 0.0020030
	speed: 0.0474s/iter; left time: 1341.3278s
	iters: 300, epoch: 32 | loss: 0.0000002
	speed: 0.0478s/iter; left time: 1347.5974s
	iters: 400, epoch: 32 | loss: 0.0000034
	speed: 0.0489s/iter; left time: 1374.0328s
Epoch: 32 cost time: 20.81804656982422
Epoch: 32, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.295 Vali Acc: 0.973 Test Loss: 0.295 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 104522
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4562846
	speed: 0.0806s/iter; left time: 3319.0579s
	iters: 200, epoch: 1 | loss: 0.2829193
	speed: 0.0431s/iter; left time: 1770.8021s
	iters: 300, epoch: 1 | loss: 0.1472490
	speed: 0.0409s/iter; left time: 1675.6889s
	iters: 400, epoch: 1 | loss: 0.0334882
	speed: 0.0407s/iter; left time: 1663.5084s
Epoch: 1 cost time: 21.136979818344116
Epoch: 1, Steps: 413 | Train Loss: 0.419 Vali Loss: 0.174 Vali Acc: 0.939 Test Loss: 0.174 Test Acc: 0.939
Validation loss decreased (inf --> -0.938607).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1984254
	speed: 0.1854s/iter; left time: 7563.0042s
	iters: 200, epoch: 2 | loss: 0.0063880
	speed: 0.0408s/iter; left time: 1659.1380s
	iters: 300, epoch: 2 | loss: 0.1456683
	speed: 0.0337s/iter; left time: 1366.5880s
	iters: 400, epoch: 2 | loss: 0.0006717
	speed: 0.0370s/iter; left time: 1496.5813s
Epoch: 2 cost time: 15.66739797592163
Epoch: 2, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.175 Vali Acc: 0.955 Test Loss: 0.175 Test Acc: 0.955
Validation loss decreased (-0.938607 --> -0.954978).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0378780
	speed: 0.1869s/iter; left time: 7546.2406s
	iters: 200, epoch: 3 | loss: 0.0751652
	speed: 0.0326s/iter; left time: 1311.4690s
	iters: 300, epoch: 3 | loss: 0.0343449
	speed: 0.0355s/iter; left time: 1425.2739s
	iters: 400, epoch: 3 | loss: 0.0567471
	speed: 0.0345s/iter; left time: 1383.8343s
Epoch: 3 cost time: 15.394968271255493
Epoch: 3, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.954978 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0001826
	speed: 0.1727s/iter; left time: 6900.4538s
	iters: 200, epoch: 4 | loss: 0.0002334
	speed: 0.0354s/iter; left time: 1410.8915s
	iters: 300, epoch: 4 | loss: 0.0041198
	speed: 0.0372s/iter; left time: 1480.4334s
	iters: 400, epoch: 4 | loss: 0.0001510
	speed: 0.0375s/iter; left time: 1487.2108s
Epoch: 4 cost time: 15.938772201538086
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.196 Vali Acc: 0.955 Test Loss: 0.196 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000040
	speed: 0.1551s/iter; left time: 6133.1626s
	iters: 200, epoch: 5 | loss: 0.1540946
	speed: 0.0307s/iter; left time: 1210.4334s
	iters: 300, epoch: 5 | loss: 0.0029379
	speed: 0.0347s/iter; left time: 1364.9805s
	iters: 400, epoch: 5 | loss: 0.1206223
	speed: 0.0327s/iter; left time: 1283.0290s
Epoch: 5 cost time: 14.259371042251587
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0149916
	speed: 0.1706s/iter; left time: 6674.7081s
	iters: 200, epoch: 6 | loss: 0.0078285
	speed: 0.0314s/iter; left time: 1224.1214s
	iters: 300, epoch: 6 | loss: 0.0529743
	speed: 0.0325s/iter; left time: 1265.5932s
	iters: 400, epoch: 6 | loss: 0.1459458
	speed: 0.0301s/iter; left time: 1170.0236s
Epoch: 6 cost time: 14.005095481872559
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000004
	speed: 0.1826s/iter; left time: 7069.7601s
	iters: 200, epoch: 7 | loss: 0.0466034
	speed: 0.0357s/iter; left time: 1377.4605s
	iters: 300, epoch: 7 | loss: 0.0000150
	speed: 0.0333s/iter; left time: 1284.3470s
	iters: 400, epoch: 7 | loss: 0.0001414
	speed: 0.0335s/iter; left time: 1287.5015s
Epoch: 7 cost time: 15.887963771820068
Epoch: 7, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.201 Vali Acc: 0.966 Test Loss: 0.201 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0585391
	speed: 0.1868s/iter; left time: 7155.6810s
	iters: 200, epoch: 8 | loss: 0.0000005
	speed: 0.0377s/iter; left time: 1440.5772s
	iters: 300, epoch: 8 | loss: 0.0000183
	speed: 0.0370s/iter; left time: 1409.0277s
	iters: 400, epoch: 8 | loss: 0.0003885
	speed: 0.0379s/iter; left time: 1439.0982s
Epoch: 8 cost time: 16.09722375869751
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.197 Vali Acc: 0.968 Test Loss: 0.197 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000324
	speed: 0.1862s/iter; left time: 7057.5138s
	iters: 200, epoch: 9 | loss: 0.0000008
	speed: 0.0418s/iter; left time: 1578.4524s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0399s/iter; left time: 1502.5225s
	iters: 400, epoch: 9 | loss: 0.0000022
	speed: 0.0378s/iter; left time: 1421.8023s
Epoch: 9 cost time: 16.966161251068115
Epoch: 9, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.188 Vali Acc: 0.971 Test Loss: 0.188 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000005
	speed: 0.1852s/iter; left time: 6943.7816s
	iters: 200, epoch: 10 | loss: 0.0000002
	speed: 0.0362s/iter; left time: 1354.2774s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 1367.2654s
	iters: 400, epoch: 10 | loss: 0.0000035
	speed: 0.0321s/iter; left time: 1194.9752s
Epoch: 10 cost time: 15.448980569839478
Epoch: 10, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.269 Vali Acc: 0.969 Test Loss: 0.269 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000502
	speed: 0.1947s/iter; left time: 7218.7642s
	iters: 200, epoch: 11 | loss: 0.0000025
	speed: 0.0327s/iter; left time: 1210.2406s
	iters: 300, epoch: 11 | loss: 0.3372018
	speed: 0.0369s/iter; left time: 1358.8443s
	iters: 400, epoch: 11 | loss: 0.0000583
	speed: 0.0363s/iter; left time: 1333.8126s
Epoch: 11 cost time: 15.87468147277832
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000564
	speed: 0.1937s/iter; left time: 7100.3771s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0345s/iter; left time: 1260.7435s
	iters: 300, epoch: 12 | loss: 0.0000071
	speed: 0.0340s/iter; left time: 1238.8722s
	iters: 400, epoch: 12 | loss: 0.0043429
	speed: 0.0301s/iter; left time: 1095.1328s
Epoch: 12 cost time: 14.57481575012207
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.182 Vali Acc: 0.979 Test Loss: 0.182 Test Acc: 0.979
Validation loss decreased (-0.973169 --> -0.979080).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0002009
	speed: 0.1761s/iter; left time: 6382.7872s
	iters: 200, epoch: 13 | loss: 0.0000198
	speed: 0.0360s/iter; left time: 1301.1606s
	iters: 300, epoch: 13 | loss: 0.0201448
	speed: 0.0303s/iter; left time: 1090.7857s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0297s/iter; left time: 1067.7574s
Epoch: 13 cost time: 14.30297565460205
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.197 Vali Acc: 0.976 Test Loss: 0.197 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000010
	speed: 0.1584s/iter; left time: 5674.2439s
	iters: 200, epoch: 14 | loss: 0.4092705
	speed: 0.0343s/iter; left time: 1226.3502s
	iters: 300, epoch: 14 | loss: 0.0358701
	speed: 0.0362s/iter; left time: 1289.8380s
	iters: 400, epoch: 14 | loss: 0.0006140
	speed: 0.0360s/iter; left time: 1277.4454s
Epoch: 14 cost time: 15.113676309585571
Epoch: 14, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.200 Vali Acc: 0.978 Test Loss: 0.200 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000003
	speed: 0.1633s/iter; left time: 5785.0164s
	iters: 200, epoch: 15 | loss: 0.0000002
	speed: 0.0341s/iter; left time: 1203.4968s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 1300.2729s
	iters: 400, epoch: 15 | loss: 0.0015856
	speed: 0.0396s/iter; left time: 1391.7350s
Epoch: 15 cost time: 15.826133728027344
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.301 Vali Acc: 0.968 Test Loss: 0.301 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000072
	speed: 0.1743s/iter; left time: 6102.8858s
	iters: 200, epoch: 16 | loss: 0.0000009
	speed: 0.0312s/iter; left time: 1088.0255s
	iters: 300, epoch: 16 | loss: 0.0000250
	speed: 0.0349s/iter; left time: 1216.0836s
	iters: 400, epoch: 16 | loss: 0.0000205
	speed: 0.0308s/iter; left time: 1067.4105s
Epoch: 16 cost time: 14.318862199783325
Epoch: 16, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.313 Vali Acc: 0.972 Test Loss: 0.313 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000273
	speed: 0.1787s/iter; left time: 6182.5302s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 1313.4218s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0332s/iter; left time: 1141.2778s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 1316.4900s
Epoch: 17 cost time: 15.816245079040527
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.304 Vali Acc: 0.973 Test Loss: 0.304 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1812s/iter; left time: 6192.5467s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0394s/iter; left time: 1342.2668s
	iters: 300, epoch: 18 | loss: 0.0001421
	speed: 0.0371s/iter; left time: 1260.5409s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 1221.9061s
Epoch: 18 cost time: 16.166879653930664
Epoch: 18, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.242 Vali Acc: 0.971 Test Loss: 0.242 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.2005845
	speed: 0.1828s/iter; left time: 6171.5075s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 1203.7564s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 1143.4201s
	iters: 400, epoch: 19 | loss: 0.0000671
	speed: 0.0387s/iter; left time: 1294.3490s
Epoch: 19 cost time: 15.78821325302124
Epoch: 19, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.242 Vali Acc: 0.976 Test Loss: 0.242 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000017
	speed: 0.1821s/iter; left time: 6072.9426s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0423s/iter; left time: 1405.3453s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 1259.0692s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0315s/iter; left time: 1040.0239s
Epoch: 20 cost time: 15.772164106369019
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.261 Vali Acc: 0.975 Test Loss: 0.261 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1890s/iter; left time: 6224.9597s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 1237.9695s
	iters: 300, epoch: 21 | loss: 0.0000088
	speed: 0.0360s/iter; left time: 1177.7690s
	iters: 400, epoch: 21 | loss: 0.0392569
	speed: 0.0324s/iter; left time: 1058.7125s
Epoch: 21 cost time: 15.638013362884521
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.202 Vali Acc: 0.977 Test Loss: 0.202 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000007
	speed: 0.1959s/iter; left time: 6371.7761s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 1142.1733s
	iters: 300, epoch: 22 | loss: 0.0000726
	speed: 0.0381s/iter; left time: 1231.7269s
	iters: 400, epoch: 22 | loss: 0.0007694
	speed: 0.0335s/iter; left time: 1079.4659s
Epoch: 22 cost time: 15.823149919509888
Epoch: 22, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
model parameter : 83818
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3558792
	speed: 0.0734s/iter; left time: 3024.9371s
	iters: 200, epoch: 1 | loss: 0.2073793
	speed: 0.0375s/iter; left time: 1542.1273s
	iters: 300, epoch: 1 | loss: 0.1585282
	speed: 0.0355s/iter; left time: 1456.9912s
	iters: 400, epoch: 1 | loss: 0.0074729
	speed: 0.0346s/iter; left time: 1416.6026s
Epoch: 1 cost time: 18.790830373764038
Epoch: 1, Steps: 413 | Train Loss: 0.457 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (inf --> -0.964528).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1131523
	speed: 0.1928s/iter; left time: 7865.8656s
	iters: 200, epoch: 2 | loss: 0.1534504
	speed: 0.0405s/iter; left time: 1648.1299s
	iters: 300, epoch: 2 | loss: 0.0586822
	speed: 0.0350s/iter; left time: 1419.6050s
	iters: 400, epoch: 2 | loss: 0.0065778
	speed: 0.0393s/iter; left time: 1590.0783s
Epoch: 2 cost time: 16.094578981399536
Epoch: 2, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
Validation loss decreased (-0.964528 --> -0.967712).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0170734
	speed: 0.1851s/iter; left time: 7472.2362s
	iters: 200, epoch: 3 | loss: 0.0204777
	speed: 0.0376s/iter; left time: 1512.3307s
	iters: 300, epoch: 3 | loss: 0.0063080
	speed: 0.0400s/iter; left time: 1608.9352s
	iters: 400, epoch: 3 | loss: 0.0477390
	speed: 0.0443s/iter; left time: 1775.7711s
Epoch: 3 cost time: 16.979861736297607
Epoch: 3, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (-0.967712 --> -0.979081).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0535234
	speed: 0.1936s/iter; left time: 7736.9917s
	iters: 200, epoch: 4 | loss: 0.0002135
	speed: 0.0397s/iter; left time: 1580.5992s
	iters: 300, epoch: 4 | loss: 0.0032781
	speed: 0.0378s/iter; left time: 1504.6176s
	iters: 400, epoch: 4 | loss: 0.0068722
	speed: 0.0408s/iter; left time: 1619.4005s
Epoch: 4 cost time: 17.516368865966797
Epoch: 4, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0011528
	speed: 0.2094s/iter; left time: 8282.7071s
	iters: 200, epoch: 5 | loss: 0.0006611
	speed: 0.0448s/iter; left time: 1769.2071s
	iters: 300, epoch: 5 | loss: 0.0583353
	speed: 0.0361s/iter; left time: 1420.0980s
	iters: 400, epoch: 5 | loss: 0.5208711
	speed: 0.0339s/iter; left time: 1332.3105s
Epoch: 5 cost time: 17.664053916931152
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0001495
	speed: 0.2066s/iter; left time: 8087.3533s
	iters: 200, epoch: 6 | loss: 0.0040597
	speed: 0.0383s/iter; left time: 1495.7563s
	iters: 300, epoch: 6 | loss: 0.0705030
	speed: 0.0327s/iter; left time: 1274.2521s
	iters: 400, epoch: 6 | loss: 0.0004643
	speed: 0.0376s/iter; left time: 1459.6083s
Epoch: 6 cost time: 16.009814023971558
Epoch: 6, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0036354
	speed: 0.2151s/iter; left time: 8330.9625s
	iters: 200, epoch: 7 | loss: 0.0001625
	speed: 0.0355s/iter; left time: 1369.3264s
	iters: 300, epoch: 7 | loss: 0.0000008
	speed: 0.0408s/iter; left time: 1573.3632s
	iters: 400, epoch: 7 | loss: 0.0012718
	speed: 0.0373s/iter; left time: 1434.0927s
Epoch: 7 cost time: 16.615123748779297
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000947
	speed: 0.2096s/iter; left time: 8031.5040s
	iters: 200, epoch: 8 | loss: 0.0063792
	speed: 0.0385s/iter; left time: 1471.3178s
	iters: 300, epoch: 8 | loss: 0.0007398
	speed: 0.0378s/iter; left time: 1441.2500s
	iters: 400, epoch: 8 | loss: 0.0074402
	speed: 0.0366s/iter; left time: 1390.6196s
Epoch: 8 cost time: 17.154826402664185
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.167 Vali Acc: 0.966 Test Loss: 0.167 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000070
	speed: 0.2117s/iter; left time: 8021.6696s
	iters: 200, epoch: 9 | loss: 0.0000179
	speed: 0.0423s/iter; left time: 1597.4130s
	iters: 300, epoch: 9 | loss: 0.0008885
	speed: 0.0379s/iter; left time: 1427.9509s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0382s/iter; left time: 1436.1684s
Epoch: 9 cost time: 17.46423625946045
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000006
	speed: 0.2133s/iter; left time: 7995.1928s
	iters: 200, epoch: 10 | loss: 0.0078544
	speed: 0.0400s/iter; left time: 1496.0533s
	iters: 300, epoch: 10 | loss: 0.0001165
	speed: 0.0429s/iter; left time: 1600.3243s
	iters: 400, epoch: 10 | loss: 0.0306456
	speed: 0.0442s/iter; left time: 1642.1339s
Epoch: 10 cost time: 17.80176091194153
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0017873
	speed: 0.2093s/iter; left time: 7760.4210s
	iters: 200, epoch: 11 | loss: 0.1429975
	speed: 0.0476s/iter; left time: 1760.2916s
	iters: 300, epoch: 11 | loss: 0.0000003
	speed: 0.0412s/iter; left time: 1520.0988s
	iters: 400, epoch: 11 | loss: 0.0000012
	speed: 0.0408s/iter; left time: 1501.0255s
Epoch: 11 cost time: 18.929848194122314
Epoch: 11, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.184 Vali Acc: 0.969 Test Loss: 0.184 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.4321522
	speed: 0.2046s/iter; left time: 7499.7102s
	iters: 200, epoch: 12 | loss: 0.0000158
	speed: 0.0436s/iter; left time: 1595.4072s
	iters: 300, epoch: 12 | loss: 0.0000194
	speed: 0.0384s/iter; left time: 1400.2388s
	iters: 400, epoch: 12 | loss: 0.0000009
	speed: 0.0404s/iter; left time: 1470.3895s
Epoch: 12 cost time: 17.86116647720337
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0071034
	speed: 0.2076s/iter; left time: 7522.7792s
	iters: 200, epoch: 13 | loss: 0.0472257
	speed: 0.0359s/iter; left time: 1298.9658s
	iters: 300, epoch: 13 | loss: 0.7370265
	speed: 0.0416s/iter; left time: 1498.0069s
	iters: 400, epoch: 13 | loss: 0.0000156
	speed: 0.0469s/iter; left time: 1684.0639s
Epoch: 13 cost time: 17.90998911857605
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.220 Vali Acc: 0.967 Test Loss: 0.220 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
model parameter : 63146
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4059627
	speed: 0.0764s/iter; left time: 3149.5002s
	iters: 200, epoch: 1 | loss: 0.1935691
	speed: 0.0386s/iter; left time: 1586.7450s
	iters: 300, epoch: 1 | loss: 0.2567106
	speed: 0.0391s/iter; left time: 1603.5399s
	iters: 400, epoch: 1 | loss: 0.2189559
	speed: 0.0436s/iter; left time: 1783.4106s
Epoch: 1 cost time: 20.417747497558594
Epoch: 1, Steps: 413 | Train Loss: 0.528 Vali Loss: 0.115 Vali Acc: 0.963 Test Loss: 0.115 Test Acc: 0.963
Validation loss decreased (inf --> -0.962709).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0478595
	speed: 0.2203s/iter; left time: 8984.6495s
	iters: 200, epoch: 2 | loss: 0.3308547
	speed: 0.0413s/iter; left time: 1678.5184s
	iters: 300, epoch: 2 | loss: 0.0047418
	speed: 0.0384s/iter; left time: 1556.8877s
	iters: 400, epoch: 2 | loss: 0.0321156
	speed: 0.0402s/iter; left time: 1626.7264s
Epoch: 2 cost time: 18.057405710220337
Epoch: 2, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
Validation loss decreased (-0.962709 --> -0.973624).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0024093
	speed: 0.2123s/iter; left time: 8570.9949s
	iters: 200, epoch: 3 | loss: 0.0008035
	speed: 0.0356s/iter; left time: 1435.1766s
	iters: 300, epoch: 3 | loss: 0.0660955
	speed: 0.0384s/iter; left time: 1543.5100s
	iters: 400, epoch: 3 | loss: 0.0009029
	speed: 0.0372s/iter; left time: 1490.5663s
Epoch: 3 cost time: 16.19358801841736
Epoch: 3, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0020747
	speed: 0.2153s/iter; left time: 8603.6612s
	iters: 200, epoch: 4 | loss: 0.0006263
	speed: 0.0346s/iter; left time: 1378.4311s
	iters: 300, epoch: 4 | loss: 0.2678342
	speed: 0.0349s/iter; left time: 1389.4139s
	iters: 400, epoch: 4 | loss: 0.0059418
	speed: 0.0395s/iter; left time: 1566.4108s
Epoch: 4 cost time: 16.184941053390503
Epoch: 4, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0014973
	speed: 0.2063s/iter; left time: 8159.0214s
	iters: 200, epoch: 5 | loss: 0.0006617
	speed: 0.0371s/iter; left time: 1465.2122s
	iters: 300, epoch: 5 | loss: 0.0090599
	speed: 0.0350s/iter; left time: 1375.2910s
	iters: 400, epoch: 5 | loss: 0.0081639
	speed: 0.0372s/iter; left time: 1460.7149s
Epoch: 5 cost time: 15.918042421340942
Epoch: 5, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0533208
	speed: 0.1949s/iter; left time: 7627.1468s
	iters: 200, epoch: 6 | loss: 0.0039612
	speed: 0.0348s/iter; left time: 1359.2915s
	iters: 300, epoch: 6 | loss: 0.0009896
	speed: 0.0385s/iter; left time: 1497.3722s
	iters: 400, epoch: 6 | loss: 0.0000532
	speed: 0.0453s/iter; left time: 1757.4348s
Epoch: 6 cost time: 16.84560227394104
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.973624 --> -0.977716).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0094667
	speed: 0.1984s/iter; left time: 7684.5296s
	iters: 200, epoch: 7 | loss: 0.0016309
	speed: 0.0383s/iter; left time: 1477.4888s
	iters: 300, epoch: 7 | loss: 0.0620122
	speed: 0.0437s/iter; left time: 1682.4812s
	iters: 400, epoch: 7 | loss: 0.0605977
	speed: 0.0343s/iter; left time: 1318.7327s
Epoch: 7 cost time: 16.25132393836975
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0022466
	speed: 0.2113s/iter; left time: 8095.7360s
	iters: 200, epoch: 8 | loss: 0.0008624
	speed: 0.0409s/iter; left time: 1560.9642s
	iters: 300, epoch: 8 | loss: 0.0031299
	speed: 0.0377s/iter; left time: 1436.0417s
	iters: 400, epoch: 8 | loss: 0.0180486
	speed: 0.0407s/iter; left time: 1546.1654s
Epoch: 8 cost time: 17.52025079727173
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0047447
	speed: 0.2022s/iter; left time: 7664.5803s
	iters: 200, epoch: 9 | loss: 0.0000378
	speed: 0.0360s/iter; left time: 1360.1433s
	iters: 300, epoch: 9 | loss: 0.0001406
	speed: 0.0415s/iter; left time: 1564.7163s
	iters: 400, epoch: 9 | loss: 0.0000213
	speed: 0.0422s/iter; left time: 1586.1111s
Epoch: 9 cost time: 17.8087420463562
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
Validation loss decreased (-0.977716 --> -0.981809).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0001173
	speed: 0.2064s/iter; left time: 7737.9825s
	iters: 200, epoch: 10 | loss: 0.0006914
	speed: 0.0413s/iter; left time: 1544.0425s
	iters: 300, epoch: 10 | loss: 0.0000023
	speed: 0.0386s/iter; left time: 1437.7225s
	iters: 400, epoch: 10 | loss: 0.3327222
	speed: 0.0360s/iter; left time: 1339.1913s
Epoch: 10 cost time: 16.626102685928345
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.169 Vali Acc: 0.971 Test Loss: 0.169 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0003574
	speed: 0.2149s/iter; left time: 7965.3414s
	iters: 200, epoch: 11 | loss: 0.0436419
	speed: 0.0402s/iter; left time: 1486.4181s
	iters: 300, epoch: 11 | loss: 0.0053225
	speed: 0.0370s/iter; left time: 1365.2518s
	iters: 400, epoch: 11 | loss: 0.0001344
	speed: 0.0361s/iter; left time: 1328.5498s
Epoch: 11 cost time: 16.673120975494385
Epoch: 11, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.145 Vali Acc: 0.972 Test Loss: 0.145 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000570
	speed: 0.1935s/iter; left time: 7093.2106s
	iters: 200, epoch: 12 | loss: 0.0000188
	speed: 0.0324s/iter; left time: 1183.7853s
	iters: 300, epoch: 12 | loss: 0.0000078
	speed: 0.0367s/iter; left time: 1336.7782s
	iters: 400, epoch: 12 | loss: 0.0000152
	speed: 0.0338s/iter; left time: 1228.2445s
Epoch: 12 cost time: 15.551940202713013
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0001561
	speed: 0.1965s/iter; left time: 7122.2746s
	iters: 200, epoch: 13 | loss: 0.0110867
	speed: 0.0386s/iter; left time: 1394.3248s
	iters: 300, epoch: 13 | loss: 0.0000977
	speed: 0.0366s/iter; left time: 1318.0150s
	iters: 400, epoch: 13 | loss: 0.0000310
	speed: 0.0352s/iter; left time: 1265.4638s
Epoch: 13 cost time: 16.100534915924072
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.167 Vali Acc: 0.971 Test Loss: 0.167 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000040
	speed: 0.1908s/iter; left time: 6837.4874s
	iters: 200, epoch: 14 | loss: 0.0000010
	speed: 0.0360s/iter; left time: 1287.7510s
	iters: 300, epoch: 14 | loss: 0.0002478
	speed: 0.0351s/iter; left time: 1251.9292s
	iters: 400, epoch: 14 | loss: 0.0000002
	speed: 0.0380s/iter; left time: 1349.3305s
Epoch: 14 cost time: 16.096553325653076
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.168 Vali Acc: 0.966 Test Loss: 0.168 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000127
	speed: 0.1941s/iter; left time: 6876.2915s
	iters: 200, epoch: 15 | loss: 0.0000002
	speed: 0.0385s/iter; left time: 1358.1655s
	iters: 300, epoch: 15 | loss: 0.0039716
	speed: 0.0385s/iter; left time: 1355.8658s
	iters: 400, epoch: 15 | loss: 0.0000056
	speed: 0.0369s/iter; left time: 1294.2858s
Epoch: 15 cost time: 16.65105700492859
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1487167
	speed: 0.1901s/iter; left time: 6654.3645s
	iters: 200, epoch: 16 | loss: 0.0002013
	speed: 0.0441s/iter; left time: 1541.0523s
	iters: 300, epoch: 16 | loss: 0.0001851
	speed: 0.0424s/iter; left time: 1476.3383s
	iters: 400, epoch: 16 | loss: 0.0031652
	speed: 0.0385s/iter; left time: 1335.7059s
Epoch: 16 cost time: 17.460367679595947
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000759
	speed: 0.2083s/iter; left time: 7206.5364s
	iters: 200, epoch: 17 | loss: 0.0000003
	speed: 0.0413s/iter; left time: 1425.7803s
	iters: 300, epoch: 17 | loss: 0.0056046
	speed: 0.0390s/iter; left time: 1341.4226s
	iters: 400, epoch: 17 | loss: 0.0000487
	speed: 0.0372s/iter; left time: 1274.5649s
Epoch: 17 cost time: 17.211263179779053
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000697
	speed: 0.1962s/iter; left time: 6706.3083s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0352s/iter; left time: 1200.5641s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 1213.1236s
	iters: 400, epoch: 18 | loss: 0.4351196
	speed: 0.0353s/iter; left time: 1197.1707s
Epoch: 18 cost time: 15.910251379013062
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.194 Vali Acc: 0.974 Test Loss: 0.194 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000736
	speed: 0.1905s/iter; left time: 6431.7492s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 1407.4130s
	iters: 300, epoch: 19 | loss: 0.0001402
	speed: 0.0405s/iter; left time: 1359.5395s
	iters: 400, epoch: 19 | loss: 0.0002377
	speed: 0.0367s/iter; left time: 1227.8352s
Epoch: 19 cost time: 16.86005139350891
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 46666
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0261862
	speed: 0.0695s/iter; left time: 2863.6388s
	iters: 200, epoch: 1 | loss: 0.2067288
	speed: 0.0377s/iter; left time: 1550.5634s
	iters: 300, epoch: 1 | loss: 0.3404638
	speed: 0.0398s/iter; left time: 1633.2050s
	iters: 400, epoch: 1 | loss: 0.0997437
	speed: 0.0341s/iter; left time: 1393.3960s
Epoch: 1 cost time: 18.781190872192383
Epoch: 1, Steps: 413 | Train Loss: 0.567 Vali Loss: 0.130 Vali Acc: 0.956 Test Loss: 0.130 Test Acc: 0.956
Validation loss decreased (inf --> -0.955888).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0755267
	speed: 0.1985s/iter; left time: 8097.8390s
	iters: 200, epoch: 2 | loss: 0.0881807
	speed: 0.0398s/iter; left time: 1618.0806s
	iters: 300, epoch: 2 | loss: 0.0214716
	speed: 0.0384s/iter; left time: 1558.8937s
	iters: 400, epoch: 2 | loss: 0.2215849
	speed: 0.0357s/iter; left time: 1444.7242s
Epoch: 2 cost time: 17.022622108459473
Epoch: 2, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0113820
	speed: 0.1822s/iter; left time: 7356.2613s
	iters: 200, epoch: 3 | loss: 0.0072587
	speed: 0.0393s/iter; left time: 1584.7199s
	iters: 300, epoch: 3 | loss: 0.0056597
	speed: 0.0373s/iter; left time: 1497.0113s
	iters: 400, epoch: 3 | loss: 0.0083665
	speed: 0.0320s/iter; left time: 1281.1769s
Epoch: 3 cost time: 16.030958890914917
Epoch: 3, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.081 Vali Acc: 0.974 Test Loss: 0.081 Test Acc: 0.974
Validation loss decreased (-0.955888 --> -0.973624).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0672743
	speed: 0.1882s/iter; left time: 7521.6766s
	iters: 200, epoch: 4 | loss: 0.0056223
	speed: 0.0372s/iter; left time: 1482.7642s
	iters: 300, epoch: 4 | loss: 0.0155108
	speed: 0.0368s/iter; left time: 1461.6968s
	iters: 400, epoch: 4 | loss: 0.0257911
	speed: 0.0305s/iter; left time: 1209.0265s
Epoch: 4 cost time: 15.69921612739563
Epoch: 4, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.077 Vali Acc: 0.974 Test Loss: 0.077 Test Acc: 0.974
Validation loss decreased (-0.973624 --> -0.974078).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0055564
	speed: 0.1740s/iter; left time: 6883.2110s
	iters: 200, epoch: 5 | loss: 0.0029078
	speed: 0.0383s/iter; left time: 1509.2954s
	iters: 300, epoch: 5 | loss: 0.0988335
	speed: 0.0300s/iter; left time: 1179.4197s
	iters: 400, epoch: 5 | loss: 0.0114623
	speed: 0.0331s/iter; left time: 1298.8387s
Epoch: 5 cost time: 14.849441289901733
Epoch: 5, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.974078 --> -0.979990).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0023912
	speed: 0.1722s/iter; left time: 6737.6121s
	iters: 200, epoch: 6 | loss: 0.0004015
	speed: 0.0352s/iter; left time: 1374.9761s
	iters: 300, epoch: 6 | loss: 0.0035570
	speed: 0.0326s/iter; left time: 1268.6074s
	iters: 400, epoch: 6 | loss: 0.0017014
	speed: 0.0295s/iter; left time: 1145.6841s
Epoch: 6 cost time: 14.490323305130005
Epoch: 6, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0017962
	speed: 0.1797s/iter; left time: 6959.4973s
	iters: 200, epoch: 7 | loss: 0.0083620
	speed: 0.0354s/iter; left time: 1367.7337s
	iters: 300, epoch: 7 | loss: 0.0170309
	speed: 0.0388s/iter; left time: 1495.5252s
	iters: 400, epoch: 7 | loss: 0.0000720
	speed: 0.0341s/iter; left time: 1310.4427s
Epoch: 7 cost time: 15.666647672653198
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0061473
	speed: 0.1683s/iter; left time: 6445.8495s
	iters: 200, epoch: 8 | loss: 0.0501259
	speed: 0.0331s/iter; left time: 1264.0445s
	iters: 300, epoch: 8 | loss: 0.0034464
	speed: 0.0337s/iter; left time: 1285.1712s
	iters: 400, epoch: 8 | loss: 0.0110444
	speed: 0.0321s/iter; left time: 1219.3724s
Epoch: 8 cost time: 14.132851600646973
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0023770
	speed: 0.1825s/iter; left time: 6915.5718s
	iters: 200, epoch: 9 | loss: 0.0643629
	speed: 0.0354s/iter; left time: 1339.7068s
	iters: 300, epoch: 9 | loss: 0.0690970
	speed: 0.0386s/iter; left time: 1453.6084s
	iters: 400, epoch: 9 | loss: 0.0000002
	speed: 0.0379s/iter; left time: 1424.5970s
Epoch: 9 cost time: 16.564529180526733
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000019
	speed: 0.1908s/iter; left time: 7150.7443s
	iters: 200, epoch: 10 | loss: 0.0000409
	speed: 0.0407s/iter; left time: 1521.4085s
	iters: 300, epoch: 10 | loss: 0.0001605
	speed: 0.0431s/iter; left time: 1605.8315s
	iters: 400, epoch: 10 | loss: 0.0000168
	speed: 0.0398s/iter; left time: 1481.2763s
Epoch: 10 cost time: 18.289501905441284
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0065988
	speed: 0.1786s/iter; left time: 6622.5995s
	iters: 200, epoch: 11 | loss: 0.0008563
	speed: 0.0358s/iter; left time: 1323.4055s
	iters: 300, epoch: 11 | loss: 0.0168504
	speed: 0.0322s/iter; left time: 1186.4347s
	iters: 400, epoch: 11 | loss: 0.0000018
	speed: 0.0325s/iter; left time: 1194.3302s
Epoch: 11 cost time: 14.661988258361816
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0007505
	speed: 0.1964s/iter; left time: 7199.0222s
	iters: 200, epoch: 12 | loss: 0.0030291
	speed: 0.0345s/iter; left time: 1262.2827s
	iters: 300, epoch: 12 | loss: 0.0000245
	speed: 0.0370s/iter; left time: 1349.6776s
	iters: 400, epoch: 12 | loss: 0.0000118
	speed: 0.0401s/iter; left time: 1457.2925s
Epoch: 12 cost time: 16.084287643432617
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0001922
	speed: 0.2010s/iter; left time: 7284.4402s
	iters: 200, epoch: 13 | loss: 0.0162727
	speed: 0.0344s/iter; left time: 1242.6546s
	iters: 300, epoch: 13 | loss: 0.0050979
	speed: 0.0325s/iter; left time: 1172.1006s
	iters: 400, epoch: 13 | loss: 0.0000003
	speed: 0.0365s/iter; left time: 1311.4249s
Epoch: 13 cost time: 15.732104063034058
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0007850
	speed: 0.1997s/iter; left time: 7156.9200s
	iters: 200, epoch: 14 | loss: 0.0000069
	speed: 0.0321s/iter; left time: 1148.6562s
	iters: 300, epoch: 14 | loss: 0.0001664
	speed: 0.0364s/iter; left time: 1296.6546s
	iters: 400, epoch: 14 | loss: 0.0000022
	speed: 0.0389s/iter; left time: 1382.5940s
Epoch: 14 cost time: 16.218721628189087
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.254 Vali Acc: 0.963 Test Loss: 0.254 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000036
	speed: 0.1863s/iter; left time: 6597.9441s
	iters: 200, epoch: 15 | loss: 0.0712671
	speed: 0.0344s/iter; left time: 1213.3074s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0328s/iter; left time: 1154.7892s
	iters: 400, epoch: 15 | loss: 0.0001318
	speed: 0.0337s/iter; left time: 1182.8122s
Epoch: 15 cost time: 14.602546691894531
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
Validation loss decreased (-0.979990 --> -0.980444).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000001
	speed: 0.1781s/iter; left time: 6233.3173s
	iters: 200, epoch: 16 | loss: 0.0000021
	speed: 0.0315s/iter; left time: 1099.1912s
	iters: 300, epoch: 16 | loss: 0.0002290
	speed: 0.0328s/iter; left time: 1141.3338s
	iters: 400, epoch: 16 | loss: 0.0000013
	speed: 0.0311s/iter; left time: 1078.5215s
Epoch: 16 cost time: 14.566410779953003
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000028
	speed: 0.1663s/iter; left time: 5753.0350s
	iters: 200, epoch: 17 | loss: 0.0074736
	speed: 0.0349s/iter; left time: 1204.6019s
	iters: 300, epoch: 17 | loss: 0.0119071
	speed: 0.0322s/iter; left time: 1106.1649s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0337s/iter; left time: 1154.4232s
Epoch: 17 cost time: 14.401916027069092
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0006652
	speed: 0.1865s/iter; left time: 6373.2979s
	iters: 200, epoch: 18 | loss: 0.0000007
	speed: 0.0348s/iter; left time: 1185.5616s
	iters: 300, epoch: 18 | loss: 0.0200133
	speed: 0.0373s/iter; left time: 1266.5556s
	iters: 400, epoch: 18 | loss: 0.0000017
	speed: 0.0327s/iter; left time: 1108.2674s
Epoch: 18 cost time: 15.053678750991821
Epoch: 18, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0007316
	speed: 0.1816s/iter; left time: 6132.7417s
	iters: 200, epoch: 19 | loss: 0.0016498
	speed: 0.0330s/iter; left time: 1110.4719s
	iters: 300, epoch: 19 | loss: 0.0000088
	speed: 0.0312s/iter; left time: 1045.8075s
	iters: 400, epoch: 19 | loss: 0.0000028
	speed: 0.0299s/iter; left time: 999.3392s
Epoch: 19 cost time: 13.667603731155396
Epoch: 19, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.204 Vali Acc: 0.967 Test Loss: 0.204 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0002529
	speed: 0.1763s/iter; left time: 5881.0305s
	iters: 200, epoch: 20 | loss: 0.0000021
	speed: 0.0323s/iter; left time: 1072.6964s
	iters: 300, epoch: 20 | loss: 0.0000022
	speed: 0.0324s/iter; left time: 1072.9265s
	iters: 400, epoch: 20 | loss: 0.0000138
	speed: 0.0324s/iter; left time: 1070.5332s
Epoch: 20 cost time: 14.546469449996948
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.163 Vali Acc: 0.976 Test Loss: 0.163 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000091
	speed: 0.1793s/iter; left time: 5906.2301s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0296s/iter; left time: 972.0786s
	iters: 300, epoch: 21 | loss: 0.0000268
	speed: 0.0303s/iter; left time: 991.1409s
	iters: 400, epoch: 21 | loss: 0.0000194
	speed: 0.0333s/iter; left time: 1087.1647s
Epoch: 21 cost time: 13.706452131271362
Epoch: 21, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0007202
	speed: 0.1665s/iter; left time: 5416.3860s
	iters: 200, epoch: 22 | loss: 0.0007072
	speed: 0.0307s/iter; left time: 996.0471s
	iters: 300, epoch: 22 | loss: 0.0000040
	speed: 0.0299s/iter; left time: 966.0637s
	iters: 400, epoch: 22 | loss: 0.0000011
	speed: 0.0281s/iter; left time: 906.8880s
Epoch: 22 cost time: 13.28406548500061
Epoch: 22, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.183 Vali Acc: 0.973 Test Loss: 0.183 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000606
	speed: 0.1607s/iter; left time: 5162.0087s
	iters: 200, epoch: 23 | loss: 0.0000009
	speed: 0.0361s/iter; left time: 1156.9007s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 1077.9371s
	iters: 400, epoch: 23 | loss: 0.0051118
	speed: 0.0329s/iter; left time: 1048.1684s
Epoch: 23 cost time: 14.711199522018433
Epoch: 23, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.254 Vali Acc: 0.965 Test Loss: 0.254 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000006
	speed: 0.1708s/iter; left time: 5414.3142s
	iters: 200, epoch: 24 | loss: 0.0001320
	speed: 0.0318s/iter; left time: 1004.1428s
	iters: 300, epoch: 24 | loss: 0.0000002
	speed: 0.0376s/iter; left time: 1184.0529s
	iters: 400, epoch: 24 | loss: 0.0003056
	speed: 0.0330s/iter; left time: 1036.8634s
Epoch: 24 cost time: 15.061297178268433
Epoch: 24, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.131 Vali Acc: 0.979 Test Loss: 0.131 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000006
	speed: 0.1744s/iter; left time: 5456.2521s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0366s/iter; left time: 1142.8132s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 1022.3555s
	iters: 400, epoch: 25 | loss: 0.2156265
	speed: 0.0358s/iter; left time: 1109.5619s
Epoch: 25 cost time: 15.33773684501648
Epoch: 25, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.179 Vali Acc: 0.973 Test Loss: 0.179 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm32_nh4_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 38506
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2693351
	speed: 0.0738s/iter; left time: 3039.4133s
	iters: 200, epoch: 1 | loss: 0.1466958
	speed: 0.0419s/iter; left time: 1723.4131s
	iters: 300, epoch: 1 | loss: 0.1257565
	speed: 0.0398s/iter; left time: 1630.9145s
	iters: 400, epoch: 1 | loss: 0.0632181
	speed: 0.0440s/iter; left time: 1799.4816s
Epoch: 1 cost time: 20.598708868026733
Epoch: 1, Steps: 413 | Train Loss: 0.405 Vali Loss: 0.112 Vali Acc: 0.964 Test Loss: 0.112 Test Acc: 0.964
Validation loss decreased (inf --> -0.964073).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0047270
	speed: 0.1992s/iter; left time: 8126.1791s
	iters: 200, epoch: 2 | loss: 0.1042324
	speed: 0.0404s/iter; left time: 1642.6378s
	iters: 300, epoch: 2 | loss: 0.0062465
	speed: 0.0361s/iter; left time: 1465.1220s
	iters: 400, epoch: 2 | loss: 0.2352757
	speed: 0.0393s/iter; left time: 1589.9092s
Epoch: 2 cost time: 17.283007860183716
Epoch: 2, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0977353
	speed: 0.1957s/iter; left time: 7900.4337s
	iters: 200, epoch: 3 | loss: 0.2277947
	speed: 0.0381s/iter; left time: 1535.8917s
	iters: 300, epoch: 3 | loss: 0.0507737
	speed: 0.0444s/iter; left time: 1783.8622s
	iters: 400, epoch: 3 | loss: 0.0013297
	speed: 0.0380s/iter; left time: 1522.0660s
Epoch: 3 cost time: 17.620011806488037
Epoch: 3, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
Validation loss decreased (-0.964073 --> -0.971349).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0466468
	speed: 0.1872s/iter; left time: 7480.1198s
	iters: 200, epoch: 4 | loss: 0.0006696
	speed: 0.0493s/iter; left time: 1964.9384s
	iters: 300, epoch: 4 | loss: 0.0000465
	speed: 0.0453s/iter; left time: 1800.7970s
	iters: 400, epoch: 4 | loss: 0.4933265
	speed: 0.0453s/iter; left time: 1796.1546s
Epoch: 4 cost time: 19.836578845977783
Epoch: 4, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0728541
	speed: 0.2031s/iter; left time: 8030.6922s
	iters: 200, epoch: 5 | loss: 0.0054548
	speed: 0.0445s/iter; left time: 1756.4240s
	iters: 300, epoch: 5 | loss: 0.0017932
	speed: 0.0423s/iter; left time: 1662.6536s
	iters: 400, epoch: 5 | loss: 0.0000014
	speed: 0.0445s/iter; left time: 1748.0508s
Epoch: 5 cost time: 19.19103980064392
Epoch: 5, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.320 Vali Acc: 0.948 Test Loss: 0.320 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000760
	speed: 0.1850s/iter; left time: 7239.7278s
	iters: 200, epoch: 6 | loss: 0.0108909
	speed: 0.0377s/iter; left time: 1471.7115s
	iters: 300, epoch: 6 | loss: 0.3247978
	speed: 0.0397s/iter; left time: 1546.8959s
	iters: 400, epoch: 6 | loss: 0.0109086
	speed: 0.0418s/iter; left time: 1621.4731s
Epoch: 6 cost time: 16.841302156448364
Epoch: 6, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.302 Vali Acc: 0.953 Test Loss: 0.302 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0010703
	speed: 0.1961s/iter; left time: 7594.3335s
	iters: 200, epoch: 7 | loss: 0.0000017
	speed: 0.0394s/iter; left time: 1519.8175s
	iters: 300, epoch: 7 | loss: 0.0104404
	speed: 0.0460s/iter; left time: 1772.3684s
	iters: 400, epoch: 7 | loss: 0.0721988
	speed: 0.0410s/iter; left time: 1576.7740s
Epoch: 7 cost time: 18.138312816619873
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.221 Vali Acc: 0.966 Test Loss: 0.221 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0110488
	speed: 0.1860s/iter; left time: 7125.5999s
	iters: 200, epoch: 8 | loss: 0.1744168
	speed: 0.0397s/iter; left time: 1515.6816s
	iters: 300, epoch: 8 | loss: 0.0000014
	speed: 0.0357s/iter; left time: 1359.3149s
	iters: 400, epoch: 8 | loss: 0.0012429
	speed: 0.0387s/iter; left time: 1470.9065s
Epoch: 8 cost time: 16.737188816070557
Epoch: 8, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.327 Vali Acc: 0.958 Test Loss: 0.327 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000643
	speed: 0.1905s/iter; left time: 7218.7373s
	iters: 200, epoch: 9 | loss: 0.0077287
	speed: 0.0380s/iter; left time: 1435.7834s
	iters: 300, epoch: 9 | loss: 0.0084767
	speed: 0.0421s/iter; left time: 1586.2250s
	iters: 400, epoch: 9 | loss: 0.0000470
	speed: 0.0444s/iter; left time: 1670.6723s
Epoch: 9 cost time: 17.726618766784668
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.266 Vali Acc: 0.959 Test Loss: 0.266 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.5312625
	speed: 0.1965s/iter; left time: 7367.1013s
	iters: 200, epoch: 10 | loss: 0.0000515
	speed: 0.0444s/iter; left time: 1661.0556s
	iters: 300, epoch: 10 | loss: 0.0000007
	speed: 0.0437s/iter; left time: 1630.8542s
	iters: 400, epoch: 10 | loss: 0.0000624
	speed: 0.0441s/iter; left time: 1639.1775s
Epoch: 10 cost time: 18.749920129776
Epoch: 10, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.285 Vali Acc: 0.958 Test Loss: 0.285 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000043
	speed: 0.2013s/iter; left time: 7462.5923s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 1687.8374s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0431s/iter; left time: 1588.6476s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0465s/iter; left time: 1711.6312s
Epoch: 11 cost time: 19.677342653274536
Epoch: 11, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.293 Vali Acc: 0.965 Test Loss: 0.293 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0011563
	speed: 0.2066s/iter; left time: 7572.4591s
	iters: 200, epoch: 12 | loss: 0.0050839
	speed: 0.0442s/iter; left time: 1615.0633s
	iters: 300, epoch: 12 | loss: 0.0049655
	speed: 0.0389s/iter; left time: 1419.3069s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0484s/iter; left time: 1760.5653s
Epoch: 12 cost time: 18.794420957565308
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.445 Vali Acc: 0.960 Test Loss: 0.445 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0578925
	speed: 0.1969s/iter; left time: 7137.4870s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0397s/iter; left time: 1435.2723s
	iters: 300, epoch: 13 | loss: 0.0000007
	speed: 0.0414s/iter; left time: 1491.9941s
	iters: 400, epoch: 13 | loss: 0.1019712
	speed: 0.0381s/iter; left time: 1369.1729s
Epoch: 13 cost time: 16.724874019622803
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.303 Vali Acc: 0.967 Test Loss: 0.303 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9713506139154161
model parameter : 107466
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4038113
	speed: 0.0780s/iter; left time: 3212.8626s
	iters: 200, epoch: 1 | loss: 0.0370358
	speed: 0.0399s/iter; left time: 1641.2249s
	iters: 300, epoch: 1 | loss: 0.0201722
	speed: 0.0384s/iter; left time: 1572.5235s
	iters: 400, epoch: 1 | loss: 0.5033236
	speed: 0.0424s/iter; left time: 1734.3772s
Epoch: 1 cost time: 20.73354411125183
Epoch: 1, Steps: 413 | Train Loss: 0.430 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (inf --> -0.949521).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5440743
	speed: 0.2096s/iter; left time: 8549.8460s
	iters: 200, epoch: 2 | loss: 0.4705972
	speed: 0.0378s/iter; left time: 1538.5549s
	iters: 300, epoch: 2 | loss: 0.4721951
	speed: 0.0368s/iter; left time: 1495.6379s
	iters: 400, epoch: 2 | loss: 0.4649737
	speed: 0.0365s/iter; left time: 1476.1365s
Epoch: 2 cost time: 16.389669179916382
Epoch: 2, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.949521 --> -0.957707).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0453948
	speed: 0.1983s/iter; left time: 8007.5274s
	iters: 200, epoch: 3 | loss: 0.5668778
	speed: 0.0379s/iter; left time: 1526.6727s
	iters: 300, epoch: 3 | loss: 0.0528523
	speed: 0.0410s/iter; left time: 1647.5207s
	iters: 400, epoch: 3 | loss: 0.0594005
	speed: 0.0390s/iter; left time: 1561.0462s
Epoch: 3 cost time: 16.796192407608032
Epoch: 3, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.180 Vali Acc: 0.955 Test Loss: 0.180 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2928069
	speed: 0.1907s/iter; left time: 7620.0055s
	iters: 200, epoch: 4 | loss: 0.0028666
	speed: 0.0466s/iter; left time: 1858.8266s
	iters: 300, epoch: 4 | loss: 0.0018322
	speed: 0.0387s/iter; left time: 1538.4051s
	iters: 400, epoch: 4 | loss: 0.0748448
	speed: 0.0396s/iter; left time: 1569.2681s
Epoch: 4 cost time: 17.793009996414185
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.169 Vali Acc: 0.964 Test Loss: 0.169 Test Acc: 0.964
Validation loss decreased (-0.957707 --> -0.963618).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0043175
	speed: 0.1945s/iter; left time: 7690.5953s
	iters: 200, epoch: 5 | loss: 0.0939619
	speed: 0.0354s/iter; left time: 1396.0080s
	iters: 300, epoch: 5 | loss: 0.0296455
	speed: 0.0421s/iter; left time: 1656.5146s
	iters: 400, epoch: 5 | loss: 0.4028314
	speed: 0.0370s/iter; left time: 1451.0573s
Epoch: 5 cost time: 16.467248916625977
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.178 Vali Acc: 0.965 Test Loss: 0.178 Test Acc: 0.965
Validation loss decreased (-0.963618 --> -0.965437).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0002246
	speed: 0.2053s/iter; left time: 8036.3784s
	iters: 200, epoch: 6 | loss: 0.0000772
	speed: 0.0433s/iter; left time: 1691.4487s
	iters: 300, epoch: 6 | loss: 0.0699450
	speed: 0.0405s/iter; left time: 1576.5017s
	iters: 400, epoch: 6 | loss: 0.0000008
	speed: 0.0339s/iter; left time: 1316.0109s
Epoch: 6 cost time: 17.57930064201355
Epoch: 6, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.169 Vali Acc: 0.961 Test Loss: 0.169 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0009310
	speed: 0.2036s/iter; left time: 7885.9261s
	iters: 200, epoch: 7 | loss: 0.0000911
	speed: 0.0409s/iter; left time: 1580.9958s
	iters: 300, epoch: 7 | loss: 0.0005391
	speed: 0.0415s/iter; left time: 1599.8060s
	iters: 400, epoch: 7 | loss: 0.0000015
	speed: 0.0452s/iter; left time: 1737.3073s
Epoch: 7 cost time: 17.7493417263031
Epoch: 7, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.171 Vali Acc: 0.969 Test Loss: 0.171 Test Acc: 0.969
Validation loss decreased (-0.965437 --> -0.969075).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0003451
	speed: 0.2008s/iter; left time: 7692.0461s
	iters: 200, epoch: 8 | loss: 0.0000358
	speed: 0.0409s/iter; left time: 1561.4710s
	iters: 300, epoch: 8 | loss: 0.0010128
	speed: 0.0446s/iter; left time: 1700.6496s
	iters: 400, epoch: 8 | loss: 0.0000200
	speed: 0.0445s/iter; left time: 1689.8772s
Epoch: 8 cost time: 18.03438138961792
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.208 Vali Acc: 0.966 Test Loss: 0.208 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0433157
	speed: 0.2088s/iter; left time: 7911.9076s
	iters: 200, epoch: 9 | loss: 0.0000122
	speed: 0.0447s/iter; left time: 1690.3348s
	iters: 300, epoch: 9 | loss: 0.0027877
	speed: 0.0484s/iter; left time: 1826.3766s
	iters: 400, epoch: 9 | loss: 0.0094794
	speed: 0.0447s/iter; left time: 1680.6381s
Epoch: 9 cost time: 19.02236557006836
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
Validation loss decreased (-0.969075 --> -0.971804).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000401
	speed: 0.1980s/iter; left time: 7421.5952s
	iters: 200, epoch: 10 | loss: 0.0000039
	speed: 0.0396s/iter; left time: 1478.6829s
	iters: 300, epoch: 10 | loss: 0.0000101
	speed: 0.0415s/iter; left time: 1547.4026s
	iters: 400, epoch: 10 | loss: 0.0000002
	speed: 0.0418s/iter; left time: 1555.0141s
Epoch: 10 cost time: 17.46291422843933
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.307 Vali Acc: 0.960 Test Loss: 0.307 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000003
	speed: 0.2129s/iter; left time: 7893.6503s
	iters: 200, epoch: 11 | loss: 0.0000020
	speed: 0.0399s/iter; left time: 1474.7188s
	iters: 300, epoch: 11 | loss: 0.0000242
	speed: 0.0343s/iter; left time: 1264.5213s
	iters: 400, epoch: 11 | loss: 0.0028542
	speed: 0.0433s/iter; left time: 1593.8141s
Epoch: 11 cost time: 17.600683212280273
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.265 Vali Acc: 0.963 Test Loss: 0.265 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0005818
	speed: 0.2031s/iter; left time: 7444.1774s
	iters: 200, epoch: 12 | loss: 0.0000009
	speed: 0.0378s/iter; left time: 1383.3394s
	iters: 300, epoch: 12 | loss: 0.0000406
	speed: 0.0418s/iter; left time: 1524.3478s
	iters: 400, epoch: 12 | loss: 0.0000296
	speed: 0.0331s/iter; left time: 1204.4561s
Epoch: 12 cost time: 16.906253337860107
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.964 Test Loss: 0.230 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1985s/iter; left time: 7193.6179s
	iters: 200, epoch: 13 | loss: 0.1113933
	speed: 0.0398s/iter; left time: 1437.0203s
	iters: 300, epoch: 13 | loss: 0.0002557
	speed: 0.0438s/iter; left time: 1578.4462s
	iters: 400, epoch: 13 | loss: 0.0000751
	speed: 0.0406s/iter; left time: 1458.7286s
Epoch: 13 cost time: 17.306142568588257
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.227 Vali Acc: 0.963 Test Loss: 0.227 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000318
	speed: 0.2048s/iter; left time: 7337.6136s
	iters: 200, epoch: 14 | loss: 0.0017073
	speed: 0.0398s/iter; left time: 1420.4286s
	iters: 300, epoch: 14 | loss: 0.0132602
	speed: 0.0458s/iter; left time: 1631.4887s
	iters: 400, epoch: 14 | loss: 0.0000128
	speed: 0.0427s/iter; left time: 1517.2333s
Epoch: 14 cost time: 18.715533018112183
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0605736
	speed: 0.2224s/iter; left time: 7877.9895s
	iters: 200, epoch: 15 | loss: 0.0000008
	speed: 0.0407s/iter; left time: 1437.3338s
	iters: 300, epoch: 15 | loss: 0.2007412
	speed: 0.0428s/iter; left time: 1506.7966s
	iters: 400, epoch: 15 | loss: 0.0000004
	speed: 0.0439s/iter; left time: 1543.3946s
Epoch: 15 cost time: 18.658513069152832
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.343 Vali Acc: 0.959 Test Loss: 0.343 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000001
	speed: 0.2074s/iter; left time: 7259.8572s
	iters: 200, epoch: 16 | loss: 0.0000004
	speed: 0.0458s/iter; left time: 1597.8039s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 1798.3956s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 1496.7759s
Epoch: 16 cost time: 19.475500106811523
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.974 Test Loss: 0.206 Test Acc: 0.974
Validation loss decreased (-0.971804 --> -0.973622).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000030
	speed: 0.2088s/iter; left time: 7221.6650s
	iters: 200, epoch: 17 | loss: 0.0000305
	speed: 0.0405s/iter; left time: 1396.7855s
	iters: 300, epoch: 17 | loss: 0.0000002
	speed: 0.0457s/iter; left time: 1572.8853s
	iters: 400, epoch: 17 | loss: 0.0000017
	speed: 0.0405s/iter; left time: 1388.4005s
Epoch: 17 cost time: 18.1694815158844
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.327 Vali Acc: 0.959 Test Loss: 0.327 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000007
	speed: 0.2135s/iter; left time: 7296.1484s
	iters: 200, epoch: 18 | loss: 0.0000289
	speed: 0.0514s/iter; left time: 1752.7428s
	iters: 300, epoch: 18 | loss: 0.0008116
	speed: 0.0402s/iter; left time: 1366.3796s
	iters: 400, epoch: 18 | loss: 0.0004166
	speed: 0.0459s/iter; left time: 1556.2276s
Epoch: 18 cost time: 19.59040880203247
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.275 Vali Acc: 0.968 Test Loss: 0.275 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000009
	speed: 0.2088s/iter; left time: 7051.1128s
	iters: 200, epoch: 19 | loss: 0.0000033
	speed: 0.0383s/iter; left time: 1290.7585s
	iters: 300, epoch: 19 | loss: 0.0000003
	speed: 0.0434s/iter; left time: 1455.4390s
	iters: 400, epoch: 19 | loss: 0.0000003
	speed: 0.0426s/iter; left time: 1426.4662s
Epoch: 19 cost time: 18.311285972595215
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.327 Vali Acc: 0.966 Test Loss: 0.327 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.2039s/iter; left time: 6799.8379s
	iters: 200, epoch: 20 | loss: 0.0482409
	speed: 0.0410s/iter; left time: 1362.3171s
	iters: 300, epoch: 20 | loss: 0.0004496
	speed: 0.0460s/iter; left time: 1525.2779s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0424s/iter; left time: 1402.8665s
Epoch: 20 cost time: 17.791287183761597
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.303 Vali Acc: 0.964 Test Loss: 0.303 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0003994
	speed: 0.1786s/iter; left time: 5882.8712s
	iters: 200, epoch: 21 | loss: 0.0000004
	speed: 0.0400s/iter; left time: 1313.6079s
	iters: 300, epoch: 21 | loss: 0.0000003
	speed: 0.0387s/iter; left time: 1265.5688s
	iters: 400, epoch: 21 | loss: 0.0024685
	speed: 0.0399s/iter; left time: 1302.6484s
Epoch: 21 cost time: 16.8416850566864
Epoch: 21, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.314 Vali Acc: 0.968 Test Loss: 0.314 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.2943574
	speed: 0.1975s/iter; left time: 6423.8298s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 1243.6018s
	iters: 300, epoch: 22 | loss: 0.6110151
	speed: 0.0410s/iter; left time: 1324.9074s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0420s/iter; left time: 1353.1547s
Epoch: 22 cost time: 17.678820610046387
Epoch: 22, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.313 Vali Acc: 0.965 Test Loss: 0.313 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0004808
	speed: 0.2059s/iter; left time: 6612.4827s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 1537.2525s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 1324.8471s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0483s/iter; left time: 1535.9581s
Epoch: 23 cost time: 19.221344470977783
Epoch: 23, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.264 Vali Acc: 0.973 Test Loss: 0.264 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000004
	speed: 0.2073s/iter; left time: 6573.2359s
	iters: 200, epoch: 24 | loss: 0.0000004
	speed: 0.0475s/iter; left time: 1499.8884s
	iters: 300, epoch: 24 | loss: 0.0000007
	speed: 0.0490s/iter; left time: 1544.0734s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 1312.3845s
Epoch: 24 cost time: 19.503499507904053
Epoch: 24, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.381 Vali Acc: 0.960 Test Loss: 0.381 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.2158s/iter; left time: 6751.8633s
	iters: 200, epoch: 25 | loss: 0.0001609
	speed: 0.0442s/iter; left time: 1378.1544s
	iters: 300, epoch: 25 | loss: 0.1353712
	speed: 0.0375s/iter; left time: 1166.0673s
	iters: 400, epoch: 25 | loss: 0.0000002
	speed: 0.0347s/iter; left time: 1074.9685s
Epoch: 25 cost time: 17.498424530029297
Epoch: 25, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.265 Vali Acc: 0.969 Test Loss: 0.265 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2037s/iter; left time: 6289.1418s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 1122.0287s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.0397s/iter; left time: 1218.0397s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 1190.4363s
Epoch: 26 cost time: 16.3875675201416
Epoch: 26, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.337 Vali Acc: 0.964 Test Loss: 0.337 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df256_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9736243747157799
model parameter : 74218
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4202629
	speed: 0.0736s/iter; left time: 3033.2403s
	iters: 200, epoch: 1 | loss: 0.1364534
	speed: 0.0419s/iter; left time: 1722.4040s
	iters: 300, epoch: 1 | loss: 0.4233957
	speed: 0.0413s/iter; left time: 1694.3391s
	iters: 400, epoch: 1 | loss: 0.5486183
	speed: 0.0389s/iter; left time: 1589.7024s
Epoch: 1 cost time: 20.34872841835022
Epoch: 1, Steps: 413 | Train Loss: 0.527 Vali Loss: 0.147 Vali Acc: 0.948 Test Loss: 0.147 Test Acc: 0.948
Validation loss decreased (inf --> -0.947702).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0595823
	speed: 0.2212s/iter; left time: 9023.2666s
	iters: 200, epoch: 2 | loss: 0.0221333
	speed: 0.0440s/iter; left time: 1789.2674s
	iters: 300, epoch: 2 | loss: 0.1580800
	speed: 0.0508s/iter; left time: 2063.3399s
	iters: 400, epoch: 2 | loss: 0.0873728
	speed: 0.0438s/iter; left time: 1773.0302s
Epoch: 2 cost time: 19.775755405426025
Epoch: 2, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.096 Vali Acc: 0.969 Test Loss: 0.096 Test Acc: 0.969
Validation loss decreased (-0.947702 --> -0.969076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1310439
	speed: 0.2147s/iter; left time: 8668.7117s
	iters: 200, epoch: 3 | loss: 0.0710729
	speed: 0.0469s/iter; left time: 1888.8065s
	iters: 300, epoch: 3 | loss: 0.0045144
	speed: 0.0343s/iter; left time: 1378.0043s
	iters: 400, epoch: 3 | loss: 0.0007244
	speed: 0.0427s/iter; left time: 1710.2553s
Epoch: 3 cost time: 17.998340606689453
Epoch: 3, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0019024
	speed: 0.1937s/iter; left time: 7739.3119s
	iters: 200, epoch: 4 | loss: 0.0011488
	speed: 0.0383s/iter; left time: 1525.2969s
	iters: 300, epoch: 4 | loss: 0.0888257
	speed: 0.0346s/iter; left time: 1374.1825s
	iters: 400, epoch: 4 | loss: 0.0180442
	speed: 0.0338s/iter; left time: 1339.2114s
Epoch: 4 cost time: 15.536035776138306
Epoch: 4, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0230198
	speed: 0.1956s/iter; left time: 7734.2651s
	iters: 200, epoch: 5 | loss: 0.0023831
	speed: 0.0362s/iter; left time: 1427.1985s
	iters: 300, epoch: 5 | loss: 0.0012581
	speed: 0.0348s/iter; left time: 1370.7020s
	iters: 400, epoch: 5 | loss: 0.0493865
	speed: 0.0404s/iter; left time: 1584.9707s
Epoch: 5 cost time: 16.484500885009766
Epoch: 5, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0289646
	speed: 0.1826s/iter; left time: 7146.2813s
	iters: 200, epoch: 6 | loss: 0.0000593
	speed: 0.0346s/iter; left time: 1351.6071s
	iters: 300, epoch: 6 | loss: 0.0000036
	speed: 0.0403s/iter; left time: 1568.4423s
	iters: 400, epoch: 6 | loss: 0.0020427
	speed: 0.0350s/iter; left time: 1357.8686s
Epoch: 6 cost time: 15.531510591506958
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0080295
	speed: 0.1965s/iter; left time: 7608.5343s
	iters: 200, epoch: 7 | loss: 0.0146185
	speed: 0.0353s/iter; left time: 1364.9494s
	iters: 300, epoch: 7 | loss: 0.0013512
	speed: 0.0412s/iter; left time: 1586.1990s
	iters: 400, epoch: 7 | loss: 0.0002981
	speed: 0.0347s/iter; left time: 1334.2306s
Epoch: 7 cost time: 16.444859743118286
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.969076 --> -0.975897).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0297760
	speed: 0.1954s/iter; left time: 7487.0904s
	iters: 200, epoch: 8 | loss: 0.0000075
	speed: 0.0401s/iter; left time: 1532.2158s
	iters: 300, epoch: 8 | loss: 0.0105504
	speed: 0.0340s/iter; left time: 1295.0742s
	iters: 400, epoch: 8 | loss: 0.0000332
	speed: 0.0362s/iter; left time: 1375.1472s
Epoch: 8 cost time: 16.673003911972046
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
Validation loss decreased (-0.975897 --> -0.980899).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000071
	speed: 0.1918s/iter; left time: 7269.1742s
	iters: 200, epoch: 9 | loss: 0.0229754
	speed: 0.0356s/iter; left time: 1347.1378s
	iters: 300, epoch: 9 | loss: 0.0034579
	speed: 0.0357s/iter; left time: 1344.3271s
	iters: 400, epoch: 9 | loss: 0.0000324
	speed: 0.0431s/iter; left time: 1621.4275s
Epoch: 9 cost time: 16.73503875732422
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000002
	speed: 0.2110s/iter; left time: 7908.5352s
	iters: 200, epoch: 10 | loss: 0.0441270
	speed: 0.0380s/iter; left time: 1420.0987s
	iters: 300, epoch: 10 | loss: 0.0353113
	speed: 0.0327s/iter; left time: 1220.1073s
	iters: 400, epoch: 10 | loss: 0.0000016
	speed: 0.0431s/iter; left time: 1604.0146s
Epoch: 10 cost time: 16.465097665786743
Epoch: 10, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0201182
	speed: 0.2025s/iter; left time: 7508.2116s
	iters: 200, epoch: 11 | loss: 0.0000601
	speed: 0.0344s/iter; left time: 1270.4968s
	iters: 300, epoch: 11 | loss: 0.0000757
	speed: 0.0402s/iter; left time: 1483.6023s
	iters: 400, epoch: 11 | loss: 0.3274047
	speed: 0.0362s/iter; left time: 1330.9675s
Epoch: 11 cost time: 16.58951187133789
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000004
	speed: 0.1967s/iter; left time: 7211.7790s
	iters: 200, epoch: 12 | loss: 0.0000089
	speed: 0.0395s/iter; left time: 1443.3504s
	iters: 300, epoch: 12 | loss: 0.0000020
	speed: 0.0360s/iter; left time: 1314.2431s
	iters: 400, epoch: 12 | loss: 0.0000101
	speed: 0.0375s/iter; left time: 1364.2626s
Epoch: 12 cost time: 16.77944040298462
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.147 Vali Acc: 0.978 Test Loss: 0.147 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0076787
	speed: 0.2084s/iter; left time: 7554.8110s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.0415s/iter; left time: 1500.0112s
	iters: 300, epoch: 13 | loss: 0.0519868
	speed: 0.0373s/iter; left time: 1343.0191s
	iters: 400, epoch: 13 | loss: 0.2253278
	speed: 0.0356s/iter; left time: 1278.5884s
Epoch: 13 cost time: 17.029706478118896
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.217 Vali Acc: 0.968 Test Loss: 0.217 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0750268
	speed: 0.2211s/iter; left time: 7921.1742s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0441s/iter; left time: 1574.9748s
	iters: 300, epoch: 14 | loss: 0.0002533
	speed: 0.0346s/iter; left time: 1234.2696s
	iters: 400, epoch: 14 | loss: 0.0000043
	speed: 0.0390s/iter; left time: 1386.2501s
Epoch: 14 cost time: 17.943792581558228
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0049539
	speed: 0.2362s/iter; left time: 8366.4880s
	iters: 200, epoch: 15 | loss: 0.0000525
	speed: 0.0421s/iter; left time: 1487.6152s
	iters: 300, epoch: 15 | loss: 0.0000052
	speed: 0.0465s/iter; left time: 1637.0073s
	iters: 400, epoch: 15 | loss: 0.0000118
	speed: 0.0425s/iter; left time: 1492.1095s
Epoch: 15 cost time: 19.477580785751343
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.179 Vali Acc: 0.976 Test Loss: 0.179 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000356
	speed: 0.2243s/iter; left time: 7852.5130s
	iters: 200, epoch: 16 | loss: 0.0000092
	speed: 0.0379s/iter; left time: 1322.4911s
	iters: 300, epoch: 16 | loss: 0.0001324
	speed: 0.0432s/iter; left time: 1502.5684s
	iters: 400, epoch: 16 | loss: 0.0141693
	speed: 0.0392s/iter; left time: 1361.4462s
Epoch: 16 cost time: 18.074613094329834
Epoch: 16, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.138 Vali Acc: 0.979 Test Loss: 0.138 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2196s/iter; left time: 7594.9734s
	iters: 200, epoch: 17 | loss: 0.0005178
	speed: 0.0421s/iter; left time: 1451.2239s
	iters: 300, epoch: 17 | loss: 0.0175901
	speed: 0.0385s/iter; left time: 1324.0407s
	iters: 400, epoch: 17 | loss: 0.0037245
	speed: 0.0371s/iter; left time: 1270.5627s
Epoch: 17 cost time: 17.95210576057434
Epoch: 17, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0368752
	speed: 0.2239s/iter; left time: 7653.2988s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1354.8111s
	iters: 300, epoch: 18 | loss: 0.0000136
	speed: 0.0421s/iter; left time: 1429.8486s
	iters: 400, epoch: 18 | loss: 0.0005698
	speed: 0.0378s/iter; left time: 1280.5785s
Epoch: 18 cost time: 17.659488916397095
Epoch: 18, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.155 Vali Acc: 0.977 Test Loss: 0.155 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 57610
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df256_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4701788
	speed: 0.0755s/iter; left time: 3109.0895s
	iters: 200, epoch: 1 | loss: 0.0677857
	speed: 0.0407s/iter; left time: 1674.5165s
	iters: 300, epoch: 1 | loss: 0.0410952
	speed: 0.0443s/iter; left time: 1814.2990s
	iters: 400, epoch: 1 | loss: 0.1085973
	speed: 0.0396s/iter; left time: 1618.6746s
Epoch: 1 cost time: 20.768577814102173
Epoch: 1, Steps: 413 | Train Loss: 0.517 Vali Loss: 0.119 Vali Acc: 0.960 Test Loss: 0.119 Test Acc: 0.960
Validation loss decreased (inf --> -0.960435).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0938711
	speed: 0.2131s/iter; left time: 8690.9217s
	iters: 200, epoch: 2 | loss: 0.0279476
	speed: 0.0362s/iter; left time: 1473.6953s
	iters: 300, epoch: 2 | loss: 0.2466626
	speed: 0.0410s/iter; left time: 1663.1360s
	iters: 400, epoch: 2 | loss: 0.0863984
	speed: 0.0412s/iter; left time: 1668.1609s
Epoch: 2 cost time: 17.788063526153564
Epoch: 2, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
Validation loss decreased (-0.960435 --> -0.965438).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0073236
	speed: 0.1994s/iter; left time: 8049.2592s
	iters: 200, epoch: 3 | loss: 0.0023445
	speed: 0.0443s/iter; left time: 1783.9019s
	iters: 300, epoch: 3 | loss: 0.0070671
	speed: 0.0442s/iter; left time: 1774.7826s
	iters: 400, epoch: 3 | loss: 0.0153810
	speed: 0.0418s/iter; left time: 1676.2173s
Epoch: 3 cost time: 17.98692750930786
Epoch: 3, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.083 Vali Acc: 0.972 Test Loss: 0.083 Test Acc: 0.972
Validation loss decreased (-0.965438 --> -0.971805).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0015256
	speed: 0.2132s/iter; left time: 8519.4128s
	iters: 200, epoch: 4 | loss: 0.0036231
	speed: 0.0431s/iter; left time: 1718.7205s
	iters: 300, epoch: 4 | loss: 0.0008424
	speed: 0.0389s/iter; left time: 1545.3037s
	iters: 400, epoch: 4 | loss: 0.0772781
	speed: 0.0358s/iter; left time: 1420.7202s
Epoch: 4 cost time: 17.796036958694458
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0980948
	speed: 0.2229s/iter; left time: 8815.5531s
	iters: 200, epoch: 5 | loss: 0.1568460
	speed: 0.0389s/iter; left time: 1534.0639s
	iters: 300, epoch: 5 | loss: 0.0286924
	speed: 0.0435s/iter; left time: 1713.0267s
	iters: 400, epoch: 5 | loss: 0.0030113
	speed: 0.0419s/iter; left time: 1645.7336s
Epoch: 5 cost time: 18.729743003845215
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0002463
	speed: 0.2271s/iter; left time: 8888.0157s
	iters: 200, epoch: 6 | loss: 0.0002622
	speed: 0.0421s/iter; left time: 1644.1912s
	iters: 300, epoch: 6 | loss: 0.0415687
	speed: 0.0447s/iter; left time: 1742.0891s
	iters: 400, epoch: 6 | loss: 0.0071306
	speed: 0.0383s/iter; left time: 1486.3527s
Epoch: 6 cost time: 18.009661197662354
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0055161
	speed: 0.2154s/iter; left time: 8342.1374s
	iters: 200, epoch: 7 | loss: 0.0008001
	speed: 0.0422s/iter; left time: 1628.8568s
	iters: 300, epoch: 7 | loss: 0.0012652
	speed: 0.0423s/iter; left time: 1628.9699s
	iters: 400, epoch: 7 | loss: 0.0001214
	speed: 0.0386s/iter; left time: 1483.1160s
Epoch: 7 cost time: 18.639381170272827
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0104778
	speed: 0.1962s/iter; left time: 7516.2380s
	iters: 200, epoch: 8 | loss: 0.0049503
	speed: 0.0380s/iter; left time: 1453.0592s
	iters: 300, epoch: 8 | loss: 0.0000325
	speed: 0.0371s/iter; left time: 1414.9917s
	iters: 400, epoch: 8 | loss: 0.0589775
	speed: 0.0391s/iter; left time: 1485.8510s
Epoch: 8 cost time: 16.474369287490845
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0346549
	speed: 0.2020s/iter; left time: 7656.6880s
	iters: 200, epoch: 9 | loss: 0.0000057
	speed: 0.0360s/iter; left time: 1362.0274s
	iters: 300, epoch: 9 | loss: 0.0011384
	speed: 0.0452s/iter; left time: 1704.9500s
	iters: 400, epoch: 9 | loss: 0.0005591
	speed: 0.0380s/iter; left time: 1430.0069s
Epoch: 9 cost time: 17.313058614730835
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0243509
	speed: 0.2036s/iter; left time: 7633.5707s
	iters: 200, epoch: 10 | loss: 0.0000274
	speed: 0.0420s/iter; left time: 1571.5861s
	iters: 300, epoch: 10 | loss: 0.1099526
	speed: 0.0386s/iter; left time: 1439.7799s
	iters: 400, epoch: 10 | loss: 0.0005598
	speed: 0.0467s/iter; left time: 1736.7399s
Epoch: 10 cost time: 17.531505346298218
Epoch: 10, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
Validation loss decreased (-0.971805 --> -0.976352).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0389828
	speed: 0.2003s/iter; left time: 7425.5623s
	iters: 200, epoch: 11 | loss: 0.0008319
	speed: 0.0400s/iter; left time: 1480.6621s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0388s/iter; left time: 1429.9776s
	iters: 400, epoch: 11 | loss: 0.0000037
	speed: 0.0369s/iter; left time: 1356.9841s
Epoch: 11 cost time: 16.99388313293457
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000006
	speed: 0.2068s/iter; left time: 7582.5327s
	iters: 200, epoch: 12 | loss: 0.0000100
	speed: 0.0365s/iter; left time: 1333.4316s
	iters: 300, epoch: 12 | loss: 0.3218448
	speed: 0.0364s/iter; left time: 1326.3469s
	iters: 400, epoch: 12 | loss: 0.0000618
	speed: 0.0371s/iter; left time: 1348.8182s
Epoch: 12 cost time: 16.397740602493286
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.170 Vali Acc: 0.973 Test Loss: 0.170 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0002408
	speed: 0.2309s/iter; left time: 8369.5981s
	iters: 200, epoch: 13 | loss: 0.0029732
	speed: 0.0403s/iter; left time: 1456.6602s
	iters: 300, epoch: 13 | loss: 0.0000246
	speed: 0.0383s/iter; left time: 1381.0789s
	iters: 400, epoch: 13 | loss: 0.0072365
	speed: 0.0431s/iter; left time: 1548.5853s
Epoch: 13 cost time: 18.093406677246094
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000616
	speed: 0.2168s/iter; left time: 7769.2145s
	iters: 200, epoch: 14 | loss: 0.0001356
	speed: 0.0348s/iter; left time: 1244.2440s
	iters: 300, epoch: 14 | loss: 0.0000185
	speed: 0.0432s/iter; left time: 1538.7432s
	iters: 400, epoch: 14 | loss: 0.0000830
	speed: 0.0386s/iter; left time: 1372.9783s
Epoch: 14 cost time: 17.262097120285034
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000098
	speed: 0.2343s/iter; left time: 8298.7964s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0420s/iter; left time: 1484.2728s
	iters: 300, epoch: 15 | loss: 0.0000005
	speed: 0.0424s/iter; left time: 1492.2745s
	iters: 400, epoch: 15 | loss: 0.0005447
	speed: 0.0398s/iter; left time: 1396.8771s
Epoch: 15 cost time: 18.443638563156128
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.974 Test Loss: 0.161 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2318s/iter; left time: 8115.3996s
	iters: 200, epoch: 16 | loss: 0.0196665
	speed: 0.0422s/iter; left time: 1474.7458s
	iters: 300, epoch: 16 | loss: 0.0017528
	speed: 0.0417s/iter; left time: 1453.0569s
	iters: 400, epoch: 16 | loss: 0.0015415
	speed: 0.0381s/iter; left time: 1320.9612s
Epoch: 16 cost time: 18.264092922210693
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.150 Vali Acc: 0.971 Test Loss: 0.150 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0002885
	speed: 0.2250s/iter; left time: 7782.9666s
	iters: 200, epoch: 17 | loss: 0.0002915
	speed: 0.0387s/iter; left time: 1334.6438s
	iters: 300, epoch: 17 | loss: 0.0003539
	speed: 0.0368s/iter; left time: 1264.1392s
	iters: 400, epoch: 17 | loss: 0.0000821
	speed: 0.0407s/iter; left time: 1396.2055s
Epoch: 17 cost time: 17.437074661254883
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.218 Vali Acc: 0.971 Test Loss: 0.218 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000015
	speed: 0.2186s/iter; left time: 7471.8032s
	iters: 200, epoch: 18 | loss: 0.0000095
	speed: 0.0329s/iter; left time: 1121.1556s
	iters: 300, epoch: 18 | loss: 0.0093784
	speed: 0.0325s/iter; left time: 1104.0082s
	iters: 400, epoch: 18 | loss: 0.0017022
	speed: 0.0380s/iter; left time: 1288.7489s
Epoch: 18 cost time: 16.14520764350891
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.174 Vali Acc: 0.974 Test Loss: 0.174 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1735975
	speed: 0.1772s/iter; left time: 5983.6563s
	iters: 200, epoch: 19 | loss: 0.0000003
	speed: 0.0390s/iter; left time: 1312.3228s
	iters: 300, epoch: 19 | loss: 0.0000019
	speed: 0.0401s/iter; left time: 1344.9109s
	iters: 400, epoch: 19 | loss: 0.4255753
	speed: 0.0336s/iter; left time: 1122.8514s
Epoch: 19 cost time: 16.335845232009888
Epoch: 19, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.188 Vali Acc: 0.971 Test Loss: 0.188 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0038006
	speed: 0.2012s/iter; left time: 6712.1431s
	iters: 200, epoch: 20 | loss: 0.0000003
	speed: 0.0453s/iter; left time: 1507.7427s
	iters: 300, epoch: 20 | loss: 0.6073467
	speed: 0.0357s/iter; left time: 1184.8766s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.0368s/iter; left time: 1215.2203s
Epoch: 20 cost time: 16.892738103866577
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.970 Test Loss: 0.194 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df256_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 47258
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6390495
	speed: 0.0800s/iter; left time: 3298.0530s
	iters: 200, epoch: 1 | loss: 0.5774695
	speed: 0.0412s/iter; left time: 1693.0330s
	iters: 300, epoch: 1 | loss: 0.4623318
	speed: 0.0411s/iter; left time: 1686.6678s
	iters: 400, epoch: 1 | loss: 0.2156398
	speed: 0.0411s/iter; left time: 1679.2123s
Epoch: 1 cost time: 21.09278702735901
Epoch: 1, Steps: 413 | Train Loss: 0.619 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
Validation loss decreased (inf --> -0.953614).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0195589
	speed: 0.2141s/iter; left time: 8734.2130s
	iters: 200, epoch: 2 | loss: 0.0535849
	speed: 0.0359s/iter; left time: 1461.8785s
	iters: 300, epoch: 2 | loss: 0.2591205
	speed: 0.0418s/iter; left time: 1698.2420s
	iters: 400, epoch: 2 | loss: 0.2021038
	speed: 0.0327s/iter; left time: 1325.7675s
Epoch: 2 cost time: 16.492936611175537
Epoch: 2, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
Validation loss decreased (-0.953614 --> -0.967712).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0069261
	speed: 0.2099s/iter; left time: 8476.0704s
	iters: 200, epoch: 3 | loss: 0.0624202
	speed: 0.0398s/iter; left time: 1603.8041s
	iters: 300, epoch: 3 | loss: 0.0185161
	speed: 0.0354s/iter; left time: 1423.8141s
	iters: 400, epoch: 3 | loss: 0.1388797
	speed: 0.0371s/iter; left time: 1488.7540s
Epoch: 3 cost time: 16.462106943130493
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
Validation loss decreased (-0.967712 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0028721
	speed: 0.2337s/iter; left time: 9340.4601s
	iters: 200, epoch: 4 | loss: 0.0549994
	speed: 0.0411s/iter; left time: 1636.5232s
	iters: 300, epoch: 4 | loss: 0.0112302
	speed: 0.0423s/iter; left time: 1682.5280s
	iters: 400, epoch: 4 | loss: 0.0272671
	speed: 0.0407s/iter; left time: 1613.2735s
Epoch: 4 cost time: 17.78696632385254
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.072 Vali Acc: 0.971 Test Loss: 0.072 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0285421
	speed: 0.2227s/iter; left time: 8808.7163s
	iters: 200, epoch: 5 | loss: 0.0703202
	speed: 0.0465s/iter; left time: 1832.9608s
	iters: 300, epoch: 5 | loss: 0.2856280
	speed: 0.0433s/iter; left time: 1701.9907s
	iters: 400, epoch: 5 | loss: 0.0300753
	speed: 0.0455s/iter; left time: 1784.6445s
Epoch: 5 cost time: 19.5110080242157
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.086 Vali Acc: 0.971 Test Loss: 0.086 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0050472
	speed: 0.1998s/iter; left time: 7818.8413s
	iters: 200, epoch: 6 | loss: 0.0001979
	speed: 0.0442s/iter; left time: 1725.1045s
	iters: 300, epoch: 6 | loss: 0.0019901
	speed: 0.0362s/iter; left time: 1409.2153s
	iters: 400, epoch: 6 | loss: 0.0063206
	speed: 0.0411s/iter; left time: 1597.3421s
Epoch: 6 cost time: 17.0887234210968
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0022890
	speed: 0.2140s/iter; left time: 8285.0642s
	iters: 200, epoch: 7 | loss: 0.0352247
	speed: 0.0407s/iter; left time: 1571.3861s
	iters: 300, epoch: 7 | loss: 0.0095087
	speed: 0.0387s/iter; left time: 1490.8584s
	iters: 400, epoch: 7 | loss: 0.0857036
	speed: 0.0414s/iter; left time: 1591.7343s
Epoch: 7 cost time: 17.898955583572388
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0013832
	speed: 0.2261s/iter; left time: 8662.2070s
	iters: 200, epoch: 8 | loss: 0.0003645
	speed: 0.0405s/iter; left time: 1546.5346s
	iters: 300, epoch: 8 | loss: 0.0200508
	speed: 0.0431s/iter; left time: 1643.1582s
	iters: 400, epoch: 8 | loss: 0.0024541
	speed: 0.0513s/iter; left time: 1949.8433s
Epoch: 8 cost time: 19.263113021850586
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0008343
	speed: 0.2253s/iter; left time: 8537.2228s
	iters: 200, epoch: 9 | loss: 0.0016180
	speed: 0.0423s/iter; left time: 1599.6374s
	iters: 300, epoch: 9 | loss: 0.0068977
	speed: 0.0398s/iter; left time: 1499.3726s
	iters: 400, epoch: 9 | loss: 0.0002306
	speed: 0.0390s/iter; left time: 1465.9501s
Epoch: 9 cost time: 18.70904278755188
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0002058
	speed: 0.2287s/iter; left time: 8572.7972s
	iters: 200, epoch: 10 | loss: 0.0275235
	speed: 0.0380s/iter; left time: 1421.8882s
	iters: 300, epoch: 10 | loss: 0.0118797
	speed: 0.0372s/iter; left time: 1387.8251s
	iters: 400, epoch: 10 | loss: 0.0000118
	speed: 0.0397s/iter; left time: 1474.7814s
Epoch: 10 cost time: 17.42796516418457
Epoch: 10, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.976807 --> -0.979535).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0009040
	speed: 0.1985s/iter; left time: 7357.6733s
	iters: 200, epoch: 11 | loss: 0.0002397
	speed: 0.0391s/iter; left time: 1446.3671s
	iters: 300, epoch: 11 | loss: 0.0021138
	speed: 0.0353s/iter; left time: 1303.0791s
	iters: 400, epoch: 11 | loss: 0.0007461
	speed: 0.0369s/iter; left time: 1355.0890s
Epoch: 11 cost time: 15.69564175605774
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0142385
	speed: 0.2171s/iter; left time: 7956.7715s
	iters: 200, epoch: 12 | loss: 0.0000172
	speed: 0.0413s/iter; left time: 1511.2222s
	iters: 300, epoch: 12 | loss: 0.0000557
	speed: 0.0368s/iter; left time: 1340.6345s
	iters: 400, epoch: 12 | loss: 0.0000379
	speed: 0.0414s/iter; left time: 1505.3888s
Epoch: 12 cost time: 16.957945585250854
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.150 Vali Acc: 0.966 Test Loss: 0.150 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0139882
	speed: 0.2051s/iter; left time: 7433.2564s
	iters: 200, epoch: 13 | loss: 0.0930238
	speed: 0.0381s/iter; left time: 1377.7233s
	iters: 300, epoch: 13 | loss: 0.0005368
	speed: 0.0381s/iter; left time: 1374.7707s
	iters: 400, epoch: 13 | loss: 0.0000094
	speed: 0.0368s/iter; left time: 1322.4459s
Epoch: 13 cost time: 16.8765389919281
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0868935
	speed: 0.2216s/iter; left time: 7942.1146s
	iters: 200, epoch: 14 | loss: 0.0004822
	speed: 0.0408s/iter; left time: 1457.4180s
	iters: 300, epoch: 14 | loss: 0.0000180
	speed: 0.0393s/iter; left time: 1400.4582s
	iters: 400, epoch: 14 | loss: 0.2189293
	speed: 0.0500s/iter; left time: 1777.3247s
Epoch: 14 cost time: 18.834046363830566
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0003312
	speed: 0.2121s/iter; left time: 7513.6537s
	iters: 200, epoch: 15 | loss: 0.0000234
	speed: 0.0363s/iter; left time: 1283.5914s
	iters: 300, epoch: 15 | loss: 0.0000016
	speed: 0.0405s/iter; left time: 1426.2165s
	iters: 400, epoch: 15 | loss: 0.0267088
	speed: 0.0435s/iter; left time: 1528.6405s
Epoch: 15 cost time: 17.314629077911377
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0003528
	speed: 0.2198s/iter; left time: 7693.0119s
	iters: 200, epoch: 16 | loss: 0.0000504
	speed: 0.0357s/iter; left time: 1245.3950s
	iters: 300, epoch: 16 | loss: 0.0171670
	speed: 0.0396s/iter; left time: 1376.9935s
	iters: 400, epoch: 16 | loss: 0.1162485
	speed: 0.0385s/iter; left time: 1336.3038s
Epoch: 16 cost time: 17.200554609298706
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.248 Vali Acc: 0.966 Test Loss: 0.248 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0001176
	speed: 0.2097s/iter; left time: 7254.8979s
	iters: 200, epoch: 17 | loss: 0.0000002
	speed: 0.0428s/iter; left time: 1476.0462s
	iters: 300, epoch: 17 | loss: 0.0000319
	speed: 0.0464s/iter; left time: 1596.8783s
	iters: 400, epoch: 17 | loss: 0.0255508
	speed: 0.0357s/iter; left time: 1224.8522s
Epoch: 17 cost time: 17.72063684463501
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000555
	speed: 0.1993s/iter; left time: 6810.8420s
	iters: 200, epoch: 18 | loss: 0.0000026
	speed: 0.0425s/iter; left time: 1449.5191s
	iters: 300, epoch: 18 | loss: 0.0002259
	speed: 0.0439s/iter; left time: 1490.4969s
	iters: 400, epoch: 18 | loss: 0.0000209
	speed: 0.0383s/iter; left time: 1296.2582s
Epoch: 18 cost time: 17.684951782226562
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979535 --> -0.979990).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0009291
	speed: 0.1979s/iter; left time: 6682.0987s
	iters: 200, epoch: 19 | loss: 0.0000010
	speed: 0.0423s/iter; left time: 1424.8939s
	iters: 300, epoch: 19 | loss: 0.0235396
	speed: 0.0409s/iter; left time: 1371.8616s
	iters: 400, epoch: 19 | loss: 0.0000017
	speed: 0.0377s/iter; left time: 1260.2875s
Epoch: 19 cost time: 17.413498640060425
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0002753
	speed: 0.1948s/iter; left time: 6499.0087s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0350s/iter; left time: 1164.6019s
	iters: 300, epoch: 20 | loss: 0.0000003
	speed: 0.0386s/iter; left time: 1279.8142s
	iters: 400, epoch: 20 | loss: 0.0000607
	speed: 0.0397s/iter; left time: 1311.8650s
Epoch: 20 cost time: 16.599087476730347
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0001838
	speed: 0.1932s/iter; left time: 6364.6607s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0327s/iter; left time: 1073.8157s
	iters: 300, epoch: 21 | loss: 0.0005804
	speed: 0.0375s/iter; left time: 1227.6582s
	iters: 400, epoch: 21 | loss: 0.0000221
	speed: 0.0400s/iter; left time: 1305.9009s
Epoch: 21 cost time: 16.26219606399536
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0047234
	speed: 0.1856s/iter; left time: 6037.9528s
	iters: 200, epoch: 22 | loss: 0.0000877
	speed: 0.0454s/iter; left time: 1473.0872s
	iters: 300, epoch: 22 | loss: 0.0000005
	speed: 0.0347s/iter; left time: 1120.9695s
	iters: 400, epoch: 22 | loss: 0.0007429
	speed: 0.0384s/iter; left time: 1238.5946s
Epoch: 22 cost time: 16.954551696777344
Epoch: 22, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.979990 --> -0.981354).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000004
	speed: 0.1856s/iter; left time: 5959.3770s
	iters: 200, epoch: 23 | loss: 0.0000146
	speed: 0.0363s/iter; left time: 1160.5628s
	iters: 300, epoch: 23 | loss: 0.0001468
	speed: 0.0401s/iter; left time: 1279.0848s
	iters: 400, epoch: 23 | loss: 0.0002203
	speed: 0.0402s/iter; left time: 1278.2146s
Epoch: 23 cost time: 16.555755138397217
Epoch: 23, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0001626
	speed: 0.1943s/iter; left time: 6159.2821s
	iters: 200, epoch: 24 | loss: 0.0012990
	speed: 0.0403s/iter; left time: 1273.7337s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 1128.9783s
	iters: 400, epoch: 24 | loss: 0.0000097
	speed: 0.0418s/iter; left time: 1312.9160s
Epoch: 24 cost time: 17.532970428466797
Epoch: 24, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.1973s/iter; left time: 6172.3943s
	iters: 200, epoch: 25 | loss: 0.0000001
	speed: 0.0470s/iter; left time: 1465.3534s
	iters: 300, epoch: 25 | loss: 0.1411804
	speed: 0.0435s/iter; left time: 1352.4817s
	iters: 400, epoch: 25 | loss: 0.0033478
	speed: 0.0439s/iter; left time: 1361.2323s
Epoch: 25 cost time: 18.729066133499146
Epoch: 25, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.981354 --> -0.982719).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000552
	speed: 0.2032s/iter; left time: 6275.0288s
	iters: 200, epoch: 26 | loss: 0.0269948
	speed: 0.0469s/iter; left time: 1442.5027s
	iters: 300, epoch: 26 | loss: 0.0000002
	speed: 0.0509s/iter; left time: 1561.1852s
	iters: 400, epoch: 26 | loss: 0.0300530
	speed: 0.0456s/iter; left time: 1393.8447s
Epoch: 26 cost time: 19.8338623046875
Epoch: 26, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0000583
	speed: 0.2034s/iter; left time: 6196.3496s
	iters: 200, epoch: 27 | loss: 0.0002954
	speed: 0.0376s/iter; left time: 1142.5620s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 1326.6127s
	iters: 400, epoch: 27 | loss: 0.0203867
	speed: 0.0369s/iter; left time: 1113.1649s
Epoch: 27 cost time: 17.49083185195923
Epoch: 27, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.971 Test Loss: 0.188 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.3321085
	speed: 0.2053s/iter; left time: 6168.3774s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0364s/iter; left time: 1089.7761s
	iters: 300, epoch: 28 | loss: 0.0086985
	speed: 0.0353s/iter; left time: 1054.8163s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0343s/iter; left time: 1019.6736s
Epoch: 28 cost time: 16.44489550590515
Epoch: 28, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.5093786
	speed: 0.2122s/iter; left time: 6288.6253s
	iters: 200, epoch: 29 | loss: 0.0004014
	speed: 0.0348s/iter; left time: 1029.0323s
	iters: 300, epoch: 29 | loss: 0.0000094
	speed: 0.0379s/iter; left time: 1115.9825s
	iters: 400, epoch: 29 | loss: 0.0000021
	speed: 0.0382s/iter; left time: 1120.3330s
Epoch: 29 cost time: 16.330299377441406
Epoch: 29, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.131 Vali Acc: 0.978 Test Loss: 0.131 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0013159
	speed: 0.1992s/iter; left time: 5822.8122s
	iters: 200, epoch: 30 | loss: 0.0000002
	speed: 0.0393s/iter; left time: 1144.7074s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 1098.8695s
	iters: 400, epoch: 30 | loss: 0.0000001
	speed: 0.0389s/iter; left time: 1124.9362s
Epoch: 30 cost time: 16.447458267211914
Epoch: 30, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0009064
	speed: 0.2038s/iter; left time: 5872.6482s
	iters: 200, epoch: 31 | loss: 0.0000184
	speed: 0.0385s/iter; left time: 1106.5745s
	iters: 300, epoch: 31 | loss: 0.0000030
	speed: 0.0385s/iter; left time: 1100.4756s
	iters: 400, epoch: 31 | loss: 0.0026337
	speed: 0.0398s/iter; left time: 1135.1300s
Epoch: 31 cost time: 17.099821090698242
Epoch: 31, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0000004
	speed: 0.1987s/iter; left time: 5641.5275s
	iters: 200, epoch: 32 | loss: 0.0000003
	speed: 0.0432s/iter; left time: 1222.3826s
	iters: 300, epoch: 32 | loss: 0.0000421
	speed: 0.0397s/iter; left time: 1118.8250s
	iters: 400, epoch: 32 | loss: 0.0000010
	speed: 0.0302s/iter; left time: 847.7773s
Epoch: 32 cost time: 16.284497022628784
Epoch: 32, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0000280
	speed: 0.1930s/iter; left time: 5402.1354s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 996.1885s
	iters: 300, epoch: 33 | loss: 0.0000001
	speed: 0.0313s/iter; left time: 868.3111s
	iters: 400, epoch: 33 | loss: 0.0000020
	speed: 0.0308s/iter; left time: 853.6145s
Epoch: 33 cost time: 14.703346014022827
Epoch: 33, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1799s/iter; left time: 4960.6215s
	iters: 200, epoch: 34 | loss: 0.0000001
	speed: 0.0303s/iter; left time: 832.1630s
	iters: 300, epoch: 34 | loss: 0.0201927
	speed: 0.0316s/iter; left time: 863.8249s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 908.2327s
Epoch: 34 cost time: 13.851102590560913
Epoch: 34, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.981 Test Loss: 0.135 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0004171
	speed: 0.2023s/iter; left time: 5493.0737s
	iters: 200, epoch: 35 | loss: 0.0002249
	speed: 0.0342s/iter; left time: 925.8535s
	iters: 300, epoch: 35 | loss: 0.0082139
	speed: 0.0338s/iter; left time: 912.5065s
	iters: 400, epoch: 35 | loss: 0.1177204
	speed: 0.0352s/iter; left time: 945.4874s
Epoch: 35 cost time: 15.387439727783203
Epoch: 35, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 36922
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df256_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0806391
	speed: 0.0720s/iter; left time: 2965.1490s
	iters: 200, epoch: 1 | loss: 0.4470056
	speed: 0.0360s/iter; left time: 1481.5959s
	iters: 300, epoch: 1 | loss: 0.4400910
	speed: 0.0364s/iter; left time: 1492.4372s
	iters: 400, epoch: 1 | loss: 0.1511525
	speed: 0.0393s/iter; left time: 1605.8993s
Epoch: 1 cost time: 18.932471990585327
Epoch: 1, Steps: 413 | Train Loss: 0.654 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
Validation loss decreased (inf --> -0.954069).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2153925
	speed: 0.1978s/iter; left time: 8069.7104s
	iters: 200, epoch: 2 | loss: 0.1434501
	speed: 0.0365s/iter; left time: 1484.3191s
	iters: 300, epoch: 2 | loss: 0.0290153
	speed: 0.0418s/iter; left time: 1698.0725s
	iters: 400, epoch: 2 | loss: 0.0324798
	speed: 0.0337s/iter; left time: 1364.8464s
Epoch: 2 cost time: 15.570421934127808
Epoch: 2, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.092 Vali Acc: 0.966 Test Loss: 0.092 Test Acc: 0.966
Validation loss decreased (-0.954069 --> -0.966347).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0197476
	speed: 0.1999s/iter; left time: 8072.1760s
	iters: 200, epoch: 3 | loss: 0.0060351
	speed: 0.0387s/iter; left time: 1557.6304s
	iters: 300, epoch: 3 | loss: 0.0124050
	speed: 0.0378s/iter; left time: 1519.5567s
	iters: 400, epoch: 3 | loss: 0.0075133
	speed: 0.0361s/iter; left time: 1448.2253s
Epoch: 3 cost time: 16.693548917770386
Epoch: 3, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
Validation loss decreased (-0.966347 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0117560
	speed: 0.2001s/iter; left time: 7997.1387s
	iters: 200, epoch: 4 | loss: 0.0127578
	speed: 0.0357s/iter; left time: 1421.3454s
	iters: 300, epoch: 4 | loss: 0.0669201
	speed: 0.0429s/iter; left time: 1707.7501s
	iters: 400, epoch: 4 | loss: 0.0216396
	speed: 0.0367s/iter; left time: 1455.7364s
Epoch: 4 cost time: 17.084546327590942
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.090 Vali Acc: 0.971 Test Loss: 0.090 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0405443
	speed: 0.1876s/iter; left time: 7421.1681s
	iters: 200, epoch: 5 | loss: 0.0024919
	speed: 0.0339s/iter; left time: 1336.4393s
	iters: 300, epoch: 5 | loss: 0.1168158
	speed: 0.0390s/iter; left time: 1534.4083s
	iters: 400, epoch: 5 | loss: 0.0331827
	speed: 0.0384s/iter; left time: 1506.5099s
Epoch: 5 cost time: 16.159279346466064
Epoch: 5, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.070 Vali Acc: 0.975 Test Loss: 0.070 Test Acc: 0.975
Validation loss decreased (-0.973169 --> -0.974988).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0304513
	speed: 0.1991s/iter; left time: 7792.2072s
	iters: 200, epoch: 6 | loss: 0.0020787
	speed: 0.0446s/iter; left time: 1742.8345s
	iters: 300, epoch: 6 | loss: 0.2798927
	speed: 0.0404s/iter; left time: 1571.1065s
	iters: 400, epoch: 6 | loss: 0.0007753
	speed: 0.0412s/iter; left time: 1601.3340s
Epoch: 6 cost time: 18.235184907913208
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.097 Vali Acc: 0.967 Test Loss: 0.097 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0038017
	speed: 0.1999s/iter; left time: 7740.7643s
	iters: 200, epoch: 7 | loss: 0.0017152
	speed: 0.0372s/iter; left time: 1438.5343s
	iters: 300, epoch: 7 | loss: 0.0248026
	speed: 0.0309s/iter; left time: 1189.3042s
	iters: 400, epoch: 7 | loss: 0.0254675
	speed: 0.0401s/iter; left time: 1539.5241s
Epoch: 7 cost time: 15.95778226852417
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0012497
	speed: 0.1908s/iter; left time: 7308.2190s
	iters: 200, epoch: 8 | loss: 0.0133078
	speed: 0.0323s/iter; left time: 1233.3612s
	iters: 300, epoch: 8 | loss: 0.0257588
	speed: 0.0341s/iter; left time: 1297.9253s
	iters: 400, epoch: 8 | loss: 0.0141409
	speed: 0.0311s/iter; left time: 1183.3580s
Epoch: 8 cost time: 14.930289268493652
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0565314
	speed: 0.1872s/iter; left time: 7094.2668s
	iters: 200, epoch: 9 | loss: 0.0016166
	speed: 0.0319s/iter; left time: 1204.8348s
	iters: 300, epoch: 9 | loss: 0.0000003
	speed: 0.0320s/iter; left time: 1207.8600s
	iters: 400, epoch: 9 | loss: 0.0871627
	speed: 0.0367s/iter; left time: 1378.6598s
Epoch: 9 cost time: 15.136778831481934
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.061 Vali Acc: 0.979 Test Loss: 0.061 Test Acc: 0.979
Validation loss decreased (-0.974988 --> -0.979081).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0043454
	speed: 0.1848s/iter; left time: 6926.6805s
	iters: 200, epoch: 10 | loss: 0.0218725
	speed: 0.0366s/iter; left time: 1367.9136s
	iters: 300, epoch: 10 | loss: 0.0001761
	speed: 0.0397s/iter; left time: 1479.3326s
	iters: 400, epoch: 10 | loss: 0.0069441
	speed: 0.0359s/iter; left time: 1334.6693s
Epoch: 10 cost time: 16.071988821029663
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0021197
	speed: 0.1886s/iter; left time: 6991.8983s
	iters: 200, epoch: 11 | loss: 0.0014638
	speed: 0.0386s/iter; left time: 1426.8583s
	iters: 300, epoch: 11 | loss: 0.0010304
	speed: 0.0385s/iter; left time: 1419.1613s
	iters: 400, epoch: 11 | loss: 0.0000443
	speed: 0.0386s/iter; left time: 1417.7898s
Epoch: 11 cost time: 16.54366946220398
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0120912
	speed: 0.1918s/iter; left time: 7031.6251s
	iters: 200, epoch: 12 | loss: 0.0018547
	speed: 0.0402s/iter; left time: 1469.6880s
	iters: 300, epoch: 12 | loss: 0.0000144
	speed: 0.0370s/iter; left time: 1348.4696s
	iters: 400, epoch: 12 | loss: 0.0128277
	speed: 0.0386s/iter; left time: 1402.6224s
Epoch: 12 cost time: 17.11725425720215
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.979535).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0097414
	speed: 0.1941s/iter; left time: 7034.9180s
	iters: 200, epoch: 13 | loss: 0.0012861
	speed: 0.0330s/iter; left time: 1191.8033s
	iters: 300, epoch: 13 | loss: 0.0041198
	speed: 0.0352s/iter; left time: 1267.0260s
	iters: 400, epoch: 13 | loss: 0.1358450
	speed: 0.0386s/iter; left time: 1385.8907s
Epoch: 13 cost time: 16.220597505569458
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0043659
	speed: 0.1858s/iter; left time: 6656.0624s
	iters: 200, epoch: 14 | loss: 0.0005995
	speed: 0.0424s/iter; left time: 1515.9063s
	iters: 300, epoch: 14 | loss: 0.0003352
	speed: 0.0463s/iter; left time: 1651.3938s
	iters: 400, epoch: 14 | loss: 0.0001592
	speed: 0.0375s/iter; left time: 1331.2470s
Epoch: 14 cost time: 17.563416481018066
Epoch: 14, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0120146
	speed: 0.2074s/iter; left time: 7345.3966s
	iters: 200, epoch: 15 | loss: 0.0011941
	speed: 0.0421s/iter; left time: 1487.9933s
	iters: 300, epoch: 15 | loss: 0.0000030
	speed: 0.0408s/iter; left time: 1436.9542s
	iters: 400, epoch: 15 | loss: 0.0000061
	speed: 0.0374s/iter; left time: 1314.0037s
Epoch: 15 cost time: 18.10665011405945
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000262
	speed: 0.2049s/iter; left time: 7173.0570s
	iters: 200, epoch: 16 | loss: 0.0000232
	speed: 0.0417s/iter; left time: 1455.8628s
	iters: 300, epoch: 16 | loss: 0.0018819
	speed: 0.0407s/iter; left time: 1418.3322s
	iters: 400, epoch: 16 | loss: 0.0001455
	speed: 0.0389s/iter; left time: 1349.1767s
Epoch: 16 cost time: 17.8178608417511
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000135
	speed: 0.2008s/iter; left time: 6945.2739s
	iters: 200, epoch: 17 | loss: 0.0000059
	speed: 0.0394s/iter; left time: 1357.6197s
	iters: 300, epoch: 17 | loss: 0.0000545
	speed: 0.0426s/iter; left time: 1466.0214s
	iters: 400, epoch: 17 | loss: 0.0000689
	speed: 0.0411s/iter; left time: 1408.9258s
Epoch: 17 cost time: 17.59006643295288
Epoch: 17, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0031599
	speed: 0.2110s/iter; left time: 7212.6797s
	iters: 200, epoch: 18 | loss: 0.0018387
	speed: 0.0383s/iter; left time: 1304.5916s
	iters: 300, epoch: 18 | loss: 0.0000091
	speed: 0.0330s/iter; left time: 1120.9405s
	iters: 400, epoch: 18 | loss: 0.0000007
	speed: 0.0356s/iter; left time: 1207.1657s
Epoch: 18 cost time: 16.04653835296631
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0010577
	speed: 0.2019s/iter; left time: 6816.2819s
	iters: 200, epoch: 19 | loss: 0.0037576
	speed: 0.0358s/iter; left time: 1204.0754s
	iters: 300, epoch: 19 | loss: 0.0003272
	speed: 0.0363s/iter; left time: 1217.6285s
	iters: 400, epoch: 19 | loss: 0.0000141
	speed: 0.0363s/iter; left time: 1214.3282s
Epoch: 19 cost time: 15.921812534332275
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979535 --> -0.979990).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000004
	speed: 0.1872s/iter; left time: 6244.6341s
	iters: 200, epoch: 20 | loss: 0.0004693
	speed: 0.0423s/iter; left time: 1406.5874s
	iters: 300, epoch: 20 | loss: 0.0001678
	speed: 0.0356s/iter; left time: 1181.2688s
	iters: 400, epoch: 20 | loss: 0.0000018
	speed: 0.0379s/iter; left time: 1253.0661s
Epoch: 20 cost time: 16.68311381340027
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000034
	speed: 0.1963s/iter; left time: 6467.4637s
	iters: 200, epoch: 21 | loss: 0.0000974
	speed: 0.0367s/iter; left time: 1206.2336s
	iters: 300, epoch: 21 | loss: 0.0000082
	speed: 0.0404s/iter; left time: 1323.7662s
	iters: 400, epoch: 21 | loss: 0.0007285
	speed: 0.0376s/iter; left time: 1225.6979s
Epoch: 21 cost time: 17.04582142829895
Epoch: 21, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000129
	speed: 0.2022s/iter; left time: 6576.5686s
	iters: 200, epoch: 22 | loss: 0.0473575
	speed: 0.0406s/iter; left time: 1316.9047s
	iters: 300, epoch: 22 | loss: 0.0001303
	speed: 0.0383s/iter; left time: 1236.7337s
	iters: 400, epoch: 22 | loss: 0.0001425
	speed: 0.0412s/iter; left time: 1327.3793s
Epoch: 22 cost time: 17.501665115356445
Epoch: 22, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000033
	speed: 0.2045s/iter; left time: 6567.6444s
	iters: 200, epoch: 23 | loss: 0.0000864
	speed: 0.0393s/iter; left time: 1257.0308s
	iters: 300, epoch: 23 | loss: 0.0001775
	speed: 0.0413s/iter; left time: 1317.0107s
	iters: 400, epoch: 23 | loss: 0.0000243
	speed: 0.0404s/iter; left time: 1283.8901s
Epoch: 23 cost time: 17.438229084014893
Epoch: 23, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0001675
	speed: 0.2074s/iter; left time: 6573.5498s
	iters: 200, epoch: 24 | loss: 0.0000061
	speed: 0.0403s/iter; left time: 1274.8840s
	iters: 300, epoch: 24 | loss: 0.0000709
	speed: 0.0383s/iter; left time: 1207.9135s
	iters: 400, epoch: 24 | loss: 0.0000408
	speed: 0.0416s/iter; left time: 1306.2206s
Epoch: 24 cost time: 17.30376172065735
Epoch: 24, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.171 Vali Acc: 0.968 Test Loss: 0.171 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.2493502
	speed: 0.2042s/iter; left time: 6390.6834s
	iters: 200, epoch: 25 | loss: 0.0000237
	speed: 0.0421s/iter; left time: 1312.6818s
	iters: 300, epoch: 25 | loss: 0.0001188
	speed: 0.0366s/iter; left time: 1137.3645s
	iters: 400, epoch: 25 | loss: 0.0003579
	speed: 0.0407s/iter; left time: 1261.4812s
Epoch: 25 cost time: 16.670976400375366
Epoch: 25, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000211
	speed: 0.2081s/iter; left time: 6424.9303s
	iters: 200, epoch: 26 | loss: 0.0000443
	speed: 0.0378s/iter; left time: 1164.4984s
	iters: 300, epoch: 26 | loss: 0.0030443
	speed: 0.0377s/iter; left time: 1155.0290s
	iters: 400, epoch: 26 | loss: 0.0000107
	speed: 0.0425s/iter; left time: 1299.9674s
Epoch: 26 cost time: 17.174646854400635
Epoch: 26, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0002174
	speed: 0.2017s/iter; left time: 6145.4677s
	iters: 200, epoch: 27 | loss: 0.0548806
	speed: 0.0387s/iter; left time: 1176.4750s
	iters: 300, epoch: 27 | loss: 0.0000040
	speed: 0.0382s/iter; left time: 1155.5868s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 1137.9951s
Epoch: 27 cost time: 16.12768840789795
Epoch: 27, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000086
	speed: 0.1874s/iter; left time: 5632.2710s
	iters: 200, epoch: 28 | loss: 0.0000764
	speed: 0.0406s/iter; left time: 1214.8093s
	iters: 300, epoch: 28 | loss: 0.0000920
	speed: 0.0412s/iter; left time: 1230.4774s
	iters: 400, epoch: 28 | loss: 0.0000004
	speed: 0.0384s/iter; left time: 1143.7785s
Epoch: 28 cost time: 17.128370761871338
Epoch: 28, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000089
	speed: 0.1999s/iter; left time: 5925.8535s
	iters: 200, epoch: 29 | loss: 0.0024577
	speed: 0.0389s/iter; left time: 1150.2904s
	iters: 300, epoch: 29 | loss: 0.0022810
	speed: 0.0377s/iter; left time: 1111.0210s
	iters: 400, epoch: 29 | loss: 0.0008880
	speed: 0.0310s/iter; left time: 909.4737s
Epoch: 29 cost time: 16.14507246017456
Epoch: 29, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.165 Vali Acc: 0.976 Test Loss: 0.165 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df256_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 28682
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df256_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9172155
	speed: 0.0531s/iter; left time: 2185.9121s
	iters: 200, epoch: 1 | loss: 0.3724448
	speed: 0.0305s/iter; left time: 1254.5956s
	iters: 300, epoch: 1 | loss: 0.0912799
	speed: 0.0315s/iter; left time: 1293.4238s
	iters: 400, epoch: 1 | loss: 0.2036855
	speed: 0.0260s/iter; left time: 1064.8406s
Epoch: 1 cost time: 14.724549055099487
Epoch: 1, Steps: 413 | Train Loss: 0.728 Vali Loss: 0.165 Vali Acc: 0.947 Test Loss: 0.165 Test Acc: 0.947
Validation loss decreased (inf --> -0.946792).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3555038
	speed: 0.1585s/iter; left time: 6466.1883s
	iters: 200, epoch: 2 | loss: 0.1543821
	speed: 0.0325s/iter; left time: 1322.2040s
	iters: 300, epoch: 2 | loss: 0.0788832
	speed: 0.0321s/iter; left time: 1302.6029s
	iters: 400, epoch: 2 | loss: 0.0119826
	speed: 0.0338s/iter; left time: 1367.9132s
Epoch: 2 cost time: 14.077525854110718
Epoch: 2, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.102 Vali Acc: 0.966 Test Loss: 0.102 Test Acc: 0.966
Validation loss decreased (-0.946792 --> -0.966347).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2071825
	speed: 0.1544s/iter; left time: 6234.4847s
	iters: 200, epoch: 3 | loss: 0.0426067
	speed: 0.0347s/iter; left time: 1397.9818s
	iters: 300, epoch: 3 | loss: 0.0236794
	speed: 0.0333s/iter; left time: 1338.4332s
	iters: 400, epoch: 3 | loss: 0.0366531
	speed: 0.0315s/iter; left time: 1264.1906s
Epoch: 3 cost time: 14.097505331039429
Epoch: 3, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
Validation loss decreased (-0.966347 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0619173
	speed: 0.1633s/iter; left time: 6526.9510s
	iters: 200, epoch: 4 | loss: 0.0237934
	speed: 0.0383s/iter; left time: 1528.3941s
	iters: 300, epoch: 4 | loss: 0.0091197
	speed: 0.0312s/iter; left time: 1242.0958s
	iters: 400, epoch: 4 | loss: 0.0083513
	speed: 0.0349s/iter; left time: 1384.8309s
Epoch: 4 cost time: 15.756843328475952
Epoch: 4, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3061553
	speed: 0.1708s/iter; left time: 6754.0568s
	iters: 200, epoch: 5 | loss: 0.1050735
	speed: 0.0403s/iter; left time: 1590.0666s
	iters: 300, epoch: 5 | loss: 0.0702618
	speed: 0.0374s/iter; left time: 1472.8096s
	iters: 400, epoch: 5 | loss: 0.0207684
	speed: 0.0328s/iter; left time: 1286.5041s
Epoch: 5 cost time: 16.544614553451538
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0640268
	speed: 0.1881s/iter; left time: 7361.8166s
	iters: 200, epoch: 6 | loss: 0.0029565
	speed: 0.0370s/iter; left time: 1445.1207s
	iters: 300, epoch: 6 | loss: 0.0405013
	speed: 0.0329s/iter; left time: 1281.7163s
	iters: 400, epoch: 6 | loss: 0.1123067
	speed: 0.0343s/iter; left time: 1330.7582s
Epoch: 6 cost time: 15.612859725952148
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.077 Vali Acc: 0.974 Test Loss: 0.077 Test Acc: 0.974
Validation loss decreased (-0.973169 --> -0.974078).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0019049
	speed: 0.1871s/iter; left time: 7245.4769s
	iters: 200, epoch: 7 | loss: 0.0023871
	speed: 0.0324s/iter; left time: 1250.7483s
	iters: 300, epoch: 7 | loss: 0.0012826
	speed: 0.0346s/iter; left time: 1331.3701s
	iters: 400, epoch: 7 | loss: 0.0026126
	speed: 0.0347s/iter; left time: 1331.5427s
Epoch: 7 cost time: 14.990326166152954
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.068 Vali Acc: 0.976 Test Loss: 0.068 Test Acc: 0.976
Validation loss decreased (-0.974078 --> -0.976352).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0062992
	speed: 0.1868s/iter; left time: 7155.4104s
	iters: 200, epoch: 8 | loss: 0.0098593
	speed: 0.0342s/iter; left time: 1306.6506s
	iters: 300, epoch: 8 | loss: 0.0013692
	speed: 0.0370s/iter; left time: 1411.5544s
	iters: 400, epoch: 8 | loss: 0.0005029
	speed: 0.0388s/iter; left time: 1475.9764s
Epoch: 8 cost time: 16.001766443252563
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0192368
	speed: 0.1668s/iter; left time: 6321.2033s
	iters: 200, epoch: 9 | loss: 0.0154312
	speed: 0.0323s/iter; left time: 1221.1799s
	iters: 300, epoch: 9 | loss: 0.0004557
	speed: 0.0325s/iter; left time: 1224.9825s
	iters: 400, epoch: 9 | loss: 0.0081131
	speed: 0.0333s/iter; left time: 1251.9041s
Epoch: 9 cost time: 13.562260389328003
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0066577
	speed: 0.1747s/iter; left time: 6549.3091s
	iters: 200, epoch: 10 | loss: 0.0191953
	speed: 0.0366s/iter; left time: 1369.6502s
	iters: 300, epoch: 10 | loss: 0.0133165
	speed: 0.0425s/iter; left time: 1584.6163s
	iters: 400, epoch: 10 | loss: 0.0210571
	speed: 0.0373s/iter; left time: 1387.5616s
Epoch: 10 cost time: 16.360769987106323
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0116628
	speed: 0.1846s/iter; left time: 6844.2636s
	iters: 200, epoch: 11 | loss: 0.0496788
	speed: 0.0380s/iter; left time: 1403.8596s
	iters: 300, epoch: 11 | loss: 0.0000527
	speed: 0.0360s/iter; left time: 1327.1927s
	iters: 400, epoch: 11 | loss: 0.0143336
	speed: 0.0383s/iter; left time: 1407.6007s
Epoch: 11 cost time: 16.053993225097656
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0003553
	speed: 0.1951s/iter; left time: 7152.6468s
	iters: 200, epoch: 12 | loss: 0.0542938
	speed: 0.0386s/iter; left time: 1409.5639s
	iters: 300, epoch: 12 | loss: 0.0006263
	speed: 0.0388s/iter; left time: 1412.8565s
	iters: 400, epoch: 12 | loss: 0.0000128
	speed: 0.0427s/iter; left time: 1552.8223s
Epoch: 12 cost time: 16.94191884994507
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0059913
	speed: 0.1924s/iter; left time: 6973.4601s
	iters: 200, epoch: 13 | loss: 0.0000690
	speed: 0.0369s/iter; left time: 1332.5414s
	iters: 300, epoch: 13 | loss: 0.0079293
	speed: 0.0369s/iter; left time: 1329.2039s
	iters: 400, epoch: 13 | loss: 0.0002230
	speed: 0.0318s/iter; left time: 1143.6109s
Epoch: 13 cost time: 15.585469722747803
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0008785
	speed: 0.1830s/iter; left time: 6556.7390s
	iters: 200, epoch: 14 | loss: 0.0003294
	speed: 0.0304s/iter; left time: 1087.9660s
	iters: 300, epoch: 14 | loss: 0.0007936
	speed: 0.0325s/iter; left time: 1156.4522s
	iters: 400, epoch: 14 | loss: 0.0002157
	speed: 0.0336s/iter; left time: 1193.1646s
Epoch: 14 cost time: 14.758320808410645
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000600
	speed: 0.1810s/iter; left time: 6410.0877s
	iters: 200, epoch: 15 | loss: 0.0002651
	speed: 0.0314s/iter; left time: 1109.5203s
	iters: 300, epoch: 15 | loss: 0.0042346
	speed: 0.0289s/iter; left time: 1017.9382s
	iters: 400, epoch: 15 | loss: 0.0000073
	speed: 0.0317s/iter; left time: 1111.9094s
Epoch: 15 cost time: 13.675516366958618
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0001531
	speed: 0.1700s/iter; left time: 5952.2296s
	iters: 200, epoch: 16 | loss: 0.0000023
	speed: 0.0321s/iter; left time: 1120.7167s
	iters: 300, epoch: 16 | loss: 0.0000080
	speed: 0.0336s/iter; left time: 1168.6158s
	iters: 400, epoch: 16 | loss: 0.0357050
	speed: 0.0325s/iter; left time: 1126.2716s
Epoch: 16 cost time: 14.222141027450562
Epoch: 16, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000674
	speed: 0.1793s/iter; left time: 6203.2505s
	iters: 200, epoch: 17 | loss: 0.0000525
	speed: 0.0354s/iter; left time: 1221.0747s
	iters: 300, epoch: 17 | loss: 0.0000552
	speed: 0.0339s/iter; left time: 1166.8346s
	iters: 400, epoch: 17 | loss: 0.0005895
	speed: 0.0338s/iter; left time: 1158.3455s
Epoch: 17 cost time: 14.834781646728516
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df256_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 24602
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2075655
	speed: 0.0858s/iter; left time: 3536.4947s
	iters: 200, epoch: 1 | loss: 0.6488506
	speed: 0.0442s/iter; left time: 1814.9056s
	iters: 300, epoch: 1 | loss: 0.0526455
	speed: 0.0427s/iter; left time: 1751.2011s
	iters: 400, epoch: 1 | loss: 0.8389642
	speed: 0.0444s/iter; left time: 1816.3454s
Epoch: 1 cost time: 22.458635807037354
Epoch: 1, Steps: 413 | Train Loss: 0.406 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (inf --> -0.961800).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0615018
	speed: 0.2111s/iter; left time: 8611.1384s
	iters: 200, epoch: 2 | loss: 0.3727175
	speed: 0.0488s/iter; left time: 1983.6556s
	iters: 300, epoch: 2 | loss: 0.0158485
	speed: 0.0461s/iter; left time: 1869.5663s
	iters: 400, epoch: 2 | loss: 0.0058307
	speed: 0.0468s/iter; left time: 1894.2135s
Epoch: 2 cost time: 20.593403816223145
Epoch: 2, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.128 Vali Acc: 0.961 Test Loss: 0.128 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0406489
	speed: 0.2109s/iter; left time: 8514.6508s
	iters: 200, epoch: 3 | loss: 0.0192954
	speed: 0.0459s/iter; left time: 1850.4698s
	iters: 300, epoch: 3 | loss: 0.0587029
	speed: 0.0439s/iter; left time: 1765.1420s
	iters: 400, epoch: 3 | loss: 0.0032818
	speed: 0.0478s/iter; left time: 1914.0514s
Epoch: 3 cost time: 19.752675533294678
Epoch: 3, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.232 Vali Acc: 0.951 Test Loss: 0.232 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0002469
	speed: 0.2154s/iter; left time: 8606.0185s
	iters: 200, epoch: 4 | loss: 0.2111569
	speed: 0.0420s/iter; left time: 1674.2189s
	iters: 300, epoch: 4 | loss: 0.0001449
	speed: 0.0440s/iter; left time: 1748.5120s
	iters: 400, epoch: 4 | loss: 0.0021509
	speed: 0.0443s/iter; left time: 1757.4964s
Epoch: 4 cost time: 19.25876498222351
Epoch: 4, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.185 Vali Acc: 0.969 Test Loss: 0.185 Test Acc: 0.969
Validation loss decreased (-0.961800 --> -0.968620).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5032917
	speed: 0.2101s/iter; left time: 8309.6174s
	iters: 200, epoch: 5 | loss: 0.0000086
	speed: 0.0425s/iter; left time: 1676.7706s
	iters: 300, epoch: 5 | loss: 0.0000924
	speed: 0.0407s/iter; left time: 1602.2090s
	iters: 400, epoch: 5 | loss: 0.0003311
	speed: 0.0463s/iter; left time: 1818.9001s
Epoch: 5 cost time: 18.280928373336792
Epoch: 5, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.242 Vali Acc: 0.962 Test Loss: 0.242 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0316822
	speed: 0.2137s/iter; left time: 8363.1423s
	iters: 200, epoch: 6 | loss: 0.0000920
	speed: 0.0463s/iter; left time: 1805.4973s
	iters: 300, epoch: 6 | loss: 0.0015290
	speed: 0.0405s/iter; left time: 1578.6257s
	iters: 400, epoch: 6 | loss: 0.0000288
	speed: 0.0418s/iter; left time: 1622.7014s
Epoch: 6 cost time: 18.94078302383423
Epoch: 6, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.199 Vali Acc: 0.961 Test Loss: 0.199 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0023484
	speed: 0.2079s/iter; left time: 8049.9380s
	iters: 200, epoch: 7 | loss: 0.0006807
	speed: 0.0423s/iter; left time: 1632.3458s
	iters: 300, epoch: 7 | loss: 0.0857092
	speed: 0.0454s/iter; left time: 1749.1691s
	iters: 400, epoch: 7 | loss: 0.0000005
	speed: 0.0396s/iter; left time: 1521.7934s
Epoch: 7 cost time: 18.973445653915405
Epoch: 7, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.204 Vali Acc: 0.967 Test Loss: 0.204 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0013753
	speed: 0.2062s/iter; left time: 7900.2491s
	iters: 200, epoch: 8 | loss: 0.0326714
	speed: 0.0482s/iter; left time: 1840.2237s
	iters: 300, epoch: 8 | loss: 0.0002375
	speed: 0.0440s/iter; left time: 1678.1540s
	iters: 400, epoch: 8 | loss: 0.0000115
	speed: 0.0435s/iter; left time: 1655.2288s
Epoch: 8 cost time: 19.958537101745605
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.260 Vali Acc: 0.967 Test Loss: 0.260 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000675
	speed: 0.2089s/iter; left time: 7917.1688s
	iters: 200, epoch: 9 | loss: 0.0065238
	speed: 0.0440s/iter; left time: 1661.1784s
	iters: 300, epoch: 9 | loss: 0.0000002
	speed: 0.0468s/iter; left time: 1763.4628s
	iters: 400, epoch: 9 | loss: 0.0928768
	speed: 0.0386s/iter; left time: 1449.4553s
Epoch: 9 cost time: 18.460592031478882
Epoch: 9, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.237 Vali Acc: 0.965 Test Loss: 0.237 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0003954
	speed: 0.2011s/iter; left time: 7538.2505s
	iters: 200, epoch: 10 | loss: 0.0008146
	speed: 0.0478s/iter; left time: 1787.4774s
	iters: 300, epoch: 10 | loss: 0.0000948
	speed: 0.0383s/iter; left time: 1428.1870s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0446s/iter; left time: 1658.9218s
Epoch: 10 cost time: 19.09096670150757
Epoch: 10, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.304 Vali Acc: 0.960 Test Loss: 0.304 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000370
	speed: 0.2021s/iter; left time: 7492.4651s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1471.3745s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 1553.5809s
	iters: 400, epoch: 11 | loss: 0.1386603
	speed: 0.0402s/iter; left time: 1478.5271s
Epoch: 11 cost time: 17.82078194618225
Epoch: 11, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.367 Vali Acc: 0.959 Test Loss: 0.367 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000180
	speed: 0.2058s/iter; left time: 7544.7359s
	iters: 200, epoch: 12 | loss: 0.0000112
	speed: 0.0370s/iter; left time: 1353.2823s
	iters: 300, epoch: 12 | loss: 0.0000007
	speed: 0.0390s/iter; left time: 1422.6032s
	iters: 400, epoch: 12 | loss: 0.0000078
	speed: 0.0418s/iter; left time: 1519.0012s
Epoch: 12 cost time: 17.213528394699097
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.439 Vali Acc: 0.946 Test Loss: 0.439 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000235
	speed: 0.2036s/iter; left time: 7377.9090s
	iters: 200, epoch: 13 | loss: 0.0000011
	speed: 0.0391s/iter; left time: 1411.7710s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 1597.5677s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 1290.6255s
Epoch: 13 cost time: 17.58369779586792
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.352 Vali Acc: 0.963 Test Loss: 0.352 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2064s/iter; left time: 7394.8759s
	iters: 200, epoch: 14 | loss: 0.0000069
	speed: 0.0412s/iter; left time: 1470.6764s
	iters: 300, epoch: 14 | loss: 0.0110241
	speed: 0.0419s/iter; left time: 1494.2024s
	iters: 400, epoch: 14 | loss: 0.4853574
	speed: 0.0422s/iter; left time: 1499.8776s
Epoch: 14 cost time: 17.990622520446777
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.324 Vali Acc: 0.967 Test Loss: 0.324 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9686221009549796
model parameter : 103242
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1188908
	speed: 0.0723s/iter; left time: 2978.5546s
	iters: 200, epoch: 1 | loss: 0.1162621
	speed: 0.0435s/iter; left time: 1786.2296s
	iters: 300, epoch: 1 | loss: 0.0226409
	speed: 0.0417s/iter; left time: 1710.6240s
	iters: 400, epoch: 1 | loss: 0.0732667
	speed: 0.0374s/iter; left time: 1529.0682s
Epoch: 1 cost time: 20.066219091415405
Epoch: 1, Steps: 413 | Train Loss: 0.416 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
Validation loss decreased (inf --> -0.954978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0164586
	speed: 0.2006s/iter; left time: 8182.6675s
	iters: 200, epoch: 2 | loss: 0.0130494
	speed: 0.0333s/iter; left time: 1354.3922s
	iters: 300, epoch: 2 | loss: 0.1895673
	speed: 0.0423s/iter; left time: 1718.1721s
	iters: 400, epoch: 2 | loss: 0.0020938
	speed: 0.0350s/iter; left time: 1415.1036s
Epoch: 2 cost time: 16.075607299804688
Epoch: 2, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.107 Vali Acc: 0.964 Test Loss: 0.107 Test Acc: 0.964
Validation loss decreased (-0.954978 --> -0.964074).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0082493
	speed: 0.1713s/iter; left time: 6917.4272s
	iters: 200, epoch: 3 | loss: 0.0773434
	speed: 0.0385s/iter; left time: 1552.5306s
	iters: 300, epoch: 3 | loss: 0.0196047
	speed: 0.0361s/iter; left time: 1451.9750s
	iters: 400, epoch: 3 | loss: 0.0185012
	speed: 0.0372s/iter; left time: 1492.4474s
Epoch: 3 cost time: 15.461894512176514
Epoch: 3, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0048865
	speed: 0.1831s/iter; left time: 7317.7170s
	iters: 200, epoch: 4 | loss: 0.1929966
	speed: 0.0327s/iter; left time: 1303.1806s
	iters: 300, epoch: 4 | loss: 0.0049191
	speed: 0.0380s/iter; left time: 1512.3713s
	iters: 400, epoch: 4 | loss: 0.0001890
	speed: 0.0342s/iter; left time: 1355.3942s
Epoch: 4 cost time: 15.402889728546143
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5671453
	speed: 0.1794s/iter; left time: 7095.7976s
	iters: 200, epoch: 5 | loss: 0.0010513
	speed: 0.0349s/iter; left time: 1377.8321s
	iters: 300, epoch: 5 | loss: 0.1679212
	speed: 0.0375s/iter; left time: 1474.1780s
	iters: 400, epoch: 5 | loss: 0.0000129
	speed: 0.0381s/iter; left time: 1493.6397s
Epoch: 5 cost time: 15.790460586547852
Epoch: 5, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0002398
	speed: 0.1890s/iter; left time: 7397.5944s
	iters: 200, epoch: 6 | loss: 0.0003464
	speed: 0.0433s/iter; left time: 1690.1924s
	iters: 300, epoch: 6 | loss: 0.1398192
	speed: 0.0392s/iter; left time: 1525.7487s
	iters: 400, epoch: 6 | loss: 0.0000120
	speed: 0.0362s/iter; left time: 1405.9704s
Epoch: 6 cost time: 17.08514928817749
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.203 Vali Acc: 0.965 Test Loss: 0.203 Test Acc: 0.965
Validation loss decreased (-0.964074 --> -0.965437).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000028
	speed: 0.2016s/iter; left time: 7807.4929s
	iters: 200, epoch: 7 | loss: 0.0000057
	speed: 0.0389s/iter; left time: 1503.1807s
	iters: 300, epoch: 7 | loss: 0.0000039
	speed: 0.0419s/iter; left time: 1613.7312s
	iters: 400, epoch: 7 | loss: 0.0020360
	speed: 0.0425s/iter; left time: 1632.6151s
Epoch: 7 cost time: 17.96954846382141
Epoch: 7, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.239 Vali Acc: 0.963 Test Loss: 0.239 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0008176
	speed: 0.1984s/iter; left time: 7600.4722s
	iters: 200, epoch: 8 | loss: 0.0062118
	speed: 0.0353s/iter; left time: 1348.3406s
	iters: 300, epoch: 8 | loss: 0.0000895
	speed: 0.0429s/iter; left time: 1634.7432s
	iters: 400, epoch: 8 | loss: 0.0000522
	speed: 0.0391s/iter; left time: 1487.7685s
Epoch: 8 cost time: 17.330718278884888
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.223 Vali Acc: 0.962 Test Loss: 0.223 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000069
	speed: 0.2083s/iter; left time: 7892.9583s
	iters: 200, epoch: 9 | loss: 0.0000143
	speed: 0.0448s/iter; left time: 1692.1463s
	iters: 300, epoch: 9 | loss: 0.0000635
	speed: 0.0386s/iter; left time: 1455.9817s
	iters: 400, epoch: 9 | loss: 0.0531325
	speed: 0.0381s/iter; left time: 1430.8797s
Epoch: 9 cost time: 17.483062028884888
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
Validation loss decreased (-0.965437 --> -0.967256).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2241082
	speed: 0.1931s/iter; left time: 7237.1467s
	iters: 200, epoch: 10 | loss: 0.0064462
	speed: 0.0374s/iter; left time: 1399.1042s
	iters: 300, epoch: 10 | loss: 0.0000358
	speed: 0.0409s/iter; left time: 1524.5419s
	iters: 400, epoch: 10 | loss: 0.0050430
	speed: 0.0387s/iter; left time: 1438.0793s
Epoch: 10 cost time: 17.545191764831543
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.219 Vali Acc: 0.962 Test Loss: 0.219 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000171
	speed: 0.1971s/iter; left time: 7306.8339s
	iters: 200, epoch: 11 | loss: 0.0164645
	speed: 0.0440s/iter; left time: 1626.6478s
	iters: 300, epoch: 11 | loss: 0.0000002
	speed: 0.0390s/iter; left time: 1438.6399s
	iters: 400, epoch: 11 | loss: 0.0000137
	speed: 0.0404s/iter; left time: 1487.3189s
Epoch: 11 cost time: 17.371190309524536
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.235 Vali Acc: 0.968 Test Loss: 0.235 Test Acc: 0.968
Validation loss decreased (-0.967256 --> -0.968165).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000003
	speed: 0.1957s/iter; left time: 7173.6461s
	iters: 200, epoch: 12 | loss: 0.0001389
	speed: 0.0402s/iter; left time: 1470.1116s
	iters: 300, epoch: 12 | loss: 0.0021848
	speed: 0.0434s/iter; left time: 1581.1790s
	iters: 400, epoch: 12 | loss: 0.0000003
	speed: 0.0352s/iter; left time: 1281.0949s
Epoch: 12 cost time: 17.246582746505737
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.224 Vali Acc: 0.968 Test Loss: 0.224 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0001325
	speed: 0.2046s/iter; left time: 7415.0027s
	iters: 200, epoch: 13 | loss: 0.0002112
	speed: 0.0405s/iter; left time: 1464.4719s
	iters: 300, epoch: 13 | loss: 0.0000387
	speed: 0.0374s/iter; left time: 1347.3004s
	iters: 400, epoch: 13 | loss: 0.6582137
	speed: 0.0434s/iter; left time: 1561.0824s
Epoch: 13 cost time: 17.21192455291748
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.241 Vali Acc: 0.962 Test Loss: 0.241 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000357
	speed: 0.2193s/iter; left time: 7857.2488s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0417s/iter; left time: 1488.6327s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 1417.7239s
	iters: 400, epoch: 14 | loss: 0.0000005
	speed: 0.0495s/iter; left time: 1760.1573s
Epoch: 14 cost time: 19.376514673233032
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.238 Vali Acc: 0.965 Test Loss: 0.238 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2661341
	speed: 0.2079s/iter; left time: 7362.8092s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0420s/iter; left time: 1483.5145s
	iters: 300, epoch: 15 | loss: 0.0001051
	speed: 0.0393s/iter; left time: 1382.6285s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0471s/iter; left time: 1653.9580s
Epoch: 15 cost time: 17.66209626197815
Epoch: 15, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.300 Vali Acc: 0.966 Test Loss: 0.300 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000043
	speed: 0.2039s/iter; left time: 7138.5424s
	iters: 200, epoch: 16 | loss: 0.0242570
	speed: 0.0437s/iter; left time: 1526.1505s
	iters: 300, epoch: 16 | loss: 0.0000013
	speed: 0.0398s/iter; left time: 1385.7044s
	iters: 400, epoch: 16 | loss: 0.0000047
	speed: 0.0363s/iter; left time: 1258.7998s
Epoch: 16 cost time: 17.22408366203308
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.263 Vali Acc: 0.971 Test Loss: 0.263 Test Acc: 0.971
Validation loss decreased (-0.968165 --> -0.971348).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.1870s/iter; left time: 6467.6156s
	iters: 200, epoch: 17 | loss: 0.0113243
	speed: 0.0400s/iter; left time: 1379.7581s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 1210.4028s
	iters: 400, epoch: 17 | loss: 0.0000005
	speed: 0.0368s/iter; left time: 1262.3002s
Epoch: 17 cost time: 15.917906284332275
Epoch: 17, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.231 Vali Acc: 0.970 Test Loss: 0.231 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1860s/iter; left time: 6356.0742s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 1456.8853s
	iters: 300, epoch: 18 | loss: 0.0005330
	speed: 0.0429s/iter; left time: 1457.3527s
	iters: 400, epoch: 18 | loss: 0.0000066
	speed: 0.0336s/iter; left time: 1137.6358s
Epoch: 18 cost time: 17.053158044815063
Epoch: 18, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.299 Vali Acc: 0.966 Test Loss: 0.299 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1912s/iter; left time: 6457.7882s
	iters: 200, epoch: 19 | loss: 0.0126732
	speed: 0.0431s/iter; left time: 1452.6456s
	iters: 300, epoch: 19 | loss: 0.0003233
	speed: 0.0430s/iter; left time: 1441.8240s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0409s/iter; left time: 1368.1216s
Epoch: 19 cost time: 18.087525367736816
Epoch: 19, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
Validation loss decreased (-0.971348 --> -0.973168).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0373649
	speed: 0.1863s/iter; left time: 6212.8867s
	iters: 200, epoch: 20 | loss: 0.0000056
	speed: 0.0353s/iter; left time: 1174.2807s
	iters: 300, epoch: 20 | loss: 0.0258622
	speed: 0.0409s/iter; left time: 1357.4681s
	iters: 400, epoch: 20 | loss: 0.0809223
	speed: 0.0390s/iter; left time: 1289.4518s
Epoch: 20 cost time: 16.248669624328613
Epoch: 20, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.254 Vali Acc: 0.971 Test Loss: 0.254 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000012
	speed: 0.1959s/iter; left time: 6454.4717s
	iters: 200, epoch: 21 | loss: 0.0000191
	speed: 0.0426s/iter; left time: 1398.2842s
	iters: 300, epoch: 21 | loss: 0.0034299
	speed: 0.0402s/iter; left time: 1314.7413s
	iters: 400, epoch: 21 | loss: 0.0018227
	speed: 0.0416s/iter; left time: 1358.7324s
Epoch: 21 cost time: 17.67342233657837
Epoch: 21, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.321 Vali Acc: 0.969 Test Loss: 0.321 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000340
	speed: 0.1975s/iter; left time: 6425.2792s
	iters: 200, epoch: 22 | loss: 0.0000009
	speed: 0.0366s/iter; left time: 1188.1500s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.0416s/iter; left time: 1345.4743s
	iters: 400, epoch: 22 | loss: 0.0000035
	speed: 0.0392s/iter; left time: 1261.9683s
Epoch: 22 cost time: 16.690950393676758
Epoch: 22, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.237 Vali Acc: 0.969 Test Loss: 0.237 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000098
	speed: 0.2001s/iter; left time: 6425.1607s
	iters: 200, epoch: 23 | loss: 0.0000058
	speed: 0.0418s/iter; left time: 1338.3567s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 1344.2937s
	iters: 400, epoch: 23 | loss: 0.0000070
	speed: 0.0354s/iter; left time: 1126.3300s
Epoch: 23 cost time: 17.0368230342865
Epoch: 23, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.331 Vali Acc: 0.965 Test Loss: 0.331 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000004
	speed: 0.1938s/iter; left time: 6144.2403s
	iters: 200, epoch: 24 | loss: 0.0000016
	speed: 0.0325s/iter; left time: 1026.4066s
	iters: 300, epoch: 24 | loss: 0.0000020
	speed: 0.0319s/iter; left time: 1005.5589s
	iters: 400, epoch: 24 | loss: 0.0000036
	speed: 0.0355s/iter; left time: 1113.2557s
Epoch: 24 cost time: 14.50116515159607
Epoch: 24, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.363 Vali Acc: 0.968 Test Loss: 0.363 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.7307574
	speed: 0.1846s/iter; left time: 5777.3416s
	iters: 200, epoch: 25 | loss: 0.0000948
	speed: 0.0353s/iter; left time: 1101.0397s
	iters: 300, epoch: 25 | loss: 0.0000234
	speed: 0.0381s/iter; left time: 1183.6088s
	iters: 400, epoch: 25 | loss: 0.0001254
	speed: 0.0368s/iter; left time: 1139.4148s
Epoch: 25 cost time: 15.683454036712646
Epoch: 25, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.237 Vali Acc: 0.973 Test Loss: 0.237 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1843s/iter; left time: 5690.2009s
	iters: 200, epoch: 26 | loss: 0.0000002
	speed: 0.0326s/iter; left time: 1004.8037s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 1021.5160s
	iters: 400, epoch: 26 | loss: 0.0199564
	speed: 0.0374s/iter; left time: 1144.1220s
Epoch: 26 cost time: 14.559731721878052
Epoch: 26, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.332 Vali Acc: 0.970 Test Loss: 0.332 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1932s/iter; left time: 5885.9693s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0303s/iter; left time: 920.9311s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 1022.2724s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0360s/iter; left time: 1086.0073s
Epoch: 27 cost time: 14.966133832931519
Epoch: 27, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.264 Vali Acc: 0.972 Test Loss: 0.264 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1945s/iter; left time: 5844.8699s
	iters: 200, epoch: 28 | loss: 0.0000002
	speed: 0.0361s/iter; left time: 1082.5930s
	iters: 300, epoch: 28 | loss: 0.4092880
	speed: 0.0336s/iter; left time: 1004.2199s
	iters: 400, epoch: 28 | loss: 0.0000114
	speed: 0.0346s/iter; left time: 1028.9615s
Epoch: 28 cost time: 15.500328302383423
Epoch: 28, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
Validation loss decreased (-0.973168 --> -0.975441).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0225227
	speed: 0.1808s/iter; left time: 5359.3568s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 1031.3051s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 1110.3081s
	iters: 400, epoch: 29 | loss: 0.0000008
	speed: 0.0389s/iter; left time: 1142.0924s
Epoch: 29 cost time: 15.874330759048462
Epoch: 29, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.331 Vali Acc: 0.969 Test Loss: 0.331 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1806s/iter; left time: 5277.3581s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 958.2185s
	iters: 300, epoch: 30 | loss: 0.0000048
	speed: 0.0333s/iter; left time: 965.4396s
	iters: 400, epoch: 30 | loss: 0.0000001
	speed: 0.0324s/iter; left time: 936.4535s
Epoch: 30 cost time: 14.506229877471924
Epoch: 30, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.265 Vali Acc: 0.976 Test Loss: 0.265 Test Acc: 0.976
Validation loss decreased (-0.975441 --> -0.976350).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1983s/iter; left time: 5713.6854s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0337s/iter; left time: 966.2673s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 1125.9246s
	iters: 400, epoch: 31 | loss: 0.0013148
	speed: 0.0349s/iter; left time: 993.7239s
Epoch: 31 cost time: 16.09969139099121
Epoch: 31, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.275 Vali Acc: 0.972 Test Loss: 0.275 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1773s/iter; left time: 5034.2590s
	iters: 200, epoch: 32 | loss: 0.0000131
	speed: 0.0337s/iter; left time: 953.2672s
	iters: 300, epoch: 32 | loss: 0.0000033
	speed: 0.0342s/iter; left time: 963.5207s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 945.0383s
Epoch: 32 cost time: 14.976013898849487
Epoch: 32, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.263 Vali Acc: 0.975 Test Loss: 0.263 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1795s/iter; left time: 5023.7802s
	iters: 200, epoch: 33 | loss: 0.0000791
	speed: 0.0371s/iter; left time: 1033.6759s
	iters: 300, epoch: 33 | loss: 0.0000252
	speed: 0.0346s/iter; left time: 961.9351s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0401s/iter; left time: 1110.0303s
Epoch: 33 cost time: 15.933119058609009
Epoch: 33, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.223 Vali Acc: 0.976 Test Loss: 0.223 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1738s/iter; left time: 4791.8433s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 969.7578s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0363s/iter; left time: 993.3807s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 984.1148s
Epoch: 34 cost time: 15.636139392852783
Epoch: 34, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.268 Vali Acc: 0.977 Test Loss: 0.268 Test Acc: 0.977
Validation loss decreased (-0.976350 --> -0.977260).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1810s/iter; left time: 4915.9211s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0378s/iter; left time: 1021.5201s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0424s/iter; left time: 1143.7605s
	iters: 400, epoch: 35 | loss: 0.0000007
	speed: 0.0357s/iter; left time: 957.5871s
Epoch: 35 cost time: 16.724689960479736
Epoch: 35, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.311 Vali Acc: 0.975 Test Loss: 0.311 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.1874s/iter; left time: 5010.9201s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 1204.5180s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 1032.7212s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0378s/iter; left time: 998.7307s
Epoch: 36 cost time: 17.55677890777588
Epoch: 36, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.317 Vali Acc: 0.976 Test Loss: 0.317 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.5652881
	speed: 0.1862s/iter; left time: 4902.4606s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 837.3286s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 1135.6805s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 895.9993s
Epoch: 37 cost time: 15.552960634231567
Epoch: 37, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.367 Vali Acc: 0.969 Test Loss: 0.367 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.1983s/iter; left time: 5138.7980s
	iters: 200, epoch: 38 | loss: 0.0000001
	speed: 0.0362s/iter; left time: 934.8250s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1005.2188s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 1118.9444s
Epoch: 38 cost time: 17.25630497932434
Epoch: 38, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.338 Vali Acc: 0.972 Test Loss: 0.338 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0000004
	speed: 0.1942s/iter; left time: 4953.9626s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0376s/iter; left time: 954.9909s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 874.9531s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0390s/iter; left time: 981.9745s
Epoch: 39 cost time: 16.663360595703125
Epoch: 39, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.423 Vali Acc: 0.967 Test Loss: 0.423 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.2072s/iter; left time: 5199.4024s
	iters: 200, epoch: 40 | loss: 0.0000003
	speed: 0.0390s/iter; left time: 973.5646s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0376s/iter; left time: 935.6643s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0386s/iter; left time: 956.7037s
Epoch: 40 cost time: 17.041128635406494
Epoch: 40, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.400 Vali Acc: 0.968 Test Loss: 0.400 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0001088
	speed: 0.1895s/iter; left time: 4677.9880s
	iters: 200, epoch: 41 | loss: 0.0000001
	speed: 0.0398s/iter; left time: 977.7991s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 1010.9157s
	iters: 400, epoch: 41 | loss: 0.0000003
	speed: 0.0383s/iter; left time: 934.5192s
Epoch: 41 cost time: 17.730382680892944
Epoch: 41, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.467 Vali Acc: 0.964 Test Loss: 0.467 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.1935s/iter; left time: 4695.5857s
	iters: 200, epoch: 42 | loss: 0.0000015
	speed: 0.0383s/iter; left time: 925.6656s
	iters: 300, epoch: 42 | loss: 0.0000444
	speed: 0.0386s/iter; left time: 927.9322s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 802.9444s
Epoch: 42 cost time: 16.658187866210938
Epoch: 42, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.382 Vali Acc: 0.969 Test Loss: 0.382 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.1883s/iter; left time: 4491.1148s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 902.4016s
	iters: 300, epoch: 43 | loss: 0.0000000
	speed: 0.0339s/iter; left time: 802.4120s
	iters: 400, epoch: 43 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 823.0184s
Epoch: 43 cost time: 16.15597438812256
Epoch: 43, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.319 Vali Acc: 0.968 Test Loss: 0.319 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.0000003
	speed: 0.1770s/iter; left time: 4149.7512s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.0390s/iter; left time: 911.3631s
	iters: 300, epoch: 44 | loss: 0.0000148
	speed: 0.0391s/iter; left time: 908.7585s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.0334s/iter; left time: 774.0788s
Epoch: 44 cost time: 16.184375286102295
Epoch: 44, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.346 Vali Acc: 0.969 Test Loss: 0.346 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df128_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.977262391996362
model parameter : 69994
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4082153
	speed: 0.0605s/iter; left time: 2490.8470s
	iters: 200, epoch: 1 | loss: 0.0793915
	speed: 0.0341s/iter; left time: 1403.3425s
	iters: 300, epoch: 1 | loss: 0.0942963
	speed: 0.0337s/iter; left time: 1380.1357s
	iters: 400, epoch: 1 | loss: 0.2037778
	speed: 0.0324s/iter; left time: 1324.7028s
Epoch: 1 cost time: 16.540269374847412
Epoch: 1, Steps: 413 | Train Loss: 0.502 Vali Loss: 0.140 Vali Acc: 0.950 Test Loss: 0.140 Test Acc: 0.950
Validation loss decreased (inf --> -0.949521).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0670818
	speed: 0.1720s/iter; left time: 7016.4384s
	iters: 200, epoch: 2 | loss: 0.0018577
	speed: 0.0330s/iter; left time: 1343.4475s
	iters: 300, epoch: 2 | loss: 0.0087784
	speed: 0.0333s/iter; left time: 1352.3386s
	iters: 400, epoch: 2 | loss: 0.0196269
	speed: 0.0315s/iter; left time: 1275.6013s
Epoch: 2 cost time: 14.425565958023071
Epoch: 2, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
Validation loss decreased (-0.949521 --> -0.961800).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0167637
	speed: 0.1695s/iter; left time: 6844.8157s
	iters: 200, epoch: 3 | loss: 0.6384165
	speed: 0.0349s/iter; left time: 1405.9425s
	iters: 300, epoch: 3 | loss: 0.0008260
	speed: 0.0346s/iter; left time: 1389.6920s
	iters: 400, epoch: 3 | loss: 0.0119637
	speed: 0.0292s/iter; left time: 1168.8403s
Epoch: 3 cost time: 13.890840291976929
Epoch: 3, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.961800 --> -0.969531).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0049733
	speed: 0.1498s/iter; left time: 5988.1938s
	iters: 200, epoch: 4 | loss: 0.0018495
	speed: 0.0310s/iter; left time: 1236.2596s
	iters: 300, epoch: 4 | loss: 0.0045652
	speed: 0.0330s/iter; left time: 1313.5972s
	iters: 400, epoch: 4 | loss: 0.1195714
	speed: 0.0266s/iter; left time: 1053.1206s
Epoch: 4 cost time: 13.267247200012207
Epoch: 4, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.969531 --> -0.974988).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000578
	speed: 0.1559s/iter; left time: 6164.8393s
	iters: 200, epoch: 5 | loss: 0.0126852
	speed: 0.0291s/iter; left time: 1147.3142s
	iters: 300, epoch: 5 | loss: 0.0025153
	speed: 0.0315s/iter; left time: 1239.0736s
	iters: 400, epoch: 5 | loss: 0.0315668
	speed: 0.0307s/iter; left time: 1205.1400s
Epoch: 5 cost time: 13.146715879440308
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.143 Vali Acc: 0.961 Test Loss: 0.143 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0082684
	speed: 0.1557s/iter; left time: 6092.1537s
	iters: 200, epoch: 6 | loss: 0.0033614
	speed: 0.0306s/iter; left time: 1195.0827s
	iters: 300, epoch: 6 | loss: 0.0014489
	speed: 0.0298s/iter; left time: 1158.8428s
	iters: 400, epoch: 6 | loss: 0.0000936
	speed: 0.0270s/iter; left time: 1050.0944s
Epoch: 6 cost time: 13.21644139289856
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000153
	speed: 0.1483s/iter; left time: 5742.0666s
	iters: 200, epoch: 7 | loss: 0.0002610
	speed: 0.0289s/iter; left time: 1114.8415s
	iters: 300, epoch: 7 | loss: 0.0208223
	speed: 0.0293s/iter; left time: 1127.9184s
	iters: 400, epoch: 7 | loss: 0.1519713
	speed: 0.0289s/iter; left time: 1112.0236s
Epoch: 7 cost time: 12.604168891906738
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0022940
	speed: 0.1495s/iter; left time: 5728.8994s
	iters: 200, epoch: 8 | loss: 0.0857772
	speed: 0.0274s/iter; left time: 1048.1758s
	iters: 300, epoch: 8 | loss: 0.0000012
	speed: 0.0310s/iter; left time: 1183.2927s
	iters: 400, epoch: 8 | loss: 0.3846178
	speed: 0.0317s/iter; left time: 1204.0537s
Epoch: 8 cost time: 13.108712911605835
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0054691
	speed: 0.1436s/iter; left time: 5440.9167s
	iters: 200, epoch: 9 | loss: 0.0017667
	speed: 0.0362s/iter; left time: 1368.7437s
	iters: 300, epoch: 9 | loss: 0.0000346
	speed: 0.0323s/iter; left time: 1216.2740s
	iters: 400, epoch: 9 | loss: 0.0062658
	speed: 0.0316s/iter; left time: 1186.4660s
Epoch: 9 cost time: 14.115285396575928
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0080620
	speed: 0.1635s/iter; left time: 6126.8629s
	iters: 200, epoch: 10 | loss: 0.0000996
	speed: 0.0326s/iter; left time: 1218.2822s
	iters: 300, epoch: 10 | loss: 0.0000018
	speed: 0.0329s/iter; left time: 1226.1686s
	iters: 400, epoch: 10 | loss: 0.0277724
	speed: 0.0331s/iter; left time: 1231.7624s
Epoch: 10 cost time: 14.269307613372803
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.175 Vali Acc: 0.973 Test Loss: 0.175 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0010254
	speed: 0.1699s/iter; left time: 6299.8275s
	iters: 200, epoch: 11 | loss: 0.0003424
	speed: 0.0326s/iter; left time: 1205.8166s
	iters: 300, epoch: 11 | loss: 0.0556201
	speed: 0.0309s/iter; left time: 1140.5599s
	iters: 400, epoch: 11 | loss: 0.0000396
	speed: 0.0298s/iter; left time: 1094.3939s
Epoch: 11 cost time: 14.41024899482727
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000101
	speed: 0.1559s/iter; left time: 5714.1291s
	iters: 200, epoch: 12 | loss: 0.0976638
	speed: 0.0308s/iter; left time: 1126.8065s
	iters: 300, epoch: 12 | loss: 0.0176728
	speed: 0.0300s/iter; left time: 1094.7130s
	iters: 400, epoch: 12 | loss: 0.0000015
	speed: 0.0363s/iter; left time: 1319.2495s
Epoch: 12 cost time: 14.140018939971924
Epoch: 12, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.185 Vali Acc: 0.969 Test Loss: 0.185 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0112481
	speed: 0.1863s/iter; left time: 6753.3194s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 1260.7282s
	iters: 300, epoch: 13 | loss: 0.0000759
	speed: 0.0351s/iter; left time: 1264.6368s
	iters: 400, epoch: 13 | loss: 0.0016788
	speed: 0.0354s/iter; left time: 1273.5785s
Epoch: 13 cost time: 15.019604206085205
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.220 Vali Acc: 0.969 Test Loss: 0.220 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0579239
	speed: 0.1669s/iter; left time: 5981.4026s
	iters: 200, epoch: 14 | loss: 0.0000167
	speed: 0.0302s/iter; left time: 1079.6571s
	iters: 300, epoch: 14 | loss: 0.0005645
	speed: 0.0366s/iter; left time: 1304.0351s
	iters: 400, epoch: 14 | loss: 0.0000053
	speed: 0.0353s/iter; left time: 1255.7856s
Epoch: 14 cost time: 14.445553302764893
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.198 Vali Acc: 0.968 Test Loss: 0.198 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9749886311959982
model parameter : 53386
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df128_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6889117
	speed: 0.0705s/iter; left time: 2905.0437s
	iters: 200, epoch: 1 | loss: 0.2196119
	speed: 0.0341s/iter; left time: 1402.8347s
	iters: 300, epoch: 1 | loss: 0.1269299
	speed: 0.0334s/iter; left time: 1370.3959s
	iters: 400, epoch: 1 | loss: 0.0404029
	speed: 0.0375s/iter; left time: 1532.1354s
Epoch: 1 cost time: 18.043233394622803
Epoch: 1, Steps: 413 | Train Loss: 0.517 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
Validation loss decreased (inf --> -0.953614).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2320583
	speed: 0.1823s/iter; left time: 7436.9336s
	iters: 200, epoch: 2 | loss: 1.1555917
	speed: 0.0393s/iter; left time: 1599.3491s
	iters: 300, epoch: 2 | loss: 0.0017985
	speed: 0.0382s/iter; left time: 1549.2961s
	iters: 400, epoch: 2 | loss: 0.0592492
	speed: 0.0398s/iter; left time: 1612.2632s
Epoch: 2 cost time: 16.640257835388184
Epoch: 2, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.077 Vali Acc: 0.975 Test Loss: 0.077 Test Acc: 0.975
Validation loss decreased (-0.953614 --> -0.974533).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1365359
	speed: 0.1899s/iter; left time: 7665.9728s
	iters: 200, epoch: 3 | loss: 0.0019067
	speed: 0.0355s/iter; left time: 1428.0160s
	iters: 300, epoch: 3 | loss: 0.0014712
	speed: 0.0376s/iter; left time: 1509.1174s
	iters: 400, epoch: 3 | loss: 0.0434219
	speed: 0.0400s/iter; left time: 1602.6894s
Epoch: 3 cost time: 15.758847951889038
Epoch: 3, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.100 Vali Acc: 0.964 Test Loss: 0.100 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0356504
	speed: 0.1887s/iter; left time: 7539.2984s
	iters: 200, epoch: 4 | loss: 0.0089172
	speed: 0.0380s/iter; left time: 1516.4210s
	iters: 300, epoch: 4 | loss: 0.0000558
	speed: 0.0411s/iter; left time: 1635.5222s
	iters: 400, epoch: 4 | loss: 0.0004142
	speed: 0.0353s/iter; left time: 1400.4216s
Epoch: 4 cost time: 16.817458629608154
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.089 Vali Acc: 0.972 Test Loss: 0.089 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0334257
	speed: 0.1876s/iter; left time: 7417.7053s
	iters: 200, epoch: 5 | loss: 0.0059576
	speed: 0.0383s/iter; left time: 1509.2182s
	iters: 300, epoch: 5 | loss: 0.0158042
	speed: 0.0383s/iter; left time: 1508.2042s
	iters: 400, epoch: 5 | loss: 0.0444616
	speed: 0.0373s/iter; left time: 1462.2190s
Epoch: 5 cost time: 16.383396863937378
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0012305
	speed: 0.1801s/iter; left time: 7046.5741s
	iters: 200, epoch: 6 | loss: 0.0351350
	speed: 0.0381s/iter; left time: 1485.5401s
	iters: 300, epoch: 6 | loss: 0.0141427
	speed: 0.0356s/iter; left time: 1386.8737s
	iters: 400, epoch: 6 | loss: 0.0351362
	speed: 0.0351s/iter; left time: 1362.1231s
Epoch: 6 cost time: 15.865283966064453
Epoch: 6, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.161 Vali Acc: 0.963 Test Loss: 0.161 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0002420
	speed: 0.1770s/iter; left time: 6853.2641s
	iters: 200, epoch: 7 | loss: 0.0271206
	speed: 0.0344s/iter; left time: 1327.4515s
	iters: 300, epoch: 7 | loss: 0.0604129
	speed: 0.0311s/iter; left time: 1199.7574s
	iters: 400, epoch: 7 | loss: 0.0010524
	speed: 0.0345s/iter; left time: 1324.9521s
Epoch: 7 cost time: 14.641820192337036
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.974533 --> -0.975897).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0013206
	speed: 0.1750s/iter; left time: 6704.6985s
	iters: 200, epoch: 8 | loss: 0.0020029
	speed: 0.0375s/iter; left time: 1433.4269s
	iters: 300, epoch: 8 | loss: 0.0001256
	speed: 0.0346s/iter; left time: 1316.7710s
	iters: 400, epoch: 8 | loss: 0.0019923
	speed: 0.0371s/iter; left time: 1409.2393s
Epoch: 8 cost time: 15.576394319534302
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0082082
	speed: 0.1469s/iter; left time: 5566.2197s
	iters: 200, epoch: 9 | loss: 0.0020583
	speed: 0.0248s/iter; left time: 939.1524s
	iters: 300, epoch: 9 | loss: 0.0218347
	speed: 0.0308s/iter; left time: 1160.6050s
	iters: 400, epoch: 9 | loss: 0.0009697
	speed: 0.0274s/iter; left time: 1030.1700s
Epoch: 9 cost time: 12.88838267326355
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
Validation loss decreased (-0.975897 --> -0.979080).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0001649
	speed: 0.1504s/iter; left time: 5637.3982s
	iters: 200, epoch: 10 | loss: 0.0276516
	speed: 0.0328s/iter; left time: 1225.0331s
	iters: 300, epoch: 10 | loss: 0.0000162
	speed: 0.0333s/iter; left time: 1241.5628s
	iters: 400, epoch: 10 | loss: 0.4443880
	speed: 0.0297s/iter; left time: 1103.2747s
Epoch: 10 cost time: 14.026819705963135
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0011949
	speed: 0.1483s/iter; left time: 5498.7261s
	iters: 200, epoch: 11 | loss: 0.0000402
	speed: 0.0271s/iter; left time: 1001.7428s
	iters: 300, epoch: 11 | loss: 0.0000365
	speed: 0.0322s/iter; left time: 1186.3890s
	iters: 400, epoch: 11 | loss: 0.0004453
	speed: 0.0336s/iter; left time: 1235.0087s
Epoch: 11 cost time: 13.466049432754517
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0683757
	speed: 0.1470s/iter; left time: 5388.3183s
	iters: 200, epoch: 12 | loss: 0.0017265
	speed: 0.0322s/iter; left time: 1176.7879s
	iters: 300, epoch: 12 | loss: 0.0001900
	speed: 0.0293s/iter; left time: 1068.9241s
	iters: 400, epoch: 12 | loss: 0.0000249
	speed: 0.0313s/iter; left time: 1138.0770s
Epoch: 12 cost time: 13.127963542938232
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000503
	speed: 0.1570s/iter; left time: 5691.1668s
	iters: 200, epoch: 13 | loss: 0.0000243
	speed: 0.0296s/iter; left time: 1070.0614s
	iters: 300, epoch: 13 | loss: 0.0001827
	speed: 0.0309s/iter; left time: 1112.4571s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0250s/iter; left time: 897.3414s
Epoch: 13 cost time: 12.442501544952393
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0008784
	speed: 0.1554s/iter; left time: 5568.6465s
	iters: 200, epoch: 14 | loss: 0.0014457
	speed: 0.0280s/iter; left time: 1000.2200s
	iters: 300, epoch: 14 | loss: 0.0015327
	speed: 0.0271s/iter; left time: 965.1138s
	iters: 400, epoch: 14 | loss: 0.0000012
	speed: 0.0258s/iter; left time: 917.0427s
Epoch: 14 cost time: 11.757710456848145
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.4148862
	speed: 0.1466s/iter; left time: 5191.5727s
	iters: 200, epoch: 15 | loss: 0.0000688
	speed: 0.0308s/iter; left time: 1089.3535s
	iters: 300, epoch: 15 | loss: 0.0000747
	speed: 0.0285s/iter; left time: 1002.3483s
	iters: 400, epoch: 15 | loss: 0.0000013
	speed: 0.0306s/iter; left time: 1073.4485s
Epoch: 15 cost time: 13.47521424293518
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000011
	speed: 0.1553s/iter; left time: 5434.8349s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0278s/iter; left time: 971.8695s
	iters: 300, epoch: 16 | loss: 0.0001676
	speed: 0.0283s/iter; left time: 984.5224s
	iters: 400, epoch: 16 | loss: 0.0000004
	speed: 0.0286s/iter; left time: 992.7300s
Epoch: 16 cost time: 12.88652515411377
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.982 Test Loss: 0.096 Test Acc: 0.982
Validation loss decreased (-0.979080 --> -0.981809).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000018
	speed: 0.1460s/iter; left time: 5052.1736s
	iters: 200, epoch: 17 | loss: 0.0005593
	speed: 0.0283s/iter; left time: 975.4794s
	iters: 300, epoch: 17 | loss: 0.0000179
	speed: 0.0276s/iter; left time: 950.6077s
	iters: 400, epoch: 17 | loss: 0.0001066
	speed: 0.0278s/iter; left time: 952.2500s
Epoch: 17 cost time: 12.444833040237427
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0001505
	speed: 0.1402s/iter; left time: 4793.4830s
	iters: 200, epoch: 18 | loss: 0.0000110
	speed: 0.0280s/iter; left time: 955.5604s
	iters: 300, epoch: 18 | loss: 0.0000002
	speed: 0.0293s/iter; left time: 995.5724s
	iters: 400, epoch: 18 | loss: 0.0000936
	speed: 0.0292s/iter; left time: 988.4414s
Epoch: 18 cost time: 12.750186681747437
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000044
	speed: 0.1755s/iter; left time: 5926.1625s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0335s/iter; left time: 1129.1898s
	iters: 300, epoch: 19 | loss: 0.0000173
	speed: 0.0318s/iter; left time: 1067.4019s
	iters: 400, epoch: 19 | loss: 0.0004446
	speed: 0.0348s/iter; left time: 1163.8305s
Epoch: 19 cost time: 15.000118494033813
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.142 Vali Acc: 0.976 Test Loss: 0.142 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000137
	speed: 0.1845s/iter; left time: 6155.4279s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 1114.0137s
	iters: 300, epoch: 20 | loss: 0.0000014
	speed: 0.0322s/iter; left time: 1068.1035s
	iters: 400, epoch: 20 | loss: 0.0000267
	speed: 0.0310s/iter; left time: 1024.3689s
Epoch: 20 cost time: 14.654736518859863
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0007514
	speed: 0.1818s/iter; left time: 5989.2888s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.0354s/iter; left time: 1161.7828s
	iters: 300, epoch: 21 | loss: 0.0000056
	speed: 0.0347s/iter; left time: 1134.5239s
	iters: 400, epoch: 21 | loss: 0.0000044
	speed: 0.0354s/iter; left time: 1154.6893s
Epoch: 21 cost time: 15.392648696899414
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000075
	speed: 0.1871s/iter; left time: 6085.5905s
	iters: 200, epoch: 22 | loss: 0.0011771
	speed: 0.0320s/iter; left time: 1037.9201s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0354s/iter; left time: 1145.4236s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 1073.3639s
Epoch: 22 cost time: 14.659858465194702
Epoch: 22, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.187 Vali Acc: 0.970 Test Loss: 0.187 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0722930
	speed: 0.1794s/iter; left time: 5760.6269s
	iters: 200, epoch: 23 | loss: 0.0025162
	speed: 0.0338s/iter; left time: 1081.6297s
	iters: 300, epoch: 23 | loss: 0.0000026
	speed: 0.0358s/iter; left time: 1142.3445s
	iters: 400, epoch: 23 | loss: 0.0000001
	speed: 0.0311s/iter; left time: 987.9808s
Epoch: 23 cost time: 14.755399465560913
Epoch: 23, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.184 Vali Acc: 0.971 Test Loss: 0.184 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000048
	speed: 0.1800s/iter; left time: 5705.0934s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 1141.3343s
	iters: 300, epoch: 24 | loss: 0.0001566
	speed: 0.0361s/iter; left time: 1135.9068s
	iters: 400, epoch: 24 | loss: 0.0000085
	speed: 0.0356s/iter; left time: 1119.0780s
Epoch: 24 cost time: 15.98734998703003
Epoch: 24, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.974 Test Loss: 0.174 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0702382
	speed: 0.1860s/iter; left time: 5819.8410s
	iters: 200, epoch: 25 | loss: 0.0000013
	speed: 0.0395s/iter; left time: 1231.0034s
	iters: 300, epoch: 25 | loss: 0.0000401
	speed: 0.0454s/iter; left time: 1410.9443s
	iters: 400, epoch: 25 | loss: 0.0000002
	speed: 0.0363s/iter; left time: 1123.4574s
Epoch: 25 cost time: 17.267187118530273
Epoch: 25, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.178 Vali Acc: 0.973 Test Loss: 0.178 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000005
	speed: 0.1886s/iter; left time: 5821.9546s
	iters: 200, epoch: 26 | loss: 0.0000002
	speed: 0.0368s/iter; left time: 1131.2994s
	iters: 300, epoch: 26 | loss: 0.0000132
	speed: 0.0383s/iter; left time: 1173.4955s
	iters: 400, epoch: 26 | loss: 0.0004411
	speed: 0.0356s/iter; left time: 1088.3963s
Epoch: 26 cost time: 16.225465774536133
Epoch: 26, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.976 Test Loss: 0.176 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df128_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 43034
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9478890
	speed: 0.0640s/iter; left time: 2637.2805s
	iters: 200, epoch: 1 | loss: 0.3069339
	speed: 0.0326s/iter; left time: 1341.2693s
	iters: 300, epoch: 1 | loss: 0.0917331
	speed: 0.0289s/iter; left time: 1184.5583s
	iters: 400, epoch: 1 | loss: 0.2154973
	speed: 0.0280s/iter; left time: 1144.5800s
Epoch: 1 cost time: 15.869919061660767
Epoch: 1, Steps: 413 | Train Loss: 0.602 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1145786
	speed: 0.1849s/iter; left time: 7543.6863s
	iters: 200, epoch: 2 | loss: 0.0601176
	speed: 0.0380s/iter; left time: 1545.0897s
	iters: 300, epoch: 2 | loss: 0.0816977
	speed: 0.0296s/iter; left time: 1199.6947s
	iters: 400, epoch: 2 | loss: 0.3127521
	speed: 0.0334s/iter; left time: 1353.7752s
Epoch: 2 cost time: 15.139166593551636
Epoch: 2, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.071 Vali Acc: 0.974 Test Loss: 0.071 Test Acc: 0.974
Validation loss decreased (-0.957252 --> -0.973624).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0022364
	speed: 0.1714s/iter; left time: 6920.3697s
	iters: 200, epoch: 3 | loss: 0.1003543
	speed: 0.0315s/iter; left time: 1269.2049s
	iters: 300, epoch: 3 | loss: 0.1490514
	speed: 0.0337s/iter; left time: 1352.7513s
	iters: 400, epoch: 3 | loss: 0.0230949
	speed: 0.0374s/iter; left time: 1499.7614s
Epoch: 3 cost time: 14.63251519203186
Epoch: 3, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.104 Vali Acc: 0.961 Test Loss: 0.104 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0117722
	speed: 0.1686s/iter; left time: 6735.9370s
	iters: 200, epoch: 4 | loss: 0.0134132
	speed: 0.0303s/iter; left time: 1208.3293s
	iters: 300, epoch: 4 | loss: 0.0178067
	speed: 0.0366s/iter; left time: 1455.9277s
	iters: 400, epoch: 4 | loss: 0.1242667
	speed: 0.0358s/iter; left time: 1421.8479s
Epoch: 4 cost time: 14.497371673583984
Epoch: 4, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.074 Vali Acc: 0.972 Test Loss: 0.074 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0059935
	speed: 0.1843s/iter; left time: 7288.4759s
	iters: 200, epoch: 5 | loss: 0.0063546
	speed: 0.0380s/iter; left time: 1499.5449s
	iters: 300, epoch: 5 | loss: 0.0009411
	speed: 0.0326s/iter; left time: 1282.5731s
	iters: 400, epoch: 5 | loss: 0.1104463
	speed: 0.0375s/iter; left time: 1472.6270s
Epoch: 5 cost time: 16.18452024459839
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.162 Vali Acc: 0.960 Test Loss: 0.162 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0001349
	speed: 0.1894s/iter; left time: 7414.3100s
	iters: 200, epoch: 6 | loss: 0.0001178
	speed: 0.0385s/iter; left time: 1502.6505s
	iters: 300, epoch: 6 | loss: 0.0701470
	speed: 0.0333s/iter; left time: 1297.8367s
	iters: 400, epoch: 6 | loss: 0.0075879
	speed: 0.0329s/iter; left time: 1279.3484s
Epoch: 6 cost time: 15.925402879714966
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
Validation loss decreased (-0.973624 --> -0.975443).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0001917
	speed: 0.1890s/iter; left time: 7320.1362s
	iters: 200, epoch: 7 | loss: 0.0003794
	speed: 0.0327s/iter; left time: 1262.8477s
	iters: 300, epoch: 7 | loss: 0.0000758
	speed: 0.0333s/iter; left time: 1282.7338s
	iters: 400, epoch: 7 | loss: 0.0000861
	speed: 0.0338s/iter; left time: 1299.5940s
Epoch: 7 cost time: 14.92416501045227
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975443 --> -0.975897).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0160845
	speed: 0.1741s/iter; left time: 6670.8518s
	iters: 200, epoch: 8 | loss: 0.0000980
	speed: 0.0335s/iter; left time: 1281.3711s
	iters: 300, epoch: 8 | loss: 0.0116322
	speed: 0.0325s/iter; left time: 1237.7731s
	iters: 400, epoch: 8 | loss: 0.0021906
	speed: 0.0326s/iter; left time: 1239.1257s
Epoch: 8 cost time: 14.404958248138428
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0597934
	speed: 0.1905s/iter; left time: 7219.3445s
	iters: 200, epoch: 9 | loss: 0.0002594
	speed: 0.0366s/iter; left time: 1384.2613s
	iters: 300, epoch: 9 | loss: 0.0007004
	speed: 0.0375s/iter; left time: 1412.5130s
	iters: 400, epoch: 9 | loss: 0.0358865
	speed: 0.0400s/iter; left time: 1505.5034s
Epoch: 9 cost time: 16.21108603477478
Epoch: 9, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0004065
	speed: 0.1972s/iter; left time: 7390.8525s
	iters: 200, epoch: 10 | loss: 0.0143724
	speed: 0.0333s/iter; left time: 1246.1308s
	iters: 300, epoch: 10 | loss: 0.0003743
	speed: 0.0368s/iter; left time: 1370.6824s
	iters: 400, epoch: 10 | loss: 0.0007042
	speed: 0.0347s/iter; left time: 1291.8010s
Epoch: 10 cost time: 15.649313688278198
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0161749
	speed: 0.1846s/iter; left time: 6844.8823s
	iters: 200, epoch: 11 | loss: 0.0000431
	speed: 0.0418s/iter; left time: 1545.2131s
	iters: 300, epoch: 11 | loss: 0.0009957
	speed: 0.0404s/iter; left time: 1488.5840s
	iters: 400, epoch: 11 | loss: 0.0375389
	speed: 0.0399s/iter; left time: 1467.7036s
Epoch: 11 cost time: 17.69782328605652
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0163682
	speed: 0.1792s/iter; left time: 6570.3589s
	iters: 200, epoch: 12 | loss: 0.0002953
	speed: 0.0389s/iter; left time: 1421.8852s
	iters: 300, epoch: 12 | loss: 0.0000185
	speed: 0.0372s/iter; left time: 1354.5208s
	iters: 400, epoch: 12 | loss: 0.0000700
	speed: 0.0356s/iter; left time: 1293.7210s
Epoch: 12 cost time: 16.374656200408936
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0159783
	speed: 0.1853s/iter; left time: 6715.7064s
	iters: 200, epoch: 13 | loss: 0.2091729
	speed: 0.0393s/iter; left time: 1421.6661s
	iters: 300, epoch: 13 | loss: 0.0031996
	speed: 0.0338s/iter; left time: 1219.8643s
	iters: 400, epoch: 13 | loss: 0.0000297
	speed: 0.0345s/iter; left time: 1240.3017s
Epoch: 13 cost time: 15.80045461654663
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.978171).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000944
	speed: 0.1881s/iter; left time: 6741.6663s
	iters: 200, epoch: 14 | loss: 0.0062464
	speed: 0.0311s/iter; left time: 1110.9527s
	iters: 300, epoch: 14 | loss: 0.0000178
	speed: 0.0360s/iter; left time: 1284.4910s
	iters: 400, epoch: 14 | loss: 0.0014727
	speed: 0.0316s/iter; left time: 1123.0449s
Epoch: 14 cost time: 14.661530494689941
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0003327
	speed: 0.1789s/iter; left time: 6336.4945s
	iters: 200, epoch: 15 | loss: 0.0000345
	speed: 0.0360s/iter; left time: 1271.8394s
	iters: 300, epoch: 15 | loss: 0.0000897
	speed: 0.0354s/iter; left time: 1246.3658s
	iters: 400, epoch: 15 | loss: 0.0010256
	speed: 0.0341s/iter; left time: 1196.8816s
Epoch: 15 cost time: 15.208371639251709
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000666
	speed: 0.1843s/iter; left time: 6450.7256s
	iters: 200, epoch: 16 | loss: 0.0001234
	speed: 0.0348s/iter; left time: 1214.7677s
	iters: 300, epoch: 16 | loss: 0.0001796
	speed: 0.0353s/iter; left time: 1227.6625s
	iters: 400, epoch: 16 | loss: 0.0028766
	speed: 0.0343s/iter; left time: 1192.0403s
Epoch: 16 cost time: 15.434184074401855
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0036289
	speed: 0.1747s/iter; left time: 6044.0045s
	iters: 200, epoch: 17 | loss: 0.0131187
	speed: 0.0346s/iter; left time: 1194.7696s
	iters: 300, epoch: 17 | loss: 0.0000490
	speed: 0.0344s/iter; left time: 1182.3679s
	iters: 400, epoch: 17 | loss: 0.3039556
	speed: 0.0324s/iter; left time: 1111.2066s
Epoch: 17 cost time: 14.7977614402771
Epoch: 17, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000115
	speed: 0.1700s/iter; left time: 5811.5323s
	iters: 200, epoch: 18 | loss: 0.0000079
	speed: 0.0343s/iter; left time: 1167.7693s
	iters: 300, epoch: 18 | loss: 0.0449921
	speed: 0.0341s/iter; left time: 1157.8673s
	iters: 400, epoch: 18 | loss: 0.0003572
	speed: 0.0335s/iter; left time: 1135.9905s
Epoch: 18 cost time: 15.013565301895142
Epoch: 18, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0061445
	speed: 0.1775s/iter; left time: 5992.9307s
	iters: 200, epoch: 19 | loss: 0.0000097
	speed: 0.0405s/iter; left time: 1363.1508s
	iters: 300, epoch: 19 | loss: 0.0000412
	speed: 0.0327s/iter; left time: 1096.7195s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0306s/iter; left time: 1023.6569s
Epoch: 19 cost time: 15.426920890808105
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0001433
	speed: 0.1739s/iter; left time: 5801.1568s
	iters: 200, epoch: 20 | loss: 0.0000368
	speed: 0.0362s/iter; left time: 1202.5067s
	iters: 300, epoch: 20 | loss: 0.0007304
	speed: 0.0333s/iter; left time: 1102.4130s
	iters: 400, epoch: 20 | loss: 0.0005316
	speed: 0.0291s/iter; left time: 960.6563s
Epoch: 20 cost time: 14.795773029327393
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.152 Vali Acc: 0.971 Test Loss: 0.152 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000818
	speed: 0.1818s/iter; left time: 5987.8218s
	iters: 200, epoch: 21 | loss: 0.0006270
	speed: 0.0345s/iter; left time: 1134.5033s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.0327s/iter; left time: 1071.1628s
	iters: 400, epoch: 21 | loss: 0.0006195
	speed: 0.0318s/iter; left time: 1036.4927s
Epoch: 21 cost time: 14.596011638641357
Epoch: 21, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.968 Test Loss: 0.206 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000023
	speed: 0.1888s/iter; left time: 6141.1569s
	iters: 200, epoch: 22 | loss: 0.0000042
	speed: 0.0294s/iter; left time: 953.8170s
	iters: 300, epoch: 22 | loss: 0.0000030
	speed: 0.0343s/iter; left time: 1108.6012s
	iters: 400, epoch: 22 | loss: 0.0000013
	speed: 0.0291s/iter; left time: 938.9676s
Epoch: 22 cost time: 14.720857620239258
Epoch: 22, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000463
	speed: 0.1787s/iter; left time: 5737.9752s
	iters: 200, epoch: 23 | loss: 0.0660913
	speed: 0.0311s/iter; left time: 994.5742s
	iters: 300, epoch: 23 | loss: 0.0000268
	speed: 0.0328s/iter; left time: 1048.0084s
	iters: 400, epoch: 23 | loss: 0.0000104
	speed: 0.0297s/iter; left time: 946.3128s
Epoch: 23 cost time: 14.171963214874268
Epoch: 23, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 32698
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df128_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2206781
	speed: 0.0632s/iter; left time: 2605.0451s
	iters: 200, epoch: 1 | loss: 0.1937231
	speed: 0.0339s/iter; left time: 1395.1453s
	iters: 300, epoch: 1 | loss: 0.4621536
	speed: 0.0375s/iter; left time: 1536.8333s
	iters: 400, epoch: 1 | loss: 0.1078240
	speed: 0.0358s/iter; left time: 1464.0565s
Epoch: 1 cost time: 17.563591718673706
Epoch: 1, Steps: 413 | Train Loss: 0.688 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
Validation loss decreased (inf --> -0.953614).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0452244
	speed: 0.1792s/iter; left time: 7308.1554s
	iters: 200, epoch: 2 | loss: 0.0777081
	speed: 0.0360s/iter; left time: 1466.0684s
	iters: 300, epoch: 2 | loss: 0.3846775
	speed: 0.0370s/iter; left time: 1499.9551s
	iters: 400, epoch: 2 | loss: 0.1430244
	speed: 0.0396s/iter; left time: 1604.9328s
Epoch: 2 cost time: 16.02924346923828
Epoch: 2, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.082 Vali Acc: 0.971 Test Loss: 0.082 Test Acc: 0.971
Validation loss decreased (-0.953614 --> -0.970895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0153050
	speed: 0.1771s/iter; left time: 7149.4677s
	iters: 200, epoch: 3 | loss: 0.0102391
	speed: 0.0318s/iter; left time: 1279.2018s
	iters: 300, epoch: 3 | loss: 0.1206207
	speed: 0.0380s/iter; left time: 1525.1539s
	iters: 400, epoch: 3 | loss: 0.0811593
	speed: 0.0365s/iter; left time: 1462.4734s
Epoch: 3 cost time: 14.843409538269043
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
Validation loss decreased (-0.970895 --> -0.977716).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0210579
	speed: 0.1826s/iter; left time: 7296.7809s
	iters: 200, epoch: 4 | loss: 0.0115611
	speed: 0.0341s/iter; left time: 1359.7898s
	iters: 300, epoch: 4 | loss: 0.0142111
	speed: 0.0351s/iter; left time: 1394.1796s
	iters: 400, epoch: 4 | loss: 0.0112047
	speed: 0.0324s/iter; left time: 1283.3065s
Epoch: 4 cost time: 15.062371492385864
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.084 Vali Acc: 0.971 Test Loss: 0.084 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0022046
	speed: 0.1920s/iter; left time: 7593.8483s
	iters: 200, epoch: 5 | loss: 0.0164093
	speed: 0.0356s/iter; left time: 1402.6663s
	iters: 300, epoch: 5 | loss: 0.0853971
	speed: 0.0398s/iter; left time: 1564.5862s
	iters: 400, epoch: 5 | loss: 0.0090081
	speed: 0.0340s/iter; left time: 1336.2980s
Epoch: 5 cost time: 16.094603776931763
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.100 Vali Acc: 0.967 Test Loss: 0.100 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0016850
	speed: 0.1837s/iter; left time: 7189.9364s
	iters: 200, epoch: 6 | loss: 0.0089342
	speed: 0.0298s/iter; left time: 1162.6527s
	iters: 300, epoch: 6 | loss: 0.1391263
	speed: 0.0412s/iter; left time: 1604.5761s
	iters: 400, epoch: 6 | loss: 0.0033470
	speed: 0.0427s/iter; left time: 1659.1467s
Epoch: 6 cost time: 15.907938718795776
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.069 Vali Acc: 0.974 Test Loss: 0.069 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0051443
	speed: 0.1883s/iter; left time: 7291.2720s
	iters: 200, epoch: 7 | loss: 0.0082673
	speed: 0.0377s/iter; left time: 1455.5177s
	iters: 300, epoch: 7 | loss: 0.0030474
	speed: 0.0397s/iter; left time: 1530.4935s
	iters: 400, epoch: 7 | loss: 0.0002096
	speed: 0.0375s/iter; left time: 1440.6568s
Epoch: 7 cost time: 16.397711992263794
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0038711
	speed: 0.1781s/iter; left time: 6822.1305s
	iters: 200, epoch: 8 | loss: 0.1724590
	speed: 0.0369s/iter; left time: 1409.7260s
	iters: 300, epoch: 8 | loss: 0.1568516
	speed: 0.0406s/iter; left time: 1547.5566s
	iters: 400, epoch: 8 | loss: 0.0013710
	speed: 0.0330s/iter; left time: 1255.1234s
Epoch: 8 cost time: 15.739213466644287
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.082 Vali Acc: 0.974 Test Loss: 0.082 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0446901
	speed: 0.1852s/iter; left time: 7018.0928s
	iters: 200, epoch: 9 | loss: 0.0110792
	speed: 0.0398s/iter; left time: 1503.2947s
	iters: 300, epoch: 9 | loss: 0.0037613
	speed: 0.0411s/iter; left time: 1548.7754s
	iters: 400, epoch: 9 | loss: 0.0004651
	speed: 0.0404s/iter; left time: 1517.3840s
Epoch: 9 cost time: 17.348276138305664
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0106491
	speed: 0.1764s/iter; left time: 6613.0170s
	iters: 200, epoch: 10 | loss: 0.0036306
	speed: 0.0401s/iter; left time: 1497.3046s
	iters: 300, epoch: 10 | loss: 0.1835793
	speed: 0.0373s/iter; left time: 1389.8971s
	iters: 400, epoch: 10 | loss: 0.0007794
	speed: 0.0373s/iter; left time: 1385.8258s
Epoch: 10 cost time: 15.853307723999023
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0189982
	speed: 0.1638s/iter; left time: 6071.8785s
	iters: 200, epoch: 11 | loss: 0.0001041
	speed: 0.0347s/iter; left time: 1283.8590s
	iters: 300, epoch: 11 | loss: 0.0364160
	speed: 0.0330s/iter; left time: 1218.4148s
	iters: 400, epoch: 11 | loss: 0.2015091
	speed: 0.0316s/iter; left time: 1163.3602s
Epoch: 11 cost time: 14.149975776672363
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0002377
	speed: 0.1496s/iter; left time: 5483.2277s
	iters: 200, epoch: 12 | loss: 0.0000976
	speed: 0.0299s/iter; left time: 1091.3719s
	iters: 300, epoch: 12 | loss: 0.0002646
	speed: 0.0354s/iter; left time: 1291.7682s
	iters: 400, epoch: 12 | loss: 0.0088418
	speed: 0.0314s/iter; left time: 1142.7433s
Epoch: 12 cost time: 13.663482189178467
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0015458
	speed: 0.1534s/iter; left time: 5560.5159s
	iters: 200, epoch: 13 | loss: 0.0326153
	speed: 0.0285s/iter; left time: 1029.4617s
	iters: 300, epoch: 13 | loss: 0.0003968
	speed: 0.0281s/iter; left time: 1011.4334s
	iters: 400, epoch: 13 | loss: 0.0017446
	speed: 0.0288s/iter; left time: 1036.4806s
Epoch: 13 cost time: 12.599036455154419
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df128_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 24458
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df128_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1538726
	speed: 0.0661s/iter; left time: 2724.7218s
	iters: 200, epoch: 1 | loss: 0.3869286
	speed: 0.0282s/iter; left time: 1160.0582s
	iters: 300, epoch: 1 | loss: 0.1997667
	speed: 0.0299s/iter; left time: 1226.6364s
	iters: 400, epoch: 1 | loss: 0.3516512
	speed: 0.0354s/iter; left time: 1446.9172s
Epoch: 1 cost time: 16.427937984466553
Epoch: 1, Steps: 413 | Train Loss: 0.783 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
Validation loss decreased (inf --> -0.941335).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0694126
	speed: 0.1716s/iter; left time: 6998.9141s
	iters: 200, epoch: 2 | loss: 0.2055171
	speed: 0.0296s/iter; left time: 1204.0433s
	iters: 300, epoch: 2 | loss: 0.0831377
	speed: 0.0327s/iter; left time: 1326.2015s
	iters: 400, epoch: 2 | loss: 0.1016596
	speed: 0.0332s/iter; left time: 1342.4591s
Epoch: 2 cost time: 13.680607080459595
Epoch: 2, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.099 Vali Acc: 0.963 Test Loss: 0.099 Test Acc: 0.963
Validation loss decreased (-0.941335 --> -0.963164).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0772646
	speed: 0.1750s/iter; left time: 7064.4209s
	iters: 200, epoch: 3 | loss: 0.1057146
	speed: 0.0316s/iter; left time: 1272.3180s
	iters: 300, epoch: 3 | loss: 0.0081311
	speed: 0.0312s/iter; left time: 1254.0113s
	iters: 400, epoch: 3 | loss: 0.0119281
	speed: 0.0311s/iter; left time: 1245.9054s
Epoch: 3 cost time: 14.148852586746216
Epoch: 3, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.092 Vali Acc: 0.966 Test Loss: 0.092 Test Acc: 0.966
Validation loss decreased (-0.963164 --> -0.966347).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0257191
	speed: 0.1592s/iter; left time: 6362.4555s
	iters: 200, epoch: 4 | loss: 0.0460516
	speed: 0.0326s/iter; left time: 1301.4277s
	iters: 300, epoch: 4 | loss: 0.0085085
	speed: 0.0313s/iter; left time: 1244.3097s
	iters: 400, epoch: 4 | loss: 0.0369923
	speed: 0.0317s/iter; left time: 1259.0008s
Epoch: 4 cost time: 13.56395149230957
Epoch: 4, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.085 Vali Acc: 0.972 Test Loss: 0.085 Test Acc: 0.972
Validation loss decreased (-0.966347 --> -0.971805).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0301669
	speed: 0.1591s/iter; left time: 6293.9269s
	iters: 200, epoch: 5 | loss: 0.0126683
	speed: 0.0307s/iter; left time: 1209.6820s
	iters: 300, epoch: 5 | loss: 0.0029934
	speed: 0.0265s/iter; left time: 1041.8549s
	iters: 400, epoch: 5 | loss: 0.0175955
	speed: 0.0263s/iter; left time: 1034.1790s
Epoch: 5 cost time: 12.624420166015625
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.074 Vali Acc: 0.974 Test Loss: 0.074 Test Acc: 0.974
Validation loss decreased (-0.971805 --> -0.973624).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0012764
	speed: 0.1624s/iter; left time: 6357.5150s
	iters: 200, epoch: 6 | loss: 0.0335700
	speed: 0.0327s/iter; left time: 1277.2780s
	iters: 300, epoch: 6 | loss: 0.0097982
	speed: 0.0352s/iter; left time: 1371.8303s
	iters: 400, epoch: 6 | loss: 0.0141297
	speed: 0.0346s/iter; left time: 1342.4630s
Epoch: 6 cost time: 14.97568678855896
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0087998
	speed: 0.1760s/iter; left time: 6817.1720s
	iters: 200, epoch: 7 | loss: 0.0018293
	speed: 0.0324s/iter; left time: 1249.7041s
	iters: 300, epoch: 7 | loss: 0.3189410
	speed: 0.0358s/iter; left time: 1380.7575s
	iters: 400, epoch: 7 | loss: 0.0064528
	speed: 0.0354s/iter; left time: 1361.6614s
Epoch: 7 cost time: 14.886052131652832
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0153215
	speed: 0.1689s/iter; left time: 6471.4916s
	iters: 200, epoch: 8 | loss: 0.0108967
	speed: 0.0363s/iter; left time: 1385.1624s
	iters: 300, epoch: 8 | loss: 0.0164297
	speed: 0.0320s/iter; left time: 1219.6410s
	iters: 400, epoch: 8 | loss: 0.0367054
	speed: 0.0382s/iter; left time: 1451.2799s
Epoch: 8 cost time: 15.334324836730957
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0629360
	speed: 0.1710s/iter; left time: 6481.9667s
	iters: 200, epoch: 9 | loss: 0.0010505
	speed: 0.0325s/iter; left time: 1227.8686s
	iters: 300, epoch: 9 | loss: 0.2550671
	speed: 0.0343s/iter; left time: 1294.5250s
	iters: 400, epoch: 9 | loss: 0.0476198
	speed: 0.0375s/iter; left time: 1410.0040s
Epoch: 9 cost time: 15.244338512420654
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.086 Vali Acc: 0.972 Test Loss: 0.086 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0027857
	speed: 0.1655s/iter; left time: 6205.0886s
	iters: 200, epoch: 10 | loss: 0.0003222
	speed: 0.0326s/iter; left time: 1219.0370s
	iters: 300, epoch: 10 | loss: 0.0028737
	speed: 0.0354s/iter; left time: 1320.4854s
	iters: 400, epoch: 10 | loss: 0.0013590
	speed: 0.0338s/iter; left time: 1256.3204s
Epoch: 10 cost time: 14.624344825744629
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0023246
	speed: 0.1752s/iter; left time: 6495.9782s
	iters: 200, epoch: 11 | loss: 0.1455496
	speed: 0.0344s/iter; left time: 1272.9675s
	iters: 300, epoch: 11 | loss: 0.0100678
	speed: 0.0366s/iter; left time: 1349.9540s
	iters: 400, epoch: 11 | loss: 0.0017637
	speed: 0.0303s/iter; left time: 1112.3631s
Epoch: 11 cost time: 15.031588792800903
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.973624 --> -0.974078).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0022747
	speed: 0.1606s/iter; left time: 5885.9414s
	iters: 200, epoch: 12 | loss: 0.0012326
	speed: 0.0295s/iter; left time: 1080.2131s
	iters: 300, epoch: 12 | loss: 0.0050591
	speed: 0.0347s/iter; left time: 1265.7857s
	iters: 400, epoch: 12 | loss: 0.0228743
	speed: 0.0305s/iter; left time: 1110.0839s
Epoch: 12 cost time: 13.563020944595337
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
Validation loss decreased (-0.974078 --> -0.978626).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000116
	speed: 0.1653s/iter; left time: 5989.7682s
	iters: 200, epoch: 13 | loss: 0.0003979
	speed: 0.0330s/iter; left time: 1193.6310s
	iters: 300, epoch: 13 | loss: 0.0954957
	speed: 0.0337s/iter; left time: 1214.4769s
	iters: 400, epoch: 13 | loss: 0.0006727
	speed: 0.0354s/iter; left time: 1272.2747s
Epoch: 13 cost time: 14.724545001983643
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0014875
	speed: 0.1631s/iter; left time: 5844.3813s
	iters: 200, epoch: 14 | loss: 0.0000668
	speed: 0.0274s/iter; left time: 980.1860s
	iters: 300, epoch: 14 | loss: 0.0201382
	speed: 0.0324s/iter; left time: 1154.8496s
	iters: 400, epoch: 14 | loss: 0.0020217
	speed: 0.0351s/iter; left time: 1247.9394s
Epoch: 14 cost time: 13.977911472320557
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
Validation loss decreased (-0.978626 --> -0.978626).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0005941
	speed: 0.1554s/iter; left time: 5502.4474s
	iters: 200, epoch: 15 | loss: 0.0063872
	speed: 0.0298s/iter; left time: 1052.0635s
	iters: 300, epoch: 15 | loss: 0.0069875
	speed: 0.0334s/iter; left time: 1175.3832s
	iters: 400, epoch: 15 | loss: 0.0000049
	speed: 0.0305s/iter; left time: 1069.9858s
Epoch: 15 cost time: 13.559374809265137
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0001737
	speed: 0.1540s/iter; left time: 5389.3123s
	iters: 200, epoch: 16 | loss: 0.0298478
	speed: 0.0307s/iter; left time: 1071.8175s
	iters: 300, epoch: 16 | loss: 0.0000302
	speed: 0.0300s/iter; left time: 1042.5602s
	iters: 400, epoch: 16 | loss: 0.0116574
	speed: 0.0296s/iter; left time: 1028.6014s
Epoch: 16 cost time: 12.7671537399292
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0050091
	speed: 0.1518s/iter; left time: 5251.5990s
	iters: 200, epoch: 17 | loss: 0.0001074
	speed: 0.0320s/iter; left time: 1103.8752s
	iters: 300, epoch: 17 | loss: 0.0008562
	speed: 0.0310s/iter; left time: 1066.2605s
	iters: 400, epoch: 17 | loss: 0.0006171
	speed: 0.0289s/iter; left time: 991.9261s
Epoch: 17 cost time: 13.63268256187439
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0013276
	speed: 0.1455s/iter; left time: 4974.2072s
	iters: 200, epoch: 18 | loss: 0.0000194
	speed: 0.0327s/iter; left time: 1114.9234s
	iters: 300, epoch: 18 | loss: 0.0000020
	speed: 0.0347s/iter; left time: 1178.2315s
	iters: 400, epoch: 18 | loss: 0.0052908
	speed: 0.0347s/iter; left time: 1175.5588s
Epoch: 18 cost time: 14.32713508605957
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000039
	speed: 0.1561s/iter; left time: 5270.8111s
	iters: 200, epoch: 19 | loss: 0.0000510
	speed: 0.0312s/iter; left time: 1049.5813s
	iters: 300, epoch: 19 | loss: 0.0021793
	speed: 0.0328s/iter; left time: 1100.0671s
	iters: 400, epoch: 19 | loss: 0.0017402
	speed: 0.0297s/iter; left time: 993.4055s
Epoch: 19 cost time: 13.780656099319458
Epoch: 19, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0001149
	speed: 0.1484s/iter; left time: 4948.5553s
	iters: 200, epoch: 20 | loss: 0.2962172
	speed: 0.0299s/iter; left time: 995.1572s
	iters: 300, epoch: 20 | loss: 0.0000294
	speed: 0.0323s/iter; left time: 1069.7330s
	iters: 400, epoch: 20 | loss: 0.0011241
	speed: 0.0257s/iter; left time: 850.7834s
Epoch: 20 cost time: 12.788381814956665
Epoch: 20, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000041
	speed: 0.1607s/iter; left time: 5295.1591s
	iters: 200, epoch: 21 | loss: 0.0023245
	speed: 0.0284s/iter; left time: 933.5337s
	iters: 300, epoch: 21 | loss: 0.0002404
	speed: 0.0324s/iter; left time: 1061.8084s
	iters: 400, epoch: 21 | loss: 0.0010469
	speed: 0.0325s/iter; left time: 1060.0846s
Epoch: 21 cost time: 13.703809022903442
Epoch: 21, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0027012
	speed: 0.1564s/iter; left time: 5088.3466s
	iters: 200, epoch: 22 | loss: 0.0004932
	speed: 0.0321s/iter; left time: 1039.6377s
	iters: 300, epoch: 22 | loss: 0.0000037
	speed: 0.0338s/iter; left time: 1094.1149s
	iters: 400, epoch: 22 | loss: 0.0018374
	speed: 0.0317s/iter; left time: 1021.6155s
Epoch: 22 cost time: 13.692601203918457
Epoch: 22, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000701
	speed: 0.1676s/iter; left time: 5382.1010s
	iters: 200, epoch: 23 | loss: 0.0000304
	speed: 0.0320s/iter; left time: 1024.0136s
	iters: 300, epoch: 23 | loss: 0.0001324
	speed: 0.0358s/iter; left time: 1142.8988s
	iters: 400, epoch: 23 | loss: 0.0000027
	speed: 0.0298s/iter; left time: 947.6801s
Epoch: 23 cost time: 14.224772453308105
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0003336
	speed: 0.1731s/iter; left time: 5488.0883s
	iters: 200, epoch: 24 | loss: 0.1555398
	speed: 0.0343s/iter; left time: 1082.9006s
	iters: 300, epoch: 24 | loss: 0.0000187
	speed: 0.0296s/iter; left time: 933.9366s
	iters: 400, epoch: 24 | loss: 0.0000233
	speed: 0.0307s/iter; left time: 965.1830s
Epoch: 24 cost time: 14.099249839782715
Epoch: 24, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df128_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9786266484765803
model parameter : 20378
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5362647
	speed: 0.0779s/iter; left time: 3208.4323s
	iters: 200, epoch: 1 | loss: 0.3944565
	speed: 0.0541s/iter; left time: 2224.5626s
	iters: 300, epoch: 1 | loss: 0.2856361
	speed: 0.0461s/iter; left time: 1890.6440s
	iters: 400, epoch: 1 | loss: 0.0329757
	speed: 0.0454s/iter; left time: 1856.6585s
Epoch: 1 cost time: 23.053182363510132
Epoch: 1, Steps: 413 | Train Loss: 0.412 Vali Loss: 0.186 Vali Acc: 0.939 Test Loss: 0.186 Test Acc: 0.939
Validation loss decreased (inf --> -0.938607).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0831247
	speed: 0.1916s/iter; left time: 7815.1951s
	iters: 200, epoch: 2 | loss: 0.0317424
	speed: 0.0516s/iter; left time: 2098.8657s
	iters: 300, epoch: 2 | loss: 0.4615100
	speed: 0.0500s/iter; left time: 2029.3896s
	iters: 400, epoch: 2 | loss: 0.0229251
	speed: 0.0452s/iter; left time: 1830.3691s
Epoch: 2 cost time: 21.61064052581787
Epoch: 2, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
Validation loss decreased (-0.938607 --> -0.941335).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1317530
	speed: 0.1760s/iter; left time: 7107.3857s
	iters: 200, epoch: 3 | loss: 0.0000402
	speed: 0.0443s/iter; left time: 1785.2492s
	iters: 300, epoch: 3 | loss: 0.0165434
	speed: 0.0474s/iter; left time: 1904.4600s
	iters: 400, epoch: 3 | loss: 0.0004361
	speed: 0.0512s/iter; left time: 2053.5110s
Epoch: 3 cost time: 19.511555671691895
Epoch: 3, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.217 Vali Acc: 0.951 Test Loss: 0.217 Test Acc: 0.951
Validation loss decreased (-0.941335 --> -0.951339).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0635111
	speed: 0.1590s/iter; left time: 6355.7512s
	iters: 200, epoch: 4 | loss: 0.2604422
	speed: 0.0431s/iter; left time: 1717.6616s
	iters: 300, epoch: 4 | loss: 0.0000280
	speed: 0.0440s/iter; left time: 1748.4930s
	iters: 400, epoch: 4 | loss: 0.0000211
	speed: 0.0355s/iter; left time: 1407.2489s
Epoch: 4 cost time: 17.090636491775513
Epoch: 4, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.222 Vali Acc: 0.959 Test Loss: 0.222 Test Acc: 0.959
Validation loss decreased (-0.951339 --> -0.959070).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0028326
	speed: 0.1722s/iter; left time: 6808.9523s
	iters: 200, epoch: 5 | loss: 0.0004050
	speed: 0.0282s/iter; left time: 1110.9905s
	iters: 300, epoch: 5 | loss: 0.0000232
	speed: 0.0321s/iter; left time: 1262.7103s
	iters: 400, epoch: 5 | loss: 0.0012307
	speed: 0.0297s/iter; left time: 1164.2728s
Epoch: 5 cost time: 13.859856605529785
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.307 Vali Acc: 0.958 Test Loss: 0.307 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.1677s/iter; left time: 6563.8617s
	iters: 200, epoch: 6 | loss: 0.0000065
	speed: 0.0334s/iter; left time: 1304.0851s
	iters: 300, epoch: 6 | loss: 0.0034312
	speed: 0.0353s/iter; left time: 1373.2699s
	iters: 400, epoch: 6 | loss: 0.0000003
	speed: 0.0317s/iter; left time: 1229.5585s
Epoch: 6 cost time: 14.644943237304688
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.249 Vali Acc: 0.958 Test Loss: 0.249 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1791474
	speed: 0.1743s/iter; left time: 6748.3074s
	iters: 200, epoch: 7 | loss: 0.0000039
	speed: 0.0392s/iter; left time: 1515.0494s
	iters: 300, epoch: 7 | loss: 0.0001670
	speed: 0.0336s/iter; left time: 1292.5541s
	iters: 400, epoch: 7 | loss: 0.0000338
	speed: 0.0360s/iter; left time: 1384.0750s
Epoch: 7 cost time: 15.65419340133667
Epoch: 7, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.352 Vali Acc: 0.955 Test Loss: 0.352 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000005
	speed: 0.1905s/iter; left time: 7298.1007s
	iters: 200, epoch: 8 | loss: 0.0293312
	speed: 0.0433s/iter; left time: 1653.4061s
	iters: 300, epoch: 8 | loss: 0.0000880
	speed: 0.0397s/iter; left time: 1512.7235s
	iters: 400, epoch: 8 | loss: 0.0558822
	speed: 0.0362s/iter; left time: 1374.5100s
Epoch: 8 cost time: 17.41866636276245
Epoch: 8, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.260 Vali Acc: 0.965 Test Loss: 0.260 Test Acc: 0.965
Validation loss decreased (-0.959070 --> -0.964527).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0142791
	speed: 0.1884s/iter; left time: 7140.8958s
	iters: 200, epoch: 9 | loss: 0.0057198
	speed: 0.0358s/iter; left time: 1351.8134s
	iters: 300, epoch: 9 | loss: 0.0056929
	speed: 0.0354s/iter; left time: 1336.0211s
	iters: 400, epoch: 9 | loss: 0.0002622
	speed: 0.0323s/iter; left time: 1214.8714s
Epoch: 9 cost time: 15.578300714492798
Epoch: 9, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.238 Vali Acc: 0.968 Test Loss: 0.238 Test Acc: 0.968
Validation loss decreased (-0.964527 --> -0.967710).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000042
	speed: 0.1777s/iter; left time: 6660.3412s
	iters: 200, epoch: 10 | loss: 0.0145986
	speed: 0.0352s/iter; left time: 1314.2579s
	iters: 300, epoch: 10 | loss: 0.0000552
	speed: 0.0332s/iter; left time: 1237.1434s
	iters: 400, epoch: 10 | loss: 0.0000017
	speed: 0.0365s/iter; left time: 1358.8734s
Epoch: 10 cost time: 15.539774656295776
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.328 Vali Acc: 0.962 Test Loss: 0.328 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000097
	speed: 0.1697s/iter; left time: 6292.2333s
	iters: 200, epoch: 11 | loss: 0.0002010
	speed: 0.0308s/iter; left time: 1138.2695s
	iters: 300, epoch: 11 | loss: 0.0613483
	speed: 0.0330s/iter; left time: 1215.0817s
	iters: 400, epoch: 11 | loss: 0.0000002
	speed: 0.0297s/iter; left time: 1090.3857s
Epoch: 11 cost time: 13.92046070098877
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.321 Vali Acc: 0.961 Test Loss: 0.321 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1570s/iter; left time: 5756.0920s
	iters: 200, epoch: 12 | loss: 0.0002300
	speed: 0.0323s/iter; left time: 1179.5836s
	iters: 300, epoch: 12 | loss: 0.0000254
	speed: 0.0284s/iter; left time: 1034.8510s
	iters: 400, epoch: 12 | loss: 0.0000006
	speed: 0.0344s/iter; left time: 1250.8355s
Epoch: 12 cost time: 13.756059646606445
Epoch: 12, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.282 Vali Acc: 0.968 Test Loss: 0.282 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0382618
	speed: 0.1607s/iter; left time: 5824.3323s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 1424.2413s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0396s/iter; left time: 1428.2713s
	iters: 400, epoch: 13 | loss: 0.0000136
	speed: 0.0411s/iter; left time: 1475.8078s
Epoch: 13 cost time: 17.447548151016235
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.297 Vali Acc: 0.961 Test Loss: 0.297 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000024
	speed: 0.1805s/iter; left time: 6467.7415s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0417s/iter; left time: 1491.7656s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 1570.1911s
	iters: 400, epoch: 14 | loss: 0.0000024
	speed: 0.0475s/iter; left time: 1687.5657s
Epoch: 14 cost time: 19.05605173110962
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.337 Vali Acc: 0.969 Test Loss: 0.337 Test Acc: 0.969
Validation loss decreased (-0.967710 --> -0.969073).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1877s/iter; left time: 6648.4761s
	iters: 200, epoch: 15 | loss: 0.1296774
	speed: 0.0577s/iter; left time: 2036.9987s
	iters: 300, epoch: 15 | loss: 0.0934879
	speed: 0.0516s/iter; left time: 1817.2777s
	iters: 400, epoch: 15 | loss: 0.0000005
	speed: 0.0470s/iter; left time: 1650.0601s
Epoch: 15 cost time: 22.41425585746765
Epoch: 15, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.288 Vali Acc: 0.965 Test Loss: 0.288 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000095
	speed: 0.1645s/iter; left time: 5757.6773s
	iters: 200, epoch: 16 | loss: 0.0000173
	speed: 0.0390s/iter; left time: 1361.7414s
	iters: 300, epoch: 16 | loss: 0.0070478
	speed: 0.0441s/iter; left time: 1533.5990s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1699.9112s
Epoch: 16 cost time: 18.648385524749756
Epoch: 16, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.393 Vali Acc: 0.962 Test Loss: 0.393 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000004
	speed: 0.1749s/iter; left time: 6049.9589s
	iters: 200, epoch: 17 | loss: 0.0000003
	speed: 0.0390s/iter; left time: 1344.4048s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 1542.8487s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 1456.1547s
Epoch: 17 cost time: 17.72860026359558
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.238 Vali Acc: 0.971 Test Loss: 0.238 Test Acc: 0.971
Validation loss decreased (-0.969073 --> -0.970893).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4757434
	speed: 0.1758s/iter; left time: 6008.6384s
	iters: 200, epoch: 18 | loss: 0.0000169
	speed: 0.0402s/iter; left time: 1369.4769s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 1432.8694s
	iters: 400, epoch: 18 | loss: 0.0003015
	speed: 0.0403s/iter; left time: 1365.4435s
Epoch: 18 cost time: 18.144218683242798
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.310 Vali Acc: 0.968 Test Loss: 0.310 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000305
	speed: 0.1722s/iter; left time: 5813.5188s
	iters: 200, epoch: 19 | loss: 0.0000012
	speed: 0.0448s/iter; left time: 1506.9728s
	iters: 300, epoch: 19 | loss: 0.0005238
	speed: 0.0420s/iter; left time: 1408.5388s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 1348.1219s
Epoch: 19 cost time: 18.449768543243408
Epoch: 19, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.319 Vali Acc: 0.969 Test Loss: 0.319 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1771s/iter; left time: 5908.6175s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0538s/iter; left time: 1790.2873s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0582s/iter; left time: 1929.5191s
	iters: 400, epoch: 20 | loss: 0.0005354
	speed: 0.0563s/iter; left time: 1860.4705s
Epoch: 20 cost time: 23.3834445476532
Epoch: 20, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.364 Vali Acc: 0.967 Test Loss: 0.364 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1743s/iter; left time: 5741.0293s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 1229.2523s
	iters: 300, epoch: 21 | loss: 0.0000365
	speed: 0.0398s/iter; left time: 1302.9861s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 1288.0028s
Epoch: 21 cost time: 16.98761820793152
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.338 Vali Acc: 0.964 Test Loss: 0.338 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1697s/iter; left time: 5521.1437s
	iters: 200, epoch: 22 | loss: 0.0018095
	speed: 0.0316s/iter; left time: 1024.5136s
	iters: 300, epoch: 22 | loss: 0.0328482
	speed: 0.0337s/iter; left time: 1089.1332s
	iters: 400, epoch: 22 | loss: 0.0000010
	speed: 0.0348s/iter; left time: 1121.5311s
Epoch: 22 cost time: 14.851931095123291
Epoch: 22, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.417 Vali Acc: 0.965 Test Loss: 0.417 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000130
	speed: 0.1746s/iter; left time: 5608.8245s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 1061.1611s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0313s/iter; left time: 1000.5289s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 1101.4124s
Epoch: 23 cost time: 14.295051336288452
Epoch: 23, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.435 Vali Acc: 0.966 Test Loss: 0.435 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1659s/iter; left time: 5260.5175s
	iters: 200, epoch: 24 | loss: 0.0000005
	speed: 0.0386s/iter; left time: 1218.5280s
	iters: 300, epoch: 24 | loss: 0.0121449
	speed: 0.0340s/iter; left time: 1072.5353s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 1096.7449s
Epoch: 24 cost time: 15.313452005386353
Epoch: 24, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.391 Vali Acc: 0.964 Test Loss: 0.391 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1499s/iter; left time: 4691.1751s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 1086.3992s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 963.1554s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0320s/iter; left time: 992.6215s
Epoch: 25 cost time: 14.364046573638916
Epoch: 25, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.316 Vali Acc: 0.973 Test Loss: 0.316 Test Acc: 0.973
Validation loss decreased (-0.970893 --> -0.972712).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0012776
	speed: 0.1592s/iter; left time: 4915.3278s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0298s/iter; left time: 917.3312s
	iters: 300, epoch: 26 | loss: 0.0003471
	speed: 0.0316s/iter; left time: 969.4786s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 941.0350s
Epoch: 26 cost time: 13.648293256759644
Epoch: 26, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.403 Vali Acc: 0.965 Test Loss: 0.403 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1751s/iter; left time: 5333.6752s
	iters: 200, epoch: 27 | loss: 0.0103163
	speed: 0.0407s/iter; left time: 1236.7282s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 1074.1966s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 1190.0951s
Epoch: 27 cost time: 17.19721221923828
Epoch: 27, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.438 Vali Acc: 0.968 Test Loss: 0.438 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1622s/iter; left time: 4873.7508s
	iters: 200, epoch: 28 | loss: 0.0000112
	speed: 0.0427s/iter; left time: 1277.6054s
	iters: 300, epoch: 28 | loss: 0.0000002
	speed: 0.0461s/iter; left time: 1376.1978s
	iters: 400, epoch: 28 | loss: 0.3414029
	speed: 0.0435s/iter; left time: 1294.2933s
Epoch: 28 cost time: 18.140519618988037
Epoch: 28, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.401 Vali Acc: 0.970 Test Loss: 0.401 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0000001
	speed: 0.1579s/iter; left time: 4680.0292s
	iters: 200, epoch: 29 | loss: 0.0000001
	speed: 0.0418s/iter; left time: 1235.4577s
	iters: 300, epoch: 29 | loss: 0.0003353
	speed: 0.0409s/iter; left time: 1203.1978s
	iters: 400, epoch: 29 | loss: 0.0000024
	speed: 0.0400s/iter; left time: 1173.1110s
Epoch: 29 cost time: 17.729870557785034
Epoch: 29, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.348 Vali Acc: 0.968 Test Loss: 0.348 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0000001
	speed: 0.1719s/iter; left time: 5024.4580s
	iters: 200, epoch: 30 | loss: 0.0000930
	speed: 0.0394s/iter; left time: 1147.1887s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0376s/iter; left time: 1092.6107s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 1130.6622s
Epoch: 30 cost time: 17.093939065933228
Epoch: 30, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.363 Vali Acc: 0.967 Test Loss: 0.363 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1702s/iter; left time: 4902.8773s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 1315.7886s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 1164.7038s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 1171.9362s
Epoch: 31 cost time: 18.35869598388672
Epoch: 31, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.419 Vali Acc: 0.965 Test Loss: 0.419 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1635s/iter; left time: 4642.8462s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0397s/iter; left time: 1124.2529s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 1244.7898s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 1303.2853s
Epoch: 32 cost time: 18.49793577194214
Epoch: 32, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.301 Vali Acc: 0.970 Test Loss: 0.301 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1731s/iter; left time: 4842.8080s
	iters: 200, epoch: 33 | loss: 0.0069187
	speed: 0.0398s/iter; left time: 1109.7842s
	iters: 300, epoch: 33 | loss: 0.0000002
	speed: 0.0418s/iter; left time: 1161.6838s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0382s/iter; left time: 1056.5259s
Epoch: 33 cost time: 17.308900594711304
Epoch: 33, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.582 Vali Acc: 0.957 Test Loss: 0.582 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1759s/iter; left time: 4849.5394s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 1413.8487s
	iters: 300, epoch: 34 | loss: 0.0000007
	speed: 0.0446s/iter; left time: 1219.4655s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 1225.5686s
Epoch: 34 cost time: 20.677134037017822
Epoch: 34, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.340 Vali Acc: 0.967 Test Loss: 0.340 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1958s/iter; left time: 5318.9961s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0550s/iter; left time: 1488.8595s
	iters: 300, epoch: 35 | loss: 0.0000327
	speed: 0.0508s/iter; left time: 1370.3204s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 1409.8899s
Epoch: 35 cost time: 22.31088900566101
Epoch: 35, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.372 Vali Acc: 0.969 Test Loss: 0.372 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9727148703956344
model parameter : 101130
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3184890
	speed: 0.0634s/iter; left time: 2613.5282s
	iters: 200, epoch: 1 | loss: 0.1456816
	speed: 0.0314s/iter; left time: 1290.6842s
	iters: 300, epoch: 1 | loss: 0.0426490
	speed: 0.0302s/iter; left time: 1238.4148s
	iters: 400, epoch: 1 | loss: 0.2117274
	speed: 0.0267s/iter; left time: 1093.5633s
Epoch: 1 cost time: 15.560348272323608
Epoch: 1, Steps: 413 | Train Loss: 0.440 Vali Loss: 0.136 Vali Acc: 0.953 Test Loss: 0.136 Test Acc: 0.953
Validation loss decreased (inf --> -0.952704).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0475206
	speed: 0.1478s/iter; left time: 6027.7615s
	iters: 200, epoch: 2 | loss: 0.0197092
	speed: 0.0325s/iter; left time: 1320.7703s
	iters: 300, epoch: 2 | loss: 0.1457460
	speed: 0.0313s/iter; left time: 1268.3778s
	iters: 400, epoch: 2 | loss: 0.3796193
	speed: 0.0298s/iter; left time: 1205.5041s
Epoch: 2 cost time: 13.52191162109375
Epoch: 2, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
Validation loss decreased (-0.952704 --> -0.959526).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0058022
	speed: 0.1470s/iter; left time: 5935.9542s
	iters: 200, epoch: 3 | loss: 0.0938210
	speed: 0.0343s/iter; left time: 1382.7479s
	iters: 300, epoch: 3 | loss: 0.7353214
	speed: 0.0285s/iter; left time: 1143.1056s
	iters: 400, epoch: 3 | loss: 0.0410748
	speed: 0.0279s/iter; left time: 1119.2722s
Epoch: 3 cost time: 12.795876741409302
Epoch: 3, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.181 Vali Acc: 0.955 Test Loss: 0.181 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0324087
	speed: 0.1440s/iter; left time: 5753.0137s
	iters: 200, epoch: 4 | loss: 0.1186498
	speed: 0.0338s/iter; left time: 1347.6536s
	iters: 300, epoch: 4 | loss: 0.0036837
	speed: 0.0294s/iter; left time: 1167.5760s
	iters: 400, epoch: 4 | loss: 0.0003938
	speed: 0.0290s/iter; left time: 1150.9382s
Epoch: 4 cost time: 13.257134437561035
Epoch: 4, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
Validation loss decreased (-0.959526 --> -0.964073).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0002598
	speed: 0.1519s/iter; left time: 6007.8781s
	iters: 200, epoch: 5 | loss: 0.0004975
	speed: 0.0306s/iter; left time: 1208.6595s
	iters: 300, epoch: 5 | loss: 0.2222743
	speed: 0.0346s/iter; left time: 1359.6197s
	iters: 400, epoch: 5 | loss: 0.0255218
	speed: 0.0322s/iter; left time: 1264.0058s
Epoch: 5 cost time: 14.016026258468628
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000256
	speed: 0.1571s/iter; left time: 6146.8989s
	iters: 200, epoch: 6 | loss: 0.0068031
	speed: 0.0297s/iter; left time: 1157.6841s
	iters: 300, epoch: 6 | loss: 0.0006724
	speed: 0.0306s/iter; left time: 1190.7344s
	iters: 400, epoch: 6 | loss: 0.0003089
	speed: 0.0274s/iter; left time: 1065.2182s
Epoch: 6 cost time: 13.059224128723145
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.191 Vali Acc: 0.962 Test Loss: 0.191 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0692650
	speed: 0.1677s/iter; left time: 6492.0196s
	iters: 200, epoch: 7 | loss: 0.0002398
	speed: 0.0336s/iter; left time: 1298.7438s
	iters: 300, epoch: 7 | loss: 0.0001022
	speed: 0.0309s/iter; left time: 1192.1180s
	iters: 400, epoch: 7 | loss: 0.1219908
	speed: 0.0284s/iter; left time: 1090.7326s
Epoch: 7 cost time: 13.874407291412354
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.262 Vali Acc: 0.960 Test Loss: 0.262 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0001191
	speed: 0.1666s/iter; left time: 6381.0463s
	iters: 200, epoch: 8 | loss: 0.0548363
	speed: 0.0307s/iter; left time: 1172.3755s
	iters: 300, epoch: 8 | loss: 0.0032097
	speed: 0.0295s/iter; left time: 1124.3742s
	iters: 400, epoch: 8 | loss: 0.0020612
	speed: 0.0299s/iter; left time: 1136.7305s
Epoch: 8 cost time: 13.384775876998901
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.212 Vali Acc: 0.963 Test Loss: 0.212 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0001051
	speed: 0.1505s/iter; left time: 5702.2782s
	iters: 200, epoch: 9 | loss: 0.0016895
	speed: 0.0269s/iter; left time: 1016.6844s
	iters: 300, epoch: 9 | loss: 0.0034116
	speed: 0.0264s/iter; left time: 996.1234s
	iters: 400, epoch: 9 | loss: 0.0000136
	speed: 0.0299s/iter; left time: 1122.5876s
Epoch: 9 cost time: 11.993494749069214
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0002439
	speed: 0.1699s/iter; left time: 6369.7483s
	iters: 200, epoch: 10 | loss: 0.0014989
	speed: 0.0257s/iter; left time: 960.6177s
	iters: 300, epoch: 10 | loss: 0.0000794
	speed: 0.0290s/iter; left time: 1080.7363s
	iters: 400, epoch: 10 | loss: 0.0000461
	speed: 0.0281s/iter; left time: 1046.3589s
Epoch: 10 cost time: 12.503993511199951
Epoch: 10, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.245 Vali Acc: 0.965 Test Loss: 0.245 Test Acc: 0.965
Validation loss decreased (-0.964073 --> -0.964527).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0231962
	speed: 0.1696s/iter; left time: 6288.2394s
	iters: 200, epoch: 11 | loss: 0.0000081
	speed: 0.0329s/iter; left time: 1217.2278s
	iters: 300, epoch: 11 | loss: 0.0025200
	speed: 0.0309s/iter; left time: 1138.9197s
	iters: 400, epoch: 11 | loss: 0.0000005
	speed: 0.0339s/iter; left time: 1246.3051s
Epoch: 11 cost time: 14.164384841918945
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.236 Vali Acc: 0.967 Test Loss: 0.236 Test Acc: 0.967
Validation loss decreased (-0.964527 --> -0.966801).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.1629s/iter; left time: 5972.2065s
	iters: 200, epoch: 12 | loss: 0.0000057
	speed: 0.0287s/iter; left time: 1050.6333s
	iters: 300, epoch: 12 | loss: 0.1591122
	speed: 0.0302s/iter; left time: 1101.8583s
	iters: 400, epoch: 12 | loss: 0.0000238
	speed: 0.0329s/iter; left time: 1197.2787s
Epoch: 12 cost time: 13.360655307769775
Epoch: 12, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.384 Vali Acc: 0.955 Test Loss: 0.384 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0096232
	speed: 0.1758s/iter; left time: 6370.1169s
	iters: 200, epoch: 13 | loss: 0.0008351
	speed: 0.0314s/iter; left time: 1136.1095s
	iters: 300, epoch: 13 | loss: 0.2454863
	speed: 0.0330s/iter; left time: 1188.5234s
	iters: 400, epoch: 13 | loss: 0.0012630
	speed: 0.0331s/iter; left time: 1189.6136s
Epoch: 13 cost time: 14.580110549926758
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.251 Vali Acc: 0.967 Test Loss: 0.251 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000054
	speed: 0.1732s/iter; left time: 6205.6022s
	iters: 200, epoch: 14 | loss: 0.0266561
	speed: 0.0333s/iter; left time: 1190.2111s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 1250.0564s
	iters: 400, epoch: 14 | loss: 0.0000113
	speed: 0.0321s/iter; left time: 1141.2086s
Epoch: 14 cost time: 14.638685941696167
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.304 Vali Acc: 0.963 Test Loss: 0.304 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0047257
	speed: 0.1778s/iter; left time: 6297.6814s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0309s/iter; left time: 1090.8201s
	iters: 300, epoch: 15 | loss: 0.0010815
	speed: 0.0338s/iter; left time: 1189.5188s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0308s/iter; left time: 1083.3407s
Epoch: 15 cost time: 14.276892900466919
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.277 Vali Acc: 0.967 Test Loss: 0.277 Test Acc: 0.967
Validation loss decreased (-0.966801 --> -0.967255).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000012
	speed: 0.1840s/iter; left time: 6441.1015s
	iters: 200, epoch: 16 | loss: 0.0044485
	speed: 0.0318s/iter; left time: 1110.0739s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0330s/iter; left time: 1149.1422s
	iters: 400, epoch: 16 | loss: 0.0004202
	speed: 0.0342s/iter; left time: 1185.8325s
Epoch: 16 cost time: 14.368489027023315
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.228 Vali Acc: 0.972 Test Loss: 0.228 Test Acc: 0.972
Validation loss decreased (-0.967255 --> -0.971803).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.1672s/iter; left time: 5785.5040s
	iters: 200, epoch: 17 | loss: 0.0016883
	speed: 0.0339s/iter; left time: 1168.7487s
	iters: 300, epoch: 17 | loss: 0.0001104
	speed: 0.0321s/iter; left time: 1103.0121s
	iters: 400, epoch: 17 | loss: 0.0000007
	speed: 0.0341s/iter; left time: 1170.1515s
Epoch: 17 cost time: 14.70895767211914
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.267 Vali Acc: 0.969 Test Loss: 0.267 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000088
	speed: 0.1649s/iter; left time: 5637.6814s
	iters: 200, epoch: 18 | loss: 0.0065381
	speed: 0.0340s/iter; left time: 1158.1084s
	iters: 300, epoch: 18 | loss: 0.0000015
	speed: 0.0314s/iter; left time: 1066.3372s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0309s/iter; left time: 1046.4492s
Epoch: 18 cost time: 13.636612176895142
Epoch: 18, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.380 Vali Acc: 0.960 Test Loss: 0.380 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4993057
	speed: 0.1583s/iter; left time: 5344.8928s
	iters: 200, epoch: 19 | loss: 0.0327594
	speed: 0.0293s/iter; left time: 986.6067s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 928.0075s
	iters: 400, epoch: 19 | loss: 0.0000004
	speed: 0.0288s/iter; left time: 962.9157s
Epoch: 19 cost time: 12.828273057937622
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.292 Vali Acc: 0.966 Test Loss: 0.292 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1422s/iter; left time: 4744.5277s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0270s/iter; left time: 898.1054s
	iters: 300, epoch: 20 | loss: 0.0051447
	speed: 0.0283s/iter; left time: 939.3454s
	iters: 400, epoch: 20 | loss: 0.0000007
	speed: 0.0332s/iter; left time: 1095.9560s
Epoch: 20 cost time: 12.647935390472412
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.971803 --> -0.975441).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0012837
	speed: 0.1563s/iter; left time: 5147.2087s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.0277s/iter; left time: 910.5961s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.0306s/iter; left time: 1002.8877s
	iters: 400, epoch: 21 | loss: 0.0071259
	speed: 0.0301s/iter; left time: 981.6377s
Epoch: 21 cost time: 12.932564973831177
Epoch: 21, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.292 Vali Acc: 0.965 Test Loss: 0.292 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0004196
	speed: 0.1564s/iter; left time: 5088.3105s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0324s/iter; left time: 1050.0721s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0323s/iter; left time: 1043.3472s
	iters: 400, epoch: 22 | loss: 0.0000011
	speed: 0.0322s/iter; left time: 1039.3063s
Epoch: 22 cost time: 14.210992097854614
Epoch: 22, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.306 Vali Acc: 0.965 Test Loss: 0.306 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000062
	speed: 0.1502s/iter; left time: 4822.5340s
	iters: 200, epoch: 23 | loss: 0.2176018
	speed: 0.0315s/iter; left time: 1008.2916s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0322s/iter; left time: 1026.5260s
	iters: 400, epoch: 23 | loss: 0.0000001
	speed: 0.0293s/iter; left time: 930.7704s
Epoch: 23 cost time: 13.142204999923706
Epoch: 23, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.274 Vali Acc: 0.973 Test Loss: 0.274 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.1625968
	speed: 0.1691s/iter; left time: 5360.6825s
	iters: 200, epoch: 24 | loss: 0.0000004
	speed: 0.0297s/iter; left time: 939.4238s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 917.9889s
	iters: 400, epoch: 24 | loss: 0.0000216
	speed: 0.0297s/iter; left time: 932.7403s
Epoch: 24 cost time: 13.262099504470825
Epoch: 24, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.343 Vali Acc: 0.970 Test Loss: 0.343 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000448
	speed: 0.1474s/iter; left time: 4612.9221s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 907.4781s
	iters: 300, epoch: 25 | loss: 0.0004207
	speed: 0.0331s/iter; left time: 1030.0954s
	iters: 400, epoch: 25 | loss: 0.0003786
	speed: 0.0294s/iter; left time: 912.3798s
Epoch: 25 cost time: 13.092251539230347
Epoch: 25, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.446 Vali Acc: 0.965 Test Loss: 0.446 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0001597
	speed: 0.1595s/iter; left time: 4924.9061s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 925.7496s
	iters: 300, epoch: 26 | loss: 0.0000009
	speed: 0.0306s/iter; left time: 939.5476s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0340s/iter; left time: 1039.9192s
Epoch: 26 cost time: 13.727010488510132
Epoch: 26, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.304 Vali Acc: 0.973 Test Loss: 0.304 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000540
	speed: 0.1497s/iter; left time: 4559.2302s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0298s/iter; left time: 906.1676s
	iters: 300, epoch: 27 | loss: 0.0000920
	speed: 0.0312s/iter; left time: 944.0848s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 846.7282s
Epoch: 27 cost time: 12.869364023208618
Epoch: 27, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.273 Vali Acc: 0.977 Test Loss: 0.273 Test Acc: 0.977
Validation loss decreased (-0.975441 --> -0.977260).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1612s/iter; left time: 4843.0223s
	iters: 200, epoch: 28 | loss: 0.0000684
	speed: 0.0335s/iter; left time: 1002.6355s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0305s/iter; left time: 910.6700s
	iters: 400, epoch: 28 | loss: 0.0062720
	speed: 0.0325s/iter; left time: 968.2408s
Epoch: 28 cost time: 13.747475385665894
Epoch: 28, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.297 Vali Acc: 0.972 Test Loss: 0.297 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000768
	speed: 0.1646s/iter; left time: 4877.3973s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 1089.7682s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0347s/iter; left time: 1020.2476s
	iters: 400, epoch: 29 | loss: 0.0006076
	speed: 0.0354s/iter; left time: 1037.9923s
Epoch: 29 cost time: 15.20209288597107
Epoch: 29, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.230 Vali Acc: 0.976 Test Loss: 0.230 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1609s/iter; left time: 4700.9149s
	iters: 200, epoch: 30 | loss: 0.0000001
	speed: 0.0315s/iter; left time: 916.6587s
	iters: 300, epoch: 30 | loss: 0.0149725
	speed: 0.0318s/iter; left time: 923.6153s
	iters: 400, epoch: 30 | loss: 0.0588200
	speed: 0.0321s/iter; left time: 927.3122s
Epoch: 30 cost time: 13.530679941177368
Epoch: 30, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0002620
	speed: 0.1636s/iter; left time: 4712.4215s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0340s/iter; left time: 977.0378s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0309s/iter; left time: 884.7789s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0304s/iter; left time: 865.4264s
Epoch: 31 cost time: 13.864185810089111
Epoch: 31, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.356 Vali Acc: 0.971 Test Loss: 0.356 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0004400
	speed: 0.1620s/iter; left time: 4600.4659s
	iters: 200, epoch: 32 | loss: 0.0000026
	speed: 0.0360s/iter; left time: 1018.7094s
	iters: 300, epoch: 32 | loss: 0.0000020
	speed: 0.0298s/iter; left time: 839.5478s
	iters: 400, epoch: 32 | loss: 0.0000001
	speed: 0.0322s/iter; left time: 904.8922s
Epoch: 32 cost time: 13.879008531570435
Epoch: 32, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.317 Vali Acc: 0.972 Test Loss: 0.317 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1593s/iter; left time: 4457.5377s
	iters: 200, epoch: 33 | loss: 0.1457734
	speed: 0.0303s/iter; left time: 846.0364s
	iters: 300, epoch: 33 | loss: 0.0024648
	speed: 0.0312s/iter; left time: 868.0060s
	iters: 400, epoch: 33 | loss: 0.0007758
	speed: 0.0325s/iter; left time: 900.5414s
Epoch: 33 cost time: 13.778680562973022
Epoch: 33, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.344 Vali Acc: 0.964 Test Loss: 0.344 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1584s/iter; left time: 4366.8885s
	iters: 200, epoch: 34 | loss: 0.0000003
	speed: 0.0336s/iter; left time: 921.9366s
	iters: 300, epoch: 34 | loss: 0.0000006
	speed: 0.0285s/iter; left time: 780.4653s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 784.0220s
Epoch: 34 cost time: 13.639905452728271
Epoch: 34, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.372 Vali Acc: 0.969 Test Loss: 0.372 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1527s/iter; left time: 4146.0019s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 909.2867s
	iters: 300, epoch: 35 | loss: 0.0000001
	speed: 0.0349s/iter; left time: 940.3152s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 960.0542s
Epoch: 35 cost time: 14.697849750518799
Epoch: 35, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.350 Vali Acc: 0.971 Test Loss: 0.350 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.1574s/iter; left time: 4209.2397s
	iters: 200, epoch: 36 | loss: 0.2888094
	speed: 0.0337s/iter; left time: 898.2447s
	iters: 300, epoch: 36 | loss: 0.0000154
	speed: 0.0351s/iter; left time: 932.4990s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0337s/iter; left time: 891.1043s
Epoch: 36 cost time: 14.860422611236572
Epoch: 36, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.437 Vali Acc: 0.970 Test Loss: 0.437 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0000002
	speed: 0.1703s/iter; left time: 4484.8602s
	iters: 200, epoch: 37 | loss: 0.1644079
	speed: 0.0368s/iter; left time: 966.5952s
	iters: 300, epoch: 37 | loss: 0.0000024
	speed: 0.0352s/iter; left time: 920.8584s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0339s/iter; left time: 883.4239s
Epoch: 37 cost time: 15.592998266220093
Epoch: 37, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.575 Vali Acc: 0.963 Test Loss: 0.575 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df64_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.977262391996362
model parameter : 67882
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5348992
	speed: 0.0675s/iter; left time: 2780.5715s
	iters: 200, epoch: 1 | loss: 0.1717196
	speed: 0.0319s/iter; left time: 1312.6947s
	iters: 300, epoch: 1 | loss: 0.2113168
	speed: 0.0326s/iter; left time: 1334.9744s
	iters: 400, epoch: 1 | loss: 0.0434363
	speed: 0.0310s/iter; left time: 1269.2864s
Epoch: 1 cost time: 16.72328805923462
Epoch: 1, Steps: 413 | Train Loss: 0.510 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
Validation loss decreased (inf --> -0.946338).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2083290
	speed: 0.1648s/iter; left time: 6722.6950s
	iters: 200, epoch: 2 | loss: 0.0027051
	speed: 0.0305s/iter; left time: 1240.6516s
	iters: 300, epoch: 2 | loss: 0.0344130
	speed: 0.0301s/iter; left time: 1221.4915s
	iters: 400, epoch: 2 | loss: 0.1540477
	speed: 0.0295s/iter; left time: 1192.6835s
Epoch: 2 cost time: 13.403619766235352
Epoch: 2, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.089 Vali Acc: 0.972 Test Loss: 0.089 Test Acc: 0.972
Validation loss decreased (-0.946338 --> -0.971804).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0029042
	speed: 0.1663s/iter; left time: 6714.0174s
	iters: 200, epoch: 3 | loss: 0.0163890
	speed: 0.0342s/iter; left time: 1377.9459s
	iters: 300, epoch: 3 | loss: 0.0043371
	speed: 0.0339s/iter; left time: 1361.4975s
	iters: 400, epoch: 3 | loss: 0.0582715
	speed: 0.0351s/iter; left time: 1407.6650s
Epoch: 3 cost time: 14.526521682739258
Epoch: 3, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.125 Vali Acc: 0.960 Test Loss: 0.125 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0123220
	speed: 0.1690s/iter; left time: 6753.3923s
	iters: 200, epoch: 4 | loss: 0.0106120
	speed: 0.0296s/iter; left time: 1178.8400s
	iters: 300, epoch: 4 | loss: 0.0094790
	speed: 0.0316s/iter; left time: 1255.2187s
	iters: 400, epoch: 4 | loss: 0.0003552
	speed: 0.0312s/iter; left time: 1238.5555s
Epoch: 4 cost time: 13.60299038887024
Epoch: 4, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
Validation loss decreased (-0.971804 --> -0.972259).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0008872
	speed: 0.1695s/iter; left time: 6703.3347s
	iters: 200, epoch: 5 | loss: 0.0282022
	speed: 0.0313s/iter; left time: 1236.5244s
	iters: 300, epoch: 5 | loss: 0.0035567
	speed: 0.0313s/iter; left time: 1232.7146s
	iters: 400, epoch: 5 | loss: 0.0000403
	speed: 0.0319s/iter; left time: 1252.9286s
Epoch: 5 cost time: 13.76927375793457
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.972259 --> -0.974988).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0171756
	speed: 0.1649s/iter; left time: 6455.1881s
	iters: 200, epoch: 6 | loss: 0.0433822
	speed: 0.0310s/iter; left time: 1211.6305s
	iters: 300, epoch: 6 | loss: 0.0337392
	speed: 0.0310s/iter; left time: 1206.3664s
	iters: 400, epoch: 6 | loss: 0.0004364
	speed: 0.0320s/iter; left time: 1241.8698s
Epoch: 6 cost time: 13.661038160324097
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.163 Vali Acc: 0.966 Test Loss: 0.163 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0003165
	speed: 0.1514s/iter; left time: 5861.8558s
	iters: 200, epoch: 7 | loss: 0.0076161
	speed: 0.0284s/iter; left time: 1097.2877s
	iters: 300, epoch: 7 | loss: 0.1132818
	speed: 0.0309s/iter; left time: 1190.8385s
	iters: 400, epoch: 7 | loss: 0.0003821
	speed: 0.0330s/iter; left time: 1266.8224s
Epoch: 7 cost time: 13.57932996749878
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000368
	speed: 0.1575s/iter; left time: 6035.1852s
	iters: 200, epoch: 8 | loss: 0.0000291
	speed: 0.0282s/iter; left time: 1075.9731s
	iters: 300, epoch: 8 | loss: 0.0045233
	speed: 0.0307s/iter; left time: 1168.3983s
	iters: 400, epoch: 8 | loss: 0.0000634
	speed: 0.0310s/iter; left time: 1180.1241s
Epoch: 8 cost time: 13.474891424179077
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.144 Vali Acc: 0.974 Test Loss: 0.144 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000063
	speed: 0.1642s/iter; left time: 6220.9830s
	iters: 200, epoch: 9 | loss: 0.0901373
	speed: 0.0292s/iter; left time: 1104.8395s
	iters: 300, epoch: 9 | loss: 0.0000106
	speed: 0.0317s/iter; left time: 1194.9605s
	iters: 400, epoch: 9 | loss: 0.0002923
	speed: 0.0338s/iter; left time: 1271.1613s
Epoch: 9 cost time: 13.667243242263794
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000369
	speed: 0.1600s/iter; left time: 5996.9974s
	iters: 200, epoch: 10 | loss: 0.0227409
	speed: 0.0336s/iter; left time: 1257.6001s
	iters: 300, epoch: 10 | loss: 0.0000587
	speed: 0.0350s/iter; left time: 1305.3710s
	iters: 400, epoch: 10 | loss: 0.0403420
	speed: 0.0330s/iter; left time: 1226.8613s
Epoch: 10 cost time: 14.584553241729736
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0001447
	speed: 0.1700s/iter; left time: 6302.9804s
	iters: 200, epoch: 11 | loss: 0.0000002
	speed: 0.0373s/iter; left time: 1380.6936s
	iters: 300, epoch: 11 | loss: 0.0000061
	speed: 0.0392s/iter; left time: 1445.3863s
	iters: 400, epoch: 11 | loss: 0.0004787
	speed: 0.0335s/iter; left time: 1230.3825s
Epoch: 11 cost time: 16.123220443725586
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000028
	speed: 0.1885s/iter; left time: 6909.3247s
	iters: 200, epoch: 12 | loss: 0.0380678
	speed: 0.0352s/iter; left time: 1288.2361s
	iters: 300, epoch: 12 | loss: 0.0975324
	speed: 0.0353s/iter; left time: 1286.8331s
	iters: 400, epoch: 12 | loss: 0.0001519
	speed: 0.0377s/iter; left time: 1370.3992s
Epoch: 12 cost time: 15.845512390136719
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
Validation loss decreased (-0.974988 --> -0.978625).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0002895
	speed: 0.1733s/iter; left time: 6282.8034s
	iters: 200, epoch: 13 | loss: 0.0000352
	speed: 0.0306s/iter; left time: 1107.3670s
	iters: 300, epoch: 13 | loss: 0.0000416
	speed: 0.0370s/iter; left time: 1335.3468s
	iters: 400, epoch: 13 | loss: 0.0000387
	speed: 0.0356s/iter; left time: 1277.9847s
Epoch: 13 cost time: 15.153945922851562
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.973 Test Loss: 0.192 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0462014
	speed: 0.1654s/iter; left time: 5925.4577s
	iters: 200, epoch: 14 | loss: 0.0000947
	speed: 0.0320s/iter; left time: 1142.1703s
	iters: 300, epoch: 14 | loss: 0.0017243
	speed: 0.0334s/iter; left time: 1190.5122s
	iters: 400, epoch: 14 | loss: 0.0131178
	speed: 0.0379s/iter; left time: 1346.5711s
Epoch: 14 cost time: 14.907379627227783
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.256 Vali Acc: 0.969 Test Loss: 0.256 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000267
	speed: 0.1605s/iter; left time: 5685.0385s
	iters: 200, epoch: 15 | loss: 0.0004207
	speed: 0.0333s/iter; left time: 1177.0573s
	iters: 300, epoch: 15 | loss: 0.0000064
	speed: 0.0315s/iter; left time: 1110.4827s
	iters: 400, epoch: 15 | loss: 0.0000011
	speed: 0.0326s/iter; left time: 1144.6260s
Epoch: 15 cost time: 13.667299509048462
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.188 Vali Acc: 0.972 Test Loss: 0.188 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0061190
	speed: 0.1667s/iter; left time: 5836.9281s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0299s/iter; left time: 1044.9433s
	iters: 300, epoch: 16 | loss: 0.0822154
	speed: 0.0287s/iter; left time: 997.5261s
	iters: 400, epoch: 16 | loss: 0.0007128
	speed: 0.0341s/iter; left time: 1185.0223s
Epoch: 16 cost time: 13.561448812484741
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0010546
	speed: 0.1665s/iter; left time: 5758.5621s
	iters: 200, epoch: 17 | loss: 0.0000078
	speed: 0.0348s/iter; left time: 1200.7479s
	iters: 300, epoch: 17 | loss: 0.0827602
	speed: 0.0325s/iter; left time: 1117.8815s
	iters: 400, epoch: 17 | loss: 0.0105531
	speed: 0.0348s/iter; left time: 1193.4160s
Epoch: 17 cost time: 14.664734601974487
Epoch: 17, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.202 Vali Acc: 0.972 Test Loss: 0.202 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000350
	speed: 0.1672s/iter; left time: 5714.2813s
	iters: 200, epoch: 18 | loss: 0.0000205
	speed: 0.0298s/iter; left time: 1015.6402s
	iters: 300, epoch: 18 | loss: 0.0000026
	speed: 0.0306s/iter; left time: 1039.8691s
	iters: 400, epoch: 18 | loss: 0.0013437
	speed: 0.0315s/iter; left time: 1068.3593s
Epoch: 18 cost time: 13.565598726272583
Epoch: 18, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.153 Vali Acc: 0.977 Test Loss: 0.153 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000073
	speed: 0.1517s/iter; left time: 5123.4972s
	iters: 200, epoch: 19 | loss: 0.0000252
	speed: 0.0260s/iter; left time: 875.2141s
	iters: 300, epoch: 19 | loss: 0.0000108
	speed: 0.0359s/iter; left time: 1204.2559s
	iters: 400, epoch: 19 | loss: 0.0000176
	speed: 0.0323s/iter; left time: 1082.2589s
Epoch: 19 cost time: 13.161574840545654
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.973 Test Loss: 0.178 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0004003
	speed: 0.1657s/iter; left time: 5526.4129s
	iters: 200, epoch: 20 | loss: 0.0000082
	speed: 0.0337s/iter; left time: 1120.6614s
	iters: 300, epoch: 20 | loss: 0.0966618
	speed: 0.0327s/iter; left time: 1085.6202s
	iters: 400, epoch: 20 | loss: 0.0662878
	speed: 0.0296s/iter; left time: 977.6488s
Epoch: 20 cost time: 14.069790840148926
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.237 Vali Acc: 0.973 Test Loss: 0.237 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0938939
	speed: 0.1531s/iter; left time: 5042.4924s
	iters: 200, epoch: 21 | loss: 0.0001890
	speed: 0.0341s/iter; left time: 1121.0626s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 1193.4815s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0324s/iter; left time: 1058.5663s
Epoch: 21 cost time: 14.411248445510864
Epoch: 21, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0047050
	speed: 0.1472s/iter; left time: 4786.9695s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0328s/iter; left time: 1062.0580s
	iters: 300, epoch: 22 | loss: 0.0000002
	speed: 0.0341s/iter; left time: 1101.9943s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 1090.0425s
Epoch: 22 cost time: 14.017662525177002
Epoch: 22, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.282 Vali Acc: 0.968 Test Loss: 0.282 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9786266484765803
model parameter : 51274
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df64_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4975001
	speed: 0.0580s/iter; left time: 2391.7046s
	iters: 200, epoch: 1 | loss: 0.1645305
	speed: 0.0326s/iter; left time: 1338.8698s
	iters: 300, epoch: 1 | loss: 0.0775953
	speed: 0.0341s/iter; left time: 1398.2147s
	iters: 400, epoch: 1 | loss: 0.1922261
	speed: 0.0306s/iter; left time: 1250.9468s
Epoch: 1 cost time: 15.990882158279419
Epoch: 1, Steps: 413 | Train Loss: 0.557 Vali Loss: 0.127 Vali Acc: 0.961 Test Loss: 0.127 Test Acc: 0.961
Validation loss decreased (inf --> -0.961345).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0992204
	speed: 0.1753s/iter; left time: 7150.4574s
	iters: 200, epoch: 2 | loss: 0.1914683
	speed: 0.0353s/iter; left time: 1437.4957s
	iters: 300, epoch: 2 | loss: 0.4314813
	speed: 0.0337s/iter; left time: 1367.6162s
	iters: 400, epoch: 2 | loss: 0.0077532
	speed: 0.0333s/iter; left time: 1347.1961s
Epoch: 2 cost time: 15.404002904891968
Epoch: 2, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.087 Vali Acc: 0.967 Test Loss: 0.087 Test Acc: 0.967
Validation loss decreased (-0.961345 --> -0.966802).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0012053
	speed: 0.1880s/iter; left time: 7589.8683s
	iters: 200, epoch: 3 | loss: 0.1993187
	speed: 0.0363s/iter; left time: 1460.8063s
	iters: 300, epoch: 3 | loss: 0.0023199
	speed: 0.0344s/iter; left time: 1380.4501s
	iters: 400, epoch: 3 | loss: 0.0055694
	speed: 0.0368s/iter; left time: 1474.1875s
Epoch: 3 cost time: 15.542914867401123
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.071 Vali Acc: 0.974 Test Loss: 0.071 Test Acc: 0.974
Validation loss decreased (-0.966802 --> -0.974078).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1226415
	speed: 0.1862s/iter; left time: 7442.4354s
	iters: 200, epoch: 4 | loss: 0.0018150
	speed: 0.0343s/iter; left time: 1367.3894s
	iters: 300, epoch: 4 | loss: 0.0004027
	speed: 0.0374s/iter; left time: 1488.3287s
	iters: 400, epoch: 4 | loss: 0.0094017
	speed: 0.0357s/iter; left time: 1417.0523s
Epoch: 4 cost time: 15.761153221130371
Epoch: 4, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0008171
	speed: 0.1882s/iter; left time: 7442.2715s
	iters: 200, epoch: 5 | loss: 0.0266509
	speed: 0.0322s/iter; left time: 1269.5029s
	iters: 300, epoch: 5 | loss: 0.0632931
	speed: 0.0294s/iter; left time: 1155.5598s
	iters: 400, epoch: 5 | loss: 0.0019737
	speed: 0.0357s/iter; left time: 1401.4224s
Epoch: 5 cost time: 13.921175956726074
Epoch: 5, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1290140
	speed: 0.1843s/iter; left time: 7211.0740s
	iters: 200, epoch: 6 | loss: 0.1325307
	speed: 0.0319s/iter; left time: 1243.4388s
	iters: 300, epoch: 6 | loss: 0.0003048
	speed: 0.0336s/iter; left time: 1308.8487s
	iters: 400, epoch: 6 | loss: 0.1914259
	speed: 0.0340s/iter; left time: 1322.1040s
Epoch: 6 cost time: 13.948885440826416
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.974078 --> -0.978626).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0122468
	speed: 0.1750s/iter; left time: 6777.9351s
	iters: 200, epoch: 7 | loss: 0.0001630
	speed: 0.0318s/iter; left time: 1227.3687s
	iters: 300, epoch: 7 | loss: 0.0014223
	speed: 0.0340s/iter; left time: 1308.8244s
	iters: 400, epoch: 7 | loss: 0.0013215
	speed: 0.0314s/iter; left time: 1208.0024s
Epoch: 7 cost time: 14.523508071899414
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2767702
	speed: 0.1737s/iter; left time: 6654.1913s
	iters: 200, epoch: 8 | loss: 0.0060629
	speed: 0.0302s/iter; left time: 1152.1845s
	iters: 300, epoch: 8 | loss: 0.0020588
	speed: 0.0340s/iter; left time: 1294.0383s
	iters: 400, epoch: 8 | loss: 0.0257774
	speed: 0.0318s/iter; left time: 1208.5406s
Epoch: 8 cost time: 14.202530860900879
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.157 Vali Acc: 0.964 Test Loss: 0.157 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0001728
	speed: 0.1793s/iter; left time: 6794.4280s
	iters: 200, epoch: 9 | loss: 0.0004000
	speed: 0.0300s/iter; left time: 1132.1033s
	iters: 300, epoch: 9 | loss: 0.0005718
	speed: 0.0318s/iter; left time: 1199.4186s
	iters: 400, epoch: 9 | loss: 0.0266232
	speed: 0.0307s/iter; left time: 1155.3801s
Epoch: 9 cost time: 13.88820743560791
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0007029
	speed: 0.1738s/iter; left time: 6513.5021s
	iters: 200, epoch: 10 | loss: 0.0028814
	speed: 0.0325s/iter; left time: 1215.4084s
	iters: 300, epoch: 10 | loss: 0.0079001
	speed: 0.0341s/iter; left time: 1271.7259s
	iters: 400, epoch: 10 | loss: 0.0022625
	speed: 0.0346s/iter; left time: 1287.7975s
Epoch: 10 cost time: 14.97370958328247
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000617
	speed: 0.1755s/iter; left time: 6504.4198s
	iters: 200, epoch: 11 | loss: 0.0000056
	speed: 0.0358s/iter; left time: 1323.8158s
	iters: 300, epoch: 11 | loss: 0.0021666
	speed: 0.0340s/iter; left time: 1252.7539s
	iters: 400, epoch: 11 | loss: 0.0000168
	speed: 0.0344s/iter; left time: 1264.9762s
Epoch: 11 cost time: 15.159449815750122
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.239 Vali Acc: 0.961 Test Loss: 0.239 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0716133
	speed: 0.1656s/iter; left time: 6071.9403s
	iters: 200, epoch: 12 | loss: 0.0001510
	speed: 0.0317s/iter; left time: 1159.4335s
	iters: 300, epoch: 12 | loss: 0.0000079
	speed: 0.0279s/iter; left time: 1018.1859s
	iters: 400, epoch: 12 | loss: 0.0012581
	speed: 0.0292s/iter; left time: 1060.2854s
Epoch: 12 cost time: 13.565298557281494
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.203 Vali Acc: 0.966 Test Loss: 0.203 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000091
	speed: 0.1756s/iter; left time: 6364.3575s
	iters: 200, epoch: 13 | loss: 0.0000338
	speed: 0.0247s/iter; left time: 894.5031s
	iters: 300, epoch: 13 | loss: 0.4331509
	speed: 0.0247s/iter; left time: 891.6822s
	iters: 400, epoch: 13 | loss: 0.0043979
	speed: 0.0243s/iter; left time: 875.1683s
Epoch: 13 cost time: 12.056352853775024
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.188 Vali Acc: 0.969 Test Loss: 0.188 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0013022
	speed: 0.1535s/iter; left time: 5498.4234s
	iters: 200, epoch: 14 | loss: 0.0002760
	speed: 0.0255s/iter; left time: 912.1168s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0252s/iter; left time: 898.9633s
	iters: 400, epoch: 14 | loss: 0.0231181
	speed: 0.0283s/iter; left time: 1007.2258s
Epoch: 14 cost time: 11.938510179519653
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.181 Vali Acc: 0.974 Test Loss: 0.181 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000366
	speed: 0.1601s/iter; left time: 5669.6614s
	iters: 200, epoch: 15 | loss: 0.0000355
	speed: 0.0256s/iter; left time: 904.6193s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 989.6278s
	iters: 400, epoch: 15 | loss: 0.0001281
	speed: 0.0320s/iter; left time: 1125.3342s
Epoch: 15 cost time: 13.195539236068726
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.161 Vali Acc: 0.973 Test Loss: 0.161 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000262
	speed: 0.1370s/iter; left time: 4796.9011s
	iters: 200, epoch: 16 | loss: 0.0039807
	speed: 0.0249s/iter; left time: 869.6205s
	iters: 300, epoch: 16 | loss: 0.0001062
	speed: 0.0276s/iter; left time: 962.0496s
	iters: 400, epoch: 16 | loss: 0.0000120
	speed: 0.0327s/iter; left time: 1135.6496s
Epoch: 16 cost time: 12.008979797363281
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df64_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9786266484765803
model parameter : 40922
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8831707
	speed: 0.0674s/iter; left time: 2776.2478s
	iters: 200, epoch: 1 | loss: 0.2098551
	speed: 0.0363s/iter; left time: 1492.9584s
	iters: 300, epoch: 1 | loss: 0.0794288
	speed: 0.0331s/iter; left time: 1357.9926s
	iters: 400, epoch: 1 | loss: 0.0433129
	speed: 0.0315s/iter; left time: 1288.2729s
Epoch: 1 cost time: 17.316351890563965
Epoch: 1, Steps: 413 | Train Loss: 0.619 Vali Loss: 0.170 Vali Acc: 0.945 Test Loss: 0.170 Test Acc: 0.945
Validation loss decreased (inf --> -0.944973).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0343784
	speed: 0.1837s/iter; left time: 7491.5055s
	iters: 200, epoch: 2 | loss: 0.6367774
	speed: 0.0355s/iter; left time: 1445.4492s
	iters: 300, epoch: 2 | loss: 0.0060167
	speed: 0.0347s/iter; left time: 1408.1269s
	iters: 400, epoch: 2 | loss: 0.1207467
	speed: 0.0346s/iter; left time: 1398.9193s
Epoch: 2 cost time: 15.588094472885132
Epoch: 2, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.079 Vali Acc: 0.969 Test Loss: 0.079 Test Acc: 0.969
Validation loss decreased (-0.944973 --> -0.969076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0136576
	speed: 0.1830s/iter; left time: 7388.1610s
	iters: 200, epoch: 3 | loss: 0.0036681
	speed: 0.0377s/iter; left time: 1519.0627s
	iters: 300, epoch: 3 | loss: 0.3266194
	speed: 0.0348s/iter; left time: 1396.2713s
	iters: 400, epoch: 3 | loss: 0.0114087
	speed: 0.0367s/iter; left time: 1469.4065s
Epoch: 3 cost time: 15.607598066329956
Epoch: 3, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.075 Vali Acc: 0.972 Test Loss: 0.075 Test Acc: 0.972
Validation loss decreased (-0.969076 --> -0.972259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0155252
	speed: 0.1809s/iter; left time: 7230.6450s
	iters: 200, epoch: 4 | loss: 0.0114033
	speed: 0.0376s/iter; left time: 1499.6006s
	iters: 300, epoch: 4 | loss: 0.0007034
	speed: 0.0375s/iter; left time: 1490.4306s
	iters: 400, epoch: 4 | loss: 0.0255401
	speed: 0.0336s/iter; left time: 1333.4782s
Epoch: 4 cost time: 15.248567581176758
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0015079
	speed: 0.1746s/iter; left time: 6905.6875s
	iters: 200, epoch: 5 | loss: 0.1064541
	speed: 0.0351s/iter; left time: 1384.6402s
	iters: 300, epoch: 5 | loss: 0.0010083
	speed: 0.0330s/iter; left time: 1299.0110s
	iters: 400, epoch: 5 | loss: 0.0005730
	speed: 0.0399s/iter; left time: 1566.0012s
Epoch: 5 cost time: 15.522870779037476
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0043580
	speed: 0.1849s/iter; left time: 7236.3378s
	iters: 200, epoch: 6 | loss: 0.0003696
	speed: 0.0389s/iter; left time: 1518.1469s
	iters: 300, epoch: 6 | loss: 0.2683807
	speed: 0.0361s/iter; left time: 1404.7555s
	iters: 400, epoch: 6 | loss: 0.0030623
	speed: 0.0338s/iter; left time: 1313.3792s
Epoch: 6 cost time: 15.829240798950195
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.079 Vali Acc: 0.974 Test Loss: 0.079 Test Acc: 0.974
Validation loss decreased (-0.972259 --> -0.974078).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2534429
	speed: 0.1923s/iter; left time: 7446.1823s
	iters: 200, epoch: 7 | loss: 0.0734019
	speed: 0.0348s/iter; left time: 1343.2831s
	iters: 300, epoch: 7 | loss: 0.0046090
	speed: 0.0359s/iter; left time: 1381.7747s
	iters: 400, epoch: 7 | loss: 0.1916856
	speed: 0.0356s/iter; left time: 1368.7276s
Epoch: 7 cost time: 15.494499206542969
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0002304
	speed: 0.1873s/iter; left time: 7176.8231s
	iters: 200, epoch: 8 | loss: 0.0581769
	speed: 0.0367s/iter; left time: 1401.4628s
	iters: 300, epoch: 8 | loss: 0.0032089
	speed: 0.0348s/iter; left time: 1326.7492s
	iters: 400, epoch: 8 | loss: 0.0002788
	speed: 0.0399s/iter; left time: 1518.4006s
Epoch: 8 cost time: 15.86984372138977
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0568656
	speed: 0.1814s/iter; left time: 6875.3701s
	iters: 200, epoch: 9 | loss: 0.0000216
	speed: 0.0346s/iter; left time: 1306.8864s
	iters: 300, epoch: 9 | loss: 0.0033312
	speed: 0.0371s/iter; left time: 1399.0652s
	iters: 400, epoch: 9 | loss: 0.0005015
	speed: 0.0383s/iter; left time: 1439.8411s
Epoch: 9 cost time: 15.80728554725647
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000153
	speed: 0.1874s/iter; left time: 7024.5030s
	iters: 200, epoch: 10 | loss: 0.0001111
	speed: 0.0363s/iter; left time: 1355.3572s
	iters: 300, epoch: 10 | loss: 0.0008951
	speed: 0.0341s/iter; left time: 1273.2477s
	iters: 400, epoch: 10 | loss: 0.0003681
	speed: 0.0355s/iter; left time: 1318.2119s
Epoch: 10 cost time: 16.159287452697754
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000126
	speed: 0.1706s/iter; left time: 6324.1886s
	iters: 200, epoch: 11 | loss: 0.0000363
	speed: 0.0336s/iter; left time: 1242.9267s
	iters: 300, epoch: 11 | loss: 0.0001244
	speed: 0.0345s/iter; left time: 1270.4350s
	iters: 400, epoch: 11 | loss: 0.0001682
	speed: 0.0327s/iter; left time: 1203.6025s
Epoch: 11 cost time: 14.449319839477539
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000296
	speed: 0.1750s/iter; left time: 6416.6479s
	iters: 200, epoch: 12 | loss: 0.0000008
	speed: 0.0353s/iter; left time: 1290.3798s
	iters: 300, epoch: 12 | loss: 0.0000042
	speed: 0.0376s/iter; left time: 1369.3958s
	iters: 400, epoch: 12 | loss: 0.0000467
	speed: 0.0356s/iter; left time: 1295.0183s
Epoch: 12 cost time: 16.26500940322876
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000106
	speed: 0.1679s/iter; left time: 6086.1447s
	iters: 200, epoch: 13 | loss: 0.0021888
	speed: 0.0376s/iter; left time: 1359.3757s
	iters: 300, epoch: 13 | loss: 0.0001016
	speed: 0.0371s/iter; left time: 1338.8344s
	iters: 400, epoch: 13 | loss: 0.0078161
	speed: 0.0312s/iter; left time: 1121.2803s
Epoch: 13 cost time: 15.017451763153076
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.974078 --> -0.975897).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0002460
	speed: 0.1792s/iter; left time: 6422.0210s
	iters: 200, epoch: 14 | loss: 0.0000695
	speed: 0.0365s/iter; left time: 1303.3007s
	iters: 300, epoch: 14 | loss: 0.0000020
	speed: 0.0326s/iter; left time: 1160.1294s
	iters: 400, epoch: 14 | loss: 0.0063033
	speed: 0.0312s/iter; left time: 1108.0188s
Epoch: 14 cost time: 14.886281728744507
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.978171).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000098
	speed: 0.1670s/iter; left time: 5914.4900s
	iters: 200, epoch: 15 | loss: 0.0000690
	speed: 0.0312s/iter; left time: 1103.2277s
	iters: 300, epoch: 15 | loss: 0.0000015
	speed: 0.0344s/iter; left time: 1211.1616s
	iters: 400, epoch: 15 | loss: 0.0000003
	speed: 0.0305s/iter; left time: 1072.3395s
Epoch: 15 cost time: 13.683948755264282
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000015
	speed: 0.1618s/iter; left time: 5663.0483s
	iters: 200, epoch: 16 | loss: 0.0000198
	speed: 0.0335s/iter; left time: 1169.0931s
	iters: 300, epoch: 16 | loss: 0.0596231
	speed: 0.0345s/iter; left time: 1199.8419s
	iters: 400, epoch: 16 | loss: 0.0000062
	speed: 0.0364s/iter; left time: 1261.8494s
Epoch: 16 cost time: 14.864809036254883
Epoch: 16, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.145 Vali Acc: 0.972 Test Loss: 0.145 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000839
	speed: 0.1623s/iter; left time: 5614.5322s
	iters: 200, epoch: 17 | loss: 0.0000027
	speed: 0.0335s/iter; left time: 1157.1802s
	iters: 300, epoch: 17 | loss: 0.0001317
	speed: 0.0403s/iter; left time: 1385.0817s
	iters: 400, epoch: 17 | loss: 0.0060570
	speed: 0.0334s/iter; left time: 1144.5637s
Epoch: 17 cost time: 15.299880981445312
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000012
	speed: 0.1722s/iter; left time: 5885.1156s
	iters: 200, epoch: 18 | loss: 0.0004287
	speed: 0.0348s/iter; left time: 1185.7866s
	iters: 300, epoch: 18 | loss: 0.0000041
	speed: 0.0340s/iter; left time: 1155.3409s
	iters: 400, epoch: 18 | loss: 0.0000003
	speed: 0.0339s/iter; left time: 1148.4286s
Epoch: 18 cost time: 15.05005407333374
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.978171 --> -0.979535).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000272
	speed: 0.1793s/iter; left time: 6055.9176s
	iters: 200, epoch: 19 | loss: 0.0011979
	speed: 0.0345s/iter; left time: 1163.1313s
	iters: 300, epoch: 19 | loss: 0.0000003
	speed: 0.0349s/iter; left time: 1169.8316s
	iters: 400, epoch: 19 | loss: 0.0000398
	speed: 0.0338s/iter; left time: 1131.0165s
Epoch: 19 cost time: 15.212616205215454
Epoch: 19, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000048
	speed: 0.1698s/iter; left time: 5663.6603s
	iters: 200, epoch: 20 | loss: 0.0000183
	speed: 0.0306s/iter; left time: 1018.0686s
	iters: 300, epoch: 20 | loss: 0.0001544
	speed: 0.0360s/iter; left time: 1193.4070s
	iters: 400, epoch: 20 | loss: 0.0016970
	speed: 0.0315s/iter; left time: 1042.3520s
Epoch: 20 cost time: 14.43260645866394
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.980899).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000003
	speed: 0.1672s/iter; left time: 5506.2518s
	iters: 200, epoch: 21 | loss: 0.0000649
	speed: 0.0354s/iter; left time: 1164.1880s
	iters: 300, epoch: 21 | loss: 0.0000042
	speed: 0.0293s/iter; left time: 960.8510s
	iters: 400, epoch: 21 | loss: 0.0001013
	speed: 0.0347s/iter; left time: 1131.8486s
Epoch: 21 cost time: 14.588664293289185
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000017
	speed: 0.1717s/iter; left time: 5584.0363s
	iters: 200, epoch: 22 | loss: 0.0000026
	speed: 0.0377s/iter; left time: 1221.5222s
	iters: 300, epoch: 22 | loss: 0.0000036
	speed: 0.0371s/iter; left time: 1198.7141s
	iters: 400, epoch: 22 | loss: 0.0035645
	speed: 0.0353s/iter; left time: 1137.6062s
Epoch: 22 cost time: 16.07773780822754
Epoch: 22, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.976 Test Loss: 0.157 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.3172188
	speed: 0.1765s/iter; left time: 5667.4089s
	iters: 200, epoch: 23 | loss: 0.0007262
	speed: 0.0327s/iter; left time: 1048.1690s
	iters: 300, epoch: 23 | loss: 0.0000045
	speed: 0.0355s/iter; left time: 1132.3458s
	iters: 400, epoch: 23 | loss: 0.1885970
	speed: 0.0316s/iter; left time: 1005.9823s
Epoch: 23 cost time: 14.841683149337769
Epoch: 23, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.971 Test Loss: 0.195 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.3780387
	speed: 0.1775s/iter; left time: 5627.4280s
	iters: 200, epoch: 24 | loss: 0.0000002
	speed: 0.0381s/iter; left time: 1205.5669s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0337s/iter; left time: 1062.8249s
	iters: 400, epoch: 24 | loss: 0.0000003
	speed: 0.0361s/iter; left time: 1134.5663s
Epoch: 24 cost time: 15.5131516456604
Epoch: 24, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0015786
	speed: 0.1791s/iter; left time: 5602.6487s
	iters: 200, epoch: 25 | loss: 0.0078958
	speed: 0.0332s/iter; left time: 1034.0689s
	iters: 300, epoch: 25 | loss: 0.0000268
	speed: 0.0362s/iter; left time: 1124.3904s
	iters: 400, epoch: 25 | loss: 0.0000160
	speed: 0.0339s/iter; left time: 1050.3885s
Epoch: 25 cost time: 14.646465539932251
Epoch: 25, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0161016
	speed: 0.1803s/iter; left time: 5567.6725s
	iters: 200, epoch: 26 | loss: 0.0000001
	speed: 0.0338s/iter; left time: 1039.7239s
	iters: 300, epoch: 26 | loss: 0.0000560
	speed: 0.0327s/iter; left time: 1001.9523s
	iters: 400, epoch: 26 | loss: 0.0000002
	speed: 0.0317s/iter; left time: 969.4418s
Epoch: 26 cost time: 14.870304584503174
Epoch: 26, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.138 Vali Acc: 0.978 Test Loss: 0.138 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000589
	speed: 0.1774s/iter; left time: 5403.0885s
	iters: 200, epoch: 27 | loss: 0.0001156
	speed: 0.0363s/iter; left time: 1101.4161s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 1228.2335s
	iters: 400, epoch: 27 | loss: 0.0000020
	speed: 0.0390s/iter; left time: 1174.9781s
Epoch: 27 cost time: 16.17094922065735
Epoch: 27, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.169 Vali Acc: 0.977 Test Loss: 0.169 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000006
	speed: 0.1866s/iter; left time: 5608.4524s
	iters: 200, epoch: 28 | loss: 0.0004305
	speed: 0.0347s/iter; left time: 1038.1142s
	iters: 300, epoch: 28 | loss: 0.0044283
	speed: 0.0387s/iter; left time: 1156.3867s
	iters: 400, epoch: 28 | loss: 0.1114110
	speed: 0.0375s/iter; left time: 1115.0552s
Epoch: 28 cost time: 16.415161609649658
Epoch: 28, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.121 Vali Acc: 0.982 Test Loss: 0.121 Test Acc: 0.982
Validation loss decreased (-0.980899 --> -0.981809).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000023
	speed: 0.1878s/iter; left time: 5565.3126s
	iters: 200, epoch: 29 | loss: 0.0000001
	speed: 0.0326s/iter; left time: 963.9472s
	iters: 300, epoch: 29 | loss: 0.0000013
	speed: 0.0378s/iter; left time: 1111.5851s
	iters: 400, epoch: 29 | loss: 0.0000001
	speed: 0.0404s/iter; left time: 1185.2822s
Epoch: 29 cost time: 16.062445163726807
Epoch: 29, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.179 Vali Acc: 0.977 Test Loss: 0.179 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0000795
	speed: 0.1904s/iter; left time: 5564.6239s
	iters: 200, epoch: 30 | loss: 0.0000003
	speed: 0.0344s/iter; left time: 1002.4511s
	iters: 300, epoch: 30 | loss: 0.0782043
	speed: 0.0372s/iter; left time: 1079.9658s
	iters: 400, epoch: 30 | loss: 0.0000001
	speed: 0.0349s/iter; left time: 1008.9584s
Epoch: 30 cost time: 15.756958246231079
Epoch: 30, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.160 Vali Acc: 0.979 Test Loss: 0.160 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0000016
	speed: 0.1864s/iter; left time: 5369.1915s
	iters: 200, epoch: 31 | loss: 0.0562517
	speed: 0.0393s/iter; left time: 1127.0144s
	iters: 300, epoch: 31 | loss: 0.0000706
	speed: 0.0350s/iter; left time: 1002.3415s
	iters: 400, epoch: 31 | loss: 0.0000005
	speed: 0.0356s/iter; left time: 1015.2037s
Epoch: 31 cost time: 15.186785459518433
Epoch: 31, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0069258
	speed: 0.1833s/iter; left time: 5204.3472s
	iters: 200, epoch: 32 | loss: 0.0002711
	speed: 0.0315s/iter; left time: 890.6629s
	iters: 300, epoch: 32 | loss: 0.0000009
	speed: 0.0319s/iter; left time: 899.7519s
	iters: 400, epoch: 32 | loss: 0.0000002
	speed: 0.0363s/iter; left time: 1020.5431s
Epoch: 32 cost time: 14.955138206481934
Epoch: 32, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.981809 --> -0.982718).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0000071
	speed: 0.1742s/iter; left time: 4874.2584s
	iters: 200, epoch: 33 | loss: 0.0000001
	speed: 0.0418s/iter; left time: 1165.3107s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 981.6874s
	iters: 400, epoch: 33 | loss: 0.0000873
	speed: 0.0369s/iter; left time: 1020.6386s
Epoch: 33 cost time: 15.805939197540283
Epoch: 33, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.982 Test Loss: 0.116 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1783s/iter; left time: 4915.9044s
	iters: 200, epoch: 34 | loss: 0.0000236
	speed: 0.0298s/iter; left time: 818.3566s
	iters: 300, epoch: 34 | loss: 0.0000022
	speed: 0.0354s/iter; left time: 968.9689s
	iters: 400, epoch: 34 | loss: 0.0000006
	speed: 0.0309s/iter; left time: 841.8195s
Epoch: 34 cost time: 14.096340894699097
Epoch: 34, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.982 Test Loss: 0.130 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0920507
	speed: 0.1862s/iter; left time: 5058.3509s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0340s/iter; left time: 921.3493s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 852.8210s
	iters: 400, epoch: 35 | loss: 0.0000012
	speed: 0.0320s/iter; left time: 860.2349s
Epoch: 35 cost time: 14.340007066726685
Epoch: 35, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.146 Vali Acc: 0.981 Test Loss: 0.146 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.1803s/iter; left time: 4822.7784s
	iters: 200, epoch: 36 | loss: 0.0000005
	speed: 0.0319s/iter; left time: 848.8810s
	iters: 300, epoch: 36 | loss: 0.0000001
	speed: 0.0340s/iter; left time: 901.2648s
	iters: 400, epoch: 36 | loss: 0.0000038
	speed: 0.0380s/iter; left time: 1003.7835s
Epoch: 36 cost time: 15.2996244430542
Epoch: 36, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0000001
	speed: 0.1803s/iter; left time: 4747.6605s
	iters: 200, epoch: 37 | loss: 0.0004029
	speed: 0.0382s/iter; left time: 1001.6314s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 899.7385s
	iters: 400, epoch: 37 | loss: 0.0000001
	speed: 0.0288s/iter; left time: 748.8596s
Epoch: 37 cost time: 15.030098676681519
Epoch: 37, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.189 Vali Acc: 0.979 Test Loss: 0.189 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0000007
	speed: 0.1712s/iter; left time: 4436.3686s
	iters: 200, epoch: 38 | loss: 0.0000004
	speed: 0.0344s/iter; left time: 888.0899s
	iters: 300, epoch: 38 | loss: 0.0000002
	speed: 0.0290s/iter; left time: 745.4108s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 843.3744s
Epoch: 38 cost time: 14.283322095870972
Epoch: 38, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.169 Vali Acc: 0.976 Test Loss: 0.169 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0000026
	speed: 0.1788s/iter; left time: 4559.4296s
	iters: 200, epoch: 39 | loss: 0.0000020
	speed: 0.0370s/iter; left time: 940.8689s
	iters: 300, epoch: 39 | loss: 0.0000156
	speed: 0.0357s/iter; left time: 902.3334s
	iters: 400, epoch: 39 | loss: 0.0000003
	speed: 0.0321s/iter; left time: 808.7547s
Epoch: 39 cost time: 15.552947759628296
Epoch: 39, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.977 Test Loss: 0.168 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0000009
	speed: 0.1723s/iter; left time: 4324.4377s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 874.6104s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 866.2151s
	iters: 400, epoch: 40 | loss: 0.2642419
	speed: 0.0347s/iter; left time: 860.1156s
Epoch: 40 cost time: 15.10240912437439
Epoch: 40, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.978 Test Loss: 0.182 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0003956
	speed: 0.1680s/iter; left time: 4147.1744s
	iters: 200, epoch: 41 | loss: 0.0000003
	speed: 0.0357s/iter; left time: 878.7106s
	iters: 300, epoch: 41 | loss: 0.0033930
	speed: 0.0354s/iter; left time: 865.7019s
	iters: 400, epoch: 41 | loss: 0.0000001
	speed: 0.0350s/iter; left time: 854.2988s
Epoch: 41 cost time: 15.482470273971558
Epoch: 41, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0000578
	speed: 0.1771s/iter; left time: 4297.4697s
	iters: 200, epoch: 42 | loss: 0.0000002
	speed: 0.0346s/iter; left time: 836.5353s
	iters: 300, epoch: 42 | loss: 0.0000023
	speed: 0.0318s/iter; left time: 764.2824s
	iters: 400, epoch: 42 | loss: 0.0000033
	speed: 0.0328s/iter; left time: 786.8077s
Epoch: 42 cost time: 14.369481086730957
Epoch: 42, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.972 Test Loss: 0.222 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 30586
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df64_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9579396
	speed: 0.0584s/iter; left time: 2404.4689s
	iters: 200, epoch: 1 | loss: 0.3857138
	speed: 0.0357s/iter; left time: 1467.0992s
	iters: 300, epoch: 1 | loss: 0.4603929
	speed: 0.0374s/iter; left time: 1534.1561s
	iters: 400, epoch: 1 | loss: 0.0765566
	speed: 0.0386s/iter; left time: 1580.6185s
Epoch: 1 cost time: 17.50951910018921
Epoch: 1, Steps: 413 | Train Loss: 0.670 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (inf --> -0.956797).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2468832
	speed: 0.1515s/iter; left time: 6180.3206s
	iters: 200, epoch: 2 | loss: 0.0267692
	speed: 0.0322s/iter; left time: 1312.0076s
	iters: 300, epoch: 2 | loss: 0.1028726
	speed: 0.0306s/iter; left time: 1242.0519s
	iters: 400, epoch: 2 | loss: 0.0401561
	speed: 0.0304s/iter; left time: 1231.3025s
Epoch: 2 cost time: 13.300239562988281
Epoch: 2, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.105 Vali Acc: 0.966 Test Loss: 0.105 Test Acc: 0.966
Validation loss decreased (-0.956797 --> -0.965893).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0228500
	speed: 0.1499s/iter; left time: 6053.7284s
	iters: 200, epoch: 3 | loss: 0.0085458
	speed: 0.0276s/iter; left time: 1111.9681s
	iters: 300, epoch: 3 | loss: 0.0263297
	speed: 0.0305s/iter; left time: 1223.6212s
	iters: 400, epoch: 3 | loss: 0.0111790
	speed: 0.0331s/iter; left time: 1327.9730s
Epoch: 3 cost time: 13.405631303787231
Epoch: 3, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
Validation loss decreased (-0.965893 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1125654
	speed: 0.1493s/iter; left time: 5965.5428s
	iters: 200, epoch: 4 | loss: 0.0309390
	speed: 0.0294s/iter; left time: 1172.6603s
	iters: 300, epoch: 4 | loss: 0.0034128
	speed: 0.0318s/iter; left time: 1264.5424s
	iters: 400, epoch: 4 | loss: 0.0120882
	speed: 0.0308s/iter; left time: 1220.6972s
Epoch: 4 cost time: 13.100298166275024
Epoch: 4, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.973169 --> -0.977262).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0093998
	speed: 0.1299s/iter; left time: 5138.6463s
	iters: 200, epoch: 5 | loss: 0.0089018
	speed: 0.0258s/iter; left time: 1016.7891s
	iters: 300, epoch: 5 | loss: 0.0858247
	speed: 0.0282s/iter; left time: 1110.5280s
	iters: 400, epoch: 5 | loss: 0.0018855
	speed: 0.0291s/iter; left time: 1140.7786s
Epoch: 5 cost time: 11.751272439956665
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0003407
	speed: 0.1292s/iter; left time: 5055.2072s
	iters: 200, epoch: 6 | loss: 0.0015602
	speed: 0.0293s/iter; left time: 1144.8062s
	iters: 300, epoch: 6 | loss: 0.0072380
	speed: 0.0290s/iter; left time: 1130.5546s
	iters: 400, epoch: 6 | loss: 0.0022745
	speed: 0.0285s/iter; left time: 1105.7461s
Epoch: 6 cost time: 12.337042570114136
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.085 Vali Acc: 0.971 Test Loss: 0.085 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0038636
	speed: 0.1395s/iter; left time: 5401.3200s
	iters: 200, epoch: 7 | loss: 0.0019635
	speed: 0.0264s/iter; left time: 1019.8711s
	iters: 300, epoch: 7 | loss: 0.0005391
	speed: 0.0256s/iter; left time: 987.6806s
	iters: 400, epoch: 7 | loss: 0.0118584
	speed: 0.0314s/iter; left time: 1207.2478s
Epoch: 7 cost time: 12.069217681884766
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0031305
	speed: 0.1492s/iter; left time: 5714.5904s
	iters: 200, epoch: 8 | loss: 0.6479285
	speed: 0.0297s/iter; left time: 1135.1247s
	iters: 300, epoch: 8 | loss: 0.0035979
	speed: 0.0280s/iter; left time: 1068.6617s
	iters: 400, epoch: 8 | loss: 0.0011493
	speed: 0.0324s/iter; left time: 1233.0712s
Epoch: 8 cost time: 13.287943601608276
Epoch: 8, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.2272349
	speed: 0.1582s/iter; left time: 5993.8736s
	iters: 200, epoch: 9 | loss: 0.0000869
	speed: 0.0308s/iter; left time: 1163.2356s
	iters: 300, epoch: 9 | loss: 0.0071353
	speed: 0.0327s/iter; left time: 1232.3123s
	iters: 400, epoch: 9 | loss: 0.0007711
	speed: 0.0338s/iter; left time: 1270.0716s
Epoch: 9 cost time: 14.147887706756592
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0071078
	speed: 0.1469s/iter; left time: 5505.1048s
	iters: 200, epoch: 10 | loss: 0.0021702
	speed: 0.0281s/iter; left time: 1049.9773s
	iters: 300, epoch: 10 | loss: 0.0014467
	speed: 0.0289s/iter; left time: 1078.4191s
	iters: 400, epoch: 10 | loss: 0.0005236
	speed: 0.0289s/iter; left time: 1075.1916s
Epoch: 10 cost time: 12.325522184371948
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
Validation loss decreased (-0.977262 --> -0.979080).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0002814
	speed: 0.1565s/iter; left time: 5800.3998s
	iters: 200, epoch: 11 | loss: 0.0013564
	speed: 0.0261s/iter; left time: 965.9634s
	iters: 300, epoch: 11 | loss: 0.0004593
	speed: 0.0275s/iter; left time: 1013.6943s
	iters: 400, epoch: 11 | loss: 0.0004995
	speed: 0.0289s/iter; left time: 1062.0031s
Epoch: 11 cost time: 13.028337717056274
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1863003
	speed: 0.1537s/iter; left time: 5635.3066s
	iters: 200, epoch: 12 | loss: 0.0034972
	speed: 0.0297s/iter; left time: 1085.5979s
	iters: 300, epoch: 12 | loss: 0.0002743
	speed: 0.0302s/iter; left time: 1102.5535s
	iters: 400, epoch: 12 | loss: 0.0003901
	speed: 0.0262s/iter; left time: 954.2402s
Epoch: 12 cost time: 12.72500467300415
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0001535
	speed: 0.1632s/iter; left time: 5913.7330s
	iters: 200, epoch: 13 | loss: 0.0781369
	speed: 0.0278s/iter; left time: 1003.2372s
	iters: 300, epoch: 13 | loss: 0.0144701
	speed: 0.0261s/iter; left time: 939.3324s
	iters: 400, epoch: 13 | loss: 0.0000881
	speed: 0.0266s/iter; left time: 957.0341s
Epoch: 13 cost time: 12.305286884307861
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000029
	speed: 0.1557s/iter; left time: 5577.7269s
	iters: 200, epoch: 14 | loss: 0.0093506
	speed: 0.0259s/iter; left time: 923.7216s
	iters: 300, epoch: 14 | loss: 0.0047436
	speed: 0.0250s/iter; left time: 889.6009s
	iters: 400, epoch: 14 | loss: 0.0000819
	speed: 0.0272s/iter; left time: 967.8476s
Epoch: 14 cost time: 11.806148052215576
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0060101
	speed: 0.1541s/iter; left time: 5456.7760s
	iters: 200, epoch: 15 | loss: 0.4662839
	speed: 0.0312s/iter; left time: 1103.2437s
	iters: 300, epoch: 15 | loss: 0.0000160
	speed: 0.0349s/iter; left time: 1228.8070s
	iters: 400, epoch: 15 | loss: 0.0000415
	speed: 0.0337s/iter; left time: 1185.0012s
Epoch: 15 cost time: 14.04043459892273
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0059264
	speed: 0.1512s/iter; left time: 5292.9915s
	iters: 200, epoch: 16 | loss: 0.0000280
	speed: 0.0331s/iter; left time: 1156.1706s
	iters: 300, epoch: 16 | loss: 0.0000017
	speed: 0.0295s/iter; left time: 1027.6920s
	iters: 400, epoch: 16 | loss: 0.0026516
	speed: 0.0278s/iter; left time: 963.7729s
Epoch: 16 cost time: 13.37889552116394
Epoch: 16, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000049
	speed: 0.1586s/iter; left time: 5485.6059s
	iters: 200, epoch: 17 | loss: 0.0000833
	speed: 0.0347s/iter; left time: 1197.9808s
	iters: 300, epoch: 17 | loss: 0.0000064
	speed: 0.0330s/iter; left time: 1133.2524s
	iters: 400, epoch: 17 | loss: 0.0000058
	speed: 0.0347s/iter; left time: 1188.7414s
Epoch: 17 cost time: 14.52049732208252
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000105
	speed: 0.1385s/iter; left time: 4732.5330s
	iters: 200, epoch: 18 | loss: 0.0003223
	speed: 0.0312s/iter; left time: 1064.7526s
	iters: 300, epoch: 18 | loss: 0.1891457
	speed: 0.0294s/iter; left time: 999.6242s
	iters: 400, epoch: 18 | loss: 0.0001327
	speed: 0.0303s/iter; left time: 1027.9399s
Epoch: 18 cost time: 12.417780637741089
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0138255
	speed: 0.1385s/iter; left time: 4678.3707s
	iters: 200, epoch: 19 | loss: 0.0000109
	speed: 0.0288s/iter; left time: 969.0798s
	iters: 300, epoch: 19 | loss: 0.0000002
	speed: 0.0287s/iter; left time: 962.0407s
	iters: 400, epoch: 19 | loss: 0.0000015
	speed: 0.0275s/iter; left time: 920.0032s
Epoch: 19 cost time: 12.271125793457031
Epoch: 19, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000037
	speed: 0.1422s/iter; left time: 4743.7759s
	iters: 200, epoch: 20 | loss: 0.0005202
	speed: 0.0248s/iter; left time: 825.6981s
	iters: 300, epoch: 20 | loss: 0.0005339
	speed: 0.0271s/iter; left time: 899.3560s
	iters: 400, epoch: 20 | loss: 0.0003329
	speed: 0.0261s/iter; left time: 861.5184s
Epoch: 20 cost time: 11.712637662887573
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df64_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
model parameter : 22346
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df64_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1965998
	speed: 0.0568s/iter; left time: 2340.5070s
	iters: 200, epoch: 1 | loss: 0.4494985
	speed: 0.0294s/iter; left time: 1209.4339s
	iters: 300, epoch: 1 | loss: 0.3267506
	speed: 0.0307s/iter; left time: 1258.4307s
	iters: 400, epoch: 1 | loss: 0.1816570
	speed: 0.0326s/iter; left time: 1331.6532s
Epoch: 1 cost time: 15.425128698348999
Epoch: 1, Steps: 413 | Train Loss: 0.756 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
Validation loss decreased (inf --> -0.953159).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0495224
	speed: 0.1560s/iter; left time: 6362.1865s
	iters: 200, epoch: 2 | loss: 0.1192165
	speed: 0.0254s/iter; left time: 1035.1507s
	iters: 300, epoch: 2 | loss: 0.0232958
	speed: 0.0261s/iter; left time: 1058.8440s
	iters: 400, epoch: 2 | loss: 0.2375212
	speed: 0.0300s/iter; left time: 1213.2298s
Epoch: 2 cost time: 11.929044246673584
Epoch: 2, Steps: 413 | Train Loss: 0.134 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.953159 --> -0.962254).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0967004
	speed: 0.1666s/iter; left time: 6725.4425s
	iters: 200, epoch: 3 | loss: 0.1637654
	speed: 0.0328s/iter; left time: 1321.0242s
	iters: 300, epoch: 3 | loss: 0.0658566
	speed: 0.0295s/iter; left time: 1185.4644s
	iters: 400, epoch: 3 | loss: 0.0353976
	speed: 0.0287s/iter; left time: 1149.8353s
Epoch: 3 cost time: 13.42522644996643
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.086 Vali Acc: 0.972 Test Loss: 0.086 Test Acc: 0.972
Validation loss decreased (-0.962254 --> -0.972259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0573667
	speed: 0.1538s/iter; left time: 6145.8885s
	iters: 200, epoch: 4 | loss: 0.0257738
	speed: 0.0310s/iter; left time: 1234.9065s
	iters: 300, epoch: 4 | loss: 0.0108007
	speed: 0.0303s/iter; left time: 1205.7752s
	iters: 400, epoch: 4 | loss: 0.0291246
	speed: 0.0343s/iter; left time: 1358.6902s
Epoch: 4 cost time: 13.403098821640015
Epoch: 4, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.082 Vali Acc: 0.967 Test Loss: 0.082 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0086941
	speed: 0.1550s/iter; left time: 6131.2298s
	iters: 200, epoch: 5 | loss: 0.0078673
	speed: 0.0266s/iter; left time: 1048.7575s
	iters: 300, epoch: 5 | loss: 0.0136347
	speed: 0.0265s/iter; left time: 1044.6885s
	iters: 400, epoch: 5 | loss: 0.0058285
	speed: 0.0262s/iter; left time: 1026.5064s
Epoch: 5 cost time: 11.995465278625488
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.080 Vali Acc: 0.971 Test Loss: 0.080 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0451175
	speed: 0.1548s/iter; left time: 6057.6878s
	iters: 200, epoch: 6 | loss: 0.2392999
	speed: 0.0303s/iter; left time: 1181.3891s
	iters: 300, epoch: 6 | loss: 0.0026927
	speed: 0.0231s/iter; left time: 898.5999s
	iters: 400, epoch: 6 | loss: 0.0370139
	speed: 0.0261s/iter; left time: 1014.4363s
Epoch: 6 cost time: 11.985161304473877
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.084 Vali Acc: 0.971 Test Loss: 0.084 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1477578
	speed: 0.1581s/iter; left time: 6123.6076s
	iters: 200, epoch: 7 | loss: 0.0192763
	speed: 0.0289s/iter; left time: 1115.6575s
	iters: 300, epoch: 7 | loss: 0.0093895
	speed: 0.0247s/iter; left time: 952.1513s
	iters: 400, epoch: 7 | loss: 0.0529528
	speed: 0.0264s/iter; left time: 1016.1380s
Epoch: 7 cost time: 12.12824273109436
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.088 Vali Acc: 0.969 Test Loss: 0.088 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0004027
	speed: 0.1547s/iter; left time: 5927.7420s
	iters: 200, epoch: 8 | loss: 0.0005331
	speed: 0.0307s/iter; left time: 1174.7506s
	iters: 300, epoch: 8 | loss: 0.3367288
	speed: 0.0269s/iter; left time: 1026.0367s
	iters: 400, epoch: 8 | loss: 0.0129338
	speed: 0.0267s/iter; left time: 1013.3360s
Epoch: 8 cost time: 12.433914422988892
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.972259 --> -0.975897).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0286533
	speed: 0.1672s/iter; left time: 6337.7051s
	iters: 200, epoch: 9 | loss: 0.0019497
	speed: 0.0321s/iter; left time: 1215.1147s
	iters: 300, epoch: 9 | loss: 0.1510424
	speed: 0.0266s/iter; left time: 1001.9678s
	iters: 400, epoch: 9 | loss: 0.1136215
	speed: 0.0278s/iter; left time: 1044.8503s
Epoch: 9 cost time: 12.79993987083435
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000140
	speed: 0.1477s/iter; left time: 5537.4879s
	iters: 200, epoch: 10 | loss: 0.0001289
	speed: 0.0334s/iter; left time: 1246.9309s
	iters: 300, epoch: 10 | loss: 0.3135385
	speed: 0.0308s/iter; left time: 1148.5294s
	iters: 400, epoch: 10 | loss: 0.0029643
	speed: 0.0319s/iter; left time: 1187.8891s
Epoch: 10 cost time: 13.886626720428467
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.978171).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0026439
	speed: 0.1571s/iter; left time: 5824.6709s
	iters: 200, epoch: 11 | loss: 0.0114689
	speed: 0.0294s/iter; left time: 1086.4367s
	iters: 300, epoch: 11 | loss: 0.0035068
	speed: 0.0301s/iter; left time: 1111.1681s
	iters: 400, epoch: 11 | loss: 0.0005816
	speed: 0.0288s/iter; left time: 1057.9688s
Epoch: 11 cost time: 13.350508451461792
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
Validation loss decreased (-0.978171 --> -0.983628).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0027363
	speed: 0.1608s/iter; left time: 5893.4228s
	iters: 200, epoch: 12 | loss: 0.0000020
	speed: 0.0330s/iter; left time: 1205.5238s
	iters: 300, epoch: 12 | loss: 0.0002087
	speed: 0.0330s/iter; left time: 1204.9181s
	iters: 400, epoch: 12 | loss: 0.1945080
	speed: 0.0338s/iter; left time: 1227.3223s
Epoch: 12 cost time: 14.640951156616211
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000984
	speed: 0.1476s/iter; left time: 5348.3717s
	iters: 200, epoch: 13 | loss: 0.0024019
	speed: 0.0333s/iter; left time: 1203.6717s
	iters: 300, epoch: 13 | loss: 0.0043462
	speed: 0.0327s/iter; left time: 1178.3939s
	iters: 400, epoch: 13 | loss: 0.0009471
	speed: 0.0268s/iter; left time: 964.9469s
Epoch: 13 cost time: 13.190352439880371
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0006098
	speed: 0.1494s/iter; left time: 5354.2691s
	iters: 200, epoch: 14 | loss: 0.0026322
	speed: 0.0286s/iter; left time: 1022.3523s
	iters: 300, epoch: 14 | loss: 0.1697636
	speed: 0.0272s/iter; left time: 969.0969s
	iters: 400, epoch: 14 | loss: 0.0000081
	speed: 0.0281s/iter; left time: 996.9684s
Epoch: 14 cost time: 12.333999872207642
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0001034
	speed: 0.1575s/iter; left time: 5577.3228s
	iters: 200, epoch: 15 | loss: 0.0273497
	speed: 0.0282s/iter; left time: 996.9379s
	iters: 300, epoch: 15 | loss: 0.1394440
	speed: 0.0296s/iter; left time: 1043.7304s
	iters: 400, epoch: 15 | loss: 0.0000094
	speed: 0.0281s/iter; left time: 987.1742s
Epoch: 15 cost time: 12.935192823410034
Epoch: 15, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000215
	speed: 0.1434s/iter; left time: 5018.7685s
	iters: 200, epoch: 16 | loss: 0.0024963
	speed: 0.0314s/iter; left time: 1097.2720s
	iters: 300, epoch: 16 | loss: 0.0010223
	speed: 0.0274s/iter; left time: 953.9805s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0279s/iter; left time: 969.3408s
Epoch: 16 cost time: 12.538988828659058
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0336223
	speed: 0.1516s/iter; left time: 5242.6325s
	iters: 200, epoch: 17 | loss: 0.0000740
	speed: 0.0306s/iter; left time: 1056.4403s
	iters: 300, epoch: 17 | loss: 0.0000282
	speed: 0.0273s/iter; left time: 939.4026s
	iters: 400, epoch: 17 | loss: 0.0000094
	speed: 0.0275s/iter; left time: 942.3885s
Epoch: 17 cost time: 12.864706993103027
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0015302
	speed: 0.1533s/iter; left time: 5240.5741s
	iters: 200, epoch: 18 | loss: 0.0000128
	speed: 0.0272s/iter; left time: 928.0848s
	iters: 300, epoch: 18 | loss: 0.0005172
	speed: 0.0267s/iter; left time: 907.3959s
	iters: 400, epoch: 18 | loss: 0.0003331
	speed: 0.0279s/iter; left time: 944.1824s
Epoch: 18 cost time: 11.898109197616577
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.2347631
	speed: 0.1511s/iter; left time: 5101.8299s
	iters: 200, epoch: 19 | loss: 0.0003281
	speed: 0.0299s/iter; left time: 1006.3073s
	iters: 300, epoch: 19 | loss: 0.0032876
	speed: 0.0309s/iter; left time: 1036.3145s
	iters: 400, epoch: 19 | loss: 0.0212338
	speed: 0.0309s/iter; left time: 1035.7528s
Epoch: 19 cost time: 13.061503171920776
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0059293
	speed: 0.1555s/iter; left time: 5187.0882s
	iters: 200, epoch: 20 | loss: 0.0040376
	speed: 0.0290s/iter; left time: 965.6228s
	iters: 300, epoch: 20 | loss: 0.0000279
	speed: 0.0293s/iter; left time: 969.9150s
	iters: 400, epoch: 20 | loss: 0.0002861
	speed: 0.0288s/iter; left time: 951.8603s
Epoch: 20 cost time: 12.975482940673828
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000003
	speed: 0.1522s/iter; left time: 5013.0622s
	iters: 200, epoch: 21 | loss: 0.1346170
	speed: 0.0308s/iter; left time: 1012.1704s
	iters: 300, epoch: 21 | loss: 0.0000071
	speed: 0.0271s/iter; left time: 886.2471s
	iters: 400, epoch: 21 | loss: 0.0039029
	speed: 0.0290s/iter; left time: 946.0267s
Epoch: 21 cost time: 12.803832292556763
Epoch: 21, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_PatchTST_UEA_ftM_sl93_ll0_pl0_el1_dm16_nh4_df64_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 18266
model size : 0.38MB
