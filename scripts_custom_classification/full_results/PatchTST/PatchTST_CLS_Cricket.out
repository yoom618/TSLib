Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1643595695495605
Epoch: 1, Steps: 7 | Train Loss: 2.657 Vali Loss: 2.141 Vali Acc: 0.389 Test Loss: 2.141 Test Acc: 0.389
Validation loss decreased (inf --> -0.388867).  Saving model ...
Epoch: 2 cost time: 1.0048768520355225
Epoch: 2, Steps: 7 | Train Loss: 1.477 Vali Loss: 0.781 Vali Acc: 0.861 Test Loss: 0.781 Test Acc: 0.861
Validation loss decreased (-0.388867 --> -0.861103).  Saving model ...
Epoch: 3 cost time: 0.8582932949066162
Epoch: 3, Steps: 7 | Train Loss: 0.362 Vali Loss: 0.440 Vali Acc: 0.889 Test Loss: 0.440 Test Acc: 0.889
Validation loss decreased (-0.861103 --> -0.888884).  Saving model ...
Epoch: 4 cost time: 1.0244433879852295
Epoch: 4, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.888884 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 1.0256998538970947
Epoch: 5, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7859394550323486
Epoch: 6, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8364129066467285
Epoch: 7, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0294609069824219
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.449 Vali Acc: 0.889 Test Loss: 0.449 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0720043182373047
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0983870029449463
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8492574691772461
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2285115718841553
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.9867937564849854
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.9572844505310059
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.8756027221679688
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.119950771331787
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.2101058959960938
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.896996021270752
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.172842025756836
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.9849286079406738
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.026188611984253
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.975761890411377
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 1.0873684883117676
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.9996247291564941
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 1.1855816841125488
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 1.3661351203918457
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.8822669982910156
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 1.2829301357269287
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 1.1035406589508057
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 1.297851324081421
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 31 cost time: 1.1317009925842285
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 32 cost time: 1.1144018173217773
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 33 cost time: 1.3910882472991943
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 34 cost time: 1.1914293766021729
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 35 cost time: 1.1035163402557373
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 1.1136605739593506
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 0.8448741436004639
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 38 cost time: 1.0964765548706055
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 1.0051229000091553
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 1.130134105682373
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 1.153329849243164
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0797622203826904
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 1.1417040824890137
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0676069259643555
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 1.155688762664795
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 1.203125238418579
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.8822207450866699
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 1.1167266368865967
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.158390998840332
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 1.0215954780578613
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 51 cost time: 1.2185978889465332
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 52 cost time: 0.8363966941833496
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 1.1685512065887451
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 54 cost time: 1.1596496105194092
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.1940054893493652
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.9555680751800537
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 57 cost time: 0.992089033126831
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.205528736114502
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.8957490921020508
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 60 cost time: 0.9440951347351074
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8444011211395264
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 62 cost time: 1.1908555030822754
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.1308398246765137
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.8889689445495605
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.4080181121826172
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.9275691509246826
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 67 cost time: 1.2157747745513916
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 68 cost time: 1.2664942741394043
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.195246696472168
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.3604214191436768
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.3340263366699219
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.264087438583374
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.0652766227722168
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.4602153301239014
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.1155998706817627
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.2475814819335938
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 77 cost time: 1.2219936847686768
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 78 cost time: 1.4231042861938477
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 79 cost time: 1.109299659729004
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 80 cost time: 1.1357026100158691
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 81 cost time: 0.9732227325439453
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.1283681392669678
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 83 cost time: 0.8821003437042236
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 84 cost time: 1.1582567691802979
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.8349266052246094
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.165041208267212
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.8751769065856934
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.8107647895812988
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 0.8729004859924316
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 0.8310451507568359
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 0.9105627536773682
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 0.9543371200561523
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 0.9325864315032959
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1129612
model size : 6.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3695976734161377
Epoch: 1, Steps: 7 | Train Loss: 2.684 Vali Loss: 2.290 Vali Acc: 0.208 Test Loss: 2.290 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 0.939100980758667
Epoch: 2, Steps: 7 | Train Loss: 1.860 Vali Loss: 1.320 Vali Acc: 0.750 Test Loss: 1.320 Test Acc: 0.750
Validation loss decreased (-0.208310 --> -0.749987).  Saving model ...
Epoch: 3 cost time: 1.1178231239318848
Epoch: 3, Steps: 7 | Train Loss: 0.700 Vali Loss: 0.531 Vali Acc: 0.931 Test Loss: 0.531 Test Acc: 0.931
Validation loss decreased (-0.749987 --> -0.930550).  Saving model ...
Epoch: 4 cost time: 0.8883163928985596
Epoch: 4, Steps: 7 | Train Loss: 0.235 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.018369197845459
Epoch: 5, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7276885509490967
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0347402095794678
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7649259567260742
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.8068499565124512
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.9203741550445557
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.7289552688598633
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 1.0547239780426025
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.7229304313659668
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 1.1802647113800049
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7865850925445557
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.9867837429046631
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 1.0547096729278564
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.6348433494567871
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.9577460289001465
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.8498682975769043
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.7115507125854492
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7293601036071777
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7012679576873779
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6711466312408447
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7772572040557861
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6855478286743164
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5929958820343018
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6523361206054688
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7184293270111084
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7984402179718018
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.7628521919250488
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8271059989929199
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.8426568508148193
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.8134067058563232
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.7989764213562012
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.6340334415435791
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.9588725566864014
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.7301666736602783
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.7634212970733643
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.8944523334503174
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.8740794658660889
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.7305185794830322
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0211176872253418
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8439745903015137
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6576039791107178
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.728325366973877
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.866356611251831
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7032227516174316
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.7156538963317871
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8533527851104736
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.7821714878082275
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 52 cost time: 0.6448235511779785
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 0.7108564376831055
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7926630973815918
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 55 cost time: 0.6722307205200195
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 56 cost time: 0.7433569431304932
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.5702297687530518
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.7016811370849609
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.6722586154937744
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.6542379856109619
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.8302724361419678
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 62 cost time: 0.7571501731872559
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 63 cost time: 0.652550220489502
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 64 cost time: 0.692885160446167
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 65 cost time: 0.7779200077056885
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 66 cost time: 0.725825309753418
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 67 cost time: 0.8094117641448975
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8640282154083252
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.725944995880127
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 70 cost time: 1.0553574562072754
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.0304291248321533
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 72 cost time: 1.1563072204589844
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.055577039718628
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 74 cost time: 1.212510108947754
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 75 cost time: 1.1442017555236816
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 76 cost time: 1.0496106147766113
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 77 cost time: 1.2115201950073242
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 78 cost time: 1.018620252609253
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.1841764450073242
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.1583435535430908
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.0518519878387451
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 1.1013171672821045
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.978968620300293
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.9572494029998779
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 1.043159008026123
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.9981904029846191
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 87 cost time: 1.1770684719085693
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.0427584648132324
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.0175817012786865
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.0658750534057617
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 1.126856803894043
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 1.0860230922698975
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 1.06862473487854
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 1.1259021759033203
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 1.1338293552398682
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 96 cost time: 1.0744144916534424
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 97 cost time: 1.0752582550048828
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 98 cost time: 1.0334126949310303
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.9777543544769287
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.9837119579315186
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 764812
model size : 5.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.851902484893799
Epoch: 1, Steps: 7 | Train Loss: 2.604 Vali Loss: 2.243 Vali Acc: 0.208 Test Loss: 2.243 Test Acc: 0.208
Validation loss decreased (inf --> -0.208311).  Saving model ...
Epoch: 2 cost time: 1.045320749282837
Epoch: 2, Steps: 7 | Train Loss: 2.019 Vali Loss: 1.510 Vali Acc: 0.736 Test Loss: 1.510 Test Acc: 0.736
Validation loss decreased (-0.208311 --> -0.736096).  Saving model ...
Epoch: 3 cost time: 0.855233907699585
Epoch: 3, Steps: 7 | Train Loss: 1.067 Vali Loss: 0.886 Vali Acc: 0.833 Test Loss: 0.886 Test Acc: 0.833
Validation loss decreased (-0.736096 --> -0.833324).  Saving model ...
Epoch: 4 cost time: 1.100362777709961
Epoch: 4, Steps: 7 | Train Loss: 0.403 Vali Loss: 0.470 Vali Acc: 0.917 Test Loss: 0.470 Test Acc: 0.917
Validation loss decreased (-0.833324 --> -0.916662).  Saving model ...
Epoch: 5 cost time: 0.9609453678131104
Epoch: 5, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.04850172996521
Epoch: 6, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.1272599697113037
Epoch: 7, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.111809253692627
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0992350578308105
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.9709861278533936
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.1708831787109375
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9707727432250977
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1246941089630127
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9310441017150879
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.078775405883789
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.043344259262085
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0645625591278076
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.060145616531372
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9390695095062256
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9928748607635498
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 648844
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df256_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.634448528289795
Epoch: 1, Steps: 7 | Train Loss: 2.638 Vali Loss: 2.257 Vali Acc: 0.250 Test Loss: 2.257 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 0.9487316608428955
Epoch: 2, Steps: 7 | Train Loss: 2.055 Vali Loss: 1.630 Vali Acc: 0.708 Test Loss: 1.630 Test Acc: 0.708
Validation loss decreased (-0.249977 --> -0.708317).  Saving model ...
Epoch: 3 cost time: 1.0803813934326172
Epoch: 3, Steps: 7 | Train Loss: 1.325 Vali Loss: 1.006 Vali Acc: 0.875 Test Loss: 1.006 Test Acc: 0.875
Validation loss decreased (-0.708317 --> -0.874990).  Saving model ...
Epoch: 4 cost time: 1.0461781024932861
Epoch: 4, Steps: 7 | Train Loss: 0.593 Vali Loss: 0.564 Vali Acc: 0.889 Test Loss: 0.564 Test Acc: 0.889
Validation loss decreased (-0.874990 --> -0.888883).  Saving model ...
Epoch: 5 cost time: 1.078007459640503
Epoch: 5, Steps: 7 | Train Loss: 0.242 Vali Loss: 0.371 Vali Acc: 0.931 Test Loss: 0.371 Test Acc: 0.931
Validation loss decreased (-0.888883 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 0.9363172054290771
Epoch: 6, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.300 Vali Acc: 0.958 Test Loss: 0.300 Test Acc: 0.958
Validation loss decreased (-0.930552 --> -0.958330).  Saving model ...
Epoch: 7 cost time: 1.1315345764160156
Epoch: 7, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.248 Vali Acc: 0.958 Test Loss: 0.248 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 8 cost time: 1.0060906410217285
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9807219505310059
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 1.0499236583709717
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 0.932988166809082
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0782465934753418
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.9407024383544922
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 1.0347890853881836
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.092466115951538
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.016838788986206
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9314563274383545
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1114084720611572
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1521949768066406
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0846641063690186
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.183812141418457
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0923607349395752
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0778679847717285
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df256_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 588172
model size : 4.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.733534097671509
Epoch: 1, Steps: 7 | Train Loss: 2.514 Vali Loss: 2.242 Vali Acc: 0.222 Test Loss: 2.242 Test Acc: 0.222
Validation loss decreased (inf --> -0.222200).  Saving model ...
Epoch: 2 cost time: 1.1752150058746338
Epoch: 2, Steps: 7 | Train Loss: 2.154 Vali Loss: 1.747 Vali Acc: 0.528 Test Loss: 1.747 Test Acc: 0.528
Validation loss decreased (-0.222200 --> -0.527760).  Saving model ...
Epoch: 3 cost time: 1.0037574768066406
Epoch: 3, Steps: 7 | Train Loss: 1.484 Vali Loss: 1.216 Vali Acc: 0.778 Test Loss: 1.216 Test Acc: 0.778
Validation loss decreased (-0.527760 --> -0.777766).  Saving model ...
Epoch: 4 cost time: 1.0480890274047852
Epoch: 4, Steps: 7 | Train Loss: 0.849 Vali Loss: 0.772 Vali Acc: 0.847 Test Loss: 0.772 Test Acc: 0.847
Validation loss decreased (-0.777766 --> -0.847215).  Saving model ...
Epoch: 5 cost time: 1.133671760559082
Epoch: 5, Steps: 7 | Train Loss: 0.413 Vali Loss: 0.535 Vali Acc: 0.861 Test Loss: 0.535 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 0.9369299411773682
Epoch: 6, Steps: 7 | Train Loss: 0.192 Vali Loss: 0.414 Vali Acc: 0.861 Test Loss: 0.414 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.9848425388336182
Epoch: 7, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.198373794555664
Epoch: 8, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.9446008205413818
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.1426644325256348
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.0063972473144531
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 1.2702422142028809
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4364511966705322
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0196635723114014
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3285048007965088
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1597604751586914
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.122032642364502
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1893784999847412
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.199476718902588
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3328535556793213
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9483046531677246
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.889 Test Loss: 0.239 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 540556
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df256_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5344040393829346
Epoch: 1, Steps: 7 | Train Loss: 2.587 Vali Loss: 2.456 Vali Acc: 0.222 Test Loss: 2.456 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.7452113628387451
Epoch: 2, Steps: 7 | Train Loss: 2.214 Vali Loss: 2.023 Vali Acc: 0.389 Test Loss: 2.023 Test Acc: 0.389
Validation loss decreased (-0.222198 --> -0.388869).  Saving model ...
Epoch: 3 cost time: 0.7472274303436279
Epoch: 3, Steps: 7 | Train Loss: 1.676 Vali Loss: 1.483 Vali Acc: 0.625 Test Loss: 1.483 Test Acc: 0.625
Validation loss decreased (-0.388869 --> -0.624985).  Saving model ...
Epoch: 4 cost time: 0.7162573337554932
Epoch: 4, Steps: 7 | Train Loss: 1.095 Vali Loss: 1.038 Vali Acc: 0.792 Test Loss: 1.038 Test Acc: 0.792
Validation loss decreased (-0.624985 --> -0.791656).  Saving model ...
Epoch: 5 cost time: 0.665966272354126
Epoch: 5, Steps: 7 | Train Loss: 0.684 Vali Loss: 0.703 Vali Acc: 0.861 Test Loss: 0.703 Test Acc: 0.861
Validation loss decreased (-0.791656 --> -0.861104).  Saving model ...
Epoch: 6 cost time: 0.7185361385345459
Epoch: 6, Steps: 7 | Train Loss: 0.349 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6912803649902344
Epoch: 7, Steps: 7 | Train Loss: 0.171 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
Validation loss decreased (-0.861104 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.7490653991699219
Epoch: 8, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.7283406257629395
Epoch: 9, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.7782750129699707
Epoch: 10, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6967134475708008
Epoch: 11, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.7160770893096924
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.6888766288757324
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.6952083110809326
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.7977252006530762
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6210393905639648
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.687758207321167
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6460051536560059
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8377504348754883
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6908390522003174
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.641019344329834
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6290988922119141
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7274332046508789
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5957183837890625
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df256_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 511372
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.442697286605835
Epoch: 1, Steps: 7 | Train Loss: 2.541 Vali Loss: 2.398 Vali Acc: 0.139 Test Loss: 2.398 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.6935725212097168
Epoch: 2, Steps: 7 | Train Loss: 2.269 Vali Loss: 2.047 Vali Acc: 0.458 Test Loss: 2.047 Test Acc: 0.458
Validation loss decreased (-0.138865 --> -0.458313).  Saving model ...
Epoch: 3 cost time: 0.6848058700561523
Epoch: 3, Steps: 7 | Train Loss: 1.780 Vali Loss: 1.609 Vali Acc: 0.653 Test Loss: 1.609 Test Acc: 0.653
Validation loss decreased (-0.458313 --> -0.652762).  Saving model ...
Epoch: 4 cost time: 0.7370672225952148
Epoch: 4, Steps: 7 | Train Loss: 1.237 Vali Loss: 1.204 Vali Acc: 0.708 Test Loss: 1.204 Test Acc: 0.708
Validation loss decreased (-0.652762 --> -0.708321).  Saving model ...
Epoch: 5 cost time: 0.7601156234741211
Epoch: 5, Steps: 7 | Train Loss: 0.803 Vali Loss: 0.869 Vali Acc: 0.806 Test Loss: 0.869 Test Acc: 0.806
Validation loss decreased (-0.708321 --> -0.805547).  Saving model ...
Epoch: 6 cost time: 0.7515532970428467
Epoch: 6, Steps: 7 | Train Loss: 0.471 Vali Loss: 0.670 Vali Acc: 0.819 Test Loss: 0.670 Test Acc: 0.819
Validation loss decreased (-0.805547 --> -0.819438).  Saving model ...
Epoch: 7 cost time: 0.7529335021972656
Epoch: 7, Steps: 7 | Train Loss: 0.268 Vali Loss: 0.539 Vali Acc: 0.847 Test Loss: 0.539 Test Acc: 0.847
Validation loss decreased (-0.819438 --> -0.847217).  Saving model ...
Epoch: 8 cost time: 0.6677894592285156
Epoch: 8, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.467 Vali Acc: 0.833 Test Loss: 0.467 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7308351993560791
Epoch: 9, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 0.6550841331481934
Epoch: 10, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.339 Vali Acc: 0.861 Test Loss: 0.339 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7510290145874023
Epoch: 11, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.340 Vali Acc: 0.861 Test Loss: 0.340 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7167704105377197
Epoch: 12, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.342 Vali Acc: 0.861 Test Loss: 0.342 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7589690685272217
Epoch: 13, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.336 Vali Acc: 0.861 Test Loss: 0.336 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7895731925964355
Epoch: 14, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7614462375640869
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 16 cost time: 0.8252284526824951
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 17 cost time: 0.705812931060791
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.71158766746521
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.6753714084625244
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.7328460216522217
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.6545135974884033
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7585463523864746
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6623837947845459
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6060259342193604
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8027458190917969
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6737382411956787
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6512672901153564
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.6972429752349854
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6635348796844482
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8497219085693359
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6961050033569336
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.875 Test Loss: 0.271 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6989865303039551
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.875 Test Loss: 0.270 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7782473564147949
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.875 Test Loss: 0.269 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6846683025360107
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 0.7199625968933105
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.8176884651184082
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.7355597019195557
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.7683932781219482
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7542068958282471
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7415256500244141
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.875 Test Loss: 0.259 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7992382049560547
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.875 Test Loss: 0.258 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.710237979888916
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7198152542114258
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.7541515827178955
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.8170397281646729
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7448391914367676
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8313031196594238
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7577953338623047
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7282407283782959
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.7998130321502686
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.873833417892456
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.7653601169586182
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.7465577125549316
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.8198263645172119
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.7319023609161377
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.781163215637207
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 57 cost time: 0.7388312816619873
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7479758262634277
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7862603664398193
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.7095835208892822
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.7078421115875244
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7971274852752686
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 0.6542222499847412
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 64 cost time: 0.7358078956604004
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 65 cost time: 0.821103572845459
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 66 cost time: 0.7106337547302246
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8414952754974365
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.723928689956665
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 69 cost time: 0.9382181167602539
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.733879566192627
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.7675266265869141
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 72 cost time: 0.7983760833740234
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 73 cost time: 0.796637773513794
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 74 cost time: 0.9317708015441895
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 75 cost time: 0.7899172306060791
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8019402027130127
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.818382740020752
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.7965610027313232
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.7256805896759033
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.7942333221435547
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.7972514629364014
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 82 cost time: 0.7817132472991943
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 83 cost time: 0.7825376987457275
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 84 cost time: 0.7433125972747803
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 85 cost time: 0.6844074726104736
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 86 cost time: 0.7046184539794922
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 87 cost time: 0.7632262706756592
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 88 cost time: 0.7118487358093262
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 89 cost time: 0.7121689319610596
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.6841256618499756
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 91 cost time: 0.6370701789855957
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 92 cost time: 0.7511155605316162
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 93 cost time: 0.6860034465789795
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 94 cost time: 0.7372369766235352
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 95 cost time: 0.7619855403900146
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 96 cost time: 0.7018835544586182
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 97 cost time: 0.7882096767425537
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.8217325210571289
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.8450050354003906
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 0.82676100730896
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 500620
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5774269104003906
Epoch: 1, Steps: 7 | Train Loss: 2.566 Vali Loss: 2.055 Vali Acc: 0.444 Test Loss: 2.055 Test Acc: 0.444
Validation loss decreased (inf --> -0.444424).  Saving model ...
Epoch: 2 cost time: 1.5699293613433838
Epoch: 2, Steps: 7 | Train Loss: 1.464 Vali Loss: 0.871 Vali Acc: 0.819 Test Loss: 0.871 Test Acc: 0.819
Validation loss decreased (-0.444424 --> -0.819436).  Saving model ...
Epoch: 3 cost time: 1.5923595428466797
Epoch: 3, Steps: 7 | Train Loss: 0.413 Vali Loss: 0.347 Vali Acc: 0.861 Test Loss: 0.347 Test Acc: 0.861
Validation loss decreased (-0.819436 --> -0.861108).  Saving model ...
Epoch: 4 cost time: 1.7422168254852295
Epoch: 4, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
Validation loss decreased (-0.861108 --> -0.930552).  Saving model ...
Epoch: 5 cost time: 1.5931501388549805
Epoch: 5, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944443).  Saving model ...
Epoch: 6 cost time: 1.6551475524902344
Epoch: 6, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.944 Test Loss: 0.134 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 7 cost time: 1.6648757457733154
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.917 Test Loss: 0.167 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6857221126556396
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8028388023376465
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7009217739105225
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7423222064971924
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7001173496246338
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.696692705154419
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8166203498840332
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7711844444274902
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8483898639678955
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1030924
model size : 6.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7063677310943604
Epoch: 1, Steps: 7 | Train Loss: 2.578 Vali Loss: 2.195 Vali Acc: 0.347 Test Loss: 2.195 Test Acc: 0.347
Validation loss decreased (inf --> -0.347200).  Saving model ...
Epoch: 2 cost time: 1.7952775955200195
Epoch: 2, Steps: 7 | Train Loss: 1.775 Vali Loss: 1.241 Vali Acc: 0.819 Test Loss: 1.241 Test Acc: 0.819
Validation loss decreased (-0.347200 --> -0.819432).  Saving model ...
Epoch: 3 cost time: 1.884028434753418
Epoch: 3, Steps: 7 | Train Loss: 0.692 Vali Loss: 0.632 Vali Acc: 0.806 Test Loss: 0.632 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9090888500213623
Epoch: 4, Steps: 7 | Train Loss: 0.211 Vali Loss: 0.453 Vali Acc: 0.861 Test Loss: 0.453 Test Acc: 0.861
Validation loss decreased (-0.819432 --> -0.861107).  Saving model ...
Epoch: 5 cost time: 1.8669099807739258
Epoch: 5, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888886).  Saving model ...
Epoch: 6 cost time: 2.0625181198120117
Epoch: 6, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 1.9285573959350586
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0461981296539307
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0438649654388428
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.8375747203826904
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8732695579528809
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8747403621673584
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9298992156982422
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7744073867797852
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9660084247589111
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6962416172027588
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8632771968841553
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.820507526397705
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8241653442382812
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 666124
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.416325330734253
Epoch: 1, Steps: 7 | Train Loss: 2.561 Vali Loss: 2.303 Vali Acc: 0.194 Test Loss: 2.303 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 1.6657724380493164
Epoch: 2, Steps: 7 | Train Loss: 1.968 Vali Loss: 1.502 Vali Acc: 0.708 Test Loss: 1.502 Test Acc: 0.708
Validation loss decreased (-0.194421 --> -0.708318).  Saving model ...
Epoch: 3 cost time: 1.6850080490112305
Epoch: 3, Steps: 7 | Train Loss: 1.020 Vali Loss: 0.811 Vali Acc: 0.833 Test Loss: 0.811 Test Acc: 0.833
Validation loss decreased (-0.708318 --> -0.833325).  Saving model ...
Epoch: 4 cost time: 1.7446057796478271
Epoch: 4, Steps: 7 | Train Loss: 0.376 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
Validation loss decreased (-0.833325 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 1.681441068649292
Epoch: 5, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.392 Vali Acc: 0.889 Test Loss: 0.392 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.532329797744751
Epoch: 6, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
Validation loss decreased (-0.888885 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 1.698197841644287
Epoch: 7, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5480480194091797
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 1.7110419273376465
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.6051974296569824
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.6212234497070312
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7467408180236816
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.6617937088012695
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7564382553100586
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.7543611526489258
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.7635881900787354
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6878726482391357
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 1.749079704284668
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 1.7880363464355469
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6570088863372803
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7585492134094238
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6725823879241943
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.738685131072998
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.741734504699707
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7288382053375244
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7341625690460205
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7784039974212646
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.6795153617858887
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 550156
model size : 4.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df128_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5840158462524414
Epoch: 1, Steps: 7 | Train Loss: 2.585 Vali Loss: 2.403 Vali Acc: 0.083 Test Loss: 2.403 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 1.7547731399536133
Epoch: 2, Steps: 7 | Train Loss: 2.080 Vali Loss: 1.704 Vali Acc: 0.625 Test Loss: 1.704 Test Acc: 0.625
Validation loss decreased (-0.083309 --> -0.624983).  Saving model ...
Epoch: 3 cost time: 1.6503443717956543
Epoch: 3, Steps: 7 | Train Loss: 1.216 Vali Loss: 1.066 Vali Acc: 0.833 Test Loss: 1.066 Test Acc: 0.833
Validation loss decreased (-0.624983 --> -0.833323).  Saving model ...
Epoch: 4 cost time: 1.6423454284667969
Epoch: 4, Steps: 7 | Train Loss: 0.594 Vali Loss: 0.640 Vali Acc: 0.847 Test Loss: 0.640 Test Acc: 0.847
Validation loss decreased (-0.833323 --> -0.847216).  Saving model ...
Epoch: 5 cost time: 1.9423317909240723
Epoch: 5, Steps: 7 | Train Loss: 0.247 Vali Loss: 0.425 Vali Acc: 0.889 Test Loss: 0.425 Test Acc: 0.889
Validation loss decreased (-0.847216 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.6863987445831299
Epoch: 6, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.374 Vali Acc: 0.903 Test Loss: 0.374 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.920605182647705
Epoch: 7, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8945269584655762
Epoch: 8, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.8981032371520996
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9253954887390137
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 2.129781723022461
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.9494917392730713
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.8813016414642334
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.9820780754089355
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.9774322509765625
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.708808183670044
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.8895854949951172
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.9587252140045166
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.740572452545166
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6497681140899658
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9847190380096436
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.9616358280181885
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6049001216888428
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5744349956512451
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7993664741516113
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.847668170928955
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7142388820648193
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.004207134246826
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.8373346328735352
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 1.9060885906219482
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.7109246253967285
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 1.921698808670044
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 1.666203498840332
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 1.9166264533996582
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 1.8324780464172363
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7740039825439453
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 1.6256165504455566
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 1.7892847061157227
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7696356773376465
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.8021409511566162
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.5431759357452393
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 1.6156244277954102
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 1.8973634243011475
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 1.775481939315796
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 1.7032771110534668
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.6133356094360352
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.6876099109649658
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 1.9730608463287354
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.8187248706817627
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.7797417640686035
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.717726230621338
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.9039199352264404
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.8176820278167725
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.8360509872436523
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.9308359622955322
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.868839979171753
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 1.9417147636413574
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 1.7593646049499512
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 1.8298985958099365
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 60 cost time: 1.8849425315856934
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.6196460723876953
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.8211383819580078
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.7877466678619385
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.7794950008392334
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.6676995754241943
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 66 cost time: 1.6917293071746826
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.544011116027832
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 2.029628276824951
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 2.0193142890930176
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.7653083801269531
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 71 cost time: 2.1714212894439697
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.9857203960418701
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.984234094619751
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 2.033210515975952
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 2.0442490577697754
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.9276611804962158
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 2.0220980644226074
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.992121934890747
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 2.1324493885040283
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 2.2396533489227295
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df128_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 489484
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8534810543060303
Epoch: 1, Steps: 7 | Train Loss: 2.688 Vali Loss: 2.358 Vali Acc: 0.208 Test Loss: 2.358 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 1.7914683818817139
Epoch: 2, Steps: 7 | Train Loss: 2.189 Vali Loss: 1.831 Vali Acc: 0.514 Test Loss: 1.831 Test Acc: 0.514
Validation loss decreased (-0.208310 --> -0.513871).  Saving model ...
Epoch: 3 cost time: 1.9525296688079834
Epoch: 3, Steps: 7 | Train Loss: 1.537 Vali Loss: 1.263 Vali Acc: 0.764 Test Loss: 1.263 Test Acc: 0.764
Validation loss decreased (-0.513871 --> -0.763876).  Saving model ...
Epoch: 4 cost time: 2.040607213973999
Epoch: 4, Steps: 7 | Train Loss: 0.918 Vali Loss: 0.822 Vali Acc: 0.875 Test Loss: 0.822 Test Acc: 0.875
Validation loss decreased (-0.763876 --> -0.874992).  Saving model ...
Epoch: 5 cost time: 1.846416711807251
Epoch: 5, Steps: 7 | Train Loss: 0.448 Vali Loss: 0.534 Vali Acc: 0.889 Test Loss: 0.534 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 1.878746747970581
Epoch: 6, Steps: 7 | Train Loss: 0.196 Vali Loss: 0.404 Vali Acc: 0.917 Test Loss: 0.404 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.9694671630859375
Epoch: 7, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7346317768096924
Epoch: 8, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.8684048652648926
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8476812839508057
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.637467622756958
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7186915874481201
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8950889110565186
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8448071479797363
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.8507428169250488
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.71779465675354
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.7577722072601318
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.8829376697540283
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1347813606262207
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8115558624267578
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9771103858947754
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.8281478881835938
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.6746702194213867
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9940261840820312
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 2.259105682373047
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.7940897941589355
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9428627490997314
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9679579734802246
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8372740745544434
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 2.3398005962371826
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 2.023103952407837
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 1.82267427444458
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 2.0970778465270996
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 2.0025479793548584
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 1.9616355895996094
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6923892498016357
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.640322208404541
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.7524564266204834
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6705152988433838
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.7592077255249023
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.6526522636413574
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.8870923519134521
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.9295740127563477
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.707040786743164
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 441868
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df128_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8183555603027344
Epoch: 1, Steps: 7 | Train Loss: 2.555 Vali Loss: 2.521 Vali Acc: 0.153 Test Loss: 2.521 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.9852678775787354
Epoch: 2, Steps: 7 | Train Loss: 2.161 Vali Loss: 2.041 Vali Acc: 0.569 Test Loss: 2.041 Test Acc: 0.569
Validation loss decreased (-0.152753 --> -0.569424).  Saving model ...
Epoch: 3 cost time: 1.012568712234497
Epoch: 3, Steps: 7 | Train Loss: 1.704 Vali Loss: 1.507 Vali Acc: 0.722 Test Loss: 1.507 Test Acc: 0.722
Validation loss decreased (-0.569424 --> -0.722207).  Saving model ...
Epoch: 4 cost time: 1.0123250484466553
Epoch: 4, Steps: 7 | Train Loss: 1.154 Vali Loss: 1.047 Vali Acc: 0.819 Test Loss: 1.047 Test Acc: 0.819
Validation loss decreased (-0.722207 --> -0.819434).  Saving model ...
Epoch: 5 cost time: 0.947030782699585
Epoch: 5, Steps: 7 | Train Loss: 0.713 Vali Loss: 0.725 Vali Acc: 0.847 Test Loss: 0.725 Test Acc: 0.847
Validation loss decreased (-0.819434 --> -0.847215).  Saving model ...
Epoch: 6 cost time: 0.9619448184967041
Epoch: 6, Steps: 7 | Train Loss: 0.391 Vali Loss: 0.510 Vali Acc: 0.875 Test Loss: 0.510 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 1.0269370079040527
Epoch: 7, Steps: 7 | Train Loss: 0.196 Vali Loss: 0.404 Vali Acc: 0.917 Test Loss: 0.404 Test Acc: 0.917
Validation loss decreased (-0.874995 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 0.9372348785400391
Epoch: 8, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.357 Vali Acc: 0.931 Test Loss: 0.357 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 1.071730613708496
Epoch: 9, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9598116874694824
Epoch: 10, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.894603967666626
Epoch: 11, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.0180308818817139
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.008772850036621
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.9591357707977295
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.0524177551269531
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.9874215126037598
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.9599554538726807
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.075103759765625
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.073570966720581
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1015760898590088
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0689723491668701
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0731792449951172
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0501105785369873
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1359527111053467
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.0183959007263184
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.0034525394439697
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.9482090473175049
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0796892642974854
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0098741054534912
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0100390911102295
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0199127197265625
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0224692821502686
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0166921615600586
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0650370121002197
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9776217937469482
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9340527057647705
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df128_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 412684
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6843271255493164
Epoch: 1, Steps: 7 | Train Loss: 2.445 Vali Loss: 2.305 Vali Acc: 0.181 Test Loss: 2.305 Test Acc: 0.181
Validation loss decreased (inf --> -0.180533).  Saving model ...
Epoch: 2 cost time: 0.9392225742340088
Epoch: 2, Steps: 7 | Train Loss: 2.204 Vali Loss: 1.955 Vali Acc: 0.375 Test Loss: 1.955 Test Acc: 0.375
Validation loss decreased (-0.180533 --> -0.374980).  Saving model ...
Epoch: 3 cost time: 0.9072577953338623
Epoch: 3, Steps: 7 | Train Loss: 1.801 Vali Loss: 1.530 Vali Acc: 0.694 Test Loss: 1.530 Test Acc: 0.694
Validation loss decreased (-0.374980 --> -0.694429).  Saving model ...
Epoch: 4 cost time: 0.9807400703430176
Epoch: 4, Steps: 7 | Train Loss: 1.248 Vali Loss: 1.137 Vali Acc: 0.778 Test Loss: 1.137 Test Acc: 0.778
Validation loss decreased (-0.694429 --> -0.777766).  Saving model ...
Epoch: 5 cost time: 0.9542639255523682
Epoch: 5, Steps: 7 | Train Loss: 0.820 Vali Loss: 0.838 Vali Acc: 0.833 Test Loss: 0.838 Test Acc: 0.833
Validation loss decreased (-0.777766 --> -0.833325).  Saving model ...
Epoch: 6 cost time: 0.9621949195861816
Epoch: 6, Steps: 7 | Train Loss: 0.492 Vali Loss: 0.638 Vali Acc: 0.819 Test Loss: 0.638 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.055382490158081
Epoch: 7, Steps: 7 | Train Loss: 0.253 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
Validation loss decreased (-0.833325 --> -0.847217).  Saving model ...
Epoch: 8 cost time: 1.070225477218628
Epoch: 8, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 1.1150696277618408
Epoch: 9, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 1.1159358024597168
Epoch: 10, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 1.1245534420013428
Epoch: 11, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.369 Vali Acc: 0.903 Test Loss: 0.369 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 1.0688974857330322
Epoch: 12, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.104865312576294
Epoch: 13, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.9459571838378906
Epoch: 14, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 1.009507179260254
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 1.0128014087677002
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9328162670135498
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9778225421905518
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.9814484119415283
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 1.01542329788208
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0744366645812988
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.026569128036499
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 1.077514410018921
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 1.0128436088562012
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.9445583820343018
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 1.0283281803131104
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 1.0174410343170166
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 1.0478973388671875
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 1.0814425945281982
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.9935626983642578
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0108585357666016
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 1.0073657035827637
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9077067375183105
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0278093814849854
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9951510429382324
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9853694438934326
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9163916110992432
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.002027988433838
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 1.0808138847351074
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.973853588104248
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8987107276916504
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0478811264038086
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1062593460083008
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9688799381256104
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0577747821807861
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9751989841461182
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.083925724029541
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0550220012664795
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.0480825901031494
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 401932
model size : 4.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5310940742492676
Epoch: 1, Steps: 7 | Train Loss: 2.475 Vali Loss: 2.011 Vali Acc: 0.222 Test Loss: 2.011 Test Acc: 0.222
Validation loss decreased (inf --> -0.222202).  Saving model ...
Epoch: 2 cost time: 1.642585277557373
Epoch: 2, Steps: 7 | Train Loss: 1.362 Vali Loss: 0.712 Vali Acc: 0.903 Test Loss: 0.712 Test Acc: 0.903
Validation loss decreased (-0.222202 --> -0.902771).  Saving model ...
Epoch: 3 cost time: 1.726057529449463
Epoch: 3, Steps: 7 | Train Loss: 0.260 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6620781421661377
Epoch: 4, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.902771 --> -0.944442).  Saving model ...
Epoch: 5 cost time: 1.8390674591064453
Epoch: 5, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7309346199035645
Epoch: 6, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8449900150299072
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.664536952972412
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 2.001305341720581
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 1.5283925533294678
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 1.8571515083312988
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7263758182525635
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.831695795059204
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.64046311378479
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7957327365875244
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.445669174194336
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7882211208343506
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7854936122894287
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7518186569213867
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.562401294708252
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 981580
model size : 6.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8263261318206787
Epoch: 1, Steps: 7 | Train Loss: 2.633 Vali Loss: 2.278 Vali Acc: 0.278 Test Loss: 2.278 Test Acc: 0.278
Validation loss decreased (inf --> -0.277755).  Saving model ...
Epoch: 2 cost time: 2.033264636993408
Epoch: 2, Steps: 7 | Train Loss: 1.819 Vali Loss: 1.246 Vali Acc: 0.806 Test Loss: 1.246 Test Acc: 0.806
Validation loss decreased (-0.277755 --> -0.805543).  Saving model ...
Epoch: 3 cost time: 1.9567759037017822
Epoch: 3, Steps: 7 | Train Loss: 0.712 Vali Loss: 0.712 Vali Acc: 0.861 Test Loss: 0.712 Test Acc: 0.861
Validation loss decreased (-0.805543 --> -0.861104).  Saving model ...
Epoch: 4 cost time: 2.2864763736724854
Epoch: 4, Steps: 7 | Train Loss: 0.254 Vali Loss: 0.428 Vali Acc: 0.889 Test Loss: 0.428 Test Acc: 0.889
Validation loss decreased (-0.861104 --> -0.888885).  Saving model ...
Epoch: 5 cost time: 2.1506917476654053
Epoch: 5, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 1.998002529144287
Epoch: 6, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 2.438587188720703
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.330 Vali Acc: 0.931 Test Loss: 0.330 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.150148391723633
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1365766525268555
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7436800003051758
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.309962749481201
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.185673475265503
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9722788333892822
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 2.0536983013153076
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.9599652290344238
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.8809237480163574
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.8305330276489258
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 2.3822357654571533
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 2.2016546726226807
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.019531488418579
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5772979259490967
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7368898391723633
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6861212253570557
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5252408981323242
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7166693210601807
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6858241558074951
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3879601955413818
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9663691520690918
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 616780
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6517510414123535
Epoch: 1, Steps: 7 | Train Loss: 2.392 Vali Loss: 2.158 Vali Acc: 0.333 Test Loss: 2.158 Test Acc: 0.333
Validation loss decreased (inf --> -0.333312).  Saving model ...
Epoch: 2 cost time: 2.039323329925537
Epoch: 2, Steps: 7 | Train Loss: 1.859 Vali Loss: 1.415 Vali Acc: 0.681 Test Loss: 1.415 Test Acc: 0.681
Validation loss decreased (-0.333312 --> -0.680541).  Saving model ...
Epoch: 3 cost time: 1.907850742340088
Epoch: 3, Steps: 7 | Train Loss: 0.962 Vali Loss: 0.827 Vali Acc: 0.792 Test Loss: 0.827 Test Acc: 0.792
Validation loss decreased (-0.680541 --> -0.791658).  Saving model ...
Epoch: 4 cost time: 2.019352436065674
Epoch: 4, Steps: 7 | Train Loss: 0.385 Vali Loss: 0.459 Vali Acc: 0.889 Test Loss: 0.459 Test Acc: 0.889
Validation loss decreased (-0.791658 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 2.096120595932007
Epoch: 5, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 1.843569040298462
Epoch: 6, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 2.0395009517669678
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 1.992645025253296
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.158769369125366
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8386945724487305
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.061239004135132
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.020885705947876
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 2.002187490463257
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 1.9672513008117676
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 1.959986925125122
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 1.9332399368286133
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7485852241516113
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 2.0012550354003906
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.854369878768921
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5113401412963867
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4628682136535645
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 1.5231823921203613
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 1.5521910190582275
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 1.868161678314209
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.57492995262146
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.53556489944458
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.835397481918335
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 1.827235460281372
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 1.758915662765503
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 1.6277058124542236
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 1.8477835655212402
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 1.7259516716003418
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 2.0221149921417236
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 2.0706491470336914
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.931 Test Loss: 0.172 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.0141828060150146
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.872678279876709
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.0172746181488037
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.8450851440429688
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 1.9450805187225342
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.7683660984039307
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.9986131191253662
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.9322693347930908
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.8351030349731445
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.8646435737609863
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 1.622041940689087
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 1.7990639209747314
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 1.7000346183776855
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 1.8684422969818115
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 1.9594123363494873
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.86930513381958
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.8356001377105713
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.5539941787719727
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.006075859069824
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.9190523624420166
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.9335212707519531
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 2.1010758876800537
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 2.099555015563965
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 2.0100271701812744
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 500812
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df64_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5992038249969482
Epoch: 1, Steps: 7 | Train Loss: 2.642 Vali Loss: 2.430 Vali Acc: 0.125 Test Loss: 2.430 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 1.7552144527435303
Epoch: 2, Steps: 7 | Train Loss: 2.107 Vali Loss: 1.818 Vali Acc: 0.583 Test Loss: 1.818 Test Acc: 0.583
Validation loss decreased (-0.124976 --> -0.583315).  Saving model ...
Epoch: 3 cost time: 1.9511654376983643
Epoch: 3, Steps: 7 | Train Loss: 1.331 Vali Loss: 1.156 Vali Acc: 0.764 Test Loss: 1.156 Test Acc: 0.764
Validation loss decreased (-0.583315 --> -0.763877).  Saving model ...
Epoch: 4 cost time: 1.821720838546753
Epoch: 4, Steps: 7 | Train Loss: 0.684 Vali Loss: 0.695 Vali Acc: 0.833 Test Loss: 0.695 Test Acc: 0.833
Validation loss decreased (-0.763877 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 1.9207985401153564
Epoch: 5, Steps: 7 | Train Loss: 0.256 Vali Loss: 0.514 Vali Acc: 0.833 Test Loss: 0.514 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833328).  Saving model ...
Epoch: 6 cost time: 2.115123748779297
Epoch: 6, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
Validation loss decreased (-0.833328 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 1.8880419731140137
Epoch: 7, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.7921533584594727
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.6460607051849365
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7988221645355225
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7384634017944336
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7293543815612793
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6794016361236572
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7730834484100342
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.747678518295288
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7738914489746094
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7951123714447021
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.710829257965088
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.709031343460083
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.6850662231445312
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7509260177612305
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.609069585800171
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7835431098937988
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.8206498622894287
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.713979959487915
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7899243831634521
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8224258422851562
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7860562801361084
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8590264320373535
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9302685260772705
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.7954449653625488
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 1.7024805545806885
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 1.6244101524353027
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 1.6351492404937744
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 1.7886219024658203
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 1.723569631576538
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.729499101638794
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.712738037109375
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.7397868633270264
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 1.7459194660186768
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.8049590587615967
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.6751089096069336
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 1.802480697631836
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.667924404144287
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 1.8249051570892334
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 1.6136102676391602
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.669536828994751
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.53428316116333
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.6540930271148682
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 1.478602647781372
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.5579109191894531
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.5074996948242188
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.5270211696624756
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 1.7559733390808105
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.624622106552124
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 1.7805664539337158
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.8217556476593018
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 1.7684326171875
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 1.8515000343322754
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.623401165008545
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.7892582416534424
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.6314136981964111
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.657717227935791
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.716728925704956
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 65 cost time: 1.6508567333221436
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 66 cost time: 1.5292413234710693
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 67 cost time: 1.7664134502410889
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 68 cost time: 1.7087411880493164
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.7226219177246094
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 70 cost time: 1.6662178039550781
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.6429719924926758
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.5720651149749756
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.780705213546753
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.7937955856323242
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.7740635871887207
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.7001349925994873
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.7225854396820068
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 78 cost time: 1.7818169593811035
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 79 cost time: 1.5791118144989014
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.6224145889282227
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 81 cost time: 1.5981707572937012
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 82 cost time: 1.6122801303863525
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.6836791038513184
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.999260663986206
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.7869327068328857
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 1.7155735492706299
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 1.980412244796753
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 1.8263986110687256
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 1.8143444061279297
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 1.5901885032653809
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 1.6742825508117676
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 92 cost time: 1.8379056453704834
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 93 cost time: 1.746645450592041
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.7343199253082275
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.8071997165679932
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 1.7308008670806885
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 97 cost time: 1.8794324398040771
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 98 cost time: 1.8765785694122314
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 99 cost time: 2.08573842048645
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 100 cost time: 1.9872913360595703
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df64_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 440140
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6316065788269043
Epoch: 1, Steps: 7 | Train Loss: 2.535 Vali Loss: 2.383 Vali Acc: 0.208 Test Loss: 2.383 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 2.234255790710449
Epoch: 2, Steps: 7 | Train Loss: 2.219 Vali Loss: 1.900 Vali Acc: 0.569 Test Loss: 1.900 Test Acc: 0.569
Validation loss decreased (-0.208310 --> -0.569425).  Saving model ...
Epoch: 3 cost time: 2.3820230960845947
Epoch: 3, Steps: 7 | Train Loss: 1.546 Vali Loss: 1.336 Vali Acc: 0.792 Test Loss: 1.336 Test Acc: 0.792
Validation loss decreased (-0.569425 --> -0.791653).  Saving model ...
Epoch: 4 cost time: 2.1081087589263916
Epoch: 4, Steps: 7 | Train Loss: 0.933 Vali Loss: 0.866 Vali Acc: 0.889 Test Loss: 0.866 Test Acc: 0.889
Validation loss decreased (-0.791653 --> -0.888880).  Saving model ...
Epoch: 5 cost time: 2.2394051551818848
Epoch: 5, Steps: 7 | Train Loss: 0.479 Vali Loss: 0.568 Vali Acc: 0.917 Test Loss: 0.568 Test Acc: 0.917
Validation loss decreased (-0.888880 --> -0.916661).  Saving model ...
Epoch: 6 cost time: 2.25445294380188
Epoch: 6, Steps: 7 | Train Loss: 0.214 Vali Loss: 0.406 Vali Acc: 0.917 Test Loss: 0.406 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 2.103019952774048
Epoch: 7, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.332 Vali Acc: 0.931 Test Loss: 0.332 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 2.072417974472046
Epoch: 8, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1591711044311523
Epoch: 9, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.9561834335327148
Epoch: 10, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 2.1130712032318115
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 2.0798888206481934
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9953527450561523
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.142514944076538
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0461747646331787
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.9492106437683105
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.9254860877990723
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.9711852073669434
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.9923174381256104
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.9267191886901855
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.9200801849365234
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.052070140838623
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8864808082580566
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0831611156463623
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9418418407440186
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 2.021761655807495
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 2.0583176612854004
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 1.9958007335662842
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 2.068505048751831
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 2.0845205783843994
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.059746503829956
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.1863512992858887
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.08363676071167
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 2.0231151580810547
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 2.206983804702759
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.940978765487671
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.1068615913391113
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 2.1299257278442383
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 1.9246306419372559
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.7902772426605225
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.675269603729248
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.7505085468292236
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 1.5810110569000244
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 1.5328409671783447
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 1.5498111248016357
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 1.9568336009979248
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 1.7846369743347168
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.881044864654541
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.6425952911376953
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.8193461894989014
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 51 cost time: 1.9150781631469727
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.9838337898254395
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 1.699173927307129
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 54 cost time: 1.9163391590118408
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 55 cost time: 1.9336988925933838
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.86720609664917
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.0320754051208496
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.012758731842041
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.0607523918151855
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.614896535873413
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 61 cost time: 2.0585875511169434
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 62 cost time: 1.9001989364624023
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.047968626022339
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.9672789573669434
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.0856995582580566
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.9881577491760254
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 2.0204343795776367
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.9964840412139893
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.8909554481506348
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 70 cost time: 2.100135326385498
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 71 cost time: 1.8399467468261719
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 72 cost time: 1.9816195964813232
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 73 cost time: 1.832709789276123
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.7184967994689941
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 75 cost time: 1.7019751071929932
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 76 cost time: 1.7143361568450928
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 77 cost time: 1.8206896781921387
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 78 cost time: 1.6698799133300781
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 79 cost time: 1.6152527332305908
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 80 cost time: 1.7403347492218018
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 81 cost time: 1.7331390380859375
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 82 cost time: 1.8572392463684082
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.6682989597320557
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.8152625560760498
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.61375093460083
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
Validation loss decreased (-0.958332 --> -0.972221).  Saving model ...
Epoch: 86 cost time: 1.9656109809875488
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 87 cost time: 1.877333402633667
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 88 cost time: 2.0430610179901123
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.9081966876983643
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 2.030034303665161
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 1.7533361911773682
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 92 cost time: 1.9244720935821533
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.9831860065460205
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 2.0229880809783936
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 1.7622385025024414
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 96 cost time: 1.9910929203033447
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 97 cost time: 1.9244508743286133
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 2.1025702953338623
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.9915831089019775
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 1.9538483619689941
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 392524
model size : 3.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df64_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.798804998397827
Epoch: 1, Steps: 7 | Train Loss: 2.632 Vali Loss: 2.427 Vali Acc: 0.083 Test Loss: 2.427 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 1.1040682792663574
Epoch: 2, Steps: 7 | Train Loss: 2.258 Vali Loss: 2.017 Vali Acc: 0.431 Test Loss: 2.017 Test Acc: 0.431
Validation loss decreased (-0.083309 --> -0.430535).  Saving model ...
Epoch: 3 cost time: 1.1138544082641602
Epoch: 3, Steps: 7 | Train Loss: 1.774 Vali Loss: 1.530 Vali Acc: 0.625 Test Loss: 1.530 Test Acc: 0.625
Validation loss decreased (-0.430535 --> -0.624985).  Saving model ...
Epoch: 4 cost time: 1.0041751861572266
Epoch: 4, Steps: 7 | Train Loss: 1.247 Vali Loss: 1.082 Vali Acc: 0.861 Test Loss: 1.082 Test Acc: 0.861
Validation loss decreased (-0.624985 --> -0.861100).  Saving model ...
Epoch: 5 cost time: 1.168163776397705
Epoch: 5, Steps: 7 | Train Loss: 0.745 Vali Loss: 0.746 Vali Acc: 0.889 Test Loss: 0.746 Test Acc: 0.889
Validation loss decreased (-0.861100 --> -0.888881).  Saving model ...
Epoch: 6 cost time: 1.0519795417785645
Epoch: 6, Steps: 7 | Train Loss: 0.405 Vali Loss: 0.560 Vali Acc: 0.875 Test Loss: 0.560 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9287474155426025
Epoch: 7, Steps: 7 | Train Loss: 0.211 Vali Loss: 0.444 Vali Acc: 0.889 Test Loss: 0.444 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 1.0682823657989502
Epoch: 8, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.369 Vali Acc: 0.931 Test Loss: 0.369 Test Acc: 0.931
Validation loss decreased (-0.888884 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 1.0422859191894531
Epoch: 9, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9611244201660156
Epoch: 10, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.1466374397277832
Epoch: 11, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0370149612426758
Epoch: 12, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0335819721221924
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0584564208984375
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0913069248199463
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.240 Vali Acc: 0.958 Test Loss: 0.240 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.9543666839599609
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0107982158660889
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0857689380645752
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 1.0027549266815186
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 1.0210413932800293
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 1.0520930290222168
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9639866352081299
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.1430480480194092
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.9865491390228271
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0336847305297852
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.137338399887085
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0527350902557373
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1562259197235107
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9813282489776611
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1123385429382324
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.9928333759307861
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 1.0426809787750244
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1693251132965088
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1000995635986328
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9807536602020264
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 1.1616580486297607
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 1.0660672187805176
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0820622444152832
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1018202304840088
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9708359241485596
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.102665662765503
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 1.0357317924499512
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 1.1270349025726318
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0557353496551514
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 1.0625996589660645
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 1.0464565753936768
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 1.0209393501281738
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 1.1224486827850342
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0201826095581055
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.205960988998413
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 51 cost time: 1.0490913391113281
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0595204830169678
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0581443309783936
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 54 cost time: 1.0302248001098633
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 55 cost time: 1.1197552680969238
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 56 cost time: 1.044348955154419
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 57 cost time: 1.0626275539398193
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 58 cost time: 0.9577457904815674
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 59 cost time: 1.0430688858032227
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 60 cost time: 0.969254732131958
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0055108070373535
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9768073558807373
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.1273620128631592
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 64 cost time: 1.0073204040527344
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 65 cost time: 1.0260298252105713
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 66 cost time: 1.1110057830810547
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.1833171844482422
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.0512020587921143
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.0530469417572021
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.0429582595825195
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 71 cost time: 1.0958678722381592
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 72 cost time: 0.9431145191192627
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 73 cost time: 1.0129010677337646
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 74 cost time: 1.0334386825561523
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 75 cost time: 1.0131399631500244
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 76 cost time: 1.0178568363189697
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 77 cost time: 1.0377068519592285
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 78 cost time: 1.0234570503234863
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.0806784629821777
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.9853916168212891
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.0208282470703125
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 82 cost time: 1.0104804039001465
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 83 cost time: 1.0290956497192383
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 84 cost time: 1.009458303451538
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 85 cost time: 1.02992844581604
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 86 cost time: 0.9551548957824707
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.0384953022003174
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.085768222808838
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 89 cost time: 1.0038948059082031
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.9467606544494629
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.9458436965942383
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.9582579135894775
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 0.9902606010437012
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 1.0169484615325928
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 1.0066251754760742
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 96 cost time: 1.0488026142120361
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 97 cost time: 0.9412002563476562
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.1240870952606201
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.9543282985687256
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 100 cost time: 0.9622149467468262
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df64_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 363340
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7810020446777344
Epoch: 1, Steps: 7 | Train Loss: 2.467 Vali Loss: 2.444 Vali Acc: 0.167 Test Loss: 2.444 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 1.0000362396240234
Epoch: 2, Steps: 7 | Train Loss: 2.236 Vali Loss: 2.078 Vali Acc: 0.292 Test Loss: 2.078 Test Acc: 0.292
Validation loss decreased (-0.166642 --> -0.291646).  Saving model ...
Epoch: 3 cost time: 1.0861542224884033
Epoch: 3, Steps: 7 | Train Loss: 1.792 Vali Loss: 1.620 Vali Acc: 0.611 Test Loss: 1.620 Test Acc: 0.611
Validation loss decreased (-0.291646 --> -0.611095).  Saving model ...
Epoch: 4 cost time: 1.025758981704712
Epoch: 4, Steps: 7 | Train Loss: 1.199 Vali Loss: 1.170 Vali Acc: 0.792 Test Loss: 1.170 Test Acc: 0.792
Validation loss decreased (-0.611095 --> -0.791655).  Saving model ...
Epoch: 5 cost time: 0.9869565963745117
Epoch: 5, Steps: 7 | Train Loss: 0.800 Vali Loss: 0.844 Vali Acc: 0.833 Test Loss: 0.844 Test Acc: 0.833
Validation loss decreased (-0.791655 --> -0.833325).  Saving model ...
Epoch: 6 cost time: 0.9158852100372314
Epoch: 6, Steps: 7 | Train Loss: 0.492 Vali Loss: 0.620 Vali Acc: 0.875 Test Loss: 0.620 Test Acc: 0.875
Validation loss decreased (-0.833325 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 1.0565485954284668
Epoch: 7, Steps: 7 | Train Loss: 0.283 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 0.9995083808898926
Epoch: 8, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.9693601131439209
Epoch: 9, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0575647354125977
Epoch: 10, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 1.0641224384307861
Epoch: 11, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 1.0128552913665771
Epoch: 12, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.9811930656433105
Epoch: 13, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.9397728443145752
Epoch: 14, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.8829751014709473
Epoch: 15, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.9912941455841064
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.9612343311309814
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9743716716766357
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9756495952606201
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9906387329101562
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.989342212677002
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.981386661529541
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.002795696258545
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.8938450813293457
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.9472646713256836
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9902465343475342
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9214379787445068
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9541831016540527
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9832100868225098
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.9513144493103027
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.9518172740936279
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.8757984638214111
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1310336589813232
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9316422939300537
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 1.0071258544921875
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.964186429977417
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0475265979766846
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.0401654243469238
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.0052030086517334
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9833784103393555
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.9962010383605957
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.9235265254974365
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 1.0819292068481445
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0706791877746582
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.021819829940796
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0506632328033447
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.1051297187805176
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 1.0294904708862305
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.9636898040771484
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 1.0254554748535156
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 1.0267584323883057
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 1.0794739723205566
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 1.2372243404388428
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.1280488967895508
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.0854871273040771
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.1734271049499512
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 0.9861769676208496
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 1.057377576828003
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 1.0493361949920654
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.9794936180114746
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 0.9267244338989258
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 62 cost time: 1.0432651042938232
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 0.9634552001953125
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.0273737907409668
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.008007526397705
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.9759066104888916
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 1.037541389465332
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.0130136013031006
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 1.0147595405578613
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 0.998131275177002
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.9106056690216064
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.9261958599090576
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.9615609645843506
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 74 cost time: 1.0534296035766602
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 75 cost time: 0.9705290794372559
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 76 cost time: 0.9487466812133789
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.945225715637207
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.0795812606811523
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 79 cost time: 0.9261884689331055
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.9483444690704346
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.0096685886383057
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.0136511325836182
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 1.0012822151184082
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.938535213470459
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 85 cost time: 1.006554365158081
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.0369229316711426
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.0262260437011719
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 88 cost time: 1.0586106777191162
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 89 cost time: 1.0917704105377197
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 90 cost time: 0.9860260486602783
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 91 cost time: 1.0791316032409668
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 92 cost time: 1.01432466506958
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 93 cost time: 1.0934767723083496
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.008603811264038
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.0338830947875977
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 1.0250775814056396
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 0.9310674667358398
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 0.9100887775421143
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 99 cost time: 1.0295703411102295
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 100 cost time: 0.9852612018585205
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm128_nh16_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 352588
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5781753063201904
Epoch: 1, Steps: 7 | Train Loss: 2.544 Vali Loss: 2.282 Vali Acc: 0.125 Test Loss: 2.282 Test Acc: 0.125
Validation loss decreased (inf --> -0.124977).  Saving model ...
Epoch: 2 cost time: 1.7534751892089844
Epoch: 2, Steps: 7 | Train Loss: 1.884 Vali Loss: 1.388 Vali Acc: 0.778 Test Loss: 1.388 Test Acc: 0.778
Validation loss decreased (-0.124977 --> -0.777764).  Saving model ...
Epoch: 3 cost time: 1.9001846313476562
Epoch: 3, Steps: 7 | Train Loss: 0.844 Vali Loss: 0.721 Vali Acc: 0.889 Test Loss: 0.721 Test Acc: 0.889
Validation loss decreased (-0.777764 --> -0.888882).  Saving model ...
Epoch: 4 cost time: 1.736584186553955
Epoch: 4, Steps: 7 | Train Loss: 0.299 Vali Loss: 0.406 Vali Acc: 0.889 Test Loss: 0.406 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888885).  Saving model ...
Epoch: 5 cost time: 1.6525189876556396
Epoch: 5, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 1.7684612274169922
Epoch: 6, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.383 Vali Acc: 0.903 Test Loss: 0.383 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7487692832946777
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.744720458984375
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.7320852279663086
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.763209581375122
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 1.5739305019378662
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4987521171569824
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 1.42803955078125
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3370075225830078
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.571455717086792
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4347093105316162
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.400019645690918
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.637617588043213
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5200047492980957
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6279051303863525
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7025141716003418
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5622973442077637
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 516044
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.741615056991577
Epoch: 1, Steps: 7 | Train Loss: 2.711 Vali Loss: 2.420 Vali Acc: 0.069 Test Loss: 2.420 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 1.7443938255310059
Epoch: 2, Steps: 7 | Train Loss: 2.163 Vali Loss: 1.728 Vali Acc: 0.597 Test Loss: 1.728 Test Acc: 0.597
Validation loss decreased (-0.069420 --> -0.597205).  Saving model ...
Epoch: 3 cost time: 1.968606948852539
Epoch: 3, Steps: 7 | Train Loss: 1.416 Vali Loss: 1.073 Vali Acc: 0.792 Test Loss: 1.073 Test Acc: 0.792
Validation loss decreased (-0.597205 --> -0.791656).  Saving model ...
Epoch: 4 cost time: 1.7600774765014648
Epoch: 4, Steps: 7 | Train Loss: 0.670 Vali Loss: 0.587 Vali Acc: 0.903 Test Loss: 0.587 Test Acc: 0.903
Validation loss decreased (-0.791656 --> -0.902772).  Saving model ...
Epoch: 5 cost time: 1.7960641384124756
Epoch: 5, Steps: 7 | Train Loss: 0.267 Vali Loss: 0.426 Vali Acc: 0.889 Test Loss: 0.426 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.868535041809082
Epoch: 6, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 1.6677474975585938
Epoch: 7, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.8433520793914795
Epoch: 8, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.6534044742584229
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.7654762268066406
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7296991348266602
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6391310691833496
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7623167037963867
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6938226222991943
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.924773931503296
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4917511940002441
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.425304889678955
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6075479984283447
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3886802196502686
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 333644
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.758883476257324
Epoch: 1, Steps: 7 | Train Loss: 2.710 Vali Loss: 2.520 Vali Acc: 0.083 Test Loss: 2.520 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 1.5937669277191162
Epoch: 2, Steps: 7 | Train Loss: 2.374 Vali Loss: 2.060 Vali Acc: 0.361 Test Loss: 2.060 Test Acc: 0.361
Validation loss decreased (-0.083308 --> -0.361091).  Saving model ...
Epoch: 3 cost time: 1.7437591552734375
Epoch: 3, Steps: 7 | Train Loss: 1.749 Vali Loss: 1.486 Vali Acc: 0.667 Test Loss: 1.486 Test Acc: 0.667
Validation loss decreased (-0.361091 --> -0.666652).  Saving model ...
Epoch: 4 cost time: 1.5445308685302734
Epoch: 4, Steps: 7 | Train Loss: 1.089 Vali Loss: 1.005 Vali Acc: 0.792 Test Loss: 1.005 Test Acc: 0.792
Validation loss decreased (-0.666652 --> -0.791657).  Saving model ...
Epoch: 5 cost time: 1.766545057296753
Epoch: 5, Steps: 7 | Train Loss: 0.568 Vali Loss: 0.662 Vali Acc: 0.819 Test Loss: 0.662 Test Acc: 0.819
Validation loss decreased (-0.791657 --> -0.819438).  Saving model ...
Epoch: 6 cost time: 1.5891156196594238
Epoch: 6, Steps: 7 | Train Loss: 0.269 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
Validation loss decreased (-0.819438 --> -0.847217).  Saving model ...
Epoch: 7 cost time: 1.80153226852417
Epoch: 7, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 1.4968791007995605
Epoch: 8, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.353 Vali Acc: 0.889 Test Loss: 0.353 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 1.790403127670288
Epoch: 9, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.330 Vali Acc: 0.931 Test Loss: 0.330 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 1.5558528900146484
Epoch: 10, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6163127422332764
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.493302345275879
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6595783233642578
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6379902362823486
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.621427297592163
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7122337818145752
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.529768705368042
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.653843641281128
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.5110397338867188
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7315471172332764
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5784926414489746
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.7241630554199219
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3746452331542969
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7234547138214111
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3248562812805176
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.568098783493042
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6449131965637207
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.4028685092926025
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.796252727508545
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.836186408996582
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.8725764751434326
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 1.69862699508667
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 1.909928321838379
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8271920680999756
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8075416088104248
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7400844097137451
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.87699294090271
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 1.6971819400787354
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 1.634256362915039
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 1.5612523555755615
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 1.5338895320892334
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 1.6899893283843994
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 1.5562307834625244
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.601022720336914
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 1.9667980670928955
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 1.3559150695800781
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.8377454280853271
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 1.64613938331604
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 1.7428438663482666
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.568939447402954
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.095632553100586
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.6857631206512451
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.865447759628296
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.5017597675323486
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.5122692584991455
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.7252113819122314
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.523664951324463
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.648378610610962
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 275660
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df256_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.9452626705169678
Epoch: 1, Steps: 7 | Train Loss: 2.586 Vali Loss: 2.355 Vali Acc: 0.153 Test Loss: 2.355 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.9954345226287842
Epoch: 2, Steps: 7 | Train Loss: 2.276 Vali Loss: 1.960 Vali Acc: 0.528 Test Loss: 1.960 Test Acc: 0.528
Validation loss decreased (-0.152754 --> -0.527758).  Saving model ...
Epoch: 3 cost time: 1.0285861492156982
Epoch: 3, Steps: 7 | Train Loss: 1.752 Vali Loss: 1.480 Vali Acc: 0.750 Test Loss: 1.480 Test Acc: 0.750
Validation loss decreased (-0.527758 --> -0.749985).  Saving model ...
Epoch: 4 cost time: 1.020226240158081
Epoch: 4, Steps: 7 | Train Loss: 1.198 Vali Loss: 1.012 Vali Acc: 0.806 Test Loss: 1.012 Test Acc: 0.806
Validation loss decreased (-0.749985 --> -0.805545).  Saving model ...
Epoch: 5 cost time: 1.078890085220337
Epoch: 5, Steps: 7 | Train Loss: 0.708 Vali Loss: 0.668 Vali Acc: 0.889 Test Loss: 0.668 Test Acc: 0.889
Validation loss decreased (-0.805545 --> -0.888882).  Saving model ...
Epoch: 6 cost time: 1.0005431175231934
Epoch: 6, Steps: 7 | Train Loss: 0.390 Vali Loss: 0.483 Vali Acc: 0.917 Test Loss: 0.483 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916662).  Saving model ...
Epoch: 7 cost time: 1.1675047874450684
Epoch: 7, Steps: 7 | Train Loss: 0.187 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1194443702697754
Epoch: 8, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0466053485870361
Epoch: 9, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.021826982498169
Epoch: 10, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.9773294925689697
Epoch: 11, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.9046456813812256
Epoch: 12, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.0453708171844482
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.990558385848999
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.0459227561950684
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0620253086090088
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.950592041015625
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.927642822265625
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.029454231262207
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.9113130569458008
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.9751441478729248
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.9482989311218262
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.0600030422210693
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.901569128036499
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0264923572540283
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.099813461303711
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9973280429840088
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 0.9736785888671875
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 0.866607666015625
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 0.884401798248291
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 31 cost time: 1.0239746570587158
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 0.8368456363677979
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 0.9967629909515381
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9875528812408447
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 0.8458571434020996
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0073659420013428
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0490281581878662
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0563137531280518
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9212782382965088
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9840645790100098
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 41 cost time: 1.061009407043457
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 42 cost time: 0.9511106014251709
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 43 cost time: 1.0751783847808838
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9407219886779785
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.025139331817627
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 46 cost time: 1.117537498474121
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0009164810180664
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0200221538543701
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.029613971710205
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1055467128753662
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.1285622119903564
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0038652420043945
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.2198469638824463
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.9446892738342285
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.9478867053985596
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df256_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 245324
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8884758949279785
Epoch: 1, Steps: 7 | Train Loss: 2.652 Vali Loss: 2.685 Vali Acc: 0.056 Test Loss: 2.685 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 0.9457952976226807
Epoch: 2, Steps: 7 | Train Loss: 2.359 Vali Loss: 2.326 Vali Acc: 0.278 Test Loss: 2.326 Test Acc: 0.278
Validation loss decreased (-0.055529 --> -0.277755).  Saving model ...
Epoch: 3 cost time: 0.9673213958740234
Epoch: 3, Steps: 7 | Train Loss: 2.041 Vali Loss: 1.871 Vali Acc: 0.514 Test Loss: 1.871 Test Acc: 0.514
Validation loss decreased (-0.277755 --> -0.513870).  Saving model ...
Epoch: 4 cost time: 0.9316177368164062
Epoch: 4, Steps: 7 | Train Loss: 1.554 Vali Loss: 1.440 Vali Acc: 0.667 Test Loss: 1.440 Test Acc: 0.667
Validation loss decreased (-0.513870 --> -0.666652).  Saving model ...
Epoch: 5 cost time: 0.9802370071411133
Epoch: 5, Steps: 7 | Train Loss: 0.971 Vali Loss: 1.059 Vali Acc: 0.736 Test Loss: 1.059 Test Acc: 0.736
Validation loss decreased (-0.666652 --> -0.736101).  Saving model ...
Epoch: 6 cost time: 0.9027254581451416
Epoch: 6, Steps: 7 | Train Loss: 0.653 Vali Loss: 0.765 Vali Acc: 0.819 Test Loss: 0.765 Test Acc: 0.819
Validation loss decreased (-0.736101 --> -0.819437).  Saving model ...
Epoch: 7 cost time: 0.9095728397369385
Epoch: 7, Steps: 7 | Train Loss: 0.379 Vali Loss: 0.531 Vali Acc: 0.861 Test Loss: 0.531 Test Acc: 0.861
Validation loss decreased (-0.819437 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 1.0329246520996094
Epoch: 8, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.9165685176849365
Epoch: 9, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.9363434314727783
Epoch: 10, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.9744253158569336
Epoch: 11, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.8501276969909668
Epoch: 12, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.8621921539306641
Epoch: 13, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.0356159210205078
Epoch: 14, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9203424453735352
Epoch: 15, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9811692237854004
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0526471138000488
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8262820243835449
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.029867172241211
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.9377772808074951
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.008458137512207
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.9612116813659668
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.9470264911651611
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.040604591369629
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.00848388671875
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.04014253616333
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.1245083808898926
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.1149029731750488
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.9683949947357178
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 1.0174484252929688
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.0446407794952393
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.96524977684021
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 1.026369571685791
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.991551399230957
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 1.1166801452636719
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 1.0549466609954834
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 1.1538903713226318
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 1.0119218826293945
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 1.1077516078948975
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 1.1147124767303467
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 1.073758602142334
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 1.09735107421875
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 1.0240745544433594
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 1.0683491230010986
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 1.0430519580841064
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 1.0375330448150635
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 1.0471820831298828
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.8922431468963623
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 1.023244857788086
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 1.0211255550384521
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0106232166290283
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 0.9555723667144775
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9885203838348389
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9155163764953613
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.9885857105255127
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 56 cost time: 0.9244084358215332
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0456771850585938
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.0032093524932861
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.1002936363220215
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.0782997608184814
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.982612133026123
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.9353110790252686
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.9710021018981934
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.0345115661621094
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.9559073448181152
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 221516
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df256_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6440305709838867
Epoch: 1, Steps: 7 | Train Loss: 2.752 Vali Loss: 2.662 Vali Acc: 0.042 Test Loss: 2.662 Test Acc: 0.042
Validation loss decreased (inf --> -0.041640).  Saving model ...
Epoch: 2 cost time: 0.956674337387085
Epoch: 2, Steps: 7 | Train Loss: 2.624 Vali Loss: 2.394 Vali Acc: 0.125 Test Loss: 2.394 Test Acc: 0.125
Validation loss decreased (-0.041640 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 0.9306907653808594
Epoch: 3, Steps: 7 | Train Loss: 2.239 Vali Loss: 2.043 Vali Acc: 0.431 Test Loss: 2.043 Test Acc: 0.431
Validation loss decreased (-0.124976 --> -0.430535).  Saving model ...
Epoch: 4 cost time: 0.9872212409973145
Epoch: 4, Steps: 7 | Train Loss: 1.838 Vali Loss: 1.668 Vali Acc: 0.667 Test Loss: 1.668 Test Acc: 0.667
Validation loss decreased (-0.430535 --> -0.666650).  Saving model ...
Epoch: 5 cost time: 0.9227900505065918
Epoch: 5, Steps: 7 | Train Loss: 1.401 Vali Loss: 1.325 Vali Acc: 0.764 Test Loss: 1.325 Test Acc: 0.764
Validation loss decreased (-0.666650 --> -0.763876).  Saving model ...
Epoch: 6 cost time: 0.9443674087524414
Epoch: 6, Steps: 7 | Train Loss: 1.048 Vali Loss: 1.017 Vali Acc: 0.847 Test Loss: 1.017 Test Acc: 0.847
Validation loss decreased (-0.763876 --> -0.847212).  Saving model ...
Epoch: 7 cost time: 0.8895418643951416
Epoch: 7, Steps: 7 | Train Loss: 0.688 Vali Loss: 0.771 Vali Acc: 0.847 Test Loss: 0.771 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847215).  Saving model ...
Epoch: 8 cost time: 0.9179272651672363
Epoch: 8, Steps: 7 | Train Loss: 0.484 Vali Loss: 0.605 Vali Acc: 0.861 Test Loss: 0.605 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861105).  Saving model ...
Epoch: 9 cost time: 0.8680973052978516
Epoch: 9, Steps: 7 | Train Loss: 0.288 Vali Loss: 0.510 Vali Acc: 0.875 Test Loss: 0.510 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 10 cost time: 0.8796982765197754
Epoch: 10, Steps: 7 | Train Loss: 0.176 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 11 cost time: 0.904670000076294
Epoch: 11, Steps: 7 | Train Loss: 0.108 Vali Loss: 0.407 Vali Acc: 0.903 Test Loss: 0.407 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.8809959888458252
Epoch: 12, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.369 Vali Acc: 0.903 Test Loss: 0.369 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 0.8749959468841553
Epoch: 13, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 0.9838788509368896
Epoch: 14, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 0.877413272857666
Epoch: 15, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 0.9536495208740234
Epoch: 16, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.8679099082946777
Epoch: 17, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.9856781959533691
Epoch: 18, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.9662773609161377
Epoch: 19, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.9989440441131592
Epoch: 20, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.8879044055938721
Epoch: 21, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.9152464866638184
Epoch: 22, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.9158811569213867
Epoch: 23, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.9483397006988525
Epoch: 24, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9263150691986084
Epoch: 25, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.9030106067657471
Epoch: 26, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.9159107208251953
Epoch: 27, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.0050506591796875
Epoch: 28, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.9034547805786133
Epoch: 29, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.9178431034088135
Epoch: 30, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.9567873477935791
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.9549250602722168
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9221813678741455
Epoch: 33, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.8716421127319336
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.8327136039733887
Epoch: 35, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.9112484455108643
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.9752118587493896
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.9005146026611328
Epoch: 38, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.8416879177093506
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.949242115020752
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9409961700439453
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8425910472869873
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.9136004447937012
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.8770008087158203
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.8613245487213135
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 1.0956709384918213
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.837512731552124
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 1.0643796920776367
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9222207069396973
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.7701046466827393
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 0.8495702743530273
Epoch: 51, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8865385055541992
Epoch: 52, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 0.8584954738616943
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9504175186157227
Epoch: 54, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.8659594058990479
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.8183238506317139
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.8862478733062744
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 0.8406002521514893
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 1.0151877403259277
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.849045991897583
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 0.9369325637817383
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8835964202880859
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.0042178630828857
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.9718616008758545
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.9964706897735596
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.9779961109161377
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.986356258392334
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 68 cost time: 0.9828267097473145
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 69 cost time: 0.9471895694732666
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 70 cost time: 0.937504768371582
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 71 cost time: 0.9057681560516357
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 72 cost time: 0.9677822589874268
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 73 cost time: 0.9213306903839111
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.9828777313232422
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 75 cost time: 0.9166693687438965
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.949176549911499
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 77 cost time: 0.9716558456420898
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 78 cost time: 0.9940147399902344
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 79 cost time: 0.9231200218200684
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.8950228691101074
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.8291261196136475
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 82 cost time: 1.0048010349273682
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.9995520114898682
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.004037857055664
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 85 cost time: 0.9837987422943115
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 86 cost time: 1.1435472965240479
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.8580691814422607
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 88 cost time: 0.9972350597381592
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 89 cost time: 0.8471834659576416
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.8092129230499268
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.0395865440368652
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.9657585620880127
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 93 cost time: 0.9819052219390869
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 94 cost time: 0.930668830871582
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.9644327163696289
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 96 cost time: 0.8748397827148438
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.8595623970031738
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.9052531719207764
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.8670454025268555
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.9110603332519531
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df256_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 206924
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6078951358795166
Epoch: 1, Steps: 7 | Train Loss: 2.635 Vali Loss: 2.449 Vali Acc: 0.069 Test Loss: 2.449 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.8424699306488037
Epoch: 2, Steps: 7 | Train Loss: 2.400 Vali Loss: 2.225 Vali Acc: 0.264 Test Loss: 2.225 Test Acc: 0.264
Validation loss decreased (-0.069420 --> -0.263867).  Saving model ...
Epoch: 3 cost time: 0.8483867645263672
Epoch: 3, Steps: 7 | Train Loss: 2.077 Vali Loss: 1.919 Vali Acc: 0.486 Test Loss: 1.919 Test Acc: 0.486
Validation loss decreased (-0.263867 --> -0.486092).  Saving model ...
Epoch: 4 cost time: 0.933525562286377
Epoch: 4, Steps: 7 | Train Loss: 1.734 Vali Loss: 1.597 Vali Acc: 0.708 Test Loss: 1.597 Test Acc: 0.708
Validation loss decreased (-0.486092 --> -0.708317).  Saving model ...
Epoch: 5 cost time: 0.8820042610168457
Epoch: 5, Steps: 7 | Train Loss: 1.383 Vali Loss: 1.308 Vali Acc: 0.778 Test Loss: 1.308 Test Acc: 0.778
Validation loss decreased (-0.708317 --> -0.777765).  Saving model ...
Epoch: 6 cost time: 0.9322943687438965
Epoch: 6, Steps: 7 | Train Loss: 1.050 Vali Loss: 1.051 Vali Acc: 0.833 Test Loss: 1.051 Test Acc: 0.833
Validation loss decreased (-0.777765 --> -0.833323).  Saving model ...
Epoch: 7 cost time: 0.866060733795166
Epoch: 7, Steps: 7 | Train Loss: 0.745 Vali Loss: 0.830 Vali Acc: 0.889 Test Loss: 0.830 Test Acc: 0.889
Validation loss decreased (-0.833323 --> -0.888881).  Saving model ...
Epoch: 8 cost time: 0.9371366500854492
Epoch: 8, Steps: 7 | Train Loss: 0.506 Vali Loss: 0.664 Vali Acc: 0.903 Test Loss: 0.664 Test Acc: 0.903
Validation loss decreased (-0.888881 --> -0.902771).  Saving model ...
Epoch: 9 cost time: 0.9240741729736328
Epoch: 9, Steps: 7 | Train Loss: 0.334 Vali Loss: 0.547 Vali Acc: 0.931 Test Loss: 0.547 Test Acc: 0.931
Validation loss decreased (-0.902771 --> -0.930550).  Saving model ...
Epoch: 10 cost time: 0.8180506229400635
Epoch: 10, Steps: 7 | Train Loss: 0.233 Vali Loss: 0.472 Vali Acc: 0.917 Test Loss: 0.472 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9458653926849365
Epoch: 11, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.426 Vali Acc: 0.917 Test Loss: 0.426 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.849036693572998
Epoch: 12, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.405 Vali Acc: 0.917 Test Loss: 0.405 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9810950756072998
Epoch: 13, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9202513694763184
Epoch: 14, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9276986122131348
Epoch: 15, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9070115089416504
Epoch: 16, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9180452823638916
Epoch: 17, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9231953620910645
Epoch: 18, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9648838043212891
Epoch: 19, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 201548
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.289637804031372
Epoch: 1, Steps: 7 | Train Loss: 2.640 Vali Loss: 2.342 Vali Acc: 0.194 Test Loss: 2.342 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 1.3064873218536377
Epoch: 2, Steps: 7 | Train Loss: 1.910 Vali Loss: 1.442 Vali Acc: 0.653 Test Loss: 1.442 Test Acc: 0.653
Validation loss decreased (-0.194421 --> -0.652763).  Saving model ...
Epoch: 3 cost time: 1.193899154663086
Epoch: 3, Steps: 7 | Train Loss: 1.007 Vali Loss: 0.832 Vali Acc: 0.819 Test Loss: 0.832 Test Acc: 0.819
Validation loss decreased (-0.652763 --> -0.819436).  Saving model ...
Epoch: 4 cost time: 1.2200510501861572
Epoch: 4, Steps: 7 | Train Loss: 0.394 Vali Loss: 0.452 Vali Acc: 0.889 Test Loss: 0.452 Test Acc: 0.889
Validation loss decreased (-0.819436 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 1.2108640670776367
Epoch: 5, Steps: 7 | Train Loss: 0.162 Vali Loss: 0.445 Vali Acc: 0.889 Test Loss: 0.445 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 1.2599961757659912
Epoch: 6, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.266 Vali Acc: 0.958 Test Loss: 0.266 Test Acc: 0.958
Validation loss decreased (-0.888884 --> -0.958331).  Saving model ...
Epoch: 7 cost time: 1.3005332946777344
Epoch: 7, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.323 Vali Acc: 0.875 Test Loss: 0.323 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2369577884674072
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1953346729278564
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1609210968017578
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2593200206756592
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3090548515319824
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2519490718841553
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1699600219726562
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2440640926361084
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3191947937011719
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 466508
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3976829051971436
Epoch: 1, Steps: 7 | Train Loss: 2.482 Vali Loss: 2.181 Vali Acc: 0.278 Test Loss: 2.181 Test Acc: 0.278
Validation loss decreased (inf --> -0.277756).  Saving model ...
Epoch: 2 cost time: 1.6026487350463867
Epoch: 2, Steps: 7 | Train Loss: 1.948 Vali Loss: 1.560 Vali Acc: 0.708 Test Loss: 1.560 Test Acc: 0.708
Validation loss decreased (-0.277756 --> -0.708318).  Saving model ...
Epoch: 3 cost time: 1.6613919734954834
Epoch: 3, Steps: 7 | Train Loss: 1.266 Vali Loss: 0.965 Vali Acc: 0.889 Test Loss: 0.965 Test Acc: 0.889
Validation loss decreased (-0.708318 --> -0.888879).  Saving model ...
Epoch: 4 cost time: 1.746084451675415
Epoch: 4, Steps: 7 | Train Loss: 0.603 Vali Loss: 0.578 Vali Acc: 0.931 Test Loss: 0.578 Test Acc: 0.931
Validation loss decreased (-0.888879 --> -0.930550).  Saving model ...
Epoch: 5 cost time: 1.577176809310913
Epoch: 5, Steps: 7 | Train Loss: 0.262 Vali Loss: 0.393 Vali Acc: 0.917 Test Loss: 0.393 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7301766872406006
Epoch: 6, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.279 Vali Acc: 0.958 Test Loss: 0.279 Test Acc: 0.958
Validation loss decreased (-0.930550 --> -0.958331).  Saving model ...
Epoch: 7 cost time: 1.5365452766418457
Epoch: 7, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.526688814163208
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6524462699890137
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6336021423339844
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 11 cost time: 1.5880298614501953
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 1.6195752620697021
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 1.5885460376739502
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 14 cost time: 1.6916284561157227
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 15 cost time: 1.693049669265747
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 16 cost time: 1.6054296493530273
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7553043365478516
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.724231243133545
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 19 cost time: 1.6692290306091309
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 20 cost time: 1.531120777130127
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 21 cost time: 1.4137670993804932
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 22 cost time: 1.5044097900390625
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 23 cost time: 1.4403586387634277
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 1.6869678497314453
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8704097270965576
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.615229606628418
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8414530754089355
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 1.6148693561553955
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 1.7232561111450195
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 1.7610046863555908
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6501452922821045
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 32 cost time: 1.6119654178619385
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 33 cost time: 1.7122716903686523
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.634521245956421
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7819044589996338
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 1.8104095458984375
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 1.6785922050476074
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.926677942276001
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.7796611785888672
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8952088356018066
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.6579961776733398
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6497862339019775
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.767918586730957
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 1.66563081741333
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 1.657536268234253
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 1.6393651962280273
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.8580362796783447
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.7961950302124023
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.8271684646606445
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.758664608001709
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.7916102409362793
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 52 cost time: 1.7680225372314453
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 1.8547701835632324
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.8056745529174805
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.6581151485443115
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.6610808372497559
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.728914499282837
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 58 cost time: 1.5444579124450684
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 59 cost time: 1.5374526977539062
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 60 cost time: 1.5771429538726807
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.6307876110076904
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.640695571899414
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.6828505992889404
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.6871917247772217
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.6591293811798096
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.661332368850708
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.5887324810028076
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.7397782802581787
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.605987310409546
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 284108
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.294480323791504
Epoch: 1, Steps: 7 | Train Loss: 2.716 Vali Loss: 2.504 Vali Acc: 0.083 Test Loss: 2.504 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 1.5822076797485352
Epoch: 2, Steps: 7 | Train Loss: 2.250 Vali Loss: 2.000 Vali Acc: 0.500 Test Loss: 2.000 Test Acc: 0.500
Validation loss decreased (-0.083308 --> -0.499980).  Saving model ...
Epoch: 3 cost time: 1.286787748336792
Epoch: 3, Steps: 7 | Train Loss: 1.645 Vali Loss: 1.437 Vali Acc: 0.694 Test Loss: 1.437 Test Acc: 0.694
Validation loss decreased (-0.499980 --> -0.694430).  Saving model ...
Epoch: 4 cost time: 1.5768647193908691
Epoch: 4, Steps: 7 | Train Loss: 1.087 Vali Loss: 0.948 Vali Acc: 0.778 Test Loss: 0.948 Test Acc: 0.778
Validation loss decreased (-0.694430 --> -0.777768).  Saving model ...
Epoch: 5 cost time: 1.631974220275879
Epoch: 5, Steps: 7 | Train Loss: 0.579 Vali Loss: 0.637 Vali Acc: 0.875 Test Loss: 0.637 Test Acc: 0.875
Validation loss decreased (-0.777768 --> -0.874994).  Saving model ...
Epoch: 6 cost time: 1.6726248264312744
Epoch: 6, Steps: 7 | Train Loss: 0.280 Vali Loss: 0.458 Vali Acc: 0.861 Test Loss: 0.458 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5488243103027344
Epoch: 7, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 1.5052852630615234
Epoch: 8, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 1.5780115127563477
Epoch: 9, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4606077671051025
Epoch: 10, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 1.4738168716430664
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 1.3811819553375244
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.5414834022521973
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 1.5586421489715576
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5389533042907715
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.602893590927124
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5295133590698242
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5275890827178955
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.547217607498169
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.46187424659729
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5905861854553223
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4697847366333008
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5697247982025146
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 226124
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df128_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.165480613708496
Epoch: 1, Steps: 7 | Train Loss: 2.632 Vali Loss: 2.486 Vali Acc: 0.111 Test Loss: 2.486 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.9369347095489502
Epoch: 2, Steps: 7 | Train Loss: 2.309 Vali Loss: 2.094 Vali Acc: 0.431 Test Loss: 2.094 Test Acc: 0.431
Validation loss decreased (-0.111086 --> -0.430535).  Saving model ...
Epoch: 3 cost time: 0.965400218963623
Epoch: 3, Steps: 7 | Train Loss: 1.756 Vali Loss: 1.610 Vali Acc: 0.681 Test Loss: 1.610 Test Acc: 0.681
Validation loss decreased (-0.430535 --> -0.680539).  Saving model ...
Epoch: 4 cost time: 0.9651806354522705
Epoch: 4, Steps: 7 | Train Loss: 1.232 Vali Loss: 1.129 Vali Acc: 0.764 Test Loss: 1.129 Test Acc: 0.764
Validation loss decreased (-0.680539 --> -0.763878).  Saving model ...
Epoch: 5 cost time: 0.9248688220977783
Epoch: 5, Steps: 7 | Train Loss: 0.767 Vali Loss: 0.778 Vali Acc: 0.861 Test Loss: 0.778 Test Acc: 0.861
Validation loss decreased (-0.763878 --> -0.861103).  Saving model ...
Epoch: 6 cost time: 1.034813642501831
Epoch: 6, Steps: 7 | Train Loss: 0.398 Vali Loss: 0.552 Vali Acc: 0.875 Test Loss: 0.552 Test Acc: 0.875
Validation loss decreased (-0.861103 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 1.0157885551452637
Epoch: 7, Steps: 7 | Train Loss: 0.187 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.9404685497283936
Epoch: 8, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9680500030517578
Epoch: 9, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.395 Vali Acc: 0.861 Test Loss: 0.395 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9837570190429688
Epoch: 10, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.368 Vali Acc: 0.861 Test Loss: 0.368 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0156238079071045
Epoch: 11, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.9907572269439697
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 0.8985550403594971
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.0867424011230469
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0416719913482666
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0330443382263184
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.273 Vali Acc: 0.875 Test Loss: 0.273 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0063679218292236
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.9087471961975098
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.9966869354248047
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.9767780303955078
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 1.0312995910644531
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 1.1130859851837158
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9901175498962402
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 1.0280334949493408
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.927485466003418
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.9929919242858887
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 27 cost time: 0.9129903316497803
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 28 cost time: 0.9731321334838867
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 29 cost time: 0.9031636714935303
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8661692142486572
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9542326927185059
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 32 cost time: 0.9125819206237793
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9696357250213623
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.939328670501709
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9250903129577637
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.889 Test Loss: 0.222 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9575531482696533
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.889 Test Loss: 0.223 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.933349609375
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.889 Test Loss: 0.220 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.018826961517334
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.889 Test Loss: 0.217 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.957240104675293
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 40 cost time: 0.9999289512634277
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.889 Test Loss: 0.216 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9106936454772949
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.889 Test Loss: 0.214 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8931214809417725
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.889 Test Loss: 0.211 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.007751226425171
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.889 Test Loss: 0.208 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9233849048614502
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.889 Test Loss: 0.209 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9379987716674805
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.889 Test Loss: 0.208 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9126992225646973
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.889 Test Loss: 0.208 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9112892150878906
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.889 Test Loss: 0.207 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0239214897155762
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.889 Test Loss: 0.207 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9116384983062744
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.889 Test Loss: 0.204 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df128_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 195788
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.455454111099243
Epoch: 1, Steps: 7 | Train Loss: 2.562 Vali Loss: 2.463 Vali Acc: 0.125 Test Loss: 2.463 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 1.0377824306488037
Epoch: 2, Steps: 7 | Train Loss: 2.444 Vali Loss: 2.170 Vali Acc: 0.333 Test Loss: 2.170 Test Acc: 0.333
Validation loss decreased (-0.124975 --> -0.333312).  Saving model ...
Epoch: 3 cost time: 1.0435259342193604
Epoch: 3, Steps: 7 | Train Loss: 2.020 Vali Loss: 1.790 Vali Acc: 0.625 Test Loss: 1.790 Test Acc: 0.625
Validation loss decreased (-0.333312 --> -0.624982).  Saving model ...
Epoch: 4 cost time: 0.8933119773864746
Epoch: 4, Steps: 7 | Train Loss: 1.570 Vali Loss: 1.383 Vali Acc: 0.806 Test Loss: 1.383 Test Acc: 0.806
Validation loss decreased (-0.624982 --> -0.805542).  Saving model ...
Epoch: 5 cost time: 0.8708372116088867
Epoch: 5, Steps: 7 | Train Loss: 1.101 Vali Loss: 1.019 Vali Acc: 0.847 Test Loss: 1.019 Test Acc: 0.847
Validation loss decreased (-0.805542 --> -0.847212).  Saving model ...
Epoch: 6 cost time: 0.9376060962677002
Epoch: 6, Steps: 7 | Train Loss: 0.736 Vali Loss: 0.734 Vali Acc: 0.861 Test Loss: 0.734 Test Acc: 0.861
Validation loss decreased (-0.847212 --> -0.861104).  Saving model ...
Epoch: 7 cost time: 0.9653725624084473
Epoch: 7, Steps: 7 | Train Loss: 0.452 Vali Loss: 0.532 Vali Acc: 0.889 Test Loss: 0.532 Test Acc: 0.889
Validation loss decreased (-0.861104 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.8253824710845947
Epoch: 8, Steps: 7 | Train Loss: 0.251 Vali Loss: 0.433 Vali Acc: 0.889 Test Loss: 0.433 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.8880784511566162
Epoch: 9, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9394416809082031
Epoch: 10, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 0.8943898677825928
Epoch: 11, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9978058338165283
Epoch: 12, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.9302830696105957
Epoch: 13, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.9793460369110107
Epoch: 14, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.9408910274505615
Epoch: 15, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.9120080471038818
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 1.032743215560913
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 1.0070133209228516
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9573197364807129
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.9066212177276611
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.9122776985168457
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.9170489311218262
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.0567090511322021
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.9757192134857178
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.9157781600952148
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.9569611549377441
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9377233982086182
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.0028126239776611
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.9180026054382324
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8814303874969482
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.941903829574585
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 32 cost time: 0.8858540058135986
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.9652118682861328
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9388208389282227
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.9360840320587158
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8769712448120117
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9045403003692627
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9773619174957275
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8767223358154297
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.8683924674987793
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.9049513339996338
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8271636962890625
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.9110310077667236
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9145317077636719
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9210703372955322
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.959099531173706
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9478754997253418
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1111576557159424
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.0524845123291016
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.9477388858795166
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.9184198379516602
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 0.939208984375
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9306995868682861
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 54 cost time: 0.9532217979431152
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0688378810882568
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 56 cost time: 0.9411141872406006
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958331).  Saving model ...
Epoch: 57 cost time: 0.9207119941711426
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9679586887359619
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 59 cost time: 0.8517334461212158
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9376859664916992
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9614746570587158
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.976872444152832
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.9267933368682861
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.9604396820068359
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.0192241668701172
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 66 cost time: 0.9253261089324951
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.073141098022461
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 68 cost time: 0.9575531482696533
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9682621955871582
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.9805636405944824
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.963120698928833
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.939300537109375
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.923961877822876
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.8839693069458008
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.9097933769226074
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 76 cost time: 0.935032844543457
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 77 cost time: 0.9831507205963135
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 78 cost time: 0.9445977210998535
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 79 cost time: 0.9087874889373779
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 80 cost time: 0.9129645824432373
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.910170316696167
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.9474825859069824
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.0114810466766357
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.919489860534668
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.9179730415344238
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.8996672630310059
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 0.8824632167816162
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 0.9854459762573242
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 89 cost time: 0.9062635898590088
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 90 cost time: 0.9472389221191406
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.8543286323547363
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.9019927978515625
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 1.0793554782867432
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 94 cost time: 1.04667067527771
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 95 cost time: 0.9859921932220459
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.9345724582672119
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.8987104892730713
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 0.9830970764160156
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 99 cost time: 0.9015398025512695
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 100 cost time: 1.0282912254333496
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 171980
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df128_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7208411693573
Epoch: 1, Steps: 7 | Train Loss: 2.581 Vali Loss: 2.423 Vali Acc: 0.069 Test Loss: 2.423 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.9380078315734863
Epoch: 2, Steps: 7 | Train Loss: 2.448 Vali Loss: 2.214 Vali Acc: 0.167 Test Loss: 2.214 Test Acc: 0.167
Validation loss decreased (-0.069420 --> -0.166645).  Saving model ...
Epoch: 3 cost time: 0.9119741916656494
Epoch: 3, Steps: 7 | Train Loss: 2.127 Vali Loss: 1.920 Vali Acc: 0.500 Test Loss: 1.920 Test Acc: 0.500
Validation loss decreased (-0.166645 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 0.9724719524383545
Epoch: 4, Steps: 7 | Train Loss: 1.756 Vali Loss: 1.590 Vali Acc: 0.639 Test Loss: 1.590 Test Acc: 0.639
Validation loss decreased (-0.499981 --> -0.638873).  Saving model ...
Epoch: 5 cost time: 0.9422881603240967
Epoch: 5, Steps: 7 | Train Loss: 1.390 Vali Loss: 1.283 Vali Acc: 0.750 Test Loss: 1.283 Test Acc: 0.750
Validation loss decreased (-0.638873 --> -0.749987).  Saving model ...
Epoch: 6 cost time: 0.8807530403137207
Epoch: 6, Steps: 7 | Train Loss: 0.987 Vali Loss: 0.993 Vali Acc: 0.847 Test Loss: 0.993 Test Acc: 0.847
Validation loss decreased (-0.749987 --> -0.847212).  Saving model ...
Epoch: 7 cost time: 0.9327805042266846
Epoch: 7, Steps: 7 | Train Loss: 0.667 Vali Loss: 0.764 Vali Acc: 0.861 Test Loss: 0.764 Test Acc: 0.861
Validation loss decreased (-0.847212 --> -0.861103).  Saving model ...
Epoch: 8 cost time: 0.9359102249145508
Epoch: 8, Steps: 7 | Train Loss: 0.453 Vali Loss: 0.589 Vali Acc: 0.889 Test Loss: 0.589 Test Acc: 0.889
Validation loss decreased (-0.861103 --> -0.888883).  Saving model ...
Epoch: 9 cost time: 0.936408519744873
Epoch: 9, Steps: 7 | Train Loss: 0.287 Vali Loss: 0.477 Vali Acc: 0.917 Test Loss: 0.477 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916662).  Saving model ...
Epoch: 10 cost time: 0.9747223854064941
Epoch: 10, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.421 Vali Acc: 0.889 Test Loss: 0.421 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9293746948242188
Epoch: 11, Steps: 7 | Train Loss: 0.122 Vali Loss: 0.389 Vali Acc: 0.903 Test Loss: 0.389 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.005711317062378
Epoch: 12, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.038316011428833
Epoch: 13, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 0.9053289890289307
Epoch: 14, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.9431109428405762
Epoch: 15, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.9291939735412598
Epoch: 16, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.9516253471374512
Epoch: 17, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.8714652061462402
Epoch: 18, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8929319381713867
Epoch: 19, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8890604972839355
Epoch: 20, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9387857913970947
Epoch: 21, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.092742681503296
Epoch: 22, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.8951365947723389
Epoch: 23, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.9023890495300293
Epoch: 24, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.950859785079956
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.9784910678863525
Epoch: 26, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.8978643417358398
Epoch: 27, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.8666856288909912
Epoch: 28, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.9106080532073975
Epoch: 29, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.9292786121368408
Epoch: 30, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.9692609310150146
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.8722953796386719
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.9207253456115723
Epoch: 33, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.8821308612823486
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.9882845878601074
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.943129301071167
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.9474656581878662
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9582259654998779
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9371647834777832
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.9639379978179932
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.938453197479248
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.9525620937347412
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.9645771980285645
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.8642759323120117
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 1.0027167797088623
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.8970229625701904
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.9447758197784424
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.9369039535522461
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.8878598213195801
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.067305326461792
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9184422492980957
Epoch: 51, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.0110461711883545
Epoch: 52, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.9761488437652588
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.9688818454742432
Epoch: 54, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.0078096389770508
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.8380424976348877
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.9359583854675293
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.9637241363525391
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df128_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 157388
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8964309692382812
Epoch: 1, Steps: 7 | Train Loss: 2.593 Vali Loss: 2.526 Vali Acc: 0.194 Test Loss: 2.526 Test Acc: 0.194
Validation loss decreased (inf --> -0.194419).  Saving model ...
Epoch: 2 cost time: 0.8373706340789795
Epoch: 2, Steps: 7 | Train Loss: 2.367 Vali Loss: 2.327 Vali Acc: 0.222 Test Loss: 2.327 Test Acc: 0.222
Validation loss decreased (-0.194419 --> -0.222199).  Saving model ...
Epoch: 3 cost time: 0.9230997562408447
Epoch: 3, Steps: 7 | Train Loss: 2.088 Vali Loss: 2.071 Vali Acc: 0.431 Test Loss: 2.071 Test Acc: 0.431
Validation loss decreased (-0.222199 --> -0.430535).  Saving model ...
Epoch: 4 cost time: 0.8459196090698242
Epoch: 4, Steps: 7 | Train Loss: 1.831 Vali Loss: 1.790 Vali Acc: 0.583 Test Loss: 1.790 Test Acc: 0.583
Validation loss decreased (-0.430535 --> -0.583315).  Saving model ...
Epoch: 5 cost time: 0.9493303298950195
Epoch: 5, Steps: 7 | Train Loss: 1.467 Vali Loss: 1.504 Vali Acc: 0.681 Test Loss: 1.504 Test Acc: 0.681
Validation loss decreased (-0.583315 --> -0.680541).  Saving model ...
Epoch: 6 cost time: 0.8981993198394775
Epoch: 6, Steps: 7 | Train Loss: 1.150 Vali Loss: 1.218 Vali Acc: 0.778 Test Loss: 1.218 Test Acc: 0.778
Validation loss decreased (-0.680541 --> -0.777766).  Saving model ...
Epoch: 7 cost time: 1.0201029777526855
Epoch: 7, Steps: 7 | Train Loss: 0.822 Vali Loss: 0.975 Vali Acc: 0.778 Test Loss: 0.975 Test Acc: 0.778
Validation loss decreased (-0.777766 --> -0.777768).  Saving model ...
Epoch: 8 cost time: 0.9470527172088623
Epoch: 8, Steps: 7 | Train Loss: 0.563 Vali Loss: 0.802 Vali Acc: 0.806 Test Loss: 0.802 Test Acc: 0.806
Validation loss decreased (-0.777768 --> -0.805548).  Saving model ...
Epoch: 9 cost time: 0.9165253639221191
Epoch: 9, Steps: 7 | Train Loss: 0.391 Vali Loss: 0.654 Vali Acc: 0.819 Test Loss: 0.654 Test Acc: 0.819
Validation loss decreased (-0.805548 --> -0.819438).  Saving model ...
Epoch: 10 cost time: 0.9921200275421143
Epoch: 10, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.549 Vali Acc: 0.847 Test Loss: 0.549 Test Acc: 0.847
Validation loss decreased (-0.819438 --> -0.847217).  Saving model ...
Epoch: 11 cost time: 0.8857674598693848
Epoch: 11, Steps: 7 | Train Loss: 0.180 Vali Loss: 0.482 Vali Acc: 0.861 Test Loss: 0.482 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861106).  Saving model ...
Epoch: 12 cost time: 0.8684406280517578
Epoch: 12, Steps: 7 | Train Loss: 0.126 Vali Loss: 0.431 Vali Acc: 0.847 Test Loss: 0.431 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0207605361938477
Epoch: 13, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.400 Vali Acc: 0.861 Test Loss: 0.400 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 0.9043891429901123
Epoch: 14, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.393 Vali Acc: 0.861 Test Loss: 0.393 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 0.8805229663848877
Epoch: 15, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.374 Vali Acc: 0.861 Test Loss: 0.374 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 16 cost time: 0.825890064239502
Epoch: 16, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.360 Vali Acc: 0.861 Test Loss: 0.360 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 0.9325757026672363
Epoch: 17, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874996).  Saving model ...
Epoch: 18 cost time: 0.9245402812957764
Epoch: 18, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 19 cost time: 0.9275248050689697
Epoch: 19, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0014679431915283
Epoch: 20, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.9147396087646484
Epoch: 21, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.883793830871582
Epoch: 22, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.8661360740661621
Epoch: 23, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.8927192687988281
Epoch: 24, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9111595153808594
Epoch: 25, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.944385290145874
Epoch: 26, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8854787349700928
Epoch: 27, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9363613128662109
Epoch: 28, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9683761596679688
Epoch: 29, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8521287441253662
Epoch: 30, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0260241031646729
Epoch: 31, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8796861171722412
Epoch: 32, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0782461166381836
Epoch: 33, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 152012
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8021152019500732
Epoch: 1, Steps: 7 | Train Loss: 2.531 Vali Loss: 2.290 Vali Acc: 0.250 Test Loss: 2.290 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 1.6099085807800293
Epoch: 2, Steps: 7 | Train Loss: 1.813 Vali Loss: 1.388 Vali Acc: 0.736 Test Loss: 1.388 Test Acc: 0.736
Validation loss decreased (-0.249977 --> -0.736097).  Saving model ...
Epoch: 3 cost time: 1.3772993087768555
Epoch: 3, Steps: 7 | Train Loss: 0.876 Vali Loss: 0.715 Vali Acc: 0.875 Test Loss: 0.715 Test Acc: 0.875
Validation loss decreased (-0.736097 --> -0.874993).  Saving model ...
Epoch: 4 cost time: 2.014500856399536
Epoch: 4, Steps: 7 | Train Loss: 0.253 Vali Loss: 0.379 Vali Acc: 0.917 Test Loss: 0.379 Test Acc: 0.917
Validation loss decreased (-0.874993 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 1.7049403190612793
Epoch: 5, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.72676420211792
Epoch: 6, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 1.8552043437957764
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7526342868804932
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.7737860679626465
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.885418176651001
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 1.8536975383758545
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 1.6129124164581299
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 1.736710548400879
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 1.8118617534637451
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7227039337158203
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.50077486038208
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4743678569793701
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6602692604064941
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 19 cost time: 1.7447302341461182
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 20 cost time: 1.7167315483093262
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 21 cost time: 1.7651374340057373
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7760145664215088
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6150152683258057
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7364795207977295
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6974992752075195
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 1.7975926399230957
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 1.677776575088501
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 1.6812334060668945
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6924562454223633
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7102622985839844
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7983384132385254
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.804823637008667
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.729264259338379
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6460998058319092
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.6746656894683838
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.9023592472076416
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 1.7113494873046875
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 38 cost time: 1.5653605461120605
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 1.5505235195159912
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 1.6117944717407227
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 1.3574626445770264
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 1.3398759365081787
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.7727344036102295
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.5725140571594238
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 1.5257093906402588
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 1.712259292602539
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 1.9888923168182373
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 1.8886268138885498
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 1.6543076038360596
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 1.7118561267852783
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.6639761924743652
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 52 cost time: 1.9334814548492432
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 2.006237030029297
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 54 cost time: 1.8576538562774658
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.738161325454712
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 56 cost time: 1.695288896560669
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 57 cost time: 1.640916109085083
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.563633680343628
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.405561923980713
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.4959673881530762
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.6417925357818604
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.6571812629699707
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.7500114440917969
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.7124884128570557
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.6914043426513672
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.4760496616363525
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 441740
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.001755952835083
Epoch: 1, Steps: 7 | Train Loss: 2.580 Vali Loss: 2.432 Vali Acc: 0.125 Test Loss: 2.432 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 1.4914488792419434
Epoch: 2, Steps: 7 | Train Loss: 2.111 Vali Loss: 1.734 Vali Acc: 0.583 Test Loss: 1.734 Test Acc: 0.583
Validation loss decreased (-0.124976 --> -0.583316).  Saving model ...
Epoch: 3 cost time: 1.5532643795013428
Epoch: 3, Steps: 7 | Train Loss: 1.333 Vali Loss: 1.075 Vali Acc: 0.764 Test Loss: 1.075 Test Acc: 0.764
Validation loss decreased (-0.583316 --> -0.763878).  Saving model ...
Epoch: 4 cost time: 1.373157262802124
Epoch: 4, Steps: 7 | Train Loss: 0.672 Vali Loss: 0.640 Vali Acc: 0.889 Test Loss: 0.640 Test Acc: 0.889
Validation loss decreased (-0.763878 --> -0.888882).  Saving model ...
Epoch: 5 cost time: 1.3011353015899658
Epoch: 5, Steps: 7 | Train Loss: 0.279 Vali Loss: 0.429 Vali Acc: 0.903 Test Loss: 0.429 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902773).  Saving model ...
Epoch: 6 cost time: 1.3308100700378418
Epoch: 6, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.4646477699279785
Epoch: 7, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 1.3880808353424072
Epoch: 8, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 1.2791991233825684
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2389116287231445
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.2597591876983643
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2048885822296143
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.193100929260254
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3435118198394775
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 1.2743539810180664
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 16 cost time: 1.382788896560669
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 17 cost time: 1.4264287948608398
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 18 cost time: 1.392913579940796
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 19 cost time: 1.4053335189819336
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4534523487091064
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3244662284851074
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3231017589569092
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2960102558135986
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 1.2067749500274658
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 1.2092437744140625
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 1.3135712146759033
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 1.2948510646820068
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 1.3364386558532715
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2554419040679932
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2184791564941406
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.149461030960083
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5526175498962402
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4802052974700928
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.33744215965271
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3944306373596191
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 1.4979381561279297
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 1.4590156078338623
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4262044429779053
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.5874662399291992
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 1.39540433883667
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 1.342303991317749
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 1.4963898658752441
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2913315296173096
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.359621286392212
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.3818421363830566
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 1.3852293491363525
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 1.29036545753479
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 1.3974239826202393
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 1.4179346561431885
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 1.377551794052124
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 51 cost time: 1.3673770427703857
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 52 cost time: 1.3102002143859863
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 1.2164463996887207
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.489610195159912
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.3631048202514648
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.1436424255371094
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.1847784519195557
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 58 cost time: 1.4606552124023438
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.4300577640533447
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.5604913234710693
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.568159818649292
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.4233911037445068
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.490727424621582
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.462568759918213
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 65 cost time: 1.4146981239318848
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 66 cost time: 1.3646166324615479
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.6148147583007812
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.3537633419036865
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 69 cost time: 1.7390446662902832
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.5178186893463135
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 71 cost time: 1.6417527198791504
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.3057782649993896
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.373718023300171
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.3180625438690186
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.2302398681640625
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.2388756275177002
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.2482681274414062
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.1858506202697754
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 79 cost time: 1.237426519393921
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.3302762508392334
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.2127127647399902
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 82 cost time: 1.3525421619415283
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 83 cost time: 1.4366931915283203
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.535593032836914
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 85 cost time: 1.4558436870574951
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.2930140495300293
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 87 cost time: 1.4205846786499023
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.2989463806152344
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 89 cost time: 1.3779387474060059
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 90 cost time: 1.450477123260498
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 91 cost time: 1.3797972202301025
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 92 cost time: 1.4529526233673096
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.5339877605438232
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.4064044952392578
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 1.371546745300293
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 96 cost time: 1.34340500831604
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.9240541458129883
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 1.4207172393798828
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 1.5557193756103516
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 100 cost time: 1.55696702003479
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 259340
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.466085433959961
Epoch: 1, Steps: 7 | Train Loss: 2.566 Vali Loss: 2.345 Vali Acc: 0.153 Test Loss: 2.345 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 1.597001075744629
Epoch: 2, Steps: 7 | Train Loss: 2.236 Vali Loss: 1.906 Vali Acc: 0.528 Test Loss: 1.906 Test Acc: 0.528
Validation loss decreased (-0.152754 --> -0.527759).  Saving model ...
Epoch: 3 cost time: 1.325122356414795
Epoch: 3, Steps: 7 | Train Loss: 1.623 Vali Loss: 1.387 Vali Acc: 0.736 Test Loss: 1.387 Test Acc: 0.736
Validation loss decreased (-0.527759 --> -0.736097).  Saving model ...
Epoch: 4 cost time: 1.4001750946044922
Epoch: 4, Steps: 7 | Train Loss: 1.031 Vali Loss: 0.942 Vali Acc: 0.792 Test Loss: 0.942 Test Acc: 0.792
Validation loss decreased (-0.736097 --> -0.791657).  Saving model ...
Epoch: 5 cost time: 1.577580451965332
Epoch: 5, Steps: 7 | Train Loss: 0.536 Vali Loss: 0.653 Vali Acc: 0.847 Test Loss: 0.653 Test Acc: 0.847
Validation loss decreased (-0.791657 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 1.429600477218628
Epoch: 6, Steps: 7 | Train Loss: 0.286 Vali Loss: 0.449 Vali Acc: 0.903 Test Loss: 0.449 Test Acc: 0.903
Validation loss decreased (-0.847216 --> -0.902773).  Saving model ...
Epoch: 7 cost time: 1.4157061576843262
Epoch: 7, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 1.5036826133728027
Epoch: 8, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.353 Vali Acc: 0.889 Test Loss: 0.353 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3549799919128418
Epoch: 9, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.4466967582702637
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.335519790649414
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2789287567138672
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2828166484832764
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2735252380371094
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4385707378387451
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3698654174804688
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.4294166564941406
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.4311411380767822
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4188392162322998
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.618635892868042
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5549545288085938
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6138525009155273
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3452563285827637
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4571053981781006
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5899856090545654
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6055574417114258
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3879742622375488
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 201356
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df64_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.772961139678955
Epoch: 1, Steps: 7 | Train Loss: 2.554 Vali Loss: 2.316 Vali Acc: 0.194 Test Loss: 2.316 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 0.9008290767669678
Epoch: 2, Steps: 7 | Train Loss: 2.271 Vali Loss: 1.934 Vali Acc: 0.556 Test Loss: 1.934 Test Acc: 0.556
Validation loss decreased (-0.194421 --> -0.555536).  Saving model ...
Epoch: 3 cost time: 0.8804652690887451
Epoch: 3, Steps: 7 | Train Loss: 1.687 Vali Loss: 1.461 Vali Acc: 0.694 Test Loss: 1.461 Test Acc: 0.694
Validation loss decreased (-0.555536 --> -0.694430).  Saving model ...
Epoch: 4 cost time: 0.7879166603088379
Epoch: 4, Steps: 7 | Train Loss: 1.164 Vali Loss: 1.054 Vali Acc: 0.792 Test Loss: 1.054 Test Acc: 0.792
Validation loss decreased (-0.694430 --> -0.791656).  Saving model ...
Epoch: 5 cost time: 1.0453639030456543
Epoch: 5, Steps: 7 | Train Loss: 0.704 Vali Loss: 0.728 Vali Acc: 0.861 Test Loss: 0.728 Test Acc: 0.861
Validation loss decreased (-0.791656 --> -0.861104).  Saving model ...
Epoch: 6 cost time: 0.8173937797546387
Epoch: 6, Steps: 7 | Train Loss: 0.395 Vali Loss: 0.505 Vali Acc: 0.889 Test Loss: 0.505 Test Acc: 0.889
Validation loss decreased (-0.861104 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 0.8893053531646729
Epoch: 7, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9183154106140137
Epoch: 8, Steps: 7 | Train Loss: 0.108 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9238908290863037
Epoch: 9, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.9245271682739258
Epoch: 10, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.8706607818603516
Epoch: 11, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8515281677246094
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.8811039924621582
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.900291919708252
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.9367663860321045
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.9524059295654297
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9075362682342529
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9571752548217773
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8890407085418701
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9252157211303711
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9663114547729492
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9587554931640625
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.8367669582366943
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9688255786895752
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.831465482711792
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.893939733505249
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 1.0623292922973633
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 0.9314696788787842
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 0.9450693130493164
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 0.9667496681213379
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8865034580230713
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 1.0244238376617432
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 0.903378963470459
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 34 cost time: 1.0428791046142578
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 0.9421544075012207
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 36 cost time: 0.9062600135803223
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 37 cost time: 0.8572103977203369
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 38 cost time: 0.901648759841919
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.849553108215332
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9654102325439453
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9619910717010498
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9378552436828613
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 43 cost time: 0.8364276885986328
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 44 cost time: 0.9648833274841309
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8700411319732666
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 46 cost time: 0.9997639656066895
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 47 cost time: 0.8668687343597412
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.931 Test Loss: 0.177 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 48 cost time: 0.8413527011871338
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 49 cost time: 0.9775562286376953
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 50 cost time: 0.8385500907897949
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 0.8634817600250244
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9505617618560791
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0351390838623047
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 54 cost time: 0.8910295963287354
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9995567798614502
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8453810214996338
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.9315414428710938
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.0149040222167969
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.1008553504943848
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.8607161045074463
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.931 Test Loss: 0.172 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.9333155155181885
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.9859461784362793
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.8848066329956055
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.931 Test Loss: 0.169 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df64_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 171020
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5414299964904785
Epoch: 1, Steps: 7 | Train Loss: 2.413 Vali Loss: 2.374 Vali Acc: 0.278 Test Loss: 2.374 Test Acc: 0.278
Validation loss decreased (inf --> -0.277754).  Saving model ...
Epoch: 2 cost time: 0.8710126876831055
Epoch: 2, Steps: 7 | Train Loss: 2.185 Vali Loss: 2.120 Vali Acc: 0.375 Test Loss: 2.120 Test Acc: 0.375
Validation loss decreased (-0.277754 --> -0.374979).  Saving model ...
Epoch: 3 cost time: 0.8574988842010498
Epoch: 3, Steps: 7 | Train Loss: 1.903 Vali Loss: 1.777 Vali Acc: 0.514 Test Loss: 1.777 Test Acc: 0.514
Validation loss decreased (-0.374979 --> -0.513871).  Saving model ...
Epoch: 4 cost time: 0.8253378868103027
Epoch: 4, Steps: 7 | Train Loss: 1.451 Vali Loss: 1.396 Vali Acc: 0.694 Test Loss: 1.396 Test Acc: 0.694
Validation loss decreased (-0.513871 --> -0.694430).  Saving model ...
Epoch: 5 cost time: 0.7553396224975586
Epoch: 5, Steps: 7 | Train Loss: 0.963 Vali Loss: 1.069 Vali Acc: 0.792 Test Loss: 1.069 Test Acc: 0.792
Validation loss decreased (-0.694430 --> -0.791656).  Saving model ...
Epoch: 6 cost time: 0.780357837677002
Epoch: 6, Steps: 7 | Train Loss: 0.690 Vali Loss: 0.765 Vali Acc: 0.819 Test Loss: 0.765 Test Acc: 0.819
Validation loss decreased (-0.791656 --> -0.819437).  Saving model ...
Epoch: 7 cost time: 0.8416993618011475
Epoch: 7, Steps: 7 | Train Loss: 0.423 Vali Loss: 0.585 Vali Acc: 0.847 Test Loss: 0.585 Test Acc: 0.847
Validation loss decreased (-0.819437 --> -0.847216).  Saving model ...
Epoch: 8 cost time: 0.8013157844543457
Epoch: 8, Steps: 7 | Train Loss: 0.243 Vali Loss: 0.480 Vali Acc: 0.861 Test Loss: 0.480 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 0.8006799221038818
Epoch: 9, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 0.936093807220459
Epoch: 10, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.373 Vali Acc: 0.847 Test Loss: 0.373 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8748049736022949
Epoch: 11, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.349 Vali Acc: 0.861 Test Loss: 0.349 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9570560455322266
Epoch: 12, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8573050498962402
Epoch: 13, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 14 cost time: 0.8263883590698242
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 15 cost time: 0.8890783786773682
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 16 cost time: 0.8273653984069824
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 17 cost time: 0.9348971843719482
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 18 cost time: 0.9124610424041748
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.906508207321167
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.275 Vali Acc: 0.875 Test Loss: 0.275 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9635727405548096
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.265 Vali Acc: 0.875 Test Loss: 0.265 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9113495349884033
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.261 Vali Acc: 0.875 Test Loss: 0.261 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0100021362304688
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.875 Test Loss: 0.259 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9242062568664551
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.875 Test Loss: 0.260 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0254218578338623
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.258 Vali Acc: 0.875 Test Loss: 0.258 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0940673351287842
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.875 Test Loss: 0.256 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9404726028442383
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.875 Test Loss: 0.253 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9874832630157471
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.250 Vali Acc: 0.875 Test Loss: 0.250 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9223766326904297
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.875 Test Loss: 0.246 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 147212
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df64_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.876615524291992
Epoch: 1, Steps: 7 | Train Loss: 2.659 Vali Loss: 2.544 Vali Acc: 0.111 Test Loss: 2.544 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.9267432689666748
Epoch: 2, Steps: 7 | Train Loss: 2.447 Vali Loss: 2.339 Vali Acc: 0.250 Test Loss: 2.339 Test Acc: 0.250
Validation loss decreased (-0.111086 --> -0.249977).  Saving model ...
Epoch: 3 cost time: 0.9327404499053955
Epoch: 3, Steps: 7 | Train Loss: 2.147 Vali Loss: 2.039 Vali Acc: 0.486 Test Loss: 2.039 Test Acc: 0.486
Validation loss decreased (-0.249977 --> -0.486091).  Saving model ...
Epoch: 4 cost time: 0.8771727085113525
Epoch: 4, Steps: 7 | Train Loss: 1.781 Vali Loss: 1.709 Vali Acc: 0.625 Test Loss: 1.709 Test Acc: 0.625
Validation loss decreased (-0.486091 --> -0.624983).  Saving model ...
Epoch: 5 cost time: 0.9855456352233887
Epoch: 5, Steps: 7 | Train Loss: 1.441 Vali Loss: 1.379 Vali Acc: 0.681 Test Loss: 1.379 Test Acc: 0.681
Validation loss decreased (-0.624983 --> -0.680542).  Saving model ...
Epoch: 6 cost time: 0.9185717105865479
Epoch: 6, Steps: 7 | Train Loss: 1.040 Vali Loss: 1.088 Vali Acc: 0.736 Test Loss: 1.088 Test Acc: 0.736
Validation loss decreased (-0.680542 --> -0.736100).  Saving model ...
Epoch: 7 cost time: 0.9575276374816895
Epoch: 7, Steps: 7 | Train Loss: 0.791 Vali Loss: 0.857 Vali Acc: 0.778 Test Loss: 0.857 Test Acc: 0.778
Validation loss decreased (-0.736100 --> -0.777769).  Saving model ...
Epoch: 8 cost time: 0.9375588893890381
Epoch: 8, Steps: 7 | Train Loss: 0.522 Vali Loss: 0.685 Vali Acc: 0.792 Test Loss: 0.685 Test Acc: 0.792
Validation loss decreased (-0.777769 --> -0.791660).  Saving model ...
Epoch: 9 cost time: 0.8845374584197998
Epoch: 9, Steps: 7 | Train Loss: 0.317 Vali Loss: 0.565 Vali Acc: 0.847 Test Loss: 0.565 Test Acc: 0.847
Validation loss decreased (-0.791660 --> -0.847217).  Saving model ...
Epoch: 10 cost time: 0.9300956726074219
Epoch: 10, Steps: 7 | Train Loss: 0.213 Vali Loss: 0.489 Vali Acc: 0.847 Test Loss: 0.489 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847217).  Saving model ...
Epoch: 11 cost time: 0.8861255645751953
Epoch: 11, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.444 Vali Acc: 0.819 Test Loss: 0.444 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9595587253570557
Epoch: 12, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.392 Vali Acc: 0.889 Test Loss: 0.392 Test Acc: 0.889
Validation loss decreased (-0.847217 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 0.9321990013122559
Epoch: 13, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 1.0087971687316895
Epoch: 14, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.9076805114746094
Epoch: 15, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930552).  Saving model ...
Epoch: 16 cost time: 1.0051929950714111
Epoch: 16, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.850369930267334
Epoch: 17, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.938549280166626
Epoch: 18, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9061737060546875
Epoch: 19, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.8841850757598877
Epoch: 20, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.903606653213501
Epoch: 21, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9715425968170166
Epoch: 22, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8909282684326172
Epoch: 23, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0621373653411865
Epoch: 24, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.9663197994232178
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.8599555492401123
Epoch: 26, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.0631895065307617
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8743376731872559
Epoch: 28, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1101689338684082
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0343198776245117
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.880180835723877
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.032944917678833
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9115617275238037
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.905867338180542
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9156801700592041
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0585153102874756
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.218 Vali Acc: 0.903 Test Loss: 0.218 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df64_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 132620
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6789157390594482
Epoch: 1, Steps: 7 | Train Loss: 2.603 Vali Loss: 2.529 Vali Acc: 0.097 Test Loss: 2.529 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 1.0125772953033447
Epoch: 2, Steps: 7 | Train Loss: 2.473 Vali Loss: 2.327 Vali Acc: 0.153 Test Loss: 2.327 Test Acc: 0.153
Validation loss decreased (-0.097197 --> -0.152755).  Saving model ...
Epoch: 3 cost time: 0.8585991859436035
Epoch: 3, Steps: 7 | Train Loss: 2.152 Vali Loss: 2.053 Vali Acc: 0.278 Test Loss: 2.053 Test Acc: 0.278
Validation loss decreased (-0.152755 --> -0.277757).  Saving model ...
Epoch: 4 cost time: 0.8620121479034424
Epoch: 4, Steps: 7 | Train Loss: 1.838 Vali Loss: 1.757 Vali Acc: 0.458 Test Loss: 1.757 Test Acc: 0.458
Validation loss decreased (-0.277757 --> -0.458316).  Saving model ...
Epoch: 5 cost time: 0.9152238368988037
Epoch: 5, Steps: 7 | Train Loss: 1.505 Vali Loss: 1.457 Vali Acc: 0.681 Test Loss: 1.457 Test Acc: 0.681
Validation loss decreased (-0.458316 --> -0.680541).  Saving model ...
Epoch: 6 cost time: 0.925325870513916
Epoch: 6, Steps: 7 | Train Loss: 1.197 Vali Loss: 1.179 Vali Acc: 0.764 Test Loss: 1.179 Test Acc: 0.764
Validation loss decreased (-0.680541 --> -0.763877).  Saving model ...
Epoch: 7 cost time: 0.9307670593261719
Epoch: 7, Steps: 7 | Train Loss: 0.859 Vali Loss: 0.948 Vali Acc: 0.806 Test Loss: 0.948 Test Acc: 0.806
Validation loss decreased (-0.763877 --> -0.805546).  Saving model ...
Epoch: 8 cost time: 0.9072239398956299
Epoch: 8, Steps: 7 | Train Loss: 0.624 Vali Loss: 0.755 Vali Acc: 0.819 Test Loss: 0.755 Test Acc: 0.819
Validation loss decreased (-0.805546 --> -0.819437).  Saving model ...
Epoch: 9 cost time: 0.9115192890167236
Epoch: 9, Steps: 7 | Train Loss: 0.437 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
Validation loss decreased (-0.819437 --> -0.861105).  Saving model ...
Epoch: 10 cost time: 0.8560822010040283
Epoch: 10, Steps: 7 | Train Loss: 0.290 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8680717945098877
Epoch: 11, Steps: 7 | Train Loss: 0.199 Vali Loss: 0.476 Vali Acc: 0.861 Test Loss: 0.476 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 12 cost time: 0.7756164073944092
Epoch: 12, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.429 Vali Acc: 0.833 Test Loss: 0.429 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8507199287414551
Epoch: 13, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.401 Vali Acc: 0.847 Test Loss: 0.401 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0156378746032715
Epoch: 14, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.373 Vali Acc: 0.861 Test Loss: 0.373 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 0.7526693344116211
Epoch: 15, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.358 Vali Acc: 0.861 Test Loss: 0.358 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 16 cost time: 0.929039478302002
Epoch: 16, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 17 cost time: 0.8922767639160156
Epoch: 17, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 18 cost time: 0.9137208461761475
Epoch: 18, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8997304439544678
Epoch: 19, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 20 cost time: 0.9337360858917236
Epoch: 20, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 21 cost time: 0.9445745944976807
Epoch: 21, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 22 cost time: 0.9128749370574951
Epoch: 22, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.306 Vali Acc: 0.861 Test Loss: 0.306 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8598117828369141
Epoch: 23, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 24 cost time: 0.9328389167785645
Epoch: 24, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.9520471096038818
Epoch: 25, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.9327552318572998
Epoch: 26, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9371974468231201
Epoch: 27, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9056568145751953
Epoch: 28, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0047588348388672
Epoch: 29, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0223872661590576
Epoch: 30, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9651024341583252
Epoch: 31, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9646024703979492
Epoch: 32, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.9549441337585449
Epoch: 33, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9576416015625
Epoch: 34, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9941098690032959
Epoch: 35, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8796632289886475
Epoch: 36, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9273793697357178
Epoch: 37, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.019798755645752
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9184768199920654
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0364477634429932
Epoch: 40, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.9029698371887207
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9575750827789307
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.9977719783782959
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.9765422344207764
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.9964380264282227
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.933215856552124
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.0340986251831055
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.8524985313415527
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9329586029052734
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 1.0521795749664307
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 1.000337839126587
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.8505885601043701
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 1.0103378295898438
Epoch: 53, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 0.7978973388671875
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 1.1197082996368408
Epoch: 55, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 0.8801357746124268
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8422541618347168
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.9748296737670898
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.8343746662139893
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.0336766242980957
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.9738895893096924
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.9917101860046387
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.8000268936157227
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.8901903629302979
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 0.8709008693695068
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 1.1675057411193848
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 0.9469873905181885
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 0.9144871234893799
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.0066449642181396
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 0.9085054397583008
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8957920074462891
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 0.9918069839477539
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 73 cost time: 0.9583456516265869
Epoch: 73, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 74 cost time: 0.9151601791381836
Epoch: 74, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 75 cost time: 0.9590990543365479
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 76 cost time: 0.8507463932037354
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.8211674690246582
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.9762430191040039
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.9823052883148193
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.0599079132080078
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.0188250541687012
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.9637675285339355
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 1.0002532005310059
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.9878461360931396
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 85 cost time: 0.9641091823577881
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 86 cost time: 1.0523648262023926
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.0631828308105469
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.998999834060669
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 1.041757583618164
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 1.001988172531128
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 91 cost time: 0.9667425155639648
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.9360249042510986
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 93 cost time: 0.9209318161010742
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 94 cost time: 0.8644890785217285
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.8526713848114014
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 96 cost time: 0.9485650062561035
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 97 cost time: 0.9856827259063721
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 98 cost time: 0.9484679698944092
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 99 cost time: 1.0177538394927979
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 100 cost time: 0.9560811519622803
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm64_nh16_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 127244
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.654097080230713
Epoch: 1, Steps: 7 | Train Loss: 2.547 Vali Loss: 2.392 Vali Acc: 0.167 Test Loss: 2.392 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.9290034770965576
Epoch: 2, Steps: 7 | Train Loss: 2.221 Vali Loss: 1.860 Vali Acc: 0.542 Test Loss: 1.860 Test Acc: 0.542
Validation loss decreased (-0.166643 --> -0.541648).  Saving model ...
Epoch: 3 cost time: 1.1038320064544678
Epoch: 3, Steps: 7 | Train Loss: 1.543 Vali Loss: 1.256 Vali Acc: 0.806 Test Loss: 1.256 Test Acc: 0.806
Validation loss decreased (-0.541648 --> -0.805543).  Saving model ...
Epoch: 4 cost time: 1.0196545124053955
Epoch: 4, Steps: 7 | Train Loss: 0.893 Vali Loss: 0.779 Vali Acc: 0.833 Test Loss: 0.779 Test Acc: 0.833
Validation loss decreased (-0.805543 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 1.0405545234680176
Epoch: 5, Steps: 7 | Train Loss: 0.410 Vali Loss: 0.462 Vali Acc: 0.903 Test Loss: 0.462 Test Acc: 0.903
Validation loss decreased (-0.833326 --> -0.902773).  Saving model ...
Epoch: 6 cost time: 1.148662805557251
Epoch: 6, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.356 Vali Acc: 0.903 Test Loss: 0.356 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.0667810440063477
Epoch: 7, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 1.2156343460083008
Epoch: 8, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.0398659706115723
Epoch: 9, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.022796869277954
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.0739374160766602
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.1195154190063477
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 1.192425012588501
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 1.0974323749542236
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.17213773727417
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.9377729892730713
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 1.0859899520874023
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.9635515213012695
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.9187853336334229
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 1.0028467178344727
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.9283802509307861
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.0860397815704346
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.2155561447143555
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1375505924224854
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1466267108917236
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1354658603668213
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.025524377822876
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 1.005197525024414
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 1.0910966396331787
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.9411354064941406
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 1.044203519821167
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 1.1007037162780762
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 1.1138372421264648
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 1.0853514671325684
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 1.072106122970581
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.153761863708496
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0630404949188232
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1276814937591553
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2112081050872803
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0744707584381104
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0781035423278809
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.9553635120391846
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 1.0678870677947998
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 1.0013761520385742
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 1.0982372760772705
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 0.9561285972595215
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 1.0699310302734375
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 1.1033518314361572
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.9001133441925049
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.039017915725708
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.1542940139770508
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.0367977619171143
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 1.0541939735412598
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 54 cost time: 1.016993522644043
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 55 cost time: 1.0195977687835693
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0130176544189453
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.069185733795166
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.9699630737304688
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.098315715789795
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.0069522857666016
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.083852767944336
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.0839269161224365
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.084374189376831
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.089388370513916
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 65 cost time: 1.0540120601654053
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 66 cost time: 1.1501073837280273
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0653293132781982
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 68 cost time: 1.0269441604614258
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.0653421878814697
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.1729815006256104
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.1593537330627441
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.0485477447509766
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.1005971431732178
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.0941271781921387
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.085486650466919
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 76 cost time: 0.9952230453491211
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 77 cost time: 1.1246514320373535
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 78 cost time: 0.8906838893890381
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 79 cost time: 0.9608821868896484
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.1439392566680908
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.9917986392974854
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.0917656421661377
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.973029613494873
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.964759349822998
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 85 cost time: 1.0701618194580078
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.9794678688049316
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.1205568313598633
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 1.1266613006591797
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 1.0732903480529785
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 90 cost time: 1.2598726749420166
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 1.1344044208526611
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 1.084486961364746
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.9882681369781494
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 1.131932258605957
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 95 cost time: 1.025242805480957
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.9748005867004395
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 1.0433995723724365
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 0.9986228942871094
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 99 cost time: 1.0609588623046875
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 100 cost time: 1.1323120594024658
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 246124
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7522785663604736
Epoch: 1, Steps: 7 | Train Loss: 2.601 Vali Loss: 2.432 Vali Acc: 0.097 Test Loss: 2.432 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.9542503356933594
Epoch: 2, Steps: 7 | Train Loss: 2.326 Vali Loss: 2.066 Vali Acc: 0.514 Test Loss: 2.066 Test Acc: 0.514
Validation loss decreased (-0.097198 --> -0.513868).  Saving model ...
Epoch: 3 cost time: 0.8483326435089111
Epoch: 3, Steps: 7 | Train Loss: 1.872 Vali Loss: 1.644 Vali Acc: 0.694 Test Loss: 1.644 Test Acc: 0.694
Validation loss decreased (-0.513868 --> -0.694428).  Saving model ...
Epoch: 4 cost time: 0.9755299091339111
Epoch: 4, Steps: 7 | Train Loss: 1.361 Vali Loss: 1.159 Vali Acc: 0.861 Test Loss: 1.159 Test Acc: 0.861
Validation loss decreased (-0.694428 --> -0.861100).  Saving model ...
Epoch: 5 cost time: 0.8607692718505859
Epoch: 5, Steps: 7 | Train Loss: 0.926 Vali Loss: 0.783 Vali Acc: 0.861 Test Loss: 0.783 Test Acc: 0.861
Validation loss decreased (-0.861100 --> -0.861103).  Saving model ...
Epoch: 6 cost time: 1.0256733894348145
Epoch: 6, Steps: 7 | Train Loss: 0.491 Vali Loss: 0.559 Vali Acc: 0.847 Test Loss: 0.559 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.938960075378418
Epoch: 7, Steps: 7 | Train Loss: 0.266 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
Validation loss decreased (-0.861103 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.8703794479370117
Epoch: 8, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.9755523204803467
Epoch: 9, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 1.0017366409301758
Epoch: 10, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 1.024702787399292
Epoch: 11, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 1.0714049339294434
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.956296443939209
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.9806399345397949
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.981010913848877
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.9625751972198486
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.0925333499908447
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.976529598236084
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.9622621536254883
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.9704363346099854
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.9642388820648193
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8915832042694092
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.999260425567627
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.9572610855102539
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.9468727111816406
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.0390105247497559
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.004239559173584
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0225884914398193
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9576871395111084
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.9798383712768555
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9806225299835205
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9680819511413574
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.8860023021697998
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.9635250568389893
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.8832492828369141
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.9523792266845703
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.8984861373901367
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.9723284244537354
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.9316844940185547
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8832437992095947
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8662171363830566
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9350392818450928
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.8713834285736084
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8957023620605469
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9765188694000244
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.8763408660888672
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9253509044647217
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9556407928466797
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8248836994171143
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.9371521472930908
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9146199226379395
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 0.9103212356567383
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9511151313781738
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.9235074520111084
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 0.9159948825836182
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 0.8928372859954834
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 0.8891642093658447
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 0.9463565349578857
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 0.9104981422424316
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 60 cost time: 0.9759202003479004
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9913592338562012
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.046600580215454
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.1525311470031738
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.9639859199523926
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.9445211887359619
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.027123212814331
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.0396537780761719
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.9884376525878906
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.1153218746185303
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 154924
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.732429027557373
Epoch: 1, Steps: 7 | Train Loss: 2.687 Vali Loss: 2.546 Vali Acc: 0.139 Test Loss: 2.546 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 0.9317233562469482
Epoch: 2, Steps: 7 | Train Loss: 2.446 Vali Loss: 2.281 Vali Acc: 0.264 Test Loss: 2.281 Test Acc: 0.264
Validation loss decreased (-0.138863 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 0.8645820617675781
Epoch: 3, Steps: 7 | Train Loss: 2.115 Vali Loss: 1.927 Vali Acc: 0.528 Test Loss: 1.927 Test Acc: 0.528
Validation loss decreased (-0.263866 --> -0.527759).  Saving model ...
Epoch: 4 cost time: 0.8849518299102783
Epoch: 4, Steps: 7 | Train Loss: 1.678 Vali Loss: 1.518 Vali Acc: 0.653 Test Loss: 1.518 Test Acc: 0.653
Validation loss decreased (-0.527759 --> -0.652763).  Saving model ...
Epoch: 5 cost time: 1.007955551147461
Epoch: 5, Steps: 7 | Train Loss: 1.243 Vali Loss: 1.159 Vali Acc: 0.764 Test Loss: 1.159 Test Acc: 0.764
Validation loss decreased (-0.652763 --> -0.763877).  Saving model ...
Epoch: 6 cost time: 0.9418196678161621
Epoch: 6, Steps: 7 | Train Loss: 0.814 Vali Loss: 0.834 Vali Acc: 0.889 Test Loss: 0.834 Test Acc: 0.889
Validation loss decreased (-0.763877 --> -0.888881).  Saving model ...
Epoch: 7 cost time: 0.8710582256317139
Epoch: 7, Steps: 7 | Train Loss: 0.501 Vali Loss: 0.605 Vali Acc: 0.889 Test Loss: 0.605 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 0.8086020946502686
Epoch: 8, Steps: 7 | Train Loss: 0.284 Vali Loss: 0.468 Vali Acc: 0.889 Test Loss: 0.468 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 0.9409308433532715
Epoch: 9, Steps: 7 | Train Loss: 0.165 Vali Loss: 0.380 Vali Acc: 0.931 Test Loss: 0.380 Test Acc: 0.931
Validation loss decreased (-0.888884 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.9313700199127197
Epoch: 10, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.325 Vali Acc: 0.944 Test Loss: 0.325 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 0.9677510261535645
Epoch: 11, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.921135663986206
Epoch: 12, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.8673892021179199
Epoch: 13, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.874448299407959
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.8806881904602051
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.8069031238555908
Epoch: 16, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.8077664375305176
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.893089771270752
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.9113826751708984
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.8803045749664307
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.8185667991638184
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.8498940467834473
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9046361446380615
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8862841129302979
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.8147120475769043
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.9650297164916992
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.8445000648498535
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.9219410419464111
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.9102559089660645
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.8671541213989258
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8464779853820801
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.8216180801391602
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.8844931125640869
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.8496692180633545
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0221786499023438
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8855221271514893
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.9397673606872559
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.8666567802429199
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.9716720581054688
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.888270378112793
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9491269588470459
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.9372978210449219
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.9216775894165039
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.8844289779663086
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 0.8839931488037109
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 0.9498002529144287
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.8887894153594971
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9170365333557129
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.984776496887207
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.8716232776641846
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 51 cost time: 0.9364948272705078
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 52 cost time: 0.9980134963989258
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9835178852081299
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 54 cost time: 0.9387011528015137
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9406020641326904
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.9475648403167725
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.8414850234985352
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 58 cost time: 0.9328367710113525
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 59 cost time: 0.9483368396759033
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 60 cost time: 0.9234933853149414
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 61 cost time: 0.8918130397796631
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9080557823181152
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.9108405113220215
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.9492852687835693
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 65 cost time: 0.8675620555877686
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 66 cost time: 0.8698515892028809
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 67 cost time: 0.8061184883117676
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 68 cost time: 0.8702392578125
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9016902446746826
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 70 cost time: 0.8314623832702637
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 71 cost time: 0.8178839683532715
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.8504464626312256
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.0534391403198242
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 74 cost time: 0.8693540096282959
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 75 cost time: 0.9510824680328369
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 76 cost time: 0.849027156829834
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 77 cost time: 0.8441972732543945
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.8346788883209229
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.9103579521179199
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.8280069828033447
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.7987813949584961
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.841604471206665
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 0.7784943580627441
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 84 cost time: 0.9274663925170898
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 85 cost time: 0.9340927600860596
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.8695530891418457
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.9675753116607666
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.9250414371490479
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.8591089248657227
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 0.8904726505279541
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 0.9905879497528076
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 0.9104611873626709
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 0.9465656280517578
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 94 cost time: 0.9677996635437012
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.0166916847229004
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.9943468570709229
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 0.8603076934814453
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 0.8864331245422363
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 0.9064137935638428
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 0.8504164218902588
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 125932
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df256_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.665447235107422
Epoch: 1, Steps: 7 | Train Loss: 2.665 Vali Loss: 2.604 Vali Acc: 0.125 Test Loss: 2.604 Test Acc: 0.125
Validation loss decreased (inf --> -0.124974).  Saving model ...
Epoch: 2 cost time: 0.922961950302124
Epoch: 2, Steps: 7 | Train Loss: 2.361 Vali Loss: 2.295 Vali Acc: 0.236 Test Loss: 2.295 Test Acc: 0.236
Validation loss decreased (-0.124974 --> -0.236088).  Saving model ...
Epoch: 3 cost time: 0.9424126148223877
Epoch: 3, Steps: 7 | Train Loss: 2.100 Vali Loss: 1.930 Vali Acc: 0.514 Test Loss: 1.930 Test Acc: 0.514
Validation loss decreased (-0.236088 --> -0.513870).  Saving model ...
Epoch: 4 cost time: 0.9313862323760986
Epoch: 4, Steps: 7 | Train Loss: 1.702 Vali Loss: 1.567 Vali Acc: 0.639 Test Loss: 1.567 Test Acc: 0.639
Validation loss decreased (-0.513870 --> -0.638873).  Saving model ...
Epoch: 5 cost time: 1.0240716934204102
Epoch: 5, Steps: 7 | Train Loss: 1.319 Vali Loss: 1.231 Vali Acc: 0.806 Test Loss: 1.231 Test Acc: 0.806
Validation loss decreased (-0.638873 --> -0.805543).  Saving model ...
Epoch: 6 cost time: 0.911381721496582
Epoch: 6, Steps: 7 | Train Loss: 0.914 Vali Loss: 0.925 Vali Acc: 0.847 Test Loss: 0.925 Test Acc: 0.847
Validation loss decreased (-0.805543 --> -0.847213).  Saving model ...
Epoch: 7 cost time: 0.8760321140289307
Epoch: 7, Steps: 7 | Train Loss: 0.611 Vali Loss: 0.700 Vali Acc: 0.861 Test Loss: 0.700 Test Acc: 0.861
Validation loss decreased (-0.847213 --> -0.861104).  Saving model ...
Epoch: 8 cost time: 0.8738634586334229
Epoch: 8, Steps: 7 | Train Loss: 0.401 Vali Loss: 0.555 Vali Acc: 0.903 Test Loss: 0.555 Test Acc: 0.903
Validation loss decreased (-0.861104 --> -0.902772).  Saving model ...
Epoch: 9 cost time: 0.8900923728942871
Epoch: 9, Steps: 7 | Train Loss: 0.271 Vali Loss: 0.457 Vali Acc: 0.931 Test Loss: 0.457 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930551).  Saving model ...
Epoch: 10 cost time: 0.8918566703796387
Epoch: 10, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.372 Vali Acc: 0.917 Test Loss: 0.372 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9880735874176025
Epoch: 11, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9399311542510986
Epoch: 12, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0762979984283447
Epoch: 13, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.9472508430480957
Epoch: 14, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.7993106842041016
Epoch: 15, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8348612785339355
Epoch: 16, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9234156608581543
Epoch: 17, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8251767158508301
Epoch: 18, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8554182052612305
Epoch: 19, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9097168445587158
Epoch: 20, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9082932472229004
Epoch: 21, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0306315422058105
Epoch: 22, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9327805042266846
Epoch: 23, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8637986183166504
Epoch: 24, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df256_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 110764
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.641079902648926
Epoch: 1, Steps: 7 | Train Loss: 2.569 Vali Loss: 2.512 Vali Acc: 0.125 Test Loss: 2.512 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.8081555366516113
Epoch: 2, Steps: 7 | Train Loss: 2.430 Vali Loss: 2.350 Vali Acc: 0.153 Test Loss: 2.350 Test Acc: 0.153
Validation loss decreased (-0.124975 --> -0.152754).  Saving model ...
Epoch: 3 cost time: 0.7589142322540283
Epoch: 3, Steps: 7 | Train Loss: 2.181 Vali Loss: 2.106 Vali Acc: 0.458 Test Loss: 2.106 Test Acc: 0.458
Validation loss decreased (-0.152754 --> -0.458312).  Saving model ...
Epoch: 4 cost time: 0.7917490005493164
Epoch: 4, Steps: 7 | Train Loss: 1.954 Vali Loss: 1.843 Vali Acc: 0.556 Test Loss: 1.843 Test Acc: 0.556
Validation loss decreased (-0.458312 --> -0.555537).  Saving model ...
Epoch: 5 cost time: 0.7138457298278809
Epoch: 5, Steps: 7 | Train Loss: 1.615 Vali Loss: 1.545 Vali Acc: 0.625 Test Loss: 1.545 Test Acc: 0.625
Validation loss decreased (-0.555537 --> -0.624985).  Saving model ...
Epoch: 6 cost time: 0.7395215034484863
Epoch: 6, Steps: 7 | Train Loss: 1.314 Vali Loss: 1.273 Vali Acc: 0.708 Test Loss: 1.273 Test Acc: 0.708
Validation loss decreased (-0.624985 --> -0.708321).  Saving model ...
Epoch: 7 cost time: 0.9401912689208984
Epoch: 7, Steps: 7 | Train Loss: 1.036 Vali Loss: 1.027 Vali Acc: 0.750 Test Loss: 1.027 Test Acc: 0.750
Validation loss decreased (-0.708321 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 0.9156434535980225
Epoch: 8, Steps: 7 | Train Loss: 0.771 Vali Loss: 0.816 Vali Acc: 0.819 Test Loss: 0.816 Test Acc: 0.819
Validation loss decreased (-0.749990 --> -0.819436).  Saving model ...
Epoch: 9 cost time: 0.8999383449554443
Epoch: 9, Steps: 7 | Train Loss: 0.529 Vali Loss: 0.658 Vali Acc: 0.847 Test Loss: 0.658 Test Acc: 0.847
Validation loss decreased (-0.819436 --> -0.847216).  Saving model ...
Epoch: 10 cost time: 0.8235759735107422
Epoch: 10, Steps: 7 | Train Loss: 0.355 Vali Loss: 0.562 Vali Acc: 0.833 Test Loss: 0.562 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8308074474334717
Epoch: 11, Steps: 7 | Train Loss: 0.256 Vali Loss: 0.484 Vali Acc: 0.847 Test Loss: 0.484 Test Acc: 0.847
Validation loss decreased (-0.847216 --> -0.847217).  Saving model ...
Epoch: 12 cost time: 0.9174201488494873
Epoch: 12, Steps: 7 | Train Loss: 0.178 Vali Loss: 0.425 Vali Acc: 0.861 Test Loss: 0.425 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 0.8816180229187012
Epoch: 13, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.401 Vali Acc: 0.861 Test Loss: 0.401 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 0.95229172706604
Epoch: 14, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.382 Vali Acc: 0.861 Test Loss: 0.382 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 0.8973586559295654
Epoch: 15, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.374 Vali Acc: 0.847 Test Loss: 0.374 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9634559154510498
Epoch: 16, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 0.8755075931549072
Epoch: 17, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 18 cost time: 0.9091305732727051
Epoch: 18, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.336 Vali Acc: 0.875 Test Loss: 0.336 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 19 cost time: 0.9033348560333252
Epoch: 19, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.9257519245147705
Epoch: 20, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.9042263031005859
Epoch: 21, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.8838098049163818
Epoch: 22, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9232466220855713
Epoch: 23, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.9668607711791992
Epoch: 24, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.9215080738067627
Epoch: 25, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.9735443592071533
Epoch: 26, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.9797892570495605
Epoch: 27, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.8599905967712402
Epoch: 28, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.8199782371520996
Epoch: 29, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.8548476696014404
Epoch: 30, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.8410525321960449
Epoch: 31, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 1.0034255981445312
Epoch: 32, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.8011105060577393
Epoch: 33, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9291915893554688
Epoch: 34, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8224358558654785
Epoch: 35, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9044384956359863
Epoch: 36, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.898939847946167
Epoch: 37, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.904304027557373
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.8035488128662109
Epoch: 39, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.8513486385345459
Epoch: 40, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9383196830749512
Epoch: 41, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9465515613555908
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.988548755645752
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9093899726867676
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8924415111541748
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.9198286533355713
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.9292750358581543
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.9039268493652344
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.8562319278717041
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.9835798740386963
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 0.9029922485351562
Epoch: 51, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.9330267906188965
Epoch: 52, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 0.9380950927734375
Epoch: 53, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.853222131729126
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.8577671051025391
Epoch: 55, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.0126066207885742
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 0.8540396690368652
Epoch: 57, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 0.8371355533599854
Epoch: 58, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 0.8705615997314453
Epoch: 59, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.7847983837127686
Epoch: 60, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 0.9664163589477539
Epoch: 61, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9762938022613525
Epoch: 62, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.1040418148040771
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 1.012256145477295
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 0.8987915515899658
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 1.0178232192993164
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 0.9343695640563965
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 0.8415071964263916
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 0.9073078632354736
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.8851087093353271
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.0046823024749756
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 0.9533281326293945
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 73 cost time: 0.9476785659790039
Epoch: 73, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 74 cost time: 1.0081965923309326
Epoch: 74, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.8581905364990234
Epoch: 75, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.9046821594238281
Epoch: 76, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 77 cost time: 0.9103398323059082
Epoch: 77, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 78 cost time: 0.9927830696105957
Epoch: 78, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930553).  Saving model ...
Epoch: 79 cost time: 0.9830279350280762
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.9135642051696777
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.9112145900726318
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.0332105159759521
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.8657670021057129
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 84 cost time: 1.0443222522735596
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 85 cost time: 0.8830420970916748
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 86 cost time: 0.9433519840240479
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.9704859256744385
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 88 cost time: 0.9346756935119629
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.9206774234771729
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.0499420166015625
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 0.8556358814239502
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 0.9131970405578613
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 1.0259263515472412
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 0.7517571449279785
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 95 cost time: 0.8230729103088379
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.7926585674285889
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.7888491153717041
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 0.8996071815490723
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 0.8909497261047363
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 0.8595759868621826
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 98860
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df256_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.56146240234375
Epoch: 1, Steps: 7 | Train Loss: 2.716 Vali Loss: 2.450 Vali Acc: 0.139 Test Loss: 2.450 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.8603119850158691
Epoch: 2, Steps: 7 | Train Loss: 2.474 Vali Loss: 2.326 Vali Acc: 0.208 Test Loss: 2.326 Test Acc: 0.208
Validation loss decreased (-0.138864 --> -0.208310).  Saving model ...
Epoch: 3 cost time: 0.9421184062957764
Epoch: 3, Steps: 7 | Train Loss: 2.301 Vali Loss: 2.149 Vali Acc: 0.333 Test Loss: 2.149 Test Acc: 0.333
Validation loss decreased (-0.208310 --> -0.333312).  Saving model ...
Epoch: 4 cost time: 0.8186492919921875
Epoch: 4, Steps: 7 | Train Loss: 2.083 Vali Loss: 1.938 Vali Acc: 0.514 Test Loss: 1.938 Test Acc: 0.514
Validation loss decreased (-0.333312 --> -0.513870).  Saving model ...
Epoch: 5 cost time: 0.856220006942749
Epoch: 5, Steps: 7 | Train Loss: 1.846 Vali Loss: 1.724 Vali Acc: 0.639 Test Loss: 1.724 Test Acc: 0.639
Validation loss decreased (-0.513870 --> -0.638872).  Saving model ...
Epoch: 6 cost time: 0.9271509647369385
Epoch: 6, Steps: 7 | Train Loss: 1.585 Vali Loss: 1.492 Vali Acc: 0.750 Test Loss: 1.492 Test Acc: 0.750
Validation loss decreased (-0.638872 --> -0.749985).  Saving model ...
Epoch: 7 cost time: 0.9413995742797852
Epoch: 7, Steps: 7 | Train Loss: 1.314 Vali Loss: 1.248 Vali Acc: 0.764 Test Loss: 1.248 Test Acc: 0.764
Validation loss decreased (-0.749985 --> -0.763876).  Saving model ...
Epoch: 8 cost time: 0.8947546482086182
Epoch: 8, Steps: 7 | Train Loss: 1.070 Vali Loss: 1.026 Vali Acc: 0.764 Test Loss: 1.026 Test Acc: 0.764
Validation loss decreased (-0.763876 --> -0.763879).  Saving model ...
Epoch: 9 cost time: 0.9916572570800781
Epoch: 9, Steps: 7 | Train Loss: 0.825 Vali Loss: 0.842 Vali Acc: 0.833 Test Loss: 0.842 Test Acc: 0.833
Validation loss decreased (-0.763879 --> -0.833325).  Saving model ...
Epoch: 10 cost time: 0.8910346031188965
Epoch: 10, Steps: 7 | Train Loss: 0.600 Vali Loss: 0.677 Vali Acc: 0.847 Test Loss: 0.677 Test Acc: 0.847
Validation loss decreased (-0.833325 --> -0.847215).  Saving model ...
Epoch: 11 cost time: 0.8980145454406738
Epoch: 11, Steps: 7 | Train Loss: 0.462 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861105).  Saving model ...
Epoch: 12 cost time: 0.8168430328369141
Epoch: 12, Steps: 7 | Train Loss: 0.332 Vali Loss: 0.493 Vali Acc: 0.875 Test Loss: 0.493 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 13 cost time: 0.9493966102600098
Epoch: 13, Steps: 7 | Train Loss: 0.240 Vali Loss: 0.445 Vali Acc: 0.903 Test Loss: 0.445 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902773).  Saving model ...
Epoch: 14 cost time: 0.972646951675415
Epoch: 14, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.421 Vali Acc: 0.889 Test Loss: 0.421 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9789855480194092
Epoch: 15, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.386 Vali Acc: 0.903 Test Loss: 0.386 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 0.9695491790771484
Epoch: 16, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.371 Vali Acc: 0.917 Test Loss: 0.371 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 0.902987003326416
Epoch: 17, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 0.9735498428344727
Epoch: 18, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9631845951080322
Epoch: 19, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9320535659790039
Epoch: 20, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9183282852172852
Epoch: 21, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.0811572074890137
Epoch: 22, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.8698153495788574
Epoch: 23, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.8871219158172607
Epoch: 24, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.8483366966247559
Epoch: 25, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.9680273532867432
Epoch: 26, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.7913253307342529
Epoch: 27, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.9553675651550293
Epoch: 28, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9608116149902344
Epoch: 29, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9536449909210205
Epoch: 30, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.0055482387542725
Epoch: 31, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.8000321388244629
Epoch: 32, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.943875789642334
Epoch: 33, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9879403114318848
Epoch: 34, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.8768682479858398
Epoch: 35, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.9326298236846924
Epoch: 36, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.9100973606109619
Epoch: 37, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.8263835906982422
Epoch: 38, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.9334096908569336
Epoch: 39, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.8963830471038818
Epoch: 40, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.9174418449401855
Epoch: 41, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.8771703243255615
Epoch: 42, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.7907998561859131
Epoch: 43, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8297441005706787
Epoch: 44, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9029178619384766
Epoch: 45, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.90559983253479
Epoch: 46, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0378170013427734
Epoch: 47, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0002202987670898
Epoch: 48, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.8736045360565186
Epoch: 49, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7971758842468262
Epoch: 50, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 0.8673791885375977
Epoch: 51, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.9650745391845703
Epoch: 52, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 0.9242191314697266
Epoch: 53, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 1.0071954727172852
Epoch: 54, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9635825157165527
Epoch: 55, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 0.851205587387085
Epoch: 56, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 0.932563066482544
Epoch: 57, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 0.9231820106506348
Epoch: 58, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 0.8674111366271973
Epoch: 59, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.8226439952850342
Epoch: 60, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 0.8454117774963379
Epoch: 61, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.869563102722168
Epoch: 62, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.8342864513397217
Epoch: 63, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.0322370529174805
Epoch: 64, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 0.9021501541137695
Epoch: 65, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 1.017639398574829
Epoch: 66, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 0.9015951156616211
Epoch: 67, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 0.9036984443664551
Epoch: 68, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 0.9374749660491943
Epoch: 69, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.9333899021148682
Epoch: 70, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.9088296890258789
Epoch: 71, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 1.0420336723327637
Epoch: 72, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.9208889007568359
Epoch: 73, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.9937303066253662
Epoch: 74, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.911151647567749
Epoch: 75, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.9119625091552734
Epoch: 76, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 77 cost time: 0.9184422492980957
Epoch: 77, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 78 cost time: 0.7995538711547852
Epoch: 78, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 79 cost time: 0.9748508930206299
Epoch: 79, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 80 cost time: 1.0018665790557861
Epoch: 80, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 81 cost time: 1.0109460353851318
Epoch: 81, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.9506478309631348
Epoch: 82, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 83 cost time: 1.0352189540863037
Epoch: 83, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 84 cost time: 1.0346243381500244
Epoch: 84, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.9612240791320801
Epoch: 85, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 86 cost time: 0.8629710674285889
Epoch: 86, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 87 cost time: 1.0636346340179443
Epoch: 87, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.9642190933227539
Epoch: 88, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 89 cost time: 0.9794960021972656
Epoch: 89, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 90 cost time: 0.8789212703704834
Epoch: 90, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.966679573059082
Epoch: 91, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.9415891170501709
Epoch: 92, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 93 cost time: 0.9462761878967285
Epoch: 93, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 94 cost time: 0.8892648220062256
Epoch: 94, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 95 cost time: 0.814659595489502
Epoch: 95, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 96 cost time: 0.9489552974700928
Epoch: 96, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 97 cost time: 0.7939691543579102
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 98 cost time: 0.7953543663024902
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.8179442882537842
Epoch: 99, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.8604724407196045
Epoch: 100, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df256_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 91564
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6506690979003906
Epoch: 1, Steps: 7 | Train Loss: 2.782 Vali Loss: 2.593 Vali Acc: 0.083 Test Loss: 2.593 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 0.7831366062164307
Epoch: 2, Steps: 7 | Train Loss: 2.697 Vali Loss: 2.439 Vali Acc: 0.194 Test Loss: 2.439 Test Acc: 0.194
Validation loss decreased (-0.083307 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 0.8663508892059326
Epoch: 3, Steps: 7 | Train Loss: 2.473 Vali Loss: 2.230 Vali Acc: 0.278 Test Loss: 2.230 Test Acc: 0.278
Validation loss decreased (-0.194420 --> -0.277755).  Saving model ...
Epoch: 4 cost time: 0.7374515533447266
Epoch: 4, Steps: 7 | Train Loss: 2.185 Vali Loss: 1.992 Vali Acc: 0.361 Test Loss: 1.992 Test Acc: 0.361
Validation loss decreased (-0.277755 --> -0.361091).  Saving model ...
Epoch: 5 cost time: 0.7184920310974121
Epoch: 5, Steps: 7 | Train Loss: 1.990 Vali Loss: 1.760 Vali Acc: 0.444 Test Loss: 1.760 Test Acc: 0.444
Validation loss decreased (-0.361091 --> -0.444427).  Saving model ...
Epoch: 6 cost time: 0.7048096656799316
Epoch: 6, Steps: 7 | Train Loss: 1.690 Vali Loss: 1.535 Vali Acc: 0.625 Test Loss: 1.535 Test Acc: 0.625
Validation loss decreased (-0.444427 --> -0.624985).  Saving model ...
Epoch: 7 cost time: 0.7259066104888916
Epoch: 7, Steps: 7 | Train Loss: 1.411 Vali Loss: 1.327 Vali Acc: 0.736 Test Loss: 1.327 Test Acc: 0.736
Validation loss decreased (-0.624985 --> -0.736098).  Saving model ...
Epoch: 8 cost time: 0.751150369644165
Epoch: 8, Steps: 7 | Train Loss: 1.222 Vali Loss: 1.145 Vali Acc: 0.806 Test Loss: 1.145 Test Acc: 0.806
Validation loss decreased (-0.736098 --> -0.805544).  Saving model ...
Epoch: 9 cost time: 0.8322048187255859
Epoch: 9, Steps: 7 | Train Loss: 0.967 Vali Loss: 0.981 Vali Acc: 0.833 Test Loss: 0.981 Test Acc: 0.833
Validation loss decreased (-0.805544 --> -0.833324).  Saving model ...
Epoch: 10 cost time: 0.7928245067596436
Epoch: 10, Steps: 7 | Train Loss: 0.775 Vali Loss: 0.834 Vali Acc: 0.847 Test Loss: 0.834 Test Acc: 0.847
Validation loss decreased (-0.833324 --> -0.847214).  Saving model ...
Epoch: 11 cost time: 0.8350648880004883
Epoch: 11, Steps: 7 | Train Loss: 0.602 Vali Loss: 0.727 Vali Acc: 0.847 Test Loss: 0.727 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847215).  Saving model ...
Epoch: 12 cost time: 0.8056313991546631
Epoch: 12, Steps: 7 | Train Loss: 0.454 Vali Loss: 0.629 Vali Acc: 0.861 Test Loss: 0.629 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861105).  Saving model ...
Epoch: 13 cost time: 0.8201727867126465
Epoch: 13, Steps: 7 | Train Loss: 0.361 Vali Loss: 0.547 Vali Acc: 0.861 Test Loss: 0.547 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 14 cost time: 0.8311684131622314
Epoch: 14, Steps: 7 | Train Loss: 0.268 Vali Loss: 0.507 Vali Acc: 0.861 Test Loss: 0.507 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 15 cost time: 0.7915620803833008
Epoch: 15, Steps: 7 | Train Loss: 0.210 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874995).  Saving model ...
Epoch: 16 cost time: 0.7560150623321533
Epoch: 16, Steps: 7 | Train Loss: 0.178 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 0.8294179439544678
Epoch: 17, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.417 Vali Acc: 0.861 Test Loss: 0.417 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.726597785949707
Epoch: 18, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 19 cost time: 0.7929952144622803
Epoch: 19, Steps: 7 | Train Loss: 0.096 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 0.7820708751678467
Epoch: 20, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 21 cost time: 0.7886068820953369
Epoch: 21, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 22 cost time: 0.8965117931365967
Epoch: 22, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 23 cost time: 0.8365793228149414
Epoch: 23, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.8289005756378174
Epoch: 24, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902774).  Saving model ...
Epoch: 25 cost time: 0.7970402240753174
Epoch: 25, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.834653377532959
Epoch: 26, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.8462302684783936
Epoch: 27, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.8464007377624512
Epoch: 28, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9036614894866943
Epoch: 29, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.8406248092651367
Epoch: 30, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 1.00657057762146
Epoch: 31, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8300375938415527
Epoch: 32, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8504900932312012
Epoch: 33, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.8117868900299072
Epoch: 34, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.9153733253479004
Epoch: 35, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.8078896999359131
Epoch: 36, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.9801414012908936
Epoch: 37, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.8734309673309326
Epoch: 38, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7956418991088867
Epoch: 39, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9972987174987793
Epoch: 40, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8694541454315186
Epoch: 41, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8632540702819824
Epoch: 42, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.8689827919006348
Epoch: 43, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8951752185821533
Epoch: 44, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8801262378692627
Epoch: 45, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7233860492706299
Epoch: 46, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8029968738555908
Epoch: 47, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8125948905944824
Epoch: 48, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7120699882507324
Epoch: 49, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7278268337249756
Epoch: 50, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.8301723003387451
Epoch: 51, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.7653944492340088
Epoch: 52, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 0.8413054943084717
Epoch: 53, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7873332500457764
Epoch: 54, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 0.7848751544952393
Epoch: 55, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 0.8635210990905762
Epoch: 56, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8280599117279053
Epoch: 57, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.8966398239135742
Epoch: 58, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 0.8090198040008545
Epoch: 59, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.827763557434082
Epoch: 60, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 0.8495998382568359
Epoch: 61, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 62 cost time: 0.8422465324401855
Epoch: 62, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8004553318023682
Epoch: 63, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.8333673477172852
Epoch: 64, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 0.7896146774291992
Epoch: 65, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 0.848797082901001
Epoch: 66, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 0.8173422813415527
Epoch: 67, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 0.8228356838226318
Epoch: 68, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 0.8330502510070801
Epoch: 69, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 0.8700716495513916
Epoch: 70, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 0.9308042526245117
Epoch: 71, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.8799459934234619
Epoch: 72, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.982675313949585
Epoch: 73, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.9400765895843506
Epoch: 74, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.892188549041748
Epoch: 75, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.934617280960083
Epoch: 76, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.9423234462738037
Epoch: 77, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 78 cost time: 0.8758199214935303
Epoch: 78, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 79 cost time: 0.8606986999511719
Epoch: 79, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 80 cost time: 0.9060571193695068
Epoch: 80, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.908764123916626
Epoch: 81, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.8697199821472168
Epoch: 82, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.894357442855835
Epoch: 83, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.041189193725586
Epoch: 84, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.8696193695068359
Epoch: 85, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 86 cost time: 0.8639967441558838
Epoch: 86, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 87 cost time: 1.0108449459075928
Epoch: 87, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.9575343132019043
Epoch: 88, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 89 cost time: 0.8105475902557373
Epoch: 89, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.9832959175109863
Epoch: 90, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.9336316585540771
Epoch: 91, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.857349157333374
Epoch: 92, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 0.9501821994781494
Epoch: 93, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 0.9697356224060059
Epoch: 94, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 95 cost time: 0.9880306720733643
Epoch: 95, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 96 cost time: 0.8545920848846436
Epoch: 96, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 97 cost time: 0.8807969093322754
Epoch: 97, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.9089269638061523
Epoch: 98, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.9246177673339844
Epoch: 99, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 0.8830881118774414
Epoch: 100, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 88876
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.271730422973633
Epoch: 1, Steps: 7 | Train Loss: 2.475 Vali Loss: 2.224 Vali Acc: 0.306 Test Loss: 2.224 Test Acc: 0.306
Validation loss decreased (inf --> -0.305533).  Saving model ...
Epoch: 2 cost time: 1.03065824508667
Epoch: 2, Steps: 7 | Train Loss: 2.149 Vali Loss: 1.789 Vali Acc: 0.611 Test Loss: 1.789 Test Acc: 0.611
Validation loss decreased (-0.305533 --> -0.611093).  Saving model ...
Epoch: 3 cost time: 0.942772626876831
Epoch: 3, Steps: 7 | Train Loss: 1.509 Vali Loss: 1.219 Vali Acc: 0.750 Test Loss: 1.219 Test Acc: 0.750
Validation loss decreased (-0.611093 --> -0.749988).  Saving model ...
Epoch: 4 cost time: 0.9887888431549072
Epoch: 4, Steps: 7 | Train Loss: 0.934 Vali Loss: 0.775 Vali Acc: 0.875 Test Loss: 0.775 Test Acc: 0.875
Validation loss decreased (-0.749988 --> -0.874992).  Saving model ...
Epoch: 5 cost time: 0.9278812408447266
Epoch: 5, Steps: 7 | Train Loss: 0.487 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 1.0543458461761475
Epoch: 6, Steps: 7 | Train Loss: 0.192 Vali Loss: 0.380 Vali Acc: 0.917 Test Loss: 0.380 Test Acc: 0.917
Validation loss decreased (-0.874995 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 0.9915297031402588
Epoch: 7, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 0.9245555400848389
Epoch: 8, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9344332218170166
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1129591464996338
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0202925205230713
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0224459171295166
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.0205397605895996
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 1.0628485679626465
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.050511360168457
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 1.026684045791626
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 1.0923361778259277
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0908265113830566
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.9832978248596191
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 1.1929295063018799
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 21 cost time: 1.0897624492645264
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 22 cost time: 1.0729882717132568
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1632583141326904
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 1.0496883392333984
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 1.158621072769165
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 1.0387699604034424
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 1.063755989074707
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 1.0221574306488037
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0155911445617676
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 1.0292677879333496
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 31 cost time: 0.9432260990142822
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0801951885223389
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.076047658920288
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.344705581665039
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
Validation loss decreased (-0.958332 --> -0.972221).  Saving model ...
Epoch: 35 cost time: 1.0284595489501953
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 36 cost time: 0.9625475406646729
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 37 cost time: 1.0220398902893066
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0128297805786133
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9770159721374512
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0223476886749268
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.019505262374878
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1239597797393799
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.893923282623291
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0924873352050781
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.0091915130615234
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.9651076793670654
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 47 cost time: 1.028904914855957
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 48 cost time: 0.9081332683563232
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 49 cost time: 0.9170622825622559
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 50 cost time: 1.0792951583862305
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 51 cost time: 0.9834392070770264
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.1587212085723877
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 53 cost time: 0.9861090183258057
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 54 cost time: 1.05568528175354
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 55 cost time: 1.1003849506378174
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 56 cost time: 0.9984498023986816
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 57 cost time: 1.0476384162902832
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 58 cost time: 0.9820647239685059
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 59 cost time: 1.1266286373138428
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8701462745666504
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.0978872776031494
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.0262367725372314
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.0396480560302734
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.9925451278686523
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.037262201309204
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.9140160083770752
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 67 cost time: 0.9751605987548828
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.9897150993347168
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 69 cost time: 0.9356846809387207
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.1190338134765625
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.0331261157989502
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 72 cost time: 0.9834661483764648
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 73 cost time: 0.9623777866363525
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.0268487930297852
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.0457375049591064
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 76 cost time: 0.9960551261901855
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 77 cost time: 0.9835965633392334
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 78 cost time: 0.9797613620758057
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 79 cost time: 0.9567699432373047
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.011850118637085
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.0560719966888428
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.0112066268920898
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 1.0683698654174805
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 1.101496696472168
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 1.0294444561004639
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 1.0410265922546387
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 1.063317060470581
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 1.030379056930542
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 221164
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.801990032196045
Epoch: 1, Steps: 7 | Train Loss: 2.730 Vali Loss: 2.503 Vali Acc: 0.139 Test Loss: 2.503 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.7769260406494141
Epoch: 2, Steps: 7 | Train Loss: 2.476 Vali Loss: 2.201 Vali Acc: 0.389 Test Loss: 2.201 Test Acc: 0.389
Validation loss decreased (-0.138864 --> -0.388867).  Saving model ...
Epoch: 3 cost time: 0.8630826473236084
Epoch: 3, Steps: 7 | Train Loss: 2.020 Vali Loss: 1.789 Vali Acc: 0.667 Test Loss: 1.789 Test Acc: 0.667
Validation loss decreased (-0.388867 --> -0.666649).  Saving model ...
Epoch: 4 cost time: 0.8532440662384033
Epoch: 4, Steps: 7 | Train Loss: 1.549 Vali Loss: 1.345 Vali Acc: 0.792 Test Loss: 1.345 Test Acc: 0.792
Validation loss decreased (-0.666649 --> -0.791653).  Saving model ...
Epoch: 5 cost time: 0.8253884315490723
Epoch: 5, Steps: 7 | Train Loss: 1.039 Vali Loss: 0.941 Vali Acc: 0.833 Test Loss: 0.941 Test Acc: 0.833
Validation loss decreased (-0.791653 --> -0.833324).  Saving model ...
Epoch: 6 cost time: 0.791053056716919
Epoch: 6, Steps: 7 | Train Loss: 0.589 Vali Loss: 0.631 Vali Acc: 0.875 Test Loss: 0.631 Test Acc: 0.875
Validation loss decreased (-0.833324 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 0.8901855945587158
Epoch: 7, Steps: 7 | Train Loss: 0.312 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 0.8823375701904297
Epoch: 8, Steps: 7 | Train Loss: 0.162 Vali Loss: 0.344 Vali Acc: 0.944 Test Loss: 0.344 Test Acc: 0.944
Validation loss decreased (-0.874995 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 0.8849542140960693
Epoch: 9, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8232665061950684
Epoch: 10, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9538617134094238
Epoch: 11, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7868554592132568
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.8303208351135254
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.76993727684021
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.8973164558410645
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.7676806449890137
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.7717149257659912
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.8422858715057373
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.8748271465301514
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.8494305610656738
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.8937790393829346
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.8369059562683105
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.8873136043548584
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8771042823791504
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.8632984161376953
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 0.8633484840393066
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 0.9317929744720459
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 0.8471090793609619
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 0.8964743614196777
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9475781917572021
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 31 cost time: 0.877251386642456
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.839491605758667
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 33 cost time: 0.8279900550842285
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 34 cost time: 0.8204348087310791
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 35 cost time: 0.9004225730895996
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8655092716217041
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9151039123535156
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.010176420211792
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 1.0870592594146729
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 0.8934805393218994
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.991126537322998
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.8508262634277344
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 0.8902797698974609
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 0.8270370960235596
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 0.9275763034820557
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8257472515106201
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9224116802215576
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.8663489818572998
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.839270830154419
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.9224698543548584
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 51 cost time: 0.8605878353118896
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8609054088592529
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 0.958451509475708
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 54 cost time: 0.8874688148498535
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 55 cost time: 0.9190108776092529
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 56 cost time: 0.9289588928222656
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.9331092834472656
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.9630112648010254
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.9038689136505127
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.8486881256103516
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 61 cost time: 0.8026230335235596
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8663630485534668
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 63 cost time: 0.9281344413757324
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8283636569976807
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 65 cost time: 0.8965737819671631
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 66 cost time: 0.925229549407959
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 67 cost time: 0.9283473491668701
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 68 cost time: 0.7925081253051758
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 69 cost time: 0.8347203731536865
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.9242427349090576
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.8311161994934082
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 72 cost time: 0.7265610694885254
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.9579634666442871
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.8070724010467529
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 75 cost time: 0.929492712020874
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8524377346038818
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.8537886142730713
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 78 cost time: 0.9924314022064209
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7911159992218018
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.8732666969299316
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.034529209136963
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 82 cost time: 0.9217214584350586
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 83 cost time: 0.8785293102264404
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 84 cost time: 0.8828833103179932
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 85 cost time: 0.8243029117584229
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.8680896759033203
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 87 cost time: 0.9067521095275879
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 88 cost time: 0.9618330001831055
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.8190009593963623
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 90 cost time: 0.800189733505249
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 91 cost time: 0.8787884712219238
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 92 cost time: 0.7559051513671875
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 93 cost time: 0.8768630027770996
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 94 cost time: 0.9886460304260254
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 95 cost time: 0.9378273487091064
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 96 cost time: 0.9007775783538818
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.9970054626464844
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 98 cost time: 0.998054027557373
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.9093918800354004
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.8729579448699951
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 129964
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5736799240112305
Epoch: 1, Steps: 7 | Train Loss: 2.676 Vali Loss: 2.438 Vali Acc: 0.111 Test Loss: 2.438 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 1.1374711990356445
Epoch: 2, Steps: 7 | Train Loss: 2.447 Vali Loss: 2.185 Vali Acc: 0.361 Test Loss: 2.185 Test Acc: 0.361
Validation loss decreased (-0.111087 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 0.9275810718536377
Epoch: 3, Steps: 7 | Train Loss: 2.162 Vali Loss: 1.860 Vali Acc: 0.556 Test Loss: 1.860 Test Acc: 0.556
Validation loss decreased (-0.361089 --> -0.555537).  Saving model ...
Epoch: 4 cost time: 0.9654202461242676
Epoch: 4, Steps: 7 | Train Loss: 1.653 Vali Loss: 1.514 Vali Acc: 0.681 Test Loss: 1.514 Test Acc: 0.681
Validation loss decreased (-0.555537 --> -0.680540).  Saving model ...
Epoch: 5 cost time: 0.9445724487304688
Epoch: 5, Steps: 7 | Train Loss: 1.368 Vali Loss: 1.158 Vali Acc: 0.792 Test Loss: 1.158 Test Acc: 0.792
Validation loss decreased (-0.680540 --> -0.791655).  Saving model ...
Epoch: 6 cost time: 1.0327537059783936
Epoch: 6, Steps: 7 | Train Loss: 0.900 Vali Loss: 0.842 Vali Acc: 0.861 Test Loss: 0.842 Test Acc: 0.861
Validation loss decreased (-0.791655 --> -0.861103).  Saving model ...
Epoch: 7 cost time: 0.8494856357574463
Epoch: 7, Steps: 7 | Train Loss: 0.577 Vali Loss: 0.624 Vali Acc: 0.903 Test Loss: 0.624 Test Acc: 0.903
Validation loss decreased (-0.861103 --> -0.902772).  Saving model ...
Epoch: 8 cost time: 0.9254627227783203
Epoch: 8, Steps: 7 | Train Loss: 0.377 Vali Loss: 0.491 Vali Acc: 0.903 Test Loss: 0.491 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 1.022099494934082
Epoch: 9, Steps: 7 | Train Loss: 0.216 Vali Loss: 0.430 Vali Acc: 0.903 Test Loss: 0.430 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 10 cost time: 0.8430454730987549
Epoch: 10, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 0.8282055854797363
Epoch: 11, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 0.918025016784668
Epoch: 12, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8215773105621338
Epoch: 13, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9836025238037109
Epoch: 14, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.8591725826263428
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.066481113433838
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.7952816486358643
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.8577182292938232
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.7766144275665283
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9550380706787109
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.9178853034973145
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.9481127262115479
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.7866771221160889
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.8762786388397217
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.8097727298736572
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8401196002960205
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8232994079589844
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.8205857276916504
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.933727502822876
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.8144452571868896
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.0033378601074219
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9028408527374268
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.059678316116333
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.9971299171447754
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 0.9590158462524414
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 36 cost time: 0.941077470779419
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 37 cost time: 0.9720401763916016
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 38 cost time: 0.8294827938079834
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 39 cost time: 0.8984549045562744
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 40 cost time: 0.8922011852264404
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9039952754974365
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9597179889678955
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9668858051300049
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9363043308258057
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0727694034576416
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9403982162475586
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9753994941711426
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.8837416172027588
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8017134666442871
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 100972
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df128_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.786855697631836
Epoch: 1, Steps: 7 | Train Loss: 2.554 Vali Loss: 2.500 Vali Acc: 0.167 Test Loss: 2.500 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 0.8589582443237305
Epoch: 2, Steps: 7 | Train Loss: 2.474 Vali Loss: 2.285 Vali Acc: 0.264 Test Loss: 2.285 Test Acc: 0.264
Validation loss decreased (-0.166642 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 0.9005584716796875
Epoch: 3, Steps: 7 | Train Loss: 2.198 Vali Loss: 1.981 Vali Acc: 0.528 Test Loss: 1.981 Test Acc: 0.528
Validation loss decreased (-0.263866 --> -0.527758).  Saving model ...
Epoch: 4 cost time: 0.9154424667358398
Epoch: 4, Steps: 7 | Train Loss: 1.825 Vali Loss: 1.639 Vali Acc: 0.722 Test Loss: 1.639 Test Acc: 0.722
Validation loss decreased (-0.527758 --> -0.722206).  Saving model ...
Epoch: 5 cost time: 1.0124776363372803
Epoch: 5, Steps: 7 | Train Loss: 1.459 Vali Loss: 1.309 Vali Acc: 0.778 Test Loss: 1.309 Test Acc: 0.778
Validation loss decreased (-0.722206 --> -0.777765).  Saving model ...
Epoch: 6 cost time: 0.8426640033721924
Epoch: 6, Steps: 7 | Train Loss: 1.093 Vali Loss: 0.990 Vali Acc: 0.847 Test Loss: 0.990 Test Acc: 0.847
Validation loss decreased (-0.777765 --> -0.847212).  Saving model ...
Epoch: 7 cost time: 1.042785406112671
Epoch: 7, Steps: 7 | Train Loss: 0.768 Vali Loss: 0.744 Vali Acc: 0.875 Test Loss: 0.744 Test Acc: 0.875
Validation loss decreased (-0.847212 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 0.934380054473877
Epoch: 8, Steps: 7 | Train Loss: 0.528 Vali Loss: 0.574 Vali Acc: 0.889 Test Loss: 0.574 Test Acc: 0.889
Validation loss decreased (-0.874993 --> -0.888883).  Saving model ...
Epoch: 9 cost time: 0.8922281265258789
Epoch: 9, Steps: 7 | Train Loss: 0.338 Vali Loss: 0.462 Vali Acc: 0.861 Test Loss: 0.462 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8851761817932129
Epoch: 10, Steps: 7 | Train Loss: 0.223 Vali Loss: 0.408 Vali Acc: 0.903 Test Loss: 0.408 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 0.9380171298980713
Epoch: 11, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.8063383102416992
Epoch: 12, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8708944320678711
Epoch: 13, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.9483191967010498
Epoch: 14, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.9221594333648682
Epoch: 15, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.045428991317749
Epoch: 16, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.8833928108215332
Epoch: 17, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.1140143871307373
Epoch: 18, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.9226827621459961
Epoch: 19, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.9608669281005859
Epoch: 20, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0094375610351562
Epoch: 21, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.018878698348999
Epoch: 22, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.0013890266418457
Epoch: 23, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.8965845108032227
Epoch: 24, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.9776356220245361
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.001225471496582
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1169042587280273
Epoch: 27, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0176889896392822
Epoch: 28, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0782880783081055
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9218244552612305
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1252448558807373
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.0339386463165283
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9723892211914062
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0539703369140625
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.9309971332550049
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.985384464263916
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.9935314655303955
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0297694206237793
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9863409996032715
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0085749626159668
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0297131538391113
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.980933666229248
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.2072205543518066
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0501785278320312
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.1144869327545166
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.0074634552001953
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df128_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 85804
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7139346599578857
Epoch: 1, Steps: 7 | Train Loss: 2.580 Vali Loss: 2.517 Vali Acc: 0.083 Test Loss: 2.517 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 1.0092918872833252
Epoch: 2, Steps: 7 | Train Loss: 2.454 Vali Loss: 2.327 Vali Acc: 0.194 Test Loss: 2.327 Test Acc: 0.194
Validation loss decreased (-0.083308 --> -0.194421).  Saving model ...
Epoch: 3 cost time: 0.8654394149780273
Epoch: 3, Steps: 7 | Train Loss: 2.211 Vali Loss: 2.084 Vali Acc: 0.347 Test Loss: 2.084 Test Acc: 0.347
Validation loss decreased (-0.194421 --> -0.347201).  Saving model ...
Epoch: 4 cost time: 0.8994016647338867
Epoch: 4, Steps: 7 | Train Loss: 1.936 Vali Loss: 1.826 Vali Acc: 0.597 Test Loss: 1.826 Test Acc: 0.597
Validation loss decreased (-0.347201 --> -0.597204).  Saving model ...
Epoch: 5 cost time: 0.756173849105835
Epoch: 5, Steps: 7 | Train Loss: 1.641 Vali Loss: 1.549 Vali Acc: 0.736 Test Loss: 1.549 Test Acc: 0.736
Validation loss decreased (-0.597204 --> -0.736096).  Saving model ...
Epoch: 6 cost time: 0.728363037109375
Epoch: 6, Steps: 7 | Train Loss: 1.383 Vali Loss: 1.279 Vali Acc: 0.819 Test Loss: 1.279 Test Acc: 0.819
Validation loss decreased (-0.736096 --> -0.819432).  Saving model ...
Epoch: 7 cost time: 0.8445413112640381
Epoch: 7, Steps: 7 | Train Loss: 1.057 Vali Loss: 1.038 Vali Acc: 0.833 Test Loss: 1.038 Test Acc: 0.833
Validation loss decreased (-0.819432 --> -0.833323).  Saving model ...
Epoch: 8 cost time: 0.8128752708435059
Epoch: 8, Steps: 7 | Train Loss: 0.780 Vali Loss: 0.827 Vali Acc: 0.861 Test Loss: 0.827 Test Acc: 0.861
Validation loss decreased (-0.833323 --> -0.861103).  Saving model ...
Epoch: 9 cost time: 0.8305914402008057
Epoch: 9, Steps: 7 | Train Loss: 0.585 Vali Loss: 0.639 Vali Acc: 0.903 Test Loss: 0.639 Test Acc: 0.903
Validation loss decreased (-0.861103 --> -0.902771).  Saving model ...
Epoch: 10 cost time: 0.7290265560150146
Epoch: 10, Steps: 7 | Train Loss: 0.389 Vali Loss: 0.524 Vali Acc: 0.917 Test Loss: 0.524 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916661).  Saving model ...
Epoch: 11 cost time: 0.9301717281341553
Epoch: 11, Steps: 7 | Train Loss: 0.270 Vali Loss: 0.475 Vali Acc: 0.903 Test Loss: 0.475 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.77862548828125
Epoch: 12, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.426 Vali Acc: 0.861 Test Loss: 0.426 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8642041683197021
Epoch: 13, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.389 Vali Acc: 0.875 Test Loss: 0.389 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8701505661010742
Epoch: 14, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.364 Vali Acc: 0.861 Test Loss: 0.364 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8997066020965576
Epoch: 15, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.810875415802002
Epoch: 16, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8904001712799072
Epoch: 17, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.849172830581665
Epoch: 18, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.9087996482849121
Epoch: 19, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.9280626773834229
Epoch: 20, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9111213684082031
Epoch: 21, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.0022690296173096
Epoch: 22, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9777884483337402
Epoch: 23, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8766539096832275
Epoch: 24, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9124195575714111
Epoch: 25, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9680330753326416
Epoch: 26, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8213465213775635
Epoch: 27, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9607348442077637
Epoch: 28, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8827493190765381
Epoch: 29, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0096821784973145
Epoch: 30, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9458377361297607
Epoch: 31, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.8705346584320068
Epoch: 32, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.9641585350036621
Epoch: 33, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.923098087310791
Epoch: 34, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.9188582897186279
Epoch: 35, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0266852378845215
Epoch: 36, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.8521568775177002
Epoch: 37, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.0413687229156494
Epoch: 38, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.9031276702880859
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9287939071655273
Epoch: 40, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.9547431468963623
Epoch: 41, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.8677854537963867
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.9912440776824951
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.9529178142547607
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.9857826232910156
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.904670000076294
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.007793664932251
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.8884336948394775
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 49 cost time: 1.0707981586456299
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 50 cost time: 0.9632222652435303
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 51 cost time: 0.940030574798584
Epoch: 51, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 52 cost time: 0.874608039855957
Epoch: 52, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 53 cost time: 0.8607180118560791
Epoch: 53, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9782767295837402
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.8153412342071533
Epoch: 55, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 56 cost time: 0.863710880279541
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7766897678375244
Epoch: 57, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.7729272842407227
Epoch: 58, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 59 cost time: 0.8285820484161377
Epoch: 59, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 60 cost time: 0.9222147464752197
Epoch: 60, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8704729080200195
Epoch: 61, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9165403842926025
Epoch: 62, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.9820616245269775
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.8742389678955078
Epoch: 64, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.8999929428100586
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.94901442527771
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.9445273876190186
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 68 cost time: 0.9814016819000244
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 69 cost time: 1.0449583530426025
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 70 cost time: 0.9505140781402588
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 71 cost time: 1.0205631256103516
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.1298613548278809
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 73 cost time: 1.023650884628296
Epoch: 73, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 74 cost time: 1.008451223373413
Epoch: 74, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.917588472366333
Epoch: 75, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 76 cost time: 1.0962343215942383
Epoch: 76, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 77 cost time: 0.8607172966003418
Epoch: 77, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.0604305267333984
Epoch: 78, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.0118544101715088
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.9859046936035156
Epoch: 80, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.9015340805053711
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.0987393856048584
Epoch: 82, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.100776195526123
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 84 cost time: 0.953932523727417
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 85 cost time: 1.0398359298706055
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 86 cost time: 0.913625955581665
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 87 cost time: 0.9910781383514404
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.8905057907104492
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.002011775970459
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.941213846206665
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 91 cost time: 0.823979377746582
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 92 cost time: 0.862797737121582
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.8986198902130127
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.0386672019958496
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 0.9969666004180908
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 96 cost time: 0.9338979721069336
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 97 cost time: 0.9067790508270264
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.030559778213501
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 99 cost time: 0.9439659118652344
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.917 Test Loss: 0.184 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 0.9201109409332275
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.917 Test Loss: 0.184 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 73900
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df128_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5680627822875977
Epoch: 1, Steps: 7 | Train Loss: 2.678 Vali Loss: 2.637 Vali Acc: 0.000 Test Loss: 2.637 Test Acc: 0.000
Validation loss decreased (inf --> 0.000026).  Saving model ...
Epoch: 2 cost time: 0.977278470993042
Epoch: 2, Steps: 7 | Train Loss: 2.600 Vali Loss: 2.517 Vali Acc: 0.014 Test Loss: 2.517 Test Acc: 0.014
Validation loss decreased (0.000026 --> -0.013864).  Saving model ...
Epoch: 3 cost time: 0.7799365520477295
Epoch: 3, Steps: 7 | Train Loss: 2.423 Vali Loss: 2.333 Vali Acc: 0.097 Test Loss: 2.333 Test Acc: 0.097
Validation loss decreased (-0.013864 --> -0.097199).  Saving model ...
Epoch: 4 cost time: 0.9774060249328613
Epoch: 4, Steps: 7 | Train Loss: 2.214 Vali Loss: 2.111 Vali Acc: 0.361 Test Loss: 2.111 Test Acc: 0.361
Validation loss decreased (-0.097199 --> -0.361090).  Saving model ...
Epoch: 5 cost time: 0.8431699275970459
Epoch: 5, Steps: 7 | Train Loss: 1.958 Vali Loss: 1.884 Vali Acc: 0.528 Test Loss: 1.884 Test Acc: 0.528
Validation loss decreased (-0.361090 --> -0.527759).  Saving model ...
Epoch: 6 cost time: 0.9366402626037598
Epoch: 6, Steps: 7 | Train Loss: 1.689 Vali Loss: 1.659 Vali Acc: 0.653 Test Loss: 1.659 Test Acc: 0.653
Validation loss decreased (-0.527759 --> -0.652761).  Saving model ...
Epoch: 7 cost time: 0.8610601425170898
Epoch: 7, Steps: 7 | Train Loss: 1.400 Vali Loss: 1.446 Vali Acc: 0.681 Test Loss: 1.446 Test Acc: 0.681
Validation loss decreased (-0.652761 --> -0.680541).  Saving model ...
Epoch: 8 cost time: 0.8732962608337402
Epoch: 8, Steps: 7 | Train Loss: 1.211 Vali Loss: 1.237 Vali Acc: 0.764 Test Loss: 1.237 Test Acc: 0.764
Validation loss decreased (-0.680541 --> -0.763877).  Saving model ...
Epoch: 9 cost time: 0.8407852649688721
Epoch: 9, Steps: 7 | Train Loss: 0.918 Vali Loss: 1.054 Vali Acc: 0.764 Test Loss: 1.054 Test Acc: 0.764
Validation loss decreased (-0.763877 --> -0.763878).  Saving model ...
Epoch: 10 cost time: 0.8670186996459961
Epoch: 10, Steps: 7 | Train Loss: 0.754 Vali Loss: 0.883 Vali Acc: 0.806 Test Loss: 0.883 Test Acc: 0.806
Validation loss decreased (-0.763878 --> -0.805547).  Saving model ...
Epoch: 11 cost time: 0.99530029296875
Epoch: 11, Steps: 7 | Train Loss: 0.568 Vali Loss: 0.746 Vali Acc: 0.847 Test Loss: 0.746 Test Acc: 0.847
Validation loss decreased (-0.805547 --> -0.847215).  Saving model ...
Epoch: 12 cost time: 0.9204087257385254
Epoch: 12, Steps: 7 | Train Loss: 0.447 Vali Loss: 0.649 Vali Acc: 0.833 Test Loss: 0.649 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9199018478393555
Epoch: 13, Steps: 7 | Train Loss: 0.308 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861105).  Saving model ...
Epoch: 14 cost time: 0.7578637599945068
Epoch: 14, Steps: 7 | Train Loss: 0.251 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8188536167144775
Epoch: 15, Steps: 7 | Train Loss: 0.191 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 16 cost time: 0.7638545036315918
Epoch: 16, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.458 Vali Acc: 0.861 Test Loss: 0.458 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8255410194396973
Epoch: 17, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.437 Vali Acc: 0.889 Test Loss: 0.437 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 0.7843427658081055
Epoch: 18, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.413 Vali Acc: 0.903 Test Loss: 0.413 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 19 cost time: 0.6972858905792236
Epoch: 19, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.396 Vali Acc: 0.903 Test Loss: 0.396 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 20 cost time: 0.8535957336425781
Epoch: 20, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 21 cost time: 1.058837890625
Epoch: 21, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.374 Vali Acc: 0.903 Test Loss: 0.374 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 0.7651267051696777
Epoch: 22, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.372 Vali Acc: 0.903 Test Loss: 0.372 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.7915067672729492
Epoch: 23, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.368 Vali Acc: 0.903 Test Loss: 0.368 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 24 cost time: 0.7994146347045898
Epoch: 24, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 25 cost time: 0.8204755783081055
Epoch: 25, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 26 cost time: 0.8170166015625
Epoch: 26, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 27 cost time: 0.825676679611206
Epoch: 27, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.7944154739379883
Epoch: 28, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.8836550712585449
Epoch: 29, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.7999694347381592
Epoch: 30, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.8907661437988281
Epoch: 31, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.8153891563415527
Epoch: 32, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8975367546081543
Epoch: 33, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.9149172306060791
Epoch: 34, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.8775715827941895
Epoch: 35, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.8447554111480713
Epoch: 36, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.8875207901000977
Epoch: 37, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.9020106792449951
Epoch: 38, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.8924612998962402
Epoch: 39, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.9110317230224609
Epoch: 40, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.8734951019287109
Epoch: 41, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.8964939117431641
Epoch: 42, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.8336246013641357
Epoch: 43, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.9524168968200684
Epoch: 44, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8332560062408447
Epoch: 45, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8807973861694336
Epoch: 46, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9020843505859375
Epoch: 47, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8669238090515137
Epoch: 48, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.9055507183074951
Epoch: 49, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.8996779918670654
Epoch: 50, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.944744348526001
Epoch: 51, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.7595152854919434
Epoch: 52, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 53 cost time: 0.7714433670043945
Epoch: 53, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.8949317932128906
Epoch: 54, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.7943153381347656
Epoch: 55, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.8368360996246338
Epoch: 56, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 57 cost time: 0.9424817562103271
Epoch: 57, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.8973414897918701
Epoch: 58, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.8813872337341309
Epoch: 59, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.8700747489929199
Epoch: 60, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.8091363906860352
Epoch: 61, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.8215975761413574
Epoch: 62, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 0.8309488296508789
Epoch: 63, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 64 cost time: 0.8581247329711914
Epoch: 64, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 65 cost time: 0.8484194278717041
Epoch: 65, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 66 cost time: 0.9263615608215332
Epoch: 66, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 67 cost time: 0.9072754383087158
Epoch: 67, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 68 cost time: 0.9299197196960449
Epoch: 68, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 69 cost time: 0.8043441772460938
Epoch: 69, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.7853734493255615
Epoch: 70, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 71 cost time: 0.8957657814025879
Epoch: 71, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 72 cost time: 0.7958171367645264
Epoch: 72, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 73 cost time: 0.8523805141448975
Epoch: 73, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.8485541343688965
Epoch: 74, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 75 cost time: 0.8546156883239746
Epoch: 75, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8693783283233643
Epoch: 76, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 77 cost time: 0.920299768447876
Epoch: 77, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 78 cost time: 0.8135049343109131
Epoch: 78, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 79 cost time: 0.8797688484191895
Epoch: 79, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.9209067821502686
Epoch: 80, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.8983111381530762
Epoch: 81, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.956000804901123
Epoch: 82, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.9314336776733398
Epoch: 83, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.9132704734802246
Epoch: 84, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.8707370758056641
Epoch: 85, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 0.9583683013916016
Epoch: 86, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 87 cost time: 0.8023829460144043
Epoch: 87, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 88 cost time: 0.8244972229003906
Epoch: 88, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 89 cost time: 0.9371688365936279
Epoch: 89, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 90 cost time: 0.8810200691223145
Epoch: 90, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 91 cost time: 0.8847575187683105
Epoch: 91, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 92 cost time: 0.8938846588134766
Epoch: 92, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 93 cost time: 0.8482062816619873
Epoch: 93, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.8408865928649902
Epoch: 94, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.9287476539611816
Epoch: 95, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.8722741603851318
Epoch: 96, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 97 cost time: 0.893822431564331
Epoch: 97, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 98 cost time: 0.9110724925994873
Epoch: 98, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 99 cost time: 0.8150503635406494
Epoch: 99, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 100 cost time: 0.9050705432891846
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df128_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 66604
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.371607542037964
Epoch: 1, Steps: 7 | Train Loss: 2.709 Vali Loss: 2.612 Vali Acc: 0.042 Test Loss: 2.612 Test Acc: 0.042
Validation loss decreased (inf --> -0.041641).  Saving model ...
Epoch: 2 cost time: 0.9628608226776123
Epoch: 2, Steps: 7 | Train Loss: 2.573 Vali Loss: 2.500 Vali Acc: 0.097 Test Loss: 2.500 Test Acc: 0.097
Validation loss decreased (-0.041641 --> -0.097197).  Saving model ...
Epoch: 3 cost time: 0.825183629989624
Epoch: 3, Steps: 7 | Train Loss: 2.401 Vali Loss: 2.334 Vali Acc: 0.208 Test Loss: 2.334 Test Acc: 0.208
Validation loss decreased (-0.097197 --> -0.208310).  Saving model ...
Epoch: 4 cost time: 0.7747926712036133
Epoch: 4, Steps: 7 | Train Loss: 2.256 Vali Loss: 2.140 Vali Acc: 0.278 Test Loss: 2.140 Test Acc: 0.278
Validation loss decreased (-0.208310 --> -0.277756).  Saving model ...
Epoch: 5 cost time: 0.7943789958953857
Epoch: 5, Steps: 7 | Train Loss: 1.987 Vali Loss: 1.932 Vali Acc: 0.556 Test Loss: 1.932 Test Acc: 0.556
Validation loss decreased (-0.277756 --> -0.555536).  Saving model ...
Epoch: 6 cost time: 0.7237491607666016
Epoch: 6, Steps: 7 | Train Loss: 1.745 Vali Loss: 1.723 Vali Acc: 0.611 Test Loss: 1.723 Test Acc: 0.611
Validation loss decreased (-0.555536 --> -0.611094).  Saving model ...
Epoch: 7 cost time: 0.8435578346252441
Epoch: 7, Steps: 7 | Train Loss: 1.468 Vali Loss: 1.515 Vali Acc: 0.708 Test Loss: 1.515 Test Acc: 0.708
Validation loss decreased (-0.611094 --> -0.708318).  Saving model ...
Epoch: 8 cost time: 0.7755308151245117
Epoch: 8, Steps: 7 | Train Loss: 1.258 Vali Loss: 1.315 Vali Acc: 0.750 Test Loss: 1.315 Test Acc: 0.750
Validation loss decreased (-0.708318 --> -0.749987).  Saving model ...
Epoch: 9 cost time: 0.8535366058349609
Epoch: 9, Steps: 7 | Train Loss: 1.031 Vali Loss: 1.131 Vali Acc: 0.778 Test Loss: 1.131 Test Acc: 0.778
Validation loss decreased (-0.749987 --> -0.777766).  Saving model ...
Epoch: 10 cost time: 0.7679088115692139
Epoch: 10, Steps: 7 | Train Loss: 0.833 Vali Loss: 0.973 Vali Acc: 0.792 Test Loss: 0.973 Test Acc: 0.792
Validation loss decreased (-0.777766 --> -0.791657).  Saving model ...
Epoch: 11 cost time: 0.9514188766479492
Epoch: 11, Steps: 7 | Train Loss: 0.660 Vali Loss: 0.834 Vali Acc: 0.778 Test Loss: 0.834 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8140008449554443
Epoch: 12, Steps: 7 | Train Loss: 0.532 Vali Loss: 0.721 Vali Acc: 0.847 Test Loss: 0.721 Test Acc: 0.847
Validation loss decreased (-0.791657 --> -0.847215).  Saving model ...
Epoch: 13 cost time: 0.8454155921936035
Epoch: 13, Steps: 7 | Train Loss: 0.384 Vali Loss: 0.631 Vali Acc: 0.847 Test Loss: 0.631 Test Acc: 0.847
Validation loss decreased (-0.847215 --> -0.847216).  Saving model ...
Epoch: 14 cost time: 0.8210446834564209
Epoch: 14, Steps: 7 | Train Loss: 0.342 Vali Loss: 0.577 Vali Acc: 0.847 Test Loss: 0.577 Test Acc: 0.847
Validation loss decreased (-0.847216 --> -0.847216).  Saving model ...
Epoch: 15 cost time: 0.8605716228485107
Epoch: 15, Steps: 7 | Train Loss: 0.230 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
Validation loss decreased (-0.847216 --> -0.847217).  Saving model ...
Epoch: 16 cost time: 0.8042654991149902
Epoch: 16, Steps: 7 | Train Loss: 0.196 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861106).  Saving model ...
Epoch: 17 cost time: 0.8197355270385742
Epoch: 17, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.455 Vali Acc: 0.847 Test Loss: 0.455 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8631696701049805
Epoch: 18, Steps: 7 | Train Loss: 0.126 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 19 cost time: 0.8262128829956055
Epoch: 19, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 0.7968714237213135
Epoch: 20, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.402 Vali Acc: 0.889 Test Loss: 0.402 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 21 cost time: 0.7493438720703125
Epoch: 21, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9104652404785156
Epoch: 22, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8547863960266113
Epoch: 23, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.378 Vali Acc: 0.861 Test Loss: 0.378 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8032176494598389
Epoch: 24, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.372 Vali Acc: 0.861 Test Loss: 0.372 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8765048980712891
Epoch: 25, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7933180332183838
Epoch: 26, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8194859027862549
Epoch: 27, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8080234527587891
Epoch: 28, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9568371772766113
Epoch: 29, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 30 cost time: 0.9725327491760254
Epoch: 30, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9016706943511963
Epoch: 31, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 0.9588463306427002
Epoch: 32, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0469417572021484
Epoch: 33, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.908036470413208
Epoch: 34, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 1.0847129821777344
Epoch: 35, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902774).  Saving model ...
Epoch: 36 cost time: 0.8483850955963135
Epoch: 36, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8833262920379639
Epoch: 37, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.913323163986206
Epoch: 38, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8145196437835693
Epoch: 39, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8709249496459961
Epoch: 40, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8301630020141602
Epoch: 41, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.8312954902648926
Epoch: 42, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9810905456542969
Epoch: 43, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9514648914337158
Epoch: 44, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9547545909881592
Epoch: 45, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9770376682281494
Epoch: 46, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9149889945983887
Epoch: 47, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7584271430969238
Epoch: 48, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.8952398300170898
Epoch: 49, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7888693809509277
Epoch: 50, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.8992459774017334
Epoch: 51, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 63916
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4332752227783203
Epoch: 1, Steps: 7 | Train Loss: 2.608 Vali Loss: 2.407 Vali Acc: 0.097 Test Loss: 2.407 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 1.4760444164276123
Epoch: 2, Steps: 7 | Train Loss: 2.288 Vali Loss: 2.028 Vali Acc: 0.431 Test Loss: 2.028 Test Acc: 0.431
Validation loss decreased (-0.097198 --> -0.430535).  Saving model ...
Epoch: 3 cost time: 1.1214702129364014
Epoch: 3, Steps: 7 | Train Loss: 1.616 Vali Loss: 1.399 Vali Acc: 0.833 Test Loss: 1.399 Test Acc: 0.833
Validation loss decreased (-0.430535 --> -0.833319).  Saving model ...
Epoch: 4 cost time: 1.5180084705352783
Epoch: 4, Steps: 7 | Train Loss: 1.003 Vali Loss: 0.925 Vali Acc: 0.847 Test Loss: 0.925 Test Acc: 0.847
Validation loss decreased (-0.833319 --> -0.847213).  Saving model ...
Epoch: 5 cost time: 1.2683939933776855
Epoch: 5, Steps: 7 | Train Loss: 0.520 Vali Loss: 0.589 Vali Acc: 0.903 Test Loss: 0.589 Test Acc: 0.903
Validation loss decreased (-0.847213 --> -0.902772).  Saving model ...
Epoch: 6 cost time: 1.5079221725463867
Epoch: 6, Steps: 7 | Train Loss: 0.252 Vali Loss: 0.447 Vali Acc: 0.889 Test Loss: 0.447 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1583929061889648
Epoch: 7, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.344 Vali Acc: 0.903 Test Loss: 0.344 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 1.5536131858825684
Epoch: 8, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.2533276081085205
Epoch: 9, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.408912181854248
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.254141092300415
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.634955883026123
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.123652458190918
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3517069816589355
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.2300469875335693
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.7086832523345947
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.496347188949585
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.6814956665039062
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.5259382724761963
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.2955026626586914
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.4087605476379395
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.425666332244873
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.4663019180297852
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.157144546508789
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 1.1609420776367188
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 1.5039002895355225
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.465895652770996
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4916865825653076
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5238616466522217
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.5326740741729736
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2969200611114502
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2740421295166016
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5257928371429443
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 1.1792645454406738
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 1.4423167705535889
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 1.343919277191162
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.331676721572876
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3850386142730713
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.365609884262085
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.253629446029663
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.4675567150115967
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.5143287181854248
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.2608838081359863
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.6937141418457031
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.306248664855957
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 208684
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.698838949203491
Epoch: 1, Steps: 7 | Train Loss: 2.671 Vali Loss: 2.389 Vali Acc: 0.153 Test Loss: 2.389 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.8260903358459473
Epoch: 2, Steps: 7 | Train Loss: 2.367 Vali Loss: 2.036 Vali Acc: 0.403 Test Loss: 2.036 Test Acc: 0.403
Validation loss decreased (-0.152754 --> -0.402757).  Saving model ...
Epoch: 3 cost time: 0.8422689437866211
Epoch: 3, Steps: 7 | Train Loss: 1.916 Vali Loss: 1.642 Vali Acc: 0.653 Test Loss: 1.642 Test Acc: 0.653
Validation loss decreased (-0.402757 --> -0.652761).  Saving model ...
Epoch: 4 cost time: 0.8321027755737305
Epoch: 4, Steps: 7 | Train Loss: 1.451 Vali Loss: 1.216 Vali Acc: 0.792 Test Loss: 1.216 Test Acc: 0.792
Validation loss decreased (-0.652761 --> -0.791655).  Saving model ...
Epoch: 5 cost time: 0.9453365802764893
Epoch: 5, Steps: 7 | Train Loss: 0.963 Vali Loss: 0.853 Vali Acc: 0.875 Test Loss: 0.853 Test Acc: 0.875
Validation loss decreased (-0.791655 --> -0.874991).  Saving model ...
Epoch: 6 cost time: 0.8187322616577148
Epoch: 6, Steps: 7 | Train Loss: 0.622 Vali Loss: 0.636 Vali Acc: 0.847 Test Loss: 0.636 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8005776405334473
Epoch: 7, Steps: 7 | Train Loss: 0.363 Vali Loss: 0.488 Vali Acc: 0.917 Test Loss: 0.488 Test Acc: 0.917
Validation loss decreased (-0.874991 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 0.8249425888061523
Epoch: 8, Steps: 7 | Train Loss: 0.188 Vali Loss: 0.368 Vali Acc: 0.931 Test Loss: 0.368 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.8265347480773926
Epoch: 9, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8773620128631592
Epoch: 10, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9025998115539551
Epoch: 11, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.129481315612793
Epoch: 12, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.9315667152404785
Epoch: 13, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.8536779880523682
Epoch: 14, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.944342851638794
Epoch: 15, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.8852651119232178
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.009634017944336
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9331526756286621
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8851451873779297
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0097393989562988
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8842494487762451
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9004313945770264
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8597612380981445
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0176622867584229
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9021995067596436
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 117484
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.788986921310425
Epoch: 1, Steps: 7 | Train Loss: 2.517 Vali Loss: 2.476 Vali Acc: 0.139 Test Loss: 2.476 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.8778176307678223
Epoch: 2, Steps: 7 | Train Loss: 2.333 Vali Loss: 2.219 Vali Acc: 0.361 Test Loss: 2.219 Test Acc: 0.361
Validation loss decreased (-0.138864 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 0.911543607711792
Epoch: 3, Steps: 7 | Train Loss: 2.050 Vali Loss: 1.912 Vali Acc: 0.486 Test Loss: 1.912 Test Acc: 0.486
Validation loss decreased (-0.361089 --> -0.486092).  Saving model ...
Epoch: 4 cost time: 0.9697070121765137
Epoch: 4, Steps: 7 | Train Loss: 1.650 Vali Loss: 1.547 Vali Acc: 0.736 Test Loss: 1.547 Test Acc: 0.736
Validation loss decreased (-0.486092 --> -0.736096).  Saving model ...
Epoch: 5 cost time: 0.8043203353881836
Epoch: 5, Steps: 7 | Train Loss: 1.228 Vali Loss: 1.194 Vali Acc: 0.847 Test Loss: 1.194 Test Acc: 0.847
Validation loss decreased (-0.736096 --> -0.847210).  Saving model ...
Epoch: 6 cost time: 0.844012975692749
Epoch: 6, Steps: 7 | Train Loss: 0.872 Vali Loss: 0.904 Vali Acc: 0.861 Test Loss: 0.904 Test Acc: 0.861
Validation loss decreased (-0.847210 --> -0.861102).  Saving model ...
Epoch: 7 cost time: 0.7664439678192139
Epoch: 7, Steps: 7 | Train Loss: 0.583 Vali Loss: 0.656 Vali Acc: 0.875 Test Loss: 0.656 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 0.8182523250579834
Epoch: 8, Steps: 7 | Train Loss: 0.331 Vali Loss: 0.489 Vali Acc: 0.917 Test Loss: 0.489 Test Acc: 0.917
Validation loss decreased (-0.874993 --> -0.916662).  Saving model ...
Epoch: 9 cost time: 0.8286969661712646
Epoch: 9, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8914704322814941
Epoch: 10, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.345 Vali Acc: 0.944 Test Loss: 0.345 Test Acc: 0.944
Validation loss decreased (-0.916662 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 0.8509800434112549
Epoch: 11, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.926239013671875
Epoch: 12, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7120888233184814
Epoch: 13, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8819923400878906
Epoch: 14, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.7927758693695068
Epoch: 15, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.869295597076416
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7361252307891846
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9199233055114746
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7957630157470703
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.1030666828155518
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.7412247657775879
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.8750903606414795
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.8874115943908691
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.865243673324585
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.7297079563140869
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7467660903930664
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9341244697570801
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7965395450592041
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.7144923210144043
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.9255154132843018
Epoch: 30, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.9121520519256592
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.838324785232544
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.9175691604614258
Epoch: 33, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8143537044525146
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8718259334564209
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7493622303009033
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.845566987991333
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.751708984375
Epoch: 38, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7848124504089355
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8126606941223145
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8326113224029541
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.9148733615875244
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0308849811553955
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8398094177246094
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8109893798828125
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8274109363555908
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9045875072479248
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.901907205581665
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.8809559345245361
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.901444673538208
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.8746497631072998
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 88492
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df64_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.877331495285034
Epoch: 1, Steps: 7 | Train Loss: 2.656 Vali Loss: 2.573 Vali Acc: 0.056 Test Loss: 2.573 Test Acc: 0.056
Validation loss decreased (inf --> -0.055530).  Saving model ...
Epoch: 2 cost time: 0.8488128185272217
Epoch: 2, Steps: 7 | Train Loss: 2.539 Vali Loss: 2.379 Vali Acc: 0.181 Test Loss: 2.379 Test Acc: 0.181
Validation loss decreased (-0.055530 --> -0.180532).  Saving model ...
Epoch: 3 cost time: 0.9373264312744141
Epoch: 3, Steps: 7 | Train Loss: 2.216 Vali Loss: 2.098 Vali Acc: 0.431 Test Loss: 2.098 Test Acc: 0.431
Validation loss decreased (-0.180532 --> -0.430535).  Saving model ...
Epoch: 4 cost time: 0.8732645511627197
Epoch: 4, Steps: 7 | Train Loss: 1.856 Vali Loss: 1.765 Vali Acc: 0.569 Test Loss: 1.765 Test Acc: 0.569
Validation loss decreased (-0.430535 --> -0.569427).  Saving model ...
Epoch: 5 cost time: 0.885347843170166
Epoch: 5, Steps: 7 | Train Loss: 1.471 Vali Loss: 1.432 Vali Acc: 0.708 Test Loss: 1.432 Test Acc: 0.708
Validation loss decreased (-0.569427 --> -0.708319).  Saving model ...
Epoch: 6 cost time: 0.9181218147277832
Epoch: 6, Steps: 7 | Train Loss: 1.125 Vali Loss: 1.140 Vali Acc: 0.792 Test Loss: 1.140 Test Acc: 0.792
Validation loss decreased (-0.708319 --> -0.791655).  Saving model ...
Epoch: 7 cost time: 0.818202018737793
Epoch: 7, Steps: 7 | Train Loss: 0.796 Vali Loss: 0.882 Vali Acc: 0.792 Test Loss: 0.882 Test Acc: 0.792
Validation loss decreased (-0.791655 --> -0.791658).  Saving model ...
Epoch: 8 cost time: 0.9814586639404297
Epoch: 8, Steps: 7 | Train Loss: 0.515 Vali Loss: 0.662 Vali Acc: 0.806 Test Loss: 0.662 Test Acc: 0.806
Validation loss decreased (-0.791658 --> -0.805549).  Saving model ...
Epoch: 9 cost time: 0.9573707580566406
Epoch: 9, Steps: 7 | Train Loss: 0.338 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
Validation loss decreased (-0.805549 --> -0.819439).  Saving model ...
Epoch: 10 cost time: 0.8640570640563965
Epoch: 10, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.461 Vali Acc: 0.833 Test Loss: 0.461 Test Acc: 0.833
Validation loss decreased (-0.819439 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 0.8927967548370361
Epoch: 11, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 0.8581492900848389
Epoch: 12, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 13 cost time: 0.9539675712585449
Epoch: 13, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.356 Vali Acc: 0.861 Test Loss: 0.356 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 0.8065290451049805
Epoch: 14, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 0.8358349800109863
Epoch: 15, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.320 Vali Acc: 0.847 Test Loss: 0.320 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9567911624908447
Epoch: 16, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.311 Vali Acc: 0.847 Test Loss: 0.311 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9828083515167236
Epoch: 17, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.0789337158203125
Epoch: 18, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 19 cost time: 0.9372797012329102
Epoch: 19, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 20 cost time: 0.8615913391113281
Epoch: 20, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.279 Vali Acc: 0.861 Test Loss: 0.279 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8666896820068359
Epoch: 21, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.276 Vali Acc: 0.861 Test Loss: 0.276 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9532163143157959
Epoch: 22, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.268 Vali Acc: 0.875 Test Loss: 0.268 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 23 cost time: 1.0045158863067627
Epoch: 23, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.267 Vali Acc: 0.875 Test Loss: 0.267 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 24 cost time: 0.932396650314331
Epoch: 24, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.264 Vali Acc: 0.875 Test Loss: 0.264 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 25 cost time: 1.0092976093292236
Epoch: 25, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.262 Vali Acc: 0.875 Test Loss: 0.262 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 26 cost time: 0.8467123508453369
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.258 Vali Acc: 0.875 Test Loss: 0.258 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 27 cost time: 0.9075286388397217
Epoch: 27, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.8989231586456299
Epoch: 28, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.8794381618499756
Epoch: 29, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.9034523963928223
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 0.9632642269134521
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.875 Test Loss: 0.242 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9551212787628174
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.875 Test Loss: 0.242 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0269522666931152
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.875 Test Loss: 0.244 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9334955215454102
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.875 Test Loss: 0.245 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9398736953735352
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.875 Test Loss: 0.243 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9354009628295898
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.875 Test Loss: 0.244 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0741016864776611
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.875 Test Loss: 0.244 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.007768154144287
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.875 Test Loss: 0.239 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9145917892456055
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.875 Test Loss: 0.236 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8370375633239746
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.875 Test Loss: 0.234 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df64_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 73324
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.855830669403076
Epoch: 1, Steps: 7 | Train Loss: 2.630 Vali Loss: 2.602 Vali Acc: 0.056 Test Loss: 2.602 Test Acc: 0.056
Validation loss decreased (inf --> -0.055530).  Saving model ...
Epoch: 2 cost time: 0.9533083438873291
Epoch: 2, Steps: 7 | Train Loss: 2.529 Vali Loss: 2.424 Vali Acc: 0.194 Test Loss: 2.424 Test Acc: 0.194
Validation loss decreased (-0.055530 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 0.9457767009735107
Epoch: 3, Steps: 7 | Train Loss: 2.336 Vali Loss: 2.172 Vali Acc: 0.361 Test Loss: 2.172 Test Acc: 0.361
Validation loss decreased (-0.194420 --> -0.361089).  Saving model ...
Epoch: 4 cost time: 1.0404295921325684
Epoch: 4, Steps: 7 | Train Loss: 2.009 Vali Loss: 1.878 Vali Acc: 0.569 Test Loss: 1.878 Test Acc: 0.569
Validation loss decreased (-0.361089 --> -0.569426).  Saving model ...
Epoch: 5 cost time: 0.9829421043395996
Epoch: 5, Steps: 7 | Train Loss: 1.700 Vali Loss: 1.579 Vali Acc: 0.639 Test Loss: 1.579 Test Acc: 0.639
Validation loss decreased (-0.569426 --> -0.638873).  Saving model ...
Epoch: 6 cost time: 0.9433755874633789
Epoch: 6, Steps: 7 | Train Loss: 1.383 Vali Loss: 1.296 Vali Acc: 0.792 Test Loss: 1.296 Test Acc: 0.792
Validation loss decreased (-0.638873 --> -0.791654).  Saving model ...
Epoch: 7 cost time: 0.9546515941619873
Epoch: 7, Steps: 7 | Train Loss: 1.085 Vali Loss: 1.041 Vali Acc: 0.792 Test Loss: 1.041 Test Acc: 0.792
Validation loss decreased (-0.791654 --> -0.791656).  Saving model ...
Epoch: 8 cost time: 0.9044239521026611
Epoch: 8, Steps: 7 | Train Loss: 0.820 Vali Loss: 0.814 Vali Acc: 0.833 Test Loss: 0.814 Test Acc: 0.833
Validation loss decreased (-0.791656 --> -0.833325).  Saving model ...
Epoch: 9 cost time: 0.8687238693237305
Epoch: 9, Steps: 7 | Train Loss: 0.586 Vali Loss: 0.646 Vali Acc: 0.875 Test Loss: 0.646 Test Acc: 0.875
Validation loss decreased (-0.833325 --> -0.874994).  Saving model ...
Epoch: 10 cost time: 0.8459632396697998
Epoch: 10, Steps: 7 | Train Loss: 0.419 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 11 cost time: 0.9158813953399658
Epoch: 11, Steps: 7 | Train Loss: 0.292 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 0.9564323425292969
Epoch: 12, Steps: 7 | Train Loss: 0.199 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8819410800933838
Epoch: 13, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.381 Vali Acc: 0.889 Test Loss: 0.381 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.8932914733886719
Epoch: 14, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 0.9392907619476318
Epoch: 15, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.027691125869751
Epoch: 16, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.8527321815490723
Epoch: 17, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.911945104598999
Epoch: 18, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.017381191253662
Epoch: 19, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.9050369262695312
Epoch: 20, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.869189977645874
Epoch: 21, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 1.062328577041626
Epoch: 22, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.9227173328399658
Epoch: 23, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9636731147766113
Epoch: 24, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9539172649383545
Epoch: 25, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9141349792480469
Epoch: 26, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.868659257888794
Epoch: 27, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.9112720489501953
Epoch: 28, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.9591543674468994
Epoch: 29, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9948287010192871
Epoch: 30, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1291885375976562
Epoch: 31, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.9535007476806641
Epoch: 32, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1270551681518555
Epoch: 33, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9626002311706543
Epoch: 34, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 1.1318843364715576
Epoch: 35, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.957237958908081
Epoch: 36, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 1.0665733814239502
Epoch: 37, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.9376692771911621
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9588539600372314
Epoch: 39, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.9938299655914307
Epoch: 40, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.9732439517974854
Epoch: 41, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.9073693752288818
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.9371399879455566
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.9790372848510742
Epoch: 44, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 1.034226894378662
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1751108169555664
Epoch: 46, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9665515422821045
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9874029159545898
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.8821773529052734
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.9304702281951904
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9212493896484375
Epoch: 51, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 0.9178214073181152
Epoch: 52, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 0.8977875709533691
Epoch: 53, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.9097011089324951
Epoch: 54, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 0.8993923664093018
Epoch: 55, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 0.8796718120574951
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 0.9803333282470703
Epoch: 57, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9923326969146729
Epoch: 58, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9007656574249268
Epoch: 59, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.9496147632598877
Epoch: 60, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 0.9717807769775391
Epoch: 61, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 62 cost time: 0.9716768264770508
Epoch: 62, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.9392311573028564
Epoch: 63, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.9253096580505371
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.9739415645599365
Epoch: 65, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.9660220146179199
Epoch: 66, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.9248273372650146
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 68 cost time: 0.9387259483337402
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 69 cost time: 1.0057005882263184
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 70 cost time: 0.9566764831542969
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.976337194442749
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 72 cost time: 0.9323318004608154
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 73 cost time: 0.9429342746734619
Epoch: 73, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 74 cost time: 0.9581329822540283
Epoch: 74, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 75 cost time: 0.9381487369537354
Epoch: 75, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.9522109031677246
Epoch: 76, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.9989678859710693
Epoch: 77, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 78 cost time: 0.9059209823608398
Epoch: 78, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.9763226509094238
Epoch: 79, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.947681188583374
Epoch: 80, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 81 cost time: 0.9126360416412354
Epoch: 81, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.8433718681335449
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 83 cost time: 0.9179589748382568
Epoch: 83, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 84 cost time: 0.9469327926635742
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 85 cost time: 0.9732351303100586
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.9736919403076172
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.8929574489593506
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.9832839965820312
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 1.018022060394287
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 1.0164361000061035
Epoch: 90, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 91 cost time: 0.8672873973846436
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.9384398460388184
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.9095966815948486
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.9124126434326172
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.9218406677246094
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.9334776401519775
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 0.8706085681915283
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.8673207759857178
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 0.9800722599029541
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 0.8974626064300537
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 61420
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df64_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5512712001800537
Epoch: 1, Steps: 7 | Train Loss: 2.608 Vali Loss: 2.536 Vali Acc: 0.167 Test Loss: 2.536 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 0.9274585247039795
Epoch: 2, Steps: 7 | Train Loss: 2.514 Vali Loss: 2.396 Vali Acc: 0.222 Test Loss: 2.396 Test Acc: 0.222
Validation loss decreased (-0.166641 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 0.8061859607696533
Epoch: 3, Steps: 7 | Train Loss: 2.281 Vali Loss: 2.203 Vali Acc: 0.347 Test Loss: 2.203 Test Acc: 0.347
Validation loss decreased (-0.222198 --> -0.347200).  Saving model ...
Epoch: 4 cost time: 0.8513987064361572
Epoch: 4, Steps: 7 | Train Loss: 2.088 Vali Loss: 1.984 Vali Acc: 0.458 Test Loss: 1.984 Test Acc: 0.458
Validation loss decreased (-0.347200 --> -0.458313).  Saving model ...
Epoch: 5 cost time: 0.9089317321777344
Epoch: 5, Steps: 7 | Train Loss: 1.875 Vali Loss: 1.756 Vali Acc: 0.611 Test Loss: 1.756 Test Acc: 0.611
Validation loss decreased (-0.458313 --> -0.611094).  Saving model ...
Epoch: 6 cost time: 0.9126465320587158
Epoch: 6, Steps: 7 | Train Loss: 1.581 Vali Loss: 1.518 Vali Acc: 0.708 Test Loss: 1.518 Test Acc: 0.708
Validation loss decreased (-0.611094 --> -0.708318).  Saving model ...
Epoch: 7 cost time: 0.9429805278778076
Epoch: 7, Steps: 7 | Train Loss: 1.339 Vali Loss: 1.294 Vali Acc: 0.778 Test Loss: 1.294 Test Acc: 0.778
Validation loss decreased (-0.708318 --> -0.777765).  Saving model ...
Epoch: 8 cost time: 0.854931116104126
Epoch: 8, Steps: 7 | Train Loss: 1.031 Vali Loss: 1.078 Vali Acc: 0.806 Test Loss: 1.078 Test Acc: 0.806
Validation loss decreased (-0.777765 --> -0.805545).  Saving model ...
Epoch: 9 cost time: 0.9343116283416748
Epoch: 9, Steps: 7 | Train Loss: 0.855 Vali Loss: 0.881 Vali Acc: 0.833 Test Loss: 0.881 Test Acc: 0.833
Validation loss decreased (-0.805545 --> -0.833325).  Saving model ...
Epoch: 10 cost time: 0.9004228115081787
Epoch: 10, Steps: 7 | Train Loss: 0.624 Vali Loss: 0.724 Vali Acc: 0.861 Test Loss: 0.724 Test Acc: 0.861
Validation loss decreased (-0.833325 --> -0.861104).  Saving model ...
Epoch: 11 cost time: 0.9212131500244141
Epoch: 11, Steps: 7 | Train Loss: 0.463 Vali Loss: 0.604 Vali Acc: 0.847 Test Loss: 0.604 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9197802543640137
Epoch: 12, Steps: 7 | Train Loss: 0.334 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861106).  Saving model ...
Epoch: 13 cost time: 0.9038636684417725
Epoch: 13, Steps: 7 | Train Loss: 0.252 Vali Loss: 0.455 Vali Acc: 0.861 Test Loss: 0.455 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 0.886817455291748
Epoch: 14, Steps: 7 | Train Loss: 0.204 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 0.8330919742584229
Epoch: 15, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 16 cost time: 0.9884076118469238
Epoch: 16, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 0.8559365272521973
Epoch: 17, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9242486953735352
Epoch: 18, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9377231597900391
Epoch: 19, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.999133825302124
Epoch: 20, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.9542937278747559
Epoch: 21, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 1.0057940483093262
Epoch: 22, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8865475654602051
Epoch: 23, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.9239335060119629
Epoch: 24, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.8150014877319336
Epoch: 25, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.8746395111083984
Epoch: 26, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.851482629776001
Epoch: 27, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.9519715309143066
Epoch: 28, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9560267925262451
Epoch: 29, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.9741470813751221
Epoch: 30, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.9268229007720947
Epoch: 31, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.94339919090271
Epoch: 32, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.8392939567565918
Epoch: 33, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9472613334655762
Epoch: 34, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8509888648986816
Epoch: 35, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.9491539001464844
Epoch: 36, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9127655029296875
Epoch: 37, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.7927460670471191
Epoch: 38, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.9072062969207764
Epoch: 39, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.9046914577484131
Epoch: 40, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.9355285167694092
Epoch: 41, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.9354496002197266
Epoch: 42, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.864544153213501
Epoch: 43, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8482518196105957
Epoch: 44, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7681441307067871
Epoch: 45, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.8642899990081787
Epoch: 46, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.9448151588439941
Epoch: 47, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.8307180404663086
Epoch: 48, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.8085355758666992
Epoch: 49, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 1.0094842910766602
Epoch: 50, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 0.919318675994873
Epoch: 51, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.978057861328125
Epoch: 52, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9756879806518555
Epoch: 53, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 0.9434599876403809
Epoch: 54, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 0.982588529586792
Epoch: 55, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 56 cost time: 1.0091259479522705
Epoch: 56, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 57 cost time: 0.9170277118682861
Epoch: 57, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 58 cost time: 1.0438334941864014
Epoch: 58, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 59 cost time: 0.9003245830535889
Epoch: 59, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 60 cost time: 0.883671760559082
Epoch: 60, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9798383712768555
Epoch: 61, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9044544696807861
Epoch: 62, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.0343396663665771
Epoch: 63, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 64 cost time: 1.0280430316925049
Epoch: 64, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 65 cost time: 0.9278602600097656
Epoch: 65, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 66 cost time: 0.9307339191436768
Epoch: 66, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9078059196472168
Epoch: 67, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.0635197162628174
Epoch: 68, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 69 cost time: 1.0689647197723389
Epoch: 69, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 70 cost time: 0.9754648208618164
Epoch: 70, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 71 cost time: 0.9963257312774658
Epoch: 71, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 72 cost time: 0.9517636299133301
Epoch: 72, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 73 cost time: 0.8938877582550049
Epoch: 73, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.0475654602050781
Epoch: 74, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.9743170738220215
Epoch: 75, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.9201734066009521
Epoch: 76, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.0445702075958252
Epoch: 77, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.0575811862945557
Epoch: 78, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 79 cost time: 0.9614439010620117
Epoch: 79, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 80 cost time: 1.0346426963806152
Epoch: 80, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.9202175140380859
Epoch: 81, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.9257688522338867
Epoch: 82, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.8733766078948975
Epoch: 83, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.8797121047973633
Epoch: 84, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 85 cost time: 0.9209127426147461
Epoch: 85, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 86 cost time: 0.794567346572876
Epoch: 86, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 87 cost time: 0.8390486240386963
Epoch: 87, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.9930639266967773
Epoch: 88, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 0.9854147434234619
Epoch: 89, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.9695806503295898
Epoch: 90, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 0.9003279209136963
Epoch: 91, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 0.9569900035858154
Epoch: 92, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 1.2543752193450928
Epoch: 93, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 0.9103693962097168
Epoch: 94, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 0.9885025024414062
Epoch: 95, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 96 cost time: 0.8947916030883789
Epoch: 96, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.0090692043304443
Epoch: 97, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.888545036315918
Epoch: 98, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 99 cost time: 0.9834933280944824
Epoch: 99, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 0.9399893283843994
Epoch: 100, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df64_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 54124
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.048213005065918
Epoch: 1, Steps: 7 | Train Loss: 2.621 Vali Loss: 2.728 Vali Acc: 0.083 Test Loss: 2.728 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 0.9273684024810791
Epoch: 2, Steps: 7 | Train Loss: 2.564 Vali Loss: 2.575 Vali Acc: 0.056 Test Loss: 2.575 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0800011157989502
Epoch: 3, Steps: 7 | Train Loss: 2.416 Vali Loss: 2.370 Vali Acc: 0.111 Test Loss: 2.370 Test Acc: 0.111
Validation loss decreased (-0.083306 --> -0.111087).  Saving model ...
Epoch: 4 cost time: 0.8843481540679932
Epoch: 4, Steps: 7 | Train Loss: 2.124 Vali Loss: 2.138 Vali Acc: 0.306 Test Loss: 2.138 Test Acc: 0.306
Validation loss decreased (-0.111087 --> -0.305534).  Saving model ...
Epoch: 5 cost time: 0.9978048801422119
Epoch: 5, Steps: 7 | Train Loss: 1.944 Vali Loss: 1.903 Vali Acc: 0.528 Test Loss: 1.903 Test Acc: 0.528
Validation loss decreased (-0.305534 --> -0.527759).  Saving model ...
Epoch: 6 cost time: 0.8859741687774658
Epoch: 6, Steps: 7 | Train Loss: 1.658 Vali Loss: 1.667 Vali Acc: 0.639 Test Loss: 1.667 Test Acc: 0.639
Validation loss decreased (-0.527759 --> -0.638872).  Saving model ...
Epoch: 7 cost time: 1.0040512084960938
Epoch: 7, Steps: 7 | Train Loss: 1.381 Vali Loss: 1.442 Vali Acc: 0.764 Test Loss: 1.442 Test Acc: 0.764
Validation loss decreased (-0.638872 --> -0.763874).  Saving model ...
Epoch: 8 cost time: 0.9953432083129883
Epoch: 8, Steps: 7 | Train Loss: 1.185 Vali Loss: 1.237 Vali Acc: 0.806 Test Loss: 1.237 Test Acc: 0.806
Validation loss decreased (-0.763874 --> -0.805543).  Saving model ...
Epoch: 9 cost time: 0.9704968929290771
Epoch: 9, Steps: 7 | Train Loss: 0.969 Vali Loss: 1.056 Vali Acc: 0.833 Test Loss: 1.056 Test Acc: 0.833
Validation loss decreased (-0.805543 --> -0.833323).  Saving model ...
Epoch: 10 cost time: 0.9182679653167725
Epoch: 10, Steps: 7 | Train Loss: 0.762 Vali Loss: 0.900 Vali Acc: 0.861 Test Loss: 0.900 Test Acc: 0.861
Validation loss decreased (-0.833323 --> -0.861102).  Saving model ...
Epoch: 11 cost time: 0.9533319473266602
Epoch: 11, Steps: 7 | Train Loss: 0.590 Vali Loss: 0.778 Vali Acc: 0.861 Test Loss: 0.778 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861103).  Saving model ...
Epoch: 12 cost time: 0.8061981201171875
Epoch: 12, Steps: 7 | Train Loss: 0.448 Vali Loss: 0.679 Vali Acc: 0.875 Test Loss: 0.679 Test Acc: 0.875
Validation loss decreased (-0.861103 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 0.9611606597900391
Epoch: 13, Steps: 7 | Train Loss: 0.353 Vali Loss: 0.614 Vali Acc: 0.875 Test Loss: 0.614 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 14 cost time: 0.7653241157531738
Epoch: 14, Steps: 7 | Train Loss: 0.261 Vali Loss: 0.547 Vali Acc: 0.875 Test Loss: 0.547 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 0.9494969844818115
Epoch: 15, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 16 cost time: 0.8499336242675781
Epoch: 16, Steps: 7 | Train Loss: 0.174 Vali Loss: 0.466 Vali Acc: 0.861 Test Loss: 0.466 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9905393123626709
Epoch: 17, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.442 Vali Acc: 0.861 Test Loss: 0.442 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8908653259277344
Epoch: 18, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.426 Vali Acc: 0.861 Test Loss: 0.426 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9449863433837891
Epoch: 19, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.413 Vali Acc: 0.861 Test Loss: 0.413 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9430484771728516
Epoch: 20, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 21 cost time: 0.9475853443145752
Epoch: 21, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.387 Vali Acc: 0.889 Test Loss: 0.387 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 22 cost time: 0.8860909938812256
Epoch: 22, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0214958190917969
Epoch: 23, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.942934513092041
Epoch: 24, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.372 Vali Acc: 0.847 Test Loss: 0.372 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9298062324523926
Epoch: 25, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.365 Vali Acc: 0.861 Test Loss: 0.365 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8923475742340088
Epoch: 26, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9031691551208496
Epoch: 27, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9714083671569824
Epoch: 28, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9249370098114014
Epoch: 29, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 30 cost time: 0.9457497596740723
Epoch: 30, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9172892570495605
Epoch: 31, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9678969383239746
Epoch: 32, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.055290937423706
Epoch: 33, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 34 cost time: 0.8947343826293945
Epoch: 34, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 0.9494190216064453
Epoch: 35, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 0.9017040729522705
Epoch: 36, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 0.9506332874298096
Epoch: 37, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 0.981285810470581
Epoch: 38, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9804952144622803
Epoch: 39, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.010221004486084
Epoch: 40, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9369218349456787
Epoch: 41, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8688976764678955
Epoch: 42, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 0.9103617668151855
Epoch: 43, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 44 cost time: 0.905137300491333
Epoch: 44, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 0.9460864067077637
Epoch: 45, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 0.9732367992401123
Epoch: 46, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 47 cost time: 0.8813879489898682
Epoch: 47, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 48 cost time: 0.7585029602050781
Epoch: 48, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9181849956512451
Epoch: 49, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 50 cost time: 0.9772379398345947
Epoch: 50, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 51 cost time: 1.0129351615905762
Epoch: 51, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 52 cost time: 0.9326913356781006
Epoch: 52, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 53 cost time: 0.9139184951782227
Epoch: 53, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8588972091674805
Epoch: 54, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.9529759883880615
Epoch: 55, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8916854858398438
Epoch: 56, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.874565601348877
Epoch: 57, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8596658706665039
Epoch: 58, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.9470977783203125
Epoch: 59, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.9078655242919922
Epoch: 60, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.9605250358581543
Epoch: 61, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.8383705615997314
Epoch: 62, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 0.9360864162445068
Epoch: 63, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8489284515380859
Epoch: 64, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.0530970096588135
Epoch: 65, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8669490814208984
Epoch: 66, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.9935116767883301
Epoch: 67, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.9457790851593018
Epoch: 68, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.8724257946014404
Epoch: 69, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.9763069152832031
Epoch: 70, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.8759596347808838
Epoch: 71, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 72 cost time: 0.8791513442993164
Epoch: 72, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 73 cost time: 0.9336228370666504
Epoch: 73, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 74 cost time: 1.0053186416625977
Epoch: 74, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.9672443866729736
Epoch: 75, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.0211384296417236
Epoch: 76, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 77 cost time: 1.0038938522338867
Epoch: 77, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.8281388282775879
Epoch: 78, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.8841843605041504
Epoch: 79, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.9220271110534668
Epoch: 80, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.0311229228973389
Epoch: 81, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 82 cost time: 0.8611412048339844
Epoch: 82, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.0050153732299805
Epoch: 83, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.9252042770385742
Epoch: 84, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 85 cost time: 0.8893823623657227
Epoch: 85, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 86 cost time: 0.8554308414459229
Epoch: 86, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 87 cost time: 0.9265997409820557
Epoch: 87, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 88 cost time: 0.9027552604675293
Epoch: 88, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 89 cost time: 0.9021124839782715
Epoch: 89, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 90 cost time: 0.9706070423126221
Epoch: 90, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 91 cost time: 0.9193174839019775
Epoch: 91, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.9845559597015381
Epoch: 92, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.903907060623169
Epoch: 93, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 94 cost time: 1.0639762878417969
Epoch: 94, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.9045979976654053
Epoch: 95, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.9745452404022217
Epoch: 96, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 0.9343352317810059
Epoch: 97, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 0.8819737434387207
Epoch: 98, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 0.8284752368927002
Epoch: 99, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 0.9067983627319336
Epoch: 100, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm32_nh4_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 51436
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6035797595977783
Epoch: 1, Steps: 7 | Train Loss: 2.666 Vali Loss: 2.577 Vali Acc: 0.139 Test Loss: 2.577 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 0.844423770904541
Epoch: 2, Steps: 7 | Train Loss: 2.514 Vali Loss: 2.360 Vali Acc: 0.194 Test Loss: 2.360 Test Acc: 0.194
Validation loss decreased (-0.138863 --> -0.194421).  Saving model ...
Epoch: 3 cost time: 0.8730518817901611
Epoch: 3, Steps: 7 | Train Loss: 2.257 Vali Loss: 2.051 Vali Acc: 0.431 Test Loss: 2.051 Test Acc: 0.431
Validation loss decreased (-0.194421 --> -0.430535).  Saving model ...
Epoch: 4 cost time: 0.8582308292388916
Epoch: 4, Steps: 7 | Train Loss: 1.895 Vali Loss: 1.656 Vali Acc: 0.694 Test Loss: 1.656 Test Acc: 0.694
Validation loss decreased (-0.430535 --> -0.694428).  Saving model ...
Epoch: 5 cost time: 0.8352437019348145
Epoch: 5, Steps: 7 | Train Loss: 1.396 Vali Loss: 1.248 Vali Acc: 0.792 Test Loss: 1.248 Test Acc: 0.792
Validation loss decreased (-0.694428 --> -0.791654).  Saving model ...
Epoch: 6 cost time: 0.919348955154419
Epoch: 6, Steps: 7 | Train Loss: 0.943 Vali Loss: 0.902 Vali Acc: 0.861 Test Loss: 0.902 Test Acc: 0.861
Validation loss decreased (-0.791654 --> -0.861102).  Saving model ...
Epoch: 7 cost time: 0.824059009552002
Epoch: 7, Steps: 7 | Train Loss: 0.614 Vali Loss: 0.643 Vali Acc: 0.875 Test Loss: 0.643 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 0.936687707901001
Epoch: 8, Steps: 7 | Train Loss: 0.298 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 0.8297934532165527
Epoch: 9, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.393 Vali Acc: 0.889 Test Loss: 0.393 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.990455150604248
Epoch: 10, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8732399940490723
Epoch: 11, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.8702847957611084
Epoch: 12, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.9173731803894043
Epoch: 13, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.9211990833282471
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.8992388248443604
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.8648343086242676
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8263411521911621
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8418903350830078
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8710343837738037
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8227722644805908
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9704365730285645
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8924694061279297
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.8684818744659424
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.9136486053466797
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9343812465667725
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.986663818359375
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.9886784553527832
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.8544294834136963
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.9321813583374023
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.938624382019043
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.8537325859069824
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.9919586181640625
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.9142765998840332
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.932060956954956
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.9305675029754639
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.8699784278869629
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.8988633155822754
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.9141285419464111
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8518595695495605
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9140169620513916
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.8367960453033447
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.9599061012268066
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 0.8751778602600098
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9176201820373535
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.884286642074585
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9530050754547119
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7828333377838135
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.8363192081451416
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.8487553596496582
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.8367595672607422
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 51 cost time: 1.011047124862671
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 52 cost time: 0.86734938621521
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 0.9492406845092773
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 54 cost time: 0.7913990020751953
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 55 cost time: 0.8398900032043457
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 56 cost time: 0.9059600830078125
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 57 cost time: 0.8456430435180664
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 58 cost time: 0.8453347682952881
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 59 cost time: 0.8029217720031738
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 60 cost time: 0.8785915374755859
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 61 cost time: 0.9430367946624756
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9091317653656006
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 63 cost time: 0.9162671566009521
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 64 cost time: 0.8632745742797852
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 65 cost time: 0.9734673500061035
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 66 cost time: 0.9257588386535645
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9386625289916992
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.8610091209411621
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.8398065567016602
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.9576091766357422
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.8976595401763916
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.9259440898895264
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.9341328144073486
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.036137580871582
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.966677188873291
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 120380
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7476730346679688
Epoch: 1, Steps: 7 | Train Loss: 2.653 Vali Loss: 2.484 Vali Acc: 0.069 Test Loss: 2.484 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.9032855033874512
Epoch: 2, Steps: 7 | Train Loss: 2.454 Vali Loss: 2.289 Vali Acc: 0.194 Test Loss: 2.289 Test Acc: 0.194
Validation loss decreased (-0.069420 --> -0.194422).  Saving model ...
Epoch: 3 cost time: 0.8309893608093262
Epoch: 3, Steps: 7 | Train Loss: 2.253 Vali Loss: 2.028 Vali Acc: 0.347 Test Loss: 2.028 Test Acc: 0.347
Validation loss decreased (-0.194422 --> -0.347202).  Saving model ...
Epoch: 4 cost time: 0.9264512062072754
Epoch: 4, Steps: 7 | Train Loss: 1.886 Vali Loss: 1.739 Vali Acc: 0.653 Test Loss: 1.739 Test Acc: 0.653
Validation loss decreased (-0.347202 --> -0.652760).  Saving model ...
Epoch: 5 cost time: 0.97613525390625
Epoch: 5, Steps: 7 | Train Loss: 1.572 Vali Loss: 1.407 Vali Acc: 0.764 Test Loss: 1.407 Test Acc: 0.764
Validation loss decreased (-0.652760 --> -0.763875).  Saving model ...
Epoch: 6 cost time: 0.9596550464630127
Epoch: 6, Steps: 7 | Train Loss: 1.214 Vali Loss: 1.094 Vali Acc: 0.847 Test Loss: 1.094 Test Acc: 0.847
Validation loss decreased (-0.763875 --> -0.847211).  Saving model ...
Epoch: 7 cost time: 0.8843216896057129
Epoch: 7, Steps: 7 | Train Loss: 0.869 Vali Loss: 0.798 Vali Acc: 0.903 Test Loss: 0.798 Test Acc: 0.903
Validation loss decreased (-0.847211 --> -0.902770).  Saving model ...
Epoch: 8 cost time: 0.933452844619751
Epoch: 8, Steps: 7 | Train Loss: 0.560 Vali Loss: 0.577 Vali Acc: 0.903 Test Loss: 0.577 Test Acc: 0.903
Validation loss decreased (-0.902770 --> -0.902772).  Saving model ...
Epoch: 9 cost time: 1.008824348449707
Epoch: 9, Steps: 7 | Train Loss: 0.347 Vali Loss: 0.455 Vali Acc: 0.917 Test Loss: 0.455 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916662).  Saving model ...
Epoch: 10 cost time: 0.9436774253845215
Epoch: 10, Steps: 7 | Train Loss: 0.205 Vali Loss: 0.378 Vali Acc: 0.917 Test Loss: 0.378 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.992344856262207
Epoch: 11, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 1.061525821685791
Epoch: 12, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.300 Vali Acc: 0.958 Test Loss: 0.300 Test Acc: 0.958
Validation loss decreased (-0.916663 --> -0.958330).  Saving model ...
Epoch: 13 cost time: 0.9284241199493408
Epoch: 13, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9865968227386475
Epoch: 14, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9777638912200928
Epoch: 15, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0379676818847656
Epoch: 16, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8932054042816162
Epoch: 17, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.085411787033081
Epoch: 18, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.033294677734375
Epoch: 19, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9846107959747314
Epoch: 20, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0730721950531006
Epoch: 21, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9669933319091797
Epoch: 22, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 74780
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.9447782039642334
Epoch: 1, Steps: 7 | Train Loss: 2.519 Vali Loss: 2.459 Vali Acc: 0.069 Test Loss: 2.459 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.9658036231994629
Epoch: 2, Steps: 7 | Train Loss: 2.399 Vali Loss: 2.317 Vali Acc: 0.125 Test Loss: 2.317 Test Acc: 0.125
Validation loss decreased (-0.069420 --> -0.124977).  Saving model ...
Epoch: 3 cost time: 0.9498815536499023
Epoch: 3, Steps: 7 | Train Loss: 2.195 Vali Loss: 2.105 Vali Acc: 0.278 Test Loss: 2.105 Test Acc: 0.278
Validation loss decreased (-0.124977 --> -0.277757).  Saving model ...
Epoch: 4 cost time: 0.9376366138458252
Epoch: 4, Steps: 7 | Train Loss: 1.855 Vali Loss: 1.857 Vali Acc: 0.514 Test Loss: 1.857 Test Acc: 0.514
Validation loss decreased (-0.277757 --> -0.513870).  Saving model ...
Epoch: 5 cost time: 0.8980300426483154
Epoch: 5, Steps: 7 | Train Loss: 1.633 Vali Loss: 1.579 Vali Acc: 0.681 Test Loss: 1.579 Test Acc: 0.681
Validation loss decreased (-0.513870 --> -0.680540).  Saving model ...
Epoch: 6 cost time: 1.0083742141723633
Epoch: 6, Steps: 7 | Train Loss: 1.346 Vali Loss: 1.294 Vali Acc: 0.736 Test Loss: 1.294 Test Acc: 0.736
Validation loss decreased (-0.680540 --> -0.736098).  Saving model ...
Epoch: 7 cost time: 0.9920737743377686
Epoch: 7, Steps: 7 | Train Loss: 1.030 Vali Loss: 1.030 Vali Acc: 0.764 Test Loss: 1.030 Test Acc: 0.764
Validation loss decreased (-0.736098 --> -0.763879).  Saving model ...
Epoch: 8 cost time: 0.9450881481170654
Epoch: 8, Steps: 7 | Train Loss: 0.772 Vali Loss: 0.814 Vali Acc: 0.806 Test Loss: 0.814 Test Acc: 0.806
Validation loss decreased (-0.763879 --> -0.805547).  Saving model ...
Epoch: 9 cost time: 0.7857353687286377
Epoch: 9, Steps: 7 | Train Loss: 0.536 Vali Loss: 0.636 Vali Acc: 0.875 Test Loss: 0.636 Test Acc: 0.875
Validation loss decreased (-0.805547 --> -0.874994).  Saving model ...
Epoch: 10 cost time: 0.9860920906066895
Epoch: 10, Steps: 7 | Train Loss: 0.371 Vali Loss: 0.536 Vali Acc: 0.833 Test Loss: 0.536 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0664596557617188
Epoch: 11, Steps: 7 | Train Loss: 0.285 Vali Loss: 0.477 Vali Acc: 0.847 Test Loss: 0.477 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8662738800048828
Epoch: 12, Steps: 7 | Train Loss: 0.187 Vali Loss: 0.418 Vali Acc: 0.861 Test Loss: 0.418 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0271925926208496
Epoch: 13, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.8442466259002686
Epoch: 14, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 0.8950278759002686
Epoch: 15, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.7416970729827881
Epoch: 16, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.817427396774292
Epoch: 17, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.9024837017059326
Epoch: 18, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9214797019958496
Epoch: 19, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9549398422241211
Epoch: 20, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.8768301010131836
Epoch: 21, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.9135828018188477
Epoch: 22, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.8710677623748779
Epoch: 23, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0709130764007568
Epoch: 24, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.9214341640472412
Epoch: 25, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8546133041381836
Epoch: 26, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.022900104522705
Epoch: 27, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.9229207038879395
Epoch: 28, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.8753981590270996
Epoch: 29, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.9103379249572754
Epoch: 30, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.0325958728790283
Epoch: 31, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.9475836753845215
Epoch: 32, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.7833530902862549
Epoch: 33, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.1090974807739258
Epoch: 34, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.121736764907837
Epoch: 35, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 1.0281994342803955
Epoch: 36, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.962522029876709
Epoch: 37, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.9678514003753662
Epoch: 38, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 39 cost time: 0.8577306270599365
Epoch: 39, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9105868339538574
Epoch: 40, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8441562652587891
Epoch: 41, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.903 Test Loss: 0.209 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8384897708892822
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.903 Test Loss: 0.205 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9155254364013672
Epoch: 43, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.903 Test Loss: 0.204 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8425908088684082
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8918380737304688
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.7794337272644043
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.8381595611572266
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.9021105766296387
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 60284
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df256_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6834542751312256
Epoch: 1, Steps: 7 | Train Loss: 2.881 Vali Loss: 2.616 Vali Acc: 0.083 Test Loss: 2.616 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 0.7838947772979736
Epoch: 2, Steps: 7 | Train Loss: 2.658 Vali Loss: 2.529 Vali Acc: 0.139 Test Loss: 2.529 Test Acc: 0.139
Validation loss decreased (-0.083307 --> -0.138864).  Saving model ...
Epoch: 3 cost time: 0.9578003883361816
Epoch: 3, Steps: 7 | Train Loss: 2.502 Vali Loss: 2.380 Vali Acc: 0.167 Test Loss: 2.380 Test Acc: 0.167
Validation loss decreased (-0.138864 --> -0.166643).  Saving model ...
Epoch: 4 cost time: 0.8718547821044922
Epoch: 4, Steps: 7 | Train Loss: 2.347 Vali Loss: 2.195 Vali Acc: 0.264 Test Loss: 2.195 Test Acc: 0.264
Validation loss decreased (-0.166643 --> -0.263867).  Saving model ...
Epoch: 5 cost time: 0.8147678375244141
Epoch: 5, Steps: 7 | Train Loss: 2.097 Vali Loss: 1.964 Vali Acc: 0.486 Test Loss: 1.964 Test Acc: 0.486
Validation loss decreased (-0.263867 --> -0.486091).  Saving model ...
Epoch: 6 cost time: 0.8400909900665283
Epoch: 6, Steps: 7 | Train Loss: 1.785 Vali Loss: 1.696 Vali Acc: 0.681 Test Loss: 1.696 Test Acc: 0.681
Validation loss decreased (-0.486091 --> -0.680539).  Saving model ...
Epoch: 7 cost time: 0.8680663108825684
Epoch: 7, Steps: 7 | Train Loss: 1.553 Vali Loss: 1.420 Vali Acc: 0.778 Test Loss: 1.420 Test Acc: 0.778
Validation loss decreased (-0.680539 --> -0.777764).  Saving model ...
Epoch: 8 cost time: 0.8019685745239258
Epoch: 8, Steps: 7 | Train Loss: 1.234 Vali Loss: 1.142 Vali Acc: 0.819 Test Loss: 1.142 Test Acc: 0.819
Validation loss decreased (-0.777764 --> -0.819433).  Saving model ...
Epoch: 9 cost time: 0.8665711879730225
Epoch: 9, Steps: 7 | Train Loss: 0.932 Vali Loss: 0.914 Vali Acc: 0.819 Test Loss: 0.914 Test Acc: 0.819
Validation loss decreased (-0.819433 --> -0.819435).  Saving model ...
Epoch: 10 cost time: 0.8433454036712646
Epoch: 10, Steps: 7 | Train Loss: 0.685 Vali Loss: 0.735 Vali Acc: 0.847 Test Loss: 0.735 Test Acc: 0.847
Validation loss decreased (-0.819435 --> -0.847215).  Saving model ...
Epoch: 11 cost time: 0.758059024810791
Epoch: 11, Steps: 7 | Train Loss: 0.485 Vali Loss: 0.600 Vali Acc: 0.861 Test Loss: 0.600 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861105).  Saving model ...
Epoch: 12 cost time: 0.7446277141571045
Epoch: 12, Steps: 7 | Train Loss: 0.338 Vali Loss: 0.515 Vali Acc: 0.903 Test Loss: 0.515 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902773).  Saving model ...
Epoch: 13 cost time: 0.8276629447937012
Epoch: 13, Steps: 7 | Train Loss: 0.249 Vali Loss: 0.445 Vali Acc: 0.903 Test Loss: 0.445 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 14 cost time: 0.9106178283691406
Epoch: 14, Steps: 7 | Train Loss: 0.181 Vali Loss: 0.400 Vali Acc: 0.917 Test Loss: 0.400 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.8161702156066895
Epoch: 15, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.367 Vali Acc: 0.931 Test Loss: 0.367 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 16 cost time: 0.8908414840698242
Epoch: 16, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.348 Vali Acc: 0.931 Test Loss: 0.348 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 0.8394441604614258
Epoch: 17, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9120771884918213
Epoch: 18, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.326 Vali Acc: 0.931 Test Loss: 0.326 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 19 cost time: 0.8577163219451904
Epoch: 19, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9378702640533447
Epoch: 20, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.309 Vali Acc: 0.931 Test Loss: 0.309 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 21 cost time: 0.8521807193756104
Epoch: 21, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.8447835445404053
Epoch: 22, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.8741495609283447
Epoch: 23, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.7832849025726318
Epoch: 24, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.8999440670013428
Epoch: 25, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.9770646095275879
Epoch: 26, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.9302361011505127
Epoch: 27, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.0375571250915527
Epoch: 28, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.8406848907470703
Epoch: 29, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.8684597015380859
Epoch: 30, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.8551003932952881
Epoch: 31, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.8572506904602051
Epoch: 32, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.976060152053833
Epoch: 33, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.9015533924102783
Epoch: 34, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 1.0052447319030762
Epoch: 35, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.8358001708984375
Epoch: 36, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.889467716217041
Epoch: 37, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.894052267074585
Epoch: 38, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9346411228179932
Epoch: 39, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 1.004176139831543
Epoch: 40, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.878831148147583
Epoch: 41, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.8620603084564209
Epoch: 42, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.8448336124420166
Epoch: 43, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.8090283870697021
Epoch: 44, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0062708854675293
Epoch: 45, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8490338325500488
Epoch: 46, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.9077630043029785
Epoch: 47, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.9139082431793213
Epoch: 48, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9485929012298584
Epoch: 49, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.918114185333252
Epoch: 50, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.8067882061004639
Epoch: 51, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.7944021224975586
Epoch: 52, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 0.7781519889831543
Epoch: 53, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.9055318832397461
Epoch: 54, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 0.8544397354125977
Epoch: 55, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 0.6932549476623535
Epoch: 56, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 0.849729061126709
Epoch: 57, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 0.8037583827972412
Epoch: 58, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 0.8112080097198486
Epoch: 59, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 60 cost time: 0.9605245590209961
Epoch: 60, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 0.8714439868927002
Epoch: 61, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 62 cost time: 0.9166090488433838
Epoch: 62, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 63 cost time: 0.9355330467224121
Epoch: 63, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.9261143207550049
Epoch: 64, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.8603191375732422
Epoch: 65, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 66 cost time: 0.9431335926055908
Epoch: 66, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 67 cost time: 0.8891074657440186
Epoch: 67, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8010280132293701
Epoch: 68, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.9729611873626709
Epoch: 69, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 70 cost time: 0.8716285228729248
Epoch: 70, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8087491989135742
Epoch: 71, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.0333924293518066
Epoch: 72, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 73 cost time: 0.8451006412506104
Epoch: 73, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 74 cost time: 0.9901094436645508
Epoch: 74, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.9656622409820557
Epoch: 75, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.8776407241821289
Epoch: 76, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.9592595100402832
Epoch: 77, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.9156351089477539
Epoch: 78, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 79 cost time: 1.063307762145996
Epoch: 79, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 80 cost time: 0.9431464672088623
Epoch: 80, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 81 cost time: 1.0970816612243652
Epoch: 81, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 82 cost time: 0.9574751853942871
Epoch: 82, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.8764986991882324
Epoch: 83, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 84 cost time: 0.8974497318267822
Epoch: 84, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 85 cost time: 0.9604909420013428
Epoch: 85, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 86 cost time: 0.9030413627624512
Epoch: 86, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 87 cost time: 0.8468148708343506
Epoch: 87, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 88 cost time: 0.9522535800933838
Epoch: 88, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 89 cost time: 1.0117428302764893
Epoch: 89, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 90 cost time: 0.8420219421386719
Epoch: 90, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 91 cost time: 0.8109996318817139
Epoch: 91, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 92 cost time: 0.9434051513671875
Epoch: 92, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.8453710079193115
Epoch: 93, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.8855030536651611
Epoch: 94, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 0.8462250232696533
Epoch: 95, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 0.7672848701477051
Epoch: 96, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 0.9156327247619629
Epoch: 97, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 98 cost time: 0.8345413208007812
Epoch: 98, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 99 cost time: 0.9577412605285645
Epoch: 99, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 100 cost time: 0.9105758666992188
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df256_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 52700
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7937092781066895
Epoch: 1, Steps: 7 | Train Loss: 2.717 Vali Loss: 2.537 Vali Acc: 0.069 Test Loss: 2.537 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.9973905086517334
Epoch: 2, Steps: 7 | Train Loss: 2.619 Vali Loss: 2.449 Vali Acc: 0.139 Test Loss: 2.449 Test Acc: 0.139
Validation loss decreased (-0.069419 --> -0.138864).  Saving model ...
Epoch: 3 cost time: 0.9147417545318604
Epoch: 3, Steps: 7 | Train Loss: 2.532 Vali Loss: 2.309 Vali Acc: 0.194 Test Loss: 2.309 Test Acc: 0.194
Validation loss decreased (-0.138864 --> -0.194421).  Saving model ...
Epoch: 4 cost time: 1.0311458110809326
Epoch: 4, Steps: 7 | Train Loss: 2.303 Vali Loss: 2.138 Vali Acc: 0.250 Test Loss: 2.138 Test Acc: 0.250
Validation loss decreased (-0.194421 --> -0.249979).  Saving model ...
Epoch: 5 cost time: 0.9376964569091797
Epoch: 5, Steps: 7 | Train Loss: 2.100 Vali Loss: 1.945 Vali Acc: 0.458 Test Loss: 1.945 Test Acc: 0.458
Validation loss decreased (-0.249979 --> -0.458314).  Saving model ...
Epoch: 6 cost time: 1.065643072128296
Epoch: 6, Steps: 7 | Train Loss: 1.932 Vali Loss: 1.729 Vali Acc: 0.625 Test Loss: 1.729 Test Acc: 0.625
Validation loss decreased (-0.458314 --> -0.624983).  Saving model ...
Epoch: 7 cost time: 0.9899606704711914
Epoch: 7, Steps: 7 | Train Loss: 1.642 Vali Loss: 1.512 Vali Acc: 0.708 Test Loss: 1.512 Test Acc: 0.708
Validation loss decreased (-0.624983 --> -0.708318).  Saving model ...
Epoch: 8 cost time: 0.9700114727020264
Epoch: 8, Steps: 7 | Train Loss: 1.394 Vali Loss: 1.288 Vali Acc: 0.792 Test Loss: 1.288 Test Acc: 0.792
Validation loss decreased (-0.708318 --> -0.791654).  Saving model ...
Epoch: 9 cost time: 0.9842181205749512
Epoch: 9, Steps: 7 | Train Loss: 1.122 Vali Loss: 1.084 Vali Acc: 0.861 Test Loss: 1.084 Test Acc: 0.861
Validation loss decreased (-0.791654 --> -0.861100).  Saving model ...
Epoch: 10 cost time: 0.9358274936676025
Epoch: 10, Steps: 7 | Train Loss: 0.948 Vali Loss: 0.910 Vali Acc: 0.875 Test Loss: 0.910 Test Acc: 0.875
Validation loss decreased (-0.861100 --> -0.874991).  Saving model ...
Epoch: 11 cost time: 1.0650770664215088
Epoch: 11, Steps: 7 | Train Loss: 0.723 Vali Loss: 0.758 Vali Acc: 0.903 Test Loss: 0.758 Test Acc: 0.903
Validation loss decreased (-0.874991 --> -0.902770).  Saving model ...
Epoch: 12 cost time: 0.9992794990539551
Epoch: 12, Steps: 7 | Train Loss: 0.560 Vali Loss: 0.642 Vali Acc: 0.931 Test Loss: 0.642 Test Acc: 0.931
Validation loss decreased (-0.902770 --> -0.930549).  Saving model ...
Epoch: 13 cost time: 1.0562236309051514
Epoch: 13, Steps: 7 | Train Loss: 0.443 Vali Loss: 0.561 Vali Acc: 0.917 Test Loss: 0.561 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9666383266448975
Epoch: 14, Steps: 7 | Train Loss: 0.333 Vali Loss: 0.492 Vali Acc: 0.931 Test Loss: 0.492 Test Acc: 0.931
Validation loss decreased (-0.930549 --> -0.930551).  Saving model ...
Epoch: 15 cost time: 0.9668421745300293
Epoch: 15, Steps: 7 | Train Loss: 0.267 Vali Loss: 0.447 Vali Acc: 0.931 Test Loss: 0.447 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 16 cost time: 0.9943921566009521
Epoch: 16, Steps: 7 | Train Loss: 0.219 Vali Loss: 0.409 Vali Acc: 0.931 Test Loss: 0.409 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 17 cost time: 0.8974659442901611
Epoch: 17, Steps: 7 | Train Loss: 0.160 Vali Loss: 0.386 Vali Acc: 0.931 Test Loss: 0.386 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 18 cost time: 1.0062885284423828
Epoch: 18, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.358 Vali Acc: 0.931 Test Loss: 0.358 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 19 cost time: 0.9527218341827393
Epoch: 19, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9954602718353271
Epoch: 20, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.328 Vali Acc: 0.944 Test Loss: 0.328 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 21 cost time: 0.9010908603668213
Epoch: 21, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.325 Vali Acc: 0.931 Test Loss: 0.325 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8998751640319824
Epoch: 22, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.309 Vali Acc: 0.931 Test Loss: 0.309 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8743991851806641
Epoch: 23, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8322544097900391
Epoch: 24, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8818082809448242
Epoch: 25, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9151809215545654
Epoch: 26, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9152169227600098
Epoch: 27, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8815228939056396
Epoch: 28, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8704116344451904
Epoch: 29, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9042582511901855
Epoch: 30, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 46748
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df256_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7750627994537354
Epoch: 1, Steps: 7 | Train Loss: 2.484 Vali Loss: 2.430 Vali Acc: 0.139 Test Loss: 2.430 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.9458811283111572
Epoch: 2, Steps: 7 | Train Loss: 2.401 Vali Loss: 2.349 Vali Acc: 0.139 Test Loss: 2.349 Test Acc: 0.139
Validation loss decreased (-0.138865 --> -0.138865).  Saving model ...
Epoch: 3 cost time: 1.0224390029907227
Epoch: 3, Steps: 7 | Train Loss: 2.260 Vali Loss: 2.238 Vali Acc: 0.194 Test Loss: 2.238 Test Acc: 0.194
Validation loss decreased (-0.138865 --> -0.194422).  Saving model ...
Epoch: 4 cost time: 0.89302659034729
Epoch: 4, Steps: 7 | Train Loss: 2.141 Vali Loss: 2.116 Vali Acc: 0.292 Test Loss: 2.116 Test Acc: 0.292
Validation loss decreased (-0.194422 --> -0.291646).  Saving model ...
Epoch: 5 cost time: 0.9365091323852539
Epoch: 5, Steps: 7 | Train Loss: 2.022 Vali Loss: 1.984 Vali Acc: 0.458 Test Loss: 1.984 Test Acc: 0.458
Validation loss decreased (-0.291646 --> -0.458313).  Saving model ...
Epoch: 6 cost time: 0.883129358291626
Epoch: 6, Steps: 7 | Train Loss: 1.879 Vali Loss: 1.840 Vali Acc: 0.569 Test Loss: 1.840 Test Acc: 0.569
Validation loss decreased (-0.458313 --> -0.569426).  Saving model ...
Epoch: 7 cost time: 0.9923715591430664
Epoch: 7, Steps: 7 | Train Loss: 1.720 Vali Loss: 1.692 Vali Acc: 0.681 Test Loss: 1.692 Test Acc: 0.681
Validation loss decreased (-0.569426 --> -0.680539).  Saving model ...
Epoch: 8 cost time: 0.9358046054840088
Epoch: 8, Steps: 7 | Train Loss: 1.519 Vali Loss: 1.532 Vali Acc: 0.750 Test Loss: 1.532 Test Acc: 0.750
Validation loss decreased (-0.680539 --> -0.749985).  Saving model ...
Epoch: 9 cost time: 0.9691758155822754
Epoch: 9, Steps: 7 | Train Loss: 1.313 Vali Loss: 1.363 Vali Acc: 0.847 Test Loss: 1.363 Test Acc: 0.847
Validation loss decreased (-0.749985 --> -0.847209).  Saving model ...
Epoch: 10 cost time: 0.9663100242614746
Epoch: 10, Steps: 7 | Train Loss: 1.133 Vali Loss: 1.201 Vali Acc: 0.875 Test Loss: 1.201 Test Acc: 0.875
Validation loss decreased (-0.847209 --> -0.874988).  Saving model ...
Epoch: 11 cost time: 0.8997998237609863
Epoch: 11, Steps: 7 | Train Loss: 0.966 Vali Loss: 1.058 Vali Acc: 0.875 Test Loss: 1.058 Test Acc: 0.875
Validation loss decreased (-0.874988 --> -0.874989).  Saving model ...
Epoch: 12 cost time: 0.8732223510742188
Epoch: 12, Steps: 7 | Train Loss: 0.798 Vali Loss: 0.922 Vali Acc: 0.889 Test Loss: 0.922 Test Acc: 0.889
Validation loss decreased (-0.874989 --> -0.888880).  Saving model ...
Epoch: 13 cost time: 0.99172043800354
Epoch: 13, Steps: 7 | Train Loss: 0.702 Vali Loss: 0.809 Vali Acc: 0.903 Test Loss: 0.809 Test Acc: 0.903
Validation loss decreased (-0.888880 --> -0.902770).  Saving model ...
Epoch: 14 cost time: 0.9607877731323242
Epoch: 14, Steps: 7 | Train Loss: 0.547 Vali Loss: 0.706 Vali Acc: 0.903 Test Loss: 0.706 Test Acc: 0.903
Validation loss decreased (-0.902770 --> -0.902771).  Saving model ...
Epoch: 15 cost time: 0.9839992523193359
Epoch: 15, Steps: 7 | Train Loss: 0.475 Vali Loss: 0.632 Vali Acc: 0.903 Test Loss: 0.632 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902771).  Saving model ...
Epoch: 16 cost time: 0.9099128246307373
Epoch: 16, Steps: 7 | Train Loss: 0.344 Vali Loss: 0.569 Vali Acc: 0.903 Test Loss: 0.569 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902772).  Saving model ...
Epoch: 17 cost time: 0.8721122741699219
Epoch: 17, Steps: 7 | Train Loss: 0.323 Vali Loss: 0.524 Vali Acc: 0.903 Test Loss: 0.524 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 18 cost time: 0.9897873401641846
Epoch: 18, Steps: 7 | Train Loss: 0.271 Vali Loss: 0.497 Vali Acc: 0.903 Test Loss: 0.497 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 19 cost time: 0.8946681022644043
Epoch: 19, Steps: 7 | Train Loss: 0.237 Vali Loss: 0.469 Vali Acc: 0.903 Test Loss: 0.469 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 20 cost time: 0.8683393001556396
Epoch: 20, Steps: 7 | Train Loss: 0.213 Vali Loss: 0.447 Vali Acc: 0.903 Test Loss: 0.447 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 21 cost time: 0.8685507774353027
Epoch: 21, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.431 Vali Acc: 0.903 Test Loss: 0.431 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 22 cost time: 0.8623785972595215
Epoch: 22, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.416 Vali Acc: 0.903 Test Loss: 0.416 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.9301161766052246
Epoch: 23, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.396 Vali Acc: 0.917 Test Loss: 0.396 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 24 cost time: 0.9863357543945312
Epoch: 24, Steps: 7 | Train Loss: 0.122 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8715672492980957
Epoch: 25, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.384 Vali Acc: 0.903 Test Loss: 0.384 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8274557590484619
Epoch: 26, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8241734504699707
Epoch: 27, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.370 Vali Acc: 0.889 Test Loss: 0.370 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.972175121307373
Epoch: 28, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9287197589874268
Epoch: 29, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7658462524414062
Epoch: 30, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 31 cost time: 0.8836209774017334
Epoch: 31, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 32 cost time: 0.9155552387237549
Epoch: 32, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 33 cost time: 0.893657922744751
Epoch: 33, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.075582504272461
Epoch: 34, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8358182907104492
Epoch: 35, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9410510063171387
Epoch: 36, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8657612800598145
Epoch: 37, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.8590481281280518
Epoch: 38, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.8610727787017822
Epoch: 39, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.8586421012878418
Epoch: 40, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.8354566097259521
Epoch: 41, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.7996840476989746
Epoch: 42, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9943346977233887
Epoch: 43, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9494028091430664
Epoch: 44, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0353894233703613
Epoch: 45, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.906684160232544
Epoch: 46, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8594348430633545
Epoch: 47, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.9187614917755127
Epoch: 48, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0238111019134521
Epoch: 49, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9763801097869873
Epoch: 50, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0700738430023193
Epoch: 51, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0218379497528076
Epoch: 52, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.9394936561584473
Epoch: 53, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.9718480110168457
Epoch: 54, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.9021716117858887
Epoch: 55, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.9535164833068848
Epoch: 56, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.897392988204956
Epoch: 57, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.9379708766937256
Epoch: 58, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9119858741760254
Epoch: 59, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.9440875053405762
Epoch: 60, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.0151283740997314
Epoch: 61, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.9476494789123535
Epoch: 62, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.9443097114562988
Epoch: 63, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.9412322044372559
Epoch: 64, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.9813873767852783
Epoch: 65, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.9500918388366699
Epoch: 66, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.9886283874511719
Epoch: 67, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df256_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 43100
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.659872531890869
Epoch: 1, Steps: 7 | Train Loss: 2.532 Vali Loss: 2.508 Vali Acc: 0.056 Test Loss: 2.508 Test Acc: 0.056
Validation loss decreased (inf --> -0.055530).  Saving model ...
Epoch: 2 cost time: 0.881309986114502
Epoch: 2, Steps: 7 | Train Loss: 2.459 Vali Loss: 2.377 Vali Acc: 0.125 Test Loss: 2.377 Test Acc: 0.125
Validation loss decreased (-0.055530 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 0.9279465675354004
Epoch: 3, Steps: 7 | Train Loss: 2.423 Vali Loss: 2.265 Vali Acc: 0.250 Test Loss: 2.265 Test Acc: 0.250
Validation loss decreased (-0.124976 --> -0.249977).  Saving model ...
Epoch: 4 cost time: 0.8748855590820312
Epoch: 4, Steps: 7 | Train Loss: 2.324 Vali Loss: 2.147 Vali Acc: 0.333 Test Loss: 2.147 Test Acc: 0.333
Validation loss decreased (-0.249977 --> -0.333312).  Saving model ...
Epoch: 5 cost time: 0.9592270851135254
Epoch: 5, Steps: 7 | Train Loss: 2.204 Vali Loss: 2.025 Vali Acc: 0.403 Test Loss: 2.025 Test Acc: 0.403
Validation loss decreased (-0.333312 --> -0.402758).  Saving model ...
Epoch: 6 cost time: 0.9560298919677734
Epoch: 6, Steps: 7 | Train Loss: 2.053 Vali Loss: 1.905 Vali Acc: 0.486 Test Loss: 1.905 Test Acc: 0.486
Validation loss decreased (-0.402758 --> -0.486092).  Saving model ...
Epoch: 7 cost time: 1.044154405593872
Epoch: 7, Steps: 7 | Train Loss: 1.823 Vali Loss: 1.784 Vali Acc: 0.542 Test Loss: 1.784 Test Acc: 0.542
Validation loss decreased (-0.486092 --> -0.541649).  Saving model ...
Epoch: 8 cost time: 0.9466381072998047
Epoch: 8, Steps: 7 | Train Loss: 1.756 Vali Loss: 1.654 Vali Acc: 0.653 Test Loss: 1.654 Test Acc: 0.653
Validation loss decreased (-0.541649 --> -0.652761).  Saving model ...
Epoch: 9 cost time: 0.9746952056884766
Epoch: 9, Steps: 7 | Train Loss: 1.606 Vali Loss: 1.524 Vali Acc: 0.708 Test Loss: 1.524 Test Acc: 0.708
Validation loss decreased (-0.652761 --> -0.708318).  Saving model ...
Epoch: 10 cost time: 1.056760311126709
Epoch: 10, Steps: 7 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.722 Test Loss: 1.386 Test Acc: 0.722
Validation loss decreased (-0.708318 --> -0.722208).  Saving model ...
Epoch: 11 cost time: 0.961113452911377
Epoch: 11, Steps: 7 | Train Loss: 1.216 Vali Loss: 1.242 Vali Acc: 0.764 Test Loss: 1.242 Test Acc: 0.764
Validation loss decreased (-0.722208 --> -0.763876).  Saving model ...
Epoch: 12 cost time: 1.053666114807129
Epoch: 12, Steps: 7 | Train Loss: 1.076 Vali Loss: 1.116 Vali Acc: 0.792 Test Loss: 1.116 Test Acc: 0.792
Validation loss decreased (-0.763876 --> -0.791656).  Saving model ...
Epoch: 13 cost time: 0.9837770462036133
Epoch: 13, Steps: 7 | Train Loss: 0.884 Vali Loss: 0.997 Vali Acc: 0.819 Test Loss: 0.997 Test Acc: 0.819
Validation loss decreased (-0.791656 --> -0.819434).  Saving model ...
Epoch: 14 cost time: 1.0705080032348633
Epoch: 14, Steps: 7 | Train Loss: 0.768 Vali Loss: 0.877 Vali Acc: 0.833 Test Loss: 0.877 Test Acc: 0.833
Validation loss decreased (-0.819434 --> -0.833325).  Saving model ...
Epoch: 15 cost time: 1.0170235633850098
Epoch: 15, Steps: 7 | Train Loss: 0.672 Vali Loss: 0.775 Vali Acc: 0.889 Test Loss: 0.775 Test Acc: 0.889
Validation loss decreased (-0.833325 --> -0.888881).  Saving model ...
Epoch: 16 cost time: 0.9422793388366699
Epoch: 16, Steps: 7 | Train Loss: 0.545 Vali Loss: 0.693 Vali Acc: 0.875 Test Loss: 0.693 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9920022487640381
Epoch: 17, Steps: 7 | Train Loss: 0.479 Vali Loss: 0.629 Vali Acc: 0.875 Test Loss: 0.629 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9874129295349121
Epoch: 18, Steps: 7 | Train Loss: 0.410 Vali Loss: 0.578 Vali Acc: 0.861 Test Loss: 0.578 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.04472017288208
Epoch: 19, Steps: 7 | Train Loss: 0.336 Vali Loss: 0.539 Vali Acc: 0.861 Test Loss: 0.539 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9962139129638672
Epoch: 20, Steps: 7 | Train Loss: 0.295 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9806938171386719
Epoch: 21, Steps: 7 | Train Loss: 0.257 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1641123294830322
Epoch: 22, Steps: 7 | Train Loss: 0.229 Vali Loss: 0.464 Vali Acc: 0.861 Test Loss: 0.464 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8278472423553467
Epoch: 23, Steps: 7 | Train Loss: 0.187 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0618839263916016
Epoch: 24, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.429 Vali Acc: 0.861 Test Loss: 0.429 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9369199275970459
Epoch: 25, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 41756
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7397406101226807
Epoch: 1, Steps: 7 | Train Loss: 2.652 Vali Loss: 2.536 Vali Acc: 0.014 Test Loss: 2.536 Test Acc: 0.014
Validation loss decreased (inf --> -0.013864).  Saving model ...
Epoch: 2 cost time: 0.939882755279541
Epoch: 2, Steps: 7 | Train Loss: 2.480 Vali Loss: 2.269 Vali Acc: 0.222 Test Loss: 2.269 Test Acc: 0.222
Validation loss decreased (-0.013864 --> -0.222200).  Saving model ...
Epoch: 3 cost time: 0.9121606349945068
Epoch: 3, Steps: 7 | Train Loss: 2.121 Vali Loss: 1.962 Vali Acc: 0.486 Test Loss: 1.962 Test Acc: 0.486
Validation loss decreased (-0.222200 --> -0.486091).  Saving model ...
Epoch: 4 cost time: 0.9940037727355957
Epoch: 4, Steps: 7 | Train Loss: 1.711 Vali Loss: 1.550 Vali Acc: 0.639 Test Loss: 1.550 Test Acc: 0.639
Validation loss decreased (-0.486091 --> -0.638873).  Saving model ...
Epoch: 5 cost time: 0.941502571105957
Epoch: 5, Steps: 7 | Train Loss: 1.222 Vali Loss: 1.156 Vali Acc: 0.792 Test Loss: 1.156 Test Acc: 0.792
Validation loss decreased (-0.638873 --> -0.791655).  Saving model ...
Epoch: 6 cost time: 0.993044376373291
Epoch: 6, Steps: 7 | Train Loss: 0.825 Vali Loss: 0.823 Vali Acc: 0.806 Test Loss: 0.823 Test Acc: 0.806
Validation loss decreased (-0.791655 --> -0.805547).  Saving model ...
Epoch: 7 cost time: 0.8789150714874268
Epoch: 7, Steps: 7 | Train Loss: 0.505 Vali Loss: 0.592 Vali Acc: 0.847 Test Loss: 0.592 Test Acc: 0.847
Validation loss decreased (-0.805547 --> -0.847216).  Saving model ...
Epoch: 8 cost time: 0.9598450660705566
Epoch: 8, Steps: 7 | Train Loss: 0.265 Vali Loss: 0.468 Vali Acc: 0.861 Test Loss: 0.468 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 0.9612677097320557
Epoch: 9, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 0.9703245162963867
Epoch: 10, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.9798538684844971
Epoch: 11, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.8472254276275635
Epoch: 12, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.0133922100067139
Epoch: 13, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.9344198703765869
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.9113080501556396
Epoch: 15, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0694479942321777
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.239 Vali Acc: 0.889 Test Loss: 0.239 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0862576961517334
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.0294439792633057
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.0509300231933594
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 20 cost time: 1.0480411052703857
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.916665 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.0601139068603516
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.981896162033081
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0351943969726562
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0706684589385986
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.0243873596191406
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.0426721572875977
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8550248146057129
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9750490188598633
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1184263229370117
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0785160064697266
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0148420333862305
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0048644542694092
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0696041584014893
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0086746215820312
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8968362808227539
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 107708
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.619694948196411
Epoch: 1, Steps: 7 | Train Loss: 2.639 Vali Loss: 2.527 Vali Acc: 0.069 Test Loss: 2.527 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.9253404140472412
Epoch: 2, Steps: 7 | Train Loss: 2.532 Vali Loss: 2.389 Vali Acc: 0.153 Test Loss: 2.389 Test Acc: 0.153
Validation loss decreased (-0.069419 --> -0.152754).  Saving model ...
Epoch: 3 cost time: 0.8803482055664062
Epoch: 3, Steps: 7 | Train Loss: 2.316 Vali Loss: 2.199 Vali Acc: 0.361 Test Loss: 2.199 Test Acc: 0.361
Validation loss decreased (-0.152754 --> -0.361089).  Saving model ...
Epoch: 4 cost time: 0.9933583736419678
Epoch: 4, Steps: 7 | Train Loss: 2.003 Vali Loss: 1.963 Vali Acc: 0.500 Test Loss: 1.963 Test Acc: 0.500
Validation loss decreased (-0.361089 --> -0.499980).  Saving model ...
Epoch: 5 cost time: 0.8680994510650635
Epoch: 5, Steps: 7 | Train Loss: 1.774 Vali Loss: 1.683 Vali Acc: 0.556 Test Loss: 1.683 Test Acc: 0.556
Validation loss decreased (-0.499980 --> -0.555539).  Saving model ...
Epoch: 6 cost time: 0.8803181648254395
Epoch: 6, Steps: 7 | Train Loss: 1.444 Vali Loss: 1.370 Vali Acc: 0.708 Test Loss: 1.370 Test Acc: 0.708
Validation loss decreased (-0.555539 --> -0.708320).  Saving model ...
Epoch: 7 cost time: 0.9418816566467285
Epoch: 7, Steps: 7 | Train Loss: 1.130 Vali Loss: 1.080 Vali Acc: 0.806 Test Loss: 1.080 Test Acc: 0.806
Validation loss decreased (-0.708320 --> -0.805545).  Saving model ...
Epoch: 8 cost time: 0.8990426063537598
Epoch: 8, Steps: 7 | Train Loss: 0.824 Vali Loss: 0.820 Vali Acc: 0.875 Test Loss: 0.820 Test Acc: 0.875
Validation loss decreased (-0.805545 --> -0.874992).  Saving model ...
Epoch: 9 cost time: 0.9605474472045898
Epoch: 9, Steps: 7 | Train Loss: 0.505 Vali Loss: 0.625 Vali Acc: 0.889 Test Loss: 0.625 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888883).  Saving model ...
Epoch: 10 cost time: 0.9455652236938477
Epoch: 10, Steps: 7 | Train Loss: 0.344 Vali Loss: 0.505 Vali Acc: 0.889 Test Loss: 0.505 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 11 cost time: 0.861121654510498
Epoch: 11, Steps: 7 | Train Loss: 0.214 Vali Loss: 0.423 Vali Acc: 0.903 Test Loss: 0.423 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.8682188987731934
Epoch: 12, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.362 Vali Acc: 0.917 Test Loss: 0.362 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 1.00630784034729
Epoch: 13, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 0.9118647575378418
Epoch: 14, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.046492576599121
Epoch: 15, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.9231092929840088
Epoch: 16, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.0281779766082764
Epoch: 17, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.9424755573272705
Epoch: 18, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.9658122062683105
Epoch: 19, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.9934659004211426
Epoch: 20, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.994513750076294
Epoch: 21, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.9045860767364502
Epoch: 22, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.9871509075164795
Epoch: 23, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.947843074798584
Epoch: 24, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.9273777008056641
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.8812377452850342
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.9221172332763672
Epoch: 27, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8861796855926514
Epoch: 28, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9547340869903564
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.9294488430023193
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.9379239082336426
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.9226582050323486
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.9733517169952393
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.9506869316101074
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.9531147480010986
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.9715602397918701
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.9548265933990479
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9254484176635742
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 1.0196301937103271
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 1.0322418212890625
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.9686439037322998
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.8960320949554443
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.8711977005004883
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 44 cost time: 0.9397618770599365
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 45 cost time: 0.9675979614257812
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 46 cost time: 0.9808485507965088
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 47 cost time: 0.8870201110839844
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 48 cost time: 0.9276270866394043
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9409339427947998
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9679222106933594
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.8975913524627686
Epoch: 51, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 52 cost time: 0.8456861972808838
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 53 cost time: 0.9123878479003906
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9547989368438721
Epoch: 54, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.0042901039123535
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9660110473632812
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.9583723545074463
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.0152640342712402
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.0419857501983643
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.9483935832977295
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 61 cost time: 0.9775810241699219
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9459207057952881
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 63 cost time: 0.9266147613525391
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 64 cost time: 0.9618124961853027
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 65 cost time: 0.9142446517944336
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 66 cost time: 0.9753589630126953
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 67 cost time: 0.9436888694763184
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 68 cost time: 0.9558255672454834
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9380972385406494
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 70 cost time: 0.9551434516906738
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.9695117473602295
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.8706729412078857
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 73 cost time: 0.95424485206604
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 74 cost time: 0.9159436225891113
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.9316225051879883
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 76 cost time: 0.9669389724731445
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.964118242263794
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 78 cost time: 1.1025962829589844
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 79 cost time: 0.9806792736053467
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 80 cost time: 0.9092113971710205
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 81 cost time: 0.9694669246673584
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 82 cost time: 0.9701473712921143
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.9454987049102783
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 84 cost time: 0.961223840713501
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 85 cost time: 0.9423885345458984
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.0407536029815674
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.9711852073669434
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 88 cost time: 0.9878907203674316
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 89 cost time: 0.9759297370910645
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 90 cost time: 0.917579174041748
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 91 cost time: 0.8976078033447266
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.890671968460083
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.9297800064086914
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 94 cost time: 0.8418974876403809
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.9097020626068115
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 96 cost time: 0.8328781127929688
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 97 cost time: 1.004521131515503
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 98 cost time: 0.9430892467498779
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 99 cost time: 0.9074869155883789
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 0.8837511539459229
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 62108
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.9251201152801514
Epoch: 1, Steps: 7 | Train Loss: 2.641 Vali Loss: 2.658 Vali Acc: 0.125 Test Loss: 2.658 Test Acc: 0.125
Validation loss decreased (inf --> -0.124973).  Saving model ...
Epoch: 2 cost time: 0.9258129596710205
Epoch: 2, Steps: 7 | Train Loss: 2.587 Vali Loss: 2.459 Vali Acc: 0.125 Test Loss: 2.459 Test Acc: 0.125
Validation loss decreased (-0.124973 --> -0.124975).  Saving model ...
Epoch: 3 cost time: 0.9162189960479736
Epoch: 3, Steps: 7 | Train Loss: 2.349 Vali Loss: 2.224 Vali Acc: 0.222 Test Loss: 2.224 Test Acc: 0.222
Validation loss decreased (-0.124975 --> -0.222200).  Saving model ...
Epoch: 4 cost time: 0.9559259414672852
Epoch: 4, Steps: 7 | Train Loss: 2.084 Vali Loss: 1.942 Vali Acc: 0.528 Test Loss: 1.942 Test Acc: 0.528
Validation loss decreased (-0.222200 --> -0.527758).  Saving model ...
Epoch: 5 cost time: 0.9716196060180664
Epoch: 5, Steps: 7 | Train Loss: 1.822 Vali Loss: 1.648 Vali Acc: 0.625 Test Loss: 1.648 Test Acc: 0.625
Validation loss decreased (-0.527758 --> -0.624984).  Saving model ...
Epoch: 6 cost time: 0.8619875907897949
Epoch: 6, Steps: 7 | Train Loss: 1.555 Vali Loss: 1.373 Vali Acc: 0.708 Test Loss: 1.373 Test Acc: 0.708
Validation loss decreased (-0.624984 --> -0.708320).  Saving model ...
Epoch: 7 cost time: 0.9278984069824219
Epoch: 7, Steps: 7 | Train Loss: 1.177 Vali Loss: 1.109 Vali Acc: 0.764 Test Loss: 1.109 Test Acc: 0.764
Validation loss decreased (-0.708320 --> -0.763878).  Saving model ...
Epoch: 8 cost time: 0.9270188808441162
Epoch: 8, Steps: 7 | Train Loss: 0.947 Vali Loss: 0.888 Vali Acc: 0.875 Test Loss: 0.888 Test Acc: 0.875
Validation loss decreased (-0.763878 --> -0.874991).  Saving model ...
Epoch: 9 cost time: 0.9704363346099854
Epoch: 9, Steps: 7 | Train Loss: 0.707 Vali Loss: 0.715 Vali Acc: 0.903 Test Loss: 0.715 Test Acc: 0.903
Validation loss decreased (-0.874991 --> -0.902771).  Saving model ...
Epoch: 10 cost time: 0.9227354526519775
Epoch: 10, Steps: 7 | Train Loss: 0.485 Vali Loss: 0.580 Vali Acc: 0.889 Test Loss: 0.580 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9375178813934326
Epoch: 11, Steps: 7 | Train Loss: 0.339 Vali Loss: 0.471 Vali Acc: 0.903 Test Loss: 0.471 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902773).  Saving model ...
Epoch: 12 cost time: 0.9015069007873535
Epoch: 12, Steps: 7 | Train Loss: 0.241 Vali Loss: 0.404 Vali Acc: 0.931 Test Loss: 0.404 Test Acc: 0.931
Validation loss decreased (-0.902773 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 0.9334201812744141
Epoch: 13, Steps: 7 | Train Loss: 0.156 Vali Loss: 0.373 Vali Acc: 0.903 Test Loss: 0.373 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9747724533081055
Epoch: 14, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8976976871490479
Epoch: 15, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.303 Vali Acc: 0.931 Test Loss: 0.303 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.938152551651001
Epoch: 16, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.8783974647521973
Epoch: 17, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.289 Vali Acc: 0.944 Test Loss: 0.289 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.8852138519287109
Epoch: 18, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.279 Vali Acc: 0.958 Test Loss: 0.279 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.9215190410614014
Epoch: 19, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9960236549377441
Epoch: 20, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.254 Vali Acc: 0.958 Test Loss: 0.254 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.9863338470458984
Epoch: 21, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8917109966278076
Epoch: 22, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9167990684509277
Epoch: 23, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.241 Vali Acc: 0.958 Test Loss: 0.241 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.9808290004730225
Epoch: 24, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9632308483123779
Epoch: 25, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8759646415710449
Epoch: 26, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8774204254150391
Epoch: 27, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8349595069885254
Epoch: 28, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8751833438873291
Epoch: 29, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8436024188995361
Epoch: 30, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8351876735687256
Epoch: 31, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.9931542873382568
Epoch: 32, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 1.0405595302581787
Epoch: 33, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.9516990184783936
Epoch: 34, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9275937080383301
Epoch: 35, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.9549951553344727
Epoch: 36, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.9314758777618408
Epoch: 37, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 1.0464529991149902
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.9348270893096924
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.9229474067687988
Epoch: 40, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 1.0155463218688965
Epoch: 41, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 1.0534770488739014
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.9292006492614746
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.9083142280578613
Epoch: 44, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.9753439426422119
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 0.8967816829681396
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 0.9694969654083252
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.9612271785736084
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 1.0192089080810547
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.9450807571411133
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 51 cost time: 0.9690992832183838
Epoch: 51, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 52 cost time: 0.9274506568908691
Epoch: 52, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 0.8407013416290283
Epoch: 53, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 54 cost time: 0.8701052665710449
Epoch: 54, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 55 cost time: 0.9592885971069336
Epoch: 55, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9119069576263428
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.8595373630523682
Epoch: 57, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.9480917453765869
Epoch: 58, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 59 cost time: 0.9069621562957764
Epoch: 59, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9067676067352295
Epoch: 60, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9156112670898438
Epoch: 61, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 62 cost time: 0.9186594486236572
Epoch: 62, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 63 cost time: 0.9198818206787109
Epoch: 63, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 64 cost time: 0.9031000137329102
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 65 cost time: 0.8589880466461182
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 66 cost time: 0.9281535148620605
Epoch: 66, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 67 cost time: 0.9625375270843506
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.9820263385772705
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.9643514156341553
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.9393305778503418
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 71 cost time: 0.9803705215454102
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 72 cost time: 0.9247922897338867
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 73 cost time: 1.0246779918670654
Epoch: 73, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 74 cost time: 0.9673097133636475
Epoch: 74, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 75 cost time: 1.016155481338501
Epoch: 75, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 76 cost time: 1.0501058101654053
Epoch: 76, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.9149150848388672
Epoch: 77, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 78 cost time: 1.0531213283538818
Epoch: 78, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 79 cost time: 0.9449996948242188
Epoch: 79, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.1056373119354248
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 81 cost time: 0.9772093296051025
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.8962593078613281
Epoch: 82, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 83 cost time: 1.016223669052124
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 84 cost time: 1.0468804836273193
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 85 cost time: 0.9474966526031494
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 86 cost time: 0.9822216033935547
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 87 cost time: 1.004955530166626
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.0073766708374023
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.079496145248413
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.9904804229736328
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 91 cost time: 0.9314253330230713
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 92 cost time: 0.982062816619873
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 93 cost time: 1.0546278953552246
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 94 cost time: 1.0836870670318604
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.089674711227417
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 96 cost time: 1.076326847076416
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.870849609375
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.9174437522888184
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.9204347133636475
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.9663166999816895
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 47612
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df128_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.52992844581604
Epoch: 1, Steps: 7 | Train Loss: 2.533 Vali Loss: 2.394 Vali Acc: 0.111 Test Loss: 2.394 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 0.9844131469726562
Epoch: 2, Steps: 7 | Train Loss: 2.459 Vali Loss: 2.276 Vali Acc: 0.181 Test Loss: 2.276 Test Acc: 0.181
Validation loss decreased (-0.111087 --> -0.180533).  Saving model ...
Epoch: 3 cost time: 0.8759059906005859
Epoch: 3, Steps: 7 | Train Loss: 2.296 Vali Loss: 2.123 Vali Acc: 0.333 Test Loss: 2.123 Test Acc: 0.333
Validation loss decreased (-0.180533 --> -0.333312).  Saving model ...
Epoch: 4 cost time: 1.021571159362793
Epoch: 4, Steps: 7 | Train Loss: 2.090 Vali Loss: 1.947 Vali Acc: 0.458 Test Loss: 1.947 Test Acc: 0.458
Validation loss decreased (-0.333312 --> -0.458314).  Saving model ...
Epoch: 5 cost time: 1.0076904296875
Epoch: 5, Steps: 7 | Train Loss: 1.911 Vali Loss: 1.748 Vali Acc: 0.583 Test Loss: 1.748 Test Acc: 0.583
Validation loss decreased (-0.458314 --> -0.583316).  Saving model ...
Epoch: 6 cost time: 0.9067282676696777
Epoch: 6, Steps: 7 | Train Loss: 1.697 Vali Loss: 1.539 Vali Acc: 0.681 Test Loss: 1.539 Test Acc: 0.681
Validation loss decreased (-0.583316 --> -0.680540).  Saving model ...
Epoch: 7 cost time: 1.059842824935913
Epoch: 7, Steps: 7 | Train Loss: 1.422 Vali Loss: 1.322 Vali Acc: 0.792 Test Loss: 1.322 Test Acc: 0.792
Validation loss decreased (-0.680540 --> -0.791653).  Saving model ...
Epoch: 8 cost time: 0.9408550262451172
Epoch: 8, Steps: 7 | Train Loss: 1.229 Vali Loss: 1.098 Vali Acc: 0.764 Test Loss: 1.098 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0521633625030518
Epoch: 9, Steps: 7 | Train Loss: 0.951 Vali Loss: 0.915 Vali Acc: 0.792 Test Loss: 0.915 Test Acc: 0.792
Validation loss decreased (-0.791653 --> -0.791658).  Saving model ...
Epoch: 10 cost time: 0.8977358341217041
Epoch: 10, Steps: 7 | Train Loss: 0.742 Vali Loss: 0.751 Vali Acc: 0.819 Test Loss: 0.751 Test Acc: 0.819
Validation loss decreased (-0.791658 --> -0.819437).  Saving model ...
Epoch: 11 cost time: 0.9216580390930176
Epoch: 11, Steps: 7 | Train Loss: 0.544 Vali Loss: 0.629 Vali Acc: 0.861 Test Loss: 0.629 Test Acc: 0.861
Validation loss decreased (-0.819437 --> -0.861105).  Saving model ...
Epoch: 12 cost time: 0.9548890590667725
Epoch: 12, Steps: 7 | Train Loss: 0.389 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 13 cost time: 0.9815549850463867
Epoch: 13, Steps: 7 | Train Loss: 0.317 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 14 cost time: 1.159269094467163
Epoch: 14, Steps: 7 | Train Loss: 0.222 Vali Loss: 0.423 Vali Acc: 0.861 Test Loss: 0.423 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9845981597900391
Epoch: 15, Steps: 7 | Train Loss: 0.170 Vali Loss: 0.384 Vali Acc: 0.903 Test Loss: 0.384 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 1.0192582607269287
Epoch: 16, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 0.9657704830169678
Epoch: 17, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 18 cost time: 1.0320560932159424
Epoch: 18, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 1.007812738418579
Epoch: 19, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 1.0375893115997314
Epoch: 20, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 1.0215637683868408
Epoch: 21, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0419487953186035
Epoch: 22, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0949721336364746
Epoch: 23, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9613499641418457
Epoch: 24, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9959845542907715
Epoch: 25, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1127474308013916
Epoch: 26, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9694027900695801
Epoch: 27, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0146596431732178
Epoch: 28, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.8801193237304688
Epoch: 29, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.8673162460327148
Epoch: 30, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.9749858379364014
Epoch: 31, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.9193322658538818
Epoch: 32, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.9952073097229004
Epoch: 33, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.0048315525054932
Epoch: 34, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.9617486000061035
Epoch: 35, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9819378852844238
Epoch: 36, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9155893325805664
Epoch: 37, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.9505398273468018
Epoch: 38, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.0585086345672607
Epoch: 39, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.9849085807800293
Epoch: 40, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.9265141487121582
Epoch: 41, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.9869375228881836
Epoch: 42, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9478216171264648
Epoch: 43, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9177608489990234
Epoch: 44, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.9468703269958496
Epoch: 45, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.043029546737671
Epoch: 46, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9356374740600586
Epoch: 47, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.058056354522705
Epoch: 48, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9574153423309326
Epoch: 49, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9229996204376221
Epoch: 50, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 1.02970290184021
Epoch: 51, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 52 cost time: 1.0573043823242188
Epoch: 52, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 53 cost time: 0.9951443672180176
Epoch: 53, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0781030654907227
Epoch: 54, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 55 cost time: 0.921252965927124
Epoch: 55, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9753296375274658
Epoch: 56, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 57 cost time: 0.9304354190826416
Epoch: 57, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 58 cost time: 0.9322512149810791
Epoch: 58, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 59 cost time: 0.9803392887115479
Epoch: 59, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.1553046703338623
Epoch: 60, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9514999389648438
Epoch: 61, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.0970039367675781
Epoch: 62, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 63 cost time: 0.9367291927337646
Epoch: 63, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 64 cost time: 0.8055863380432129
Epoch: 64, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 65 cost time: 1.0408031940460205
Epoch: 65, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 66 cost time: 1.0510902404785156
Epoch: 66, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 67 cost time: 1.050825834274292
Epoch: 67, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 68 cost time: 0.9467060565948486
Epoch: 68, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9300241470336914
Epoch: 69, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.9836609363555908
Epoch: 70, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.9943928718566895
Epoch: 71, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.9347357749938965
Epoch: 72, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 73 cost time: 0.9052753448486328
Epoch: 73, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.9719507694244385
Epoch: 74, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.9289059638977051
Epoch: 75, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 76 cost time: 0.9669630527496338
Epoch: 76, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 77 cost time: 0.9316806793212891
Epoch: 77, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 78 cost time: 0.982184886932373
Epoch: 78, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 79 cost time: 0.9517471790313721
Epoch: 79, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 80 cost time: 0.8505699634552002
Epoch: 80, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 81 cost time: 1.005713701248169
Epoch: 81, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 82 cost time: 0.9347372055053711
Epoch: 82, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 83 cost time: 0.855473518371582
Epoch: 83, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 84 cost time: 0.9190285205841064
Epoch: 84, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 85 cost time: 0.8723030090332031
Epoch: 85, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 86 cost time: 0.8431828022003174
Epoch: 86, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 87 cost time: 1.0139634609222412
Epoch: 87, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 88 cost time: 1.1090784072875977
Epoch: 88, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 89 cost time: 0.965468168258667
Epoch: 89, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 90 cost time: 1.0116157531738281
Epoch: 90, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.9547061920166016
Epoch: 91, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.9255175590515137
Epoch: 92, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 93 cost time: 0.9681909084320068
Epoch: 93, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.0777435302734375
Epoch: 94, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.0587811470031738
Epoch: 95, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.9869561195373535
Epoch: 96, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 1.033902883529663
Epoch: 97, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 1.1545414924621582
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 0.9442095756530762
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 0.9394946098327637
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df128_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 40028
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.65201997756958
Epoch: 1, Steps: 7 | Train Loss: 2.794 Vali Loss: 2.710 Vali Acc: 0.097 Test Loss: 2.710 Test Acc: 0.097
Validation loss decreased (inf --> -0.097195).  Saving model ...
Epoch: 2 cost time: 1.0074758529663086
Epoch: 2, Steps: 7 | Train Loss: 2.645 Vali Loss: 2.622 Vali Acc: 0.111 Test Loss: 2.622 Test Acc: 0.111
Validation loss decreased (-0.097195 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 1.0393593311309814
Epoch: 3, Steps: 7 | Train Loss: 2.513 Vali Loss: 2.496 Vali Acc: 0.167 Test Loss: 2.496 Test Acc: 0.167
Validation loss decreased (-0.111085 --> -0.166642).  Saving model ...
Epoch: 4 cost time: 0.8918159008026123
Epoch: 4, Steps: 7 | Train Loss: 2.360 Vali Loss: 2.335 Vali Acc: 0.222 Test Loss: 2.335 Test Acc: 0.222
Validation loss decreased (-0.166642 --> -0.222199).  Saving model ...
Epoch: 5 cost time: 0.8992559909820557
Epoch: 5, Steps: 7 | Train Loss: 2.124 Vali Loss: 2.158 Vali Acc: 0.278 Test Loss: 2.158 Test Acc: 0.278
Validation loss decreased (-0.222199 --> -0.277756).  Saving model ...
Epoch: 6 cost time: 1.048125982284546
Epoch: 6, Steps: 7 | Train Loss: 1.996 Vali Loss: 1.961 Vali Acc: 0.417 Test Loss: 1.961 Test Acc: 0.417
Validation loss decreased (-0.277756 --> -0.416647).  Saving model ...
Epoch: 7 cost time: 0.960869312286377
Epoch: 7, Steps: 7 | Train Loss: 1.702 Vali Loss: 1.756 Vali Acc: 0.556 Test Loss: 1.756 Test Acc: 0.556
Validation loss decreased (-0.416647 --> -0.555538).  Saving model ...
Epoch: 8 cost time: 0.9454190731048584
Epoch: 8, Steps: 7 | Train Loss: 1.534 Vali Loss: 1.553 Vali Acc: 0.625 Test Loss: 1.553 Test Acc: 0.625
Validation loss decreased (-0.555538 --> -0.624984).  Saving model ...
Epoch: 9 cost time: 0.9370896816253662
Epoch: 9, Steps: 7 | Train Loss: 1.271 Vali Loss: 1.344 Vali Acc: 0.681 Test Loss: 1.344 Test Acc: 0.681
Validation loss decreased (-0.624984 --> -0.680542).  Saving model ...
Epoch: 10 cost time: 0.9256248474121094
Epoch: 10, Steps: 7 | Train Loss: 1.092 Vali Loss: 1.158 Vali Acc: 0.694 Test Loss: 1.158 Test Acc: 0.694
Validation loss decreased (-0.680542 --> -0.694433).  Saving model ...
Epoch: 11 cost time: 0.9683680534362793
Epoch: 11, Steps: 7 | Train Loss: 0.860 Vali Loss: 0.987 Vali Acc: 0.708 Test Loss: 0.987 Test Acc: 0.708
Validation loss decreased (-0.694433 --> -0.708323).  Saving model ...
Epoch: 12 cost time: 0.8910701274871826
Epoch: 12, Steps: 7 | Train Loss: 0.692 Vali Loss: 0.847 Vali Acc: 0.736 Test Loss: 0.847 Test Acc: 0.736
Validation loss decreased (-0.708323 --> -0.736103).  Saving model ...
Epoch: 13 cost time: 0.9752752780914307
Epoch: 13, Steps: 7 | Train Loss: 0.563 Vali Loss: 0.735 Vali Acc: 0.764 Test Loss: 0.735 Test Acc: 0.764
Validation loss decreased (-0.736103 --> -0.763882).  Saving model ...
Epoch: 14 cost time: 0.843191385269165
Epoch: 14, Steps: 7 | Train Loss: 0.415 Vali Loss: 0.648 Vali Acc: 0.764 Test Loss: 0.648 Test Acc: 0.764
Validation loss decreased (-0.763882 --> -0.763882).  Saving model ...
Epoch: 15 cost time: 0.9850780963897705
Epoch: 15, Steps: 7 | Train Loss: 0.346 Vali Loss: 0.578 Vali Acc: 0.778 Test Loss: 0.578 Test Acc: 0.778
Validation loss decreased (-0.763882 --> -0.777772).  Saving model ...
Epoch: 16 cost time: 0.9876596927642822
Epoch: 16, Steps: 7 | Train Loss: 0.265 Vali Loss: 0.533 Vali Acc: 0.847 Test Loss: 0.533 Test Acc: 0.847
Validation loss decreased (-0.777772 --> -0.847217).  Saving model ...
Epoch: 17 cost time: 1.032240390777588
Epoch: 17, Steps: 7 | Train Loss: 0.226 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847217).  Saving model ...
Epoch: 18 cost time: 0.9039466381072998
Epoch: 18, Steps: 7 | Train Loss: 0.170 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847218).  Saving model ...
Epoch: 19 cost time: 0.9539120197296143
Epoch: 19, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.445 Vali Acc: 0.847 Test Loss: 0.445 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 20 cost time: 0.9833099842071533
Epoch: 20, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.426 Vali Acc: 0.861 Test Loss: 0.426 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861107).  Saving model ...
Epoch: 21 cost time: 0.9170229434967041
Epoch: 21, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.403 Vali Acc: 0.861 Test Loss: 0.403 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 22 cost time: 0.9620685577392578
Epoch: 22, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.392 Vali Acc: 0.861 Test Loss: 0.392 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 23 cost time: 1.0047147274017334
Epoch: 23, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.386 Vali Acc: 0.861 Test Loss: 0.386 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 24 cost time: 0.9078104496002197
Epoch: 24, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.379 Vali Acc: 0.861 Test Loss: 0.379 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 25 cost time: 0.9209210872650146
Epoch: 25, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.377 Vali Acc: 0.861 Test Loss: 0.377 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 26 cost time: 0.9774701595306396
Epoch: 26, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.366 Vali Acc: 0.861 Test Loss: 0.366 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 27 cost time: 0.9389410018920898
Epoch: 27, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.352 Vali Acc: 0.861 Test Loss: 0.352 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 28 cost time: 0.8774402141571045
Epoch: 28, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 29 cost time: 0.9942798614501953
Epoch: 29, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 30 cost time: 0.9837687015533447
Epoch: 30, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9582862854003906
Epoch: 31, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 32 cost time: 0.9015753269195557
Epoch: 32, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 33 cost time: 0.8445653915405273
Epoch: 33, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 34 cost time: 0.8729405403137207
Epoch: 34, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 35 cost time: 0.9463248252868652
Epoch: 35, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 36 cost time: 0.9435575008392334
Epoch: 36, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 37 cost time: 0.9336562156677246
Epoch: 37, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 38 cost time: 0.9108123779296875
Epoch: 38, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 39 cost time: 0.9311563968658447
Epoch: 39, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 40 cost time: 1.0036823749542236
Epoch: 40, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 41 cost time: 0.9139597415924072
Epoch: 41, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 0.9792861938476562
Epoch: 42, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9839417934417725
Epoch: 43, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 44 cost time: 0.8266735076904297
Epoch: 44, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 0.906686544418335
Epoch: 45, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 1.0048730373382568
Epoch: 46, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.9086425304412842
Epoch: 47, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8950574398040771
Epoch: 48, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.9774148464202881
Epoch: 49, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.9155311584472656
Epoch: 50, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 1.055129051208496
Epoch: 51, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.9516639709472656
Epoch: 52, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 53 cost time: 0.9414205551147461
Epoch: 53, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.9447910785675049
Epoch: 54, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 1.0681157112121582
Epoch: 55, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.8935930728912354
Epoch: 56, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.966921329498291
Epoch: 57, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 0.9071581363677979
Epoch: 58, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 59 cost time: 0.9719290733337402
Epoch: 59, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 60 cost time: 0.939255952835083
Epoch: 60, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.8716733455657959
Epoch: 61, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.9310598373413086
Epoch: 62, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 0.9108297824859619
Epoch: 63, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 64 cost time: 0.9840505123138428
Epoch: 64, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 65 cost time: 0.9584643840789795
Epoch: 65, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 66 cost time: 0.963451623916626
Epoch: 66, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 67 cost time: 0.8480725288391113
Epoch: 67, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.952333927154541
Epoch: 68, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8712832927703857
Epoch: 69, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.9450290203094482
Epoch: 70, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 71 cost time: 0.996495246887207
Epoch: 71, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 72 cost time: 1.0018033981323242
Epoch: 72, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 73 cost time: 0.9407627582550049
Epoch: 73, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 74 cost time: 0.8953261375427246
Epoch: 74, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 75 cost time: 0.9501223564147949
Epoch: 75, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.9737157821655273
Epoch: 76, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.8843646049499512
Epoch: 77, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.9113113880157471
Epoch: 78, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.9452500343322754
Epoch: 79, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.0104234218597412
Epoch: 80, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.9574475288391113
Epoch: 81, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 82 cost time: 0.9805200099945068
Epoch: 82, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 83 cost time: 0.9928390979766846
Epoch: 83, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 84 cost time: 1.0065248012542725
Epoch: 84, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 85 cost time: 1.0241780281066895
Epoch: 85, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 86 cost time: 0.887188196182251
Epoch: 86, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 87 cost time: 1.0306968688964844
Epoch: 87, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 88 cost time: 0.8972342014312744
Epoch: 88, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.898735523223877
Epoch: 89, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 90 cost time: 0.8814537525177002
Epoch: 90, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 91 cost time: 0.9328749179840088
Epoch: 91, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.8773159980773926
Epoch: 92, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.8497204780578613
Epoch: 93, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.9482371807098389
Epoch: 94, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.954789400100708
Epoch: 95, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.816704273223877
Epoch: 96, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 0.8278553485870361
Epoch: 97, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.903 Test Loss: 0.214 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.7880649566650391
Epoch: 98, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.903 Test Loss: 0.211 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 0.9609723091125488
Epoch: 99, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.903 Test Loss: 0.209 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 0.8827881813049316
Epoch: 100, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 34076
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df128_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5707576274871826
Epoch: 1, Steps: 7 | Train Loss: 2.776 Vali Loss: 2.651 Vali Acc: 0.083 Test Loss: 2.651 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 0.8360755443572998
Epoch: 2, Steps: 7 | Train Loss: 2.651 Vali Loss: 2.560 Vali Acc: 0.097 Test Loss: 2.560 Test Acc: 0.097
Validation loss decreased (-0.083307 --> -0.097197).  Saving model ...
Epoch: 3 cost time: 0.8251848220825195
Epoch: 3, Steps: 7 | Train Loss: 2.576 Vali Loss: 2.436 Vali Acc: 0.153 Test Loss: 2.436 Test Acc: 0.153
Validation loss decreased (-0.097197 --> -0.152753).  Saving model ...
Epoch: 4 cost time: 0.9337508678436279
Epoch: 4, Steps: 7 | Train Loss: 2.366 Vali Loss: 2.296 Vali Acc: 0.250 Test Loss: 2.296 Test Acc: 0.250
Validation loss decreased (-0.152753 --> -0.249977).  Saving model ...
Epoch: 5 cost time: 0.9286539554595947
Epoch: 5, Steps: 7 | Train Loss: 2.224 Vali Loss: 2.144 Vali Acc: 0.264 Test Loss: 2.144 Test Acc: 0.264
Validation loss decreased (-0.249977 --> -0.263867).  Saving model ...
Epoch: 6 cost time: 0.7936990261077881
Epoch: 6, Steps: 7 | Train Loss: 2.062 Vali Loss: 1.984 Vali Acc: 0.375 Test Loss: 1.984 Test Acc: 0.375
Validation loss decreased (-0.263867 --> -0.374980).  Saving model ...
Epoch: 7 cost time: 0.8253021240234375
Epoch: 7, Steps: 7 | Train Loss: 1.873 Vali Loss: 1.817 Vali Acc: 0.500 Test Loss: 1.817 Test Acc: 0.500
Validation loss decreased (-0.374980 --> -0.499982).  Saving model ...
Epoch: 8 cost time: 0.9249377250671387
Epoch: 8, Steps: 7 | Train Loss: 1.708 Vali Loss: 1.646 Vali Acc: 0.625 Test Loss: 1.646 Test Acc: 0.625
Validation loss decreased (-0.499982 --> -0.624984).  Saving model ...
Epoch: 9 cost time: 0.8968021869659424
Epoch: 9, Steps: 7 | Train Loss: 1.530 Vali Loss: 1.467 Vali Acc: 0.681 Test Loss: 1.467 Test Acc: 0.681
Validation loss decreased (-0.624984 --> -0.680541).  Saving model ...
Epoch: 10 cost time: 0.8617308139801025
Epoch: 10, Steps: 7 | Train Loss: 1.315 Vali Loss: 1.300 Vali Acc: 0.736 Test Loss: 1.300 Test Acc: 0.736
Validation loss decreased (-0.680541 --> -0.736098).  Saving model ...
Epoch: 11 cost time: 0.8632044792175293
Epoch: 11, Steps: 7 | Train Loss: 1.143 Vali Loss: 1.149 Vali Acc: 0.778 Test Loss: 1.149 Test Acc: 0.778
Validation loss decreased (-0.736098 --> -0.777766).  Saving model ...
Epoch: 12 cost time: 0.8490455150604248
Epoch: 12, Steps: 7 | Train Loss: 0.952 Vali Loss: 1.019 Vali Acc: 0.819 Test Loss: 1.019 Test Acc: 0.819
Validation loss decreased (-0.777766 --> -0.819434).  Saving model ...
Epoch: 13 cost time: 0.8030509948730469
Epoch: 13, Steps: 7 | Train Loss: 0.786 Vali Loss: 0.895 Vali Acc: 0.833 Test Loss: 0.895 Test Acc: 0.833
Validation loss decreased (-0.819434 --> -0.833324).  Saving model ...
Epoch: 14 cost time: 0.9846649169921875
Epoch: 14, Steps: 7 | Train Loss: 0.635 Vali Loss: 0.790 Vali Acc: 0.833 Test Loss: 0.790 Test Acc: 0.833
Validation loss decreased (-0.833324 --> -0.833325).  Saving model ...
Epoch: 15 cost time: 1.0376431941986084
Epoch: 15, Steps: 7 | Train Loss: 0.520 Vali Loss: 0.704 Vali Acc: 0.833 Test Loss: 0.704 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833326).  Saving model ...
Epoch: 16 cost time: 1.072622299194336
Epoch: 16, Steps: 7 | Train Loss: 0.443 Vali Loss: 0.643 Vali Acc: 0.847 Test Loss: 0.643 Test Acc: 0.847
Validation loss decreased (-0.833326 --> -0.847216).  Saving model ...
Epoch: 17 cost time: 0.9493386745452881
Epoch: 17, Steps: 7 | Train Loss: 0.392 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861105).  Saving model ...
Epoch: 18 cost time: 0.8934061527252197
Epoch: 18, Steps: 7 | Train Loss: 0.326 Vali Loss: 0.548 Vali Acc: 0.861 Test Loss: 0.548 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 19 cost time: 0.9137639999389648
Epoch: 19, Steps: 7 | Train Loss: 0.260 Vali Loss: 0.521 Vali Acc: 0.875 Test Loss: 0.521 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874995).  Saving model ...
Epoch: 20 cost time: 0.9830605983734131
Epoch: 20, Steps: 7 | Train Loss: 0.235 Vali Loss: 0.503 Vali Acc: 0.889 Test Loss: 0.503 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888884).  Saving model ...
Epoch: 21 cost time: 0.9597697257995605
Epoch: 21, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9428424835205078
Epoch: 22, Steps: 7 | Train Loss: 0.179 Vali Loss: 0.453 Vali Acc: 0.889 Test Loss: 0.453 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 23 cost time: 0.9631338119506836
Epoch: 23, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.437 Vali Acc: 0.889 Test Loss: 0.437 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 24 cost time: 0.9745290279388428
Epoch: 24, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.426 Vali Acc: 0.889 Test Loss: 0.426 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 25 cost time: 0.9974591732025146
Epoch: 25, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 26 cost time: 0.9438996315002441
Epoch: 26, Steps: 7 | Train Loss: 0.118 Vali Loss: 0.404 Vali Acc: 0.903 Test Loss: 0.404 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 27 cost time: 0.9151716232299805
Epoch: 27, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 28 cost time: 0.9250738620758057
Epoch: 28, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.390 Vali Acc: 0.903 Test Loss: 0.390 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 29 cost time: 0.9046742916107178
Epoch: 29, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.379 Vali Acc: 0.903 Test Loss: 0.379 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 30 cost time: 0.97454833984375
Epoch: 30, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0404539108276367
Epoch: 31, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8594212532043457
Epoch: 32, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 33 cost time: 0.9662377834320068
Epoch: 33, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 34 cost time: 0.8490452766418457
Epoch: 34, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 35 cost time: 0.898101806640625
Epoch: 35, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 36 cost time: 0.8341324329376221
Epoch: 36, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.344 Vali Acc: 0.903 Test Loss: 0.344 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 37 cost time: 0.8786981105804443
Epoch: 37, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 38 cost time: 0.915863037109375
Epoch: 38, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 39 cost time: 0.8617727756500244
Epoch: 39, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 40 cost time: 0.8721191883087158
Epoch: 40, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 1.0117566585540771
Epoch: 41, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.8647787570953369
Epoch: 42, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.9647367000579834
Epoch: 43, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.9139368534088135
Epoch: 44, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.8517472743988037
Epoch: 45, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.8917033672332764
Epoch: 46, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.8752791881561279
Epoch: 47, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.965954065322876
Epoch: 48, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.9951117038726807
Epoch: 49, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.9407367706298828
Epoch: 50, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.9089617729187012
Epoch: 51, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.8797540664672852
Epoch: 52, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 53 cost time: 0.9208822250366211
Epoch: 53, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.913670539855957
Epoch: 54, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.9626259803771973
Epoch: 55, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.9037134647369385
Epoch: 56, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 57 cost time: 0.9702091217041016
Epoch: 57, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 0.925579309463501
Epoch: 58, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 59 cost time: 0.8640964031219482
Epoch: 59, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 60 cost time: 1.0491993427276611
Epoch: 60, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.9527125358581543
Epoch: 61, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.9428303241729736
Epoch: 62, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 0.9640307426452637
Epoch: 63, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.9055619239807129
Epoch: 64, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.989330530166626
Epoch: 65, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.9359874725341797
Epoch: 66, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.8986501693725586
Epoch: 67, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 68 cost time: 0.8922481536865234
Epoch: 68, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 69 cost time: 1.0081310272216797
Epoch: 69, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 70 cost time: 0.9528679847717285
Epoch: 70, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 71 cost time: 0.8800008296966553
Epoch: 71, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 72 cost time: 0.9150550365447998
Epoch: 72, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 73 cost time: 0.8176014423370361
Epoch: 73, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 74 cost time: 0.8590750694274902
Epoch: 74, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 75 cost time: 0.7934625148773193
Epoch: 75, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 76 cost time: 0.924828052520752
Epoch: 76, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 77 cost time: 0.8945131301879883
Epoch: 77, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 78 cost time: 0.84222412109375
Epoch: 78, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.9654877185821533
Epoch: 79, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.9929261207580566
Epoch: 80, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 81 cost time: 0.9635903835296631
Epoch: 81, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 82 cost time: 0.8598945140838623
Epoch: 82, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 83 cost time: 0.8726096153259277
Epoch: 83, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 84 cost time: 0.9157841205596924
Epoch: 84, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 85 cost time: 0.9165663719177246
Epoch: 85, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.9693188667297363
Epoch: 86, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.8594644069671631
Epoch: 87, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 88 cost time: 0.9167039394378662
Epoch: 88, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 89 cost time: 0.9215829372406006
Epoch: 89, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 90 cost time: 0.9440081119537354
Epoch: 90, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 1.041454792022705
Epoch: 91, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.944645881652832
Epoch: 92, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.9366166591644287
Epoch: 93, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.9653403759002686
Epoch: 94, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.8923652172088623
Epoch: 95, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 96 cost time: 0.9378736019134521
Epoch: 96, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.9721617698669434
Epoch: 97, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.9475686550140381
Epoch: 98, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.8832857608795166
Epoch: 99, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 1.0338966846466064
Epoch: 100, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df128_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 30428
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5839688777923584
Epoch: 1, Steps: 7 | Train Loss: 2.588 Vali Loss: 2.494 Vali Acc: 0.042 Test Loss: 2.494 Test Acc: 0.042
Validation loss decreased (inf --> -0.041642).  Saving model ...
Epoch: 2 cost time: 0.8679394721984863
Epoch: 2, Steps: 7 | Train Loss: 2.570 Vali Loss: 2.410 Vali Acc: 0.042 Test Loss: 2.410 Test Acc: 0.042
Validation loss decreased (-0.041642 --> -0.041643).  Saving model ...
Epoch: 3 cost time: 0.8556251525878906
Epoch: 3, Steps: 7 | Train Loss: 2.437 Vali Loss: 2.306 Vali Acc: 0.097 Test Loss: 2.306 Test Acc: 0.097
Validation loss decreased (-0.041643 --> -0.097199).  Saving model ...
Epoch: 4 cost time: 0.8492617607116699
Epoch: 4, Steps: 7 | Train Loss: 2.392 Vali Loss: 2.191 Vali Acc: 0.181 Test Loss: 2.191 Test Acc: 0.181
Validation loss decreased (-0.097199 --> -0.180534).  Saving model ...
Epoch: 5 cost time: 0.8557291030883789
Epoch: 5, Steps: 7 | Train Loss: 2.234 Vali Loss: 2.069 Vali Acc: 0.278 Test Loss: 2.069 Test Acc: 0.278
Validation loss decreased (-0.180534 --> -0.277757).  Saving model ...
Epoch: 6 cost time: 0.795720100402832
Epoch: 6, Steps: 7 | Train Loss: 2.096 Vali Loss: 1.941 Vali Acc: 0.403 Test Loss: 1.941 Test Acc: 0.403
Validation loss decreased (-0.277757 --> -0.402758).  Saving model ...
Epoch: 7 cost time: 0.8559794425964355
Epoch: 7, Steps: 7 | Train Loss: 1.908 Vali Loss: 1.813 Vali Acc: 0.486 Test Loss: 1.813 Test Acc: 0.486
Validation loss decreased (-0.402758 --> -0.486093).  Saving model ...
Epoch: 8 cost time: 0.8978128433227539
Epoch: 8, Steps: 7 | Train Loss: 1.771 Vali Loss: 1.679 Vali Acc: 0.597 Test Loss: 1.679 Test Acc: 0.597
Validation loss decreased (-0.486093 --> -0.597205).  Saving model ...
Epoch: 9 cost time: 0.9835801124572754
Epoch: 9, Steps: 7 | Train Loss: 1.633 Vali Loss: 1.539 Vali Acc: 0.681 Test Loss: 1.539 Test Acc: 0.681
Validation loss decreased (-0.597205 --> -0.680540).  Saving model ...
Epoch: 10 cost time: 1.0066077709197998
Epoch: 10, Steps: 7 | Train Loss: 1.470 Vali Loss: 1.396 Vali Acc: 0.736 Test Loss: 1.396 Test Acc: 0.736
Validation loss decreased (-0.680540 --> -0.736097).  Saving model ...
Epoch: 11 cost time: 1.0107076168060303
Epoch: 11, Steps: 7 | Train Loss: 1.253 Vali Loss: 1.265 Vali Acc: 0.750 Test Loss: 1.265 Test Acc: 0.750
Validation loss decreased (-0.736097 --> -0.749987).  Saving model ...
Epoch: 12 cost time: 1.0016343593597412
Epoch: 12, Steps: 7 | Train Loss: 1.099 Vali Loss: 1.130 Vali Acc: 0.778 Test Loss: 1.130 Test Acc: 0.778
Validation loss decreased (-0.749987 --> -0.777766).  Saving model ...
Epoch: 13 cost time: 0.9991397857666016
Epoch: 13, Steps: 7 | Train Loss: 0.957 Vali Loss: 1.002 Vali Acc: 0.792 Test Loss: 1.002 Test Acc: 0.792
Validation loss decreased (-0.777766 --> -0.791657).  Saving model ...
Epoch: 14 cost time: 1.0470342636108398
Epoch: 14, Steps: 7 | Train Loss: 0.866 Vali Loss: 0.900 Vali Acc: 0.806 Test Loss: 0.900 Test Acc: 0.806
Validation loss decreased (-0.791657 --> -0.805547).  Saving model ...
Epoch: 15 cost time: 1.0299036502838135
Epoch: 15, Steps: 7 | Train Loss: 0.682 Vali Loss: 0.807 Vali Acc: 0.833 Test Loss: 0.807 Test Acc: 0.833
Validation loss decreased (-0.805547 --> -0.833325).  Saving model ...
Epoch: 16 cost time: 1.0389015674591064
Epoch: 16, Steps: 7 | Train Loss: 0.614 Vali Loss: 0.730 Vali Acc: 0.833 Test Loss: 0.730 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833326).  Saving model ...
Epoch: 17 cost time: 0.8914005756378174
Epoch: 17, Steps: 7 | Train Loss: 0.485 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 1.0110104084014893
Epoch: 18, Steps: 7 | Train Loss: 0.453 Vali Loss: 0.586 Vali Acc: 0.875 Test Loss: 0.586 Test Acc: 0.875
Validation loss decreased (-0.833327 --> -0.874994).  Saving model ...
Epoch: 19 cost time: 1.0733261108398438
Epoch: 19, Steps: 7 | Train Loss: 0.356 Vali Loss: 0.543 Vali Acc: 0.889 Test Loss: 0.543 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888883).  Saving model ...
Epoch: 20 cost time: 0.9720418453216553
Epoch: 20, Steps: 7 | Train Loss: 0.293 Vali Loss: 0.511 Vali Acc: 0.903 Test Loss: 0.511 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902773).  Saving model ...
Epoch: 21 cost time: 0.9564876556396484
Epoch: 21, Steps: 7 | Train Loss: 0.274 Vali Loss: 0.485 Vali Acc: 0.903 Test Loss: 0.485 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 22 cost time: 0.9315242767333984
Epoch: 22, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.462 Vali Acc: 0.903 Test Loss: 0.462 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 23 cost time: 1.0013864040374756
Epoch: 23, Steps: 7 | Train Loss: 0.218 Vali Loss: 0.451 Vali Acc: 0.917 Test Loss: 0.451 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916662).  Saving model ...
Epoch: 24 cost time: 0.9423787593841553
Epoch: 24, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.433 Vali Acc: 0.917 Test Loss: 0.433 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 25 cost time: 0.9571127891540527
Epoch: 25, Steps: 7 | Train Loss: 0.163 Vali Loss: 0.420 Vali Acc: 0.917 Test Loss: 0.420 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 26 cost time: 1.0678925514221191
Epoch: 26, Steps: 7 | Train Loss: 0.143 Vali Loss: 0.408 Vali Acc: 0.903 Test Loss: 0.408 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9878921508789062
Epoch: 27, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.390 Vali Acc: 0.917 Test Loss: 0.390 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 28 cost time: 1.072033405303955
Epoch: 28, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.375 Vali Acc: 0.917 Test Loss: 0.375 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 29 cost time: 1.0074410438537598
Epoch: 29, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.364 Vali Acc: 0.917 Test Loss: 0.364 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 30 cost time: 0.8347251415252686
Epoch: 30, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.359 Vali Acc: 0.931 Test Loss: 0.359 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 31 cost time: 0.8856098651885986
Epoch: 31, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.354 Vali Acc: 0.917 Test Loss: 0.354 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9068756103515625
Epoch: 32, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7782342433929443
Epoch: 33, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.343 Vali Acc: 0.917 Test Loss: 0.343 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8569996356964111
Epoch: 34, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8532660007476807
Epoch: 35, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.328 Vali Acc: 0.917 Test Loss: 0.328 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8802609443664551
Epoch: 36, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9929690361022949
Epoch: 37, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 38 cost time: 0.8988513946533203
Epoch: 38, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.308 Vali Acc: 0.931 Test Loss: 0.308 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 39 cost time: 0.8921306133270264
Epoch: 39, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.7896294593811035
Epoch: 40, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.310 Vali Acc: 0.931 Test Loss: 0.310 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8643901348114014
Epoch: 41, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0021955966949463
Epoch: 42, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944441).  Saving model ...
Epoch: 43 cost time: 0.9988384246826172
Epoch: 43, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.9516043663024902
Epoch: 44, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0556666851043701
Epoch: 45, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9639766216278076
Epoch: 46, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9413588047027588
Epoch: 47, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.9423086643218994
Epoch: 48, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9635381698608398
Epoch: 49, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9488141536712646
Epoch: 50, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.9314606189727783
Epoch: 51, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.8772187232971191
Epoch: 52, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 0.9403674602508545
Epoch: 53, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9372799396514893
Epoch: 54, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.9919953346252441
Epoch: 55, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 0.9389975070953369
Epoch: 56, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 0.985184907913208
Epoch: 57, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.8514361381530762
Epoch: 58, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8420319557189941
Epoch: 59, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 0.8929755687713623
Epoch: 60, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9371306896209717
Epoch: 61, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.8550574779510498
Epoch: 62, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 63 cost time: 0.8979389667510986
Epoch: 63, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 64 cost time: 0.8537943363189697
Epoch: 64, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.783233642578125
Epoch: 65, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.8748829364776611
Epoch: 66, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.8046557903289795
Epoch: 67, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.844606876373291
Epoch: 68, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.8363447189331055
Epoch: 69, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 70 cost time: 0.7972991466522217
Epoch: 70, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8029220104217529
Epoch: 71, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 72 cost time: 0.7889463901519775
Epoch: 72, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 73 cost time: 0.8505711555480957
Epoch: 73, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 74 cost time: 0.8816752433776855
Epoch: 74, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.8818719387054443
Epoch: 75, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.929893970489502
Epoch: 76, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 77 cost time: 0.9194576740264893
Epoch: 77, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 78 cost time: 0.9731359481811523
Epoch: 78, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.9930593967437744
Epoch: 79, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.9342191219329834
Epoch: 80, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.0048243999481201
Epoch: 81, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.240 Vali Acc: 0.958 Test Loss: 0.240 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 82 cost time: 0.9076831340789795
Epoch: 82, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 83 cost time: 0.9632322788238525
Epoch: 83, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.8715476989746094
Epoch: 84, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.0226857662200928
Epoch: 85, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 86 cost time: 0.8320493698120117
Epoch: 86, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.9269258975982666
Epoch: 87, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 88 cost time: 0.9060418605804443
Epoch: 88, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 89 cost time: 0.9926557540893555
Epoch: 89, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 90 cost time: 0.9107797145843506
Epoch: 90, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 91 cost time: 0.9950950145721436
Epoch: 91, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 92 cost time: 0.9244937896728516
Epoch: 92, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.0052154064178467
Epoch: 93, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.9682679176330566
Epoch: 94, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 0.9633007049560547
Epoch: 95, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 96 cost time: 0.8496506214141846
Epoch: 96, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.9174292087554932
Epoch: 97, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.8673417568206787
Epoch: 98, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.8986480236053467
Epoch: 99, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.9000039100646973
Epoch: 100, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 29084
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7954182624816895
Epoch: 1, Steps: 7 | Train Loss: 2.716 Vali Loss: 2.499 Vali Acc: 0.111 Test Loss: 2.499 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.9979953765869141
Epoch: 2, Steps: 7 | Train Loss: 2.467 Vali Loss: 2.286 Vali Acc: 0.278 Test Loss: 2.286 Test Acc: 0.278
Validation loss decreased (-0.111086 --> -0.277755).  Saving model ...
Epoch: 3 cost time: 0.8992581367492676
Epoch: 3, Steps: 7 | Train Loss: 2.079 Vali Loss: 1.980 Vali Acc: 0.486 Test Loss: 1.980 Test Acc: 0.486
Validation loss decreased (-0.277755 --> -0.486091).  Saving model ...
Epoch: 4 cost time: 1.0484490394592285
Epoch: 4, Steps: 7 | Train Loss: 1.692 Vali Loss: 1.604 Vali Acc: 0.597 Test Loss: 1.604 Test Acc: 0.597
Validation loss decreased (-0.486091 --> -0.597206).  Saving model ...
Epoch: 5 cost time: 0.9233615398406982
Epoch: 5, Steps: 7 | Train Loss: 1.236 Vali Loss: 1.216 Vali Acc: 0.722 Test Loss: 1.216 Test Acc: 0.722
Validation loss decreased (-0.597206 --> -0.722210).  Saving model ...
Epoch: 6 cost time: 0.9640226364135742
Epoch: 6, Steps: 7 | Train Loss: 0.868 Vali Loss: 0.883 Vali Acc: 0.806 Test Loss: 0.883 Test Acc: 0.806
Validation loss decreased (-0.722210 --> -0.805547).  Saving model ...
Epoch: 7 cost time: 0.971569299697876
Epoch: 7, Steps: 7 | Train Loss: 0.520 Vali Loss: 0.685 Vali Acc: 0.847 Test Loss: 0.685 Test Acc: 0.847
Validation loss decreased (-0.805547 --> -0.847215).  Saving model ...
Epoch: 8 cost time: 0.9719805717468262
Epoch: 8, Steps: 7 | Train Loss: 0.304 Vali Loss: 0.510 Vali Acc: 0.903 Test Loss: 0.510 Test Acc: 0.903
Validation loss decreased (-0.847215 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 0.971217155456543
Epoch: 9, Steps: 7 | Train Loss: 0.160 Vali Loss: 0.445 Vali Acc: 0.861 Test Loss: 0.445 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8772447109222412
Epoch: 10, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8491318225860596
Epoch: 11, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8657052516937256
Epoch: 12, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0201244354248047
Epoch: 13, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8677833080291748
Epoch: 14, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9540178775787354
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9125089645385742
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.9285914897918701
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9440851211547852
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.923076868057251
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.8386735916137695
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.894179105758667
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.8639497756958008
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.8620588779449463
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.8792552947998047
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.8756263256072998
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.94258713722229
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.877678632736206
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8171122074127197
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9043631553649902
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.051811933517456
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.024860143661499
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8362174034118652
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8655154705047607
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.9323554039001465
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 1.0530917644500732
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.9142253398895264
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.9309852123260498
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.9831480979919434
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.9592044353485107
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 1.0672359466552734
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8776569366455078
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.9156768321990967
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 1.0156424045562744
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.9575934410095215
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0342657566070557
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.9700918197631836
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.0671231746673584
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.053445816040039
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9967434406280518
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9139671325683594
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.0896377563476562
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 0.9305064678192139
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 1.0058655738830566
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.9104375839233398
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7931716442108154
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 0.8796651363372803
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 0.9519913196563721
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 0.8527834415435791
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 59 cost time: 0.8631346225738525
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 60 cost time: 0.9735798835754395
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 61 cost time: 0.8213751316070557
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 62 cost time: 0.8717095851898193
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 63 cost time: 0.8112051486968994
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 64 cost time: 0.9273843765258789
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 65 cost time: 0.9197216033935547
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 66 cost time: 0.9043757915496826
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9047925472259521
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 68 cost time: 0.9818019866943359
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 69 cost time: 0.9319171905517578
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 70 cost time: 1.0133085250854492
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 71 cost time: 0.921694278717041
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 72 cost time: 1.0384154319763184
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 73 cost time: 0.9380865097045898
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 74 cost time: 1.0494608879089355
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 75 cost time: 0.9913623332977295
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.030956506729126
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.007842779159546
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.8854553699493408
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.1083080768585205
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.0522692203521729
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 1.009190559387207
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 82 cost time: 0.9469666481018066
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 83 cost time: 0.986433744430542
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 84 cost time: 0.9663710594177246
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 85 cost time: 1.1431035995483398
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.9209794998168945
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.9167187213897705
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.898796558380127
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.9698412418365479
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 0.9348430633544922
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 0.9034264087677002
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 0.9069664478302002
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 0.9288942813873291
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 0.9734749794006348
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 101372
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.667004108428955
Epoch: 1, Steps: 7 | Train Loss: 2.627 Vali Loss: 2.481 Vali Acc: 0.097 Test Loss: 2.481 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.9612131118774414
Epoch: 2, Steps: 7 | Train Loss: 2.465 Vali Loss: 2.248 Vali Acc: 0.250 Test Loss: 2.248 Test Acc: 0.250
Validation loss decreased (-0.097197 --> -0.249978).  Saving model ...
Epoch: 3 cost time: 0.8628003597259521
Epoch: 3, Steps: 7 | Train Loss: 2.233 Vali Loss: 1.961 Vali Acc: 0.500 Test Loss: 1.961 Test Acc: 0.500
Validation loss decreased (-0.249978 --> -0.499980).  Saving model ...
Epoch: 4 cost time: 1.0007762908935547
Epoch: 4, Steps: 7 | Train Loss: 1.871 Vali Loss: 1.660 Vali Acc: 0.681 Test Loss: 1.660 Test Acc: 0.681
Validation loss decreased (-0.499980 --> -0.680539).  Saving model ...
Epoch: 5 cost time: 0.8476903438568115
Epoch: 5, Steps: 7 | Train Loss: 1.545 Vali Loss: 1.360 Vali Acc: 0.750 Test Loss: 1.360 Test Acc: 0.750
Validation loss decreased (-0.680539 --> -0.749986).  Saving model ...
Epoch: 6 cost time: 0.9008669853210449
Epoch: 6, Steps: 7 | Train Loss: 1.191 Vali Loss: 1.078 Vali Acc: 0.819 Test Loss: 1.078 Test Acc: 0.819
Validation loss decreased (-0.749986 --> -0.819434).  Saving model ...
Epoch: 7 cost time: 0.8365633487701416
Epoch: 7, Steps: 7 | Train Loss: 0.885 Vali Loss: 0.804 Vali Acc: 0.861 Test Loss: 0.804 Test Acc: 0.861
Validation loss decreased (-0.819434 --> -0.861103).  Saving model ...
Epoch: 8 cost time: 0.9507365226745605
Epoch: 8, Steps: 7 | Train Loss: 0.548 Vali Loss: 0.618 Vali Acc: 0.903 Test Loss: 0.618 Test Acc: 0.903
Validation loss decreased (-0.861103 --> -0.902772).  Saving model ...
Epoch: 9 cost time: 0.8327112197875977
Epoch: 9, Steps: 7 | Train Loss: 0.411 Vali Loss: 0.494 Vali Acc: 0.917 Test Loss: 0.494 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916662).  Saving model ...
Epoch: 10 cost time: 0.903742790222168
Epoch: 10, Steps: 7 | Train Loss: 0.269 Vali Loss: 0.387 Vali Acc: 0.958 Test Loss: 0.387 Test Acc: 0.958
Validation loss decreased (-0.916662 --> -0.958329).  Saving model ...
Epoch: 11 cost time: 0.7940473556518555
Epoch: 11, Steps: 7 | Train Loss: 0.157 Vali Loss: 0.341 Vali Acc: 0.931 Test Loss: 0.341 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9530065059661865
Epoch: 12, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.342 Vali Acc: 0.917 Test Loss: 0.342 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8940560817718506
Epoch: 13, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.303 Vali Acc: 0.931 Test Loss: 0.303 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9292106628417969
Epoch: 14, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0015652179718018
Epoch: 15, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9814572334289551
Epoch: 16, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1021223068237305
Epoch: 17, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9227039813995361
Epoch: 18, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.958329 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.8211867809295654
Epoch: 19, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9315242767333984
Epoch: 20, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9278073310852051
Epoch: 21, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.9100258350372314
Epoch: 22, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.901648759841919
Epoch: 23, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.972 Test Loss: 0.210 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 24 cost time: 0.7818701267242432
Epoch: 24, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9167373180389404
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8192765712738037
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9396023750305176
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8786134719848633
Epoch: 28, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.925044059753418
Epoch: 29, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 30 cost time: 0.9087076187133789
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9382510185241699
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8636977672576904
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.026454210281372
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8741669654846191
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0445139408111572
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8601984977722168
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0753583908081055
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0124859809875488
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9823367595672607
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 55772
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.875790596008301
Epoch: 1, Steps: 7 | Train Loss: 2.619 Vali Loss: 2.547 Vali Acc: 0.014 Test Loss: 2.547 Test Acc: 0.014
Validation loss decreased (inf --> -0.013863).  Saving model ...
Epoch: 2 cost time: 0.9724686145782471
Epoch: 2, Steps: 7 | Train Loss: 2.509 Vali Loss: 2.372 Vali Acc: 0.111 Test Loss: 2.372 Test Acc: 0.111
Validation loss decreased (-0.013863 --> -0.111087).  Saving model ...
Epoch: 3 cost time: 1.00638747215271
Epoch: 3, Steps: 7 | Train Loss: 2.270 Vali Loss: 2.145 Vali Acc: 0.306 Test Loss: 2.145 Test Acc: 0.306
Validation loss decreased (-0.111087 --> -0.305534).  Saving model ...
Epoch: 4 cost time: 1.040367841720581
Epoch: 4, Steps: 7 | Train Loss: 1.980 Vali Loss: 1.884 Vali Acc: 0.542 Test Loss: 1.884 Test Acc: 0.542
Validation loss decreased (-0.305534 --> -0.541648).  Saving model ...
Epoch: 5 cost time: 0.91896653175354
Epoch: 5, Steps: 7 | Train Loss: 1.743 Vali Loss: 1.618 Vali Acc: 0.667 Test Loss: 1.618 Test Acc: 0.667
Validation loss decreased (-0.541648 --> -0.666650).  Saving model ...
Epoch: 6 cost time: 0.8339731693267822
Epoch: 6, Steps: 7 | Train Loss: 1.388 Vali Loss: 1.349 Vali Acc: 0.736 Test Loss: 1.349 Test Acc: 0.736
Validation loss decreased (-0.666650 --> -0.736098).  Saving model ...
Epoch: 7 cost time: 0.8760125637054443
Epoch: 7, Steps: 7 | Train Loss: 1.176 Vali Loss: 1.091 Vali Acc: 0.792 Test Loss: 1.091 Test Acc: 0.792
Validation loss decreased (-0.736098 --> -0.791656).  Saving model ...
Epoch: 8 cost time: 0.8673734664916992
Epoch: 8, Steps: 7 | Train Loss: 0.874 Vali Loss: 0.874 Vali Acc: 0.819 Test Loss: 0.874 Test Acc: 0.819
Validation loss decreased (-0.791656 --> -0.819436).  Saving model ...
Epoch: 9 cost time: 0.8849349021911621
Epoch: 9, Steps: 7 | Train Loss: 0.602 Vali Loss: 0.715 Vali Acc: 0.806 Test Loss: 0.715 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8065955638885498
Epoch: 10, Steps: 7 | Train Loss: 0.484 Vali Loss: 0.585 Vali Acc: 0.875 Test Loss: 0.585 Test Acc: 0.875
Validation loss decreased (-0.819436 --> -0.874994).  Saving model ...
Epoch: 11 cost time: 0.8134829998016357
Epoch: 11, Steps: 7 | Train Loss: 0.342 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 12 cost time: 0.8094339370727539
Epoch: 12, Steps: 7 | Train Loss: 0.246 Vali Loss: 0.444 Vali Acc: 0.861 Test Loss: 0.444 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.875577449798584
Epoch: 13, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.396 Vali Acc: 0.903 Test Loss: 0.396 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 0.835106372833252
Epoch: 14, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 0.9602706432342529
Epoch: 15, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8179054260253906
Epoch: 16, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 1.0327494144439697
Epoch: 17, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 18 cost time: 0.8437438011169434
Epoch: 18, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.9264471530914307
Epoch: 19, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8576357364654541
Epoch: 20, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.9534790515899658
Epoch: 21, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.867800235748291
Epoch: 22, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.9062094688415527
Epoch: 23, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.014350175857544
Epoch: 24, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0109169483184814
Epoch: 25, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.8760249614715576
Epoch: 26, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.9315280914306641
Epoch: 27, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.934157133102417
Epoch: 28, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.9676527976989746
Epoch: 29, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 1.027897596359253
Epoch: 30, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 1.0460205078125
Epoch: 31, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2353019714355469
Epoch: 32, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 1.109769582748413
Epoch: 33, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.9101996421813965
Epoch: 34, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.9307029247283936
Epoch: 35, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.9129111766815186
Epoch: 36, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.979602575302124
Epoch: 37, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.8964591026306152
Epoch: 38, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 39 cost time: 0.8704667091369629
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 40 cost time: 0.9312729835510254
Epoch: 40, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 41 cost time: 0.8061740398406982
Epoch: 41, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8726041316986084
Epoch: 42, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 43 cost time: 0.863903284072876
Epoch: 43, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 44 cost time: 0.8877735137939453
Epoch: 44, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 45 cost time: 0.9846279621124268
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 46 cost time: 0.9910297393798828
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 47 cost time: 0.9629731178283691
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.032332420349121
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 49 cost time: 0.965543270111084
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.214 Vali Acc: 0.903 Test Loss: 0.214 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 50 cost time: 0.92952561378479
Epoch: 50, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 51 cost time: 0.9129788875579834
Epoch: 51, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 52 cost time: 0.9315555095672607
Epoch: 52, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 53 cost time: 0.8846867084503174
Epoch: 53, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.903 Test Loss: 0.208 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 54 cost time: 1.032790184020996
Epoch: 54, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.903 Test Loss: 0.207 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 55 cost time: 0.9751720428466797
Epoch: 55, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.903 Test Loss: 0.204 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 56 cost time: 0.9647071361541748
Epoch: 56, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.903 Test Loss: 0.203 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 57 cost time: 0.9800570011138916
Epoch: 57, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.903 Test Loss: 0.204 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0135478973388672
Epoch: 58, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.903 Test Loss: 0.204 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9483058452606201
Epoch: 59, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.903 Test Loss: 0.203 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 60 cost time: 0.9796452522277832
Epoch: 60, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.903 Test Loss: 0.203 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 61 cost time: 0.9706392288208008
Epoch: 61, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.903 Test Loss: 0.202 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 62 cost time: 0.9436836242675781
Epoch: 62, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 63 cost time: 1.0027048587799072
Epoch: 63, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 64 cost time: 1.000262975692749
Epoch: 64, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 65 cost time: 0.8663225173950195
Epoch: 65, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.9799683094024658
Epoch: 66, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.903 Test Loss: 0.198 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 67 cost time: 1.1080808639526367
Epoch: 67, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.903 Test Loss: 0.197 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 68 cost time: 1.0855703353881836
Epoch: 68, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.903 Test Loss: 0.197 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 69 cost time: 0.9347355365753174
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.903 Test Loss: 0.195 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 70 cost time: 0.8621649742126465
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.903 Test Loss: 0.195 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 71 cost time: 1.0194244384765625
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.903 Test Loss: 0.196 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.1301565170288086
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.903 Test Loss: 0.196 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.0030362606048584
Epoch: 73, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.903 Test Loss: 0.196 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.9662783145904541
Epoch: 74, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.903 Test Loss: 0.194 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 75 cost time: 0.921196460723877
Epoch: 75, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.903 Test Loss: 0.192 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 76 cost time: 0.8088359832763672
Epoch: 76, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.903 Test Loss: 0.191 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 77 cost time: 1.0187592506408691
Epoch: 77, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.903 Test Loss: 0.190 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 78 cost time: 0.8028900623321533
Epoch: 78, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.903 Test Loss: 0.189 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 79 cost time: 1.002272605895996
Epoch: 79, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.903 Test Loss: 0.189 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 80 cost time: 0.7740600109100342
Epoch: 80, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.903 Test Loss: 0.188 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 81 cost time: 0.9275391101837158
Epoch: 81, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.903 Test Loss: 0.188 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 82 cost time: 0.8465213775634766
Epoch: 82, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.903 Test Loss: 0.188 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 83 cost time: 0.9126102924346924
Epoch: 83, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.903 Test Loss: 0.188 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 84 cost time: 0.8525233268737793
Epoch: 84, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.903 Test Loss: 0.188 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 85 cost time: 0.9274349212646484
Epoch: 85, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.903 Test Loss: 0.189 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.001516580581665
Epoch: 86, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.903 Test Loss: 0.187 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 87 cost time: 0.859689474105835
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
Validation loss decreased (-0.902776 --> -0.916665).  Saving model ...
Epoch: 88 cost time: 0.9914841651916504
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 89 cost time: 0.9496786594390869
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.917 Test Loss: 0.184 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 90 cost time: 0.95306396484375
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.903 Test Loss: 0.183 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.9788079261779785
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.903 Test Loss: 0.182 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.8898763656616211
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.903 Test Loss: 0.182 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.8793954849243164
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.903 Test Loss: 0.182 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.9648420810699463
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.903 Test Loss: 0.182 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.8565070629119873
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.903 Test Loss: 0.181 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 1.0112733840942383
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.903 Test Loss: 0.182 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 0.9457154273986816
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 98 cost time: 1.0738232135772705
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.917 Test Loss: 0.182 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 99 cost time: 0.9072163105010986
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.903 Test Loss: 0.183 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 0.9991569519042969
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.917 Test Loss: 0.182 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 41276
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df64_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8926987648010254
Epoch: 1, Steps: 7 | Train Loss: 2.440 Vali Loss: 2.396 Vali Acc: 0.111 Test Loss: 2.396 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 0.9397668838500977
Epoch: 2, Steps: 7 | Train Loss: 2.433 Vali Loss: 2.280 Vali Acc: 0.181 Test Loss: 2.280 Test Acc: 0.181
Validation loss decreased (-0.111087 --> -0.180533).  Saving model ...
Epoch: 3 cost time: 0.8815584182739258
Epoch: 3, Steps: 7 | Train Loss: 2.244 Vali Loss: 2.113 Vali Acc: 0.361 Test Loss: 2.113 Test Acc: 0.361
Validation loss decreased (-0.180533 --> -0.361090).  Saving model ...
Epoch: 4 cost time: 0.8398311138153076
Epoch: 4, Steps: 7 | Train Loss: 2.080 Vali Loss: 1.922 Vali Acc: 0.458 Test Loss: 1.922 Test Acc: 0.458
Validation loss decreased (-0.361090 --> -0.458314).  Saving model ...
Epoch: 5 cost time: 0.888559103012085
Epoch: 5, Steps: 7 | Train Loss: 1.850 Vali Loss: 1.704 Vali Acc: 0.597 Test Loss: 1.704 Test Acc: 0.597
Validation loss decreased (-0.458314 --> -0.597205).  Saving model ...
Epoch: 6 cost time: 0.8401951789855957
Epoch: 6, Steps: 7 | Train Loss: 1.649 Vali Loss: 1.479 Vali Acc: 0.736 Test Loss: 1.479 Test Acc: 0.736
Validation loss decreased (-0.597205 --> -0.736096).  Saving model ...
Epoch: 7 cost time: 0.9612908363342285
Epoch: 7, Steps: 7 | Train Loss: 1.426 Vali Loss: 1.244 Vali Acc: 0.833 Test Loss: 1.244 Test Acc: 0.833
Validation loss decreased (-0.736096 --> -0.833321).  Saving model ...
Epoch: 8 cost time: 0.8635520935058594
Epoch: 8, Steps: 7 | Train Loss: 1.084 Vali Loss: 1.026 Vali Acc: 0.917 Test Loss: 1.026 Test Acc: 0.917
Validation loss decreased (-0.833321 --> -0.916656).  Saving model ...
Epoch: 9 cost time: 0.9843192100524902
Epoch: 9, Steps: 7 | Train Loss: 0.846 Vali Loss: 0.840 Vali Acc: 0.917 Test Loss: 0.840 Test Acc: 0.917
Validation loss decreased (-0.916656 --> -0.916658).  Saving model ...
Epoch: 10 cost time: 0.8755085468292236
Epoch: 10, Steps: 7 | Train Loss: 0.694 Vali Loss: 0.688 Vali Acc: 0.931 Test Loss: 0.688 Test Acc: 0.931
Validation loss decreased (-0.916658 --> -0.930549).  Saving model ...
Epoch: 11 cost time: 0.8048911094665527
Epoch: 11, Steps: 7 | Train Loss: 0.516 Vali Loss: 0.569 Vali Acc: 0.944 Test Loss: 0.569 Test Acc: 0.944
Validation loss decreased (-0.930549 --> -0.944439).  Saving model ...
Epoch: 12 cost time: 0.8181824684143066
Epoch: 12, Steps: 7 | Train Loss: 0.390 Vali Loss: 0.479 Vali Acc: 0.958 Test Loss: 0.479 Test Acc: 0.958
Validation loss decreased (-0.944439 --> -0.958329).  Saving model ...
Epoch: 13 cost time: 0.8765597343444824
Epoch: 13, Steps: 7 | Train Loss: 0.283 Vali Loss: 0.416 Vali Acc: 0.972 Test Loss: 0.416 Test Acc: 0.972
Validation loss decreased (-0.958329 --> -0.972218).  Saving model ...
Epoch: 14 cost time: 0.8564596176147461
Epoch: 14, Steps: 7 | Train Loss: 0.223 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8950977325439453
Epoch: 15, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.344 Vali Acc: 0.931 Test Loss: 0.344 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0444037914276123
Epoch: 16, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.318 Vali Acc: 0.931 Test Loss: 0.318 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9304172992706299
Epoch: 17, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9605934619903564
Epoch: 18, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9259774684906006
Epoch: 19, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9017703533172607
Epoch: 20, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9167881011962891
Epoch: 21, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8723340034484863
Epoch: 22, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0290017127990723
Epoch: 23, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df64_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 33692
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.536591053009033
Epoch: 1, Steps: 7 | Train Loss: 2.710 Vali Loss: 2.607 Vali Acc: 0.083 Test Loss: 2.607 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 0.9307725429534912
Epoch: 2, Steps: 7 | Train Loss: 2.581 Vali Loss: 2.535 Vali Acc: 0.083 Test Loss: 2.535 Test Acc: 0.083
Validation loss decreased (-0.083307 --> -0.083308).  Saving model ...
Epoch: 3 cost time: 0.8178668022155762
Epoch: 3, Steps: 7 | Train Loss: 2.488 Vali Loss: 2.418 Vali Acc: 0.153 Test Loss: 2.418 Test Acc: 0.153
Validation loss decreased (-0.083308 --> -0.152754).  Saving model ...
Epoch: 4 cost time: 0.948002815246582
Epoch: 4, Steps: 7 | Train Loss: 2.350 Vali Loss: 2.267 Vali Acc: 0.319 Test Loss: 2.267 Test Acc: 0.319
Validation loss decreased (-0.152754 --> -0.319422).  Saving model ...
Epoch: 5 cost time: 0.8014259338378906
Epoch: 5, Steps: 7 | Train Loss: 2.161 Vali Loss: 2.095 Vali Acc: 0.417 Test Loss: 2.095 Test Acc: 0.417
Validation loss decreased (-0.319422 --> -0.416646).  Saving model ...
Epoch: 6 cost time: 0.8396503925323486
Epoch: 6, Steps: 7 | Train Loss: 1.912 Vali Loss: 1.912 Vali Acc: 0.486 Test Loss: 1.912 Test Acc: 0.486
Validation loss decreased (-0.416646 --> -0.486092).  Saving model ...
Epoch: 7 cost time: 0.7764947414398193
Epoch: 7, Steps: 7 | Train Loss: 1.730 Vali Loss: 1.722 Vali Acc: 0.625 Test Loss: 1.722 Test Acc: 0.625
Validation loss decreased (-0.486092 --> -0.624983).  Saving model ...
Epoch: 8 cost time: 0.8059282302856445
Epoch: 8, Steps: 7 | Train Loss: 1.490 Vali Loss: 1.521 Vali Acc: 0.681 Test Loss: 1.521 Test Acc: 0.681
Validation loss decreased (-0.624983 --> -0.680540).  Saving model ...
Epoch: 9 cost time: 0.9668707847595215
Epoch: 9, Steps: 7 | Train Loss: 1.284 Vali Loss: 1.331 Vali Acc: 0.681 Test Loss: 1.331 Test Acc: 0.681
Validation loss decreased (-0.680540 --> -0.680542).  Saving model ...
Epoch: 10 cost time: 0.8302342891693115
Epoch: 10, Steps: 7 | Train Loss: 1.004 Vali Loss: 1.153 Vali Acc: 0.736 Test Loss: 1.153 Test Acc: 0.736
Validation loss decreased (-0.680542 --> -0.736100).  Saving model ...
Epoch: 11 cost time: 0.8754987716674805
Epoch: 11, Steps: 7 | Train Loss: 0.893 Vali Loss: 0.990 Vali Acc: 0.861 Test Loss: 0.990 Test Acc: 0.861
Validation loss decreased (-0.736100 --> -0.861101).  Saving model ...
Epoch: 12 cost time: 0.8248536586761475
Epoch: 12, Steps: 7 | Train Loss: 0.720 Vali Loss: 0.846 Vali Acc: 0.875 Test Loss: 0.846 Test Acc: 0.875
Validation loss decreased (-0.861101 --> -0.874992).  Saving model ...
Epoch: 13 cost time: 0.8658063411712646
Epoch: 13, Steps: 7 | Train Loss: 0.519 Vali Loss: 0.727 Vali Acc: 0.875 Test Loss: 0.727 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 14 cost time: 0.8246982097625732
Epoch: 14, Steps: 7 | Train Loss: 0.464 Vali Loss: 0.635 Vali Acc: 0.875 Test Loss: 0.635 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 15 cost time: 0.7973675727844238
Epoch: 15, Steps: 7 | Train Loss: 0.344 Vali Loss: 0.560 Vali Acc: 0.875 Test Loss: 0.560 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 16 cost time: 0.8266804218292236
Epoch: 16, Steps: 7 | Train Loss: 0.286 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888884).  Saving model ...
Epoch: 17 cost time: 0.8067100048065186
Epoch: 17, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.470 Vali Acc: 0.903 Test Loss: 0.470 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902773).  Saving model ...
Epoch: 18 cost time: 0.8042311668395996
Epoch: 18, Steps: 7 | Train Loss: 0.186 Vali Loss: 0.445 Vali Acc: 0.889 Test Loss: 0.445 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7842037677764893
Epoch: 19, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.429 Vali Acc: 0.889 Test Loss: 0.429 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9113094806671143
Epoch: 20, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.408 Vali Acc: 0.889 Test Loss: 0.408 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9952914714813232
Epoch: 21, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.387 Vali Acc: 0.889 Test Loss: 0.387 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9013662338256836
Epoch: 22, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8714854717254639
Epoch: 23, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9763202667236328
Epoch: 24, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 25 cost time: 0.950263261795044
Epoch: 25, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 26 cost time: 0.8540241718292236
Epoch: 26, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 27 cost time: 0.7979497909545898
Epoch: 27, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0149028301239014
Epoch: 28, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9016785621643066
Epoch: 29, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.900566577911377
Epoch: 30, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8309767246246338
Epoch: 31, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8669111728668213
Epoch: 32, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.8261404037475586
Epoch: 33, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.0586450099945068
Epoch: 34, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8486521244049072
Epoch: 35, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8267192840576172
Epoch: 36, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8168673515319824
Epoch: 37, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9157731533050537
Epoch: 38, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8319151401519775
Epoch: 39, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9366817474365234
Epoch: 40, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.8447000980377197
Epoch: 41, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.898597002029419
Epoch: 42, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9802796840667725
Epoch: 43, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 27740
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df64_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5447442531585693
Epoch: 1, Steps: 7 | Train Loss: 2.737 Vali Loss: 2.573 Vali Acc: 0.097 Test Loss: 2.573 Test Acc: 0.097
Validation loss decreased (inf --> -0.097196).  Saving model ...
Epoch: 2 cost time: 0.7875630855560303
Epoch: 2, Steps: 7 | Train Loss: 2.663 Vali Loss: 2.522 Vali Acc: 0.083 Test Loss: 2.522 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7970883846282959
Epoch: 3, Steps: 7 | Train Loss: 2.561 Vali Loss: 2.428 Vali Acc: 0.097 Test Loss: 2.428 Test Acc: 0.097
Validation loss decreased (-0.097196 --> -0.097198).  Saving model ...
Epoch: 4 cost time: 0.8061497211456299
Epoch: 4, Steps: 7 | Train Loss: 2.512 Vali Loss: 2.311 Vali Acc: 0.181 Test Loss: 2.311 Test Acc: 0.181
Validation loss decreased (-0.097198 --> -0.180532).  Saving model ...
Epoch: 5 cost time: 0.8689413070678711
Epoch: 5, Steps: 7 | Train Loss: 2.246 Vali Loss: 2.171 Vali Acc: 0.292 Test Loss: 2.171 Test Acc: 0.292
Validation loss decreased (-0.180532 --> -0.291645).  Saving model ...
Epoch: 6 cost time: 0.821476936340332
Epoch: 6, Steps: 7 | Train Loss: 2.134 Vali Loss: 2.025 Vali Acc: 0.375 Test Loss: 2.025 Test Acc: 0.375
Validation loss decreased (-0.291645 --> -0.374980).  Saving model ...
Epoch: 7 cost time: 0.9587569236755371
Epoch: 7, Steps: 7 | Train Loss: 2.016 Vali Loss: 1.873 Vali Acc: 0.458 Test Loss: 1.873 Test Acc: 0.458
Validation loss decreased (-0.374980 --> -0.458315).  Saving model ...
Epoch: 8 cost time: 0.7502837181091309
Epoch: 8, Steps: 7 | Train Loss: 1.806 Vali Loss: 1.721 Vali Acc: 0.514 Test Loss: 1.721 Test Acc: 0.514
Validation loss decreased (-0.458315 --> -0.513872).  Saving model ...
Epoch: 9 cost time: 0.7568824291229248
Epoch: 9, Steps: 7 | Train Loss: 1.667 Vali Loss: 1.559 Vali Acc: 0.611 Test Loss: 1.559 Test Acc: 0.611
Validation loss decreased (-0.513872 --> -0.611096).  Saving model ...
Epoch: 10 cost time: 0.8813157081604004
Epoch: 10, Steps: 7 | Train Loss: 1.488 Vali Loss: 1.411 Vali Acc: 0.667 Test Loss: 1.411 Test Acc: 0.667
Validation loss decreased (-0.611096 --> -0.666653).  Saving model ...
Epoch: 11 cost time: 0.7463071346282959
Epoch: 11, Steps: 7 | Train Loss: 1.249 Vali Loss: 1.259 Vali Acc: 0.764 Test Loss: 1.259 Test Acc: 0.764
Validation loss decreased (-0.666653 --> -0.763876).  Saving model ...
Epoch: 12 cost time: 0.8563017845153809
Epoch: 12, Steps: 7 | Train Loss: 1.105 Vali Loss: 1.117 Vali Acc: 0.792 Test Loss: 1.117 Test Acc: 0.792
Validation loss decreased (-0.763876 --> -0.791655).  Saving model ...
Epoch: 13 cost time: 0.8094816207885742
Epoch: 13, Steps: 7 | Train Loss: 0.930 Vali Loss: 0.990 Vali Acc: 0.819 Test Loss: 0.990 Test Acc: 0.819
Validation loss decreased (-0.791655 --> -0.819435).  Saving model ...
Epoch: 14 cost time: 0.8125011920928955
Epoch: 14, Steps: 7 | Train Loss: 0.805 Vali Loss: 0.876 Vali Acc: 0.833 Test Loss: 0.876 Test Acc: 0.833
Validation loss decreased (-0.819435 --> -0.833325).  Saving model ...
Epoch: 15 cost time: 0.7366476058959961
Epoch: 15, Steps: 7 | Train Loss: 0.679 Vali Loss: 0.776 Vali Acc: 0.847 Test Loss: 0.776 Test Acc: 0.847
Validation loss decreased (-0.833325 --> -0.847214).  Saving model ...
Epoch: 16 cost time: 0.8367190361022949
Epoch: 16, Steps: 7 | Train Loss: 0.549 Vali Loss: 0.694 Vali Acc: 0.875 Test Loss: 0.694 Test Acc: 0.875
Validation loss decreased (-0.847214 --> -0.874993).  Saving model ...
Epoch: 17 cost time: 0.8152480125427246
Epoch: 17, Steps: 7 | Train Loss: 0.461 Vali Loss: 0.617 Vali Acc: 0.889 Test Loss: 0.617 Test Acc: 0.889
Validation loss decreased (-0.874993 --> -0.888883).  Saving model ...
Epoch: 18 cost time: 0.8452982902526855
Epoch: 18, Steps: 7 | Train Loss: 0.385 Vali Loss: 0.568 Vali Acc: 0.889 Test Loss: 0.568 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 19 cost time: 0.9170057773590088
Epoch: 19, Steps: 7 | Train Loss: 0.305 Vali Loss: 0.539 Vali Acc: 0.889 Test Loss: 0.539 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 20 cost time: 0.7505578994750977
Epoch: 20, Steps: 7 | Train Loss: 0.271 Vali Loss: 0.516 Vali Acc: 0.889 Test Loss: 0.516 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 21 cost time: 0.784205436706543
Epoch: 21, Steps: 7 | Train Loss: 0.229 Vali Loss: 0.489 Vali Acc: 0.889 Test Loss: 0.489 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 22 cost time: 0.9246461391448975
Epoch: 22, Steps: 7 | Train Loss: 0.216 Vali Loss: 0.465 Vali Acc: 0.889 Test Loss: 0.465 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 23 cost time: 0.8402280807495117
Epoch: 23, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.446 Vali Acc: 0.903 Test Loss: 0.446 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902773).  Saving model ...
Epoch: 24 cost time: 0.9404566287994385
Epoch: 24, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.433 Vali Acc: 0.889 Test Loss: 0.433 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9188230037689209
Epoch: 25, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.419 Vali Acc: 0.903 Test Loss: 0.419 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 26 cost time: 0.9179444313049316
Epoch: 26, Steps: 7 | Train Loss: 0.126 Vali Loss: 0.407 Vali Acc: 0.903 Test Loss: 0.407 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 27 cost time: 0.967879056930542
Epoch: 27, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.393 Vali Acc: 0.903 Test Loss: 0.393 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 28 cost time: 0.8291213512420654
Epoch: 28, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 29 cost time: 0.8934202194213867
Epoch: 29, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.373 Vali Acc: 0.903 Test Loss: 0.373 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 30 cost time: 0.8275699615478516
Epoch: 30, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 31 cost time: 0.7797529697418213
Epoch: 31, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 32 cost time: 0.7809033393859863
Epoch: 32, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7894718647003174
Epoch: 33, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7743632793426514
Epoch: 34, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8222558498382568
Epoch: 35, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8013138771057129
Epoch: 36, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.7429766654968262
Epoch: 37, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 38 cost time: 0.7498960494995117
Epoch: 38, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.309 Vali Acc: 0.931 Test Loss: 0.309 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 39 cost time: 0.8304224014282227
Epoch: 39, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.302 Vali Acc: 0.931 Test Loss: 0.302 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.8677527904510498
Epoch: 40, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.8053274154663086
Epoch: 41, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8562345504760742
Epoch: 42, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7647140026092529
Epoch: 43, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.903376579284668
Epoch: 44, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8701255321502686
Epoch: 45, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.8280336856842041
Epoch: 46, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.8392758369445801
Epoch: 47, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.9030389785766602
Epoch: 48, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.8972411155700684
Epoch: 49, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8728530406951904
Epoch: 50, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9182074069976807
Epoch: 51, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8950240612030029
Epoch: 52, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.9056839942932129
Epoch: 53, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.8772399425506592
Epoch: 54, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 0.8014187812805176
Epoch: 55, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 0.843209981918335
Epoch: 56, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 0.8678739070892334
Epoch: 57, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9114763736724854
Epoch: 58, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9500446319580078
Epoch: 59, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 0.8998477458953857
Epoch: 60, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 0.8273642063140869
Epoch: 61, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9265909194946289
Epoch: 62, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.8242604732513428
Epoch: 63, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.862701416015625
Epoch: 64, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.8992037773132324
Epoch: 65, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.024059534072876
Epoch: 66, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.8275249004364014
Epoch: 67, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.807551383972168
Epoch: 68, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.7888617515563965
Epoch: 69, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.7307794094085693
Epoch: 70, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df64_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 24092
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6228129863739014
Epoch: 1, Steps: 7 | Train Loss: 2.595 Vali Loss: 2.388 Vali Acc: 0.111 Test Loss: 2.388 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 0.7607107162475586
Epoch: 2, Steps: 7 | Train Loss: 2.466 Vali Loss: 2.323 Vali Acc: 0.125 Test Loss: 2.323 Test Acc: 0.125
Validation loss decreased (-0.111087 --> -0.124977).  Saving model ...
Epoch: 3 cost time: 0.8851504325866699
Epoch: 3, Steps: 7 | Train Loss: 2.407 Vali Loss: 2.233 Vali Acc: 0.250 Test Loss: 2.233 Test Acc: 0.250
Validation loss decreased (-0.124977 --> -0.249978).  Saving model ...
Epoch: 4 cost time: 0.8710634708404541
Epoch: 4, Steps: 7 | Train Loss: 2.333 Vali Loss: 2.123 Vali Acc: 0.333 Test Loss: 2.123 Test Acc: 0.333
Validation loss decreased (-0.249978 --> -0.333312).  Saving model ...
Epoch: 5 cost time: 0.8875501155853271
Epoch: 5, Steps: 7 | Train Loss: 2.141 Vali Loss: 2.005 Vali Acc: 0.444 Test Loss: 2.005 Test Acc: 0.444
Validation loss decreased (-0.333312 --> -0.444424).  Saving model ...
Epoch: 6 cost time: 1.0041706562042236
Epoch: 6, Steps: 7 | Train Loss: 2.047 Vali Loss: 1.876 Vali Acc: 0.528 Test Loss: 1.876 Test Acc: 0.528
Validation loss decreased (-0.444424 --> -0.527759).  Saving model ...
Epoch: 7 cost time: 0.8901371955871582
Epoch: 7, Steps: 7 | Train Loss: 1.907 Vali Loss: 1.746 Vali Acc: 0.597 Test Loss: 1.746 Test Acc: 0.597
Validation loss decreased (-0.527759 --> -0.597205).  Saving model ...
Epoch: 8 cost time: 0.9285955429077148
Epoch: 8, Steps: 7 | Train Loss: 1.746 Vali Loss: 1.620 Vali Acc: 0.736 Test Loss: 1.620 Test Acc: 0.736
Validation loss decreased (-0.597205 --> -0.736095).  Saving model ...
Epoch: 9 cost time: 0.8504581451416016
Epoch: 9, Steps: 7 | Train Loss: 1.605 Vali Loss: 1.492 Vali Acc: 0.736 Test Loss: 1.492 Test Acc: 0.736
Validation loss decreased (-0.736095 --> -0.736096).  Saving model ...
Epoch: 10 cost time: 0.824059009552002
Epoch: 10, Steps: 7 | Train Loss: 1.431 Vali Loss: 1.360 Vali Acc: 0.750 Test Loss: 1.360 Test Acc: 0.750
Validation loss decreased (-0.736096 --> -0.749986).  Saving model ...
Epoch: 11 cost time: 0.904015302658081
Epoch: 11, Steps: 7 | Train Loss: 1.309 Vali Loss: 1.227 Vali Acc: 0.764 Test Loss: 1.227 Test Acc: 0.764
Validation loss decreased (-0.749986 --> -0.763877).  Saving model ...
Epoch: 12 cost time: 0.855919361114502
Epoch: 12, Steps: 7 | Train Loss: 1.165 Vali Loss: 1.101 Vali Acc: 0.806 Test Loss: 1.101 Test Acc: 0.806
Validation loss decreased (-0.763877 --> -0.805545).  Saving model ...
Epoch: 13 cost time: 0.8446788787841797
Epoch: 13, Steps: 7 | Train Loss: 1.020 Vali Loss: 0.982 Vali Acc: 0.861 Test Loss: 0.982 Test Acc: 0.861
Validation loss decreased (-0.805545 --> -0.861101).  Saving model ...
Epoch: 14 cost time: 0.8134951591491699
Epoch: 14, Steps: 7 | Train Loss: 0.857 Vali Loss: 0.875 Vali Acc: 0.889 Test Loss: 0.875 Test Acc: 0.889
Validation loss decreased (-0.861101 --> -0.888880).  Saving model ...
Epoch: 15 cost time: 0.8689889907836914
Epoch: 15, Steps: 7 | Train Loss: 0.741 Vali Loss: 0.779 Vali Acc: 0.903 Test Loss: 0.779 Test Acc: 0.903
Validation loss decreased (-0.888880 --> -0.902770).  Saving model ...
Epoch: 16 cost time: 0.8006772994995117
Epoch: 16, Steps: 7 | Train Loss: 0.631 Vali Loss: 0.700 Vali Acc: 0.903 Test Loss: 0.700 Test Acc: 0.903
Validation loss decreased (-0.902770 --> -0.902771).  Saving model ...
Epoch: 17 cost time: 1.1187412738800049
Epoch: 17, Steps: 7 | Train Loss: 0.529 Vali Loss: 0.631 Vali Acc: 0.903 Test Loss: 0.631 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902771).  Saving model ...
Epoch: 18 cost time: 0.8714373111724854
Epoch: 18, Steps: 7 | Train Loss: 0.445 Vali Loss: 0.580 Vali Acc: 0.903 Test Loss: 0.580 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902772).  Saving model ...
Epoch: 19 cost time: 0.9095263481140137
Epoch: 19, Steps: 7 | Train Loss: 0.392 Vali Loss: 0.539 Vali Acc: 0.917 Test Loss: 0.539 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916661).  Saving model ...
Epoch: 20 cost time: 0.9652130603790283
Epoch: 20, Steps: 7 | Train Loss: 0.330 Vali Loss: 0.510 Vali Acc: 0.917 Test Loss: 0.510 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 21 cost time: 0.9134056568145752
Epoch: 21, Steps: 7 | Train Loss: 0.264 Vali Loss: 0.484 Vali Acc: 0.917 Test Loss: 0.484 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 22 cost time: 1.1748268604278564
Epoch: 22, Steps: 7 | Train Loss: 0.268 Vali Loss: 0.459 Vali Acc: 0.917 Test Loss: 0.459 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 23 cost time: 0.8883974552154541
Epoch: 23, Steps: 7 | Train Loss: 0.226 Vali Loss: 0.440 Vali Acc: 0.917 Test Loss: 0.440 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 24 cost time: 0.8984389305114746
Epoch: 24, Steps: 7 | Train Loss: 0.199 Vali Loss: 0.419 Vali Acc: 0.931 Test Loss: 0.419 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 25 cost time: 0.8970251083374023
Epoch: 25, Steps: 7 | Train Loss: 0.189 Vali Loss: 0.407 Vali Acc: 0.931 Test Loss: 0.407 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 26 cost time: 0.8381726741790771
Epoch: 26, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.402 Vali Acc: 0.917 Test Loss: 0.402 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8409802913665771
Epoch: 27, Steps: 7 | Train Loss: 0.157 Vali Loss: 0.387 Vali Acc: 0.917 Test Loss: 0.387 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8205709457397461
Epoch: 28, Steps: 7 | Train Loss: 0.157 Vali Loss: 0.377 Vali Acc: 0.917 Test Loss: 0.377 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7891278266906738
Epoch: 29, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.366 Vali Acc: 0.917 Test Loss: 0.366 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7384099960327148
Epoch: 30, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.359 Vali Acc: 0.917 Test Loss: 0.359 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7985575199127197
Epoch: 31, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.354 Vali Acc: 0.917 Test Loss: 0.354 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7889940738677979
Epoch: 32, Steps: 7 | Train Loss: 0.096 Vali Loss: 0.352 Vali Acc: 0.917 Test Loss: 0.352 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8715784549713135
Epoch: 33, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.347 Vali Acc: 0.917 Test Loss: 0.347 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9152593612670898
Epoch: 34, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.338 Vali Acc: 0.931 Test Loss: 0.338 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 35 cost time: 0.8619661331176758
Epoch: 35, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8187811374664307
Epoch: 36, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.935744047164917
Epoch: 37, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8932449817657471
Epoch: 38, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.330 Vali Acc: 0.931 Test Loss: 0.330 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 39 cost time: 0.9210488796234131
Epoch: 39, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9571206569671631
Epoch: 40, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.319 Vali Acc: 0.931 Test Loss: 0.319 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 41 cost time: 0.870363712310791
Epoch: 41, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.317 Vali Acc: 0.931 Test Loss: 0.317 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 42 cost time: 1.0356009006500244
Epoch: 42, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9394559860229492
Epoch: 43, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.314 Vali Acc: 0.931 Test Loss: 0.314 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 44 cost time: 1.042179822921753
Epoch: 44, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.9020497798919678
Epoch: 45, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.310 Vali Acc: 0.931 Test Loss: 0.310 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8459532260894775
Epoch: 46, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9287111759185791
Epoch: 47, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.303 Vali Acc: 0.931 Test Loss: 0.303 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.910754919052124
Epoch: 48, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.9586255550384521
Epoch: 49, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.9328203201293945
Epoch: 50, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.289 Vali Acc: 0.931 Test Loss: 0.289 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 0.9558150768280029
Epoch: 51, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 0.8382787704467773
Epoch: 52, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 0.879622220993042
Epoch: 53, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.9581413269042969
Epoch: 54, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.042738437652588
Epoch: 55, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 0.9514026641845703
Epoch: 56, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 0.9384174346923828
Epoch: 57, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 1.0048260688781738
Epoch: 58, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8877227306365967
Epoch: 59, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.8768279552459717
Epoch: 60, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.9786515235900879
Epoch: 61, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.9416763782501221
Epoch: 62, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 63 cost time: 0.8707847595214844
Epoch: 63, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 64 cost time: 0.8826141357421875
Epoch: 64, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 65 cost time: 0.9426593780517578
Epoch: 65, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 66 cost time: 0.9088432788848877
Epoch: 66, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8759231567382812
Epoch: 67, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.8256428241729736
Epoch: 68, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.9789972305297852
Epoch: 69, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.9413337707519531
Epoch: 70, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.804473876953125
Epoch: 71, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 72 cost time: 0.8607263565063477
Epoch: 72, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 73 cost time: 0.9766919612884521
Epoch: 73, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.963346004486084
Epoch: 74, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.0185573101043701
Epoch: 75, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.978644609451294
Epoch: 76, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.9267735481262207
Epoch: 77, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.265005111694336
Epoch: 78, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.0432848930358887
Epoch: 79, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 1.0519003868103027
Epoch: 80, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.9695405960083008
Epoch: 81, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 82 cost time: 0.8827145099639893
Epoch: 82, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 83 cost time: 0.9435195922851562
Epoch: 83, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.9580109119415283
Epoch: 84, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.9744229316711426
Epoch: 85, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.9016966819763184
Epoch: 86, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 1.0006482601165771
Epoch: 87, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 88 cost time: 1.008286952972412
Epoch: 88, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 89 cost time: 0.9644997119903564
Epoch: 89, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 90 cost time: 0.9355013370513916
Epoch: 90, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.9472348690032959
Epoch: 91, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.9417262077331543
Epoch: 92, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.9199075698852539
Epoch: 93, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.8895204067230225
Epoch: 94, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.9086654186248779
Epoch: 95, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 1.0985805988311768
Epoch: 96, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 97 cost time: 0.8081111907958984
Epoch: 97, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 98 cost time: 0.849184513092041
Epoch: 98, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 99 cost time: 0.9990918636322021
Epoch: 99, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 0.9601576328277588
Epoch: 100, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el3_dm16_nh4_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 22748
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.118727445602417
Epoch: 1, Steps: 7 | Train Loss: 2.601 Vali Loss: 2.058 Vali Acc: 0.278 Test Loss: 2.058 Test Acc: 0.278
Validation loss decreased (inf --> -0.277757).  Saving model ...
Epoch: 2 cost time: 1.3886945247650146
Epoch: 2, Steps: 7 | Train Loss: 1.411 Vali Loss: 0.865 Vali Acc: 0.792 Test Loss: 0.865 Test Acc: 0.792
Validation loss decreased (-0.277757 --> -0.791658).  Saving model ...
Epoch: 3 cost time: 1.3661978244781494
Epoch: 3, Steps: 7 | Train Loss: 0.338 Vali Loss: 0.442 Vali Acc: 0.847 Test Loss: 0.442 Test Acc: 0.847
Validation loss decreased (-0.791658 --> -0.847218).  Saving model ...
Epoch: 4 cost time: 1.5218842029571533
Epoch: 4, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.384 Vali Acc: 0.903 Test Loss: 0.384 Test Acc: 0.903
Validation loss decreased (-0.847218 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 1.556659460067749
Epoch: 5, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 1.3743300437927246
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5660808086395264
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 1.4960238933563232
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 1.5483417510986328
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.531325340270996
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3971335887908936
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4230313301086426
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.517533540725708
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 1.4607982635498047
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.4047791957855225
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 1.4815938472747803
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 1.5051400661468506
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 1.2302846908569336
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 1.3538100719451904
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 1.3232996463775635
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 1.509082317352295
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.450974941253662
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.4766952991485596
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.475707769393921
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 1.2075328826904297
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 1.5832197666168213
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 1.5843210220336914
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 1.454176425933838
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 1.4442143440246582
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 1.4485116004943848
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 31 cost time: 1.3131835460662842
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3561906814575195
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 33 cost time: 1.3928537368774414
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4651579856872559
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.406501293182373
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.341975212097168
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4083170890808105
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2571444511413574
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.4572224617004395
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.4762258529663086
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.581298589706421
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.4839816093444824
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 1.4567985534667969
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3857176303863525
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.234194278717041
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 1.4327235221862793
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.5053658485412598
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.5655829906463623
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.4337420463562012
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.3823468685150146
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.3704497814178467
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.348445177078247
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.1995534896850586
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.4790804386138916
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.5891759395599365
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 997132
model size : 6.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3366990089416504
Epoch: 1, Steps: 7 | Train Loss: 2.467 Vali Loss: 2.184 Vali Acc: 0.431 Test Loss: 2.184 Test Acc: 0.431
Validation loss decreased (inf --> -0.430534).  Saving model ...
Epoch: 2 cost time: 1.299617052078247
Epoch: 2, Steps: 7 | Train Loss: 1.648 Vali Loss: 1.157 Vali Acc: 0.750 Test Loss: 1.157 Test Acc: 0.750
Validation loss decreased (-0.430534 --> -0.749988).  Saving model ...
Epoch: 3 cost time: 1.4415504932403564
Epoch: 3, Steps: 7 | Train Loss: 0.613 Vali Loss: 0.586 Vali Acc: 0.903 Test Loss: 0.586 Test Acc: 0.903
Validation loss decreased (-0.749988 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 1.3641586303710938
Epoch: 4, Steps: 7 | Train Loss: 0.176 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 1.3259193897247314
Epoch: 5, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5604875087738037
Epoch: 6, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 1.3878357410430908
Epoch: 7, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3380439281463623
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2072257995605469
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1979649066925049
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.217165231704712
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2998204231262207
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4222028255462646
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3738398551940918
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3267691135406494
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2090606689453125
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 632332
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0172877311706543
Epoch: 1, Steps: 7 | Train Loss: 2.670 Vali Loss: 2.346 Vali Acc: 0.167 Test Loss: 2.346 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 1.051027536392212
Epoch: 2, Steps: 7 | Train Loss: 1.982 Vali Loss: 1.528 Vali Acc: 0.722 Test Loss: 1.528 Test Acc: 0.722
Validation loss decreased (-0.166643 --> -0.722207).  Saving model ...
Epoch: 3 cost time: 0.9529707431793213
Epoch: 3, Steps: 7 | Train Loss: 1.021 Vali Loss: 0.855 Vali Acc: 0.847 Test Loss: 0.855 Test Acc: 0.847
Validation loss decreased (-0.722207 --> -0.847214).  Saving model ...
Epoch: 4 cost time: 1.1944551467895508
Epoch: 4, Steps: 7 | Train Loss: 0.383 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
Validation loss decreased (-0.847214 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 1.0587053298950195
Epoch: 5, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 1.1638374328613281
Epoch: 6, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 1.0025691986083984
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2504241466522217
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2441329956054688
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.310497760772705
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.1993978023529053
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2500269412994385
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.2718346118927002
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3707776069641113
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.2077271938323975
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.1683897972106934
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.2577838897705078
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.286229133605957
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.2011001110076904
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 1.009631633758545
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.9957456588745117
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 1.1058831214904785
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2134954929351807
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2403109073638916
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1527099609375
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1712355613708496
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 1.297593355178833
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 1.2820162773132324
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 1.1143224239349365
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 1.2531287670135498
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1867649555206299
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 1.211620569229126
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 1.2800233364105225
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 1.1390881538391113
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 1.1926279067993164
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 1.2872717380523682
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 1.2422120571136475
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3713438510894775
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 1.313690423965454
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 1.2777984142303467
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 1.3135583400726318
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2980856895446777
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 1.3583033084869385
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 1.237199068069458
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 1.3772590160369873
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2924399375915527
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 1.3002221584320068
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.167726755142212
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0716259479522705
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.21458101272583
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.3323519229888916
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.1028435230255127
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.967278003692627
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 54 cost time: 0.9830365180969238
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 55 cost time: 1.1244547367095947
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 56 cost time: 1.1934516429901123
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1237461566925049
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.0968208312988281
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.0845978260040283
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.251063346862793
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.2038652896881104
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 62 cost time: 1.098496675491333
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 63 cost time: 1.191098690032959
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 64 cost time: 1.1570193767547607
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 65 cost time: 1.1288187503814697
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 66 cost time: 1.0238037109375
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 67 cost time: 1.2044074535369873
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 68 cost time: 1.366947889328003
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 69 cost time: 1.16575026512146
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.2144310474395752
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.3031487464904785
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.1797537803649902
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.2377676963806152
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.2995123863220215
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 75 cost time: 1.271557092666626
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 76 cost time: 1.2469072341918945
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 77 cost time: 1.3404057025909424
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 78 cost time: 1.2392024993896484
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 79 cost time: 1.257023572921753
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.2175257205963135
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.223978042602539
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.0692996978759766
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 1.0078997611999512
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 1.1554348468780518
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 1.1812009811401367
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 1.3393590450286865
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 1.3150880336761475
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 1.2838973999023438
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 516364
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df256_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.105074882507324
Epoch: 1, Steps: 7 | Train Loss: 2.602 Vali Loss: 2.304 Vali Acc: 0.181 Test Loss: 2.304 Test Acc: 0.181
Validation loss decreased (inf --> -0.180533).  Saving model ...
Epoch: 2 cost time: 1.1211647987365723
Epoch: 2, Steps: 7 | Train Loss: 2.013 Vali Loss: 1.652 Vali Acc: 0.653 Test Loss: 1.652 Test Acc: 0.653
Validation loss decreased (-0.180533 --> -0.652761).  Saving model ...
Epoch: 3 cost time: 1.1560759544372559
Epoch: 3, Steps: 7 | Train Loss: 1.273 Vali Loss: 0.986 Vali Acc: 0.833 Test Loss: 0.986 Test Acc: 0.833
Validation loss decreased (-0.652761 --> -0.833323).  Saving model ...
Epoch: 4 cost time: 1.2130179405212402
Epoch: 4, Steps: 7 | Train Loss: 0.585 Vali Loss: 0.634 Vali Acc: 0.903 Test Loss: 0.634 Test Acc: 0.903
Validation loss decreased (-0.833323 --> -0.902771).  Saving model ...
Epoch: 5 cost time: 1.031085729598999
Epoch: 5, Steps: 7 | Train Loss: 0.223 Vali Loss: 0.370 Vali Acc: 0.931 Test Loss: 0.370 Test Acc: 0.931
Validation loss decreased (-0.902771 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 1.2012314796447754
Epoch: 6, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.345 Vali Acc: 0.944 Test Loss: 0.345 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 7 cost time: 1.1221973896026611
Epoch: 7, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1586730480194092
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2642030715942383
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1791067123413086
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3858017921447754
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1503288745880127
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2013001441955566
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1885418891906738
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2570385932922363
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.0036568641662598
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.1071901321411133
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.2702066898345947
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.2752494812011719
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0877141952514648
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.175856590270996
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.9949593544006348
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.2330777645111084
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.9768927097320557
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.057863473892212
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.9952008724212646
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.9470088481903076
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0978946685791016
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.0669872760772705
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1936485767364502
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.148224115371704
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0998778343200684
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2680456638336182
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 1.1904661655426025
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1942858695983887
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 1.3226089477539062
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 1.2472681999206543
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 1.2867496013641357
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 1.288456916809082
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 1.034592866897583
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 1.2469730377197266
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 1.0899317264556885
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 1.318798542022705
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 1.115173101425171
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 1.2870354652404785
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 1.1995849609375
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 1.0258643627166748
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 1.2069604396820068
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 1.0972418785095215
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1435158252716064
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0626823902130127
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 1.184086561203003
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0846538543701172
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.086083173751831
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.1302978992462158
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.2148997783660889
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 57 cost time: 1.0540010929107666
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.076702356338501
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.1360034942626953
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.2872745990753174
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.111001968383789
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.2986702919006348
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 63 cost time: 1.0892715454101562
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 64 cost time: 1.0027580261230469
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.0114848613739014
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.9549217224121094
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.0717453956604004
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.0229709148406982
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.0050740242004395
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 70 cost time: 1.2282040119171143
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 71 cost time: 1.2177345752716064
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.1538794040679932
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 73 cost time: 1.3236501216888428
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 74 cost time: 1.1486213207244873
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 75 cost time: 1.0468146800994873
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 76 cost time: 1.2555463314056396
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.2994697093963623
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 78 cost time: 1.4038383960723877
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.2074975967407227
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.067185878753662
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 81 cost time: 1.08290433883667
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.1249442100524902
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.0130043029785156
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.0643351078033447
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.1285037994384766
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.0413286685943604
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 1.213719129562378
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 1.0787227153778076
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 1.082324504852295
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 1.1973507404327393
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df256_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 455692
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2306628227233887
Epoch: 1, Steps: 7 | Train Loss: 2.834 Vali Loss: 2.616 Vali Acc: 0.056 Test Loss: 2.616 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 1.099344253540039
Epoch: 2, Steps: 7 | Train Loss: 2.343 Vali Loss: 2.050 Vali Acc: 0.403 Test Loss: 2.050 Test Acc: 0.403
Validation loss decreased (-0.055529 --> -0.402757).  Saving model ...
Epoch: 3 cost time: 1.0467474460601807
Epoch: 3, Steps: 7 | Train Loss: 1.645 Vali Loss: 1.438 Vali Acc: 0.750 Test Loss: 1.438 Test Acc: 0.750
Validation loss decreased (-0.402757 --> -0.749986).  Saving model ...
Epoch: 4 cost time: 1.0798609256744385
Epoch: 4, Steps: 7 | Train Loss: 0.939 Vali Loss: 0.919 Vali Acc: 0.847 Test Loss: 0.919 Test Acc: 0.847
Validation loss decreased (-0.749986 --> -0.847213).  Saving model ...
Epoch: 5 cost time: 1.1276907920837402
Epoch: 5, Steps: 7 | Train Loss: 0.456 Vali Loss: 0.575 Vali Acc: 0.889 Test Loss: 0.575 Test Acc: 0.889
Validation loss decreased (-0.847213 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 1.0521705150604248
Epoch: 6, Steps: 7 | Train Loss: 0.209 Vali Loss: 0.432 Vali Acc: 0.889 Test Loss: 0.432 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 1.2430269718170166
Epoch: 7, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1567881107330322
Epoch: 8, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.240891456604004
Epoch: 9, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.1989469528198242
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.9355545043945312
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.215456247329712
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0461487770080566
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1680054664611816
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2817339897155762
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9928116798400879
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.114889144897461
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.9032013416290283
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.144127368927002
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.045177936553955
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9335169792175293
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0685803890228271
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.985945463180542
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9935383796691895
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.954493522644043
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9577741622924805
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1003007888793945
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.142887830734253
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 408076
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df256_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4705002307891846
Epoch: 1, Steps: 7 | Train Loss: 2.553 Vali Loss: 2.207 Vali Acc: 0.306 Test Loss: 2.207 Test Acc: 0.306
Validation loss decreased (inf --> -0.305533).  Saving model ...
Epoch: 2 cost time: 0.6754672527313232
Epoch: 2, Steps: 7 | Train Loss: 2.276 Vali Loss: 1.801 Vali Acc: 0.639 Test Loss: 1.801 Test Acc: 0.639
Validation loss decreased (-0.305533 --> -0.638871).  Saving model ...
Epoch: 3 cost time: 0.6449568271636963
Epoch: 3, Steps: 7 | Train Loss: 1.661 Vali Loss: 1.345 Vali Acc: 0.792 Test Loss: 1.345 Test Acc: 0.792
Validation loss decreased (-0.638871 --> -0.791653).  Saving model ...
Epoch: 4 cost time: 0.693925142288208
Epoch: 4, Steps: 7 | Train Loss: 1.118 Vali Loss: 0.930 Vali Acc: 0.889 Test Loss: 0.930 Test Acc: 0.889
Validation loss decreased (-0.791653 --> -0.888880).  Saving model ...
Epoch: 5 cost time: 0.7046225070953369
Epoch: 5, Steps: 7 | Train Loss: 0.625 Vali Loss: 0.639 Vali Acc: 0.889 Test Loss: 0.639 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 0.7459511756896973
Epoch: 6, Steps: 7 | Train Loss: 0.356 Vali Loss: 0.492 Vali Acc: 0.889 Test Loss: 0.492 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 0.8144662380218506
Epoch: 7, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.398 Vali Acc: 0.917 Test Loss: 0.398 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 0.7334921360015869
Epoch: 8, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8180105686187744
Epoch: 9, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 0.7980694770812988
Epoch: 10, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.7589051723480225
Epoch: 11, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.7717676162719727
Epoch: 12, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7446866035461426
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.7823123931884766
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.7437460422515869
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.7935013771057129
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.753223180770874
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.74627685546875
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8631818294525146
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7335014343261719
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6836404800415039
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.6964988708496094
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.642319917678833
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.6920795440673828
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.7078275680541992
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.6834628582000732
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6828866004943848
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6788852214813232
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7351138591766357
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7375762462615967
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.7339622974395752
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.7327277660369873
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.7035913467407227
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.7325615882873535
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8579204082489014
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7427396774291992
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8481574058532715
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7272329330444336
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7889838218688965
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.8247723579406738
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.7135009765625
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.699263334274292
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.7219297885894775
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7443444728851318
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7630650997161865
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.7645630836486816
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.7363643646240234
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.7990407943725586
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.8298823833465576
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.7766439914703369
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.6894302368164062
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.6963443756103516
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 0.6884970664978027
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 54 cost time: 0.6782410144805908
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 55 cost time: 0.606032133102417
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 56 cost time: 0.6928324699401855
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 57 cost time: 0.6415605545043945
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 58 cost time: 0.6792523860931396
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6379179954528809
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.8224444389343262
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.6597812175750732
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.9494776725769043
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.7822108268737793
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.844590425491333
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.7285928726196289
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.7668273448944092
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 67 cost time: 0.740811824798584
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 68 cost time: 0.7804670333862305
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 69 cost time: 0.7744016647338867
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 70 cost time: 0.7131199836730957
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 71 cost time: 0.6964137554168701
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 72 cost time: 0.7203950881958008
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 73 cost time: 0.7491199970245361
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 74 cost time: 0.8136615753173828
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.8078725337982178
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.8022799491882324
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.796086311340332
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.7939841747283936
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.6788065433502197
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.7886264324188232
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.8539187908172607
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.8127508163452148
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.8225398063659668
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df256_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 378892
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5850062370300293
Epoch: 1, Steps: 7 | Train Loss: 2.757 Vali Loss: 2.495 Vali Acc: 0.139 Test Loss: 2.495 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.7345972061157227
Epoch: 2, Steps: 7 | Train Loss: 2.512 Vali Loss: 2.114 Vali Acc: 0.306 Test Loss: 2.114 Test Acc: 0.306
Validation loss decreased (-0.138864 --> -0.305534).  Saving model ...
Epoch: 3 cost time: 0.7520604133605957
Epoch: 3, Steps: 7 | Train Loss: 1.808 Vali Loss: 1.658 Vali Acc: 0.611 Test Loss: 1.658 Test Acc: 0.611
Validation loss decreased (-0.305534 --> -0.611095).  Saving model ...
Epoch: 4 cost time: 0.7469375133514404
Epoch: 4, Steps: 7 | Train Loss: 1.327 Vali Loss: 1.225 Vali Acc: 0.722 Test Loss: 1.225 Test Acc: 0.722
Validation loss decreased (-0.611095 --> -0.722210).  Saving model ...
Epoch: 5 cost time: 0.6859898567199707
Epoch: 5, Steps: 7 | Train Loss: 0.839 Vali Loss: 0.889 Vali Acc: 0.806 Test Loss: 0.889 Test Acc: 0.806
Validation loss decreased (-0.722210 --> -0.805547).  Saving model ...
Epoch: 6 cost time: 0.7034385204315186
Epoch: 6, Steps: 7 | Train Loss: 0.496 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
Validation loss decreased (-0.805547 --> -0.833327).  Saving model ...
Epoch: 7 cost time: 0.8163292407989502
Epoch: 7, Steps: 7 | Train Loss: 0.280 Vali Loss: 0.512 Vali Acc: 0.819 Test Loss: 0.512 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6994526386260986
Epoch: 8, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.453 Vali Acc: 0.819 Test Loss: 0.453 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7107577323913574
Epoch: 9, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.397 Vali Acc: 0.833 Test Loss: 0.397 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 0.7561004161834717
Epoch: 10, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.392 Vali Acc: 0.847 Test Loss: 0.392 Test Acc: 0.847
Validation loss decreased (-0.833329 --> -0.847218).  Saving model ...
Epoch: 11 cost time: 0.7243149280548096
Epoch: 11, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.382 Vali Acc: 0.847 Test Loss: 0.382 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 12 cost time: 0.8584029674530029
Epoch: 12, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.374 Vali Acc: 0.847 Test Loss: 0.374 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 13 cost time: 0.8238403797149658
Epoch: 13, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.350 Vali Acc: 0.847 Test Loss: 0.350 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847219).  Saving model ...
Epoch: 14 cost time: 0.7687582969665527
Epoch: 14, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.334 Vali Acc: 0.847 Test Loss: 0.334 Test Acc: 0.847
Validation loss decreased (-0.847219 --> -0.847219).  Saving model ...
Epoch: 15 cost time: 0.7521553039550781
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.325 Vali Acc: 0.847 Test Loss: 0.325 Test Acc: 0.847
Validation loss decreased (-0.847219 --> -0.847219).  Saving model ...
Epoch: 16 cost time: 0.7791943550109863
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.328 Vali Acc: 0.847 Test Loss: 0.328 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8278234004974365
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.327 Vali Acc: 0.847 Test Loss: 0.327 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.833294153213501
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.321 Vali Acc: 0.847 Test Loss: 0.321 Test Acc: 0.847
Validation loss decreased (-0.847219 --> -0.847219).  Saving model ...
Epoch: 19 cost time: 0.8232021331787109
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.847219 --> -0.874997).  Saving model ...
Epoch: 20 cost time: 0.8151535987854004
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 21 cost time: 0.790034294128418
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 22 cost time: 0.8553495407104492
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 23 cost time: 0.9071331024169922
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8716895580291748
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7901067733764648
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 26 cost time: 0.7729251384735107
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8411777019500732
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 28 cost time: 0.7779457569122314
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8186311721801758
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8552138805389404
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7731473445892334
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.749037504196167
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7640013694763184
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 34 cost time: 0.7731456756591797
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 35 cost time: 0.8786525726318359
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9208409786224365
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 37 cost time: 0.8354337215423584
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 38 cost time: 0.7199656963348389
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 39 cost time: 0.7407729625701904
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7738020420074463
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 41 cost time: 0.7964599132537842
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.861 Test Loss: 0.281 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8617033958435059
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 43 cost time: 0.7751083374023438
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 44 cost time: 0.8031005859375
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 45 cost time: 0.7012083530426025
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.861 Test Loss: 0.274 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7048077583312988
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7113761901855469
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7719259262084961
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.875 Test Loss: 0.275 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8631377220153809
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.7752165794372559
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.7568461894989014
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.7325859069824219
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.875 Test Loss: 0.273 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 53 cost time: 0.7290992736816406
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6863749027252197
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 55 cost time: 0.7734427452087402
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 56 cost time: 0.7971518039703369
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 57 cost time: 0.7561078071594238
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7504560947418213
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7373378276824951
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.875 Test Loss: 0.272 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.8105933666229248
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.875 Test Loss: 0.270 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.723914623260498
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.875 Test Loss: 0.270 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.7336165904998779
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.875 Test Loss: 0.270 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.7118914127349854
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 64 cost time: 0.8078110218048096
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7248146533966064
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.7772197723388672
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 67 cost time: 0.8022356033325195
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 68 cost time: 0.8407373428344727
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 69 cost time: 0.725398063659668
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 70 cost time: 0.8918895721435547
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 71 cost time: 0.8834638595581055
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.9351053237915039
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.7898683547973633
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.7716412544250488
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 75 cost time: 0.7689597606658936
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 76 cost time: 0.858210563659668
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 77 cost time: 0.6986579895019531
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 78 cost time: 0.7610104084014893
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 79 cost time: 0.6777057647705078
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.9081192016601562
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.7930774688720703
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.7927443981170654
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.7684283256530762
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 84 cost time: 0.7103896141052246
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.746626615524292
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.7180929183959961
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.7860558032989502
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 88 cost time: 0.829948902130127
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 89 cost time: 0.7763826847076416
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 90 cost time: 0.8199412822723389
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.8314707279205322
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.7298374176025391
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.7687506675720215
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.7870810031890869
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.7699613571166992
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 0.8104605674743652
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 0.7861917018890381
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 98 cost time: 0.693636417388916
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 99 cost time: 0.777146577835083
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 100 cost time: 0.7396538257598877
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 368140
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.812652349472046
Epoch: 1, Steps: 7 | Train Loss: 2.628 Vali Loss: 2.091 Vali Acc: 0.431 Test Loss: 2.091 Test Acc: 0.431
Validation loss decreased (inf --> -0.430535).  Saving model ...
Epoch: 2 cost time: 1.24961519241333
Epoch: 2, Steps: 7 | Train Loss: 1.527 Vali Loss: 0.782 Vali Acc: 0.861 Test Loss: 0.782 Test Acc: 0.861
Validation loss decreased (-0.430535 --> -0.861103).  Saving model ...
Epoch: 3 cost time: 1.304447889328003
Epoch: 3, Steps: 7 | Train Loss: 0.361 Vali Loss: 0.438 Vali Acc: 0.889 Test Loss: 0.438 Test Acc: 0.889
Validation loss decreased (-0.861103 --> -0.888885).  Saving model ...
Epoch: 4 cost time: 1.240525484085083
Epoch: 4, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 5 cost time: 1.1362013816833496
Epoch: 5, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 0.9557051658630371
Epoch: 6, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2043492794036865
Epoch: 7, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1112523078918457
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.371 Vali Acc: 0.931 Test Loss: 0.371 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2421140670776367
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.329 Vali Acc: 0.931 Test Loss: 0.329 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2011079788208008
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958332).  Saving model ...
Epoch: 11 cost time: 1.3469135761260986
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2754828929901123
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.132169485092163
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0256249904632568
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0721251964569092
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9956674575805664
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0558505058288574
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1135175228118896
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9382696151733398
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0931153297424316
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 931340
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0011775493621826
Epoch: 1, Steps: 7 | Train Loss: 2.596 Vali Loss: 2.325 Vali Acc: 0.153 Test Loss: 2.325 Test Acc: 0.153
Validation loss decreased (inf --> -0.152755).  Saving model ...
Epoch: 2 cost time: 1.111771583557129
Epoch: 2, Steps: 7 | Train Loss: 1.750 Vali Loss: 1.326 Vali Acc: 0.653 Test Loss: 1.326 Test Acc: 0.653
Validation loss decreased (-0.152755 --> -0.652765).  Saving model ...
Epoch: 3 cost time: 1.2616462707519531
Epoch: 3, Steps: 7 | Train Loss: 0.692 Vali Loss: 0.631 Vali Acc: 0.819 Test Loss: 0.631 Test Acc: 0.819
Validation loss decreased (-0.652765 --> -0.819438).  Saving model ...
Epoch: 4 cost time: 1.2016847133636475
Epoch: 4, Steps: 7 | Train Loss: 0.224 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
Validation loss decreased (-0.819438 --> -0.847218).  Saving model ...
Epoch: 5 cost time: 1.111295461654663
Epoch: 5, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.335 Vali Acc: 0.903 Test Loss: 0.335 Test Acc: 0.903
Validation loss decreased (-0.847218 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 1.325944185256958
Epoch: 6, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1157751083374023
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.220576524734497
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.3474676609039307
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0784378051757812
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2803092002868652
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2294492721557617
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3250486850738525
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.2635369300842285
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3148510456085205
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.089916706085205
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5064265727996826
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0131940841674805
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5341086387634277
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 20 cost time: 1.1644337177276611
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4476032257080078
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 22 cost time: 1.3279650211334229
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.241370439529419
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3013195991516113
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3050928115844727
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.14921236038208
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1003458499908447
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0036952495574951
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0236914157867432
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.005249261856079
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9637668132781982
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 566540
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0909605026245117
Epoch: 1, Steps: 7 | Train Loss: 2.607 Vali Loss: 2.324 Vali Acc: 0.194 Test Loss: 2.324 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 1.2658584117889404
Epoch: 2, Steps: 7 | Train Loss: 1.971 Vali Loss: 1.526 Vali Acc: 0.708 Test Loss: 1.526 Test Acc: 0.708
Validation loss decreased (-0.194421 --> -0.708318).  Saving model ...
Epoch: 3 cost time: 0.9845230579376221
Epoch: 3, Steps: 7 | Train Loss: 0.996 Vali Loss: 0.873 Vali Acc: 0.819 Test Loss: 0.873 Test Acc: 0.819
Validation loss decreased (-0.708318 --> -0.819436).  Saving model ...
Epoch: 4 cost time: 1.1218488216400146
Epoch: 4, Steps: 7 | Train Loss: 0.420 Vali Loss: 0.478 Vali Acc: 0.903 Test Loss: 0.478 Test Acc: 0.903
Validation loss decreased (-0.819436 --> -0.902773).  Saving model ...
Epoch: 5 cost time: 1.1271917819976807
Epoch: 5, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.388 Vali Acc: 0.903 Test Loss: 0.388 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 0.9770898818969727
Epoch: 6, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2045719623565674
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.1432538032531738
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.280160903930664
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930554).  Saving model ...
Epoch: 10 cost time: 1.1816792488098145
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 11 cost time: 1.1364166736602783
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 12 cost time: 1.3354554176330566
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1561429500579834
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2560484409332275
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0607280731201172
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2283947467803955
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3054025173187256
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1163640022277832
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4206664562225342
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1930880546569824
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2526371479034424
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 450572
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df128_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8011271953582764
Epoch: 1, Steps: 7 | Train Loss: 2.651 Vali Loss: 2.461 Vali Acc: 0.069 Test Loss: 2.461 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 1.1857764720916748
Epoch: 2, Steps: 7 | Train Loss: 2.123 Vali Loss: 1.840 Vali Acc: 0.542 Test Loss: 1.840 Test Acc: 0.542
Validation loss decreased (-0.069420 --> -0.541648).  Saving model ...
Epoch: 3 cost time: 1.0855324268341064
Epoch: 3, Steps: 7 | Train Loss: 1.320 Vali Loss: 1.179 Vali Acc: 0.792 Test Loss: 1.179 Test Acc: 0.792
Validation loss decreased (-0.541648 --> -0.791655).  Saving model ...
Epoch: 4 cost time: 1.338397741317749
Epoch: 4, Steps: 7 | Train Loss: 0.648 Vali Loss: 0.676 Vali Acc: 0.847 Test Loss: 0.676 Test Acc: 0.847
Validation loss decreased (-0.791655 --> -0.847215).  Saving model ...
Epoch: 5 cost time: 1.1709814071655273
Epoch: 5, Steps: 7 | Train Loss: 0.281 Vali Loss: 0.462 Vali Acc: 0.903 Test Loss: 0.462 Test Acc: 0.903
Validation loss decreased (-0.847215 --> -0.902773).  Saving model ...
Epoch: 6 cost time: 1.2856996059417725
Epoch: 6, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.358 Vali Acc: 0.917 Test Loss: 0.358 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.0520644187927246
Epoch: 7, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3140881061553955
Epoch: 8, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2096643447875977
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.2214601039886475
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.1956923007965088
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.1628649234771729
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.2129778861999512
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.0865020751953125
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.0677671432495117
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1230058670043945
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1519901752471924
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1050608158111572
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.0349724292755127
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0593583583831787
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.9898130893707275
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.0637319087982178
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.0505962371826172
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.013674259185791
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.0617694854736328
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.2020015716552734
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.1530680656433105
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.207604169845581
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.113093376159668
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.190990924835205
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.187708854675293
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2527532577514648
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1538598537445068
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 1.134047269821167
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2476325035095215
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 1.1103529930114746
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 1.2715437412261963
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 1.0609309673309326
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.126758337020874
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0507798194885254
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1372077465057373
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1069369316101074
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1464450359344482
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0361993312835693
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.094841480255127
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 1.1733765602111816
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.054548978805542
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 1.1395988464355469
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 1.155210256576538
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 1.1775665283203125
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0927314758300781
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.324263095855713
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.1895875930786133
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.0627593994140625
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.0493950843811035
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.1890449523925781
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.1900556087493896
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.1295695304870605
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.286531686782837
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df128_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 389900
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7511403560638428
Epoch: 1, Steps: 7 | Train Loss: 2.627 Vali Loss: 2.502 Vali Acc: 0.208 Test Loss: 2.502 Test Acc: 0.208
Validation loss decreased (inf --> -0.208308).  Saving model ...
Epoch: 2 cost time: 1.0008413791656494
Epoch: 2, Steps: 7 | Train Loss: 2.264 Vali Loss: 1.972 Vali Acc: 0.486 Test Loss: 1.972 Test Acc: 0.486
Validation loss decreased (-0.208308 --> -0.486091).  Saving model ...
Epoch: 3 cost time: 1.0516815185546875
Epoch: 3, Steps: 7 | Train Loss: 1.568 Vali Loss: 1.370 Vali Acc: 0.722 Test Loss: 1.370 Test Acc: 0.722
Validation loss decreased (-0.486091 --> -0.722209).  Saving model ...
Epoch: 4 cost time: 0.9806249141693115
Epoch: 4, Steps: 7 | Train Loss: 0.959 Vali Loss: 0.892 Vali Acc: 0.833 Test Loss: 0.892 Test Acc: 0.833
Validation loss decreased (-0.722209 --> -0.833324).  Saving model ...
Epoch: 5 cost time: 1.079317569732666
Epoch: 5, Steps: 7 | Train Loss: 0.475 Vali Loss: 0.602 Vali Acc: 0.875 Test Loss: 0.602 Test Acc: 0.875
Validation loss decreased (-0.833324 --> -0.874994).  Saving model ...
Epoch: 6 cost time: 0.9642953872680664
Epoch: 6, Steps: 7 | Train Loss: 0.217 Vali Loss: 0.443 Vali Acc: 0.889 Test Loss: 0.443 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 1.0400981903076172
Epoch: 7, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.0602631568908691
Epoch: 8, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1588037014007568
Epoch: 9, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.0889408588409424
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.1166057586669922
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.0022683143615723
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1842083930969238
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2493054866790771
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1480536460876465
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2372395992279053
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1644542217254639
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.1580393314361572
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.9585134983062744
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.1360881328582764
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.1314337253570557
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.1043071746826172
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.1758830547332764
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 1.0465435981750488
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.163426160812378
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.0901777744293213
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.231285572052002
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 1.0964806079864502
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.1264002323150635
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.22755765914917
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.166886806488037
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1986911296844482
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 1.152665376663208
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 1.0626418590545654
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 1.0183837413787842
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0207509994506836
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9895553588867188
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.978123664855957
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 1.0950851440429688
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 1.1902234554290771
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2008733749389648
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3754348754882812
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.4759244918823242
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 1.4015343189239502
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 1.4650144577026367
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 1.209552526473999
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 1.4102227687835693
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 1.3176178932189941
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 1.6488919258117676
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3283932209014893
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 1.4787912368774414
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 1.3059415817260742
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.4628033638000488
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 54 cost time: 1.2870292663574219
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 55 cost time: 1.3843889236450195
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 56 cost time: 1.3828904628753662
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.4766120910644531
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.2513749599456787
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.5596492290496826
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.378641128540039
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.3660697937011719
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.320505142211914
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.443373441696167
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.3442907333374023
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.3938381671905518
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 342284
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df128_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5860610008239746
Epoch: 1, Steps: 7 | Train Loss: 2.468 Vali Loss: 2.360 Vali Acc: 0.222 Test Loss: 2.360 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 0.7882299423217773
Epoch: 2, Steps: 7 | Train Loss: 2.174 Vali Loss: 1.951 Vali Acc: 0.444 Test Loss: 1.951 Test Acc: 0.444
Validation loss decreased (-0.222199 --> -0.444425).  Saving model ...
Epoch: 3 cost time: 0.905407190322876
Epoch: 3, Steps: 7 | Train Loss: 1.630 Vali Loss: 1.487 Vali Acc: 0.653 Test Loss: 1.487 Test Acc: 0.653
Validation loss decreased (-0.444425 --> -0.652763).  Saving model ...
Epoch: 4 cost time: 0.8520991802215576
Epoch: 4, Steps: 7 | Train Loss: 1.094 Vali Loss: 1.084 Vali Acc: 0.764 Test Loss: 1.084 Test Acc: 0.764
Validation loss decreased (-0.652763 --> -0.763878).  Saving model ...
Epoch: 5 cost time: 0.7835605144500732
Epoch: 5, Steps: 7 | Train Loss: 0.620 Vali Loss: 0.744 Vali Acc: 0.819 Test Loss: 0.744 Test Acc: 0.819
Validation loss decreased (-0.763878 --> -0.819437).  Saving model ...
Epoch: 6 cost time: 0.8752264976501465
Epoch: 6, Steps: 7 | Train Loss: 0.343 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
Validation loss decreased (-0.819437 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 0.8865180015563965
Epoch: 7, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.459 Vali Acc: 0.861 Test Loss: 0.459 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.821150541305542
Epoch: 8, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.395 Vali Acc: 0.847 Test Loss: 0.395 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8611068725585938
Epoch: 9, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 0.814619779586792
Epoch: 10, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.8121304512023926
Epoch: 11, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.7581398487091064
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.99810791015625
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9330224990844727
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.9253811836242676
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.9969727993011475
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.9506583213806152
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.9504549503326416
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.8612127304077148
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.8937256336212158
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.9150679111480713
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.8623216152191162
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.8507852554321289
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.9287106990814209
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.8602538108825684
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9266550540924072
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9214963912963867
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9188859462738037
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9233732223510742
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8812243938446045
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.910306453704834
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9137544631958008
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.9568326473236084
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.9209606647491455
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.8091623783111572
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.988867998123169
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.8490300178527832
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.940894365310669
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.9265532493591309
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.8462152481079102
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.8894193172454834
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.9544432163238525
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.8224043846130371
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.9164600372314453
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8815286159515381
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.9224600791931152
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.9280490875244141
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0123240947723389
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9467055797576904
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8889338970184326
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.904292106628418
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.8881857395172119
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9825079441070557
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.9160792827606201
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.8473336696624756
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.9921133518218994
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df128_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 313100
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6337802410125732
Epoch: 1, Steps: 7 | Train Loss: 2.594 Vali Loss: 2.418 Vali Acc: 0.153 Test Loss: 2.418 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.8820445537567139
Epoch: 2, Steps: 7 | Train Loss: 2.271 Vali Loss: 2.037 Vali Acc: 0.431 Test Loss: 2.037 Test Acc: 0.431
Validation loss decreased (-0.152754 --> -0.430535).  Saving model ...
Epoch: 3 cost time: 0.8889684677124023
Epoch: 3, Steps: 7 | Train Loss: 1.760 Vali Loss: 1.575 Vali Acc: 0.667 Test Loss: 1.575 Test Acc: 0.667
Validation loss decreased (-0.430535 --> -0.666651).  Saving model ...
Epoch: 4 cost time: 0.8698008060455322
Epoch: 4, Steps: 7 | Train Loss: 1.288 Vali Loss: 1.165 Vali Acc: 0.792 Test Loss: 1.165 Test Acc: 0.792
Validation loss decreased (-0.666651 --> -0.791655).  Saving model ...
Epoch: 5 cost time: 0.9002199172973633
Epoch: 5, Steps: 7 | Train Loss: 0.876 Vali Loss: 0.843 Vali Acc: 0.861 Test Loss: 0.843 Test Acc: 0.861
Validation loss decreased (-0.791655 --> -0.861103).  Saving model ...
Epoch: 6 cost time: 0.9927585124969482
Epoch: 6, Steps: 7 | Train Loss: 0.521 Vali Loss: 0.613 Vali Acc: 0.903 Test Loss: 0.613 Test Acc: 0.903
Validation loss decreased (-0.861103 --> -0.902772).  Saving model ...
Epoch: 7 cost time: 0.8749747276306152
Epoch: 7, Steps: 7 | Train Loss: 0.287 Vali Loss: 0.492 Vali Acc: 0.903 Test Loss: 0.492 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 0.969294548034668
Epoch: 8, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.410 Vali Acc: 0.889 Test Loss: 0.410 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8487911224365234
Epoch: 9, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9119894504547119
Epoch: 10, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8582746982574463
Epoch: 11, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.038672685623169
Epoch: 12, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.8906147480010986
Epoch: 13, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.8849461078643799
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.8924341201782227
Epoch: 15, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.8546156883239746
Epoch: 16, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.9481260776519775
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.8037548065185547
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9165685176849365
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.834423303604126
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.854257345199585
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.7292098999023438
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.7941386699676514
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8819262981414795
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.8197436332702637
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.8840837478637695
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.8029208183288574
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.8568415641784668
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9388809204101562
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9346373081207275
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9080383777618408
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8263614177703857
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.7998664379119873
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.7341959476470947
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.8736081123352051
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8585433959960938
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7640097141265869
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.75333571434021
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.8062374591827393
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7844197750091553
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8117566108703613
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.8352172374725342
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.9169538021087646
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.8377602100372314
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.7978343963623047
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.8894021511077881
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.9345178604125977
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8814175128936768
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8983170986175537
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8642539978027344
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 0.7891583442687988
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.8732903003692627
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9394819736480713
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.8817880153656006
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.8935220241546631
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9428756237030029
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.9430220127105713
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.8322949409484863
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 0.8093540668487549
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.881079912185669
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.856086015701294
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.8341677188873291
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 0.8705575466156006
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 0.7794680595397949
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 0.6610023975372314
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.8992583751678467
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.9336042404174805
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.8437888622283936
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.8753557205200195
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.8866331577301025
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.8357217311859131
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.8524789810180664
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 73 cost time: 0.9513928890228271
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 74 cost time: 0.8116052150726318
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.8230178356170654
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 76 cost time: 0.8522231578826904
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.9264919757843018
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.8256871700286865
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.9119453430175781
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 80 cost time: 0.8651537895202637
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 81 cost time: 0.7758450508117676
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.7975788116455078
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.8100645542144775
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.8307797908782959
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.8400335311889648
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.9262032508850098
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.8646974563598633
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.8678390979766846
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 0.9528474807739258
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.9231545925140381
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 302348
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2040271759033203
Epoch: 1, Steps: 7 | Train Loss: 2.553 Vali Loss: 2.050 Vali Acc: 0.375 Test Loss: 2.050 Test Acc: 0.375
Validation loss decreased (inf --> -0.374979).  Saving model ...
Epoch: 2 cost time: 1.291010856628418
Epoch: 2, Steps: 7 | Train Loss: 1.295 Vali Loss: 0.761 Vali Acc: 0.792 Test Loss: 0.761 Test Acc: 0.792
Validation loss decreased (-0.374979 --> -0.791659).  Saving model ...
Epoch: 3 cost time: 1.3714725971221924
Epoch: 3, Steps: 7 | Train Loss: 0.254 Vali Loss: 0.425 Vali Acc: 0.847 Test Loss: 0.425 Test Acc: 0.847
Validation loss decreased (-0.791659 --> -0.847218).  Saving model ...
Epoch: 4 cost time: 1.3541357517242432
Epoch: 4, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.529 Vali Acc: 0.875 Test Loss: 0.529 Test Acc: 0.875
Validation loss decreased (-0.847218 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 1.3328297138214111
Epoch: 5, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.3302373886108398
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 1.2067296504974365
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.2937450408935547
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.348 Vali Acc: 0.931 Test Loss: 0.348 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 1.3303558826446533
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.037501573562622
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.1477406024932861
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1360838413238525
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1811895370483398
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1500287055969238
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0907447338104248
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.095107078552246
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0285935401916504
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.268148422241211
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.347456693649292
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2092618942260742
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 898444
model size : 5.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1756691932678223
Epoch: 1, Steps: 7 | Train Loss: 2.793 Vali Loss: 2.278 Vali Acc: 0.194 Test Loss: 2.278 Test Acc: 0.194
Validation loss decreased (inf --> -0.194422).  Saving model ...
Epoch: 2 cost time: 1.2088241577148438
Epoch: 2, Steps: 7 | Train Loss: 1.850 Vali Loss: 1.319 Vali Acc: 0.694 Test Loss: 1.319 Test Acc: 0.694
Validation loss decreased (-0.194422 --> -0.694431).  Saving model ...
Epoch: 3 cost time: 1.410430669784546
Epoch: 3, Steps: 7 | Train Loss: 0.725 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
Validation loss decreased (-0.694431 --> -0.874994).  Saving model ...
Epoch: 4 cost time: 1.3807785511016846
Epoch: 4, Steps: 7 | Train Loss: 0.213 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 5 cost time: 1.0931396484375
Epoch: 5, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 1.3171987533569336
Epoch: 6, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3185296058654785
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.371 Vali Acc: 0.903 Test Loss: 0.371 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2268357276916504
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2435708045959473
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.348379373550415
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.221717119216919
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.0561959743499756
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.4827721118927002
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.355196475982666
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.3203389644622803
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3111634254455566
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3079378604888916
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3783342838287354
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2373614311218262
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3645861148834229
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.362173080444336
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2693054676055908
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.207287311553955
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4168691635131836
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 533644
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.677060604095459
Epoch: 1, Steps: 7 | Train Loss: 2.620 Vali Loss: 2.373 Vali Acc: 0.250 Test Loss: 2.373 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 1.0635578632354736
Epoch: 2, Steps: 7 | Train Loss: 1.954 Vali Loss: 1.537 Vali Acc: 0.653 Test Loss: 1.537 Test Acc: 0.653
Validation loss decreased (-0.249976 --> -0.652762).  Saving model ...
Epoch: 3 cost time: 1.1413121223449707
Epoch: 3, Steps: 7 | Train Loss: 1.068 Vali Loss: 0.866 Vali Acc: 0.806 Test Loss: 0.866 Test Acc: 0.806
Validation loss decreased (-0.652762 --> -0.805547).  Saving model ...
Epoch: 4 cost time: 1.213758945465088
Epoch: 4, Steps: 7 | Train Loss: 0.407 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
Validation loss decreased (-0.805547 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 1.0764060020446777
Epoch: 5, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.369 Vali Acc: 0.917 Test Loss: 0.369 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 1.3969995975494385
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2448539733886719
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 1.1230354309082031
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 1.3669233322143555
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2623510360717773
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.36777663230896
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.1757118701934814
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.356959342956543
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.3169629573822021
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2136149406433105
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.346036672592163
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.139434576034546
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2905001640319824
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9766194820404053
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4859819412231445
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1397078037261963
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.275787115097046
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1919314861297607
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 417676
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df64_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8796627521514893
Epoch: 1, Steps: 7 | Train Loss: 2.832 Vali Loss: 2.503 Vali Acc: 0.097 Test Loss: 2.503 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 1.0971558094024658
Epoch: 2, Steps: 7 | Train Loss: 2.253 Vali Loss: 1.790 Vali Acc: 0.583 Test Loss: 1.790 Test Acc: 0.583
Validation loss decreased (-0.097197 --> -0.583315).  Saving model ...
Epoch: 3 cost time: 1.2355380058288574
Epoch: 3, Steps: 7 | Train Loss: 1.358 Vali Loss: 1.116 Vali Acc: 0.833 Test Loss: 1.116 Test Acc: 0.833
Validation loss decreased (-0.583315 --> -0.833322).  Saving model ...
Epoch: 4 cost time: 1.158665418624878
Epoch: 4, Steps: 7 | Train Loss: 0.648 Vali Loss: 0.683 Vali Acc: 0.847 Test Loss: 0.683 Test Acc: 0.847
Validation loss decreased (-0.833322 --> -0.847215).  Saving model ...
Epoch: 5 cost time: 0.9122829437255859
Epoch: 5, Steps: 7 | Train Loss: 0.290 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 1.0974175930023193
Epoch: 6, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 1.2151665687561035
Epoch: 7, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.2406132221221924
Epoch: 8, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.285 Vali Acc: 0.931 Test Loss: 0.285 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.5454645156860352
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9806423187255859
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4325854778289795
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0334486961364746
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4760029315948486
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1200063228607178
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3842029571533203
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2275328636169434
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2988131046295166
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2842822074890137
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df64_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 357004
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.972485303878784
Epoch: 1, Steps: 7 | Train Loss: 2.765 Vali Loss: 2.562 Vali Acc: 0.097 Test Loss: 2.562 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.8806982040405273
Epoch: 2, Steps: 7 | Train Loss: 2.367 Vali Loss: 2.119 Vali Acc: 0.403 Test Loss: 2.119 Test Acc: 0.403
Validation loss decreased (-0.097197 --> -0.402757).  Saving model ...
Epoch: 3 cost time: 1.1760516166687012
Epoch: 3, Steps: 7 | Train Loss: 1.656 Vali Loss: 1.528 Vali Acc: 0.639 Test Loss: 1.528 Test Acc: 0.639
Validation loss decreased (-0.402757 --> -0.638874).  Saving model ...
Epoch: 4 cost time: 1.1012938022613525
Epoch: 4, Steps: 7 | Train Loss: 1.001 Vali Loss: 1.004 Vali Acc: 0.764 Test Loss: 1.004 Test Acc: 0.764
Validation loss decreased (-0.638874 --> -0.763879).  Saving model ...
Epoch: 5 cost time: 1.2189929485321045
Epoch: 5, Steps: 7 | Train Loss: 0.536 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
Validation loss decreased (-0.763879 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 0.9795017242431641
Epoch: 6, Steps: 7 | Train Loss: 0.229 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
Validation loss decreased (-0.833327 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 1.373610258102417
Epoch: 7, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 1.172114372253418
Epoch: 8, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 1.121971845626831
Epoch: 9, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 1.0450212955474854
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 1.2437422275543213
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 1.029627799987793
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 1.1421167850494385
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.2932276725769043
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3367094993591309
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.9861588478088379
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.2470614910125732
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.0080077648162842
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.3842196464538574
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 1.1808195114135742
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 1.2485902309417725
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 1.255298137664795
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.996387243270874
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 1.1078708171844482
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 1.0913856029510498
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 1.1434071063995361
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 1.1170141696929932
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 1.3449454307556152
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 1.1609740257263184
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 30 cost time: 1.1989727020263672
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 31 cost time: 1.173065185546875
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 32 cost time: 1.17326021194458
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1084587574005127
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2728915214538574
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 35 cost time: 1.0901484489440918
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.087681531906128
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 37 cost time: 0.9270436763763428
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 38 cost time: 1.0275297164916992
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 39 cost time: 1.0273375511169434
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9959566593170166
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 41 cost time: 0.9460997581481934
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8104393482208252
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 43 cost time: 0.8768503665924072
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 44 cost time: 0.9642379283905029
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 45 cost time: 1.3459930419921875
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1626694202423096
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0988502502441406
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1435532569885254
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2877206802368164
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.903 Test Loss: 0.214 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 50 cost time: 1.0798203945159912
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 51 cost time: 1.0932402610778809
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 52 cost time: 1.1467056274414062
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.903 Test Loss: 0.209 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 53 cost time: 0.9490325450897217
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.903 Test Loss: 0.209 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 54 cost time: 1.0056016445159912
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.903 Test Loss: 0.207 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 55 cost time: 1.601313591003418
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.903 Test Loss: 0.206 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 56 cost time: 1.285132646560669
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.903 Test Loss: 0.205 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 57 cost time: 1.1259446144104004
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.903 Test Loss: 0.205 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 58 cost time: 1.288987159729004
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.903 Test Loss: 0.206 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.2135989665985107
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.903 Test Loss: 0.206 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.2862181663513184
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.903 Test Loss: 0.207 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.9486818313598633
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.903 Test Loss: 0.206 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.4207916259765625
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.903 Test Loss: 0.205 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.1140072345733643
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.903 Test Loss: 0.203 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 64 cost time: 1.200209617614746
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.903 Test Loss: 0.203 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.2350594997406006
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.903 Test Loss: 0.203 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 66 cost time: 1.2649595737457275
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 67 cost time: 1.146693229675293
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 68 cost time: 1.3303401470184326
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 69 cost time: 1.1453685760498047
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 70 cost time: 1.1830365657806396
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.1807796955108643
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.068176031112671
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.903 Test Loss: 0.199 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 73 cost time: 0.901057243347168
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.903 Test Loss: 0.199 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 74 cost time: 1.1250600814819336
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.903 Test Loss: 0.199 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.0169618129730225
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.903 Test Loss: 0.198 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 76 cost time: 0.90730881690979
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.903 Test Loss: 0.197 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 77 cost time: 0.9674782752990723
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.903 Test Loss: 0.197 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 78 cost time: 1.2166666984558105
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.903 Test Loss: 0.196 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 79 cost time: 0.8598842620849609
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.903 Test Loss: 0.195 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 80 cost time: 0.9195799827575684
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.903 Test Loss: 0.194 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 81 cost time: 0.9983453750610352
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.903 Test Loss: 0.193 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 82 cost time: 1.228031873703003
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.903 Test Loss: 0.195 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.2404792308807373
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.903 Test Loss: 0.194 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.0511021614074707
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.903 Test Loss: 0.192 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 85 cost time: 1.2742486000061035
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.903 Test Loss: 0.193 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.0812811851501465
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.903 Test Loss: 0.192 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 87 cost time: 1.2122042179107666
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
Validation loss decreased (-0.902776 --> -0.916665).  Saving model ...
Epoch: 88 cost time: 1.1337146759033203
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 89 cost time: 1.2181930541992188
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 90 cost time: 1.0449166297912598
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 91 cost time: 1.0511486530303955
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.2288990020751953
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 93 cost time: 1.214193344116211
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 94 cost time: 1.0523076057434082
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 95 cost time: 1.0982539653778076
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.0393402576446533
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 1.1575078964233398
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 1.0789988040924072
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 1.077542781829834
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 0.9314324855804443
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 309388
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df64_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4864068031311035
Epoch: 1, Steps: 7 | Train Loss: 2.478 Vali Loss: 2.399 Vali Acc: 0.083 Test Loss: 2.399 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 0.7261788845062256
Epoch: 2, Steps: 7 | Train Loss: 2.193 Vali Loss: 1.967 Vali Acc: 0.458 Test Loss: 1.967 Test Acc: 0.458
Validation loss decreased (-0.083309 --> -0.458314).  Saving model ...
Epoch: 3 cost time: 0.7993700504302979
Epoch: 3, Steps: 7 | Train Loss: 1.666 Vali Loss: 1.454 Vali Acc: 0.694 Test Loss: 1.454 Test Acc: 0.694
Validation loss decreased (-0.458314 --> -0.694430).  Saving model ...
Epoch: 4 cost time: 0.7201242446899414
Epoch: 4, Steps: 7 | Train Loss: 1.091 Vali Loss: 1.018 Vali Acc: 0.722 Test Loss: 1.018 Test Acc: 0.722
Validation loss decreased (-0.694430 --> -0.722212).  Saving model ...
Epoch: 5 cost time: 0.807197093963623
Epoch: 5, Steps: 7 | Train Loss: 0.641 Vali Loss: 0.698 Vali Acc: 0.833 Test Loss: 0.698 Test Acc: 0.833
Validation loss decreased (-0.722212 --> -0.833326).  Saving model ...
Epoch: 6 cost time: 0.78609299659729
Epoch: 6, Steps: 7 | Train Loss: 0.365 Vali Loss: 0.515 Vali Acc: 0.903 Test Loss: 0.515 Test Acc: 0.903
Validation loss decreased (-0.833326 --> -0.902773).  Saving model ...
Epoch: 7 cost time: 0.7531821727752686
Epoch: 7, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.417 Vali Acc: 0.903 Test Loss: 0.417 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.8385322093963623
Epoch: 8, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.353 Vali Acc: 0.931 Test Loss: 0.353 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.8243484497070312
Epoch: 9, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8827579021453857
Epoch: 10, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7944512367248535
Epoch: 11, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9599478244781494
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.9664897918701172
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.274 Vali Acc: 0.958 Test Loss: 0.274 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.860905647277832
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.8051955699920654
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8439908027648926
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.253 Vali Acc: 0.958 Test Loss: 0.253 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.8609926700592041
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.958 Test Loss: 0.253 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.7971072196960449
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.958 Test Loss: 0.246 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.8872864246368408
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.7690427303314209
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.8220312595367432
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.6722228527069092
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.7773861885070801
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8558015823364258
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.8298840522766113
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.9193947315216064
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.8565285205841064
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.8157055377960205
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.8633012771606445
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.8335671424865723
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.7629556655883789
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.972 Test Loss: 0.210 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 32 cost time: 0.9380125999450684
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.972 Test Loss: 0.208 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 33 cost time: 0.86004638671875
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.972 Test Loss: 0.207 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 34 cost time: 0.8584442138671875
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8051488399505615
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8548614978790283
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7724955081939697
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7826976776123047
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.974891185760498
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.867154598236084
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.80226731300354
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8800148963928223
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.972 Test Loss: 0.196 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 43 cost time: 0.9720249176025391
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 44 cost time: 0.8859443664550781
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 45 cost time: 0.9154636859893799
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 46 cost time: 0.9341213703155518
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 47 cost time: 0.916893482208252
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8928399085998535
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9205975532531738
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8405547142028809
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.9142494201660156
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.8770897388458252
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9502649307250977
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 54 cost time: 0.8953394889831543
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.972 Test Loss: 0.190 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 55 cost time: 0.8168971538543701
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.972 Test Loss: 0.189 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 56 cost time: 0.9654443264007568
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.972 Test Loss: 0.188 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 57 cost time: 0.8265664577484131
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 58 cost time: 0.8872942924499512
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 59 cost time: 0.7869188785552979
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.912196159362793
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.8517863750457764
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 62 cost time: 0.9196407794952393
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 63 cost time: 0.8197965621948242
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 64 cost time: 0.8884902000427246
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 65 cost time: 0.8051242828369141
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 66 cost time: 0.8255283832550049
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8652420043945312
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 68 cost time: 0.8430349826812744
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.8683731555938721
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 70 cost time: 0.8250384330749512
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 71 cost time: 0.8836860656738281
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 72 cost time: 0.7969999313354492
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.8390839099884033
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 74 cost time: 0.7931056022644043
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 75 cost time: 0.8457260131835938
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 76 cost time: 0.8183486461639404
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 77 cost time: 0.9115324020385742
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 78 cost time: 0.8233447074890137
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 79 cost time: 0.8907620906829834
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.972 Test Loss: 0.174 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 80 cost time: 0.9080641269683838
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.972 Test Loss: 0.174 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 81 cost time: 0.8347551822662354
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.972 Test Loss: 0.174 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.8756198883056641
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.7310194969177246
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.8930902481079102
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.972 Test Loss: 0.174 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.9162464141845703
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.9292948246002197
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.8791074752807617
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.9156994819641113
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 0.9386518001556396
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.9289290904998779
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df64_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 280204
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.66280198097229
Epoch: 1, Steps: 7 | Train Loss: 2.556 Vali Loss: 2.410 Vali Acc: 0.139 Test Loss: 2.410 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.8693885803222656
Epoch: 2, Steps: 7 | Train Loss: 2.337 Vali Loss: 2.053 Vali Acc: 0.542 Test Loss: 2.053 Test Acc: 0.542
Validation loss decreased (-0.138865 --> -0.541646).  Saving model ...
Epoch: 3 cost time: 0.8514347076416016
Epoch: 3, Steps: 7 | Train Loss: 1.848 Vali Loss: 1.611 Vali Acc: 0.694 Test Loss: 1.611 Test Acc: 0.694
Validation loss decreased (-0.541646 --> -0.694428).  Saving model ...
Epoch: 4 cost time: 1.0027573108673096
Epoch: 4, Steps: 7 | Train Loss: 1.306 Vali Loss: 1.205 Vali Acc: 0.778 Test Loss: 1.205 Test Acc: 0.778
Validation loss decreased (-0.694428 --> -0.777766).  Saving model ...
Epoch: 5 cost time: 0.820803165435791
Epoch: 5, Steps: 7 | Train Loss: 0.884 Vali Loss: 0.887 Vali Acc: 0.806 Test Loss: 0.887 Test Acc: 0.806
Validation loss decreased (-0.777766 --> -0.805547).  Saving model ...
Epoch: 6 cost time: 0.8679959774017334
Epoch: 6, Steps: 7 | Train Loss: 0.511 Vali Loss: 0.655 Vali Acc: 0.847 Test Loss: 0.655 Test Acc: 0.847
Validation loss decreased (-0.805547 --> -0.847216).  Saving model ...
Epoch: 7 cost time: 0.9227471351623535
Epoch: 7, Steps: 7 | Train Loss: 0.318 Vali Loss: 0.548 Vali Acc: 0.847 Test Loss: 0.548 Test Acc: 0.847
Validation loss decreased (-0.847216 --> -0.847217).  Saving model ...
Epoch: 8 cost time: 0.8326714038848877
Epoch: 8, Steps: 7 | Train Loss: 0.179 Vali Loss: 0.455 Vali Acc: 0.861 Test Loss: 0.455 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861107).  Saving model ...
Epoch: 9 cost time: 0.9564616680145264
Epoch: 9, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.404 Vali Acc: 0.889 Test Loss: 0.404 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.9303338527679443
Epoch: 10, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8716838359832764
Epoch: 11, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 0.8080086708068848
Epoch: 12, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8714585304260254
Epoch: 13, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.8435664176940918
Epoch: 14, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.7953300476074219
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.9059028625488281
Epoch: 16, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.8436768054962158
Epoch: 17, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.9560225009918213
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0568366050720215
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9009053707122803
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9488582611083984
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.9790558815002441
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.9246361255645752
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9349062442779541
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8779070377349854
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8454742431640625
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.9903311729431152
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8534059524536133
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.8914775848388672
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.8690922260284424
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.8963830471038818
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.8929870128631592
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.9477739334106445
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.8511767387390137
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.841376781463623
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.8827121257781982
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.7896804809570312
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8126840591430664
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9785332679748535
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8653690814971924
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.8764300346374512
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.8564817905426025
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.9411640167236328
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.7967929840087891
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.7987756729125977
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9376966953277588
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9439256191253662
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9773719310760498
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 1.0054469108581543
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.9363112449645996
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8761615753173828
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.9776334762573242
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.89182448387146
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9052388668060303
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.8832607269287109
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.8263473510742188
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 57 cost time: 0.886315107345581
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 0.7551290988922119
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 59 cost time: 0.950047492980957
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 60 cost time: 0.8150923252105713
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.7750351428985596
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.745220422744751
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 0.7190089225769043
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 64 cost time: 0.7930788993835449
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 65 cost time: 0.8409848213195801
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.9222910404205322
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.8992905616760254
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.8368902206420898
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.9658551216125488
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.7671434879302979
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.9070038795471191
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.870694637298584
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.7895214557647705
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.8611471652984619
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm128_nh16_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 269452
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1983280181884766
Epoch: 1, Steps: 7 | Train Loss: 2.648 Vali Loss: 2.394 Vali Acc: 0.167 Test Loss: 2.394 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 1.227900743484497
Epoch: 2, Steps: 7 | Train Loss: 1.914 Vali Loss: 1.545 Vali Acc: 0.625 Test Loss: 1.545 Test Acc: 0.625
Validation loss decreased (-0.166643 --> -0.624985).  Saving model ...
Epoch: 3 cost time: 1.2575476169586182
Epoch: 3, Steps: 7 | Train Loss: 0.902 Vali Loss: 0.743 Vali Acc: 0.847 Test Loss: 0.743 Test Acc: 0.847
Validation loss decreased (-0.624985 --> -0.847215).  Saving model ...
Epoch: 4 cost time: 1.3325626850128174
Epoch: 4, Steps: 7 | Train Loss: 0.274 Vali Loss: 0.499 Vali Acc: 0.875 Test Loss: 0.499 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 1.3417224884033203
Epoch: 5, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902775).  Saving model ...
Epoch: 6 cost time: 1.2425014972686768
Epoch: 6, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.245607614517212
Epoch: 7, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.402 Vali Acc: 0.917 Test Loss: 0.402 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 1.165367841720581
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.1406056880950928
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2047767639160156
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2034556865692139
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.1083950996398926
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 1.2601816654205322
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 1.167036533355713
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.0762498378753662
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 1.2371675968170166
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 1.095719575881958
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1687936782836914
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 1.0959303379058838
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.051525354385376
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2612385749816895
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.073484182357788
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.2138912677764893
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 1.2794103622436523
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 1.0476078987121582
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0263118743896484
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1220457553863525
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1985836029052734
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1305506229400635
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1380620002746582
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2798612117767334
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0839550495147705
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1751675605773926
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2932887077331543
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 1.1296846866607666
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 1.3373563289642334
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 1.126173496246338
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 1.1449000835418701
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 1.3013463020324707
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2623505592346191
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1946589946746826
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.232964277267456
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.3487958908081055
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.1166095733642578
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.2586405277252197
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.235762357711792
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.14341139793396
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.250288963317871
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 466060
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.908505439758301
Epoch: 1, Steps: 7 | Train Loss: 2.511 Vali Loss: 2.359 Vali Acc: 0.222 Test Loss: 2.359 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 1.1975858211517334
Epoch: 2, Steps: 7 | Train Loss: 2.078 Vali Loss: 1.733 Vali Acc: 0.500 Test Loss: 1.733 Test Acc: 0.500
Validation loss decreased (-0.222199 --> -0.499983).  Saving model ...
Epoch: 3 cost time: 1.2507100105285645
Epoch: 3, Steps: 7 | Train Loss: 1.280 Vali Loss: 1.092 Vali Acc: 0.806 Test Loss: 1.092 Test Acc: 0.806
Validation loss decreased (-0.499983 --> -0.805545).  Saving model ...
Epoch: 4 cost time: 1.0724787712097168
Epoch: 4, Steps: 7 | Train Loss: 0.636 Vali Loss: 0.649 Vali Acc: 0.875 Test Loss: 0.649 Test Acc: 0.875
Validation loss decreased (-0.805545 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 1.249405860900879
Epoch: 5, Steps: 7 | Train Loss: 0.265 Vali Loss: 0.442 Vali Acc: 0.903 Test Loss: 0.442 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902773).  Saving model ...
Epoch: 6 cost time: 1.0370497703552246
Epoch: 6, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.353 Vali Acc: 0.917 Test Loss: 0.353 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.2818858623504639
Epoch: 7, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2601370811462402
Epoch: 8, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.055454969406128
Epoch: 9, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.3202805519104004
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.3010339736938477
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.1332826614379883
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.1969799995422363
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1398494243621826
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4107341766357422
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.322542667388916
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9766075611114502
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2717325687408447
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9640767574310303
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1381614208221436
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.163447380065918
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0733423233032227
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.924471378326416
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1009209156036377
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1887624263763428
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0195739269256592
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.044886589050293
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 1.1430697441101074
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0092098712921143
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2432920932769775
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.255335807800293
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1534144878387451
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2309942245483398
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2180588245391846
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1416020393371582
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1830601692199707
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2917804718017578
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 283660
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0542032718658447
Epoch: 1, Steps: 7 | Train Loss: 2.490 Vali Loss: 2.315 Vali Acc: 0.139 Test Loss: 2.315 Test Acc: 0.139
Validation loss decreased (inf --> -0.138866).  Saving model ...
Epoch: 2 cost time: 1.1617307662963867
Epoch: 2, Steps: 7 | Train Loss: 2.150 Vali Loss: 1.834 Vali Acc: 0.681 Test Loss: 1.834 Test Acc: 0.681
Validation loss decreased (-0.138866 --> -0.680537).  Saving model ...
Epoch: 3 cost time: 1.2892582416534424
Epoch: 3, Steps: 7 | Train Loss: 1.577 Vali Loss: 1.270 Vali Acc: 0.806 Test Loss: 1.270 Test Acc: 0.806
Validation loss decreased (-0.680537 --> -0.805543).  Saving model ...
Epoch: 4 cost time: 1.1207129955291748
Epoch: 4, Steps: 7 | Train Loss: 0.941 Vali Loss: 0.813 Vali Acc: 0.903 Test Loss: 0.813 Test Acc: 0.903
Validation loss decreased (-0.805543 --> -0.902770).  Saving model ...
Epoch: 5 cost time: 1.2737412452697754
Epoch: 5, Steps: 7 | Train Loss: 0.501 Vali Loss: 0.553 Vali Acc: 0.861 Test Loss: 0.553 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0312714576721191
Epoch: 6, Steps: 7 | Train Loss: 0.227 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2613677978515625
Epoch: 7, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.285 Vali Acc: 0.958 Test Loss: 0.285 Test Acc: 0.958
Validation loss decreased (-0.902770 --> -0.958330).  Saving model ...
Epoch: 8 cost time: 1.0743985176086426
Epoch: 8, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0661253929138184
Epoch: 9, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9233574867248535
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0512783527374268
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0937471389770508
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0730564594268799
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 1.157113790512085
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.9575135707855225
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 1.0946745872497559
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.9574332237243652
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1660823822021484
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 1.148946762084961
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 1.0199675559997559
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 1.058182954788208
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.064162254333496
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.0557518005371094
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 1.2187960147857666
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 1.0929265022277832
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 1.0181670188903809
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1973066329956055
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0412869453430176
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3035516738891602
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 0.9613394737243652
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 31 cost time: 1.2003083229064941
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 32 cost time: 0.990086555480957
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 33 cost time: 1.1707136631011963
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 34 cost time: 1.124295711517334
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 35 cost time: 1.118462324142456
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 1.1063079833984375
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 0.9406821727752686
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 38 cost time: 1.0161361694335938
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 1.0131080150604248
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 0.9778282642364502
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.9699969291687012
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 1.0074870586395264
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1001617908477783
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.079920768737793
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0894510746002197
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 1.2277367115020752
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 1.0988891124725342
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 1.2450051307678223
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 1.0213558673858643
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 1.3056681156158447
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 51 cost time: 1.3084628582000732
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 52 cost time: 1.15047287940979
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2563345432281494
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.210242509841919
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 55 cost time: 1.2633781433105469
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 56 cost time: 1.2023491859436035
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0487871170043945
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.1618638038635254
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.2698357105255127
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.2414836883544922
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.0729186534881592
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.2216465473175049
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.2207884788513184
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.286970853805542
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.1080255508422852
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 225676
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df256_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3607609272003174
Epoch: 1, Steps: 7 | Train Loss: 2.571 Vali Loss: 2.452 Vali Acc: 0.181 Test Loss: 2.452 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.8020548820495605
Epoch: 2, Steps: 7 | Train Loss: 2.301 Vali Loss: 2.091 Vali Acc: 0.528 Test Loss: 2.091 Test Acc: 0.528
Validation loss decreased (-0.180531 --> -0.527757).  Saving model ...
Epoch: 3 cost time: 0.8013074398040771
Epoch: 3, Steps: 7 | Train Loss: 1.731 Vali Loss: 1.616 Vali Acc: 0.708 Test Loss: 1.616 Test Acc: 0.708
Validation loss decreased (-0.527757 --> -0.708317).  Saving model ...
Epoch: 4 cost time: 1.0020878314971924
Epoch: 4, Steps: 7 | Train Loss: 1.198 Vali Loss: 1.150 Vali Acc: 0.806 Test Loss: 1.150 Test Acc: 0.806
Validation loss decreased (-0.708317 --> -0.805544).  Saving model ...
Epoch: 5 cost time: 0.9303889274597168
Epoch: 5, Steps: 7 | Train Loss: 0.722 Vali Loss: 0.783 Vali Acc: 0.875 Test Loss: 0.783 Test Acc: 0.875
Validation loss decreased (-0.805544 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.8216962814331055
Epoch: 6, Steps: 7 | Train Loss: 0.414 Vali Loss: 0.564 Vali Acc: 0.861 Test Loss: 0.564 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8808715343475342
Epoch: 7, Steps: 7 | Train Loss: 0.204 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.8525605201721191
Epoch: 8, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.8571665287017822
Epoch: 9, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.8219594955444336
Epoch: 10, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8888325691223145
Epoch: 11, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9257214069366455
Epoch: 12, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.8981833457946777
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.8582096099853516
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.8757448196411133
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.8734538555145264
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.9602339267730713
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9543285369873047
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.7946393489837646
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.8903460502624512
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.020512342453003
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.9524087905883789
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.9658172130584717
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 24 cost time: 0.9095802307128906
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9597682952880859
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7923083305358887
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9237735271453857
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8168540000915527
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0163495540618896
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 30 cost time: 0.9236524105072021
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 31 cost time: 0.782604455947876
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 32 cost time: 0.8274331092834473
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 33 cost time: 0.9449527263641357
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 34 cost time: 0.9605352878570557
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 35 cost time: 0.9055018424987793
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 36 cost time: 0.9127752780914307
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8238930702209473
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9697275161743164
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 39 cost time: 0.9273293018341064
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 40 cost time: 0.9211006164550781
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 41 cost time: 0.8445394039154053
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.903 Test Loss: 0.218 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8652818202972412
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 43 cost time: 0.8117890357971191
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9342877864837646
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 45 cost time: 0.822777509689331
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.903 Test Loss: 0.214 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 46 cost time: 0.8545444011688232
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8682849407196045
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 48 cost time: 0.8946125507354736
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 49 cost time: 0.9342882633209229
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0484960079193115
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 51 cost time: 0.7974791526794434
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.903 Test Loss: 0.211 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9100956916809082
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9260296821594238
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.903 Test Loss: 0.211 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.8448400497436523
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.903 Test Loss: 0.211 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.8596453666687012
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.903 Test Loss: 0.211 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.845454216003418
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 57 cost time: 0.7707087993621826
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9343409538269043
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.903 Test Loss: 0.209 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 59 cost time: 0.8169355392456055
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.903 Test Loss: 0.207 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 60 cost time: 0.9391810894012451
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.903 Test Loss: 0.208 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8533673286437988
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.903 Test Loss: 0.206 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 62 cost time: 0.8951542377471924
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.903 Test Loss: 0.205 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 63 cost time: 0.927682638168335
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.903 Test Loss: 0.205 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.9302170276641846
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.903 Test Loss: 0.206 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.0001888275146484
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.903 Test Loss: 0.205 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8521361351013184
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.903 Test Loss: 0.205 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 67 cost time: 0.8327021598815918
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.903 Test Loss: 0.204 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 68 cost time: 0.8544566631317139
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.903 Test Loss: 0.205 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9701414108276367
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.903 Test Loss: 0.204 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 70 cost time: 0.8280754089355469
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.903 Test Loss: 0.203 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 71 cost time: 0.881462574005127
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.903 Test Loss: 0.202 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 72 cost time: 0.8923501968383789
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.903 Test Loss: 0.203 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.0243916511535645
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 74 cost time: 0.8823287487030029
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.903 Test Loss: 0.202 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.8218953609466553
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.9410324096679688
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.9251129627227783
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 78 cost time: 0.8098828792572021
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.9220070838928223
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 80 cost time: 0.8745388984680176
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.8841660022735596
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.9392862319946289
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.903 Test Loss: 0.202 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.8333635330200195
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.903 Test Loss: 0.202 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.9435040950775146
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 85 cost time: 0.9576289653778076
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 86 cost time: 0.8631346225738525
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.903 Test Loss: 0.198 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 87 cost time: 0.8826103210449219
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.8372447490692139
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.903 Test Loss: 0.199 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 0.8928751945495605
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.903 Test Loss: 0.198 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.8967230319976807
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.903 Test Loss: 0.198 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 0.877241849899292
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.903 Test Loss: 0.199 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 0.8555960655212402
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.903 Test Loss: 0.199 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 0.9048788547515869
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 0.9060158729553223
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 0.863837718963623
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 96 cost time: 0.8112127780914307
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.903 Test Loss: 0.202 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df256_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 195340
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5414888858795166
Epoch: 1, Steps: 7 | Train Loss: 2.570 Vali Loss: 2.499 Vali Acc: 0.125 Test Loss: 2.499 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.8070154190063477
Epoch: 2, Steps: 7 | Train Loss: 2.336 Vali Loss: 2.200 Vali Acc: 0.306 Test Loss: 2.200 Test Acc: 0.306
Validation loss decreased (-0.124975 --> -0.305534).  Saving model ...
Epoch: 3 cost time: 0.8441848754882812
Epoch: 3, Steps: 7 | Train Loss: 1.896 Vali Loss: 1.797 Vali Acc: 0.542 Test Loss: 1.797 Test Acc: 0.542
Validation loss decreased (-0.305534 --> -0.541649).  Saving model ...
Epoch: 4 cost time: 0.8621847629547119
Epoch: 4, Steps: 7 | Train Loss: 1.468 Vali Loss: 1.379 Vali Acc: 0.750 Test Loss: 1.379 Test Acc: 0.750
Validation loss decreased (-0.541649 --> -0.749986).  Saving model ...
Epoch: 5 cost time: 0.9164581298828125
Epoch: 5, Steps: 7 | Train Loss: 1.034 Vali Loss: 0.986 Vali Acc: 0.833 Test Loss: 0.986 Test Acc: 0.833
Validation loss decreased (-0.749986 --> -0.833323).  Saving model ...
Epoch: 6 cost time: 0.846705436706543
Epoch: 6, Steps: 7 | Train Loss: 0.604 Vali Loss: 0.703 Vali Acc: 0.833 Test Loss: 0.703 Test Acc: 0.833
Validation loss decreased (-0.833323 --> -0.833326).  Saving model ...
Epoch: 7 cost time: 0.8923852443695068
Epoch: 7, Steps: 7 | Train Loss: 0.387 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 0.9161107540130615
Epoch: 8, Steps: 7 | Train Loss: 0.215 Vali Loss: 0.439 Vali Acc: 0.847 Test Loss: 0.439 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8731374740600586
Epoch: 9, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.9902701377868652
Epoch: 10, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9167637825012207
Epoch: 11, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.9340198040008545
Epoch: 12, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9318222999572754
Epoch: 13, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8754875659942627
Epoch: 14, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9491820335388184
Epoch: 15, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8737835884094238
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.903980016708374
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.8829362392425537
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.9336757659912109
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.965139627456665
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.8484656810760498
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.823570966720581
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.8392119407653809
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.8497538566589355
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.8768284320831299
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.9332804679870605
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.8574023246765137
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.7606832981109619
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 29 cost time: 0.9067196846008301
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 30 cost time: 0.9090712070465088
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 31 cost time: 0.9838182926177979
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 32 cost time: 0.9362819194793701
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 33 cost time: 0.7670764923095703
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 34 cost time: 0.9735608100891113
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.902776 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.9323990345001221
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 36 cost time: 0.8785998821258545
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9030940532684326
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9577460289001465
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.903 Test Loss: 0.214 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.959601640701294
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.864048957824707
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8319087028503418
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8686752319335938
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0612719058990479
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.7855119705200195
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.903 Test Loss: 0.211 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.8576412200927734
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.903 Test Loss: 0.209 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 171532
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df256_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4258334636688232
Epoch: 1, Steps: 7 | Train Loss: 2.612 Vali Loss: 2.486 Vali Acc: 0.083 Test Loss: 2.486 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.725654125213623
Epoch: 2, Steps: 7 | Train Loss: 2.399 Vali Loss: 2.234 Vali Acc: 0.222 Test Loss: 2.234 Test Acc: 0.222
Validation loss decreased (-0.083308 --> -0.222200).  Saving model ...
Epoch: 3 cost time: 0.7823121547698975
Epoch: 3, Steps: 7 | Train Loss: 2.034 Vali Loss: 1.924 Vali Acc: 0.444 Test Loss: 1.924 Test Acc: 0.444
Validation loss decreased (-0.222200 --> -0.444425).  Saving model ...
Epoch: 4 cost time: 0.7719924449920654
Epoch: 4, Steps: 7 | Train Loss: 1.680 Vali Loss: 1.600 Vali Acc: 0.625 Test Loss: 1.600 Test Acc: 0.625
Validation loss decreased (-0.444425 --> -0.624984).  Saving model ...
Epoch: 5 cost time: 0.7638280391693115
Epoch: 5, Steps: 7 | Train Loss: 1.293 Vali Loss: 1.312 Vali Acc: 0.708 Test Loss: 1.312 Test Acc: 0.708
Validation loss decreased (-0.624984 --> -0.708320).  Saving model ...
Epoch: 6 cost time: 0.8141655921936035
Epoch: 6, Steps: 7 | Train Loss: 0.992 Vali Loss: 1.020 Vali Acc: 0.792 Test Loss: 1.020 Test Acc: 0.792
Validation loss decreased (-0.708320 --> -0.791656).  Saving model ...
Epoch: 7 cost time: 0.8339667320251465
Epoch: 7, Steps: 7 | Train Loss: 0.638 Vali Loss: 0.781 Vali Acc: 0.833 Test Loss: 0.781 Test Acc: 0.833
Validation loss decreased (-0.791656 --> -0.833326).  Saving model ...
Epoch: 8 cost time: 0.765235424041748
Epoch: 8, Steps: 7 | Train Loss: 0.427 Vali Loss: 0.607 Vali Acc: 0.889 Test Loss: 0.607 Test Acc: 0.889
Validation loss decreased (-0.833326 --> -0.888883).  Saving model ...
Epoch: 9 cost time: 0.8068156242370605
Epoch: 9, Steps: 7 | Train Loss: 0.279 Vali Loss: 0.493 Vali Acc: 0.903 Test Loss: 0.493 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902773).  Saving model ...
Epoch: 10 cost time: 0.7885177135467529
Epoch: 10, Steps: 7 | Train Loss: 0.183 Vali Loss: 0.426 Vali Acc: 0.889 Test Loss: 0.426 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7520120143890381
Epoch: 11, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8011584281921387
Epoch: 12, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8608369827270508
Epoch: 13, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.7547914981842041
Epoch: 14, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.8204095363616943
Epoch: 15, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.8236525058746338
Epoch: 16, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.7888839244842529
Epoch: 17, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.891045093536377
Epoch: 18, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.8648457527160645
Epoch: 19, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.9207367897033691
Epoch: 20, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.9001636505126953
Epoch: 21, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.833625078201294
Epoch: 22, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.9133286476135254
Epoch: 23, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.82539963722229
Epoch: 24, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.7467331886291504
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8983759880065918
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8857038021087646
Epoch: 27, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.8246099948883057
Epoch: 28, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.7273380756378174
Epoch: 29, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8104064464569092
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.9401965141296387
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.7753109931945801
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.7565944194793701
Epoch: 33, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.8453359603881836
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.7383742332458496
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.7445180416107178
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.8162708282470703
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.8077871799468994
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.9647645950317383
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.9850761890411377
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.9510765075683594
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7805008888244629
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8137092590332031
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7367699146270752
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.9220097064971924
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 1.01878023147583
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.8327896595001221
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.9022312164306641
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.7863643169403076
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8645675182342529
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 0.8026101589202881
Epoch: 51, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 0.902552604675293
Epoch: 52, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 0.7289175987243652
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.9130129814147949
Epoch: 54, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.792574405670166
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 56 cost time: 0.7613258361816406
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 57 cost time: 0.8671431541442871
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 58 cost time: 0.7644309997558594
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 59 cost time: 0.78084397315979
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 60 cost time: 0.8346855640411377
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 61 cost time: 0.6993288993835449
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8916738033294678
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 63 cost time: 0.7751655578613281
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.9746251106262207
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 65 cost time: 0.7480599880218506
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 66 cost time: 0.909130334854126
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 67 cost time: 0.8153109550476074
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.9070746898651123
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8549649715423584
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.8782801628112793
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 71 cost time: 0.8213675022125244
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 72 cost time: 0.8934314250946045
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 73 cost time: 0.7289614677429199
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.8679900169372559
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 75 cost time: 0.778411865234375
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8712160587310791
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 77 cost time: 0.8219943046569824
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 78 cost time: 0.8566803932189941
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 79 cost time: 0.8775928020477295
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 80 cost time: 0.8107502460479736
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.893202543258667
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.8429028987884521
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.8306055068969727
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 84 cost time: 0.8805556297302246
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 85 cost time: 0.7760007381439209
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 86 cost time: 0.7292687892913818
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.7850828170776367
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.7889492511749268
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 89 cost time: 0.9641497135162354
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.8127219676971436
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 91 cost time: 0.964489221572876
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.9166698455810547
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 93 cost time: 0.7974114418029785
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.8325800895690918
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.7966279983520508
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.7659616470336914
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 0.812863826751709
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 98 cost time: 0.8200738430023193
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.7752923965454102
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.7465171813964844
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df256_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 156940
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8591504096984863
Epoch: 1, Steps: 7 | Train Loss: 2.765 Vali Loss: 2.691 Vali Acc: 0.097 Test Loss: 2.691 Test Acc: 0.097
Validation loss decreased (inf --> -0.097195).  Saving model ...
Epoch: 2 cost time: 0.737938404083252
Epoch: 2, Steps: 7 | Train Loss: 2.596 Vali Loss: 2.470 Vali Acc: 0.222 Test Loss: 2.470 Test Acc: 0.222
Validation loss decreased (-0.097195 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 0.8534832000732422
Epoch: 3, Steps: 7 | Train Loss: 2.270 Vali Loss: 2.169 Vali Acc: 0.403 Test Loss: 2.169 Test Acc: 0.403
Validation loss decreased (-0.222198 --> -0.402756).  Saving model ...
Epoch: 4 cost time: 0.7634713649749756
Epoch: 4, Steps: 7 | Train Loss: 1.949 Vali Loss: 1.834 Vali Acc: 0.500 Test Loss: 1.834 Test Acc: 0.500
Validation loss decreased (-0.402756 --> -0.499982).  Saving model ...
Epoch: 5 cost time: 0.8198425769805908
Epoch: 5, Steps: 7 | Train Loss: 1.505 Vali Loss: 1.501 Vali Acc: 0.667 Test Loss: 1.501 Test Acc: 0.667
Validation loss decreased (-0.499982 --> -0.666652).  Saving model ...
Epoch: 6 cost time: 0.7075870037078857
Epoch: 6, Steps: 7 | Train Loss: 1.185 Vali Loss: 1.187 Vali Acc: 0.806 Test Loss: 1.187 Test Acc: 0.806
Validation loss decreased (-0.666652 --> -0.805544).  Saving model ...
Epoch: 7 cost time: 0.8093767166137695
Epoch: 7, Steps: 7 | Train Loss: 0.866 Vali Loss: 0.929 Vali Acc: 0.819 Test Loss: 0.929 Test Acc: 0.819
Validation loss decreased (-0.805544 --> -0.819435).  Saving model ...
Epoch: 8 cost time: 0.8461527824401855
Epoch: 8, Steps: 7 | Train Loss: 0.612 Vali Loss: 0.723 Vali Acc: 0.806 Test Loss: 0.723 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7174434661865234
Epoch: 9, Steps: 7 | Train Loss: 0.406 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
Validation loss decreased (-0.819435 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 0.8801398277282715
Epoch: 10, Steps: 7 | Train Loss: 0.284 Vali Loss: 0.519 Vali Acc: 0.833 Test Loss: 0.519 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 11 cost time: 0.7372951507568359
Epoch: 11, Steps: 7 | Train Loss: 0.198 Vali Loss: 0.450 Vali Acc: 0.819 Test Loss: 0.450 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6830282211303711
Epoch: 12, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.423 Vali Acc: 0.833 Test Loss: 0.423 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 0.8997154235839844
Epoch: 13, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.405 Vali Acc: 0.847 Test Loss: 0.405 Test Acc: 0.847
Validation loss decreased (-0.833329 --> -0.847218).  Saving model ...
Epoch: 14 cost time: 0.9107155799865723
Epoch: 14, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.385 Vali Acc: 0.847 Test Loss: 0.385 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 15 cost time: 0.7897086143493652
Epoch: 15, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.357 Vali Acc: 0.847 Test Loss: 0.357 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847219).  Saving model ...
Epoch: 16 cost time: 0.7846858501434326
Epoch: 16, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.344 Vali Acc: 0.847 Test Loss: 0.344 Test Acc: 0.847
Validation loss decreased (-0.847219 --> -0.847219).  Saving model ...
Epoch: 17 cost time: 0.6662917137145996
Epoch: 17, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.341 Vali Acc: 0.847 Test Loss: 0.341 Test Acc: 0.847
Validation loss decreased (-0.847219 --> -0.847219).  Saving model ...
Epoch: 18 cost time: 0.877600908279419
Epoch: 18, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.328 Vali Acc: 0.847 Test Loss: 0.328 Test Acc: 0.847
Validation loss decreased (-0.847219 --> -0.847219).  Saving model ...
Epoch: 19 cost time: 0.9002864360809326
Epoch: 19, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.319 Vali Acc: 0.861 Test Loss: 0.319 Test Acc: 0.861
Validation loss decreased (-0.847219 --> -0.861108).  Saving model ...
Epoch: 20 cost time: 0.7773103713989258
Epoch: 20, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 21 cost time: 0.8183043003082275
Epoch: 21, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 22 cost time: 0.712785005569458
Epoch: 22, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 23 cost time: 0.7309231758117676
Epoch: 23, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 24 cost time: 0.8220319747924805
Epoch: 24, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 25 cost time: 0.8420352935791016
Epoch: 25, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7525155544281006
Epoch: 26, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 27 cost time: 0.8912773132324219
Epoch: 27, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 28 cost time: 0.7198131084442139
Epoch: 28, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.282 Vali Acc: 0.861 Test Loss: 0.282 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 29 cost time: 0.7610750198364258
Epoch: 29, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8370773792266846
Epoch: 30, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7090809345245361
Epoch: 31, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.272 Vali Acc: 0.861 Test Loss: 0.272 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 32 cost time: 0.7089459896087646
Epoch: 32, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.267 Vali Acc: 0.875 Test Loss: 0.267 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 33 cost time: 0.8017621040344238
Epoch: 33, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.264 Vali Acc: 0.875 Test Loss: 0.264 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 34 cost time: 0.7273001670837402
Epoch: 34, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.267 Vali Acc: 0.861 Test Loss: 0.267 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9167709350585938
Epoch: 35, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.267 Vali Acc: 0.861 Test Loss: 0.267 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7057688236236572
Epoch: 36, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.266 Vali Acc: 0.861 Test Loss: 0.266 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7263011932373047
Epoch: 37, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.262 Vali Acc: 0.861 Test Loss: 0.262 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7175767421722412
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.261 Vali Acc: 0.861 Test Loss: 0.261 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6738169193267822
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.875 Test Loss: 0.257 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 40 cost time: 0.7467906475067139
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.875 Test Loss: 0.256 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 41 cost time: 0.7621452808380127
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.861 Test Loss: 0.258 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8273894786834717
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.259 Vali Acc: 0.861 Test Loss: 0.259 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9261291027069092
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.263 Vali Acc: 0.861 Test Loss: 0.263 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9153974056243896
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.861 Test Loss: 0.261 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8628458976745605
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.861 Test Loss: 0.259 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.8738088607788086
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.861 Test Loss: 0.256 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9786274433135986
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.861 Test Loss: 0.257 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7894473075866699
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.861 Test Loss: 0.257 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.899620771408081
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.861 Test Loss: 0.258 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.8495550155639648
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.861 Test Loss: 0.256 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 151564
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8665475845336914
Epoch: 1, Steps: 7 | Train Loss: 2.603 Vali Loss: 2.273 Vali Acc: 0.208 Test Loss: 2.273 Test Acc: 0.208
Validation loss decreased (inf --> -0.208311).  Saving model ...
Epoch: 2 cost time: 1.1004297733306885
Epoch: 2, Steps: 7 | Train Loss: 1.981 Vali Loss: 1.400 Vali Acc: 0.736 Test Loss: 1.400 Test Acc: 0.736
Validation loss decreased (-0.208311 --> -0.736097).  Saving model ...
Epoch: 3 cost time: 0.9429810047149658
Epoch: 3, Steps: 7 | Train Loss: 0.848 Vali Loss: 0.726 Vali Acc: 0.847 Test Loss: 0.726 Test Acc: 0.847
Validation loss decreased (-0.736097 --> -0.847215).  Saving model ...
Epoch: 4 cost time: 1.0403637886047363
Epoch: 4, Steps: 7 | Train Loss: 0.267 Vali Loss: 0.448 Vali Acc: 0.931 Test Loss: 0.448 Test Acc: 0.931
Validation loss decreased (-0.847215 --> -0.930551).  Saving model ...
Epoch: 5 cost time: 1.2445764541625977
Epoch: 5, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.391 Vali Acc: 0.903 Test Loss: 0.391 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.120894432067871
Epoch: 6, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 1.2272486686706543
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0874030590057373
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.9936225414276123
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0776455402374268
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0562140941619873
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0030229091644287
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0563671588897705
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.091482162475586
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9856467247009277
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1418755054473877
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0353798866271973
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.97141432762146
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1365418434143066
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0385348796844482
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0964767932891846
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0690577030181885
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.078115463256836
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1413493156433105
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0250473022460938
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0428225994110107
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.090507984161377
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 433036
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0934348106384277
Epoch: 1, Steps: 7 | Train Loss: 2.574 Vali Loss: 2.356 Vali Acc: 0.208 Test Loss: 2.356 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 1.1981899738311768
Epoch: 2, Steps: 7 | Train Loss: 2.013 Vali Loss: 1.686 Vali Acc: 0.639 Test Loss: 1.686 Test Acc: 0.639
Validation loss decreased (-0.208310 --> -0.638872).  Saving model ...
Epoch: 3 cost time: 1.061352252960205
Epoch: 3, Steps: 7 | Train Loss: 1.340 Vali Loss: 1.033 Vali Acc: 0.833 Test Loss: 1.033 Test Acc: 0.833
Validation loss decreased (-0.638872 --> -0.833323).  Saving model ...
Epoch: 4 cost time: 1.2111034393310547
Epoch: 4, Steps: 7 | Train Loss: 0.642 Vali Loss: 0.720 Vali Acc: 0.847 Test Loss: 0.720 Test Acc: 0.847
Validation loss decreased (-0.833323 --> -0.847215).  Saving model ...
Epoch: 5 cost time: 1.1764576435089111
Epoch: 5, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.437 Vali Acc: 0.917 Test Loss: 0.437 Test Acc: 0.917
Validation loss decreased (-0.847215 --> -0.916662).  Saving model ...
Epoch: 6 cost time: 1.0991835594177246
Epoch: 6, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.1932144165039062
Epoch: 7, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.1722891330718994
Epoch: 8, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9819488525390625
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.320549726486206
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.198948860168457
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.2042622566223145
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.3017265796661377
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.2174856662750244
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.1435258388519287
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 1.270218849182129
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 1.2495009899139404
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 1.2277436256408691
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.12294340133667
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.123016119003296
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2417776584625244
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.1808497905731201
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.2653453350067139
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 1.1583614349365234
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 1.029503583908081
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 1.311549186706543
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.194525957107544
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2804875373840332
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2855215072631836
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2903964519500732
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1518564224243164
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 1.1739380359649658
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 1.2559397220611572
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 1.1965274810791016
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1989262104034424
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.037912130355835
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 1.206925392150879
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 1.1510648727416992
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 1.1994516849517822
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2082397937774658
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 1.1757042407989502
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.043428659439087
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 1.325225591659546
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 1.2117900848388672
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 1.1933722496032715
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1790857315063477
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2807071208953857
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 1.2787723541259766
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 1.0169739723205566
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 1.2839183807373047
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 51 cost time: 0.9357035160064697
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 52 cost time: 1.0332961082458496
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9127616882324219
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.040827751159668
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.0316050052642822
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 56 cost time: 1.0285239219665527
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0236287117004395
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 58 cost time: 1.2909433841705322
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 59 cost time: 1.214613437652588
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 60 cost time: 1.2413547039031982
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 61 cost time: 1.2081944942474365
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 62 cost time: 1.0716373920440674
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 63 cost time: 1.0523040294647217
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.125720739364624
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 65 cost time: 1.1709115505218506
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 66 cost time: 1.097419261932373
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 67 cost time: 1.1314029693603516
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.0824215412139893
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.143885612487793
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.049894094467163
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.2475054264068604
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.137528896331787
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.9916093349456787
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.1840860843658447
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.1940228939056396
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.0027830600738525
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 77 cost time: 1.1451966762542725
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 78 cost time: 1.1846842765808105
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 79 cost time: 1.1817805767059326
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 80 cost time: 0.9386601448059082
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 81 cost time: 1.0973145961761475
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 82 cost time: 1.0550622940063477
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.1546368598937988
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.1943519115447998
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.0934650897979736
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 1.1281554698944092
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 87 cost time: 1.104736089706421
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 88 cost time: 1.1391627788543701
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 89 cost time: 1.1725435256958008
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.1080141067504883
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.9657163619995117
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.2181484699249268
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.1887762546539307
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 1.0912857055664062
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 1.0452611446380615
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 0.9970338344573975
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 0.9591434001922607
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 98 cost time: 0.9512219429016113
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 99 cost time: 1.0084214210510254
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 100 cost time: 0.9583361148834229
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 250636
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.905992031097412
Epoch: 1, Steps: 7 | Train Loss: 2.563 Vali Loss: 2.376 Vali Acc: 0.194 Test Loss: 2.376 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 0.9950776100158691
Epoch: 2, Steps: 7 | Train Loss: 2.232 Vali Loss: 1.912 Vali Acc: 0.583 Test Loss: 1.912 Test Acc: 0.583
Validation loss decreased (-0.194421 --> -0.583314).  Saving model ...
Epoch: 3 cost time: 1.138279914855957
Epoch: 3, Steps: 7 | Train Loss: 1.591 Vali Loss: 1.325 Vali Acc: 0.778 Test Loss: 1.325 Test Acc: 0.778
Validation loss decreased (-0.583314 --> -0.777765).  Saving model ...
Epoch: 4 cost time: 1.0659313201904297
Epoch: 4, Steps: 7 | Train Loss: 1.036 Vali Loss: 0.825 Vali Acc: 0.875 Test Loss: 0.825 Test Acc: 0.875
Validation loss decreased (-0.777765 --> -0.874992).  Saving model ...
Epoch: 5 cost time: 0.9995162487030029
Epoch: 5, Steps: 7 | Train Loss: 0.517 Vali Loss: 0.562 Vali Acc: 0.889 Test Loss: 0.562 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 1.1355328559875488
Epoch: 6, Steps: 7 | Train Loss: 0.244 Vali Loss: 0.374 Vali Acc: 0.903 Test Loss: 0.374 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.0368921756744385
Epoch: 7, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.0488178730010986
Epoch: 8, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.9159805774688721
Epoch: 9, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.334413766860962
Epoch: 10, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.122121810913086
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.141366720199585
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.2217257022857666
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.117114782333374
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2830784320831299
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 1.203730821609497
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0650653839111328
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.154759407043457
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2607407569885254
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.0048089027404785
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1244328022003174
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1322267055511475
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 0.9988961219787598
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1874642372131348
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 1.0985705852508545
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 1.1285960674285889
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2484824657440186
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 1.0871732234954834
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.198991060256958
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1395812034606934
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0863285064697266
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0988459587097168
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1028764247894287
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0869765281677246
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.212134838104248
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1369524002075195
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0456979274749756
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 192652
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df128_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.713801860809326
Epoch: 1, Steps: 7 | Train Loss: 2.463 Vali Loss: 2.452 Vali Acc: 0.083 Test Loss: 2.452 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 0.7756166458129883
Epoch: 2, Steps: 7 | Train Loss: 2.229 Vali Loss: 2.049 Vali Acc: 0.486 Test Loss: 2.049 Test Acc: 0.486
Validation loss decreased (-0.083309 --> -0.486091).  Saving model ...
Epoch: 3 cost time: 0.8471336364746094
Epoch: 3, Steps: 7 | Train Loss: 1.673 Vali Loss: 1.573 Vali Acc: 0.694 Test Loss: 1.573 Test Acc: 0.694
Validation loss decreased (-0.486091 --> -0.694429).  Saving model ...
Epoch: 4 cost time: 0.8945951461791992
Epoch: 4, Steps: 7 | Train Loss: 1.113 Vali Loss: 1.149 Vali Acc: 0.750 Test Loss: 1.149 Test Acc: 0.750
Validation loss decreased (-0.694429 --> -0.749989).  Saving model ...
Epoch: 5 cost time: 0.8181850910186768
Epoch: 5, Steps: 7 | Train Loss: 0.694 Vali Loss: 0.783 Vali Acc: 0.806 Test Loss: 0.783 Test Acc: 0.806
Validation loss decreased (-0.749989 --> -0.805548).  Saving model ...
Epoch: 6 cost time: 0.7737712860107422
Epoch: 6, Steps: 7 | Train Loss: 0.388 Vali Loss: 0.602 Vali Acc: 0.819 Test Loss: 0.602 Test Acc: 0.819
Validation loss decreased (-0.805548 --> -0.819438).  Saving model ...
Epoch: 7 cost time: 0.8163900375366211
Epoch: 7, Steps: 7 | Train Loss: 0.202 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
Validation loss decreased (-0.819438 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.7928082942962646
Epoch: 8, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8497798442840576
Epoch: 9, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.370 Vali Acc: 0.847 Test Loss: 0.370 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8188424110412598
Epoch: 10, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9302253723144531
Epoch: 11, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.351 Vali Acc: 0.861 Test Loss: 0.351 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8493809700012207
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8412446975708008
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.779329776763916
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.7270665168762207
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.8378260135650635
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.8793678283691406
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.7705693244934082
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.7787816524505615
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.8804166316986084
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.7697803974151611
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.8250198364257812
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.7003674507141113
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.7430472373962402
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.7708253860473633
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.8444068431854248
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.7046918869018555
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.841317892074585
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.7160379886627197
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.9042963981628418
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 0.7711398601531982
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 0.8853328227996826
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8379983901977539
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8222818374633789
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 0.8112180233001709
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 0.6732661724090576
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 0.8107614517211914
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.721217155456543
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 0.7977361679077148
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 0.8323409557342529
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 41 cost time: 0.7722392082214355
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 0.8218710422515869
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 0.8306913375854492
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8152096271514893
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8155133724212646
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8692970275878906
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8261785507202148
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9098527431488037
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.889 Test Loss: 0.239 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 49 cost time: 0.8036940097808838
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888887).  Saving model ...
Epoch: 50 cost time: 0.7032415866851807
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 51 cost time: 0.8196394443511963
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 52 cost time: 0.8870880603790283
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7330472469329834
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.8268284797668457
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 55 cost time: 0.9235811233520508
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7973158359527588
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 57 cost time: 0.8548374176025391
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 58 cost time: 0.8438808917999268
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.889 Test Loss: 0.231 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 59 cost time: 0.8899936676025391
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.889 Test Loss: 0.230 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 60 cost time: 0.8347437381744385
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 61 cost time: 0.8505053520202637
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.889 Test Loss: 0.227 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 62 cost time: 0.8250727653503418
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.889 Test Loss: 0.228 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.865044355392456
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.889 Test Loss: 0.230 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.8143930435180664
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.889 Test Loss: 0.228 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.8107929229736328
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.889 Test Loss: 0.227 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 66 cost time: 0.7459580898284912
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.889 Test Loss: 0.226 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 67 cost time: 0.7327289581298828
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.889 Test Loss: 0.227 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.702580451965332
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.889 Test Loss: 0.227 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8436167240142822
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.889 Test Loss: 0.226 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 70 cost time: 0.8078503608703613
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.889 Test Loss: 0.226 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 71 cost time: 0.8511753082275391
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.889 Test Loss: 0.225 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 72 cost time: 0.7208645343780518
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.889 Test Loss: 0.225 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 73 cost time: 0.7647690773010254
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.889 Test Loss: 0.224 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 74 cost time: 0.8179645538330078
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.889 Test Loss: 0.223 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 75 cost time: 0.8745465278625488
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.889 Test Loss: 0.223 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 76 cost time: 0.9194521903991699
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.889 Test Loss: 0.222 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 77 cost time: 0.7839369773864746
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.889 Test Loss: 0.221 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 78 cost time: 0.7622427940368652
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.889 Test Loss: 0.222 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7811648845672607
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.889 Test Loss: 0.221 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.8260712623596191
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.889 Test Loss: 0.221 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 81 cost time: 0.7385942935943604
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.889 Test Loss: 0.220 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 82 cost time: 0.7703747749328613
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.889 Test Loss: 0.219 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 83 cost time: 0.7639501094818115
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.889 Test Loss: 0.219 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 84 cost time: 0.8645539283752441
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.889 Test Loss: 0.219 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 85 cost time: 0.9013783931732178
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.889 Test Loss: 0.219 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.8244385719299316
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.889 Test Loss: 0.219 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.8237252235412598
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.889 Test Loss: 0.220 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.8953726291656494
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.889 Test Loss: 0.221 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.906836748123169
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.889 Test Loss: 0.221 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 0.8704266548156738
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.889 Test Loss: 0.221 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 0.8712809085845947
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.889 Test Loss: 0.221 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 0.847679615020752
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.889 Test Loss: 0.221 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 0.8031909465789795
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.889 Test Loss: 0.220 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 0.853630542755127
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.889 Test Loss: 0.219 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df128_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 162316
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6915149688720703
Epoch: 1, Steps: 7 | Train Loss: 2.586 Vali Loss: 2.396 Vali Acc: 0.069 Test Loss: 2.396 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.7424209117889404
Epoch: 2, Steps: 7 | Train Loss: 2.313 Vali Loss: 2.139 Vali Acc: 0.306 Test Loss: 2.139 Test Acc: 0.306
Validation loss decreased (-0.069420 --> -0.305534).  Saving model ...
Epoch: 3 cost time: 0.8556883335113525
Epoch: 3, Steps: 7 | Train Loss: 1.900 Vali Loss: 1.783 Vali Acc: 0.681 Test Loss: 1.783 Test Acc: 0.681
Validation loss decreased (-0.305534 --> -0.680538).  Saving model ...
Epoch: 4 cost time: 0.8549289703369141
Epoch: 4, Steps: 7 | Train Loss: 1.522 Vali Loss: 1.394 Vali Acc: 0.750 Test Loss: 1.394 Test Acc: 0.750
Validation loss decreased (-0.680538 --> -0.749986).  Saving model ...
Epoch: 5 cost time: 0.7456614971160889
Epoch: 5, Steps: 7 | Train Loss: 1.095 Vali Loss: 1.034 Vali Acc: 0.833 Test Loss: 1.034 Test Acc: 0.833
Validation loss decreased (-0.749986 --> -0.833323).  Saving model ...
Epoch: 6 cost time: 0.773392915725708
Epoch: 6, Steps: 7 | Train Loss: 0.705 Vali Loss: 0.752 Vali Acc: 0.903 Test Loss: 0.752 Test Acc: 0.903
Validation loss decreased (-0.833323 --> -0.902770).  Saving model ...
Epoch: 7 cost time: 0.8612244129180908
Epoch: 7, Steps: 7 | Train Loss: 0.437 Vali Loss: 0.555 Vali Acc: 0.903 Test Loss: 0.555 Test Acc: 0.903
Validation loss decreased (-0.902770 --> -0.902772).  Saving model ...
Epoch: 8 cost time: 0.821307897567749
Epoch: 8, Steps: 7 | Train Loss: 0.234 Vali Loss: 0.418 Vali Acc: 0.931 Test Loss: 0.418 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930551).  Saving model ...
Epoch: 9 cost time: 0.7631363868713379
Epoch: 9, Steps: 7 | Train Loss: 0.146 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9737191200256348
Epoch: 10, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.76528000831604
Epoch: 11, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.7599804401397705
Epoch: 12, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8419697284698486
Epoch: 13, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9014277458190918
Epoch: 14, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.7393271923065186
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.7213678359985352
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8485627174377441
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8174185752868652
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7945003509521484
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.7695486545562744
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.7944834232330322
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.8124260902404785
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7855746746063232
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.7224264144897461
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7615728378295898
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7738757133483887
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8944742679595947
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8843863010406494
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8389713764190674
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7400782108306885
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8356673717498779
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.765519380569458
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.7621634006500244
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 34 cost time: 0.7915170192718506
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 35 cost time: 0.755321741104126
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
Validation loss decreased (-0.958332 --> -0.972220).  Saving model ...
Epoch: 36 cost time: 0.7014296054840088
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8055083751678467
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8374817371368408
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7927920818328857
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7254824638366699
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7813935279846191
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8781633377075195
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.8821885585784912
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972221).  Saving model ...
Epoch: 44 cost time: 0.8352324962615967
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 45 cost time: 0.8076310157775879
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 46 cost time: 0.8411009311676025
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 47 cost time: 0.8234865665435791
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.812389612197876
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8849198818206787
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8604929447174072
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.8439550399780273
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.817908525466919
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.8999497890472412
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.7719516754150391
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.8279430866241455
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 56 cost time: 0.7092423439025879
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 57 cost time: 0.8435237407684326
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 58 cost time: 0.7321972846984863
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 59 cost time: 0.8660976886749268
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 60 cost time: 0.7972922325134277
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 61 cost time: 0.8768658638000488
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 62 cost time: 0.8059463500976562
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7749741077423096
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.7733142375946045
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 65 cost time: 0.7830979824066162
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.844552755355835
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 67 cost time: 0.7920622825622559
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7150921821594238
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.7787086963653564
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 70 cost time: 0.830549955368042
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 71 cost time: 0.9202330112457275
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 72 cost time: 0.7723736763000488
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 73 cost time: 0.7086694240570068
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 74 cost time: 0.8553981781005859
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 75 cost time: 0.776024580001831
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 76 cost time: 0.802462100982666
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 77 cost time: 0.7656724452972412
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.7932384014129639
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.8777623176574707
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.813633918762207
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.972 Test Loss: 0.147 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 81 cost time: 0.791417121887207
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.972 Test Loss: 0.147 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 82 cost time: 0.8058013916015625
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.83744215965271
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.972 Test Loss: 0.147 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.8703014850616455
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.8168041706085205
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.972 Test Loss: 0.147 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.7598006725311279
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.972 Test Loss: 0.147 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.9581851959228516
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 88 cost time: 0.8569247722625732
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.9029538631439209
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.8267390727996826
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.972 Test Loss: 0.147 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 0.8220551013946533
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.972 Test Loss: 0.147 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 0.7815790176391602
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 0.7795181274414062
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 0.8331689834594727
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 0.7336082458496094
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 0.7820723056793213
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.972 Test Loss: 0.147 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 0.8270554542541504
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 98 cost time: 0.8161051273345947
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.972 Test Loss: 0.145 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 99 cost time: 0.8477275371551514
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 0.8652124404907227
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 138508
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df128_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6656882762908936
Epoch: 1, Steps: 7 | Train Loss: 2.503 Vali Loss: 2.381 Vali Acc: 0.181 Test Loss: 2.381 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 0.8344857692718506
Epoch: 2, Steps: 7 | Train Loss: 2.314 Vali Loss: 2.150 Vali Acc: 0.347 Test Loss: 2.150 Test Acc: 0.347
Validation loss decreased (-0.180532 --> -0.347201).  Saving model ...
Epoch: 3 cost time: 0.8264784812927246
Epoch: 3, Steps: 7 | Train Loss: 1.987 Vali Loss: 1.842 Vali Acc: 0.556 Test Loss: 1.842 Test Acc: 0.556
Validation loss decreased (-0.347201 --> -0.555537).  Saving model ...
Epoch: 4 cost time: 0.8963325023651123
Epoch: 4, Steps: 7 | Train Loss: 1.627 Vali Loss: 1.495 Vali Acc: 0.639 Test Loss: 1.495 Test Acc: 0.639
Validation loss decreased (-0.555537 --> -0.638874).  Saving model ...
Epoch: 5 cost time: 0.8567192554473877
Epoch: 5, Steps: 7 | Train Loss: 1.285 Vali Loss: 1.199 Vali Acc: 0.722 Test Loss: 1.199 Test Acc: 0.722
Validation loss decreased (-0.638874 --> -0.722210).  Saving model ...
Epoch: 6 cost time: 0.8249037265777588
Epoch: 6, Steps: 7 | Train Loss: 0.852 Vali Loss: 0.949 Vali Acc: 0.778 Test Loss: 0.949 Test Acc: 0.778
Validation loss decreased (-0.722210 --> -0.777768).  Saving model ...
Epoch: 7 cost time: 0.7823529243469238
Epoch: 7, Steps: 7 | Train Loss: 0.597 Vali Loss: 0.753 Vali Acc: 0.778 Test Loss: 0.753 Test Acc: 0.778
Validation loss decreased (-0.777768 --> -0.777770).  Saving model ...
Epoch: 8 cost time: 0.8477602005004883
Epoch: 8, Steps: 7 | Train Loss: 0.405 Vali Loss: 0.623 Vali Acc: 0.792 Test Loss: 0.623 Test Acc: 0.792
Validation loss decreased (-0.777770 --> -0.791660).  Saving model ...
Epoch: 9 cost time: 0.8654136657714844
Epoch: 9, Steps: 7 | Train Loss: 0.276 Vali Loss: 0.526 Vali Acc: 0.833 Test Loss: 0.526 Test Acc: 0.833
Validation loss decreased (-0.791660 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 0.855771541595459
Epoch: 10, Steps: 7 | Train Loss: 0.169 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 0.8468306064605713
Epoch: 11, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.431 Vali Acc: 0.847 Test Loss: 0.431 Test Acc: 0.847
Validation loss decreased (-0.833329 --> -0.847218).  Saving model ...
Epoch: 12 cost time: 0.7576134204864502
Epoch: 12, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 0.7604880332946777
Epoch: 13, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 14 cost time: 0.6961269378662109
Epoch: 14, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 15 cost time: 0.7412447929382324
Epoch: 15, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 0.6892588138580322
Epoch: 16, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.743793249130249
Epoch: 17, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.7583270072937012
Epoch: 18, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916663).  Saving model ...
Epoch: 19 cost time: 0.8757915496826172
Epoch: 19, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.8433630466461182
Epoch: 20, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.8940885066986084
Epoch: 21, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.8308811187744141
Epoch: 22, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.8323452472686768
Epoch: 23, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.7508072853088379
Epoch: 24, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9273436069488525
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7594821453094482
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9319968223571777
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.8008477687835693
Epoch: 28, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.8864750862121582
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.830949068069458
Epoch: 30, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.8993074893951416
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.8823068141937256
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.8534574508666992
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.9035122394561768
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.8516252040863037
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.7777500152587891
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.908560037612915
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.8832552433013916
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.8331186771392822
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.8187847137451172
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.8007209300994873
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.8909015655517578
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.770979642868042
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.847104549407959
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.8984780311584473
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.7883217334747314
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.7541282176971436
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.7594456672668457
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.8219707012176514
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.7419147491455078
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 0.8075146675109863
Epoch: 51, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6779193878173828
Epoch: 52, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7342016696929932
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.8051719665527344
Epoch: 54, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 0.9170749187469482
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 0.7809467315673828
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 0.791874885559082
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 0.8016705513000488
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 0.9578626155853271
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7927606105804443
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 0.8789346218109131
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7927091121673584
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.8414554595947266
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 64 cost time: 0.8425724506378174
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.799485445022583
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.8214678764343262
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 67 cost time: 0.7875454425811768
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8217206001281738
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8845312595367432
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.8368146419525146
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.7712388038635254
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.8164081573486328
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.9414265155792236
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.8061649799346924
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.9830551147460938
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.7764120101928711
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df128_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 123916
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.586589813232422
Epoch: 1, Steps: 7 | Train Loss: 2.734 Vali Loss: 2.675 Vali Acc: 0.111 Test Loss: 2.675 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 0.8069357872009277
Epoch: 2, Steps: 7 | Train Loss: 2.544 Vali Loss: 2.416 Vali Acc: 0.250 Test Loss: 2.416 Test Acc: 0.250
Validation loss decreased (-0.111084 --> -0.249976).  Saving model ...
Epoch: 3 cost time: 0.7094001770019531
Epoch: 3, Steps: 7 | Train Loss: 2.237 Vali Loss: 2.086 Vali Acc: 0.417 Test Loss: 2.086 Test Acc: 0.417
Validation loss decreased (-0.249976 --> -0.416646).  Saving model ...
Epoch: 4 cost time: 0.9045274257659912
Epoch: 4, Steps: 7 | Train Loss: 1.903 Vali Loss: 1.751 Vali Acc: 0.639 Test Loss: 1.751 Test Acc: 0.639
Validation loss decreased (-0.416646 --> -0.638871).  Saving model ...
Epoch: 5 cost time: 0.7593293190002441
Epoch: 5, Steps: 7 | Train Loss: 1.505 Vali Loss: 1.434 Vali Acc: 0.722 Test Loss: 1.434 Test Acc: 0.722
Validation loss decreased (-0.638871 --> -0.722208).  Saving model ...
Epoch: 6 cost time: 0.8059766292572021
Epoch: 6, Steps: 7 | Train Loss: 1.141 Vali Loss: 1.156 Vali Acc: 0.819 Test Loss: 1.156 Test Acc: 0.819
Validation loss decreased (-0.722208 --> -0.819433).  Saving model ...
Epoch: 7 cost time: 0.7685282230377197
Epoch: 7, Steps: 7 | Train Loss: 0.833 Vali Loss: 0.922 Vali Acc: 0.847 Test Loss: 0.922 Test Acc: 0.847
Validation loss decreased (-0.819433 --> -0.847213).  Saving model ...
Epoch: 8 cost time: 0.8343560695648193
Epoch: 8, Steps: 7 | Train Loss: 0.598 Vali Loss: 0.715 Vali Acc: 0.903 Test Loss: 0.715 Test Acc: 0.903
Validation loss decreased (-0.847213 --> -0.902771).  Saving model ...
Epoch: 9 cost time: 0.9019665718078613
Epoch: 9, Steps: 7 | Train Loss: 0.422 Vali Loss: 0.575 Vali Acc: 0.903 Test Loss: 0.575 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902772).  Saving model ...
Epoch: 10 cost time: 0.7825782299041748
Epoch: 10, Steps: 7 | Train Loss: 0.267 Vali Loss: 0.481 Vali Acc: 0.889 Test Loss: 0.481 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8490850925445557
Epoch: 11, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.423 Vali Acc: 0.903 Test Loss: 0.423 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.9964642524719238
Epoch: 12, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.385 Vali Acc: 0.889 Test Loss: 0.385 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8541841506958008
Epoch: 13, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8167014122009277
Epoch: 14, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8067283630371094
Epoch: 15, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8768022060394287
Epoch: 16, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0113751888275146
Epoch: 17, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9982044696807861
Epoch: 18, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8051986694335938
Epoch: 19, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8774406909942627
Epoch: 20, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8532254695892334
Epoch: 21, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 118540
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0479044914245605
Epoch: 1, Steps: 7 | Train Loss: 2.466 Vali Loss: 2.222 Vali Acc: 0.194 Test Loss: 2.222 Test Acc: 0.194
Validation loss decreased (inf --> -0.194422).  Saving model ...
Epoch: 2 cost time: 1.2735815048217773
Epoch: 2, Steps: 7 | Train Loss: 1.872 Vali Loss: 1.369 Vali Acc: 0.750 Test Loss: 1.369 Test Acc: 0.750
Validation loss decreased (-0.194422 --> -0.749986).  Saving model ...
Epoch: 3 cost time: 1.3015224933624268
Epoch: 3, Steps: 7 | Train Loss: 0.797 Vali Loss: 0.654 Vali Acc: 0.889 Test Loss: 0.654 Test Acc: 0.889
Validation loss decreased (-0.749986 --> -0.888882).  Saving model ...
Epoch: 4 cost time: 1.3441193103790283
Epoch: 4, Steps: 7 | Train Loss: 0.259 Vali Loss: 0.529 Vali Acc: 0.875 Test Loss: 0.529 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2052865028381348
Epoch: 5, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.316 Vali Acc: 0.931 Test Loss: 0.316 Test Acc: 0.931
Validation loss decreased (-0.888882 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 1.3919446468353271
Epoch: 6, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.534661054611206
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 1.2215712070465088
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958331).  Saving model ...
Epoch: 9 cost time: 1.3072314262390137
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.400543212890625
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4787943363189697
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.253629207611084
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3706209659576416
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.443559169769287
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3471617698669434
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.307734727859497
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1906061172485352
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3501670360565186
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 416524
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.9258618354797363
Epoch: 1, Steps: 7 | Train Loss: 2.543 Vali Loss: 2.299 Vali Acc: 0.208 Test Loss: 2.299 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 1.0276494026184082
Epoch: 2, Steps: 7 | Train Loss: 1.993 Vali Loss: 1.673 Vali Acc: 0.472 Test Loss: 1.673 Test Acc: 0.472
Validation loss decreased (-0.208310 --> -0.472205).  Saving model ...
Epoch: 3 cost time: 1.1394774913787842
Epoch: 3, Steps: 7 | Train Loss: 1.198 Vali Loss: 1.007 Vali Acc: 0.778 Test Loss: 1.007 Test Acc: 0.778
Validation loss decreased (-0.472205 --> -0.777768).  Saving model ...
Epoch: 4 cost time: 1.1879777908325195
Epoch: 4, Steps: 7 | Train Loss: 0.607 Vali Loss: 0.634 Vali Acc: 0.847 Test Loss: 0.634 Test Acc: 0.847
Validation loss decreased (-0.777768 --> -0.847216).  Saving model ...
Epoch: 5 cost time: 1.2441861629486084
Epoch: 5, Steps: 7 | Train Loss: 0.238 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
Validation loss decreased (-0.847216 --> -0.847217).  Saving model ...
Epoch: 6 cost time: 1.0873422622680664
Epoch: 6, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.406 Vali Acc: 0.847 Test Loss: 0.406 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847218).  Saving model ...
Epoch: 7 cost time: 1.19455885887146
Epoch: 7, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
Validation loss decreased (-0.847218 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.3437347412109375
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.208055019378662
Epoch: 9, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.0179939270019531
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.2516660690307617
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.0271589756011963
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.977440357208252
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1071207523345947
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.9789564609527588
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.2001721858978271
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.1633455753326416
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.1611428260803223
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3165597915649414
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0555236339569092
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.1239876747131348
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.0526087284088135
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.0587267875671387
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 1.0742733478546143
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.1062085628509521
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.0946202278137207
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.0488171577453613
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0991764068603516
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.0807385444641113
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.216123342514038
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.1751036643981934
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 1.1087069511413574
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 1.125678300857544
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.125175952911377
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 1.0591366291046143
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 1.0318832397460938
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1005356311798096
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2337126731872559
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.18923020362854
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1879076957702637
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1577081680297852
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2369978427886963
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0985820293426514
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0893564224243164
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2313122749328613
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 234124
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7459940910339355
Epoch: 1, Steps: 7 | Train Loss: 2.597 Vali Loss: 2.463 Vali Acc: 0.139 Test Loss: 2.463 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.9449546337127686
Epoch: 2, Steps: 7 | Train Loss: 2.288 Vali Loss: 1.973 Vali Acc: 0.500 Test Loss: 1.973 Test Acc: 0.500
Validation loss decreased (-0.138864 --> -0.499980).  Saving model ...
Epoch: 3 cost time: 0.9656152725219727
Epoch: 3, Steps: 7 | Train Loss: 1.659 Vali Loss: 1.381 Vali Acc: 0.764 Test Loss: 1.381 Test Acc: 0.764
Validation loss decreased (-0.499980 --> -0.763875).  Saving model ...
Epoch: 4 cost time: 0.9770116806030273
Epoch: 4, Steps: 7 | Train Loss: 0.967 Vali Loss: 0.889 Vali Acc: 0.806 Test Loss: 0.889 Test Acc: 0.806
Validation loss decreased (-0.763875 --> -0.805547).  Saving model ...
Epoch: 5 cost time: 1.1037321090698242
Epoch: 5, Steps: 7 | Train Loss: 0.526 Vali Loss: 0.636 Vali Acc: 0.847 Test Loss: 0.636 Test Acc: 0.847
Validation loss decreased (-0.805547 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 0.7220489978790283
Epoch: 6, Steps: 7 | Train Loss: 0.240 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
Validation loss decreased (-0.847216 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 1.342731237411499
Epoch: 7, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 1.1483652591705322
Epoch: 8, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.320 Vali Acc: 0.931 Test Loss: 0.320 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 1.2988004684448242
Epoch: 9, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2819604873657227
Epoch: 10, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.1338517665863037
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.387099027633667
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.3890173435211182
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.354212760925293
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4502108097076416
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.18741774559021
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.34781813621521
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.292996883392334
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.3384113311767578
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.1770317554473877
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.2670538425445557
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.270249366760254
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.1366145610809326
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 1.341050148010254
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3406851291656494
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.131094217300415
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2733643054962158
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2570815086364746
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.191091537475586
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1773107051849365
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2554714679718018
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.264479398727417
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.2892656326293945
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 176140
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df64_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.690511703491211
Epoch: 1, Steps: 7 | Train Loss: 2.610 Vali Loss: 2.476 Vali Acc: 0.111 Test Loss: 2.476 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.8057861328125
Epoch: 2, Steps: 7 | Train Loss: 2.281 Vali Loss: 2.079 Vali Acc: 0.403 Test Loss: 2.079 Test Acc: 0.403
Validation loss decreased (-0.111086 --> -0.402757).  Saving model ...
Epoch: 3 cost time: 0.7734384536743164
Epoch: 3, Steps: 7 | Train Loss: 1.774 Vali Loss: 1.584 Vali Acc: 0.639 Test Loss: 1.584 Test Acc: 0.639
Validation loss decreased (-0.402757 --> -0.638873).  Saving model ...
Epoch: 4 cost time: 0.8159637451171875
Epoch: 4, Steps: 7 | Train Loss: 1.198 Vali Loss: 1.160 Vali Acc: 0.736 Test Loss: 1.160 Test Acc: 0.736
Validation loss decreased (-0.638873 --> -0.736100).  Saving model ...
Epoch: 5 cost time: 0.9863040447235107
Epoch: 5, Steps: 7 | Train Loss: 0.728 Vali Loss: 0.812 Vali Acc: 0.833 Test Loss: 0.812 Test Acc: 0.833
Validation loss decreased (-0.736100 --> -0.833325).  Saving model ...
Epoch: 6 cost time: 0.8844671249389648
Epoch: 6, Steps: 7 | Train Loss: 0.399 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833327).  Saving model ...
Epoch: 7 cost time: 0.8335542678833008
Epoch: 7, Steps: 7 | Train Loss: 0.201 Vali Loss: 0.478 Vali Acc: 0.861 Test Loss: 0.478 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 0.8925402164459229
Epoch: 8, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.413 Vali Acc: 0.861 Test Loss: 0.413 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 9 cost time: 0.8872029781341553
Epoch: 9, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 0.8472700119018555
Epoch: 10, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.9019887447357178
Epoch: 11, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.7993385791778564
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.8350863456726074
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.8539137840270996
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.8670449256896973
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.787832498550415
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.8093552589416504
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7153189182281494
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.8893935680389404
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.8675336837768555
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.913585901260376
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7918746471405029
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.8126156330108643
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.793487548828125
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.9613659381866455
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.979698896408081
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8610312938690186
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9582970142364502
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7939455509185791
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.8964722156524658
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.858269453048706
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.9071741104125977
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.8047966957092285
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.7920560836791992
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.8073451519012451
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.825709342956543
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.7534170150756836
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.7790968418121338
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.803192138671875
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.9307024478912354
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.9171843528747559
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.9870712757110596
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8681745529174805
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.8451480865478516
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.8012421131134033
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.893622875213623
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.8172192573547363
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8674037456512451
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9984192848205566
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8854169845581055
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.8382396697998047
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.8086545467376709
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 53 cost time: 0.9113483428955078
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.7984342575073242
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.868802547454834
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.863882303237915
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.9174973964691162
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.782524824142456
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.7538301944732666
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.828568696975708
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.883141040802002
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.8125779628753662
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.8756988048553467
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.9341468811035156
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.8541154861450195
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df64_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 145804
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.652648448944092
Epoch: 1, Steps: 7 | Train Loss: 2.524 Vali Loss: 2.346 Vali Acc: 0.181 Test Loss: 2.346 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 0.7673649787902832
Epoch: 2, Steps: 7 | Train Loss: 2.241 Vali Loss: 2.044 Vali Acc: 0.458 Test Loss: 2.044 Test Acc: 0.458
Validation loss decreased (-0.180532 --> -0.458313).  Saving model ...
Epoch: 3 cost time: 0.8278772830963135
Epoch: 3, Steps: 7 | Train Loss: 1.867 Vali Loss: 1.667 Vali Acc: 0.681 Test Loss: 1.667 Test Acc: 0.681
Validation loss decreased (-0.458313 --> -0.680539).  Saving model ...
Epoch: 4 cost time: 0.8045785427093506
Epoch: 4, Steps: 7 | Train Loss: 1.413 Vali Loss: 1.287 Vali Acc: 0.750 Test Loss: 1.287 Test Acc: 0.750
Validation loss decreased (-0.680539 --> -0.749987).  Saving model ...
Epoch: 5 cost time: 0.8213813304901123
Epoch: 5, Steps: 7 | Train Loss: 0.953 Vali Loss: 0.940 Vali Acc: 0.819 Test Loss: 0.940 Test Acc: 0.819
Validation loss decreased (-0.749987 --> -0.819435).  Saving model ...
Epoch: 6 cost time: 0.8131952285766602
Epoch: 6, Steps: 7 | Train Loss: 0.640 Vali Loss: 0.683 Vali Acc: 0.833 Test Loss: 0.683 Test Acc: 0.833
Validation loss decreased (-0.819435 --> -0.833326).  Saving model ...
Epoch: 7 cost time: 0.7977278232574463
Epoch: 7, Steps: 7 | Train Loss: 0.388 Vali Loss: 0.548 Vali Acc: 0.903 Test Loss: 0.548 Test Acc: 0.903
Validation loss decreased (-0.833326 --> -0.902772).  Saving model ...
Epoch: 8 cost time: 1.0308868885040283
Epoch: 8, Steps: 7 | Train Loss: 0.219 Vali Loss: 0.432 Vali Acc: 0.917 Test Loss: 0.432 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916662).  Saving model ...
Epoch: 9 cost time: 0.754671573638916
Epoch: 9, Steps: 7 | Train Loss: 0.132 Vali Loss: 0.359 Vali Acc: 0.944 Test Loss: 0.359 Test Acc: 0.944
Validation loss decreased (-0.916662 --> -0.944441).  Saving model ...
Epoch: 10 cost time: 0.8436136245727539
Epoch: 10, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7978084087371826
Epoch: 11, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7783360481262207
Epoch: 12, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6863112449645996
Epoch: 13, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7215495109558105
Epoch: 14, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6927669048309326
Epoch: 15, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.847524881362915
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8168232440948486
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8469431400299072
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8368523120880127
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 121996
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df64_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.467378616333008
Epoch: 1, Steps: 7 | Train Loss: 2.701 Vali Loss: 2.488 Vali Acc: 0.111 Test Loss: 2.488 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.9018988609313965
Epoch: 2, Steps: 7 | Train Loss: 2.561 Vali Loss: 2.269 Vali Acc: 0.153 Test Loss: 2.269 Test Acc: 0.153
Validation loss decreased (-0.111086 --> -0.152755).  Saving model ...
Epoch: 3 cost time: 0.7888214588165283
Epoch: 3, Steps: 7 | Train Loss: 2.224 Vali Loss: 1.945 Vali Acc: 0.458 Test Loss: 1.945 Test Acc: 0.458
Validation loss decreased (-0.152755 --> -0.458314).  Saving model ...
Epoch: 4 cost time: 0.8578181266784668
Epoch: 4, Steps: 7 | Train Loss: 1.758 Vali Loss: 1.578 Vali Acc: 0.736 Test Loss: 1.578 Test Acc: 0.736
Validation loss decreased (-0.458314 --> -0.736095).  Saving model ...
Epoch: 5 cost time: 0.8103361129760742
Epoch: 5, Steps: 7 | Train Loss: 1.370 Vali Loss: 1.239 Vali Acc: 0.847 Test Loss: 1.239 Test Acc: 0.847
Validation loss decreased (-0.736095 --> -0.847210).  Saving model ...
Epoch: 6 cost time: 0.8250324726104736
Epoch: 6, Steps: 7 | Train Loss: 0.983 Vali Loss: 0.955 Vali Acc: 0.889 Test Loss: 0.955 Test Acc: 0.889
Validation loss decreased (-0.847210 --> -0.888879).  Saving model ...
Epoch: 7 cost time: 0.8694508075714111
Epoch: 7, Steps: 7 | Train Loss: 0.690 Vali Loss: 0.734 Vali Acc: 0.917 Test Loss: 0.734 Test Acc: 0.917
Validation loss decreased (-0.888879 --> -0.916659).  Saving model ...
Epoch: 8 cost time: 0.8648128509521484
Epoch: 8, Steps: 7 | Train Loss: 0.456 Vali Loss: 0.572 Vali Acc: 0.889 Test Loss: 0.572 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8390913009643555
Epoch: 9, Steps: 7 | Train Loss: 0.264 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9064865112304688
Epoch: 10, Steps: 7 | Train Loss: 0.188 Vali Loss: 0.434 Vali Acc: 0.847 Test Loss: 0.434 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8349118232727051
Epoch: 11, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8629415035247803
Epoch: 12, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.364 Vali Acc: 0.847 Test Loss: 0.364 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8388223648071289
Epoch: 13, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7940220832824707
Epoch: 14, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7572226524353027
Epoch: 15, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8098783493041992
Epoch: 16, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8229031562805176
Epoch: 17, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df64_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 107404
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2558839321136475
Epoch: 1, Steps: 7 | Train Loss: 2.587 Vali Loss: 2.623 Vali Acc: 0.167 Test Loss: 2.623 Test Acc: 0.167
Validation loss decreased (inf --> -0.166640).  Saving model ...
Epoch: 2 cost time: 0.7153866291046143
Epoch: 2, Steps: 7 | Train Loss: 2.398 Vali Loss: 2.400 Vali Acc: 0.222 Test Loss: 2.400 Test Acc: 0.222
Validation loss decreased (-0.166640 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 0.7622973918914795
Epoch: 3, Steps: 7 | Train Loss: 2.106 Vali Loss: 2.101 Vali Acc: 0.375 Test Loss: 2.101 Test Acc: 0.375
Validation loss decreased (-0.222198 --> -0.374979).  Saving model ...
Epoch: 4 cost time: 0.8103597164154053
Epoch: 4, Steps: 7 | Train Loss: 1.793 Vali Loss: 1.784 Vali Acc: 0.514 Test Loss: 1.784 Test Acc: 0.514
Validation loss decreased (-0.374979 --> -0.513871).  Saving model ...
Epoch: 5 cost time: 0.66371750831604
Epoch: 5, Steps: 7 | Train Loss: 1.434 Vali Loss: 1.472 Vali Acc: 0.667 Test Loss: 1.472 Test Acc: 0.667
Validation loss decreased (-0.513871 --> -0.666652).  Saving model ...
Epoch: 6 cost time: 0.700676679611206
Epoch: 6, Steps: 7 | Train Loss: 1.101 Vali Loss: 1.184 Vali Acc: 0.792 Test Loss: 1.184 Test Acc: 0.792
Validation loss decreased (-0.666652 --> -0.791655).  Saving model ...
Epoch: 7 cost time: 0.8047780990600586
Epoch: 7, Steps: 7 | Train Loss: 0.800 Vali Loss: 0.943 Vali Acc: 0.833 Test Loss: 0.943 Test Acc: 0.833
Validation loss decreased (-0.791655 --> -0.833324).  Saving model ...
Epoch: 8 cost time: 0.7076001167297363
Epoch: 8, Steps: 7 | Train Loss: 0.561 Vali Loss: 0.770 Vali Acc: 0.833 Test Loss: 0.770 Test Acc: 0.833
Validation loss decreased (-0.833324 --> -0.833326).  Saving model ...
Epoch: 9 cost time: 0.7461330890655518
Epoch: 9, Steps: 7 | Train Loss: 0.392 Vali Loss: 0.635 Vali Acc: 0.819 Test Loss: 0.635 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7888538837432861
Epoch: 10, Steps: 7 | Train Loss: 0.291 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833328).  Saving model ...
Epoch: 11 cost time: 0.7503054141998291
Epoch: 11, Steps: 7 | Train Loss: 0.183 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
Validation loss decreased (-0.833328 --> -0.861106).  Saving model ...
Epoch: 12 cost time: 0.7538051605224609
Epoch: 12, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.439 Vali Acc: 0.861 Test Loss: 0.439 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 0.7336511611938477
Epoch: 13, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.413 Vali Acc: 0.861 Test Loss: 0.413 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 0.7192068099975586
Epoch: 14, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.393 Vali Acc: 0.861 Test Loss: 0.393 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 0.7396128177642822
Epoch: 15, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.375 Vali Acc: 0.861 Test Loss: 0.375 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 16 cost time: 0.7419247627258301
Epoch: 16, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.368 Vali Acc: 0.861 Test Loss: 0.368 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 17 cost time: 0.7414298057556152
Epoch: 17, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.370 Vali Acc: 0.861 Test Loss: 0.370 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8056309223175049
Epoch: 18, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.361 Vali Acc: 0.861 Test Loss: 0.361 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 0.7005321979522705
Epoch: 19, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.355 Vali Acc: 0.861 Test Loss: 0.355 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 20 cost time: 0.8425631523132324
Epoch: 20, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.345 Vali Acc: 0.861 Test Loss: 0.345 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 21 cost time: 0.7012002468109131
Epoch: 21, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 22 cost time: 0.7682921886444092
Epoch: 22, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 23 cost time: 0.7501442432403564
Epoch: 23, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.338 Vali Acc: 0.861 Test Loss: 0.338 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8997287750244141
Epoch: 24, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.336 Vali Acc: 0.861 Test Loss: 0.336 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 25 cost time: 0.7500126361846924
Epoch: 25, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 26 cost time: 0.7901420593261719
Epoch: 26, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 27 cost time: 0.7906439304351807
Epoch: 27, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 28 cost time: 0.8199329376220703
Epoch: 28, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 29 cost time: 0.7651665210723877
Epoch: 29, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.320 Vali Acc: 0.875 Test Loss: 0.320 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 30 cost time: 0.7433793544769287
Epoch: 30, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 31 cost time: 0.9637861251831055
Epoch: 31, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 32 cost time: 0.8148860931396484
Epoch: 32, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 33 cost time: 0.8975870609283447
Epoch: 33, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8603000640869141
Epoch: 34, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 35 cost time: 0.7268273830413818
Epoch: 35, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 36 cost time: 0.785193920135498
Epoch: 36, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 37 cost time: 0.844463586807251
Epoch: 37, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 38 cost time: 0.7813677787780762
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 39 cost time: 0.8163869380950928
Epoch: 39, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 40 cost time: 0.8116762638092041
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 41 cost time: 0.6878082752227783
Epoch: 41, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 42 cost time: 0.712134838104248
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 43 cost time: 0.7221436500549316
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 44 cost time: 0.7183220386505127
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 45 cost time: 0.8047168254852295
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7280843257904053
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8270590305328369
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7040798664093018
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 49 cost time: 0.6496732234954834
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8294482231140137
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8114652633666992
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 52 cost time: 0.8233258724212646
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 53 cost time: 0.7145845890045166
Epoch: 53, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 54 cost time: 0.7660458087921143
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 55 cost time: 0.9157795906066895
Epoch: 55, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 56 cost time: 0.7395763397216797
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 57 cost time: 0.7630536556243896
Epoch: 57, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 58 cost time: 0.7686102390289307
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8012111186981201
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.819331169128418
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 61 cost time: 0.8013584613800049
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.875 Test Loss: 0.280 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 62 cost time: 0.7549002170562744
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.793724536895752
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.875 Test Loss: 0.280 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 64 cost time: 0.7471222877502441
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.875 Test Loss: 0.277 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 65 cost time: 0.8068878650665283
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.875 Test Loss: 0.280 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7679417133331299
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.8434031009674072
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.8685674667358398
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.875 Test Loss: 0.277 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 69 cost time: 0.8422298431396484
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 70 cost time: 0.8555569648742676
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7988991737365723
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.813338041305542
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.9009609222412109
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 74 cost time: 0.8527827262878418
Epoch: 74, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.9051897525787354
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 76 cost time: 0.7591762542724609
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 77 cost time: 0.747913122177124
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.875 Test Loss: 0.273 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.8028595447540283
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 79 cost time: 0.8159427642822266
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 80 cost time: 0.7850995063781738
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 81 cost time: 0.7727136611938477
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 82 cost time: 0.7782590389251709
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 83 cost time: 0.8107635974884033
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.7375023365020752
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.8995702266693115
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.8091797828674316
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.8166186809539795
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.8038153648376465
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 0.7493650913238525
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 0.7447443008422852
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 0.794694185256958
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 92 cost time: 0.8850669860839844
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.8452553749084473
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.8596060276031494
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 0.8439679145812988
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 0.7412285804748535
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 97 cost time: 0.9190232753753662
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.7790138721466064
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 99 cost time: 0.8214876651763916
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 0.8609859943389893
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm64_nh16_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 102028
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5957229137420654
Epoch: 1, Steps: 7 | Train Loss: 2.682 Vali Loss: 2.458 Vali Acc: 0.097 Test Loss: 2.458 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.9266357421875
Epoch: 2, Steps: 7 | Train Loss: 2.262 Vali Loss: 1.993 Vali Acc: 0.389 Test Loss: 1.993 Test Acc: 0.389
Validation loss decreased (-0.097198 --> -0.388869).  Saving model ...
Epoch: 3 cost time: 0.8946640491485596
Epoch: 3, Steps: 7 | Train Loss: 1.582 Vali Loss: 1.379 Vali Acc: 0.764 Test Loss: 1.379 Test Acc: 0.764
Validation loss decreased (-0.388869 --> -0.763875).  Saving model ...
Epoch: 4 cost time: 0.8380029201507568
Epoch: 4, Steps: 7 | Train Loss: 0.922 Vali Loss: 0.894 Vali Acc: 0.861 Test Loss: 0.894 Test Acc: 0.861
Validation loss decreased (-0.763875 --> -0.861102).  Saving model ...
Epoch: 5 cost time: 1.00408935546875
Epoch: 5, Steps: 7 | Train Loss: 0.440 Vali Loss: 0.540 Vali Acc: 0.875 Test Loss: 0.540 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 0.9373981952667236
Epoch: 6, Steps: 7 | Train Loss: 0.175 Vali Loss: 0.448 Vali Acc: 0.903 Test Loss: 0.448 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902773).  Saving model ...
Epoch: 7 cost time: 0.928342342376709
Epoch: 7, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.326 Vali Acc: 0.931 Test Loss: 0.326 Test Acc: 0.931
Validation loss decreased (-0.902773 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 0.8168864250183105
Epoch: 8, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9044055938720703
Epoch: 9, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9399056434631348
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8642294406890869
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.8900485038757324
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.8236286640167236
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.797508716583252
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.8336849212646484
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.8470892906188965
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8934576511383057
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.817847490310669
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8714609146118164
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.9023025035858154
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.9184384346008301
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8636689186096191
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.8588414192199707
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.8961308002471924
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9093821048736572
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.9258296489715576
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.9273600578308105
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 0.836371660232544
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0400185585021973
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9770119190216064
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.8274109363555908
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.9707193374633789
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.856783390045166
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.879047155380249
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.8793914318084717
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.8845479488372803
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.9425044059753418
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.8184726238250732
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.9128437042236328
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8057858943939209
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.9187514781951904
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.9131839275360107
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.9231011867523193
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.842383623123169
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.860755205154419
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8483090400695801
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8688035011291504
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9127664566040039
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.8406603336334229
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.9038975238800049
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.8531494140625
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.9068524837493896
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.8638472557067871
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 225100
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.533637523651123
Epoch: 1, Steps: 7 | Train Loss: 2.548 Vali Loss: 2.506 Vali Acc: 0.153 Test Loss: 2.506 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.7577860355377197
Epoch: 2, Steps: 7 | Train Loss: 2.294 Vali Loss: 2.144 Vali Acc: 0.403 Test Loss: 2.144 Test Acc: 0.403
Validation loss decreased (-0.152753 --> -0.402756).  Saving model ...
Epoch: 3 cost time: 0.7570507526397705
Epoch: 3, Steps: 7 | Train Loss: 1.838 Vali Loss: 1.707 Vali Acc: 0.653 Test Loss: 1.707 Test Acc: 0.653
Validation loss decreased (-0.402756 --> -0.652761).  Saving model ...
Epoch: 4 cost time: 0.7124133110046387
Epoch: 4, Steps: 7 | Train Loss: 1.305 Vali Loss: 1.241 Vali Acc: 0.819 Test Loss: 1.241 Test Acc: 0.819
Validation loss decreased (-0.652761 --> -0.819432).  Saving model ...
Epoch: 5 cost time: 0.7934942245483398
Epoch: 5, Steps: 7 | Train Loss: 0.868 Vali Loss: 0.883 Vali Acc: 0.847 Test Loss: 0.883 Test Acc: 0.847
Validation loss decreased (-0.819432 --> -0.847213).  Saving model ...
Epoch: 6 cost time: 0.7712409496307373
Epoch: 6, Steps: 7 | Train Loss: 0.461 Vali Loss: 0.616 Vali Acc: 0.847 Test Loss: 0.616 Test Acc: 0.847
Validation loss decreased (-0.847213 --> -0.847216).  Saving model ...
Epoch: 7 cost time: 0.863525390625
Epoch: 7, Steps: 7 | Train Loss: 0.253 Vali Loss: 0.422 Vali Acc: 0.917 Test Loss: 0.422 Test Acc: 0.917
Validation loss decreased (-0.847216 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 0.8788092136383057
Epoch: 8, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.351 Vali Acc: 0.917 Test Loss: 0.351 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.831916332244873
Epoch: 9, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.914379358291626
Epoch: 10, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9240000247955322
Epoch: 11, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.8238630294799805
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.8069179058074951
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.8706667423248291
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.829312801361084
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.8566544055938721
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.7716419696807861
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.7682628631591797
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.8926563262939453
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.8874053955078125
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.8736593723297119
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.7702693939208984
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9312698841094971
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.778339147567749
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.9001047611236572
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.843111515045166
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8272898197174072
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9366638660430908
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.9391074180603027
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.7964375019073486
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.9426639080047607
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8838820457458496
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.892650842666626
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.8359389305114746
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.9309182167053223
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.9066698551177979
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.9360129833221436
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.8031258583068848
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.8043227195739746
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.8070478439331055
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.8182327747344971
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7745697498321533
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7993917465209961
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.9441237449645996
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.8147852420806885
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.7646894454956055
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.8919944763183594
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9801068305969238
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8866143226623535
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.8541345596313477
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.878605842590332
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.8672130107879639
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 0.8654980659484863
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.930401086807251
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.8635106086730957
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8616125583648682
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.8069562911987305
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8995604515075684
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 0.8355860710144043
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9623949527740479
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.7821483612060547
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 62 cost time: 0.767634391784668
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8013203144073486
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.8549885749816895
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 65 cost time: 0.8080580234527588
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.8048386573791504
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 67 cost time: 1.0018396377563477
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 68 cost time: 0.893326997756958
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.8893313407897949
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.8752148151397705
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.8951139450073242
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.8558804988861084
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.9418232440948486
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.9377567768096924
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.865577220916748
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.8143882751464844
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.9556005001068115
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 133900
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4220569133758545
Epoch: 1, Steps: 7 | Train Loss: 2.488 Vali Loss: 2.456 Vali Acc: 0.167 Test Loss: 2.456 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 0.6929891109466553
Epoch: 2, Steps: 7 | Train Loss: 2.311 Vali Loss: 2.192 Vali Acc: 0.347 Test Loss: 2.192 Test Acc: 0.347
Validation loss decreased (-0.166642 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 0.8715507984161377
Epoch: 3, Steps: 7 | Train Loss: 1.946 Vali Loss: 1.829 Vali Acc: 0.583 Test Loss: 1.829 Test Acc: 0.583
Validation loss decreased (-0.347200 --> -0.583315).  Saving model ...
Epoch: 4 cost time: 0.7673807144165039
Epoch: 4, Steps: 7 | Train Loss: 1.547 Vali Loss: 1.442 Vali Acc: 0.764 Test Loss: 1.442 Test Acc: 0.764
Validation loss decreased (-0.583315 --> -0.763874).  Saving model ...
Epoch: 5 cost time: 0.8241519927978516
Epoch: 5, Steps: 7 | Train Loss: 1.058 Vali Loss: 1.088 Vali Acc: 0.778 Test Loss: 1.088 Test Acc: 0.778
Validation loss decreased (-0.763874 --> -0.777767).  Saving model ...
Epoch: 6 cost time: 0.6889181137084961
Epoch: 6, Steps: 7 | Train Loss: 0.726 Vali Loss: 0.798 Vali Acc: 0.778 Test Loss: 0.798 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777770).  Saving model ...
Epoch: 7 cost time: 0.7193818092346191
Epoch: 7, Steps: 7 | Train Loss: 0.420 Vali Loss: 0.591 Vali Acc: 0.847 Test Loss: 0.591 Test Acc: 0.847
Validation loss decreased (-0.777770 --> -0.847216).  Saving model ...
Epoch: 8 cost time: 0.7797951698303223
Epoch: 8, Steps: 7 | Train Loss: 0.236 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
Validation loss decreased (-0.847216 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 0.7399983406066895
Epoch: 9, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.420 Vali Acc: 0.861 Test Loss: 0.420 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8460323810577393
Epoch: 10, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 0.9125876426696777
Epoch: 11, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 0.7616331577301025
Epoch: 12, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.8416941165924072
Epoch: 13, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.8080313205718994
Epoch: 14, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.7912507057189941
Epoch: 15, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7739286422729492
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8167078495025635
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8132963180541992
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7894277572631836
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8089027404785156
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7298266887664795
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8168025016784668
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8015320301055908
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.764249324798584
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 104908
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df256_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.525904893875122
Epoch: 1, Steps: 7 | Train Loss: 2.618 Vali Loss: 2.505 Vali Acc: 0.042 Test Loss: 2.505 Test Acc: 0.042
Validation loss decreased (inf --> -0.041642).  Saving model ...
Epoch: 2 cost time: 0.7753808498382568
Epoch: 2, Steps: 7 | Train Loss: 2.406 Vali Loss: 2.253 Vali Acc: 0.278 Test Loss: 2.253 Test Acc: 0.278
Validation loss decreased (-0.041642 --> -0.277755).  Saving model ...
Epoch: 3 cost time: 0.9118602275848389
Epoch: 3, Steps: 7 | Train Loss: 2.118 Vali Loss: 1.909 Vali Acc: 0.514 Test Loss: 1.909 Test Acc: 0.514
Validation loss decreased (-0.277755 --> -0.513870).  Saving model ...
Epoch: 4 cost time: 0.848996639251709
Epoch: 4, Steps: 7 | Train Loss: 1.739 Vali Loss: 1.553 Vali Acc: 0.681 Test Loss: 1.553 Test Acc: 0.681
Validation loss decreased (-0.513870 --> -0.680540).  Saving model ...
Epoch: 5 cost time: 0.7707245349884033
Epoch: 5, Steps: 7 | Train Loss: 1.335 Vali Loss: 1.226 Vali Acc: 0.806 Test Loss: 1.226 Test Acc: 0.806
Validation loss decreased (-0.680540 --> -0.805543).  Saving model ...
Epoch: 6 cost time: 0.8661961555480957
Epoch: 6, Steps: 7 | Train Loss: 0.938 Vali Loss: 0.936 Vali Acc: 0.806 Test Loss: 0.936 Test Acc: 0.806
Validation loss decreased (-0.805543 --> -0.805546).  Saving model ...
Epoch: 7 cost time: 0.790184736251831
Epoch: 7, Steps: 7 | Train Loss: 0.631 Vali Loss: 0.701 Vali Acc: 0.875 Test Loss: 0.701 Test Acc: 0.875
Validation loss decreased (-0.805546 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 0.8380610942840576
Epoch: 8, Steps: 7 | Train Loss: 0.410 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7985420227050781
Epoch: 9, Steps: 7 | Train Loss: 0.253 Vali Loss: 0.464 Vali Acc: 0.889 Test Loss: 0.464 Test Acc: 0.889
Validation loss decreased (-0.874993 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 0.9004101753234863
Epoch: 10, Steps: 7 | Train Loss: 0.167 Vali Loss: 0.408 Vali Acc: 0.889 Test Loss: 0.408 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 0.7719252109527588
Epoch: 11, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.374 Vali Acc: 0.903 Test Loss: 0.374 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.7670035362243652
Epoch: 12, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 0.7838423252105713
Epoch: 13, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.8142592906951904
Epoch: 14, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.8780632019042969
Epoch: 15, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.8488013744354248
Epoch: 16, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7808136940002441
Epoch: 17, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8798134326934814
Epoch: 18, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.8925948143005371
Epoch: 19, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.826977014541626
Epoch: 20, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.8564028739929199
Epoch: 21, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.9123916625976562
Epoch: 22, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.8505380153656006
Epoch: 23, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.861565351486206
Epoch: 24, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.8602480888366699
Epoch: 25, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.8448145389556885
Epoch: 26, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.7643036842346191
Epoch: 27, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.776923418045044
Epoch: 28, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.7788295745849609
Epoch: 29, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.8592729568481445
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.818556547164917
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.8711678981781006
Epoch: 32, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.8725471496582031
Epoch: 33, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.7805600166320801
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.8910484313964844
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.8098995685577393
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.8546748161315918
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.8300323486328125
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.8849034309387207
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.8000664710998535
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.8636569976806641
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.8718643188476562
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.8347094058990479
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.8726577758789062
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.8052883148193359
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.890984058380127
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.782334566116333
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.8188605308532715
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.8168761730194092
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8477902412414551
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.8041908740997314
Epoch: 51, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.7831499576568604
Epoch: 52, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8119850158691406
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.832040548324585
Epoch: 54, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 55 cost time: 0.8609945774078369
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9283208847045898
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 57 cost time: 0.9287252426147461
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 58 cost time: 0.7801029682159424
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 59 cost time: 0.7657530307769775
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 60 cost time: 0.8388965129852295
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 61 cost time: 0.8773927688598633
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 62 cost time: 0.7975904941558838
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.9003024101257324
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.9394731521606445
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.0261187553405762
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.9767336845397949
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 67 cost time: 0.8364050388336182
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 68 cost time: 0.9912562370300293
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9196076393127441
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.9056296348571777
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 71 cost time: 0.8414888381958008
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 72 cost time: 0.7617111206054688
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.913041353225708
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.903 Test Loss: 0.218 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 74 cost time: 0.8801858425140381
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.903 Test Loss: 0.214 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 75 cost time: 0.8614349365234375
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 76 cost time: 0.8769519329071045
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.902776 --> -0.916665).  Saving model ...
Epoch: 77 cost time: 0.918525218963623
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.8382940292358398
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 79 cost time: 0.8513154983520508
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.8893544673919678
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.903 Test Loss: 0.211 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.9232187271118164
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.8497202396392822
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.8327014446258545
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.903 Test Loss: 0.209 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.932837724685669
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.8466942310333252
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 86 cost time: 0.9082527160644531
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 87 cost time: 0.9578397274017334
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 88 cost time: 0.9241950511932373
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.9335975646972656
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.8803880214691162
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 0.8461408615112305
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 0.9367990493774414
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.903 Test Loss: 0.209 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 0.9371888637542725
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 0.8621604442596436
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.903 Test Loss: 0.209 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 0.8649559020996094
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.903 Test Loss: 0.209 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 0.9285686016082764
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 97 cost time: 0.8732235431671143
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 98 cost time: 0.7873580455780029
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.8328812122344971
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 100 cost time: 0.8820152282714844
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df256_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 89740
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3839519023895264
Epoch: 1, Steps: 7 | Train Loss: 2.672 Vali Loss: 2.532 Vali Acc: 0.069 Test Loss: 2.532 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.7084059715270996
Epoch: 2, Steps: 7 | Train Loss: 2.586 Vali Loss: 2.382 Vali Acc: 0.208 Test Loss: 2.382 Test Acc: 0.208
Validation loss decreased (-0.069419 --> -0.208310).  Saving model ...
Epoch: 3 cost time: 0.6388678550720215
Epoch: 3, Steps: 7 | Train Loss: 2.276 Vali Loss: 2.157 Vali Acc: 0.458 Test Loss: 2.157 Test Acc: 0.458
Validation loss decreased (-0.208310 --> -0.458312).  Saving model ...
Epoch: 4 cost time: 0.77488112449646
Epoch: 4, Steps: 7 | Train Loss: 2.040 Vali Loss: 1.902 Vali Acc: 0.556 Test Loss: 1.902 Test Acc: 0.556
Validation loss decreased (-0.458312 --> -0.555537).  Saving model ...
Epoch: 5 cost time: 0.8377189636230469
Epoch: 5, Steps: 7 | Train Loss: 1.650 Vali Loss: 1.621 Vali Acc: 0.681 Test Loss: 1.621 Test Acc: 0.681
Validation loss decreased (-0.555537 --> -0.680539).  Saving model ...
Epoch: 6 cost time: 0.809211015701294
Epoch: 6, Steps: 7 | Train Loss: 1.411 Vali Loss: 1.347 Vali Acc: 0.736 Test Loss: 1.347 Test Acc: 0.736
Validation loss decreased (-0.680539 --> -0.736098).  Saving model ...
Epoch: 7 cost time: 0.8237671852111816
Epoch: 7, Steps: 7 | Train Loss: 1.087 Vali Loss: 1.102 Vali Acc: 0.764 Test Loss: 1.102 Test Acc: 0.764
Validation loss decreased (-0.736098 --> -0.763878).  Saving model ...
Epoch: 8 cost time: 0.8456642627716064
Epoch: 8, Steps: 7 | Train Loss: 0.794 Vali Loss: 0.893 Vali Acc: 0.792 Test Loss: 0.893 Test Acc: 0.792
Validation loss decreased (-0.763878 --> -0.791658).  Saving model ...
Epoch: 9 cost time: 0.7634768486022949
Epoch: 9, Steps: 7 | Train Loss: 0.618 Vali Loss: 0.724 Vali Acc: 0.819 Test Loss: 0.724 Test Acc: 0.819
Validation loss decreased (-0.791658 --> -0.819437).  Saving model ...
Epoch: 10 cost time: 0.7634155750274658
Epoch: 10, Steps: 7 | Train Loss: 0.415 Vali Loss: 0.590 Vali Acc: 0.875 Test Loss: 0.590 Test Acc: 0.875
Validation loss decreased (-0.819437 --> -0.874994).  Saving model ...
Epoch: 11 cost time: 0.8330883979797363
Epoch: 11, Steps: 7 | Train Loss: 0.277 Vali Loss: 0.512 Vali Acc: 0.875 Test Loss: 0.512 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 12 cost time: 0.8251924514770508
Epoch: 12, Steps: 7 | Train Loss: 0.196 Vali Loss: 0.466 Vali Acc: 0.861 Test Loss: 0.466 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7203953266143799
Epoch: 13, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.447 Vali Acc: 0.847 Test Loss: 0.447 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7843031883239746
Epoch: 14, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.418 Vali Acc: 0.861 Test Loss: 0.418 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8693246841430664
Epoch: 15, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.387 Vali Acc: 0.889 Test Loss: 0.387 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 0.7238430976867676
Epoch: 16, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7744159698486328
Epoch: 17, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7771387100219727
Epoch: 18, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.80387282371521
Epoch: 19, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.362 Vali Acc: 0.847 Test Loss: 0.362 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.728651762008667
Epoch: 20, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7375278472900391
Epoch: 21, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7724835872650146
Epoch: 22, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.339 Vali Acc: 0.861 Test Loss: 0.339 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8087122440338135
Epoch: 23, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.335 Vali Acc: 0.861 Test Loss: 0.335 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7505037784576416
Epoch: 24, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.7919745445251465
Epoch: 25, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.874239444732666
Epoch: 26, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.8060214519500732
Epoch: 27, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.7907629013061523
Epoch: 28, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.8070659637451172
Epoch: 29, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.8447146415710449
Epoch: 30, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8000984191894531
Epoch: 31, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.9313182830810547
Epoch: 32, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.7809944152832031
Epoch: 33, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.7994232177734375
Epoch: 34, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.7831935882568359
Epoch: 35, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.8253908157348633
Epoch: 36, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.7348968982696533
Epoch: 37, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7551894187927246
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7964015007019043
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8151388168334961
Epoch: 40, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7309925556182861
Epoch: 41, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8113348484039307
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.8811237812042236
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.8372163772583008
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.8124918937683105
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8156664371490479
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7605957984924316
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.7992868423461914
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8325541019439697
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8394374847412109
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.8620128631591797
Epoch: 51, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.7477874755859375
Epoch: 52, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 0.8744354248046875
Epoch: 53, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8038771152496338
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.8324713706970215
Epoch: 55, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.8140785694122314
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 0.877439022064209
Epoch: 57, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 0.8199832439422607
Epoch: 58, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 0.7635655403137207
Epoch: 59, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 60 cost time: 0.752943754196167
Epoch: 60, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 0.8786361217498779
Epoch: 61, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8003876209259033
Epoch: 62, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.784937858581543
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 64 cost time: 0.890899658203125
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.847252368927002
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.8006582260131836
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.7942092418670654
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.9058876037597656
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.8459699153900146
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.8320581912994385
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.8134701251983643
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.8307061195373535
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.7156898975372314
Epoch: 73, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 77836
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df256_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4376959800720215
Epoch: 1, Steps: 7 | Train Loss: 2.702 Vali Loss: 2.556 Vali Acc: 0.042 Test Loss: 2.556 Test Acc: 0.042
Validation loss decreased (inf --> -0.041641).  Saving model ...
Epoch: 2 cost time: 0.787520170211792
Epoch: 2, Steps: 7 | Train Loss: 2.555 Vali Loss: 2.427 Vali Acc: 0.153 Test Loss: 2.427 Test Acc: 0.153
Validation loss decreased (-0.041641 --> -0.152754).  Saving model ...
Epoch: 3 cost time: 0.8082549571990967
Epoch: 3, Steps: 7 | Train Loss: 2.498 Vali Loss: 2.235 Vali Acc: 0.292 Test Loss: 2.235 Test Acc: 0.292
Validation loss decreased (-0.152754 --> -0.291644).  Saving model ...
Epoch: 4 cost time: 0.8470091819763184
Epoch: 4, Steps: 7 | Train Loss: 2.168 Vali Loss: 2.005 Vali Acc: 0.417 Test Loss: 2.005 Test Acc: 0.417
Validation loss decreased (-0.291644 --> -0.416647).  Saving model ...
Epoch: 5 cost time: 0.8340463638305664
Epoch: 5, Steps: 7 | Train Loss: 1.894 Vali Loss: 1.769 Vali Acc: 0.500 Test Loss: 1.769 Test Acc: 0.500
Validation loss decreased (-0.416647 --> -0.499982).  Saving model ...
Epoch: 6 cost time: 0.8942029476165771
Epoch: 6, Steps: 7 | Train Loss: 1.619 Vali Loss: 1.531 Vali Acc: 0.625 Test Loss: 1.531 Test Acc: 0.625
Validation loss decreased (-0.499982 --> -0.624985).  Saving model ...
Epoch: 7 cost time: 0.8884181976318359
Epoch: 7, Steps: 7 | Train Loss: 1.354 Vali Loss: 1.304 Vali Acc: 0.722 Test Loss: 1.304 Test Acc: 0.722
Validation loss decreased (-0.624985 --> -0.722209).  Saving model ...
Epoch: 8 cost time: 0.7515907287597656
Epoch: 8, Steps: 7 | Train Loss: 1.139 Vali Loss: 1.095 Vali Acc: 0.792 Test Loss: 1.095 Test Acc: 0.792
Validation loss decreased (-0.722209 --> -0.791656).  Saving model ...
Epoch: 9 cost time: 0.7805960178375244
Epoch: 9, Steps: 7 | Train Loss: 0.809 Vali Loss: 0.910 Vali Acc: 0.861 Test Loss: 0.910 Test Acc: 0.861
Validation loss decreased (-0.791656 --> -0.861102).  Saving model ...
Epoch: 10 cost time: 0.8031432628631592
Epoch: 10, Steps: 7 | Train Loss: 0.621 Vali Loss: 0.759 Vali Acc: 0.861 Test Loss: 0.759 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861104).  Saving model ...
Epoch: 11 cost time: 0.8852763175964355
Epoch: 11, Steps: 7 | Train Loss: 0.451 Vali Loss: 0.652 Vali Acc: 0.847 Test Loss: 0.652 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9598462581634521
Epoch: 12, Steps: 7 | Train Loss: 0.333 Vali Loss: 0.557 Vali Acc: 0.875 Test Loss: 0.557 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 0.9489338397979736
Epoch: 13, Steps: 7 | Train Loss: 0.244 Vali Loss: 0.498 Vali Acc: 0.889 Test Loss: 0.498 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888884).  Saving model ...
Epoch: 14 cost time: 0.8500854969024658
Epoch: 14, Steps: 7 | Train Loss: 0.198 Vali Loss: 0.453 Vali Acc: 0.875 Test Loss: 0.453 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8525636196136475
Epoch: 15, Steps: 7 | Train Loss: 0.152 Vali Loss: 0.429 Vali Acc: 0.861 Test Loss: 0.429 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8791909217834473
Epoch: 16, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 0.9622948169708252
Epoch: 17, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.390 Vali Acc: 0.889 Test Loss: 0.390 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 0.8851325511932373
Epoch: 18, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.373 Vali Acc: 0.917 Test Loss: 0.373 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 19 cost time: 0.8326082229614258
Epoch: 19, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 0.8444762229919434
Epoch: 20, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.343 Vali Acc: 0.917 Test Loss: 0.343 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 21 cost time: 0.8291120529174805
Epoch: 21, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8264875411987305
Epoch: 22, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8187730312347412
Epoch: 23, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 24 cost time: 0.8506813049316406
Epoch: 24, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 25 cost time: 0.809734582901001
Epoch: 25, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.8215482234954834
Epoch: 26, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.863680362701416
Epoch: 27, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8400349617004395
Epoch: 28, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8416032791137695
Epoch: 29, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8077282905578613
Epoch: 30, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8803384304046631
Epoch: 31, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8407974243164062
Epoch: 32, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7921175956726074
Epoch: 33, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.868952751159668
Epoch: 34, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.6522986888885498
Epoch: 35, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.8152732849121094
Epoch: 36, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.8003592491149902
Epoch: 37, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8967602252960205
Epoch: 38, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.8302690982818604
Epoch: 39, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.8555560111999512
Epoch: 40, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8278179168701172
Epoch: 41, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7155489921569824
Epoch: 42, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.916816234588623
Epoch: 43, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8862380981445312
Epoch: 44, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8229732513427734
Epoch: 45, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8293678760528564
Epoch: 46, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9706640243530273
Epoch: 47, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.8236098289489746
Epoch: 48, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8051445484161377
Epoch: 49, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df256_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 70540
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.339216709136963
Epoch: 1, Steps: 7 | Train Loss: 2.699 Vali Loss: 2.513 Vali Acc: 0.153 Test Loss: 2.513 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.746950626373291
Epoch: 2, Steps: 7 | Train Loss: 2.580 Vali Loss: 2.373 Vali Acc: 0.153 Test Loss: 2.373 Test Acc: 0.153
Validation loss decreased (-0.152753 --> -0.152754).  Saving model ...
Epoch: 3 cost time: 1.2282731533050537
Epoch: 3, Steps: 7 | Train Loss: 2.369 Vali Loss: 2.190 Vali Acc: 0.347 Test Loss: 2.190 Test Acc: 0.347
Validation loss decreased (-0.152754 --> -0.347200).  Saving model ...
Epoch: 4 cost time: 0.9085996150970459
Epoch: 4, Steps: 7 | Train Loss: 2.214 Vali Loss: 1.981 Vali Acc: 0.486 Test Loss: 1.981 Test Acc: 0.486
Validation loss decreased (-0.347200 --> -0.486091).  Saving model ...
Epoch: 5 cost time: 0.904198408126831
Epoch: 5, Steps: 7 | Train Loss: 1.941 Vali Loss: 1.766 Vali Acc: 0.597 Test Loss: 1.766 Test Acc: 0.597
Validation loss decreased (-0.486091 --> -0.597205).  Saving model ...
Epoch: 6 cost time: 0.8931179046630859
Epoch: 6, Steps: 7 | Train Loss: 1.679 Vali Loss: 1.548 Vali Acc: 0.722 Test Loss: 1.548 Test Acc: 0.722
Validation loss decreased (-0.597205 --> -0.722207).  Saving model ...
Epoch: 7 cost time: 0.8558504581451416
Epoch: 7, Steps: 7 | Train Loss: 1.420 Vali Loss: 1.343 Vali Acc: 0.750 Test Loss: 1.343 Test Acc: 0.750
Validation loss decreased (-0.722207 --> -0.749987).  Saving model ...
Epoch: 8 cost time: 0.8029956817626953
Epoch: 8, Steps: 7 | Train Loss: 1.156 Vali Loss: 1.149 Vali Acc: 0.792 Test Loss: 1.149 Test Acc: 0.792
Validation loss decreased (-0.749987 --> -0.791655).  Saving model ...
Epoch: 9 cost time: 0.8462355136871338
Epoch: 9, Steps: 7 | Train Loss: 0.959 Vali Loss: 0.979 Vali Acc: 0.806 Test Loss: 0.979 Test Acc: 0.806
Validation loss decreased (-0.791655 --> -0.805546).  Saving model ...
Epoch: 10 cost time: 0.9030613899230957
Epoch: 10, Steps: 7 | Train Loss: 0.782 Vali Loss: 0.827 Vali Acc: 0.861 Test Loss: 0.827 Test Acc: 0.861
Validation loss decreased (-0.805546 --> -0.861103).  Saving model ...
Epoch: 11 cost time: 0.873218297958374
Epoch: 11, Steps: 7 | Train Loss: 0.584 Vali Loss: 0.697 Vali Acc: 0.889 Test Loss: 0.697 Test Acc: 0.889
Validation loss decreased (-0.861103 --> -0.888882).  Saving model ...
Epoch: 12 cost time: 0.9085111618041992
Epoch: 12, Steps: 7 | Train Loss: 0.478 Vali Loss: 0.602 Vali Acc: 0.917 Test Loss: 0.602 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916661).  Saving model ...
Epoch: 13 cost time: 0.8392059803009033
Epoch: 13, Steps: 7 | Train Loss: 0.362 Vali Loss: 0.534 Vali Acc: 0.903 Test Loss: 0.534 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9347443580627441
Epoch: 14, Steps: 7 | Train Loss: 0.265 Vali Loss: 0.478 Vali Acc: 0.917 Test Loss: 0.478 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 15 cost time: 0.7502760887145996
Epoch: 15, Steps: 7 | Train Loss: 0.212 Vali Loss: 0.444 Vali Acc: 0.903 Test Loss: 0.444 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8772356510162354
Epoch: 16, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.418 Vali Acc: 0.903 Test Loss: 0.418 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7884900569915771
Epoch: 17, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8617467880249023
Epoch: 18, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9054028987884521
Epoch: 19, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9031574726104736
Epoch: 20, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8699214458465576
Epoch: 21, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 22 cost time: 0.8180882930755615
Epoch: 22, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 23 cost time: 0.8081314563751221
Epoch: 23, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8836698532104492
Epoch: 24, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8930025100708008
Epoch: 25, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0431733131408691
Epoch: 26, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8627514839172363
Epoch: 27, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8401684761047363
Epoch: 28, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8661956787109375
Epoch: 29, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9725668430328369
Epoch: 30, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9200279712677002
Epoch: 31, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9352602958679199
Epoch: 32, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 67852
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8031387329101562
Epoch: 1, Steps: 7 | Train Loss: 2.583 Vali Loss: 2.371 Vali Acc: 0.125 Test Loss: 2.371 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 0.9064719676971436
Epoch: 2, Steps: 7 | Train Loss: 2.199 Vali Loss: 1.848 Vali Acc: 0.556 Test Loss: 1.848 Test Acc: 0.556
Validation loss decreased (-0.124976 --> -0.555537).  Saving model ...
Epoch: 3 cost time: 0.9496281147003174
Epoch: 3, Steps: 7 | Train Loss: 1.483 Vali Loss: 1.233 Vali Acc: 0.847 Test Loss: 1.233 Test Acc: 0.847
Validation loss decreased (-0.555537 --> -0.847210).  Saving model ...
Epoch: 4 cost time: 1.0311942100524902
Epoch: 4, Steps: 7 | Train Loss: 0.874 Vali Loss: 0.779 Vali Acc: 0.889 Test Loss: 0.779 Test Acc: 0.889
Validation loss decreased (-0.847210 --> -0.888881).  Saving model ...
Epoch: 5 cost time: 0.9953851699829102
Epoch: 5, Steps: 7 | Train Loss: 0.444 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9578053951263428
Epoch: 6, Steps: 7 | Train Loss: 0.187 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
Validation loss decreased (-0.888881 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.080526351928711
Epoch: 7, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.0229301452636719
Epoch: 8, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0384438037872314
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.9092044830322266
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.0289866924285889
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 0.9903357028961182
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9800794124603271
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8994951248168945
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9006180763244629
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9983925819396973
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0135581493377686
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9694669246673584
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0721919536590576
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 0.9287114143371582
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.9385530948638916
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 1.045875072479248
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 1.0075218677520752
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0305938720703125
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.946129560470581
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8388044834136963
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0518267154693604
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9710793495178223
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0299561023712158
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.9297623634338379
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 1.026233434677124
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.966468095779419
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0229847431182861
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 1.0904104709625244
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 1.0149264335632324
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.9668982028961182
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.017709732055664
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0426194667816162
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9864563941955566
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9882609844207764
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9949662685394287
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0266995429992676
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0306482315063477
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.231752872467041
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 1.121429204940796
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.9470434188842773
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 1.163545846939087
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.9793500900268555
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 1.1176507472991943
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 1.0724542140960693
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0177302360534668
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.1033532619476318
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.084808349609375
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.9640779495239258
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.9751498699188232
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.8858151435852051
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 57 cost time: 1.0910851955413818
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 58 cost time: 1.0449950695037842
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.944 Test Loss: 0.153 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 59 cost time: 1.0307810306549072
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.0202226638793945
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.1017026901245117
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.0875933170318604
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.084540843963623
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.087465524673462
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.1264383792877197
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.0264267921447754
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.1411736011505127
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.1502573490142822
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 208460
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4916534423828125
Epoch: 1, Steps: 7 | Train Loss: 2.595 Vali Loss: 2.404 Vali Acc: 0.167 Test Loss: 2.404 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.759739875793457
Epoch: 2, Steps: 7 | Train Loss: 2.334 Vali Loss: 2.070 Vali Acc: 0.403 Test Loss: 2.070 Test Acc: 0.403
Validation loss decreased (-0.166643 --> -0.402757).  Saving model ...
Epoch: 3 cost time: 0.9008491039276123
Epoch: 3, Steps: 7 | Train Loss: 1.862 Vali Loss: 1.699 Vali Acc: 0.736 Test Loss: 1.699 Test Acc: 0.736
Validation loss decreased (-0.402757 --> -0.736094).  Saving model ...
Epoch: 4 cost time: 0.7551815509796143
Epoch: 4, Steps: 7 | Train Loss: 1.418 Vali Loss: 1.248 Vali Acc: 0.792 Test Loss: 1.248 Test Acc: 0.792
Validation loss decreased (-0.736094 --> -0.791654).  Saving model ...
Epoch: 5 cost time: 0.8251988887786865
Epoch: 5, Steps: 7 | Train Loss: 0.926 Vali Loss: 0.869 Vali Acc: 0.875 Test Loss: 0.869 Test Acc: 0.875
Validation loss decreased (-0.791654 --> -0.874991).  Saving model ...
Epoch: 6 cost time: 0.7405357360839844
Epoch: 6, Steps: 7 | Train Loss: 0.556 Vali Loss: 0.625 Vali Acc: 0.889 Test Loss: 0.625 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888883).  Saving model ...
Epoch: 7 cost time: 0.7261521816253662
Epoch: 7, Steps: 7 | Train Loss: 0.275 Vali Loss: 0.459 Vali Acc: 0.889 Test Loss: 0.459 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.8334169387817383
Epoch: 8, Steps: 7 | Train Loss: 0.152 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.7438607215881348
Epoch: 9, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7642321586608887
Epoch: 10, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.7861313819885254
Epoch: 11, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.8534176349639893
Epoch: 12, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.8099117279052734
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8598451614379883
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.8649110794067383
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.8072805404663086
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.7494444847106934
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.8857471942901611
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.7937695980072021
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.8325247764587402
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8329753875732422
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8378064632415771
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8786146640777588
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7936835289001465
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8138313293457031
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.7986888885498047
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.9233808517456055
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.8790225982666016
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8008089065551758
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.7811675071716309
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 31 cost time: 0.78959059715271
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 0.7978720664978027
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 0.9428772926330566
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 34 cost time: 0.866701602935791
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 0.8254110813140869
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 36 cost time: 0.7676129341125488
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 37 cost time: 0.8755831718444824
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7919371128082275
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8584754467010498
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 40 cost time: 0.8750128746032715
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 41 cost time: 0.7971756458282471
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 42 cost time: 0.8298687934875488
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 43 cost time: 0.7853806018829346
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8994874954223633
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.843888521194458
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8074846267700195
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.831470251083374
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8089926242828369
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.8399405479431152
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8348574638366699
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 51 cost time: 0.7460699081420898
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 52 cost time: 0.8398420810699463
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8163442611694336
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.7853193283081055
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.7249953746795654
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 56 cost time: 0.870065450668335
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 57 cost time: 0.7988154888153076
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 58 cost time: 0.8047769069671631
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 59 cost time: 0.8830013275146484
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 60 cost time: 0.8377845287322998
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 61 cost time: 0.8510761260986328
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 62 cost time: 0.7513599395751953
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7402858734130859
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.7738356590270996
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.7605204582214355
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.8047609329223633
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.8511958122253418
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.9058964252471924
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.8881096839904785
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 70 cost time: 0.7930469512939453
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 71 cost time: 0.7825236320495605
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 72 cost time: 0.8731601238250732
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.8068923950195312
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.8203814029693604
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 75 cost time: 0.7794890403747559
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.931 Test Loss: 0.177 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 76 cost time: 0.7480635643005371
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.931 Test Loss: 0.177 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 77 cost time: 0.8332395553588867
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.8281686305999756
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.931 Test Loss: 0.177 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.8082444667816162
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.8674328327178955
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 81 cost time: 0.8054225444793701
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.917 Test Loss: 0.176 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.8345868587493896
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 83 cost time: 0.8993387222290039
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.9352681636810303
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.6792330741882324
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.917 Test Loss: 0.178 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.9631004333496094
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.917 Test Loss: 0.180 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.9114649295806885
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.8494365215301514
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 0.8107507228851318
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.917 Test Loss: 0.178 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 0.7559080123901367
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 0.7876133918762207
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.917 Test Loss: 0.176 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 0.8419914245605469
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 117260
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4324629306793213
Epoch: 1, Steps: 7 | Train Loss: 2.562 Vali Loss: 2.404 Vali Acc: 0.208 Test Loss: 2.404 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.7566113471984863
Epoch: 2, Steps: 7 | Train Loss: 2.319 Vali Loss: 2.144 Vali Acc: 0.431 Test Loss: 2.144 Test Acc: 0.431
Validation loss decreased (-0.208309 --> -0.430534).  Saving model ...
Epoch: 3 cost time: 0.8177082538604736
Epoch: 3, Steps: 7 | Train Loss: 1.964 Vali Loss: 1.813 Vali Acc: 0.569 Test Loss: 1.813 Test Acc: 0.569
Validation loss decreased (-0.430534 --> -0.569426).  Saving model ...
Epoch: 4 cost time: 0.7908494472503662
Epoch: 4, Steps: 7 | Train Loss: 1.599 Vali Loss: 1.452 Vali Acc: 0.667 Test Loss: 1.452 Test Acc: 0.667
Validation loss decreased (-0.569426 --> -0.666652).  Saving model ...
Epoch: 5 cost time: 0.9016897678375244
Epoch: 5, Steps: 7 | Train Loss: 1.132 Vali Loss: 1.128 Vali Acc: 0.736 Test Loss: 1.128 Test Acc: 0.736
Validation loss decreased (-0.666652 --> -0.736100).  Saving model ...
Epoch: 6 cost time: 0.8230323791503906
Epoch: 6, Steps: 7 | Train Loss: 0.772 Vali Loss: 0.847 Vali Acc: 0.764 Test Loss: 0.847 Test Acc: 0.764
Validation loss decreased (-0.736100 --> -0.763880).  Saving model ...
Epoch: 7 cost time: 0.8089377880096436
Epoch: 7, Steps: 7 | Train Loss: 0.503 Vali Loss: 0.631 Vali Acc: 0.792 Test Loss: 0.631 Test Acc: 0.792
Validation loss decreased (-0.763880 --> -0.791660).  Saving model ...
Epoch: 8 cost time: 0.8106832504272461
Epoch: 8, Steps: 7 | Train Loss: 0.280 Vali Loss: 0.521 Vali Acc: 0.806 Test Loss: 0.521 Test Acc: 0.806
Validation loss decreased (-0.791660 --> -0.805550).  Saving model ...
Epoch: 9 cost time: 0.78240966796875
Epoch: 9, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.442 Vali Acc: 0.833 Test Loss: 0.442 Test Acc: 0.833
Validation loss decreased (-0.805550 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 0.8255093097686768
Epoch: 10, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.405 Vali Acc: 0.861 Test Loss: 0.405 Test Acc: 0.861
Validation loss decreased (-0.833329 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 0.7494504451751709
Epoch: 11, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 12 cost time: 0.8126118183135986
Epoch: 12, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.7739167213439941
Epoch: 13, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 0.8396003246307373
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.8022322654724121
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7702546119689941
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7674682140350342
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8297951221466064
Epoch: 18, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8165509700775146
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7503218650817871
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8211712837219238
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.83711838722229
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.9089229106903076
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.8451285362243652
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.8254578113555908
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.8151931762695312
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.7778832912445068
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.8527791500091553
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.8747055530548096
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.7892730236053467
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7610852718353271
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.7886810302734375
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.803504467010498
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.8190932273864746
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.7560856342315674
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8380279541015625
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8429534435272217
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.8589928150177002
Epoch: 38, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.8679301738739014
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.8463647365570068
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0700180530548096
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.8297340869903564
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.8278458118438721
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.8885807991027832
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.8653714656829834
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7684364318847656
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.8049185276031494
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.8071846961975098
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.8117249011993408
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.8764698505401611
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 0.8457541465759277
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7989323139190674
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 0.8101730346679688
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7732925415039062
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.8210172653198242
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 0.8036556243896484
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8646023273468018
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.8393971920013428
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.8256802558898926
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.8459994792938232
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.8442239761352539
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.8193025588989258
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.870546817779541
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.7824056148529053
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 0.8595321178436279
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 0.7785999774932861
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 0.9279434680938721
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 0.7549808025360107
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 0.8508667945861816
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 0.7649645805358887
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7740974426269531
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.7470848560333252
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 73 cost time: 0.7425599098205566
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 74 cost time: 0.7473893165588379
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.8419055938720703
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.793586254119873
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.8158729076385498
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.8165960311889648
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.8238623142242432
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.8275530338287354
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.8615424633026123
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.8350217342376709
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.7908470630645752
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 88268
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df128_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2607154846191406
Epoch: 1, Steps: 7 | Train Loss: 2.693 Vali Loss: 2.537 Vali Acc: 0.014 Test Loss: 2.537 Test Acc: 0.014
Validation loss decreased (inf --> -0.013864).  Saving model ...
Epoch: 2 cost time: 0.7273743152618408
Epoch: 2, Steps: 7 | Train Loss: 2.564 Vali Loss: 2.275 Vali Acc: 0.125 Test Loss: 2.275 Test Acc: 0.125
Validation loss decreased (-0.013864 --> -0.124977).  Saving model ...
Epoch: 3 cost time: 0.8169851303100586
Epoch: 3, Steps: 7 | Train Loss: 2.182 Vali Loss: 1.958 Vali Acc: 0.500 Test Loss: 1.958 Test Acc: 0.500
Validation loss decreased (-0.124977 --> -0.499980).  Saving model ...
Epoch: 4 cost time: 0.7536470890045166
Epoch: 4, Steps: 7 | Train Loss: 1.834 Vali Loss: 1.604 Vali Acc: 0.667 Test Loss: 1.604 Test Acc: 0.667
Validation loss decreased (-0.499980 --> -0.666651).  Saving model ...
Epoch: 5 cost time: 0.7465431690216064
Epoch: 5, Steps: 7 | Train Loss: 1.443 Vali Loss: 1.272 Vali Acc: 0.750 Test Loss: 1.272 Test Acc: 0.750
Validation loss decreased (-0.666651 --> -0.749987).  Saving model ...
Epoch: 6 cost time: 0.7587475776672363
Epoch: 6, Steps: 7 | Train Loss: 1.041 Vali Loss: 0.997 Vali Acc: 0.806 Test Loss: 0.997 Test Acc: 0.806
Validation loss decreased (-0.749987 --> -0.805546).  Saving model ...
Epoch: 7 cost time: 0.7498774528503418
Epoch: 7, Steps: 7 | Train Loss: 0.732 Vali Loss: 0.747 Vali Acc: 0.889 Test Loss: 0.747 Test Acc: 0.889
Validation loss decreased (-0.805546 --> -0.888881).  Saving model ...
Epoch: 8 cost time: 0.7817509174346924
Epoch: 8, Steps: 7 | Train Loss: 0.489 Vali Loss: 0.600 Vali Acc: 0.875 Test Loss: 0.600 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7740354537963867
Epoch: 9, Steps: 7 | Train Loss: 0.322 Vali Loss: 0.497 Vali Acc: 0.889 Test Loss: 0.497 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 0.7523329257965088
Epoch: 10, Steps: 7 | Train Loss: 0.207 Vali Loss: 0.421 Vali Acc: 0.889 Test Loss: 0.421 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 0.7437529563903809
Epoch: 11, Steps: 7 | Train Loss: 0.126 Vali Loss: 0.381 Vali Acc: 0.861 Test Loss: 0.381 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6738162040710449
Epoch: 12, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8333237171173096
Epoch: 13, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.358 Vali Acc: 0.861 Test Loss: 0.358 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7074313163757324
Epoch: 14, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7583630084991455
Epoch: 15, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7571167945861816
Epoch: 16, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7745835781097412
Epoch: 17, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.8091716766357422
Epoch: 18, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9415171146392822
Epoch: 19, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.8515057563781738
Epoch: 20, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.843956470489502
Epoch: 21, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.9000449180603027
Epoch: 22, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.8008043766021729
Epoch: 23, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.8986949920654297
Epoch: 24, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7451872825622559
Epoch: 25, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8611526489257812
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.7840616703033447
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7700660228729248
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9863965511322021
Epoch: 29, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8193447589874268
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.845280647277832
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7961022853851318
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.824660062789917
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7864234447479248
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8382954597473145
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9730346202850342
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df128_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 73100
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2800230979919434
Epoch: 1, Steps: 7 | Train Loss: 2.715 Vali Loss: 2.609 Vali Acc: 0.042 Test Loss: 2.609 Test Acc: 0.042
Validation loss decreased (inf --> -0.041641).  Saving model ...
Epoch: 2 cost time: 0.7360403537750244
Epoch: 2, Steps: 7 | Train Loss: 2.551 Vali Loss: 2.416 Vali Acc: 0.167 Test Loss: 2.416 Test Acc: 0.167
Validation loss decreased (-0.041641 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 0.8882451057434082
Epoch: 3, Steps: 7 | Train Loss: 2.292 Vali Loss: 2.163 Vali Acc: 0.333 Test Loss: 2.163 Test Acc: 0.333
Validation loss decreased (-0.166643 --> -0.333312).  Saving model ...
Epoch: 4 cost time: 0.7340960502624512
Epoch: 4, Steps: 7 | Train Loss: 1.985 Vali Loss: 1.884 Vali Acc: 0.542 Test Loss: 1.884 Test Acc: 0.542
Validation loss decreased (-0.333312 --> -0.541648).  Saving model ...
Epoch: 5 cost time: 0.7946093082427979
Epoch: 5, Steps: 7 | Train Loss: 1.709 Vali Loss: 1.600 Vali Acc: 0.750 Test Loss: 1.600 Test Acc: 0.750
Validation loss decreased (-0.541648 --> -0.749984).  Saving model ...
Epoch: 6 cost time: 0.8248679637908936
Epoch: 6, Steps: 7 | Train Loss: 1.347 Vali Loss: 1.322 Vali Acc: 0.792 Test Loss: 1.322 Test Acc: 0.792
Validation loss decreased (-0.749984 --> -0.791653).  Saving model ...
Epoch: 7 cost time: 0.8153932094573975
Epoch: 7, Steps: 7 | Train Loss: 1.106 Vali Loss: 1.079 Vali Acc: 0.806 Test Loss: 1.079 Test Acc: 0.806
Validation loss decreased (-0.791653 --> -0.805545).  Saving model ...
Epoch: 8 cost time: 0.8592019081115723
Epoch: 8, Steps: 7 | Train Loss: 0.857 Vali Loss: 0.871 Vali Acc: 0.833 Test Loss: 0.871 Test Acc: 0.833
Validation loss decreased (-0.805545 --> -0.833325).  Saving model ...
Epoch: 9 cost time: 0.8460135459899902
Epoch: 9, Steps: 7 | Train Loss: 0.617 Vali Loss: 0.704 Vali Acc: 0.889 Test Loss: 0.704 Test Acc: 0.889
Validation loss decreased (-0.833325 --> -0.888882).  Saving model ...
Epoch: 10 cost time: 0.7762932777404785
Epoch: 10, Steps: 7 | Train Loss: 0.420 Vali Loss: 0.586 Vali Acc: 0.889 Test Loss: 0.586 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 11 cost time: 0.6988129615783691
Epoch: 11, Steps: 7 | Train Loss: 0.298 Vali Loss: 0.495 Vali Acc: 0.861 Test Loss: 0.495 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8227767944335938
Epoch: 12, Steps: 7 | Train Loss: 0.211 Vali Loss: 0.448 Vali Acc: 0.847 Test Loss: 0.448 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7838959693908691
Epoch: 13, Steps: 7 | Train Loss: 0.147 Vali Loss: 0.413 Vali Acc: 0.861 Test Loss: 0.413 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8243649005889893
Epoch: 14, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 0.7750065326690674
Epoch: 15, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 0.826225757598877
Epoch: 16, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.353 Vali Acc: 0.889 Test Loss: 0.353 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7998998165130615
Epoch: 17, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8349611759185791
Epoch: 18, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9383151531219482
Epoch: 19, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8952455520629883
Epoch: 20, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8350341320037842
Epoch: 21, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.7329380512237549
Epoch: 22, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.7317321300506592
Epoch: 23, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.7908816337585449
Epoch: 24, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.7784249782562256
Epoch: 25, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.9218206405639648
Epoch: 26, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7460653781890869
Epoch: 27, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.8564937114715576
Epoch: 28, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7502005100250244
Epoch: 29, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8453342914581299
Epoch: 30, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.749351978302002
Epoch: 31, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7128992080688477
Epoch: 32, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8723490238189697
Epoch: 33, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8352468013763428
Epoch: 34, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7454268932342529
Epoch: 35, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8472108840942383
Epoch: 36, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8021876811981201
Epoch: 37, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 61196
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df128_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.569725275039673
Epoch: 1, Steps: 7 | Train Loss: 2.806 Vali Loss: 2.638 Vali Acc: 0.014 Test Loss: 2.638 Test Acc: 0.014
Validation loss decreased (inf --> -0.013863).  Saving model ...
Epoch: 2 cost time: 0.774646520614624
Epoch: 2, Steps: 7 | Train Loss: 2.682 Vali Loss: 2.509 Vali Acc: 0.028 Test Loss: 2.509 Test Acc: 0.028
Validation loss decreased (-0.013863 --> -0.027753).  Saving model ...
Epoch: 3 cost time: 0.8844814300537109
Epoch: 3, Steps: 7 | Train Loss: 2.467 Vali Loss: 2.325 Vali Acc: 0.208 Test Loss: 2.325 Test Acc: 0.208
Validation loss decreased (-0.027753 --> -0.208310).  Saving model ...
Epoch: 4 cost time: 0.7618575096130371
Epoch: 4, Steps: 7 | Train Loss: 2.231 Vali Loss: 2.123 Vali Acc: 0.347 Test Loss: 2.123 Test Acc: 0.347
Validation loss decreased (-0.208310 --> -0.347201).  Saving model ...
Epoch: 5 cost time: 0.809269905090332
Epoch: 5, Steps: 7 | Train Loss: 1.947 Vali Loss: 1.903 Vali Acc: 0.514 Test Loss: 1.903 Test Acc: 0.514
Validation loss decreased (-0.347201 --> -0.513870).  Saving model ...
Epoch: 6 cost time: 0.8079571723937988
Epoch: 6, Steps: 7 | Train Loss: 1.681 Vali Loss: 1.680 Vali Acc: 0.583 Test Loss: 1.680 Test Acc: 0.583
Validation loss decreased (-0.513870 --> -0.583317).  Saving model ...
Epoch: 7 cost time: 0.7573709487915039
Epoch: 7, Steps: 7 | Train Loss: 1.439 Vali Loss: 1.455 Vali Acc: 0.708 Test Loss: 1.455 Test Acc: 0.708
Validation loss decreased (-0.583317 --> -0.708319).  Saving model ...
Epoch: 8 cost time: 0.8215761184692383
Epoch: 8, Steps: 7 | Train Loss: 1.169 Vali Loss: 1.228 Vali Acc: 0.722 Test Loss: 1.228 Test Acc: 0.722
Validation loss decreased (-0.708319 --> -0.722210).  Saving model ...
Epoch: 9 cost time: 0.8194799423217773
Epoch: 9, Steps: 7 | Train Loss: 0.942 Vali Loss: 1.020 Vali Acc: 0.819 Test Loss: 1.020 Test Acc: 0.819
Validation loss decreased (-0.722210 --> -0.819434).  Saving model ...
Epoch: 10 cost time: 0.7913615703582764
Epoch: 10, Steps: 7 | Train Loss: 0.720 Vali Loss: 0.842 Vali Acc: 0.819 Test Loss: 0.842 Test Acc: 0.819
Validation loss decreased (-0.819434 --> -0.819436).  Saving model ...
Epoch: 11 cost time: 0.892585277557373
Epoch: 11, Steps: 7 | Train Loss: 0.491 Vali Loss: 0.716 Vali Acc: 0.847 Test Loss: 0.716 Test Acc: 0.847
Validation loss decreased (-0.819436 --> -0.847215).  Saving model ...
Epoch: 12 cost time: 0.7665083408355713
Epoch: 12, Steps: 7 | Train Loss: 0.386 Vali Loss: 0.623 Vali Acc: 0.847 Test Loss: 0.623 Test Acc: 0.847
Validation loss decreased (-0.847215 --> -0.847216).  Saving model ...
Epoch: 13 cost time: 0.8551743030548096
Epoch: 13, Steps: 7 | Train Loss: 0.284 Vali Loss: 0.560 Vali Acc: 0.847 Test Loss: 0.560 Test Acc: 0.847
Validation loss decreased (-0.847216 --> -0.847217).  Saving model ...
Epoch: 14 cost time: 0.7548515796661377
Epoch: 14, Steps: 7 | Train Loss: 0.196 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861106).  Saving model ...
Epoch: 15 cost time: 0.8509278297424316
Epoch: 15, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 16 cost time: 0.7705380916595459
Epoch: 16, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 0.6885771751403809
Epoch: 17, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.409 Vali Acc: 0.889 Test Loss: 0.409 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 0.8072004318237305
Epoch: 18, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.389 Vali Acc: 0.889 Test Loss: 0.389 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 19 cost time: 0.8178825378417969
Epoch: 19, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 0.8325278759002686
Epoch: 20, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.370 Vali Acc: 0.889 Test Loss: 0.370 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 21 cost time: 0.7985517978668213
Epoch: 21, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 0.7594437599182129
Epoch: 22, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.7283735275268555
Epoch: 23, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 24 cost time: 0.8561153411865234
Epoch: 24, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.755300760269165
Epoch: 25, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7026147842407227
Epoch: 26, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.7942094802856445
Epoch: 27, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.8219544887542725
Epoch: 28, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.864593505859375
Epoch: 29, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.8488297462463379
Epoch: 30, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.8929398059844971
Epoch: 31, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.8460955619812012
Epoch: 32, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.8495314121246338
Epoch: 33, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.8587799072265625
Epoch: 34, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.8242571353912354
Epoch: 35, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.754183292388916
Epoch: 36, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.7767257690429688
Epoch: 37, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.8223538398742676
Epoch: 38, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.9040277004241943
Epoch: 39, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.8363521099090576
Epoch: 40, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7950520515441895
Epoch: 41, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.7414040565490723
Epoch: 42, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.831449031829834
Epoch: 43, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.7528326511383057
Epoch: 44, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 1.0631370544433594
Epoch: 45, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.781078577041626
Epoch: 46, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.9211251735687256
Epoch: 47, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.8634951114654541
Epoch: 48, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8404855728149414
Epoch: 49, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.7821125984191895
Epoch: 50, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.7908596992492676
Epoch: 51, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.9274857044219971
Epoch: 52, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 53 cost time: 0.7634642124176025
Epoch: 53, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.7718300819396973
Epoch: 54, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.7696425914764404
Epoch: 55, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.8615646362304688
Epoch: 56, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 57 cost time: 0.8023018836975098
Epoch: 57, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.8739476203918457
Epoch: 58, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.8482382297515869
Epoch: 59, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 60 cost time: 0.9215672016143799
Epoch: 60, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.7661619186401367
Epoch: 61, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.746638298034668
Epoch: 62, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7021763324737549
Epoch: 63, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 64 cost time: 0.8164665699005127
Epoch: 64, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.8587698936462402
Epoch: 65, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 66 cost time: 0.7710473537445068
Epoch: 66, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 67 cost time: 0.789700984954834
Epoch: 67, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 68 cost time: 0.7755694389343262
Epoch: 68, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 69 cost time: 0.8004302978515625
Epoch: 69, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.7877988815307617
Epoch: 70, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 71 cost time: 0.7630932331085205
Epoch: 71, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 72 cost time: 0.8103163242340088
Epoch: 72, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 73 cost time: 0.74442458152771
Epoch: 73, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 74 cost time: 0.815415620803833
Epoch: 74, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.889 Test Loss: 0.238 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.7982602119445801
Epoch: 75, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.889 Test Loss: 0.236 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.7928786277770996
Epoch: 76, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 77 cost time: 0.8743619918823242
Epoch: 77, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.7510857582092285
Epoch: 78, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.8342442512512207
Epoch: 79, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 80 cost time: 0.7451567649841309
Epoch: 80, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 81 cost time: 0.7263903617858887
Epoch: 81, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.696782112121582
Epoch: 82, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.889 Test Loss: 0.231 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.6960067749023438
Epoch: 83, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.7444348335266113
Epoch: 84, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.7304465770721436
Epoch: 85, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.889 Test Loss: 0.230 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.8186712265014648
Epoch: 86, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.8403778076171875
Epoch: 87, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.889 Test Loss: 0.228 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.699134111404419
Epoch: 88, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.889 Test Loss: 0.228 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 0.8186051845550537
Epoch: 89, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.7657051086425781
Epoch: 90, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.889 Test Loss: 0.227 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df128_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 53900
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.372016191482544
Epoch: 1, Steps: 7 | Train Loss: 2.599 Vali Loss: 2.481 Vali Acc: 0.111 Test Loss: 2.481 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.754641056060791
Epoch: 2, Steps: 7 | Train Loss: 2.463 Vali Loss: 2.389 Vali Acc: 0.125 Test Loss: 2.389 Test Acc: 0.125
Validation loss decreased (-0.111086 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 0.7363076210021973
Epoch: 3, Steps: 7 | Train Loss: 2.340 Vali Loss: 2.240 Vali Acc: 0.194 Test Loss: 2.240 Test Acc: 0.194
Validation loss decreased (-0.124976 --> -0.194422).  Saving model ...
Epoch: 4 cost time: 0.7604053020477295
Epoch: 4, Steps: 7 | Train Loss: 2.165 Vali Loss: 2.057 Vali Acc: 0.319 Test Loss: 2.057 Test Acc: 0.319
Validation loss decreased (-0.194422 --> -0.319424).  Saving model ...
Epoch: 5 cost time: 0.8094937801361084
Epoch: 5, Steps: 7 | Train Loss: 1.884 Vali Loss: 1.852 Vali Acc: 0.444 Test Loss: 1.852 Test Acc: 0.444
Validation loss decreased (-0.319424 --> -0.444426).  Saving model ...
Epoch: 6 cost time: 0.6871802806854248
Epoch: 6, Steps: 7 | Train Loss: 1.657 Vali Loss: 1.642 Vali Acc: 0.556 Test Loss: 1.642 Test Acc: 0.556
Validation loss decreased (-0.444426 --> -0.555539).  Saving model ...
Epoch: 7 cost time: 0.7493898868560791
Epoch: 7, Steps: 7 | Train Loss: 1.416 Vali Loss: 1.434 Vali Acc: 0.736 Test Loss: 1.434 Test Acc: 0.736
Validation loss decreased (-0.555539 --> -0.736097).  Saving model ...
Epoch: 8 cost time: 0.6989092826843262
Epoch: 8, Steps: 7 | Train Loss: 1.205 Vali Loss: 1.240 Vali Acc: 0.806 Test Loss: 1.240 Test Acc: 0.806
Validation loss decreased (-0.736097 --> -0.805543).  Saving model ...
Epoch: 9 cost time: 0.7306113243103027
Epoch: 9, Steps: 7 | Train Loss: 0.987 Vali Loss: 1.067 Vali Acc: 0.806 Test Loss: 1.067 Test Acc: 0.806
Validation loss decreased (-0.805543 --> -0.805545).  Saving model ...
Epoch: 10 cost time: 0.8081729412078857
Epoch: 10, Steps: 7 | Train Loss: 0.780 Vali Loss: 0.917 Vali Acc: 0.806 Test Loss: 0.917 Test Acc: 0.806
Validation loss decreased (-0.805545 --> -0.805546).  Saving model ...
Epoch: 11 cost time: 0.6984207630157471
Epoch: 11, Steps: 7 | Train Loss: 0.596 Vali Loss: 0.797 Vali Acc: 0.847 Test Loss: 0.797 Test Acc: 0.847
Validation loss decreased (-0.805546 --> -0.847214).  Saving model ...
Epoch: 12 cost time: 0.7291958332061768
Epoch: 12, Steps: 7 | Train Loss: 0.459 Vali Loss: 0.692 Vali Acc: 0.847 Test Loss: 0.692 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847215).  Saving model ...
Epoch: 13 cost time: 0.760350227355957
Epoch: 13, Steps: 7 | Train Loss: 0.337 Vali Loss: 0.604 Vali Acc: 0.875 Test Loss: 0.604 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874994).  Saving model ...
Epoch: 14 cost time: 0.699953556060791
Epoch: 14, Steps: 7 | Train Loss: 0.278 Vali Loss: 0.548 Vali Acc: 0.875 Test Loss: 0.548 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 0.8194520473480225
Epoch: 15, Steps: 7 | Train Loss: 0.233 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888884).  Saving model ...
Epoch: 16 cost time: 0.761777400970459
Epoch: 16, Steps: 7 | Train Loss: 0.167 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8144707679748535
Epoch: 17, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.466 Vali Acc: 0.875 Test Loss: 0.466 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8438224792480469
Epoch: 18, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8003451824188232
Epoch: 19, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 0.794539213180542
Epoch: 20, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.409 Vali Acc: 0.889 Test Loss: 0.409 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 21 cost time: 0.7401249408721924
Epoch: 21, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.404 Vali Acc: 0.903 Test Loss: 0.404 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 0.7579467296600342
Epoch: 22, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.397 Vali Acc: 0.903 Test Loss: 0.397 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.7371773719787598
Epoch: 23, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8037862777709961
Epoch: 24, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6999056339263916
Epoch: 25, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.378 Vali Acc: 0.889 Test Loss: 0.378 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.738178014755249
Epoch: 26, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6749811172485352
Epoch: 27, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8095071315765381
Epoch: 28, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6416902542114258
Epoch: 29, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7712440490722656
Epoch: 30, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7934982776641846
Epoch: 31, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 32 cost time: 0.6786637306213379
Epoch: 32, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 33 cost time: 0.7358572483062744
Epoch: 33, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.335 Vali Acc: 0.903 Test Loss: 0.335 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 34 cost time: 0.7294595241546631
Epoch: 34, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 35 cost time: 0.8668122291564941
Epoch: 35, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.7368597984313965
Epoch: 36, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.7551167011260986
Epoch: 37, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.671865701675415
Epoch: 38, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7266466617584229
Epoch: 39, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7523648738861084
Epoch: 40, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7854230403900146
Epoch: 41, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.8054537773132324
Epoch: 42, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7702796459197998
Epoch: 43, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7796239852905273
Epoch: 44, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.7704880237579346
Epoch: 45, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.7328791618347168
Epoch: 46, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.7618937492370605
Epoch: 47, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.6690614223480225
Epoch: 48, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.6730697154998779
Epoch: 49, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.7680299282073975
Epoch: 50, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7181649208068848
Epoch: 51, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7619311809539795
Epoch: 52, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.6485481262207031
Epoch: 53, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 0.7415726184844971
Epoch: 54, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 0.7541868686676025
Epoch: 55, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 0.6995928287506104
Epoch: 56, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 0.762582540512085
Epoch: 57, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 0.7155582904815674
Epoch: 58, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 0.7562761306762695
Epoch: 59, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.7413430213928223
Epoch: 60, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 0.6411948204040527
Epoch: 61, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 62 cost time: 0.7359967231750488
Epoch: 62, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 0.7860450744628906
Epoch: 63, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 0.786466121673584
Epoch: 64, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 0.6621723175048828
Epoch: 65, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 0.6919989585876465
Epoch: 66, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 0.6933174133300781
Epoch: 67, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 0.6901776790618896
Epoch: 68, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.6893994808197021
Epoch: 69, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.6540536880493164
Epoch: 70, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.7473108768463135
Epoch: 71, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.8369922637939453
Epoch: 72, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 73 cost time: 0.6807174682617188
Epoch: 73, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 74 cost time: 0.7335782051086426
Epoch: 74, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 75 cost time: 0.7199447154998779
Epoch: 75, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8015601634979248
Epoch: 76, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.6871981620788574
Epoch: 77, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.7986464500427246
Epoch: 78, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 79 cost time: 0.7577550411224365
Epoch: 79, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 80 cost time: 0.8015091419219971
Epoch: 80, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.738276481628418
Epoch: 81, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 82 cost time: 0.7289965152740479
Epoch: 82, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.8256375789642334
Epoch: 83, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.7430758476257324
Epoch: 84, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.6873641014099121
Epoch: 85, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.7268533706665039
Epoch: 86, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.6894726753234863
Epoch: 87, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 0.7382893562316895
Epoch: 88, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 0.6861610412597656
Epoch: 89, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 0.7020316123962402
Epoch: 90, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 0.6896100044250488
Epoch: 91, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 51212
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6070618629455566
Epoch: 1, Steps: 7 | Train Loss: 2.621 Vali Loss: 2.468 Vali Acc: 0.167 Test Loss: 2.468 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 1.1511790752410889
Epoch: 2, Steps: 7 | Train Loss: 2.243 Vali Loss: 2.031 Vali Acc: 0.444 Test Loss: 2.031 Test Acc: 0.444
Validation loss decreased (-0.166642 --> -0.444424).  Saving model ...
Epoch: 3 cost time: 1.1201369762420654
Epoch: 3, Steps: 7 | Train Loss: 1.644 Vali Loss: 1.406 Vali Acc: 0.750 Test Loss: 1.406 Test Acc: 0.750
Validation loss decreased (-0.444424 --> -0.749986).  Saving model ...
Epoch: 4 cost time: 1.1830260753631592
Epoch: 4, Steps: 7 | Train Loss: 1.020 Vali Loss: 0.953 Vali Acc: 0.819 Test Loss: 0.953 Test Acc: 0.819
Validation loss decreased (-0.749986 --> -0.819435).  Saving model ...
Epoch: 5 cost time: 1.2999176979064941
Epoch: 5, Steps: 7 | Train Loss: 0.508 Vali Loss: 0.612 Vali Acc: 0.903 Test Loss: 0.612 Test Acc: 0.903
Validation loss decreased (-0.819435 --> -0.902772).  Saving model ...
Epoch: 6 cost time: 1.3831627368927002
Epoch: 6, Steps: 7 | Train Loss: 0.238 Vali Loss: 0.424 Vali Acc: 0.903 Test Loss: 0.424 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.4104795455932617
Epoch: 7, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.422 Vali Acc: 0.903 Test Loss: 0.422 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 1.2178435325622559
Epoch: 8, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.0843958854675293
Epoch: 9, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.303241491317749
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4112298488616943
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3521232604980469
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.302884578704834
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.4162628650665283
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.368685245513916
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2878937721252441
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.4044678211212158
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3101637363433838
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3074593544006348
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1301383972167969
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.23716139793396
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3429667949676514
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3373031616210938
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3492372035980225
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2996714115142822
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3756110668182373
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 200140
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.365079164505005
Epoch: 1, Steps: 7 | Train Loss: 2.613 Vali Loss: 2.362 Vali Acc: 0.181 Test Loss: 2.362 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 0.8351714611053467
Epoch: 2, Steps: 7 | Train Loss: 2.371 Vali Loss: 2.070 Vali Acc: 0.431 Test Loss: 2.070 Test Acc: 0.431
Validation loss decreased (-0.180532 --> -0.430535).  Saving model ...
Epoch: 3 cost time: 0.7878270149230957
Epoch: 3, Steps: 7 | Train Loss: 1.946 Vali Loss: 1.668 Vali Acc: 0.625 Test Loss: 1.668 Test Acc: 0.625
Validation loss decreased (-0.430535 --> -0.624983).  Saving model ...
Epoch: 4 cost time: 0.8369805812835693
Epoch: 4, Steps: 7 | Train Loss: 1.401 Vali Loss: 1.236 Vali Acc: 0.736 Test Loss: 1.236 Test Acc: 0.736
Validation loss decreased (-0.624983 --> -0.736099).  Saving model ...
Epoch: 5 cost time: 0.8880112171173096
Epoch: 5, Steps: 7 | Train Loss: 0.955 Vali Loss: 0.864 Vali Acc: 0.861 Test Loss: 0.864 Test Acc: 0.861
Validation loss decreased (-0.736099 --> -0.861102).  Saving model ...
Epoch: 6 cost time: 0.7628772258758545
Epoch: 6, Steps: 7 | Train Loss: 0.568 Vali Loss: 0.656 Vali Acc: 0.889 Test Loss: 0.656 Test Acc: 0.889
Validation loss decreased (-0.861102 --> -0.888882).  Saving model ...
Epoch: 7 cost time: 0.7401411533355713
Epoch: 7, Steps: 7 | Train Loss: 0.323 Vali Loss: 0.463 Vali Acc: 0.903 Test Loss: 0.463 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 0.7809033393859863
Epoch: 8, Steps: 7 | Train Loss: 0.167 Vali Loss: 0.400 Vali Acc: 0.903 Test Loss: 0.400 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.7726857662200928
Epoch: 9, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8395602703094482
Epoch: 10, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7808401584625244
Epoch: 11, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.320 Vali Acc: 0.875 Test Loss: 0.320 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7599949836730957
Epoch: 12, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.749943733215332
Epoch: 13, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.8311491012573242
Epoch: 14, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.8058059215545654
Epoch: 15, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.8635566234588623
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.8138759136199951
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8174760341644287
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.8021860122680664
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.779961109161377
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.8167264461517334
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.7912280559539795
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8172271251678467
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7658743858337402
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8053348064422607
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7304244041442871
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.8397223949432373
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7850558757781982
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.820136308670044
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.7778520584106445
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7446780204772949
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7536873817443848
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7959864139556885
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.8882918357849121
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.8283238410949707
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8659906387329102
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8028395175933838
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.8479840755462646
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.8729794025421143
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.8600783348083496
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.8183114528656006
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8507387638092041
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7867419719696045
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8429982662200928
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7399218082427979
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.9130449295043945
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8603525161743164
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.7378313541412354
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.8231201171875
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.726304292678833
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.7065320014953613
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 0.6868062019348145
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7470495700836182
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9756448268890381
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 0.8579940795898438
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8386702537536621
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.799424409866333
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8068766593933105
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.8866996765136719
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.8839154243469238
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 0.7897236347198486
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 62 cost time: 0.8438198566436768
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8836772441864014
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.8346633911132812
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 65 cost time: 0.7706916332244873
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7687923908233643
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.8184480667114258
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 68 cost time: 0.8072316646575928
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 69 cost time: 0.7887725830078125
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.7810990810394287
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 71 cost time: 0.9042725563049316
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.801149845123291
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.769132137298584
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.8248565196990967
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.8491272926330566
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.8460702896118164
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.7910792827606201
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.8245563507080078
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.9117047786712646
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 80 cost time: 0.8201422691345215
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 81 cost time: 0.814002275466919
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 82 cost time: 0.8853261470794678
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.9038710594177246
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.883425235748291
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.9145674705505371
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.9036684036254883
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.8246810436248779
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 0.8762400150299072
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 0.8549907207489014
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 0.7720081806182861
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 0.8246002197265625
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 108940
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3161821365356445
Epoch: 1, Steps: 7 | Train Loss: 2.639 Vali Loss: 2.418 Vali Acc: 0.139 Test Loss: 2.418 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.7150225639343262
Epoch: 2, Steps: 7 | Train Loss: 2.443 Vali Loss: 2.159 Vali Acc: 0.292 Test Loss: 2.159 Test Acc: 0.292
Validation loss decreased (-0.138865 --> -0.291645).  Saving model ...
Epoch: 3 cost time: 0.7415766716003418
Epoch: 3, Steps: 7 | Train Loss: 2.069 Vali Loss: 1.829 Vali Acc: 0.667 Test Loss: 1.829 Test Acc: 0.667
Validation loss decreased (-0.291645 --> -0.666648).  Saving model ...
Epoch: 4 cost time: 0.7443146705627441
Epoch: 4, Steps: 7 | Train Loss: 1.629 Vali Loss: 1.464 Vali Acc: 0.764 Test Loss: 1.464 Test Acc: 0.764
Validation loss decreased (-0.666648 --> -0.763874).  Saving model ...
Epoch: 5 cost time: 0.6877601146697998
Epoch: 5, Steps: 7 | Train Loss: 1.253 Vali Loss: 1.118 Vali Acc: 0.806 Test Loss: 1.118 Test Acc: 0.806
Validation loss decreased (-0.763874 --> -0.805544).  Saving model ...
Epoch: 6 cost time: 0.7045621871948242
Epoch: 6, Steps: 7 | Train Loss: 0.841 Vali Loss: 0.835 Vali Acc: 0.861 Test Loss: 0.835 Test Acc: 0.861
Validation loss decreased (-0.805544 --> -0.861103).  Saving model ...
Epoch: 7 cost time: 0.65852952003479
Epoch: 7, Steps: 7 | Train Loss: 0.556 Vali Loss: 0.599 Vali Acc: 0.903 Test Loss: 0.599 Test Acc: 0.903
Validation loss decreased (-0.861103 --> -0.902772).  Saving model ...
Epoch: 8 cost time: 0.7694439888000488
Epoch: 8, Steps: 7 | Train Loss: 0.326 Vali Loss: 0.455 Vali Acc: 0.917 Test Loss: 0.455 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916662).  Saving model ...
Epoch: 9 cost time: 0.7629947662353516
Epoch: 9, Steps: 7 | Train Loss: 0.196 Vali Loss: 0.371 Vali Acc: 0.917 Test Loss: 0.371 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 0.8275735378265381
Epoch: 10, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.7888643741607666
Epoch: 11, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.7323946952819824
Epoch: 12, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7527375221252441
Epoch: 13, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.761488676071167
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.8107430934906006
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.7443151473999023
Epoch: 16, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.7257602214813232
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.7763881683349609
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.7915987968444824
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.7094619274139404
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.7425997257232666
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.7468011379241943
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.8547048568725586
Epoch: 23, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.6762087345123291
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.7242815494537354
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.7672872543334961
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.7316603660583496
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 0.8395240306854248
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.7197396755218506
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7704756259918213
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.7990691661834717
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.7921042442321777
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.7415006160736084
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.6364760398864746
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.7254080772399902
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.7364535331726074
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7502543926239014
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7619800567626953
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7331068515777588
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6692512035369873
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7468874454498291
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6937007904052734
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.7573037147521973
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7201094627380371
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7837874889373779
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.69722580909729
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.6280889511108398
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7396142482757568
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.7299292087554932
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.7379097938537598
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 0.7689533233642578
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 0.7363491058349609
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 53 cost time: 0.7102248668670654
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 54 cost time: 0.7026338577270508
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7502062320709229
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6605856418609619
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 57 cost time: 0.6887931823730469
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 58 cost time: 0.6887280941009521
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7284643650054932
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 60 cost time: 0.7069580554962158
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 61 cost time: 0.71018385887146
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6680247783660889
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.7679922580718994
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.7156937122344971
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.8091650009155273
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.6962883472442627
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.774864912033081
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.772998571395874
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 69 cost time: 0.7040636539459229
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 70 cost time: 0.7238190174102783
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 71 cost time: 0.7741239070892334
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 72 cost time: 0.7689862251281738
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.7174906730651855
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.674422025680542
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.6499557495117188
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.6990616321563721
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.7328083515167236
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 78 cost time: 0.6623799800872803
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 79 cost time: 0.7780728340148926
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 80 cost time: 0.6918728351593018
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.7029106616973877
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.7210874557495117
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.7391819953918457
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.83677077293396
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.7972502708435059
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.8288230895996094
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 0.7936320304870605
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 0.7500805854797363
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 0.7146036624908447
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 79948
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df64_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.449777841567993
Epoch: 1, Steps: 7 | Train Loss: 2.595 Vali Loss: 2.371 Vali Acc: 0.194 Test Loss: 2.371 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 0.8120477199554443
Epoch: 2, Steps: 7 | Train Loss: 2.411 Vali Loss: 2.163 Vali Acc: 0.278 Test Loss: 2.163 Test Acc: 0.278
Validation loss decreased (-0.194421 --> -0.277756).  Saving model ...
Epoch: 3 cost time: 0.75388503074646
Epoch: 3, Steps: 7 | Train Loss: 2.204 Vali Loss: 1.884 Vali Acc: 0.542 Test Loss: 1.884 Test Acc: 0.542
Validation loss decreased (-0.277756 --> -0.541648).  Saving model ...
Epoch: 4 cost time: 0.6741087436676025
Epoch: 4, Steps: 7 | Train Loss: 1.831 Vali Loss: 1.568 Vali Acc: 0.681 Test Loss: 1.568 Test Acc: 0.681
Validation loss decreased (-0.541648 --> -0.680540).  Saving model ...
Epoch: 5 cost time: 0.7123837471008301
Epoch: 5, Steps: 7 | Train Loss: 1.420 Vali Loss: 1.262 Vali Acc: 0.764 Test Loss: 1.262 Test Acc: 0.764
Validation loss decreased (-0.680540 --> -0.763876).  Saving model ...
Epoch: 6 cost time: 0.6882534027099609
Epoch: 6, Steps: 7 | Train Loss: 1.077 Vali Loss: 0.989 Vali Acc: 0.778 Test Loss: 0.989 Test Acc: 0.778
Validation loss decreased (-0.763876 --> -0.777768).  Saving model ...
Epoch: 7 cost time: 0.7464158535003662
Epoch: 7, Steps: 7 | Train Loss: 0.769 Vali Loss: 0.750 Vali Acc: 0.833 Test Loss: 0.750 Test Acc: 0.833
Validation loss decreased (-0.777768 --> -0.833326).  Saving model ...
Epoch: 8 cost time: 0.7692475318908691
Epoch: 8, Steps: 7 | Train Loss: 0.503 Vali Loss: 0.583 Vali Acc: 0.861 Test Loss: 0.583 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861105).  Saving model ...
Epoch: 9 cost time: 0.77182936668396
Epoch: 9, Steps: 7 | Train Loss: 0.327 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 10 cost time: 0.7149839401245117
Epoch: 10, Steps: 7 | Train Loss: 0.206 Vali Loss: 0.407 Vali Acc: 0.861 Test Loss: 0.407 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 0.6638331413269043
Epoch: 11, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
Validation loss decreased (-0.861107 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.6916909217834473
Epoch: 12, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 0.7135047912597656
Epoch: 13, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.7764058113098145
Epoch: 14, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7065556049346924
Epoch: 15, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.707252025604248
Epoch: 16, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.7453289031982422
Epoch: 17, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7641265392303467
Epoch: 18, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.840111255645752
Epoch: 19, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8332514762878418
Epoch: 20, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7623460292816162
Epoch: 21, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7605798244476318
Epoch: 22, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7504363059997559
Epoch: 23, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6732721328735352
Epoch: 24, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7959370613098145
Epoch: 25, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8303008079528809
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df64_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 64780
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.343074321746826
Epoch: 1, Steps: 7 | Train Loss: 2.763 Vali Loss: 2.573 Vali Acc: 0.097 Test Loss: 2.573 Test Acc: 0.097
Validation loss decreased (inf --> -0.097196).  Saving model ...
Epoch: 2 cost time: 0.8080902099609375
Epoch: 2, Steps: 7 | Train Loss: 2.599 Vali Loss: 2.432 Vali Acc: 0.167 Test Loss: 2.432 Test Acc: 0.167
Validation loss decreased (-0.097196 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 0.7000827789306641
Epoch: 3, Steps: 7 | Train Loss: 2.378 Vali Loss: 2.223 Vali Acc: 0.306 Test Loss: 2.223 Test Acc: 0.306
Validation loss decreased (-0.166642 --> -0.305533).  Saving model ...
Epoch: 4 cost time: 0.7652437686920166
Epoch: 4, Steps: 7 | Train Loss: 2.076 Vali Loss: 2.001 Vali Acc: 0.375 Test Loss: 2.001 Test Acc: 0.375
Validation loss decreased (-0.305533 --> -0.374980).  Saving model ...
Epoch: 5 cost time: 0.78662109375
Epoch: 5, Steps: 7 | Train Loss: 1.803 Vali Loss: 1.762 Vali Acc: 0.542 Test Loss: 1.762 Test Acc: 0.542
Validation loss decreased (-0.374980 --> -0.541649).  Saving model ...
Epoch: 6 cost time: 0.7956540584564209
Epoch: 6, Steps: 7 | Train Loss: 1.536 Vali Loss: 1.518 Vali Acc: 0.667 Test Loss: 1.518 Test Acc: 0.667
Validation loss decreased (-0.541649 --> -0.666651).  Saving model ...
Epoch: 7 cost time: 0.7820911407470703
Epoch: 7, Steps: 7 | Train Loss: 1.205 Vali Loss: 1.277 Vali Acc: 0.750 Test Loss: 1.277 Test Acc: 0.750
Validation loss decreased (-0.666651 --> -0.749987).  Saving model ...
Epoch: 8 cost time: 0.6819360256195068
Epoch: 8, Steps: 7 | Train Loss: 0.983 Vali Loss: 1.041 Vali Acc: 0.792 Test Loss: 1.041 Test Acc: 0.792
Validation loss decreased (-0.749987 --> -0.791656).  Saving model ...
Epoch: 9 cost time: 0.7473747730255127
Epoch: 9, Steps: 7 | Train Loss: 0.703 Vali Loss: 0.850 Vali Acc: 0.792 Test Loss: 0.850 Test Acc: 0.792
Validation loss decreased (-0.791656 --> -0.791658).  Saving model ...
Epoch: 10 cost time: 0.746251106262207
Epoch: 10, Steps: 7 | Train Loss: 0.513 Vali Loss: 0.706 Vali Acc: 0.847 Test Loss: 0.706 Test Acc: 0.847
Validation loss decreased (-0.791658 --> -0.847215).  Saving model ...
Epoch: 11 cost time: 0.714519739151001
Epoch: 11, Steps: 7 | Train Loss: 0.371 Vali Loss: 0.603 Vali Acc: 0.875 Test Loss: 0.603 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874994).  Saving model ...
Epoch: 12 cost time: 0.7648499011993408
Epoch: 12, Steps: 7 | Train Loss: 0.285 Vali Loss: 0.527 Vali Acc: 0.875 Test Loss: 0.527 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 13 cost time: 0.9079315662384033
Epoch: 13, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.463 Vali Acc: 0.861 Test Loss: 0.463 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7379422187805176
Epoch: 14, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.429 Vali Acc: 0.875 Test Loss: 0.429 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 0.6688902378082275
Epoch: 15, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.400 Vali Acc: 0.889 Test Loss: 0.400 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 0.6735875606536865
Epoch: 16, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 0.7183535099029541
Epoch: 17, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7725422382354736
Epoch: 18, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 19 cost time: 0.8006083965301514
Epoch: 19, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7215328216552734
Epoch: 20, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 21 cost time: 0.7171931266784668
Epoch: 21, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 0.7023923397064209
Epoch: 22, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.8083460330963135
Epoch: 23, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 24 cost time: 0.8235206604003906
Epoch: 24, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.328 Vali Acc: 0.917 Test Loss: 0.328 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 25 cost time: 0.8194782733917236
Epoch: 25, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 0.8744161128997803
Epoch: 26, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 27 cost time: 0.7609856128692627
Epoch: 27, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.7981030941009521
Epoch: 28, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.6776046752929688
Epoch: 29, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.7798261642456055
Epoch: 30, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.7131810188293457
Epoch: 31, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.7504136562347412
Epoch: 32, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.7042090892791748
Epoch: 33, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.7279565334320068
Epoch: 34, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.7958588600158691
Epoch: 35, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.7271213531494141
Epoch: 36, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.70998215675354
Epoch: 37, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.8663568496704102
Epoch: 38, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.6780025959014893
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7602593898773193
Epoch: 40, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.6774256229400635
Epoch: 41, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.8135976791381836
Epoch: 42, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.7491726875305176
Epoch: 43, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.7878129482269287
Epoch: 44, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.7266156673431396
Epoch: 45, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.7600271701812744
Epoch: 46, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.7600727081298828
Epoch: 47, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.8561294078826904
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.755138635635376
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8266494274139404
Epoch: 50, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7418253421783447
Epoch: 51, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.7199118137359619
Epoch: 52, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 0.6928501129150391
Epoch: 53, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 0.7045574188232422
Epoch: 54, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 0.6988649368286133
Epoch: 55, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 0.7020745277404785
Epoch: 56, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 0.7366788387298584
Epoch: 57, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 0.7433414459228516
Epoch: 58, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 0.651404619216919
Epoch: 59, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.674980878829956
Epoch: 60, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 0.7430031299591064
Epoch: 61, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 62 cost time: 0.6984484195709229
Epoch: 62, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 0.6648964881896973
Epoch: 63, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 0.6689014434814453
Epoch: 64, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.6752467155456543
Epoch: 65, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 0.6797289848327637
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6324825286865234
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 0.7336533069610596
Epoch: 68, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 0.6624205112457275
Epoch: 69, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 0.7549190521240234
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 0.673912525177002
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 0.7167515754699707
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.7307062149047852
Epoch: 73, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.7911005020141602
Epoch: 74, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 75 cost time: 0.7538712024688721
Epoch: 75, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 76 cost time: 0.7225809097290039
Epoch: 76, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 77 cost time: 0.7403049468994141
Epoch: 77, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 78 cost time: 0.7334060668945312
Epoch: 78, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 79 cost time: 0.6833734512329102
Epoch: 79, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 80 cost time: 0.7917053699493408
Epoch: 80, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 81 cost time: 0.7192134857177734
Epoch: 81, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 82 cost time: 0.8511271476745605
Epoch: 82, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.8192839622497559
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.7267923355102539
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 85 cost time: 0.7398591041564941
Epoch: 85, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.8007009029388428
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.8272504806518555
Epoch: 87, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 88 cost time: 0.816992998123169
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 89 cost time: 0.7728447914123535
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.8141391277313232
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.8232650756835938
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.698397159576416
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 0.7099525928497314
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 0.727501392364502
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 0.7590820789337158
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 0.7796354293823242
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 97 cost time: 0.789811372756958
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 98 cost time: 0.6982846260070801
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.7610089778900146
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 100 cost time: 0.7281179428100586
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 52876
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df64_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.269460439682007
Epoch: 1, Steps: 7 | Train Loss: 2.619 Vali Loss: 2.550 Vali Acc: 0.069 Test Loss: 2.550 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.708782434463501
Epoch: 2, Steps: 7 | Train Loss: 2.569 Vali Loss: 2.385 Vali Acc: 0.111 Test Loss: 2.385 Test Acc: 0.111
Validation loss decreased (-0.069419 --> -0.111087).  Saving model ...
Epoch: 3 cost time: 0.7711668014526367
Epoch: 3, Steps: 7 | Train Loss: 2.341 Vali Loss: 2.171 Vali Acc: 0.264 Test Loss: 2.171 Test Acc: 0.264
Validation loss decreased (-0.111087 --> -0.263867).  Saving model ...
Epoch: 4 cost time: 0.7756357192993164
Epoch: 4, Steps: 7 | Train Loss: 2.006 Vali Loss: 1.937 Vali Acc: 0.444 Test Loss: 1.937 Test Acc: 0.444
Validation loss decreased (-0.263867 --> -0.444425).  Saving model ...
Epoch: 5 cost time: 0.7324280738830566
Epoch: 5, Steps: 7 | Train Loss: 1.821 Vali Loss: 1.689 Vali Acc: 0.653 Test Loss: 1.689 Test Acc: 0.653
Validation loss decreased (-0.444425 --> -0.652761).  Saving model ...
Epoch: 6 cost time: 0.7755227088928223
Epoch: 6, Steps: 7 | Train Loss: 1.573 Vali Loss: 1.441 Vali Acc: 0.736 Test Loss: 1.441 Test Acc: 0.736
Validation loss decreased (-0.652761 --> -0.736097).  Saving model ...
Epoch: 7 cost time: 0.7152018547058105
Epoch: 7, Steps: 7 | Train Loss: 1.266 Vali Loss: 1.203 Vali Acc: 0.736 Test Loss: 1.203 Test Acc: 0.736
Validation loss decreased (-0.736097 --> -0.736099).  Saving model ...
Epoch: 8 cost time: 0.7675890922546387
Epoch: 8, Steps: 7 | Train Loss: 1.017 Vali Loss: 1.003 Vali Acc: 0.792 Test Loss: 1.003 Test Acc: 0.792
Validation loss decreased (-0.736099 --> -0.791657).  Saving model ...
Epoch: 9 cost time: 0.7080075740814209
Epoch: 9, Steps: 7 | Train Loss: 0.793 Vali Loss: 0.835 Vali Acc: 0.819 Test Loss: 0.835 Test Acc: 0.819
Validation loss decreased (-0.791657 --> -0.819436).  Saving model ...
Epoch: 10 cost time: 0.7085013389587402
Epoch: 10, Steps: 7 | Train Loss: 0.575 Vali Loss: 0.698 Vali Acc: 0.833 Test Loss: 0.698 Test Acc: 0.833
Validation loss decreased (-0.819436 --> -0.833326).  Saving model ...
Epoch: 11 cost time: 0.7720451354980469
Epoch: 11, Steps: 7 | Train Loss: 0.448 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833327).  Saving model ...
Epoch: 12 cost time: 0.741126298904419
Epoch: 12, Steps: 7 | Train Loss: 0.349 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861106).  Saving model ...
Epoch: 13 cost time: 0.719529390335083
Epoch: 13, Steps: 7 | Train Loss: 0.249 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 14 cost time: 0.7240304946899414
Epoch: 14, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.436 Vali Acc: 0.861 Test Loss: 0.436 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 0.8790147304534912
Epoch: 15, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 16 cost time: 0.694591760635376
Epoch: 16, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.389 Vali Acc: 0.889 Test Loss: 0.389 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 0.7413952350616455
Epoch: 17, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.378 Vali Acc: 0.889 Test Loss: 0.378 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 0.7207655906677246
Epoch: 18, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 19 cost time: 0.7054026126861572
Epoch: 19, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 0.7280256748199463
Epoch: 20, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7734763622283936
Epoch: 21, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7062172889709473
Epoch: 22, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.786700963973999
Epoch: 23, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.811471700668335
Epoch: 24, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.8650665283203125
Epoch: 25, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.79850172996521
Epoch: 26, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7779104709625244
Epoch: 27, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.7742984294891357
Epoch: 28, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.8415608406066895
Epoch: 29, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6294987201690674
Epoch: 30, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.805736780166626
Epoch: 31, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7336640357971191
Epoch: 32, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.74729323387146
Epoch: 33, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7770342826843262
Epoch: 34, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7060935497283936
Epoch: 35, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.7354938983917236
Epoch: 36, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7308201789855957
Epoch: 37, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.7348384857177734
Epoch: 38, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.7514078617095947
Epoch: 39, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.791731595993042
Epoch: 40, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7456488609313965
Epoch: 41, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7579350471496582
Epoch: 42, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.7114043235778809
Epoch: 43, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.7912344932556152
Epoch: 44, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.7400696277618408
Epoch: 45, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.800872802734375
Epoch: 46, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.6715223789215088
Epoch: 47, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6492903232574463
Epoch: 48, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.7948610782623291
Epoch: 49, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.8678665161132812
Epoch: 50, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.7105681896209717
Epoch: 51, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.7256863117218018
Epoch: 52, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 53 cost time: 0.7397656440734863
Epoch: 53, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.741633415222168
Epoch: 54, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.8021256923675537
Epoch: 55, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.6734194755554199
Epoch: 56, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 57 cost time: 0.763195276260376
Epoch: 57, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 0.7585077285766602
Epoch: 58, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 59 cost time: 0.7764909267425537
Epoch: 59, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 60 cost time: 0.8111481666564941
Epoch: 60, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7114739418029785
Epoch: 61, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.7548463344573975
Epoch: 62, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8245689868927002
Epoch: 63, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 64 cost time: 0.681220531463623
Epoch: 64, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 65 cost time: 0.8724253177642822
Epoch: 65, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7892935276031494
Epoch: 66, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.7977137565612793
Epoch: 67, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 68 cost time: 0.6954338550567627
Epoch: 68, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.6895382404327393
Epoch: 69, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 70 cost time: 0.645317554473877
Epoch: 70, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 71 cost time: 0.7739753723144531
Epoch: 71, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 72 cost time: 0.7862935066223145
Epoch: 72, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 73 cost time: 0.7413327693939209
Epoch: 73, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7684412002563477
Epoch: 74, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 75 cost time: 0.7992923259735107
Epoch: 75, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 76 cost time: 0.8137121200561523
Epoch: 76, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 77 cost time: 0.7861778736114502
Epoch: 77, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 78 cost time: 0.6934797763824463
Epoch: 78, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 79 cost time: 0.7042229175567627
Epoch: 79, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 80 cost time: 0.7347359657287598
Epoch: 80, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 81 cost time: 0.7832057476043701
Epoch: 81, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.8842225074768066
Epoch: 82, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 83 cost time: 0.7378158569335938
Epoch: 83, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.741774320602417
Epoch: 84, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 85 cost time: 0.7071597576141357
Epoch: 85, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 86 cost time: 0.7265186309814453
Epoch: 86, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 87 cost time: 0.7464079856872559
Epoch: 87, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.7261278629302979
Epoch: 88, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 89 cost time: 0.7065746784210205
Epoch: 89, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 90 cost time: 0.7704100608825684
Epoch: 90, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.7552716732025146
Epoch: 91, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.802299976348877
Epoch: 92, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.7640249729156494
Epoch: 93, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 94 cost time: 0.7954576015472412
Epoch: 94, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 95 cost time: 0.749962329864502
Epoch: 95, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 96 cost time: 0.7178347110748291
Epoch: 96, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.903 Test Loss: 0.214 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 97 cost time: 0.6800205707550049
Epoch: 97, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.6853122711181641
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.7594761848449707
Epoch: 99, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.903 Test Loss: 0.214 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 0.8003072738647461
Epoch: 100, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df64_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 45580
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3230831623077393
Epoch: 1, Steps: 7 | Train Loss: 2.476 Vali Loss: 2.535 Vali Acc: 0.069 Test Loss: 2.535 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.7945523262023926
Epoch: 2, Steps: 7 | Train Loss: 2.457 Vali Loss: 2.417 Vali Acc: 0.167 Test Loss: 2.417 Test Acc: 0.167
Validation loss decreased (-0.069419 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 0.7172729969024658
Epoch: 3, Steps: 7 | Train Loss: 2.265 Vali Loss: 2.236 Vali Acc: 0.347 Test Loss: 2.236 Test Acc: 0.347
Validation loss decreased (-0.166643 --> -0.347200).  Saving model ...
Epoch: 4 cost time: 0.7522814273834229
Epoch: 4, Steps: 7 | Train Loss: 2.042 Vali Loss: 2.023 Vali Acc: 0.528 Test Loss: 2.023 Test Acc: 0.528
Validation loss decreased (-0.347200 --> -0.527758).  Saving model ...
Epoch: 5 cost time: 0.7737510204315186
Epoch: 5, Steps: 7 | Train Loss: 1.864 Vali Loss: 1.799 Vali Acc: 0.625 Test Loss: 1.799 Test Acc: 0.625
Validation loss decreased (-0.527758 --> -0.624982).  Saving model ...
Epoch: 6 cost time: 0.6674923896789551
Epoch: 6, Steps: 7 | Train Loss: 1.599 Vali Loss: 1.581 Vali Acc: 0.653 Test Loss: 1.581 Test Acc: 0.653
Validation loss decreased (-0.624982 --> -0.652762).  Saving model ...
Epoch: 7 cost time: 0.6391112804412842
Epoch: 7, Steps: 7 | Train Loss: 1.320 Vali Loss: 1.380 Vali Acc: 0.694 Test Loss: 1.380 Test Acc: 0.694
Validation loss decreased (-0.652762 --> -0.694431).  Saving model ...
Epoch: 8 cost time: 0.6633634567260742
Epoch: 8, Steps: 7 | Train Loss: 1.157 Vali Loss: 1.183 Vali Acc: 0.750 Test Loss: 1.183 Test Acc: 0.750
Validation loss decreased (-0.694431 --> -0.749988).  Saving model ...
Epoch: 9 cost time: 0.6124205589294434
Epoch: 9, Steps: 7 | Train Loss: 0.898 Vali Loss: 1.007 Vali Acc: 0.819 Test Loss: 1.007 Test Acc: 0.819
Validation loss decreased (-0.749988 --> -0.819434).  Saving model ...
Epoch: 10 cost time: 0.6950643062591553
Epoch: 10, Steps: 7 | Train Loss: 0.746 Vali Loss: 0.856 Vali Acc: 0.861 Test Loss: 0.856 Test Acc: 0.861
Validation loss decreased (-0.819434 --> -0.861103).  Saving model ...
Epoch: 11 cost time: 0.6829953193664551
Epoch: 11, Steps: 7 | Train Loss: 0.582 Vali Loss: 0.738 Vali Acc: 0.861 Test Loss: 0.738 Test Acc: 0.861
Validation loss decreased (-0.861103 --> -0.861104).  Saving model ...
Epoch: 12 cost time: 0.6861717700958252
Epoch: 12, Steps: 7 | Train Loss: 0.447 Vali Loss: 0.636 Vali Acc: 0.889 Test Loss: 0.636 Test Acc: 0.889
Validation loss decreased (-0.861104 --> -0.888883).  Saving model ...
Epoch: 13 cost time: 0.643578290939331
Epoch: 13, Steps: 7 | Train Loss: 0.351 Vali Loss: 0.563 Vali Acc: 0.903 Test Loss: 0.563 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902772).  Saving model ...
Epoch: 14 cost time: 0.6861636638641357
Epoch: 14, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.504 Vali Acc: 0.903 Test Loss: 0.504 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 15 cost time: 0.7420854568481445
Epoch: 15, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.466 Vali Acc: 0.903 Test Loss: 0.466 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 16 cost time: 0.7589731216430664
Epoch: 16, Steps: 7 | Train Loss: 0.174 Vali Loss: 0.435 Vali Acc: 0.917 Test Loss: 0.435 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916662).  Saving model ...
Epoch: 17 cost time: 0.7175736427307129
Epoch: 17, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.410 Vali Acc: 0.917 Test Loss: 0.410 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 0.7768056392669678
Epoch: 18, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.384 Vali Acc: 0.917 Test Loss: 0.384 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 19 cost time: 0.6986958980560303
Epoch: 19, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 0.6411395072937012
Epoch: 20, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.364 Vali Acc: 0.917 Test Loss: 0.364 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 21 cost time: 0.8276679515838623
Epoch: 21, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.359 Vali Acc: 0.917 Test Loss: 0.359 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 22 cost time: 0.599900484085083
Epoch: 22, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 23 cost time: 0.6933102607727051
Epoch: 23, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 24 cost time: 0.7324633598327637
Epoch: 24, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 25 cost time: 0.7196743488311768
Epoch: 25, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 0.7684035301208496
Epoch: 26, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 27 cost time: 0.6234424114227295
Epoch: 27, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.7751009464263916
Epoch: 28, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7528877258300781
Epoch: 29, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5944063663482666
Epoch: 30, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.8016853332519531
Epoch: 31, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.7257909774780273
Epoch: 32, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.6909806728363037
Epoch: 33, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7614986896514893
Epoch: 34, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7405447959899902
Epoch: 35, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7677745819091797
Epoch: 36, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.7371969223022461
Epoch: 37, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.7437381744384766
Epoch: 38, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.7428402900695801
Epoch: 39, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.7792675495147705
Epoch: 40, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.7254972457885742
Epoch: 41, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6616055965423584
Epoch: 42, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7526893615722656
Epoch: 43, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7386434078216553
Epoch: 44, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7497258186340332
Epoch: 45, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6832330226898193
Epoch: 46, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6632206439971924
Epoch: 47, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.6783473491668701
Epoch: 48, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.68440842628479
Epoch: 49, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.7654514312744141
Epoch: 50, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm32_nh4_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 42892
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3620874881744385
Epoch: 1, Steps: 7 | Train Loss: 2.689 Vali Loss: 2.554 Vali Acc: 0.083 Test Loss: 2.554 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.743189811706543
Epoch: 2, Steps: 7 | Train Loss: 2.500 Vali Loss: 2.303 Vali Acc: 0.208 Test Loss: 2.303 Test Acc: 0.208
Validation loss decreased (-0.083308 --> -0.208310).  Saving model ...
Epoch: 3 cost time: 0.8232908248901367
Epoch: 3, Steps: 7 | Train Loss: 2.192 Vali Loss: 1.969 Vali Acc: 0.514 Test Loss: 1.969 Test Acc: 0.514
Validation loss decreased (-0.208310 --> -0.513869).  Saving model ...
Epoch: 4 cost time: 0.6871452331542969
Epoch: 4, Steps: 7 | Train Loss: 1.719 Vali Loss: 1.598 Vali Acc: 0.708 Test Loss: 1.598 Test Acc: 0.708
Validation loss decreased (-0.513869 --> -0.708317).  Saving model ...
Epoch: 5 cost time: 0.6602189540863037
Epoch: 5, Steps: 7 | Train Loss: 1.253 Vali Loss: 1.206 Vali Acc: 0.736 Test Loss: 1.206 Test Acc: 0.736
Validation loss decreased (-0.708317 --> -0.736099).  Saving model ...
Epoch: 6 cost time: 0.7444021701812744
Epoch: 6, Steps: 7 | Train Loss: 0.840 Vali Loss: 0.905 Vali Acc: 0.819 Test Loss: 0.905 Test Acc: 0.819
Validation loss decreased (-0.736099 --> -0.819435).  Saving model ...
Epoch: 7 cost time: 0.6830635070800781
Epoch: 7, Steps: 7 | Train Loss: 0.560 Vali Loss: 0.659 Vali Acc: 0.889 Test Loss: 0.659 Test Acc: 0.889
Validation loss decreased (-0.819435 --> -0.888882).  Saving model ...
Epoch: 8 cost time: 0.7654843330383301
Epoch: 8, Steps: 7 | Train Loss: 0.308 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 0.6881248950958252
Epoch: 9, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8219058513641357
Epoch: 10, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.356 Vali Acc: 0.903 Test Loss: 0.356 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 0.6401793956756592
Epoch: 11, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.6758718490600586
Epoch: 12, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.727618932723999
Epoch: 13, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.638134241104126
Epoch: 14, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.7396636009216309
Epoch: 15, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.8171746730804443
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7074272632598877
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7909228801727295
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6853320598602295
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.7722036838531494
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.7177994251251221
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7541546821594238
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8959579467773438
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7956838607788086
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8040175437927246
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7886621952056885
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7201755046844482
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.7989673614501953
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.7201848030090332
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7925269603729248
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.7560534477233887
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.7661576271057129
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.848696231842041
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.704704761505127
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7534832954406738
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6763901710510254
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.754277229309082
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.6582329273223877
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.754328727722168
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 0.7497081756591797
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.6904349327087402
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.6587679386138916
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 0.6940522193908691
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7021558284759521
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6798505783081055
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 0.8068642616271973
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.74143385887146
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.8183579444885254
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6598999500274658
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7279534339904785
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7679898738861084
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 52 cost time: 0.665229320526123
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 0.6979150772094727
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 54 cost time: 0.7118911743164062
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6999475955963135
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7900979518890381
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7522609233856201
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 58 cost time: 0.750741720199585
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 59 cost time: 0.8612048625946045
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 60 cost time: 0.6206245422363281
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 61 cost time: 0.7823710441589355
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 62 cost time: 0.729175329208374
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7169318199157715
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 64 cost time: 0.756066083908081
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7254500389099121
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 66 cost time: 0.6612370014190674
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 67 cost time: 0.6937248706817627
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 68 cost time: 0.7734580039978027
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 69 cost time: 0.7585115432739258
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 70 cost time: 0.701509952545166
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 71 cost time: 0.7180960178375244
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 72 cost time: 0.685075044631958
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 73 cost time: 0.7631769180297852
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.694389820098877
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 75 cost time: 0.6826639175415039
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 76 cost time: 0.7072670459747314
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.6688225269317627
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 78 cost time: 0.684084415435791
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.697723388671875
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 80 cost time: 0.6962490081787109
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.6893751621246338
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 82 cost time: 0.797412633895874
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 83 cost time: 0.7185354232788086
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 84 cost time: 0.7067501544952393
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 85 cost time: 0.8678784370422363
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.6852338314056396
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 87 cost time: 0.7581079006195068
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 88 cost time: 0.6840317249298096
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.7552158832550049
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.6875767707824707
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 91 cost time: 0.676689863204956
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 92 cost time: 0.659010648727417
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.670433759689331
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.6614627838134766
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 0.7747786045074463
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 0.7230653762817383
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 0.7678883075714111
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 98 cost time: 0.7268466949462891
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 99 cost time: 0.7634217739105225
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 100 cost time: 0.767439603805542
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 110764
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.38093638420105
Epoch: 1, Steps: 7 | Train Loss: 2.633 Vali Loss: 2.472 Vali Acc: 0.069 Test Loss: 2.472 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.7396783828735352
Epoch: 2, Steps: 7 | Train Loss: 2.499 Vali Loss: 2.301 Vali Acc: 0.167 Test Loss: 2.301 Test Acc: 0.167
Validation loss decreased (-0.069420 --> -0.166644).  Saving model ...
Epoch: 3 cost time: 0.7234675884246826
Epoch: 3, Steps: 7 | Train Loss: 2.298 Vali Loss: 2.066 Vali Acc: 0.500 Test Loss: 2.066 Test Acc: 0.500
Validation loss decreased (-0.166644 --> -0.499979).  Saving model ...
Epoch: 4 cost time: 0.8126978874206543
Epoch: 4, Steps: 7 | Train Loss: 1.996 Vali Loss: 1.778 Vali Acc: 0.625 Test Loss: 1.778 Test Acc: 0.625
Validation loss decreased (-0.499979 --> -0.624982).  Saving model ...
Epoch: 5 cost time: 0.6783344745635986
Epoch: 5, Steps: 7 | Train Loss: 1.631 Vali Loss: 1.454 Vali Acc: 0.681 Test Loss: 1.454 Test Acc: 0.681
Validation loss decreased (-0.624982 --> -0.680541).  Saving model ...
Epoch: 6 cost time: 0.7297284603118896
Epoch: 6, Steps: 7 | Train Loss: 1.268 Vali Loss: 1.163 Vali Acc: 0.778 Test Loss: 1.163 Test Acc: 0.778
Validation loss decreased (-0.680541 --> -0.777766).  Saving model ...
Epoch: 7 cost time: 0.7990546226501465
Epoch: 7, Steps: 7 | Train Loss: 0.946 Vali Loss: 0.901 Vali Acc: 0.861 Test Loss: 0.901 Test Acc: 0.861
Validation loss decreased (-0.777766 --> -0.861102).  Saving model ...
Epoch: 8 cost time: 0.7588868141174316
Epoch: 8, Steps: 7 | Train Loss: 0.635 Vali Loss: 0.689 Vali Acc: 0.833 Test Loss: 0.689 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6832411289215088
Epoch: 9, Steps: 7 | Train Loss: 0.400 Vali Loss: 0.556 Vali Acc: 0.847 Test Loss: 0.556 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7633802890777588
Epoch: 10, Steps: 7 | Train Loss: 0.267 Vali Loss: 0.467 Vali Acc: 0.861 Test Loss: 0.467 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861106).  Saving model ...
Epoch: 11 cost time: 0.8109314441680908
Epoch: 11, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.396 Vali Acc: 0.903 Test Loss: 0.396 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.7443134784698486
Epoch: 12, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6921405792236328
Epoch: 13, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7178387641906738
Epoch: 14, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.7498002052307129
Epoch: 15, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.7043929100036621
Epoch: 16, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.296 Vali Acc: 0.931 Test Loss: 0.296 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.6497862339019775
Epoch: 17, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9040398597717285
Epoch: 18, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6955196857452393
Epoch: 19, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7101678848266602
Epoch: 20, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.670433521270752
Epoch: 21, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8350491523742676
Epoch: 22, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.8117976188659668
Epoch: 23, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.7181730270385742
Epoch: 24, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.8167891502380371
Epoch: 25, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.7420291900634766
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.7400093078613281
Epoch: 27, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.7219142913818359
Epoch: 28, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6961090564727783
Epoch: 29, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.7572915554046631
Epoch: 30, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.7776706218719482
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.7878692150115967
Epoch: 32, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7731912136077881
Epoch: 33, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.7020058631896973
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.6867079734802246
Epoch: 35, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.7005982398986816
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.6894364356994629
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7196784019470215
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7926380634307861
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7256419658660889
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7643897533416748
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8102514743804932
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7497119903564453
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7503566741943359
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7359669208526611
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6961193084716797
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 65164
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.176546096801758
Epoch: 1, Steps: 7 | Train Loss: 2.707 Vali Loss: 2.668 Vali Acc: 0.097 Test Loss: 2.668 Test Acc: 0.097
Validation loss decreased (inf --> -0.097196).  Saving model ...
Epoch: 2 cost time: 0.7123908996582031
Epoch: 2, Steps: 7 | Train Loss: 2.610 Vali Loss: 2.481 Vali Acc: 0.139 Test Loss: 2.481 Test Acc: 0.139
Validation loss decreased (-0.097196 --> -0.138864).  Saving model ...
Epoch: 3 cost time: 0.7846531867980957
Epoch: 3, Steps: 7 | Train Loss: 2.363 Vali Loss: 2.257 Vali Acc: 0.167 Test Loss: 2.257 Test Acc: 0.167
Validation loss decreased (-0.138864 --> -0.166644).  Saving model ...
Epoch: 4 cost time: 0.8188643455505371
Epoch: 4, Steps: 7 | Train Loss: 2.154 Vali Loss: 1.997 Vali Acc: 0.417 Test Loss: 1.997 Test Acc: 0.417
Validation loss decreased (-0.166644 --> -0.416647).  Saving model ...
Epoch: 5 cost time: 0.8331611156463623
Epoch: 5, Steps: 7 | Train Loss: 1.891 Vali Loss: 1.716 Vali Acc: 0.625 Test Loss: 1.716 Test Acc: 0.625
Validation loss decreased (-0.416647 --> -0.624983).  Saving model ...
Epoch: 6 cost time: 0.7645719051361084
Epoch: 6, Steps: 7 | Train Loss: 1.621 Vali Loss: 1.439 Vali Acc: 0.764 Test Loss: 1.439 Test Acc: 0.764
Validation loss decreased (-0.624983 --> -0.763875).  Saving model ...
Epoch: 7 cost time: 0.819972038269043
Epoch: 7, Steps: 7 | Train Loss: 1.272 Vali Loss: 1.179 Vali Acc: 0.819 Test Loss: 1.179 Test Acc: 0.819
Validation loss decreased (-0.763875 --> -0.819433).  Saving model ...
Epoch: 8 cost time: 0.7668697834014893
Epoch: 8, Steps: 7 | Train Loss: 0.933 Vali Loss: 0.941 Vali Acc: 0.875 Test Loss: 0.941 Test Acc: 0.875
Validation loss decreased (-0.819433 --> -0.874991).  Saving model ...
Epoch: 9 cost time: 0.7811386585235596
Epoch: 9, Steps: 7 | Train Loss: 0.700 Vali Loss: 0.731 Vali Acc: 0.875 Test Loss: 0.731 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874993).  Saving model ...
Epoch: 10 cost time: 0.7365341186523438
Epoch: 10, Steps: 7 | Train Loss: 0.484 Vali Loss: 0.588 Vali Acc: 0.903 Test Loss: 0.588 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902772).  Saving model ...
Epoch: 11 cost time: 0.8061614036560059
Epoch: 11, Steps: 7 | Train Loss: 0.304 Vali Loss: 0.508 Vali Acc: 0.875 Test Loss: 0.508 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.744049072265625
Epoch: 12, Steps: 7 | Train Loss: 0.227 Vali Loss: 0.426 Vali Acc: 0.889 Test Loss: 0.426 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8546350002288818
Epoch: 13, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7631015777587891
Epoch: 14, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 0.7508950233459473
Epoch: 15, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7718839645385742
Epoch: 16, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.6968178749084473
Epoch: 17, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.750394344329834
Epoch: 18, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9113495349884033
Epoch: 19, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.843714714050293
Epoch: 20, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.7940049171447754
Epoch: 21, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.7883071899414062
Epoch: 22, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8662266731262207
Epoch: 23, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.8280951976776123
Epoch: 24, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.6744956970214844
Epoch: 25, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.8294458389282227
Epoch: 26, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.7804896831512451
Epoch: 27, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.6980998516082764
Epoch: 28, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.7968599796295166
Epoch: 29, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8061332702636719
Epoch: 30, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.8264420032501221
Epoch: 31, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7796266078948975
Epoch: 32, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7771494388580322
Epoch: 33, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.7663242816925049
Epoch: 34, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.6992378234863281
Epoch: 35, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.7729475498199463
Epoch: 36, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.8157286643981934
Epoch: 37, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.7512943744659424
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7992901802062988
Epoch: 39, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7530930042266846
Epoch: 40, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7103817462921143
Epoch: 41, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7688124179840088
Epoch: 42, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.80177903175354
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.9538059234619141
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.7750730514526367
Epoch: 45, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9508876800537109
Epoch: 46, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.767941951751709
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.6969270706176758
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.7976884841918945
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8538353443145752
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.7915868759155273
Epoch: 51, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7791345119476318
Epoch: 52, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.7725553512573242
Epoch: 53, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 0.766547679901123
Epoch: 54, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 0.8076708316802979
Epoch: 55, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 0.8075907230377197
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 0.6927111148834229
Epoch: 57, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7246136665344238
Epoch: 58, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7860689163208008
Epoch: 59, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.7560746669769287
Epoch: 60, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 0.7156686782836914
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7571592330932617
Epoch: 62, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.8106260299682617
Epoch: 63, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.7922546863555908
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.7396531105041504
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.7552728652954102
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.7742564678192139
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.7755486965179443
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 0.755882740020752
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 0.7630918025970459
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 0.7805514335632324
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 0.7818112373352051
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 73 cost time: 0.79449462890625
Epoch: 73, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.8015859127044678
Epoch: 74, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.7744951248168945
Epoch: 75, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 76 cost time: 0.8155093193054199
Epoch: 76, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 77 cost time: 0.774641752243042
Epoch: 77, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 78 cost time: 0.8303251266479492
Epoch: 78, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930553).  Saving model ...
Epoch: 79 cost time: 0.813284158706665
Epoch: 79, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 80 cost time: 0.7922112941741943
Epoch: 80, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 81 cost time: 0.7595760822296143
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.8574206829071045
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.7617418766021729
Epoch: 83, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.7735657691955566
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.7613115310668945
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.7374839782714844
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.7414357662200928
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.7958652973175049
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 0.653695821762085
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.6773686408996582
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 50668
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df256_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.295203447341919
Epoch: 1, Steps: 7 | Train Loss: 2.665 Vali Loss: 2.663 Vali Acc: 0.097 Test Loss: 2.663 Test Acc: 0.097
Validation loss decreased (inf --> -0.097196).  Saving model ...
Epoch: 2 cost time: 0.7271125316619873
Epoch: 2, Steps: 7 | Train Loss: 2.525 Vali Loss: 2.512 Vali Acc: 0.167 Test Loss: 2.512 Test Acc: 0.167
Validation loss decreased (-0.097196 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 0.7887973785400391
Epoch: 3, Steps: 7 | Train Loss: 2.366 Vali Loss: 2.315 Vali Acc: 0.278 Test Loss: 2.315 Test Acc: 0.278
Validation loss decreased (-0.166642 --> -0.277755).  Saving model ...
Epoch: 4 cost time: 0.8760309219360352
Epoch: 4, Steps: 7 | Train Loss: 2.162 Vali Loss: 2.078 Vali Acc: 0.431 Test Loss: 2.078 Test Acc: 0.431
Validation loss decreased (-0.277755 --> -0.430535).  Saving model ...
Epoch: 5 cost time: 0.7855098247528076
Epoch: 5, Steps: 7 | Train Loss: 1.878 Vali Loss: 1.827 Vali Acc: 0.611 Test Loss: 1.827 Test Acc: 0.611
Validation loss decreased (-0.430535 --> -0.611093).  Saving model ...
Epoch: 6 cost time: 0.6847753524780273
Epoch: 6, Steps: 7 | Train Loss: 1.548 Vali Loss: 1.553 Vali Acc: 0.722 Test Loss: 1.553 Test Acc: 0.722
Validation loss decreased (-0.611093 --> -0.722207).  Saving model ...
Epoch: 7 cost time: 0.7110378742218018
Epoch: 7, Steps: 7 | Train Loss: 1.364 Vali Loss: 1.285 Vali Acc: 0.750 Test Loss: 1.285 Test Acc: 0.750
Validation loss decreased (-0.722207 --> -0.749987).  Saving model ...
Epoch: 8 cost time: 0.6981661319732666
Epoch: 8, Steps: 7 | Train Loss: 1.075 Vali Loss: 1.028 Vali Acc: 0.792 Test Loss: 1.028 Test Acc: 0.792
Validation loss decreased (-0.749987 --> -0.791656).  Saving model ...
Epoch: 9 cost time: 0.7010655403137207
Epoch: 9, Steps: 7 | Train Loss: 0.801 Vali Loss: 0.834 Vali Acc: 0.833 Test Loss: 0.834 Test Acc: 0.833
Validation loss decreased (-0.791656 --> -0.833325).  Saving model ...
Epoch: 10 cost time: 0.7407853603363037
Epoch: 10, Steps: 7 | Train Loss: 0.560 Vali Loss: 0.676 Vali Acc: 0.833 Test Loss: 0.676 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833327).  Saving model ...
Epoch: 11 cost time: 0.7543604373931885
Epoch: 11, Steps: 7 | Train Loss: 0.422 Vali Loss: 0.573 Vali Acc: 0.819 Test Loss: 0.573 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6782407760620117
Epoch: 12, Steps: 7 | Train Loss: 0.302 Vali Loss: 0.499 Vali Acc: 0.833 Test Loss: 0.499 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 13 cost time: 0.6544723510742188
Epoch: 13, Steps: 7 | Train Loss: 0.216 Vali Loss: 0.448 Vali Acc: 0.833 Test Loss: 0.448 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 0.6415839195251465
Epoch: 14, Steps: 7 | Train Loss: 0.165 Vali Loss: 0.416 Vali Acc: 0.847 Test Loss: 0.416 Test Acc: 0.847
Validation loss decreased (-0.833329 --> -0.847218).  Saving model ...
Epoch: 15 cost time: 0.678215742111206
Epoch: 15, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
Validation loss decreased (-0.847218 --> -0.874996).  Saving model ...
Epoch: 16 cost time: 0.7092573642730713
Epoch: 16, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 0.7974770069122314
Epoch: 17, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.355 Vali Acc: 0.861 Test Loss: 0.355 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7591066360473633
Epoch: 18, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.353 Vali Acc: 0.861 Test Loss: 0.353 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.810187816619873
Epoch: 19, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 20 cost time: 0.7592499256134033
Epoch: 20, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.336 Vali Acc: 0.875 Test Loss: 0.336 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 21 cost time: 0.8113651275634766
Epoch: 21, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 22 cost time: 0.7282683849334717
Epoch: 22, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.7329635620117188
Epoch: 23, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7742469310760498
Epoch: 24, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7116048336029053
Epoch: 25, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.7905545234680176
Epoch: 26, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.7826485633850098
Epoch: 27, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.7710821628570557
Epoch: 28, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7795114517211914
Epoch: 29, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.774590253829956
Epoch: 30, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7966043949127197
Epoch: 31, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7659831047058105
Epoch: 32, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.7629315853118896
Epoch: 33, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.6720476150512695
Epoch: 34, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.8050787448883057
Epoch: 35, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6913158893585205
Epoch: 36, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.7970795631408691
Epoch: 37, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7855093479156494
Epoch: 38, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.7841451168060303
Epoch: 39, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.7389671802520752
Epoch: 40, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.7724127769470215
Epoch: 41, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.7142775058746338
Epoch: 42, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7561423778533936
Epoch: 43, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6681582927703857
Epoch: 44, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.7412705421447754
Epoch: 45, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7556338310241699
Epoch: 46, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.7674210071563721
Epoch: 47, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.7184453010559082
Epoch: 48, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8161313533782959
Epoch: 49, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.707916259765625
Epoch: 50, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7035510540008545
Epoch: 51, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.7767453193664551
Epoch: 52, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7245430946350098
Epoch: 53, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.712893009185791
Epoch: 54, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 0.7424869537353516
Epoch: 55, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7418005466461182
Epoch: 56, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.6546475887298584
Epoch: 57, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.723130464553833
Epoch: 58, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6547636985778809
Epoch: 59, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.6816921234130859
Epoch: 60, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.7120635509490967
Epoch: 61, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.7391674518585205
Epoch: 62, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.6934342384338379
Epoch: 63, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.7248170375823975
Epoch: 64, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df256_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 43084
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3447065353393555
Epoch: 1, Steps: 7 | Train Loss: 2.623 Vali Loss: 2.535 Vali Acc: 0.125 Test Loss: 2.535 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.7765457630157471
Epoch: 2, Steps: 7 | Train Loss: 2.591 Vali Loss: 2.454 Vali Acc: 0.125 Test Loss: 2.454 Test Acc: 0.125
Validation loss decreased (-0.124975 --> -0.124975).  Saving model ...
Epoch: 3 cost time: 0.6691315174102783
Epoch: 3, Steps: 7 | Train Loss: 2.368 Vali Loss: 2.322 Vali Acc: 0.167 Test Loss: 2.322 Test Acc: 0.167
Validation loss decreased (-0.124975 --> -0.166643).  Saving model ...
Epoch: 4 cost time: 0.7705521583557129
Epoch: 4, Steps: 7 | Train Loss: 2.248 Vali Loss: 2.164 Vali Acc: 0.333 Test Loss: 2.164 Test Acc: 0.333
Validation loss decreased (-0.166643 --> -0.333312).  Saving model ...
Epoch: 5 cost time: 0.6640236377716064
Epoch: 5, Steps: 7 | Train Loss: 2.083 Vali Loss: 1.986 Vali Acc: 0.472 Test Loss: 1.986 Test Acc: 0.472
Validation loss decreased (-0.333312 --> -0.472202).  Saving model ...
Epoch: 6 cost time: 0.7309002876281738
Epoch: 6, Steps: 7 | Train Loss: 1.914 Vali Loss: 1.798 Vali Acc: 0.583 Test Loss: 1.798 Test Acc: 0.583
Validation loss decreased (-0.472202 --> -0.583315).  Saving model ...
Epoch: 7 cost time: 0.7480814456939697
Epoch: 7, Steps: 7 | Train Loss: 1.704 Vali Loss: 1.598 Vali Acc: 0.639 Test Loss: 1.598 Test Acc: 0.639
Validation loss decreased (-0.583315 --> -0.638873).  Saving model ...
Epoch: 8 cost time: 0.6948785781860352
Epoch: 8, Steps: 7 | Train Loss: 1.450 Vali Loss: 1.401 Vali Acc: 0.722 Test Loss: 1.401 Test Acc: 0.722
Validation loss decreased (-0.638873 --> -0.722208).  Saving model ...
Epoch: 9 cost time: 0.7716915607452393
Epoch: 9, Steps: 7 | Train Loss: 1.222 Vali Loss: 1.215 Vali Acc: 0.750 Test Loss: 1.215 Test Acc: 0.750
Validation loss decreased (-0.722208 --> -0.749988).  Saving model ...
Epoch: 10 cost time: 0.8746185302734375
Epoch: 10, Steps: 7 | Train Loss: 0.974 Vali Loss: 1.049 Vali Acc: 0.778 Test Loss: 1.049 Test Acc: 0.778
Validation loss decreased (-0.749988 --> -0.777767).  Saving model ...
Epoch: 11 cost time: 0.6976850032806396
Epoch: 11, Steps: 7 | Train Loss: 0.808 Vali Loss: 0.890 Vali Acc: 0.792 Test Loss: 0.890 Test Acc: 0.792
Validation loss decreased (-0.777767 --> -0.791658).  Saving model ...
Epoch: 12 cost time: 0.7288119792938232
Epoch: 12, Steps: 7 | Train Loss: 0.645 Vali Loss: 0.764 Vali Acc: 0.819 Test Loss: 0.764 Test Acc: 0.819
Validation loss decreased (-0.791658 --> -0.819437).  Saving model ...
Epoch: 13 cost time: 0.6769921779632568
Epoch: 13, Steps: 7 | Train Loss: 0.506 Vali Loss: 0.649 Vali Acc: 0.847 Test Loss: 0.649 Test Acc: 0.847
Validation loss decreased (-0.819437 --> -0.847216).  Saving model ...
Epoch: 14 cost time: 0.7452089786529541
Epoch: 14, Steps: 7 | Train Loss: 0.406 Vali Loss: 0.569 Vali Acc: 0.847 Test Loss: 0.569 Test Acc: 0.847
Validation loss decreased (-0.847216 --> -0.847217).  Saving model ...
Epoch: 15 cost time: 0.7712650299072266
Epoch: 15, Steps: 7 | Train Loss: 0.302 Vali Loss: 0.508 Vali Acc: 0.833 Test Loss: 0.508 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7979860305786133
Epoch: 16, Steps: 7 | Train Loss: 0.235 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7386865615844727
Epoch: 17, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874996).  Saving model ...
Epoch: 18 cost time: 0.7048170566558838
Epoch: 18, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6832709312438965
Epoch: 19, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6791136264801025
Epoch: 20, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 21 cost time: 0.7415564060211182
Epoch: 21, Steps: 7 | Train Loss: 0.096 Vali Loss: 0.349 Vali Acc: 0.861 Test Loss: 0.349 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7166123390197754
Epoch: 22, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 23 cost time: 0.752854585647583
Epoch: 23, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 24 cost time: 0.7236347198486328
Epoch: 24, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.319 Vali Acc: 0.861 Test Loss: 0.319 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7374660968780518
Epoch: 25, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 26 cost time: 0.7214369773864746
Epoch: 26, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.7833535671234131
Epoch: 27, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.7932641506195068
Epoch: 28, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.8247098922729492
Epoch: 29, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.7761838436126709
Epoch: 30, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.6933748722076416
Epoch: 31, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7866430282592773
Epoch: 32, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.800722599029541
Epoch: 33, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7251977920532227
Epoch: 34, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.8290629386901855
Epoch: 35, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.7912278175354004
Epoch: 36, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.7756466865539551
Epoch: 37, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.7305212020874023
Epoch: 38, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.7169342041015625
Epoch: 39, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.7803246974945068
Epoch: 40, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.7893702983856201
Epoch: 41, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.7072799205780029
Epoch: 42, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.774198055267334
Epoch: 43, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.7691099643707275
Epoch: 44, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.762017011642456
Epoch: 45, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.7238047122955322
Epoch: 46, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.7670490741729736
Epoch: 47, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6922831535339355
Epoch: 48, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7155811786651611
Epoch: 49, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.7209773063659668
Epoch: 50, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 0.7410030364990234
Epoch: 51, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 0.7540795803070068
Epoch: 52, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 0.8406586647033691
Epoch: 53, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.7803363800048828
Epoch: 54, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 0.7477233409881592
Epoch: 55, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7571649551391602
Epoch: 56, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 0.7296285629272461
Epoch: 57, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 0.6409120559692383
Epoch: 58, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 0.7558729648590088
Epoch: 59, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 60 cost time: 0.6917626857757568
Epoch: 60, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 0.7439677715301514
Epoch: 61, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 62 cost time: 0.79443359375
Epoch: 62, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 63 cost time: 0.77132248878479
Epoch: 63, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 64 cost time: 0.7807860374450684
Epoch: 64, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 65 cost time: 0.7171890735626221
Epoch: 65, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 66 cost time: 0.6984155178070068
Epoch: 66, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7624967098236084
Epoch: 67, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.7226791381835938
Epoch: 68, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.8229000568389893
Epoch: 69, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 70 cost time: 0.7820966243743896
Epoch: 70, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 71 cost time: 0.7580471038818359
Epoch: 71, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 72 cost time: 0.7800264358520508
Epoch: 72, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 73 cost time: 0.8213522434234619
Epoch: 73, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7265617847442627
Epoch: 74, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.8532955646514893
Epoch: 75, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 76 cost time: 0.6990871429443359
Epoch: 76, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 77 cost time: 0.6967837810516357
Epoch: 77, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 78 cost time: 0.7009878158569336
Epoch: 78, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 79 cost time: 0.6576738357543945
Epoch: 79, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 80 cost time: 0.7237763404846191
Epoch: 80, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 81 cost time: 0.6438138484954834
Epoch: 81, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 82 cost time: 0.7303588390350342
Epoch: 82, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 83 cost time: 0.6570770740509033
Epoch: 83, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.7038733959197998
Epoch: 84, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 85 cost time: 0.6907544136047363
Epoch: 85, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 86 cost time: 0.7322697639465332
Epoch: 86, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 87 cost time: 0.7120695114135742
Epoch: 87, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 88 cost time: 0.6959691047668457
Epoch: 88, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.7033896446228027
Epoch: 89, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 90 cost time: 0.7819907665252686
Epoch: 90, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.7882306575775146
Epoch: 91, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 92 cost time: 0.7105808258056641
Epoch: 92, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 93 cost time: 0.7014923095703125
Epoch: 93, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.6694455146789551
Epoch: 94, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.931 Test Loss: 0.177 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 95 cost time: 0.6484851837158203
Epoch: 95, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 96 cost time: 0.6957743167877197
Epoch: 96, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 97 cost time: 0.7801122665405273
Epoch: 97, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.7085652351379395
Epoch: 98, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.6690089702606201
Epoch: 99, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 0.7322432994842529
Epoch: 100, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 37132
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df256_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2569971084594727
Epoch: 1, Steps: 7 | Train Loss: 2.608 Vali Loss: 2.564 Vali Acc: 0.083 Test Loss: 2.564 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.6993236541748047
Epoch: 2, Steps: 7 | Train Loss: 2.499 Vali Loss: 2.455 Vali Acc: 0.083 Test Loss: 2.455 Test Acc: 0.083
Validation loss decreased (-0.083308 --> -0.083309).  Saving model ...
Epoch: 3 cost time: 0.7086963653564453
Epoch: 3, Steps: 7 | Train Loss: 2.439 Vali Loss: 2.328 Vali Acc: 0.208 Test Loss: 2.328 Test Acc: 0.208
Validation loss decreased (-0.083309 --> -0.208310).  Saving model ...
Epoch: 4 cost time: 0.6956095695495605
Epoch: 4, Steps: 7 | Train Loss: 2.390 Vali Loss: 2.188 Vali Acc: 0.347 Test Loss: 2.188 Test Acc: 0.347
Validation loss decreased (-0.208310 --> -0.347200).  Saving model ...
Epoch: 5 cost time: 0.775956392288208
Epoch: 5, Steps: 7 | Train Loss: 2.106 Vali Loss: 2.038 Vali Acc: 0.472 Test Loss: 2.038 Test Acc: 0.472
Validation loss decreased (-0.347200 --> -0.472202).  Saving model ...
Epoch: 6 cost time: 0.677264928817749
Epoch: 6, Steps: 7 | Train Loss: 1.984 Vali Loss: 1.888 Vali Acc: 0.569 Test Loss: 1.888 Test Acc: 0.569
Validation loss decreased (-0.472202 --> -0.569426).  Saving model ...
Epoch: 7 cost time: 0.7976236343383789
Epoch: 7, Steps: 7 | Train Loss: 1.789 Vali Loss: 1.728 Vali Acc: 0.639 Test Loss: 1.728 Test Acc: 0.639
Validation loss decreased (-0.569426 --> -0.638872).  Saving model ...
Epoch: 8 cost time: 0.7785682678222656
Epoch: 8, Steps: 7 | Train Loss: 1.613 Vali Loss: 1.571 Vali Acc: 0.694 Test Loss: 1.571 Test Acc: 0.694
Validation loss decreased (-0.638872 --> -0.694429).  Saving model ...
Epoch: 9 cost time: 0.7766664028167725
Epoch: 9, Steps: 7 | Train Loss: 1.492 Vali Loss: 1.409 Vali Acc: 0.778 Test Loss: 1.409 Test Acc: 0.778
Validation loss decreased (-0.694429 --> -0.777764).  Saving model ...
Epoch: 10 cost time: 0.6607582569122314
Epoch: 10, Steps: 7 | Train Loss: 1.273 Vali Loss: 1.248 Vali Acc: 0.833 Test Loss: 1.248 Test Acc: 0.833
Validation loss decreased (-0.777764 --> -0.833321).  Saving model ...
Epoch: 11 cost time: 0.724475622177124
Epoch: 11, Steps: 7 | Train Loss: 1.058 Vali Loss: 1.105 Vali Acc: 0.847 Test Loss: 1.105 Test Acc: 0.847
Validation loss decreased (-0.833321 --> -0.847211).  Saving model ...
Epoch: 12 cost time: 0.6320705413818359
Epoch: 12, Steps: 7 | Train Loss: 0.905 Vali Loss: 0.973 Vali Acc: 0.847 Test Loss: 0.973 Test Acc: 0.847
Validation loss decreased (-0.847211 --> -0.847212).  Saving model ...
Epoch: 13 cost time: 0.8140215873718262
Epoch: 13, Steps: 7 | Train Loss: 0.770 Vali Loss: 0.858 Vali Acc: 0.861 Test Loss: 0.858 Test Acc: 0.861
Validation loss decreased (-0.847212 --> -0.861103).  Saving model ...
Epoch: 14 cost time: 0.8064193725585938
Epoch: 14, Steps: 7 | Train Loss: 0.624 Vali Loss: 0.767 Vali Acc: 0.861 Test Loss: 0.767 Test Acc: 0.861
Validation loss decreased (-0.861103 --> -0.861103).  Saving model ...
Epoch: 15 cost time: 0.8002262115478516
Epoch: 15, Steps: 7 | Train Loss: 0.527 Vali Loss: 0.693 Vali Acc: 0.861 Test Loss: 0.693 Test Acc: 0.861
Validation loss decreased (-0.861103 --> -0.861104).  Saving model ...
Epoch: 16 cost time: 0.7297801971435547
Epoch: 16, Steps: 7 | Train Loss: 0.445 Vali Loss: 0.623 Vali Acc: 0.889 Test Loss: 0.623 Test Acc: 0.889
Validation loss decreased (-0.861104 --> -0.888883).  Saving model ...
Epoch: 17 cost time: 0.6888246536254883
Epoch: 17, Steps: 7 | Train Loss: 0.364 Vali Loss: 0.564 Vali Acc: 0.889 Test Loss: 0.564 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 18 cost time: 0.7264688014984131
Epoch: 18, Steps: 7 | Train Loss: 0.300 Vali Loss: 0.526 Vali Acc: 0.889 Test Loss: 0.526 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 19 cost time: 0.6896693706512451
Epoch: 19, Steps: 7 | Train Loss: 0.237 Vali Loss: 0.501 Vali Acc: 0.889 Test Loss: 0.501 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 20 cost time: 0.7023308277130127
Epoch: 20, Steps: 7 | Train Loss: 0.234 Vali Loss: 0.491 Vali Acc: 0.889 Test Loss: 0.491 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 21 cost time: 0.6971871852874756
Epoch: 21, Steps: 7 | Train Loss: 0.190 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 22 cost time: 0.8326823711395264
Epoch: 22, Steps: 7 | Train Loss: 0.166 Vali Loss: 0.448 Vali Acc: 0.889 Test Loss: 0.448 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 23 cost time: 0.630866289138794
Epoch: 23, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.433 Vali Acc: 0.889 Test Loss: 0.433 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 24 cost time: 0.7256014347076416
Epoch: 24, Steps: 7 | Train Loss: 0.132 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 25 cost time: 0.7290971279144287
Epoch: 25, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.402 Vali Acc: 0.889 Test Loss: 0.402 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 26 cost time: 0.7789397239685059
Epoch: 26, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.387 Vali Acc: 0.903 Test Loss: 0.387 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 27 cost time: 0.6941561698913574
Epoch: 27, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.373 Vali Acc: 0.917 Test Loss: 0.373 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 28 cost time: 0.7958741188049316
Epoch: 28, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 29 cost time: 0.7416083812713623
Epoch: 29, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.360 Vali Acc: 0.931 Test Loss: 0.360 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 30 cost time: 0.7402877807617188
Epoch: 30, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.356 Vali Acc: 0.931 Test Loss: 0.356 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 31 cost time: 0.6437642574310303
Epoch: 31, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7031455039978027
Epoch: 32, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6893835067749023
Epoch: 33, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.343 Vali Acc: 0.917 Test Loss: 0.343 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6616499423980713
Epoch: 34, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6681156158447266
Epoch: 35, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.326 Vali Acc: 0.944 Test Loss: 0.326 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 36 cost time: 0.778867244720459
Epoch: 36, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.321 Vali Acc: 0.944 Test Loss: 0.321 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 37 cost time: 0.7777700424194336
Epoch: 37, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.317 Vali Acc: 0.944 Test Loss: 0.317 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 38 cost time: 0.7782697677612305
Epoch: 38, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 39 cost time: 0.8001258373260498
Epoch: 39, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 40 cost time: 0.6878621578216553
Epoch: 40, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.304 Vali Acc: 0.944 Test Loss: 0.304 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 41 cost time: 0.771784782409668
Epoch: 41, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.302 Vali Acc: 0.944 Test Loss: 0.302 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 42 cost time: 0.6779100894927979
Epoch: 42, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.296 Vali Acc: 0.944 Test Loss: 0.296 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 43 cost time: 0.7809536457061768
Epoch: 43, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.292 Vali Acc: 0.944 Test Loss: 0.292 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.7580657005310059
Epoch: 44, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.7570633888244629
Epoch: 45, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.7540647983551025
Epoch: 46, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.283 Vali Acc: 0.944 Test Loss: 0.283 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.6577138900756836
Epoch: 47, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.7631003856658936
Epoch: 48, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.727285623550415
Epoch: 49, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.6838009357452393
Epoch: 50, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.7174756526947021
Epoch: 51, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.7842648029327393
Epoch: 52, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 0.7286331653594971
Epoch: 53, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 0.7132289409637451
Epoch: 54, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.7357311248779297
Epoch: 55, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 0.7453939914703369
Epoch: 56, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6888692378997803
Epoch: 57, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.7184820175170898
Epoch: 58, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 0.7090976238250732
Epoch: 59, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 0.7081825733184814
Epoch: 60, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 0.659233808517456
Epoch: 61, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 62 cost time: 0.698387622833252
Epoch: 62, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7235188484191895
Epoch: 63, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.7502861022949219
Epoch: 64, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.7835736274719238
Epoch: 65, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 66 cost time: 0.7796659469604492
Epoch: 66, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 67 cost time: 0.7818646430969238
Epoch: 67, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 68 cost time: 0.7159848213195801
Epoch: 68, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 69 cost time: 0.7362394332885742
Epoch: 69, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 70 cost time: 0.8085341453552246
Epoch: 70, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.801565408706665
Epoch: 71, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.8054463863372803
Epoch: 72, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 73 cost time: 0.7915318012237549
Epoch: 73, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 74 cost time: 0.8200247287750244
Epoch: 74, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.8431479930877686
Epoch: 75, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.8355386257171631
Epoch: 76, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.7633016109466553
Epoch: 77, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 78 cost time: 0.7858772277832031
Epoch: 78, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 79 cost time: 0.7734107971191406
Epoch: 79, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 80 cost time: 0.8169140815734863
Epoch: 80, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.789332389831543
Epoch: 81, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 82 cost time: 0.811711311340332
Epoch: 82, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 83 cost time: 0.7521276473999023
Epoch: 83, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 84 cost time: 0.6581640243530273
Epoch: 84, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.8119008541107178
Epoch: 85, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.805530309677124
Epoch: 86, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.7987616062164307
Epoch: 87, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.8124897480010986
Epoch: 88, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 89 cost time: 0.8152346611022949
Epoch: 89, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 90 cost time: 0.8740465641021729
Epoch: 90, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 91 cost time: 0.770780086517334
Epoch: 91, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.7907629013061523
Epoch: 92, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.8077950477600098
Epoch: 93, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 94 cost time: 0.8296988010406494
Epoch: 94, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 95 cost time: 0.7866482734680176
Epoch: 95, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 96 cost time: 0.7684118747711182
Epoch: 96, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 97 cost time: 0.7344141006469727
Epoch: 97, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 98 cost time: 0.8105909824371338
Epoch: 98, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.8244125843048096
Epoch: 99, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.7367386817932129
Epoch: 100, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df256_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 33484
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.201984167098999
Epoch: 1, Steps: 7 | Train Loss: 2.641 Vali Loss: 2.552 Vali Acc: 0.056 Test Loss: 2.552 Test Acc: 0.056
Validation loss decreased (inf --> -0.055530).  Saving model ...
Epoch: 2 cost time: 0.790062665939331
Epoch: 2, Steps: 7 | Train Loss: 2.594 Vali Loss: 2.462 Vali Acc: 0.083 Test Loss: 2.462 Test Acc: 0.083
Validation loss decreased (-0.055530 --> -0.083309).  Saving model ...
Epoch: 3 cost time: 0.7631988525390625
Epoch: 3, Steps: 7 | Train Loss: 2.541 Vali Loss: 2.347 Vali Acc: 0.139 Test Loss: 2.347 Test Acc: 0.139
Validation loss decreased (-0.083309 --> -0.138865).  Saving model ...
Epoch: 4 cost time: 0.783832311630249
Epoch: 4, Steps: 7 | Train Loss: 2.404 Vali Loss: 2.219 Vali Acc: 0.208 Test Loss: 2.219 Test Acc: 0.208
Validation loss decreased (-0.138865 --> -0.208311).  Saving model ...
Epoch: 5 cost time: 0.740189790725708
Epoch: 5, Steps: 7 | Train Loss: 2.207 Vali Loss: 2.080 Vali Acc: 0.292 Test Loss: 2.080 Test Acc: 0.292
Validation loss decreased (-0.208311 --> -0.291646).  Saving model ...
Epoch: 6 cost time: 0.7213342189788818
Epoch: 6, Steps: 7 | Train Loss: 2.029 Vali Loss: 1.944 Vali Acc: 0.444 Test Loss: 1.944 Test Acc: 0.444
Validation loss decreased (-0.291646 --> -0.444425).  Saving model ...
Epoch: 7 cost time: 0.7374465465545654
Epoch: 7, Steps: 7 | Train Loss: 1.861 Vali Loss: 1.809 Vali Acc: 0.542 Test Loss: 1.809 Test Acc: 0.542
Validation loss decreased (-0.444425 --> -0.541649).  Saving model ...
Epoch: 8 cost time: 0.805016040802002
Epoch: 8, Steps: 7 | Train Loss: 1.665 Vali Loss: 1.676 Vali Acc: 0.611 Test Loss: 1.676 Test Acc: 0.611
Validation loss decreased (-0.541649 --> -0.611094).  Saving model ...
Epoch: 9 cost time: 0.828667402267456
Epoch: 9, Steps: 7 | Train Loss: 1.565 Vali Loss: 1.537 Vali Acc: 0.694 Test Loss: 1.537 Test Acc: 0.694
Validation loss decreased (-0.611094 --> -0.694429).  Saving model ...
Epoch: 10 cost time: 0.7320592403411865
Epoch: 10, Steps: 7 | Train Loss: 1.400 Vali Loss: 1.399 Vali Acc: 0.722 Test Loss: 1.399 Test Acc: 0.722
Validation loss decreased (-0.694429 --> -0.722208).  Saving model ...
Epoch: 11 cost time: 0.7523009777069092
Epoch: 11, Steps: 7 | Train Loss: 1.234 Vali Loss: 1.269 Vali Acc: 0.750 Test Loss: 1.269 Test Acc: 0.750
Validation loss decreased (-0.722208 --> -0.749987).  Saving model ...
Epoch: 12 cost time: 0.7340104579925537
Epoch: 12, Steps: 7 | Train Loss: 1.117 Vali Loss: 1.145 Vali Acc: 0.750 Test Loss: 1.145 Test Acc: 0.750
Validation loss decreased (-0.749987 --> -0.749989).  Saving model ...
Epoch: 13 cost time: 0.7389531135559082
Epoch: 13, Steps: 7 | Train Loss: 0.931 Vali Loss: 1.022 Vali Acc: 0.792 Test Loss: 1.022 Test Acc: 0.792
Validation loss decreased (-0.749989 --> -0.791656).  Saving model ...
Epoch: 14 cost time: 0.7718632221221924
Epoch: 14, Steps: 7 | Train Loss: 0.857 Vali Loss: 0.913 Vali Acc: 0.833 Test Loss: 0.913 Test Acc: 0.833
Validation loss decreased (-0.791656 --> -0.833324).  Saving model ...
Epoch: 15 cost time: 0.7407989501953125
Epoch: 15, Steps: 7 | Train Loss: 0.706 Vali Loss: 0.820 Vali Acc: 0.875 Test Loss: 0.820 Test Acc: 0.875
Validation loss decreased (-0.833324 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.8397948741912842
Epoch: 16, Steps: 7 | Train Loss: 0.579 Vali Loss: 0.741 Vali Acc: 0.903 Test Loss: 0.741 Test Acc: 0.903
Validation loss decreased (-0.874992 --> -0.902770).  Saving model ...
Epoch: 17 cost time: 0.7668440341949463
Epoch: 17, Steps: 7 | Train Loss: 0.502 Vali Loss: 0.673 Vali Acc: 0.903 Test Loss: 0.673 Test Acc: 0.903
Validation loss decreased (-0.902770 --> -0.902771).  Saving model ...
Epoch: 18 cost time: 0.6886336803436279
Epoch: 18, Steps: 7 | Train Loss: 0.421 Vali Loss: 0.630 Vali Acc: 0.903 Test Loss: 0.630 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902771).  Saving model ...
Epoch: 19 cost time: 0.7630500793457031
Epoch: 19, Steps: 7 | Train Loss: 0.366 Vali Loss: 0.587 Vali Acc: 0.903 Test Loss: 0.587 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902772).  Saving model ...
Epoch: 20 cost time: 0.7488808631896973
Epoch: 20, Steps: 7 | Train Loss: 0.287 Vali Loss: 0.547 Vali Acc: 0.917 Test Loss: 0.547 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916661).  Saving model ...
Epoch: 21 cost time: 0.7142996788024902
Epoch: 21, Steps: 7 | Train Loss: 0.286 Vali Loss: 0.514 Vali Acc: 0.917 Test Loss: 0.514 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 22 cost time: 0.6502847671508789
Epoch: 22, Steps: 7 | Train Loss: 0.236 Vali Loss: 0.490 Vali Acc: 0.917 Test Loss: 0.490 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 23 cost time: 0.6588797569274902
Epoch: 23, Steps: 7 | Train Loss: 0.225 Vali Loss: 0.467 Vali Acc: 0.917 Test Loss: 0.467 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 24 cost time: 0.6388249397277832
Epoch: 24, Steps: 7 | Train Loss: 0.209 Vali Loss: 0.459 Vali Acc: 0.903 Test Loss: 0.459 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8047587871551514
Epoch: 25, Steps: 7 | Train Loss: 0.182 Vali Loss: 0.446 Vali Acc: 0.903 Test Loss: 0.446 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6390762329101562
Epoch: 26, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.433 Vali Acc: 0.917 Test Loss: 0.433 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 27 cost time: 0.6693317890167236
Epoch: 27, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.419 Vali Acc: 0.917 Test Loss: 0.419 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 28 cost time: 0.6333334445953369
Epoch: 28, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.410 Vali Acc: 0.917 Test Loss: 0.410 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 29 cost time: 0.672126054763794
Epoch: 29, Steps: 7 | Train Loss: 0.118 Vali Loss: 0.396 Vali Acc: 0.917 Test Loss: 0.396 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 30 cost time: 0.6236362457275391
Epoch: 30, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.391 Vali Acc: 0.917 Test Loss: 0.391 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 31 cost time: 0.6816608905792236
Epoch: 31, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.385 Vali Acc: 0.917 Test Loss: 0.385 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 32 cost time: 0.6389048099517822
Epoch: 32, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.385 Vali Acc: 0.903 Test Loss: 0.385 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6602928638458252
Epoch: 33, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.383 Vali Acc: 0.903 Test Loss: 0.383 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7931778430938721
Epoch: 34, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.363 Vali Acc: 0.917 Test Loss: 0.363 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 35 cost time: 0.7691512107849121
Epoch: 35, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.353 Vali Acc: 0.917 Test Loss: 0.353 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 36 cost time: 0.7322967052459717
Epoch: 36, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 37 cost time: 0.7575430870056152
Epoch: 37, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 38 cost time: 0.6986682415008545
Epoch: 38, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 39 cost time: 0.7107400894165039
Epoch: 39, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 40 cost time: 0.7668609619140625
Epoch: 40, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.736987829208374
Epoch: 41, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7560877799987793
Epoch: 42, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7141416072845459
Epoch: 43, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7476277351379395
Epoch: 44, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 45 cost time: 0.8090670108795166
Epoch: 45, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 46 cost time: 0.7361598014831543
Epoch: 46, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 47 cost time: 0.7538504600524902
Epoch: 47, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.7704625129699707
Epoch: 48, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.7027156352996826
Epoch: 49, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7698521614074707
Epoch: 50, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 0.7078993320465088
Epoch: 51, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7842702865600586
Epoch: 52, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 0.6869239807128906
Epoch: 53, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 0.7990858554840088
Epoch: 54, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 0.7383291721343994
Epoch: 55, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 0.7534537315368652
Epoch: 56, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6450483798980713
Epoch: 57, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 0.7209908962249756
Epoch: 58, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 0.7341833114624023
Epoch: 59, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8399958610534668
Epoch: 60, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.7258026599884033
Epoch: 61, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 62 cost time: 0.7385463714599609
Epoch: 62, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 0.7407224178314209
Epoch: 63, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7435667514801025
Epoch: 64, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.6959097385406494
Epoch: 65, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8130536079406738
Epoch: 66, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.7355799674987793
Epoch: 67, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.77535080909729
Epoch: 68, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.7537710666656494
Epoch: 69, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 0.6999845504760742
Epoch: 70, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 0.6873714923858643
Epoch: 71, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.7465610504150391
Epoch: 72, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.7027740478515625
Epoch: 73, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 74 cost time: 0.6518468856811523
Epoch: 74, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 75 cost time: 0.6078124046325684
Epoch: 75, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.6706564426422119
Epoch: 76, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 77 cost time: 0.6231215000152588
Epoch: 77, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 78 cost time: 0.5527770519256592
Epoch: 78, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.6390044689178467
Epoch: 79, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.6754944324493408
Epoch: 80, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.7510042190551758
Epoch: 81, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.7290244102478027
Epoch: 82, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.6741585731506348
Epoch: 83, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 84 cost time: 0.7387833595275879
Epoch: 84, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 85 cost time: 0.8371005058288574
Epoch: 85, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.7564647197723389
Epoch: 86, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.7756617069244385
Epoch: 87, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.7248730659484863
Epoch: 88, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.7168593406677246
Epoch: 89, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 0.7716045379638672
Epoch: 90, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 91 cost time: 0.6770143508911133
Epoch: 91, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.7406365871429443
Epoch: 92, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.7424461841583252
Epoch: 93, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.7091903686523438
Epoch: 94, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.7016303539276123
Epoch: 95, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.6991322040557861
Epoch: 96, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 0.763831615447998
Epoch: 97, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.7501897811889648
Epoch: 98, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 0.6940162181854248
Epoch: 99, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 0.7369821071624756
Epoch: 100, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 32140
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3502955436706543
Epoch: 1, Steps: 7 | Train Loss: 2.567 Vali Loss: 2.460 Vali Acc: 0.222 Test Loss: 2.460 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.8646037578582764
Epoch: 2, Steps: 7 | Train Loss: 2.489 Vali Loss: 2.271 Vali Acc: 0.264 Test Loss: 2.271 Test Acc: 0.264
Validation loss decreased (-0.222198 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 0.7184741497039795
Epoch: 3, Steps: 7 | Train Loss: 2.117 Vali Loss: 1.977 Vali Acc: 0.486 Test Loss: 1.977 Test Acc: 0.486
Validation loss decreased (-0.263866 --> -0.486091).  Saving model ...
Epoch: 4 cost time: 0.7418732643127441
Epoch: 4, Steps: 7 | Train Loss: 1.789 Vali Loss: 1.606 Vali Acc: 0.653 Test Loss: 1.606 Test Acc: 0.653
Validation loss decreased (-0.486091 --> -0.652762).  Saving model ...
Epoch: 5 cost time: 0.6063621044158936
Epoch: 5, Steps: 7 | Train Loss: 1.341 Vali Loss: 1.237 Vali Acc: 0.764 Test Loss: 1.237 Test Acc: 0.764
Validation loss decreased (-0.652762 --> -0.763877).  Saving model ...
Epoch: 6 cost time: 0.770848274230957
Epoch: 6, Steps: 7 | Train Loss: 0.917 Vali Loss: 0.937 Vali Acc: 0.792 Test Loss: 0.937 Test Acc: 0.792
Validation loss decreased (-0.763877 --> -0.791657).  Saving model ...
Epoch: 7 cost time: 0.7843363285064697
Epoch: 7, Steps: 7 | Train Loss: 0.562 Vali Loss: 0.688 Vali Acc: 0.903 Test Loss: 0.688 Test Acc: 0.903
Validation loss decreased (-0.791657 --> -0.902771).  Saving model ...
Epoch: 8 cost time: 0.69679856300354
Epoch: 8, Steps: 7 | Train Loss: 0.351 Vali Loss: 0.503 Vali Acc: 0.903 Test Loss: 0.503 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 0.7710859775543213
Epoch: 9, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.393 Vali Acc: 0.931 Test Loss: 0.393 Test Acc: 0.931
Validation loss decreased (-0.902773 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.7242577075958252
Epoch: 10, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7546133995056152
Epoch: 11, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7450082302093506
Epoch: 12, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.6658167839050293
Epoch: 13, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.243 Vali Acc: 0.958 Test Loss: 0.243 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.7162520885467529
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.7193338871002197
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.7441537380218506
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.6639621257781982
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7552754878997803
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.8366894721984863
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.6560087203979492
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.6910314559936523
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6864604949951172
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.6684494018554688
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.7334709167480469
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.8237152099609375
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.7731757164001465
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.820246696472168
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.6587002277374268
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.7294838428497314
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.8061285018920898
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7352116107940674
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7635226249694824
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6294758319854736
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.7482383251190186
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.6217801570892334
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 0.7732458114624023
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 0.7960047721862793
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7077972888946533
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7084939479827881
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7119646072387695
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.6574459075927734
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.7609353065490723
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 0.7329940795898438
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 0.7969262599945068
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7452664375305176
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.714569091796875
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.7647244930267334
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.7536826133728027
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.7462458610534668
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.7529306411743164
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 51 cost time: 0.7672040462493896
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 52 cost time: 0.771916389465332
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 0.7695512771606445
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7591385841369629
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7920267581939697
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 56 cost time: 0.8206601142883301
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 57 cost time: 0.8373777866363525
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 58 cost time: 0.7774608135223389
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 59 cost time: 0.7470638751983643
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 60 cost time: 0.6895289421081543
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 61 cost time: 0.6310298442840576
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 62 cost time: 0.6466364860534668
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 63 cost time: 0.6758654117584229
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 64 cost time: 0.7358698844909668
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 65 cost time: 0.743572473526001
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.6481509208679199
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.6492407321929932
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 68 cost time: 0.6676874160766602
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.6839492321014404
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 70 cost time: 0.7723081111907959
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 71 cost time: 0.7230231761932373
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 72 cost time: 0.7684721946716309
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 73 cost time: 0.7697744369506836
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7242989540100098
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.806760311126709
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.7797586917877197
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.8052957057952881
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 78 cost time: 0.7222015857696533
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 79 cost time: 0.7544059753417969
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 80 cost time: 0.7319862842559814
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 81 cost time: 0.6538355350494385
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.7387609481811523
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.7485151290893555
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 84 cost time: 0.7461071014404297
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 85 cost time: 0.7280457019805908
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 86 cost time: 0.8065798282623291
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 87 cost time: 0.7204883098602295
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 88 cost time: 0.8347225189208984
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 89 cost time: 0.6834475994110107
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.7353165149688721
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 91 cost time: 0.7205393314361572
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 92 cost time: 0.7588376998901367
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.7301678657531738
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.7308685779571533
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 0.7987866401672363
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 0.7487308979034424
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 97 cost time: 0.6644103527069092
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.7880880832672119
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.6771395206451416
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 100 cost time: 0.8243734836578369
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 102316
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.266582489013672
Epoch: 1, Steps: 7 | Train Loss: 2.717 Vali Loss: 2.626 Vali Acc: 0.083 Test Loss: 2.626 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 0.6341814994812012
Epoch: 2, Steps: 7 | Train Loss: 2.627 Vali Loss: 2.459 Vali Acc: 0.153 Test Loss: 2.459 Test Acc: 0.153
Validation loss decreased (-0.083307 --> -0.152753).  Saving model ...
Epoch: 3 cost time: 0.6720824241638184
Epoch: 3, Steps: 7 | Train Loss: 2.378 Vali Loss: 2.244 Vali Acc: 0.222 Test Loss: 2.244 Test Acc: 0.222
Validation loss decreased (-0.152753 --> -0.222200).  Saving model ...
Epoch: 4 cost time: 0.6883969306945801
Epoch: 4, Steps: 7 | Train Loss: 2.067 Vali Loss: 1.983 Vali Acc: 0.500 Test Loss: 1.983 Test Acc: 0.500
Validation loss decreased (-0.222200 --> -0.499980).  Saving model ...
Epoch: 5 cost time: 0.7015640735626221
Epoch: 5, Steps: 7 | Train Loss: 1.694 Vali Loss: 1.705 Vali Acc: 0.625 Test Loss: 1.705 Test Acc: 0.625
Validation loss decreased (-0.499980 --> -0.624983).  Saving model ...
Epoch: 6 cost time: 0.7046558856964111
Epoch: 6, Steps: 7 | Train Loss: 1.435 Vali Loss: 1.413 Vali Acc: 0.736 Test Loss: 1.413 Test Acc: 0.736
Validation loss decreased (-0.624983 --> -0.736097).  Saving model ...
Epoch: 7 cost time: 0.7724168300628662
Epoch: 7, Steps: 7 | Train Loss: 1.207 Vali Loss: 1.133 Vali Acc: 0.792 Test Loss: 1.133 Test Acc: 0.792
Validation loss decreased (-0.736097 --> -0.791655).  Saving model ...
Epoch: 8 cost time: 0.7133622169494629
Epoch: 8, Steps: 7 | Train Loss: 0.834 Vali Loss: 0.883 Vali Acc: 0.847 Test Loss: 0.883 Test Acc: 0.847
Validation loss decreased (-0.791655 --> -0.847213).  Saving model ...
Epoch: 9 cost time: 0.7346985340118408
Epoch: 9, Steps: 7 | Train Loss: 0.631 Vali Loss: 0.694 Vali Acc: 0.889 Test Loss: 0.694 Test Acc: 0.889
Validation loss decreased (-0.847213 --> -0.888882).  Saving model ...
Epoch: 10 cost time: 0.8293642997741699
Epoch: 10, Steps: 7 | Train Loss: 0.383 Vali Loss: 0.574 Vali Acc: 0.889 Test Loss: 0.574 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 11 cost time: 0.8092515468597412
Epoch: 11, Steps: 7 | Train Loss: 0.258 Vali Loss: 0.476 Vali Acc: 0.889 Test Loss: 0.476 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 0.723231315612793
Epoch: 12, Steps: 7 | Train Loss: 0.163 Vali Loss: 0.386 Vali Acc: 0.903 Test Loss: 0.386 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 0.6675610542297363
Epoch: 13, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 0.737900972366333
Epoch: 14, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.7900180816650391
Epoch: 15, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 0.6775295734405518
Epoch: 16, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 0.7039608955383301
Epoch: 17, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.7049117088317871
Epoch: 18, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.285 Vali Acc: 0.931 Test Loss: 0.285 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.6686382293701172
Epoch: 19, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.6352150440216064
Epoch: 20, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6822121143341064
Epoch: 21, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.6841683387756348
Epoch: 22, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.7457492351531982
Epoch: 23, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7478396892547607
Epoch: 24, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7050414085388184
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.7817928791046143
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.7574701309204102
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6873579025268555
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.7598788738250732
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.7607603073120117
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.7108967304229736
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.6994211673736572
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.6265590190887451
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.6286125183105469
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.649834394454956
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.6690142154693604
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.7523975372314453
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.6656231880187988
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6872878074645996
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6609244346618652
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.7302248477935791
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.7096481323242188
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.7030174732208252
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.6820712089538574
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.6946523189544678
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 0.7227733135223389
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6721212863922119
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7601680755615234
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6612684726715088
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.7844271659851074
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.972 Test Loss: 0.206 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 51 cost time: 0.6827068328857422
Epoch: 51, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.972 Test Loss: 0.205 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 52 cost time: 0.7223615646362305
Epoch: 52, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.972 Test Loss: 0.204 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 53 cost time: 0.6943545341491699
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.972 Test Loss: 0.204 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 54 cost time: 0.6382114887237549
Epoch: 54, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.972 Test Loss: 0.205 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7292959690093994
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.972 Test Loss: 0.205 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7921288013458252
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.972 Test Loss: 0.205 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7540295124053955
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.972 Test Loss: 0.203 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 58 cost time: 0.6104893684387207
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.972 Test Loss: 0.203 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 59 cost time: 0.7382016181945801
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.972 Test Loss: 0.203 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7371711730957031
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.972 Test Loss: 0.202 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 61 cost time: 0.6548519134521484
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6942393779754639
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.972 Test Loss: 0.202 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 63 cost time: 0.7020745277404785
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.972 Test Loss: 0.202 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 64 cost time: 0.759756326675415
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 65 cost time: 0.7108273506164551
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.972 Test Loss: 0.200 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 66 cost time: 0.7316117286682129
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.972 Test Loss: 0.200 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7591798305511475
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.7758641242980957
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.7061347961425781
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.7818951606750488
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.7262048721313477
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.7818155288696289
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.7630105018615723
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.7716596126556396
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.775660514831543
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 56716
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.337279796600342
Epoch: 1, Steps: 7 | Train Loss: 2.589 Vali Loss: 2.495 Vali Acc: 0.111 Test Loss: 2.495 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.7511351108551025
Epoch: 2, Steps: 7 | Train Loss: 2.545 Vali Loss: 2.393 Vali Acc: 0.181 Test Loss: 2.393 Test Acc: 0.181
Validation loss decreased (-0.111086 --> -0.180532).  Saving model ...
Epoch: 3 cost time: 0.7756710052490234
Epoch: 3, Steps: 7 | Train Loss: 2.368 Vali Loss: 2.224 Vali Acc: 0.306 Test Loss: 2.224 Test Acc: 0.306
Validation loss decreased (-0.180532 --> -0.305533).  Saving model ...
Epoch: 4 cost time: 0.751948356628418
Epoch: 4, Steps: 7 | Train Loss: 2.063 Vali Loss: 2.015 Vali Acc: 0.444 Test Loss: 2.015 Test Acc: 0.444
Validation loss decreased (-0.305533 --> -0.444424).  Saving model ...
Epoch: 5 cost time: 0.7211422920227051
Epoch: 5, Steps: 7 | Train Loss: 1.860 Vali Loss: 1.782 Vali Acc: 0.583 Test Loss: 1.782 Test Acc: 0.583
Validation loss decreased (-0.444424 --> -0.583316).  Saving model ...
Epoch: 6 cost time: 0.7706811428070068
Epoch: 6, Steps: 7 | Train Loss: 1.587 Vali Loss: 1.516 Vali Acc: 0.722 Test Loss: 1.516 Test Acc: 0.722
Validation loss decreased (-0.583316 --> -0.722207).  Saving model ...
Epoch: 7 cost time: 0.671654462814331
Epoch: 7, Steps: 7 | Train Loss: 1.272 Vali Loss: 1.257 Vali Acc: 0.819 Test Loss: 1.257 Test Acc: 0.819
Validation loss decreased (-0.722207 --> -0.819432).  Saving model ...
Epoch: 8 cost time: 0.7724158763885498
Epoch: 8, Steps: 7 | Train Loss: 0.991 Vali Loss: 1.010 Vali Acc: 0.819 Test Loss: 1.010 Test Acc: 0.819
Validation loss decreased (-0.819432 --> -0.819434).  Saving model ...
Epoch: 9 cost time: 0.8108367919921875
Epoch: 9, Steps: 7 | Train Loss: 0.775 Vali Loss: 0.819 Vali Acc: 0.819 Test Loss: 0.819 Test Acc: 0.819
Validation loss decreased (-0.819434 --> -0.819436).  Saving model ...
Epoch: 10 cost time: 0.7345190048217773
Epoch: 10, Steps: 7 | Train Loss: 0.562 Vali Loss: 0.669 Vali Acc: 0.847 Test Loss: 0.669 Test Acc: 0.847
Validation loss decreased (-0.819436 --> -0.847216).  Saving model ...
Epoch: 11 cost time: 0.7322759628295898
Epoch: 11, Steps: 7 | Train Loss: 0.371 Vali Loss: 0.552 Vali Acc: 0.861 Test Loss: 0.552 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861106).  Saving model ...
Epoch: 12 cost time: 0.7366776466369629
Epoch: 12, Steps: 7 | Train Loss: 0.254 Vali Loss: 0.467 Vali Acc: 0.903 Test Loss: 0.467 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902773).  Saving model ...
Epoch: 13 cost time: 0.8228976726531982
Epoch: 13, Steps: 7 | Train Loss: 0.182 Vali Loss: 0.405 Vali Acc: 0.903 Test Loss: 0.405 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 0.6256504058837891
Epoch: 14, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.366 Vali Acc: 0.903 Test Loss: 0.366 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 0.6341683864593506
Epoch: 15, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.333 Vali Acc: 0.931 Test Loss: 0.333 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 16 cost time: 0.7108385562896729
Epoch: 16, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8061380386352539
Epoch: 17, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.308 Vali Acc: 0.931 Test Loss: 0.308 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 18 cost time: 0.8254456520080566
Epoch: 18, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7981154918670654
Epoch: 19, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7240781784057617
Epoch: 20, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7040293216705322
Epoch: 21, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.7589600086212158
Epoch: 22, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.8103258609771729
Epoch: 23, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.6974489688873291
Epoch: 24, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.7468216419219971
Epoch: 25, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.249 Vali Acc: 0.958 Test Loss: 0.249 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.712130069732666
Epoch: 26, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.244 Vali Acc: 0.958 Test Loss: 0.244 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.746840238571167
Epoch: 27, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.239 Vali Acc: 0.958 Test Loss: 0.239 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.818697452545166
Epoch: 28, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.7404117584228516
Epoch: 29, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7571678161621094
Epoch: 30, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8396098613739014
Epoch: 31, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.792304515838623
Epoch: 32, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.7520039081573486
Epoch: 33, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.214 Vali Acc: 0.972 Test Loss: 0.214 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 34 cost time: 0.7857687473297119
Epoch: 34, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.210 Vali Acc: 0.972 Test Loss: 0.210 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 35 cost time: 0.751011848449707
Epoch: 35, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.972 Test Loss: 0.207 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 36 cost time: 0.8040173053741455
Epoch: 36, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.972 Test Loss: 0.205 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 37 cost time: 0.7748551368713379
Epoch: 37, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.972 Test Loss: 0.203 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 38 cost time: 0.7583694458007812
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7637131214141846
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.772040843963623
Epoch: 40, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7110810279846191
Epoch: 41, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6958544254302979
Epoch: 42, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 43 cost time: 0.6853151321411133
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.972 Test Loss: 0.190 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 44 cost time: 0.780799150466919
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.972 Test Loss: 0.190 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 45 cost time: 0.7374298572540283
Epoch: 45, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.189 Vali Acc: 0.972 Test Loss: 0.189 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 46 cost time: 0.846240758895874
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.972 Test Loss: 0.189 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6636273860931396
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.972 Test Loss: 0.189 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 48 cost time: 0.7483501434326172
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.972 Test Loss: 0.187 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 49 cost time: 0.8123888969421387
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.972 Test Loss: 0.187 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 50 cost time: 0.756812334060669
Epoch: 50, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 51 cost time: 0.7548723220825195
Epoch: 51, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 52 cost time: 0.7947230339050293
Epoch: 52, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 53 cost time: 0.7426385879516602
Epoch: 53, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.684192419052124
Epoch: 54, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.753326416015625
Epoch: 55, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 56 cost time: 0.7349872589111328
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 57 cost time: 0.7321836948394775
Epoch: 57, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 58 cost time: 0.8091325759887695
Epoch: 58, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 59 cost time: 0.7989342212677002
Epoch: 59, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7014403343200684
Epoch: 60, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 61 cost time: 0.7761716842651367
Epoch: 61, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 62 cost time: 0.6959929466247559
Epoch: 62, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 63 cost time: 0.6178121566772461
Epoch: 63, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.972 Test Loss: 0.173 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 64 cost time: 0.6883711814880371
Epoch: 64, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.972 Test Loss: 0.173 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 65 cost time: 0.694699764251709
Epoch: 65, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 66 cost time: 0.6895203590393066
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972221).  Saving model ...
Epoch: 67 cost time: 0.8343925476074219
Epoch: 67, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 68 cost time: 0.6900641918182373
Epoch: 68, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 69 cost time: 0.722151517868042
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.6646120548248291
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.6673855781555176
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.7814223766326904
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 73 cost time: 0.7609972953796387
Epoch: 73, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 74 cost time: 0.7510499954223633
Epoch: 74, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 75 cost time: 0.6259377002716064
Epoch: 75, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 76 cost time: 0.7419204711914062
Epoch: 76, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 77 cost time: 0.7280235290527344
Epoch: 77, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 78 cost time: 0.6844923496246338
Epoch: 78, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7571554183959961
Epoch: 79, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.758763313293457
Epoch: 80, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 81 cost time: 0.8231973648071289
Epoch: 81, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 82 cost time: 0.7702329158782959
Epoch: 82, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 83 cost time: 0.7566981315612793
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 84 cost time: 0.7326712608337402
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.789447546005249
Epoch: 85, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.6974284648895264
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.7264673709869385
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 88 cost time: 0.619368314743042
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 89 cost time: 0.6974349021911621
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 90 cost time: 0.7294108867645264
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 91 cost time: 0.67657470703125
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 92 cost time: 0.6548118591308594
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 93 cost time: 0.6434955596923828
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.6494095325469971
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 95 cost time: 0.6367926597595215
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 96 cost time: 0.6197268962860107
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.654865026473999
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 98 cost time: 0.7170882225036621
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.6685678958892822
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.7464525699615479
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 42220
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df128_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.274169683456421
Epoch: 1, Steps: 7 | Train Loss: 2.548 Vali Loss: 2.505 Vali Acc: 0.097 Test Loss: 2.505 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.6898200511932373
Epoch: 2, Steps: 7 | Train Loss: 2.519 Vali Loss: 2.403 Vali Acc: 0.097 Test Loss: 2.403 Test Acc: 0.097
Validation loss decreased (-0.097197 --> -0.097198).  Saving model ...
Epoch: 3 cost time: 0.6597356796264648
Epoch: 3, Steps: 7 | Train Loss: 2.386 Vali Loss: 2.253 Vali Acc: 0.250 Test Loss: 2.253 Test Acc: 0.250
Validation loss decreased (-0.097198 --> -0.249977).  Saving model ...
Epoch: 4 cost time: 0.6538827419281006
Epoch: 4, Steps: 7 | Train Loss: 2.114 Vali Loss: 2.059 Vali Acc: 0.375 Test Loss: 2.059 Test Acc: 0.375
Validation loss decreased (-0.249977 --> -0.374979).  Saving model ...
Epoch: 5 cost time: 0.7152180671691895
Epoch: 5, Steps: 7 | Train Loss: 1.931 Vali Loss: 1.837 Vali Acc: 0.542 Test Loss: 1.837 Test Acc: 0.542
Validation loss decreased (-0.374979 --> -0.541648).  Saving model ...
Epoch: 6 cost time: 0.8242661952972412
Epoch: 6, Steps: 7 | Train Loss: 1.699 Vali Loss: 1.603 Vali Acc: 0.639 Test Loss: 1.603 Test Acc: 0.639
Validation loss decreased (-0.541648 --> -0.638873).  Saving model ...
Epoch: 7 cost time: 0.7410373687744141
Epoch: 7, Steps: 7 | Train Loss: 1.419 Vali Loss: 1.347 Vali Acc: 0.736 Test Loss: 1.347 Test Acc: 0.736
Validation loss decreased (-0.638873 --> -0.736098).  Saving model ...
Epoch: 8 cost time: 0.7794783115386963
Epoch: 8, Steps: 7 | Train Loss: 1.155 Vali Loss: 1.109 Vali Acc: 0.819 Test Loss: 1.109 Test Acc: 0.819
Validation loss decreased (-0.736098 --> -0.819433).  Saving model ...
Epoch: 9 cost time: 0.7945475578308105
Epoch: 9, Steps: 7 | Train Loss: 0.867 Vali Loss: 0.903 Vali Acc: 0.861 Test Loss: 0.903 Test Acc: 0.861
Validation loss decreased (-0.819433 --> -0.861102).  Saving model ...
Epoch: 10 cost time: 0.7080340385437012
Epoch: 10, Steps: 7 | Train Loss: 0.660 Vali Loss: 0.730 Vali Acc: 0.917 Test Loss: 0.730 Test Acc: 0.917
Validation loss decreased (-0.861102 --> -0.916659).  Saving model ...
Epoch: 11 cost time: 0.6583499908447266
Epoch: 11, Steps: 7 | Train Loss: 0.499 Vali Loss: 0.600 Vali Acc: 0.931 Test Loss: 0.600 Test Acc: 0.931
Validation loss decreased (-0.916659 --> -0.930550).  Saving model ...
Epoch: 12 cost time: 0.8657207489013672
Epoch: 12, Steps: 7 | Train Loss: 0.349 Vali Loss: 0.502 Vali Acc: 0.944 Test Loss: 0.502 Test Acc: 0.944
Validation loss decreased (-0.930550 --> -0.944439).  Saving model ...
Epoch: 13 cost time: 0.7149264812469482
Epoch: 13, Steps: 7 | Train Loss: 0.266 Vali Loss: 0.447 Vali Acc: 0.944 Test Loss: 0.447 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 14 cost time: 0.6818497180938721
Epoch: 14, Steps: 7 | Train Loss: 0.180 Vali Loss: 0.400 Vali Acc: 0.958 Test Loss: 0.400 Test Acc: 0.958
Validation loss decreased (-0.944440 --> -0.958329).  Saving model ...
Epoch: 15 cost time: 0.6950526237487793
Epoch: 15, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.367 Vali Acc: 0.958 Test Loss: 0.367 Test Acc: 0.958
Validation loss decreased (-0.958329 --> -0.958330).  Saving model ...
Epoch: 16 cost time: 0.6728558540344238
Epoch: 16, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6758768558502197
Epoch: 17, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.333 Vali Acc: 0.944 Test Loss: 0.333 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7591805458068848
Epoch: 18, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.323 Vali Acc: 0.944 Test Loss: 0.323 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7111983299255371
Epoch: 19, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.312 Vali Acc: 0.944 Test Loss: 0.312 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6472756862640381
Epoch: 20, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6970510482788086
Epoch: 21, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6755931377410889
Epoch: 22, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7560014724731445
Epoch: 23, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7720873355865479
Epoch: 24, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6325473785400391
Epoch: 25, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df128_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 34636
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2762017250061035
Epoch: 1, Steps: 7 | Train Loss: 2.629 Vali Loss: 2.644 Vali Acc: 0.083 Test Loss: 2.644 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 0.7003746032714844
Epoch: 2, Steps: 7 | Train Loss: 2.546 Vali Loss: 2.524 Vali Acc: 0.097 Test Loss: 2.524 Test Acc: 0.097
Validation loss decreased (-0.083307 --> -0.097197).  Saving model ...
Epoch: 3 cost time: 0.7160027027130127
Epoch: 3, Steps: 7 | Train Loss: 2.426 Vali Loss: 2.372 Vali Acc: 0.153 Test Loss: 2.372 Test Acc: 0.153
Validation loss decreased (-0.097197 --> -0.152754).  Saving model ...
Epoch: 4 cost time: 0.761185884475708
Epoch: 4, Steps: 7 | Train Loss: 2.243 Vali Loss: 2.196 Vali Acc: 0.264 Test Loss: 2.196 Test Acc: 0.264
Validation loss decreased (-0.152754 --> -0.263867).  Saving model ...
Epoch: 5 cost time: 0.6128568649291992
Epoch: 5, Steps: 7 | Train Loss: 2.140 Vali Loss: 2.001 Vali Acc: 0.444 Test Loss: 2.001 Test Acc: 0.444
Validation loss decreased (-0.263867 --> -0.444424).  Saving model ...
Epoch: 6 cost time: 0.8016397953033447
Epoch: 6, Steps: 7 | Train Loss: 1.903 Vali Loss: 1.805 Vali Acc: 0.528 Test Loss: 1.805 Test Acc: 0.528
Validation loss decreased (-0.444424 --> -0.527760).  Saving model ...
Epoch: 7 cost time: 0.7469124794006348
Epoch: 7, Steps: 7 | Train Loss: 1.641 Vali Loss: 1.603 Vali Acc: 0.597 Test Loss: 1.603 Test Acc: 0.597
Validation loss decreased (-0.527760 --> -0.597206).  Saving model ...
Epoch: 8 cost time: 0.6506171226501465
Epoch: 8, Steps: 7 | Train Loss: 1.463 Vali Loss: 1.415 Vali Acc: 0.667 Test Loss: 1.415 Test Acc: 0.667
Validation loss decreased (-0.597206 --> -0.666653).  Saving model ...
Epoch: 9 cost time: 0.7410323619842529
Epoch: 9, Steps: 7 | Train Loss: 1.242 Vali Loss: 1.228 Vali Acc: 0.736 Test Loss: 1.228 Test Acc: 0.736
Validation loss decreased (-0.666653 --> -0.736099).  Saving model ...
Epoch: 10 cost time: 0.6990890502929688
Epoch: 10, Steps: 7 | Train Loss: 1.026 Vali Loss: 1.051 Vali Acc: 0.736 Test Loss: 1.051 Test Acc: 0.736
Validation loss decreased (-0.736099 --> -0.736101).  Saving model ...
Epoch: 11 cost time: 0.6558170318603516
Epoch: 11, Steps: 7 | Train Loss: 0.824 Vali Loss: 0.905 Vali Acc: 0.792 Test Loss: 0.905 Test Acc: 0.792
Validation loss decreased (-0.736101 --> -0.791658).  Saving model ...
Epoch: 12 cost time: 0.6695437431335449
Epoch: 12, Steps: 7 | Train Loss: 0.617 Vali Loss: 0.768 Vali Acc: 0.819 Test Loss: 0.768 Test Acc: 0.819
Validation loss decreased (-0.791658 --> -0.819437).  Saving model ...
Epoch: 13 cost time: 0.831413984298706
Epoch: 13, Steps: 7 | Train Loss: 0.480 Vali Loss: 0.672 Vali Acc: 0.833 Test Loss: 0.672 Test Acc: 0.833
Validation loss decreased (-0.819437 --> -0.833327).  Saving model ...
Epoch: 14 cost time: 0.8298177719116211
Epoch: 14, Steps: 7 | Train Loss: 0.401 Vali Loss: 0.588 Vali Acc: 0.833 Test Loss: 0.588 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 0.6899216175079346
Epoch: 15, Steps: 7 | Train Loss: 0.308 Vali Loss: 0.524 Vali Acc: 0.875 Test Loss: 0.524 Test Acc: 0.875
Validation loss decreased (-0.833327 --> -0.874995).  Saving model ...
Epoch: 16 cost time: 0.7820980548858643
Epoch: 16, Steps: 7 | Train Loss: 0.249 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6644434928894043
Epoch: 17, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 18 cost time: 0.71856689453125
Epoch: 18, Steps: 7 | Train Loss: 0.166 Vali Loss: 0.415 Vali Acc: 0.861 Test Loss: 0.415 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7014379501342773
Epoch: 19, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.412 Vali Acc: 0.847 Test Loss: 0.412 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7212567329406738
Epoch: 20, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.399 Vali Acc: 0.847 Test Loss: 0.399 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7566549777984619
Epoch: 21, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.376 Vali Acc: 0.847 Test Loss: 0.376 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7509775161743164
Epoch: 22, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.357 Vali Acc: 0.861 Test Loss: 0.357 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7039508819580078
Epoch: 23, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.343 Vali Acc: 0.889 Test Loss: 0.343 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 24 cost time: 0.7036948204040527
Epoch: 24, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7295582294464111
Epoch: 25, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.913806676864624
Epoch: 26, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7574374675750732
Epoch: 27, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.7152881622314453
Epoch: 28, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.6930503845214844
Epoch: 29, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.82895827293396
Epoch: 30, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.7383463382720947
Epoch: 31, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7409589290618896
Epoch: 32, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7802786827087402
Epoch: 33, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7720551490783691
Epoch: 34, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7572174072265625
Epoch: 35, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8082902431488037
Epoch: 36, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.7614538669586182
Epoch: 37, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.7746400833129883
Epoch: 38, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.714256763458252
Epoch: 39, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.7177939414978027
Epoch: 40, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.6895418167114258
Epoch: 41, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.7558903694152832
Epoch: 42, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.6943483352661133
Epoch: 43, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.7225799560546875
Epoch: 44, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.7634668350219727
Epoch: 45, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.7047133445739746
Epoch: 46, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.707045316696167
Epoch: 47, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.7053525447845459
Epoch: 48, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6525566577911377
Epoch: 49, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6830170154571533
Epoch: 50, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.5997869968414307
Epoch: 51, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.7567617893218994
Epoch: 52, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 0.7060661315917969
Epoch: 53, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 0.7135841846466064
Epoch: 54, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 0.67801833152771
Epoch: 55, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 0.6514437198638916
Epoch: 56, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.647019624710083
Epoch: 57, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.796783447265625
Epoch: 58, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.7693264484405518
Epoch: 59, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.750664472579956
Epoch: 60, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.7428796291351318
Epoch: 61, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.7360854148864746
Epoch: 62, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.8067052364349365
Epoch: 63, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.742042064666748
Epoch: 64, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.739558219909668
Epoch: 65, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 28684
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df128_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3803513050079346
Epoch: 1, Steps: 7 | Train Loss: 2.590 Vali Loss: 2.574 Vali Acc: 0.056 Test Loss: 2.574 Test Acc: 0.056
Validation loss decreased (inf --> -0.055530).  Saving model ...
Epoch: 2 cost time: 0.6705684661865234
Epoch: 2, Steps: 7 | Train Loss: 2.486 Vali Loss: 2.488 Vali Acc: 0.097 Test Loss: 2.488 Test Acc: 0.097
Validation loss decreased (-0.055530 --> -0.097197).  Saving model ...
Epoch: 3 cost time: 0.6677155494689941
Epoch: 3, Steps: 7 | Train Loss: 2.351 Vali Loss: 2.367 Vali Acc: 0.139 Test Loss: 2.367 Test Acc: 0.139
Validation loss decreased (-0.097197 --> -0.138865).  Saving model ...
Epoch: 4 cost time: 0.6564586162567139
Epoch: 4, Steps: 7 | Train Loss: 2.246 Vali Loss: 2.225 Vali Acc: 0.208 Test Loss: 2.225 Test Acc: 0.208
Validation loss decreased (-0.138865 --> -0.208311).  Saving model ...
Epoch: 5 cost time: 0.6324684619903564
Epoch: 5, Steps: 7 | Train Loss: 2.050 Vali Loss: 2.070 Vali Acc: 0.319 Test Loss: 2.070 Test Acc: 0.319
Validation loss decreased (-0.208311 --> -0.319424).  Saving model ...
Epoch: 6 cost time: 0.6586015224456787
Epoch: 6, Steps: 7 | Train Loss: 1.910 Vali Loss: 1.907 Vali Acc: 0.444 Test Loss: 1.907 Test Acc: 0.444
Validation loss decreased (-0.319424 --> -0.444425).  Saving model ...
Epoch: 7 cost time: 0.7767257690429688
Epoch: 7, Steps: 7 | Train Loss: 1.775 Vali Loss: 1.739 Vali Acc: 0.569 Test Loss: 1.739 Test Acc: 0.569
Validation loss decreased (-0.444425 --> -0.569427).  Saving model ...
Epoch: 8 cost time: 0.7200992107391357
Epoch: 8, Steps: 7 | Train Loss: 1.573 Vali Loss: 1.568 Vali Acc: 0.653 Test Loss: 1.568 Test Acc: 0.653
Validation loss decreased (-0.569427 --> -0.652762).  Saving model ...
Epoch: 9 cost time: 0.7732260227203369
Epoch: 9, Steps: 7 | Train Loss: 1.348 Vali Loss: 1.389 Vali Acc: 0.694 Test Loss: 1.389 Test Acc: 0.694
Validation loss decreased (-0.652762 --> -0.694431).  Saving model ...
Epoch: 10 cost time: 0.7199249267578125
Epoch: 10, Steps: 7 | Train Loss: 1.168 Vali Loss: 1.227 Vali Acc: 0.736 Test Loss: 1.227 Test Acc: 0.736
Validation loss decreased (-0.694431 --> -0.736099).  Saving model ...
Epoch: 11 cost time: 0.6956355571746826
Epoch: 11, Steps: 7 | Train Loss: 0.957 Vali Loss: 1.080 Vali Acc: 0.778 Test Loss: 1.080 Test Acc: 0.778
Validation loss decreased (-0.736099 --> -0.777767).  Saving model ...
Epoch: 12 cost time: 0.6612932682037354
Epoch: 12, Steps: 7 | Train Loss: 0.826 Vali Loss: 0.947 Vali Acc: 0.806 Test Loss: 0.947 Test Acc: 0.806
Validation loss decreased (-0.777767 --> -0.805546).  Saving model ...
Epoch: 13 cost time: 0.6825623512268066
Epoch: 13, Steps: 7 | Train Loss: 0.725 Vali Loss: 0.837 Vali Acc: 0.847 Test Loss: 0.837 Test Acc: 0.847
Validation loss decreased (-0.805546 --> -0.847214).  Saving model ...
Epoch: 14 cost time: 0.6238093376159668
Epoch: 14, Steps: 7 | Train Loss: 0.546 Vali Loss: 0.743 Vali Acc: 0.847 Test Loss: 0.743 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847215).  Saving model ...
Epoch: 15 cost time: 0.663872241973877
Epoch: 15, Steps: 7 | Train Loss: 0.456 Vali Loss: 0.668 Vali Acc: 0.847 Test Loss: 0.668 Test Acc: 0.847
Validation loss decreased (-0.847215 --> -0.847216).  Saving model ...
Epoch: 16 cost time: 0.6392207145690918
Epoch: 16, Steps: 7 | Train Loss: 0.396 Vali Loss: 0.599 Vali Acc: 0.903 Test Loss: 0.599 Test Acc: 0.903
Validation loss decreased (-0.847216 --> -0.902772).  Saving model ...
Epoch: 17 cost time: 0.6142439842224121
Epoch: 17, Steps: 7 | Train Loss: 0.319 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7187485694885254
Epoch: 18, Steps: 7 | Train Loss: 0.267 Vali Loss: 0.521 Vali Acc: 0.889 Test Loss: 0.521 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6834621429443359
Epoch: 19, Steps: 7 | Train Loss: 0.254 Vali Loss: 0.499 Vali Acc: 0.875 Test Loss: 0.499 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6690943241119385
Epoch: 20, Steps: 7 | Train Loss: 0.207 Vali Loss: 0.483 Vali Acc: 0.889 Test Loss: 0.483 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6639325618743896
Epoch: 21, Steps: 7 | Train Loss: 0.176 Vali Loss: 0.465 Vali Acc: 0.903 Test Loss: 0.465 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 22 cost time: 0.6707584857940674
Epoch: 22, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.444 Vali Acc: 0.889 Test Loss: 0.444 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6116595268249512
Epoch: 23, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.426 Vali Acc: 0.903 Test Loss: 0.426 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 24 cost time: 0.64107346534729
Epoch: 24, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.414 Vali Acc: 0.917 Test Loss: 0.414 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 25 cost time: 0.6453475952148438
Epoch: 25, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.401 Vali Acc: 0.917 Test Loss: 0.401 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 0.656674861907959
Epoch: 26, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.395 Vali Acc: 0.931 Test Loss: 0.395 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 27 cost time: 0.6677799224853516
Epoch: 27, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.389 Vali Acc: 0.931 Test Loss: 0.389 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 28 cost time: 0.6961126327514648
Epoch: 28, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.387 Vali Acc: 0.917 Test Loss: 0.387 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6370048522949219
Epoch: 29, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.376 Vali Acc: 0.917 Test Loss: 0.376 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7061877250671387
Epoch: 30, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.371 Vali Acc: 0.903 Test Loss: 0.371 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6938807964324951
Epoch: 31, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.368 Vali Acc: 0.903 Test Loss: 0.368 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.678778886795044
Epoch: 32, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8142821788787842
Epoch: 33, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6786692142486572
Epoch: 34, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6747353076934814
Epoch: 35, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.342 Vali Acc: 0.917 Test Loss: 0.342 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7118825912475586
Epoch: 36, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.340 Vali Acc: 0.931 Test Loss: 0.340 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 37 cost time: 0.636725902557373
Epoch: 37, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6448650360107422
Epoch: 38, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 39 cost time: 0.6401629447937012
Epoch: 39, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.328 Vali Acc: 0.931 Test Loss: 0.328 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 40 cost time: 0.6954324245452881
Epoch: 40, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.324 Vali Acc: 0.931 Test Loss: 0.324 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 41 cost time: 0.6629862785339355
Epoch: 41, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.322 Vali Acc: 0.931 Test Loss: 0.322 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 42 cost time: 0.667057991027832
Epoch: 42, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.318 Vali Acc: 0.931 Test Loss: 0.318 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 43 cost time: 0.664353609085083
Epoch: 43, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.316 Vali Acc: 0.931 Test Loss: 0.316 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 44 cost time: 0.6645491123199463
Epoch: 44, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 45 cost time: 0.69443678855896
Epoch: 45, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.308 Vali Acc: 0.931 Test Loss: 0.308 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 46 cost time: 0.7071588039398193
Epoch: 46, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.6895887851715088
Epoch: 47, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.6984543800354004
Epoch: 48, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.7163240909576416
Epoch: 49, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.308 Vali Acc: 0.931 Test Loss: 0.308 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7066347599029541
Epoch: 50, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.308 Vali Acc: 0.931 Test Loss: 0.308 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.644425630569458
Epoch: 51, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 0.6414003372192383
Epoch: 52, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 0.6131651401519775
Epoch: 53, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.6465857028961182
Epoch: 54, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 0.6408414840698242
Epoch: 55, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8741593360900879
Epoch: 56, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.5592551231384277
Epoch: 57, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.6664533615112305
Epoch: 58, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.296 Vali Acc: 0.931 Test Loss: 0.296 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6451852321624756
Epoch: 59, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 60 cost time: 0.6296899318695068
Epoch: 60, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 0.6633119583129883
Epoch: 61, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 62 cost time: 0.5714836120605469
Epoch: 62, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 63 cost time: 0.6666057109832764
Epoch: 63, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7274112701416016
Epoch: 64, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.7017145156860352
Epoch: 65, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.5939695835113525
Epoch: 66, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 67 cost time: 0.7667410373687744
Epoch: 67, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 68 cost time: 0.6266562938690186
Epoch: 68, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 69 cost time: 0.7711222171783447
Epoch: 69, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 70 cost time: 0.6644980907440186
Epoch: 70, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7424118518829346
Epoch: 71, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.727532148361206
Epoch: 72, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 73 cost time: 0.7167928218841553
Epoch: 73, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 74 cost time: 0.7531886100769043
Epoch: 74, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 75 cost time: 0.6856648921966553
Epoch: 75, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 76 cost time: 0.7670431137084961
Epoch: 76, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 77 cost time: 0.6840863227844238
Epoch: 77, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 78 cost time: 0.6783263683319092
Epoch: 78, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.6800415515899658
Epoch: 79, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.6546719074249268
Epoch: 80, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.6695618629455566
Epoch: 81, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.6728365421295166
Epoch: 82, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.6734209060668945
Epoch: 83, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.7011899948120117
Epoch: 84, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.7165555953979492
Epoch: 85, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.681196928024292
Epoch: 86, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 87 cost time: 0.7329549789428711
Epoch: 87, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 88 cost time: 0.6797001361846924
Epoch: 88, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 89 cost time: 0.7608065605163574
Epoch: 89, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 90 cost time: 0.7067840099334717
Epoch: 90, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 91 cost time: 0.779778242111206
Epoch: 91, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.6911361217498779
Epoch: 92, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.7301638126373291
Epoch: 93, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.7299535274505615
Epoch: 94, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.7285401821136475
Epoch: 95, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.679901123046875
Epoch: 96, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 0.6882431507110596
Epoch: 97, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.7699751853942871
Epoch: 98, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 0.7910003662109375
Epoch: 99, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 0.7501883506774902
Epoch: 100, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df128_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 25036
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2586958408355713
Epoch: 1, Steps: 7 | Train Loss: 2.787 Vali Loss: 2.772 Vali Acc: 0.083 Test Loss: 2.772 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 0.7027349472045898
Epoch: 2, Steps: 7 | Train Loss: 2.745 Vali Loss: 2.699 Vali Acc: 0.111 Test Loss: 2.699 Test Acc: 0.111
Validation loss decreased (-0.083306 --> -0.111084).  Saving model ...
Epoch: 3 cost time: 0.7163500785827637
Epoch: 3, Steps: 7 | Train Loss: 2.662 Vali Loss: 2.597 Vali Acc: 0.125 Test Loss: 2.597 Test Acc: 0.125
Validation loss decreased (-0.111084 --> -0.124974).  Saving model ...
Epoch: 4 cost time: 0.6793358325958252
Epoch: 4, Steps: 7 | Train Loss: 2.546 Vali Loss: 2.481 Vali Acc: 0.181 Test Loss: 2.481 Test Acc: 0.181
Validation loss decreased (-0.124974 --> -0.180531).  Saving model ...
Epoch: 5 cost time: 0.645061731338501
Epoch: 5, Steps: 7 | Train Loss: 2.415 Vali Loss: 2.365 Vali Acc: 0.222 Test Loss: 2.365 Test Acc: 0.222
Validation loss decreased (-0.180531 --> -0.222199).  Saving model ...
Epoch: 6 cost time: 0.623776912689209
Epoch: 6, Steps: 7 | Train Loss: 2.278 Vali Loss: 2.238 Vali Acc: 0.306 Test Loss: 2.238 Test Acc: 0.306
Validation loss decreased (-0.222199 --> -0.305533).  Saving model ...
Epoch: 7 cost time: 0.6451730728149414
Epoch: 7, Steps: 7 | Train Loss: 2.130 Vali Loss: 2.122 Vali Acc: 0.361 Test Loss: 2.122 Test Acc: 0.361
Validation loss decreased (-0.305533 --> -0.361090).  Saving model ...
Epoch: 8 cost time: 0.7382955551147461
Epoch: 8, Steps: 7 | Train Loss: 1.987 Vali Loss: 2.001 Vali Acc: 0.431 Test Loss: 2.001 Test Acc: 0.431
Validation loss decreased (-0.361090 --> -0.430536).  Saving model ...
Epoch: 9 cost time: 0.5829343795776367
Epoch: 9, Steps: 7 | Train Loss: 1.848 Vali Loss: 1.877 Vali Acc: 0.583 Test Loss: 1.877 Test Acc: 0.583
Validation loss decreased (-0.430536 --> -0.583315).  Saving model ...
Epoch: 10 cost time: 0.7457778453826904
Epoch: 10, Steps: 7 | Train Loss: 1.713 Vali Loss: 1.748 Vali Acc: 0.694 Test Loss: 1.748 Test Acc: 0.694
Validation loss decreased (-0.583315 --> -0.694427).  Saving model ...
Epoch: 11 cost time: 0.651702880859375
Epoch: 11, Steps: 7 | Train Loss: 1.537 Vali Loss: 1.618 Vali Acc: 0.722 Test Loss: 1.618 Test Acc: 0.722
Validation loss decreased (-0.694427 --> -0.722206).  Saving model ...
Epoch: 12 cost time: 0.6558856964111328
Epoch: 12, Steps: 7 | Train Loss: 1.374 Vali Loss: 1.483 Vali Acc: 0.750 Test Loss: 1.483 Test Acc: 0.750
Validation loss decreased (-0.722206 --> -0.749985).  Saving model ...
Epoch: 13 cost time: 0.7304785251617432
Epoch: 13, Steps: 7 | Train Loss: 1.261 Vali Loss: 1.352 Vali Acc: 0.792 Test Loss: 1.352 Test Acc: 0.792
Validation loss decreased (-0.749985 --> -0.791653).  Saving model ...
Epoch: 14 cost time: 0.6848535537719727
Epoch: 14, Steps: 7 | Train Loss: 1.090 Vali Loss: 1.217 Vali Acc: 0.847 Test Loss: 1.217 Test Acc: 0.847
Validation loss decreased (-0.791653 --> -0.847210).  Saving model ...
Epoch: 15 cost time: 0.6717846393585205
Epoch: 15, Steps: 7 | Train Loss: 0.956 Vali Loss: 1.096 Vali Acc: 0.861 Test Loss: 1.096 Test Acc: 0.861
Validation loss decreased (-0.847210 --> -0.861100).  Saving model ...
Epoch: 16 cost time: 0.6918604373931885
Epoch: 16, Steps: 7 | Train Loss: 0.826 Vali Loss: 0.982 Vali Acc: 0.861 Test Loss: 0.982 Test Acc: 0.861
Validation loss decreased (-0.861100 --> -0.861101).  Saving model ...
Epoch: 17 cost time: 0.7493813037872314
Epoch: 17, Steps: 7 | Train Loss: 0.711 Vali Loss: 0.885 Vali Acc: 0.861 Test Loss: 0.885 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861102).  Saving model ...
Epoch: 18 cost time: 0.7010354995727539
Epoch: 18, Steps: 7 | Train Loss: 0.590 Vali Loss: 0.799 Vali Acc: 0.875 Test Loss: 0.799 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874992).  Saving model ...
Epoch: 19 cost time: 0.6705851554870605
Epoch: 19, Steps: 7 | Train Loss: 0.480 Vali Loss: 0.731 Vali Acc: 0.903 Test Loss: 0.731 Test Acc: 0.903
Validation loss decreased (-0.874992 --> -0.902770).  Saving model ...
Epoch: 20 cost time: 0.7410030364990234
Epoch: 20, Steps: 7 | Train Loss: 0.434 Vali Loss: 0.679 Vali Acc: 0.889 Test Loss: 0.679 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.818690299987793
Epoch: 21, Steps: 7 | Train Loss: 0.388 Vali Loss: 0.633 Vali Acc: 0.889 Test Loss: 0.633 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7173142433166504
Epoch: 22, Steps: 7 | Train Loss: 0.311 Vali Loss: 0.598 Vali Acc: 0.889 Test Loss: 0.598 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.759030818939209
Epoch: 23, Steps: 7 | Train Loss: 0.294 Vali Loss: 0.564 Vali Acc: 0.889 Test Loss: 0.564 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7377710342407227
Epoch: 24, Steps: 7 | Train Loss: 0.257 Vali Loss: 0.544 Vali Acc: 0.889 Test Loss: 0.544 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6636111736297607
Epoch: 25, Steps: 7 | Train Loss: 0.222 Vali Loss: 0.525 Vali Acc: 0.875 Test Loss: 0.525 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7029681205749512
Epoch: 26, Steps: 7 | Train Loss: 0.182 Vali Loss: 0.498 Vali Acc: 0.875 Test Loss: 0.498 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7071642875671387
Epoch: 27, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6196703910827637
Epoch: 28, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7223117351531982
Epoch: 29, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.457 Vali Acc: 0.889 Test Loss: 0.457 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 23692
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.36328125
Epoch: 1, Steps: 7 | Train Loss: 2.572 Vali Loss: 2.490 Vali Acc: 0.125 Test Loss: 2.490 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.7404792308807373
Epoch: 2, Steps: 7 | Train Loss: 2.449 Vali Loss: 2.219 Vali Acc: 0.389 Test Loss: 2.219 Test Acc: 0.389
Validation loss decreased (-0.124975 --> -0.388867).  Saving model ...
Epoch: 3 cost time: 0.8075258731842041
Epoch: 3, Steps: 7 | Train Loss: 2.077 Vali Loss: 1.879 Vali Acc: 0.528 Test Loss: 1.879 Test Acc: 0.528
Validation loss decreased (-0.388867 --> -0.527759).  Saving model ...
Epoch: 4 cost time: 0.7545914649963379
Epoch: 4, Steps: 7 | Train Loss: 1.681 Vali Loss: 1.523 Vali Acc: 0.736 Test Loss: 1.523 Test Acc: 0.736
Validation loss decreased (-0.527759 --> -0.736096).  Saving model ...
Epoch: 5 cost time: 0.7991218566894531
Epoch: 5, Steps: 7 | Train Loss: 1.272 Vali Loss: 1.185 Vali Acc: 0.792 Test Loss: 1.185 Test Acc: 0.792
Validation loss decreased (-0.736096 --> -0.791655).  Saving model ...
Epoch: 6 cost time: 0.6748552322387695
Epoch: 6, Steps: 7 | Train Loss: 0.857 Vali Loss: 0.842 Vali Acc: 0.861 Test Loss: 0.842 Test Acc: 0.861
Validation loss decreased (-0.791655 --> -0.861103).  Saving model ...
Epoch: 7 cost time: 0.8030917644500732
Epoch: 7, Steps: 7 | Train Loss: 0.494 Vali Loss: 0.620 Vali Acc: 0.875 Test Loss: 0.620 Test Acc: 0.875
Validation loss decreased (-0.861103 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 0.7555515766143799
Epoch: 8, Steps: 7 | Train Loss: 0.279 Vali Loss: 0.460 Vali Acc: 0.889 Test Loss: 0.460 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 0.8211274147033691
Epoch: 9, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.7847621440887451
Epoch: 10, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 0.8172364234924316
Epoch: 11, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.7921168804168701
Epoch: 12, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.7646713256835938
Epoch: 13, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7796697616577148
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8378744125366211
Epoch: 15, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7219414710998535
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.7366721630096436
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.7281315326690674
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7081327438354492
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7444219589233398
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7549934387207031
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.7670257091522217
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.7717835903167725
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7537999153137207
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7102770805358887
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.7274580001831055
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.8060798645019531
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.793748140335083
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.7364563941955566
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.7756268978118896
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.7358465194702148
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.7191762924194336
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 33 cost time: 0.7297272682189941
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 34 cost time: 0.7894766330718994
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 35 cost time: 0.6719341278076172
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 0.7387425899505615
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 0.6875333786010742
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 38 cost time: 0.7327063083648682
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 0.802973747253418
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 0.716970682144165
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.7271170616149902
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.6843011379241943
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.82704758644104
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 0.7134385108947754
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 0.7304413318634033
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 0.7105538845062256
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.7424592971801758
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7683806419372559
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8177239894866943
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.7420973777770996
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7960293292999268
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.79486083984375
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 0.776113748550415
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 54 cost time: 0.8164422512054443
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 55 cost time: 0.7905645370483398
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 56 cost time: 0.8092496395111084
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 57 cost time: 0.78786301612854
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 58 cost time: 0.7437353134155273
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6760344505310059
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 60 cost time: 0.8328757286071777
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7255170345306396
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.8091354370117188
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 63 cost time: 0.6305735111236572
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 64 cost time: 0.6738801002502441
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 65 cost time: 0.6734435558319092
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 66 cost time: 0.7926437854766846
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 67 cost time: 0.6347506046295166
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 68 cost time: 0.7013261318206787
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.6840379238128662
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 70 cost time: 0.7128911018371582
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 71 cost time: 0.6638634204864502
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 72 cost time: 0.7337307929992676
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 73 cost time: 0.7287278175354004
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 74 cost time: 0.6913609504699707
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 75 cost time: 0.7471802234649658
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 76 cost time: 0.7335121631622314
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.8050734996795654
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 78 cost time: 0.7505326271057129
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 79 cost time: 0.7994663715362549
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 80 cost time: 0.7282474040985107
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.7701301574707031
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 82 cost time: 0.7410256862640381
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.769279956817627
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.7522528171539307
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.7122275829315186
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.7442121505737305
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 87 cost time: 0.7490458488464355
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 88 cost time: 0.7025115489959717
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 89 cost time: 0.7507622241973877
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 90 cost time: 0.778285026550293
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 91 cost time: 0.8115329742431641
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 92 cost time: 0.8053758144378662
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 93 cost time: 0.7637524604797363
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 94 cost time: 0.7593765258789062
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 95 cost time: 0.8300085067749023
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.7597825527191162
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.7502837181091309
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 0.7576065063476562
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 0.7828609943389893
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 100 cost time: 0.6508793830871582
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 98092
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.235286235809326
Epoch: 1, Steps: 7 | Train Loss: 2.666 Vali Loss: 2.522 Vali Acc: 0.083 Test Loss: 2.522 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.7192456722259521
Epoch: 2, Steps: 7 | Train Loss: 2.563 Vali Loss: 2.322 Vali Acc: 0.139 Test Loss: 2.322 Test Acc: 0.139
Validation loss decreased (-0.083308 --> -0.138866).  Saving model ...
Epoch: 3 cost time: 0.709388256072998
Epoch: 3, Steps: 7 | Train Loss: 2.288 Vali Loss: 2.066 Vali Acc: 0.417 Test Loss: 2.066 Test Acc: 0.417
Validation loss decreased (-0.138866 --> -0.416646).  Saving model ...
Epoch: 4 cost time: 0.7406439781188965
Epoch: 4, Steps: 7 | Train Loss: 1.958 Vali Loss: 1.772 Vali Acc: 0.611 Test Loss: 1.772 Test Acc: 0.611
Validation loss decreased (-0.416646 --> -0.611093).  Saving model ...
Epoch: 5 cost time: 0.6999204158782959
Epoch: 5, Steps: 7 | Train Loss: 1.618 Vali Loss: 1.464 Vali Acc: 0.736 Test Loss: 1.464 Test Acc: 0.736
Validation loss decreased (-0.611093 --> -0.736096).  Saving model ...
Epoch: 6 cost time: 0.7176327705383301
Epoch: 6, Steps: 7 | Train Loss: 1.246 Vali Loss: 1.172 Vali Acc: 0.778 Test Loss: 1.172 Test Acc: 0.778
Validation loss decreased (-0.736096 --> -0.777766).  Saving model ...
Epoch: 7 cost time: 0.7845385074615479
Epoch: 7, Steps: 7 | Train Loss: 0.947 Vali Loss: 0.935 Vali Acc: 0.806 Test Loss: 0.935 Test Acc: 0.806
Validation loss decreased (-0.777766 --> -0.805546).  Saving model ...
Epoch: 8 cost time: 0.6516745090484619
Epoch: 8, Steps: 7 | Train Loss: 0.647 Vali Loss: 0.730 Vali Acc: 0.833 Test Loss: 0.730 Test Acc: 0.833
Validation loss decreased (-0.805546 --> -0.833326).  Saving model ...
Epoch: 9 cost time: 0.692359447479248
Epoch: 9, Steps: 7 | Train Loss: 0.444 Vali Loss: 0.573 Vali Acc: 0.861 Test Loss: 0.573 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861105).  Saving model ...
Epoch: 10 cost time: 0.7267320156097412
Epoch: 10, Steps: 7 | Train Loss: 0.312 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 11 cost time: 0.6259164810180664
Epoch: 11, Steps: 7 | Train Loss: 0.209 Vali Loss: 0.429 Vali Acc: 0.889 Test Loss: 0.429 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 0.6736481189727783
Epoch: 12, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 0.8130416870117188
Epoch: 13, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.714946985244751
Epoch: 14, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.6610121726989746
Epoch: 15, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.7211635112762451
Epoch: 16, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7153100967407227
Epoch: 17, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7248871326446533
Epoch: 18, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7325234413146973
Epoch: 19, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.7058982849121094
Epoch: 20, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.7671928405761719
Epoch: 21, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.6940288543701172
Epoch: 22, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.6782712936401367
Epoch: 23, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.6747603416442871
Epoch: 24, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.7831342220306396
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.69158935546875
Epoch: 26, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.6989388465881348
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6259763240814209
Epoch: 28, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.650127649307251
Epoch: 29, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.606440544128418
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7999699115753174
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7358207702636719
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.6901750564575195
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7208371162414551
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5898716449737549
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.6427834033966064
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6371467113494873
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6956934928894043
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.7026042938232422
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.7498304843902588
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7632157802581787
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7780489921569824
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.638502836227417
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6808736324310303
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8194003105163574
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7060408592224121
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.7048053741455078
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.613743782043457
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7408652305603027
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 52492
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2269694805145264
Epoch: 1, Steps: 7 | Train Loss: 2.696 Vali Loss: 2.665 Vali Acc: 0.056 Test Loss: 2.665 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 0.691931962966919
Epoch: 2, Steps: 7 | Train Loss: 2.516 Vali Loss: 2.490 Vali Acc: 0.097 Test Loss: 2.490 Test Acc: 0.097
Validation loss decreased (-0.055529 --> -0.097197).  Saving model ...
Epoch: 3 cost time: 0.7219555377960205
Epoch: 3, Steps: 7 | Train Loss: 2.356 Vali Loss: 2.262 Vali Acc: 0.278 Test Loss: 2.262 Test Acc: 0.278
Validation loss decreased (-0.097197 --> -0.277755).  Saving model ...
Epoch: 4 cost time: 0.7988386154174805
Epoch: 4, Steps: 7 | Train Loss: 2.112 Vali Loss: 1.991 Vali Acc: 0.403 Test Loss: 1.991 Test Acc: 0.403
Validation loss decreased (-0.277755 --> -0.402758).  Saving model ...
Epoch: 5 cost time: 0.7143974304199219
Epoch: 5, Steps: 7 | Train Loss: 1.807 Vali Loss: 1.700 Vali Acc: 0.653 Test Loss: 1.700 Test Acc: 0.653
Validation loss decreased (-0.402758 --> -0.652761).  Saving model ...
Epoch: 6 cost time: 0.6580784320831299
Epoch: 6, Steps: 7 | Train Loss: 1.449 Vali Loss: 1.417 Vali Acc: 0.722 Test Loss: 1.417 Test Acc: 0.722
Validation loss decreased (-0.652761 --> -0.722208).  Saving model ...
Epoch: 7 cost time: 0.7381765842437744
Epoch: 7, Steps: 7 | Train Loss: 1.154 Vali Loss: 1.175 Vali Acc: 0.764 Test Loss: 1.175 Test Acc: 0.764
Validation loss decreased (-0.722208 --> -0.763877).  Saving model ...
Epoch: 8 cost time: 0.6344735622406006
Epoch: 8, Steps: 7 | Train Loss: 0.936 Vali Loss: 0.947 Vali Acc: 0.792 Test Loss: 0.947 Test Acc: 0.792
Validation loss decreased (-0.763877 --> -0.791657).  Saving model ...
Epoch: 9 cost time: 0.6561317443847656
Epoch: 9, Steps: 7 | Train Loss: 0.660 Vali Loss: 0.760 Vali Acc: 0.819 Test Loss: 0.760 Test Acc: 0.819
Validation loss decreased (-0.791657 --> -0.819437).  Saving model ...
Epoch: 10 cost time: 0.7156126499176025
Epoch: 10, Steps: 7 | Train Loss: 0.458 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
Validation loss decreased (-0.819437 --> -0.833327).  Saving model ...
Epoch: 11 cost time: 0.7714860439300537
Epoch: 11, Steps: 7 | Train Loss: 0.328 Vali Loss: 0.513 Vali Acc: 0.861 Test Loss: 0.513 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861106).  Saving model ...
Epoch: 12 cost time: 0.7271933555603027
Epoch: 12, Steps: 7 | Train Loss: 0.239 Vali Loss: 0.457 Vali Acc: 0.847 Test Loss: 0.457 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6949284076690674
Epoch: 13, Steps: 7 | Train Loss: 0.160 Vali Loss: 0.400 Vali Acc: 0.861 Test Loss: 0.400 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 0.7220933437347412
Epoch: 14, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.367 Vali Acc: 0.861 Test Loss: 0.367 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 0.7113027572631836
Epoch: 15, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.356 Vali Acc: 0.847 Test Loss: 0.356 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7190008163452148
Epoch: 16, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874997).  Saving model ...
Epoch: 17 cost time: 0.7212207317352295
Epoch: 17, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.8081848621368408
Epoch: 18, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.6794424057006836
Epoch: 19, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.7088212966918945
Epoch: 20, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.7102952003479004
Epoch: 21, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.7085015773773193
Epoch: 22, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.6943590641021729
Epoch: 23, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.7197632789611816
Epoch: 24, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.7698037624359131
Epoch: 25, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.6635289192199707
Epoch: 26, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7082819938659668
Epoch: 27, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.6177773475646973
Epoch: 28, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7962145805358887
Epoch: 29, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6361949443817139
Epoch: 30, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6731517314910889
Epoch: 31, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.714771032333374
Epoch: 32, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6537423133850098
Epoch: 33, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6042282581329346
Epoch: 34, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6907820701599121
Epoch: 35, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6687889099121094
Epoch: 36, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7447738647460938
Epoch: 37, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 37996
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df64_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.119783401489258
Epoch: 1, Steps: 7 | Train Loss: 2.570 Vali Loss: 2.523 Vali Acc: 0.083 Test Loss: 2.523 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.6353120803833008
Epoch: 2, Steps: 7 | Train Loss: 2.537 Vali Loss: 2.386 Vali Acc: 0.111 Test Loss: 2.386 Test Acc: 0.111
Validation loss decreased (-0.083308 --> -0.111087).  Saving model ...
Epoch: 3 cost time: 0.7037806510925293
Epoch: 3, Steps: 7 | Train Loss: 2.335 Vali Loss: 2.210 Vali Acc: 0.236 Test Loss: 2.210 Test Acc: 0.236
Validation loss decreased (-0.111087 --> -0.236089).  Saving model ...
Epoch: 4 cost time: 0.6967787742614746
Epoch: 4, Steps: 7 | Train Loss: 2.181 Vali Loss: 2.004 Vali Acc: 0.458 Test Loss: 2.004 Test Acc: 0.458
Validation loss decreased (-0.236089 --> -0.458313).  Saving model ...
Epoch: 5 cost time: 0.6618359088897705
Epoch: 5, Steps: 7 | Train Loss: 1.911 Vali Loss: 1.779 Vali Acc: 0.639 Test Loss: 1.779 Test Acc: 0.639
Validation loss decreased (-0.458313 --> -0.638871).  Saving model ...
Epoch: 6 cost time: 0.7264974117279053
Epoch: 6, Steps: 7 | Train Loss: 1.670 Vali Loss: 1.552 Vali Acc: 0.750 Test Loss: 1.552 Test Acc: 0.750
Validation loss decreased (-0.638871 --> -0.749984).  Saving model ...
Epoch: 7 cost time: 0.6494922637939453
Epoch: 7, Steps: 7 | Train Loss: 1.417 Vali Loss: 1.311 Vali Acc: 0.750 Test Loss: 1.311 Test Acc: 0.750
Validation loss decreased (-0.749984 --> -0.749987).  Saving model ...
Epoch: 8 cost time: 0.6636552810668945
Epoch: 8, Steps: 7 | Train Loss: 1.161 Vali Loss: 1.089 Vali Acc: 0.792 Test Loss: 1.089 Test Acc: 0.792
Validation loss decreased (-0.749987 --> -0.791656).  Saving model ...
Epoch: 9 cost time: 0.7220802307128906
Epoch: 9, Steps: 7 | Train Loss: 0.909 Vali Loss: 0.900 Vali Acc: 0.819 Test Loss: 0.900 Test Acc: 0.819
Validation loss decreased (-0.791656 --> -0.819435).  Saving model ...
Epoch: 10 cost time: 0.7008657455444336
Epoch: 10, Steps: 7 | Train Loss: 0.711 Vali Loss: 0.747 Vali Acc: 0.819 Test Loss: 0.747 Test Acc: 0.819
Validation loss decreased (-0.819435 --> -0.819437).  Saving model ...
Epoch: 11 cost time: 0.6700572967529297
Epoch: 11, Steps: 7 | Train Loss: 0.499 Vali Loss: 0.609 Vali Acc: 0.861 Test Loss: 0.609 Test Acc: 0.861
Validation loss decreased (-0.819437 --> -0.861105).  Saving model ...
Epoch: 12 cost time: 0.6462795734405518
Epoch: 12, Steps: 7 | Train Loss: 0.392 Vali Loss: 0.511 Vali Acc: 0.889 Test Loss: 0.511 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888884).  Saving model ...
Epoch: 13 cost time: 0.6852283477783203
Epoch: 13, Steps: 7 | Train Loss: 0.278 Vali Loss: 0.443 Vali Acc: 0.903 Test Loss: 0.443 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902773).  Saving model ...
Epoch: 14 cost time: 0.6064972877502441
Epoch: 14, Steps: 7 | Train Loss: 0.217 Vali Loss: 0.414 Vali Acc: 0.861 Test Loss: 0.414 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6902875900268555
Epoch: 15, Steps: 7 | Train Loss: 0.156 Vali Loss: 0.366 Vali Acc: 0.889 Test Loss: 0.366 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7231721878051758
Epoch: 16, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 0.6556439399719238
Epoch: 17, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.6443090438842773
Epoch: 18, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.6415972709655762
Epoch: 19, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.6748158931732178
Epoch: 20, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.6465141773223877
Epoch: 21, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.6976010799407959
Epoch: 22, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.6820547580718994
Epoch: 23, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.668724536895752
Epoch: 24, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.7261867523193359
Epoch: 25, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.674985408782959
Epoch: 26, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6899969577789307
Epoch: 27, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6055252552032471
Epoch: 28, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8054769039154053
Epoch: 29, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6717586517333984
Epoch: 30, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.581087589263916
Epoch: 31, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6339950561523438
Epoch: 32, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7271947860717773
Epoch: 33, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.700681209564209
Epoch: 34, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6748189926147461
Epoch: 35, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df64_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 30412
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.340630054473877
Epoch: 1, Steps: 7 | Train Loss: 2.631 Vali Loss: 2.501 Vali Acc: 0.069 Test Loss: 2.501 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.7553648948669434
Epoch: 2, Steps: 7 | Train Loss: 2.546 Vali Loss: 2.427 Vali Acc: 0.097 Test Loss: 2.427 Test Acc: 0.097
Validation loss decreased (-0.069419 --> -0.097198).  Saving model ...
Epoch: 3 cost time: 0.738990068435669
Epoch: 3, Steps: 7 | Train Loss: 2.435 Vali Loss: 2.313 Vali Acc: 0.167 Test Loss: 2.313 Test Acc: 0.167
Validation loss decreased (-0.097198 --> -0.166644).  Saving model ...
Epoch: 4 cost time: 0.7143425941467285
Epoch: 4, Steps: 7 | Train Loss: 2.236 Vali Loss: 2.168 Vali Acc: 0.278 Test Loss: 2.168 Test Acc: 0.278
Validation loss decreased (-0.166644 --> -0.277756).  Saving model ...
Epoch: 5 cost time: 0.6849377155303955
Epoch: 5, Steps: 7 | Train Loss: 2.087 Vali Loss: 2.001 Vali Acc: 0.458 Test Loss: 2.001 Test Acc: 0.458
Validation loss decreased (-0.277756 --> -0.458313).  Saving model ...
Epoch: 6 cost time: 0.6723089218139648
Epoch: 6, Steps: 7 | Train Loss: 1.904 Vali Loss: 1.825 Vali Acc: 0.583 Test Loss: 1.825 Test Acc: 0.583
Validation loss decreased (-0.458313 --> -0.583315).  Saving model ...
Epoch: 7 cost time: 0.7668728828430176
Epoch: 7, Steps: 7 | Train Loss: 1.700 Vali Loss: 1.632 Vali Acc: 0.694 Test Loss: 1.632 Test Acc: 0.694
Validation loss decreased (-0.583315 --> -0.694428).  Saving model ...
Epoch: 8 cost time: 0.6972262859344482
Epoch: 8, Steps: 7 | Train Loss: 1.468 Vali Loss: 1.438 Vali Acc: 0.736 Test Loss: 1.438 Test Acc: 0.736
Validation loss decreased (-0.694428 --> -0.736097).  Saving model ...
Epoch: 9 cost time: 0.7920823097229004
Epoch: 9, Steps: 7 | Train Loss: 1.259 Vali Loss: 1.251 Vali Acc: 0.750 Test Loss: 1.251 Test Acc: 0.750
Validation loss decreased (-0.736097 --> -0.749987).  Saving model ...
Epoch: 10 cost time: 0.8426971435546875
Epoch: 10, Steps: 7 | Train Loss: 1.017 Vali Loss: 1.083 Vali Acc: 0.764 Test Loss: 1.083 Test Acc: 0.764
Validation loss decreased (-0.749987 --> -0.763878).  Saving model ...
Epoch: 11 cost time: 0.725623607635498
Epoch: 11, Steps: 7 | Train Loss: 0.871 Vali Loss: 0.919 Vali Acc: 0.792 Test Loss: 0.919 Test Acc: 0.792
Validation loss decreased (-0.763878 --> -0.791657).  Saving model ...
Epoch: 12 cost time: 0.7720823287963867
Epoch: 12, Steps: 7 | Train Loss: 0.677 Vali Loss: 0.790 Vali Acc: 0.806 Test Loss: 0.790 Test Acc: 0.806
Validation loss decreased (-0.791657 --> -0.805548).  Saving model ...
Epoch: 13 cost time: 0.7126758098602295
Epoch: 13, Steps: 7 | Train Loss: 0.535 Vali Loss: 0.687 Vali Acc: 0.833 Test Loss: 0.687 Test Acc: 0.833
Validation loss decreased (-0.805548 --> -0.833326).  Saving model ...
Epoch: 14 cost time: 0.8625438213348389
Epoch: 14, Steps: 7 | Train Loss: 0.444 Vali Loss: 0.595 Vali Acc: 0.819 Test Loss: 0.595 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8024659156799316
Epoch: 15, Steps: 7 | Train Loss: 0.349 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
Validation loss decreased (-0.833326 --> -0.847217).  Saving model ...
Epoch: 16 cost time: 0.7308077812194824
Epoch: 16, Steps: 7 | Train Loss: 0.269 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874995).  Saving model ...
Epoch: 17 cost time: 0.773430347442627
Epoch: 17, Steps: 7 | Train Loss: 0.226 Vali Loss: 0.444 Vali Acc: 0.889 Test Loss: 0.444 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888884).  Saving model ...
Epoch: 18 cost time: 0.7965006828308105
Epoch: 18, Steps: 7 | Train Loss: 0.186 Vali Loss: 0.425 Vali Acc: 0.875 Test Loss: 0.425 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8418855667114258
Epoch: 19, Steps: 7 | Train Loss: 0.147 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7882959842681885
Epoch: 20, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8430666923522949
Epoch: 21, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 22 cost time: 0.7704098224639893
Epoch: 22, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6956586837768555
Epoch: 23, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.355 Vali Acc: 0.917 Test Loss: 0.355 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 24 cost time: 0.6825580596923828
Epoch: 24, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7655739784240723
Epoch: 25, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7570171356201172
Epoch: 26, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 27 cost time: 0.6995372772216797
Epoch: 27, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.7476725578308105
Epoch: 28, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.6580431461334229
Epoch: 29, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.7302842140197754
Epoch: 30, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7081997394561768
Epoch: 31, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7461769580841064
Epoch: 32, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7809507846832275
Epoch: 33, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6787667274475098
Epoch: 34, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7115991115570068
Epoch: 35, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7300715446472168
Epoch: 36, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7796962261199951
Epoch: 37, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7026069164276123
Epoch: 38, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6436672210693359
Epoch: 39, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 24460
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df64_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.413466453552246
Epoch: 1, Steps: 7 | Train Loss: 2.579 Vali Loss: 2.492 Vali Acc: 0.111 Test Loss: 2.492 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.739008903503418
Epoch: 2, Steps: 7 | Train Loss: 2.549 Vali Loss: 2.415 Vali Acc: 0.153 Test Loss: 2.415 Test Acc: 0.153
Validation loss decreased (-0.111086 --> -0.152754).  Saving model ...
Epoch: 3 cost time: 0.786855936050415
Epoch: 3, Steps: 7 | Train Loss: 2.427 Vali Loss: 2.315 Vali Acc: 0.194 Test Loss: 2.315 Test Acc: 0.194
Validation loss decreased (-0.152754 --> -0.194421).  Saving model ...
Epoch: 4 cost time: 0.7019877433776855
Epoch: 4, Steps: 7 | Train Loss: 2.388 Vali Loss: 2.197 Vali Acc: 0.319 Test Loss: 2.197 Test Acc: 0.319
Validation loss decreased (-0.194421 --> -0.319422).  Saving model ...
Epoch: 5 cost time: 0.6750659942626953
Epoch: 5, Steps: 7 | Train Loss: 2.186 Vali Loss: 2.065 Vali Acc: 0.431 Test Loss: 2.065 Test Acc: 0.431
Validation loss decreased (-0.319422 --> -0.430535).  Saving model ...
Epoch: 6 cost time: 0.67287278175354
Epoch: 6, Steps: 7 | Train Loss: 2.017 Vali Loss: 1.923 Vali Acc: 0.583 Test Loss: 1.923 Test Acc: 0.583
Validation loss decreased (-0.430535 --> -0.583314).  Saving model ...
Epoch: 7 cost time: 0.8443248271942139
Epoch: 7, Steps: 7 | Train Loss: 1.880 Vali Loss: 1.780 Vali Acc: 0.625 Test Loss: 1.780 Test Acc: 0.625
Validation loss decreased (-0.583314 --> -0.624982).  Saving model ...
Epoch: 8 cost time: 0.8996658325195312
Epoch: 8, Steps: 7 | Train Loss: 1.697 Vali Loss: 1.632 Vali Acc: 0.653 Test Loss: 1.632 Test Acc: 0.653
Validation loss decreased (-0.624982 --> -0.652761).  Saving model ...
Epoch: 9 cost time: 0.7373178005218506
Epoch: 9, Steps: 7 | Train Loss: 1.521 Vali Loss: 1.491 Vali Acc: 0.708 Test Loss: 1.491 Test Acc: 0.708
Validation loss decreased (-0.652761 --> -0.708318).  Saving model ...
Epoch: 10 cost time: 0.7748584747314453
Epoch: 10, Steps: 7 | Train Loss: 1.319 Vali Loss: 1.344 Vali Acc: 0.736 Test Loss: 1.344 Test Acc: 0.736
Validation loss decreased (-0.708318 --> -0.736098).  Saving model ...
Epoch: 11 cost time: 0.588890790939331
Epoch: 11, Steps: 7 | Train Loss: 1.199 Vali Loss: 1.199 Vali Acc: 0.792 Test Loss: 1.199 Test Acc: 0.792
Validation loss decreased (-0.736098 --> -0.791655).  Saving model ...
Epoch: 12 cost time: 0.6406681537628174
Epoch: 12, Steps: 7 | Train Loss: 1.042 Vali Loss: 1.072 Vali Acc: 0.806 Test Loss: 1.072 Test Acc: 0.806
Validation loss decreased (-0.791655 --> -0.805545).  Saving model ...
Epoch: 13 cost time: 0.6679644584655762
Epoch: 13, Steps: 7 | Train Loss: 0.879 Vali Loss: 0.949 Vali Acc: 0.806 Test Loss: 0.949 Test Acc: 0.806
Validation loss decreased (-0.805545 --> -0.805546).  Saving model ...
Epoch: 14 cost time: 0.8253440856933594
Epoch: 14, Steps: 7 | Train Loss: 0.712 Vali Loss: 0.835 Vali Acc: 0.847 Test Loss: 0.835 Test Acc: 0.847
Validation loss decreased (-0.805546 --> -0.847214).  Saving model ...
Epoch: 15 cost time: 0.7328343391418457
Epoch: 15, Steps: 7 | Train Loss: 0.628 Vali Loss: 0.743 Vali Acc: 0.889 Test Loss: 0.743 Test Acc: 0.889
Validation loss decreased (-0.847214 --> -0.888881).  Saving model ...
Epoch: 16 cost time: 0.6561784744262695
Epoch: 16, Steps: 7 | Train Loss: 0.510 Vali Loss: 0.678 Vali Acc: 0.875 Test Loss: 0.678 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7638874053955078
Epoch: 17, Steps: 7 | Train Loss: 0.411 Vali Loss: 0.623 Vali Acc: 0.875 Test Loss: 0.623 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7158815860748291
Epoch: 18, Steps: 7 | Train Loss: 0.356 Vali Loss: 0.573 Vali Acc: 0.875 Test Loss: 0.573 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7751142978668213
Epoch: 19, Steps: 7 | Train Loss: 0.296 Vali Loss: 0.535 Vali Acc: 0.875 Test Loss: 0.535 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7526888847351074
Epoch: 20, Steps: 7 | Train Loss: 0.262 Vali Loss: 0.502 Vali Acc: 0.903 Test Loss: 0.502 Test Acc: 0.903
Validation loss decreased (-0.888881 --> -0.902773).  Saving model ...
Epoch: 21 cost time: 0.6702418327331543
Epoch: 21, Steps: 7 | Train Loss: 0.222 Vali Loss: 0.482 Vali Acc: 0.889 Test Loss: 0.482 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7227261066436768
Epoch: 22, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.459 Vali Acc: 0.903 Test Loss: 0.459 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 23 cost time: 0.7540223598480225
Epoch: 23, Steps: 7 | Train Loss: 0.174 Vali Loss: 0.441 Vali Acc: 0.903 Test Loss: 0.441 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 24 cost time: 0.6714987754821777
Epoch: 24, Steps: 7 | Train Loss: 0.149 Vali Loss: 0.420 Vali Acc: 0.903 Test Loss: 0.420 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 25 cost time: 0.7447280883789062
Epoch: 25, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.402 Vali Acc: 0.903 Test Loss: 0.402 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 26 cost time: 0.7373008728027344
Epoch: 26, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.395 Vali Acc: 0.903 Test Loss: 0.395 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 27 cost time: 0.7016420364379883
Epoch: 27, Steps: 7 | Train Loss: 0.108 Vali Loss: 0.386 Vali Acc: 0.903 Test Loss: 0.386 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 28 cost time: 0.7897799015045166
Epoch: 28, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 29 cost time: 0.7761707305908203
Epoch: 29, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.369 Vali Acc: 0.903 Test Loss: 0.369 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 30 cost time: 0.6443350315093994
Epoch: 30, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.365 Vali Acc: 0.903 Test Loss: 0.365 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 31 cost time: 0.745471715927124
Epoch: 31, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.356 Vali Acc: 0.903 Test Loss: 0.356 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 32 cost time: 0.78678297996521
Epoch: 32, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 33 cost time: 0.6708395481109619
Epoch: 33, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 34 cost time: 0.730510950088501
Epoch: 34, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 35 cost time: 0.7457339763641357
Epoch: 35, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 36 cost time: 0.7323172092437744
Epoch: 36, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.7026815414428711
Epoch: 37, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.6937096118927002
Epoch: 38, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.6647310256958008
Epoch: 39, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.6887552738189697
Epoch: 40, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.8690190315246582
Epoch: 41, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.66741943359375
Epoch: 42, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.7030816078186035
Epoch: 43, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.70548415184021
Epoch: 44, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.6489393711090088
Epoch: 45, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.6682224273681641
Epoch: 46, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.6759698390960693
Epoch: 47, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.6859073638916016
Epoch: 48, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.6981408596038818
Epoch: 49, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.7472531795501709
Epoch: 50, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.8020634651184082
Epoch: 51, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7676057815551758
Epoch: 52, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 53 cost time: 0.7632453441619873
Epoch: 53, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.7844915390014648
Epoch: 54, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.697817325592041
Epoch: 55, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 0.7973077297210693
Epoch: 56, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 0.7970130443572998
Epoch: 57, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.8208699226379395
Epoch: 58, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 0.8506083488464355
Epoch: 59, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8451142311096191
Epoch: 60, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 0.7698876857757568
Epoch: 61, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8110523223876953
Epoch: 62, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.7052743434906006
Epoch: 63, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.6673939228057861
Epoch: 64, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.6844327449798584
Epoch: 65, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.7385044097900391
Epoch: 66, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 0.6968262195587158
Epoch: 67, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 0.7120552062988281
Epoch: 68, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 0.6611301898956299
Epoch: 69, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 0.7861487865447998
Epoch: 70, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 0.7033388614654541
Epoch: 71, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 0.8368489742279053
Epoch: 72, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.7355854511260986
Epoch: 73, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.6629021167755127
Epoch: 74, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.7138440608978271
Epoch: 75, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.7616565227508545
Epoch: 76, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.750230073928833
Epoch: 77, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 78 cost time: 0.6644787788391113
Epoch: 78, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 79 cost time: 0.7020833492279053
Epoch: 79, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 80 cost time: 0.7393081188201904
Epoch: 80, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 81 cost time: 0.6394777297973633
Epoch: 81, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.6943304538726807
Epoch: 82, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 83 cost time: 0.8173699378967285
Epoch: 83, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 84 cost time: 0.7592768669128418
Epoch: 84, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.66139817237854
Epoch: 85, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.7408227920532227
Epoch: 86, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.6132259368896484
Epoch: 87, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.7757108211517334
Epoch: 88, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 0.804858922958374
Epoch: 89, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 0.897998571395874
Epoch: 90, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 0.6821320056915283
Epoch: 91, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 0.7212185859680176
Epoch: 92, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 0.6790423393249512
Epoch: 93, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df64_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 20812
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.221893072128296
Epoch: 1, Steps: 7 | Train Loss: 2.606 Vali Loss: 2.544 Vali Acc: 0.097 Test Loss: 2.544 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.6619627475738525
Epoch: 2, Steps: 7 | Train Loss: 2.506 Vali Loss: 2.479 Vali Acc: 0.181 Test Loss: 2.479 Test Acc: 0.181
Validation loss decreased (-0.097197 --> -0.180531).  Saving model ...
Epoch: 3 cost time: 0.6720023155212402
Epoch: 3, Steps: 7 | Train Loss: 2.488 Vali Loss: 2.382 Vali Acc: 0.181 Test Loss: 2.382 Test Acc: 0.181
Validation loss decreased (-0.180531 --> -0.180532).  Saving model ...
Epoch: 4 cost time: 0.6923370361328125
Epoch: 4, Steps: 7 | Train Loss: 2.421 Vali Loss: 2.264 Vali Acc: 0.292 Test Loss: 2.264 Test Acc: 0.292
Validation loss decreased (-0.180532 --> -0.291644).  Saving model ...
Epoch: 5 cost time: 0.7819433212280273
Epoch: 5, Steps: 7 | Train Loss: 2.240 Vali Loss: 2.137 Vali Acc: 0.333 Test Loss: 2.137 Test Acc: 0.333
Validation loss decreased (-0.291644 --> -0.333312).  Saving model ...
Epoch: 6 cost time: 0.7456510066986084
Epoch: 6, Steps: 7 | Train Loss: 2.101 Vali Loss: 2.007 Vali Acc: 0.403 Test Loss: 2.007 Test Acc: 0.403
Validation loss decreased (-0.333312 --> -0.402758).  Saving model ...
Epoch: 7 cost time: 0.8232619762420654
Epoch: 7, Steps: 7 | Train Loss: 1.897 Vali Loss: 1.875 Vali Acc: 0.514 Test Loss: 1.875 Test Acc: 0.514
Validation loss decreased (-0.402758 --> -0.513870).  Saving model ...
Epoch: 8 cost time: 0.72747802734375
Epoch: 8, Steps: 7 | Train Loss: 1.797 Vali Loss: 1.736 Vali Acc: 0.639 Test Loss: 1.736 Test Acc: 0.639
Validation loss decreased (-0.513870 --> -0.638872).  Saving model ...
Epoch: 9 cost time: 0.6271440982818604
Epoch: 9, Steps: 7 | Train Loss: 1.611 Vali Loss: 1.599 Vali Acc: 0.694 Test Loss: 1.599 Test Acc: 0.694
Validation loss decreased (-0.638872 --> -0.694428).  Saving model ...
Epoch: 10 cost time: 0.6862170696258545
Epoch: 10, Steps: 7 | Train Loss: 1.487 Vali Loss: 1.465 Vali Acc: 0.708 Test Loss: 1.465 Test Acc: 0.708
Validation loss decreased (-0.694428 --> -0.708319).  Saving model ...
Epoch: 11 cost time: 0.7797849178314209
Epoch: 11, Steps: 7 | Train Loss: 1.309 Vali Loss: 1.328 Vali Acc: 0.764 Test Loss: 1.328 Test Acc: 0.764
Validation loss decreased (-0.708319 --> -0.763876).  Saving model ...
Epoch: 12 cost time: 0.6452662944793701
Epoch: 12, Steps: 7 | Train Loss: 1.135 Vali Loss: 1.197 Vali Acc: 0.778 Test Loss: 1.197 Test Acc: 0.778
Validation loss decreased (-0.763876 --> -0.777766).  Saving model ...
Epoch: 13 cost time: 0.676119327545166
Epoch: 13, Steps: 7 | Train Loss: 1.016 Vali Loss: 1.078 Vali Acc: 0.778 Test Loss: 1.078 Test Acc: 0.778
Validation loss decreased (-0.777766 --> -0.777767).  Saving model ...
Epoch: 14 cost time: 0.7061624526977539
Epoch: 14, Steps: 7 | Train Loss: 0.875 Vali Loss: 0.965 Vali Acc: 0.819 Test Loss: 0.965 Test Acc: 0.819
Validation loss decreased (-0.777767 --> -0.819435).  Saving model ...
Epoch: 15 cost time: 0.784700870513916
Epoch: 15, Steps: 7 | Train Loss: 0.751 Vali Loss: 0.867 Vali Acc: 0.847 Test Loss: 0.867 Test Acc: 0.847
Validation loss decreased (-0.819435 --> -0.847214).  Saving model ...
Epoch: 16 cost time: 0.6913623809814453
Epoch: 16, Steps: 7 | Train Loss: 0.628 Vali Loss: 0.782 Vali Acc: 0.847 Test Loss: 0.782 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847214).  Saving model ...
Epoch: 17 cost time: 0.6440198421478271
Epoch: 17, Steps: 7 | Train Loss: 0.538 Vali Loss: 0.707 Vali Acc: 0.847 Test Loss: 0.707 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847215).  Saving model ...
Epoch: 18 cost time: 0.797961950302124
Epoch: 18, Steps: 7 | Train Loss: 0.442 Vali Loss: 0.655 Vali Acc: 0.847 Test Loss: 0.655 Test Acc: 0.847
Validation loss decreased (-0.847215 --> -0.847216).  Saving model ...
Epoch: 19 cost time: 0.6889495849609375
Epoch: 19, Steps: 7 | Train Loss: 0.380 Vali Loss: 0.615 Vali Acc: 0.875 Test Loss: 0.615 Test Acc: 0.875
Validation loss decreased (-0.847216 --> -0.874994).  Saving model ...
Epoch: 20 cost time: 0.7322647571563721
Epoch: 20, Steps: 7 | Train Loss: 0.340 Vali Loss: 0.576 Vali Acc: 0.847 Test Loss: 0.576 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7437703609466553
Epoch: 21, Steps: 7 | Train Loss: 0.281 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7022840976715088
Epoch: 22, Steps: 7 | Train Loss: 0.248 Vali Loss: 0.525 Vali Acc: 0.875 Test Loss: 0.525 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 0.7739286422729492
Epoch: 23, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 24 cost time: 0.7463359832763672
Epoch: 24, Steps: 7 | Train Loss: 0.199 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 25 cost time: 0.8580131530761719
Epoch: 25, Steps: 7 | Train Loss: 0.179 Vali Loss: 0.466 Vali Acc: 0.875 Test Loss: 0.466 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 26 cost time: 0.8215165138244629
Epoch: 26, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.448 Vali Acc: 0.861 Test Loss: 0.448 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6562793254852295
Epoch: 27, Steps: 7 | Train Loss: 0.157 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 28 cost time: 0.683506965637207
Epoch: 28, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.434 Vali Acc: 0.889 Test Loss: 0.434 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 29 cost time: 0.6768970489501953
Epoch: 29, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.428 Vali Acc: 0.889 Test Loss: 0.428 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 30 cost time: 0.6859045028686523
Epoch: 30, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 31 cost time: 0.7851252555847168
Epoch: 31, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.410 Vali Acc: 0.889 Test Loss: 0.410 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 32 cost time: 0.6770792007446289
Epoch: 32, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 33 cost time: 0.6956722736358643
Epoch: 33, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 34 cost time: 0.7699658870697021
Epoch: 34, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 35 cost time: 0.7265331745147705
Epoch: 35, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 36 cost time: 0.7082011699676514
Epoch: 36, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 37 cost time: 0.7632994651794434
Epoch: 37, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.378 Vali Acc: 0.889 Test Loss: 0.378 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 38 cost time: 0.7254610061645508
Epoch: 38, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.378 Vali Acc: 0.889 Test Loss: 0.378 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 39 cost time: 0.7301833629608154
Epoch: 39, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 40 cost time: 0.8181018829345703
Epoch: 40, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 41 cost time: 0.7143476009368896
Epoch: 41, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.361 Vali Acc: 0.889 Test Loss: 0.361 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 42 cost time: 0.7034728527069092
Epoch: 42, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 43 cost time: 0.8463494777679443
Epoch: 43, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7679300308227539
Epoch: 44, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 45 cost time: 0.6776828765869141
Epoch: 45, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 46 cost time: 0.6681616306304932
Epoch: 46, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 47 cost time: 0.7396762371063232
Epoch: 47, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 48 cost time: 0.6509449481964111
Epoch: 48, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 49 cost time: 0.5988595485687256
Epoch: 49, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 50 cost time: 0.7362253665924072
Epoch: 50, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.773817777633667
Epoch: 51, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.716118574142456
Epoch: 52, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.7310006618499756
Epoch: 53, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 54 cost time: 0.7054080963134766
Epoch: 54, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.7810709476470947
Epoch: 55, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8306314945220947
Epoch: 56, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 57 cost time: 0.701728105545044
Epoch: 57, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 0.6444838047027588
Epoch: 58, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 59 cost time: 0.7000532150268555
Epoch: 59, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.7162117958068848
Epoch: 60, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 0.6010086536407471
Epoch: 61, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7135624885559082
Epoch: 62, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.7622852325439453
Epoch: 63, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 0.7357604503631592
Epoch: 64, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.6714458465576172
Epoch: 65, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.6719794273376465
Epoch: 66, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 0.6240255832672119
Epoch: 67, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 0.6816868782043457
Epoch: 68, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 0.7398679256439209
Epoch: 69, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 0.6089620590209961
Epoch: 70, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7800326347351074
Epoch: 71, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.8237838745117188
Epoch: 72, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.7096607685089111
Epoch: 73, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.7667028903961182
Epoch: 74, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 75 cost time: 0.6733293533325195
Epoch: 75, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 76 cost time: 0.7546126842498779
Epoch: 76, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 77 cost time: 0.7121424674987793
Epoch: 77, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 78 cost time: 0.6999266147613525
Epoch: 78, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.6420598030090332
Epoch: 79, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.752349853515625
Epoch: 80, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.6865472793579102
Epoch: 81, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 82 cost time: 0.6454818248748779
Epoch: 82, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 83 cost time: 0.6679096221923828
Epoch: 83, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.7370505332946777
Epoch: 84, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.6509950160980225
Epoch: 85, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.6271085739135742
Epoch: 86, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.6256742477416992
Epoch: 87, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 88 cost time: 0.7267589569091797
Epoch: 88, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.720038890838623
Epoch: 89, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 90 cost time: 0.6778223514556885
Epoch: 90, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 91 cost time: 0.8027064800262451
Epoch: 91, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.7303426265716553
Epoch: 92, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.7514474391937256
Epoch: 93, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.7980725765228271
Epoch: 94, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 95 cost time: 0.7427570819854736
Epoch: 95, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 96 cost time: 0.7691512107849121
Epoch: 96, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 97 cost time: 0.6862261295318604
Epoch: 97, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.7242000102996826
Epoch: 98, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.6937053203582764
Epoch: 99, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 0.6584322452545166
Epoch: 100, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el2_dm16_nh4_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 19468
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3343942165374756
Epoch: 1, Steps: 7 | Train Loss: 2.551 Vali Loss: 1.964 Vali Acc: 0.556 Test Loss: 1.964 Test Acc: 0.556
Validation loss decreased (inf --> -0.555536).  Saving model ...
Epoch: 2 cost time: 0.7834434509277344
Epoch: 2, Steps: 7 | Train Loss: 1.356 Vali Loss: 0.774 Vali Acc: 0.806 Test Loss: 0.774 Test Acc: 0.806
Validation loss decreased (-0.555536 --> -0.805548).  Saving model ...
Epoch: 3 cost time: 0.7956717014312744
Epoch: 3, Steps: 7 | Train Loss: 0.284 Vali Loss: 0.435 Vali Acc: 0.861 Test Loss: 0.435 Test Acc: 0.861
Validation loss decreased (-0.805548 --> -0.861107).  Saving model ...
Epoch: 4 cost time: 0.7764945030212402
Epoch: 4, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
Validation loss decreased (-0.861107 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 0.8197989463806152
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 0.8114845752716064
Epoch: 6, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958331).  Saving model ...
Epoch: 7 cost time: 0.8724517822265625
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9601833820343018
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9076023101806641
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9625582695007324
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8754143714904785
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9043068885803223
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9156661033630371
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9328250885009766
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8571345806121826
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.025686502456665
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 864652
model size : 5.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5680599212646484
Epoch: 1, Steps: 7 | Train Loss: 2.560 Vali Loss: 2.163 Vali Acc: 0.417 Test Loss: 2.163 Test Acc: 0.417
Validation loss decreased (inf --> -0.416645).  Saving model ...
Epoch: 2 cost time: 0.8699135780334473
Epoch: 2, Steps: 7 | Train Loss: 1.805 Vali Loss: 1.234 Vali Acc: 0.750 Test Loss: 1.234 Test Acc: 0.750
Validation loss decreased (-0.416645 --> -0.749988).  Saving model ...
Epoch: 3 cost time: 0.813392162322998
Epoch: 3, Steps: 7 | Train Loss: 0.622 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
Validation loss decreased (-0.749988 --> -0.861105).  Saving model ...
Epoch: 4 cost time: 0.8398070335388184
Epoch: 4, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.367 Vali Acc: 0.931 Test Loss: 0.367 Test Acc: 0.931
Validation loss decreased (-0.861105 --> -0.930552).  Saving model ...
Epoch: 5 cost time: 0.876774787902832
Epoch: 5, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.417 Vali Acc: 0.847 Test Loss: 0.417 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8008763790130615
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8206882476806641
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8443315029144287
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.7461593151092529
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.889040470123291
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8671431541442871
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7594232559204102
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0352962017059326
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8002493381500244
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8706791400909424
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8021352291107178
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7634928226470947
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8250291347503662
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8039608001708984
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 499852
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.609191417694092
Epoch: 1, Steps: 7 | Train Loss: 2.510 Vali Loss: 2.297 Vali Acc: 0.278 Test Loss: 2.297 Test Acc: 0.278
Validation loss decreased (inf --> -0.277755).  Saving model ...
Epoch: 2 cost time: 0.7533009052276611
Epoch: 2, Steps: 7 | Train Loss: 1.908 Vali Loss: 1.490 Vali Acc: 0.681 Test Loss: 1.490 Test Acc: 0.681
Validation loss decreased (-0.277755 --> -0.680541).  Saving model ...
Epoch: 3 cost time: 0.7681550979614258
Epoch: 3, Steps: 7 | Train Loss: 0.935 Vali Loss: 0.806 Vali Acc: 0.889 Test Loss: 0.806 Test Acc: 0.889
Validation loss decreased (-0.680541 --> -0.888881).  Saving model ...
Epoch: 4 cost time: 0.856806755065918
Epoch: 4, Steps: 7 | Train Loss: 0.361 Vali Loss: 0.472 Vali Acc: 0.917 Test Loss: 0.472 Test Acc: 0.917
Validation loss decreased (-0.888881 --> -0.916662).  Saving model ...
Epoch: 5 cost time: 0.8211145401000977
Epoch: 5, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.345 Vali Acc: 0.917 Test Loss: 0.345 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 0.8100988864898682
Epoch: 6, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 0.8129100799560547
Epoch: 7, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 0.8636949062347412
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.9354257583618164
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.8789393901824951
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.9201004505157471
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.832923173904419
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.8977949619293213
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7702121734619141
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8829162120819092
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7799093723297119
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7404301166534424
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8430812358856201
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.6997501850128174
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.8420662879943848
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8500230312347412
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.7969119548797607
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7305681705474854
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.8841099739074707
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 0.8440806865692139
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 0.7361249923706055
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8155899047851562
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7603802680969238
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.849614143371582
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.7364249229431152
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8531646728515625
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8159849643707275
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.7030458450317383
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7850582599639893
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.776691198348999
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8534317016601562
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.7786555290222168
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.9873213768005371
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.7648675441741943
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.8245010375976562
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.7986881732940674
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.7543351650238037
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.7952680587768555
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.7640945911407471
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8366458415985107
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7722723484039307
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.7601058483123779
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.835254430770874
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7103590965270996
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6916627883911133
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 0.7163341045379639
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 0.7041025161743164
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8256118297576904
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.8866713047027588
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.7056488990783691
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.7495002746582031
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.9965686798095703
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.8291327953338623
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.8919510841369629
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.7327663898468018
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.8392343521118164
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 383884
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df256_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5953822135925293
Epoch: 1, Steps: 7 | Train Loss: 2.632 Vali Loss: 2.353 Vali Acc: 0.083 Test Loss: 2.353 Test Acc: 0.083
Validation loss decreased (inf --> -0.083310).  Saving model ...
Epoch: 2 cost time: 0.8125829696655273
Epoch: 2, Steps: 7 | Train Loss: 2.082 Vali Loss: 1.679 Vali Acc: 0.611 Test Loss: 1.679 Test Acc: 0.611
Validation loss decreased (-0.083310 --> -0.611094).  Saving model ...
Epoch: 3 cost time: 0.7749419212341309
Epoch: 3, Steps: 7 | Train Loss: 1.258 Vali Loss: 1.028 Vali Acc: 0.861 Test Loss: 1.028 Test Acc: 0.861
Validation loss decreased (-0.611094 --> -0.861101).  Saving model ...
Epoch: 4 cost time: 0.85019850730896
Epoch: 4, Steps: 7 | Train Loss: 0.575 Vali Loss: 0.649 Vali Acc: 0.903 Test Loss: 0.649 Test Acc: 0.903
Validation loss decreased (-0.861101 --> -0.902771).  Saving model ...
Epoch: 5 cost time: 0.7601616382598877
Epoch: 5, Steps: 7 | Train Loss: 0.225 Vali Loss: 0.466 Vali Acc: 0.917 Test Loss: 0.466 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916662).  Saving model ...
Epoch: 6 cost time: 0.8381974697113037
Epoch: 6, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.358 Vali Acc: 0.931 Test Loss: 0.358 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 7 cost time: 0.8758647441864014
Epoch: 7, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.365 Vali Acc: 0.903 Test Loss: 0.365 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8604495525360107
Epoch: 8, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7288446426391602
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.347 Vali Acc: 0.861 Test Loss: 0.347 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9117391109466553
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8384854793548584
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8696060180664062
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.6978063583374023
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7893695831298828
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8117942810058594
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.7795102596282959
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8833580017089844
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7539331912994385
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8855748176574707
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7922806739807129
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6886601448059082
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6934728622436523
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6653578281402588
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7470192909240723
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7208437919616699
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df256_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 323212
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7182767391204834
Epoch: 1, Steps: 7 | Train Loss: 2.501 Vali Loss: 2.329 Vali Acc: 0.264 Test Loss: 2.329 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 0.802013635635376
Epoch: 2, Steps: 7 | Train Loss: 2.109 Vali Loss: 1.827 Vali Acc: 0.611 Test Loss: 1.827 Test Acc: 0.611
Validation loss decreased (-0.263866 --> -0.611093).  Saving model ...
Epoch: 3 cost time: 0.7825512886047363
Epoch: 3, Steps: 7 | Train Loss: 1.474 Vali Loss: 1.274 Vali Acc: 0.778 Test Loss: 1.274 Test Acc: 0.778
Validation loss decreased (-0.611093 --> -0.777765).  Saving model ...
Epoch: 4 cost time: 0.7795171737670898
Epoch: 4, Steps: 7 | Train Loss: 0.849 Vali Loss: 0.813 Vali Acc: 0.875 Test Loss: 0.813 Test Acc: 0.875
Validation loss decreased (-0.777765 --> -0.874992).  Saving model ...
Epoch: 5 cost time: 0.7306513786315918
Epoch: 5, Steps: 7 | Train Loss: 0.429 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 0.6836774349212646
Epoch: 6, Steps: 7 | Train Loss: 0.192 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8087632656097412
Epoch: 7, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7383301258087158
Epoch: 8, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.7995502948760986
Epoch: 9, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7416749000549316
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.709681510925293
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7587487697601318
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7648131847381592
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7633411884307861
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8530054092407227
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.833669900894165
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.6949658393859863
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.7630724906921387
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.817176342010498
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.703594446182251
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8235447406768799
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7700624465942383
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6994686126708984
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6867208480834961
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.7538025379180908
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.6992170810699463
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7613143920898438
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.889 Test Loss: 0.238 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8348121643066406
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.6740913391113281
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.7268979549407959
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6820905208587646
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7835347652435303
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6713254451751709
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7630360126495361
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7449047565460205
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.774693489074707
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.8065366744995117
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.6375713348388672
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6906695365905762
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.6680009365081787
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.7451434135437012
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.6187009811401367
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.7508330345153809
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6854016780853271
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6875889301300049
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6787538528442383
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.6240627765655518
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.7434983253479004
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.865126371383667
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8697905540466309
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.7248377799987793
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7217724323272705
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.7415482997894287
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.7347424030303955
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.7496762275695801
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.6767642498016357
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.7516942024230957
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.6674437522888184
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 275596
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df256_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3990373611450195
Epoch: 1, Steps: 7 | Train Loss: 2.586 Vali Loss: 2.560 Vali Acc: 0.111 Test Loss: 2.560 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.6215798854827881
Epoch: 2, Steps: 7 | Train Loss: 2.197 Vali Loss: 2.091 Vali Acc: 0.417 Test Loss: 2.091 Test Acc: 0.417
Validation loss decreased (-0.111086 --> -0.416646).  Saving model ...
Epoch: 3 cost time: 0.640573263168335
Epoch: 3, Steps: 7 | Train Loss: 1.675 Vali Loss: 1.553 Vali Acc: 0.597 Test Loss: 1.553 Test Acc: 0.597
Validation loss decreased (-0.416646 --> -0.597207).  Saving model ...
Epoch: 4 cost time: 0.6075141429901123
Epoch: 4, Steps: 7 | Train Loss: 1.103 Vali Loss: 1.102 Vali Acc: 0.722 Test Loss: 1.102 Test Acc: 0.722
Validation loss decreased (-0.597207 --> -0.722211).  Saving model ...
Epoch: 5 cost time: 0.6300613880157471
Epoch: 5, Steps: 7 | Train Loss: 0.629 Vali Loss: 0.772 Vali Acc: 0.764 Test Loss: 0.772 Test Acc: 0.764
Validation loss decreased (-0.722211 --> -0.763881).  Saving model ...
Epoch: 6 cost time: 0.5383005142211914
Epoch: 6, Steps: 7 | Train Loss: 0.319 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
Validation loss decreased (-0.763881 --> -0.861105).  Saving model ...
Epoch: 7 cost time: 0.6283419132232666
Epoch: 7, Steps: 7 | Train Loss: 0.167 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6329317092895508
Epoch: 8, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.429 Vali Acc: 0.847 Test Loss: 0.429 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7370574474334717
Epoch: 9, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.368 Vali Acc: 0.889 Test Loss: 0.368 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.7320442199707031
Epoch: 10, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.6376175880432129
Epoch: 11, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.6367666721343994
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5801780223846436
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5869643688201904
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6466681957244873
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5707559585571289
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5857269763946533
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6933600902557373
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6096389293670654
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6029677391052246
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5132138729095459
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df256_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 246412
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1069507598876953
Epoch: 1, Steps: 7 | Train Loss: 2.525 Vali Loss: 2.380 Vali Acc: 0.083 Test Loss: 2.380 Test Acc: 0.083
Validation loss decreased (inf --> -0.083310).  Saving model ...
Epoch: 2 cost time: 0.6333088874816895
Epoch: 2, Steps: 7 | Train Loss: 2.260 Vali Loss: 2.039 Vali Acc: 0.389 Test Loss: 2.039 Test Acc: 0.389
Validation loss decreased (-0.083310 --> -0.388868).  Saving model ...
Epoch: 3 cost time: 0.6048221588134766
Epoch: 3, Steps: 7 | Train Loss: 1.765 Vali Loss: 1.610 Vali Acc: 0.639 Test Loss: 1.610 Test Acc: 0.639
Validation loss decreased (-0.388868 --> -0.638873).  Saving model ...
Epoch: 4 cost time: 0.6974904537200928
Epoch: 4, Steps: 7 | Train Loss: 1.236 Vali Loss: 1.192 Vali Acc: 0.750 Test Loss: 1.192 Test Acc: 0.750
Validation loss decreased (-0.638873 --> -0.749988).  Saving model ...
Epoch: 5 cost time: 0.7045001983642578
Epoch: 5, Steps: 7 | Train Loss: 0.795 Vali Loss: 0.891 Vali Acc: 0.778 Test Loss: 0.891 Test Acc: 0.778
Validation loss decreased (-0.749988 --> -0.777769).  Saving model ...
Epoch: 6 cost time: 0.6814632415771484
Epoch: 6, Steps: 7 | Train Loss: 0.473 Vali Loss: 0.690 Vali Acc: 0.833 Test Loss: 0.690 Test Acc: 0.833
Validation loss decreased (-0.777769 --> -0.833326).  Saving model ...
Epoch: 7 cost time: 0.6458151340484619
Epoch: 7, Steps: 7 | Train Loss: 0.268 Vali Loss: 0.559 Vali Acc: 0.847 Test Loss: 0.559 Test Acc: 0.847
Validation loss decreased (-0.833326 --> -0.847217).  Saving model ...
Epoch: 8 cost time: 0.5678536891937256
Epoch: 8, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.592350959777832
Epoch: 9, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.410 Vali Acc: 0.889 Test Loss: 0.410 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.5915451049804688
Epoch: 10, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6767375469207764
Epoch: 11, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6410088539123535
Epoch: 12, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 0.5848093032836914
Epoch: 13, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.5941457748413086
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.335 Vali Acc: 0.861 Test Loss: 0.335 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.718778133392334
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6727049350738525
Epoch: 16, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6972694396972656
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6657893657684326
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6526107788085938
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6136729717254639
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.5715944766998291
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.6038517951965332
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.6251249313354492
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7222537994384766
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.5857295989990234
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.6462619304656982
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.8451793193817139
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6568148136138916
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6782913208007812
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.6214821338653564
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.6546962261199951
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5436160564422607
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5791935920715332
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5771389007568359
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.6231694221496582
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.5970008373260498
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.6145985126495361
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5447068214416504
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.6593430042266846
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.6453061103820801
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7396590709686279
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.6585540771484375
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.6655547618865967
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6700046062469482
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6772739887237549
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6301479339599609
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6762537956237793
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6803877353668213
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5436451435089111
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6122815608978271
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.6146702766418457
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.6462905406951904
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.802734375
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6533629894256592
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.6867001056671143
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.6103298664093018
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7418220043182373
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6721413135528564
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.6591050624847412
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.6369049549102783
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.7137858867645264
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.7138745784759521
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.6009609699249268
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 64 cost time: 0.5922048091888428
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 65 cost time: 0.6545157432556152
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 66 cost time: 0.5944137573242188
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6312735080718994
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6461970806121826
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.7080056667327881
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 70 cost time: 0.6764304637908936
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.5993971824645996
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.5838527679443359
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.6669104099273682
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.608647346496582
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.6596295833587646
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.7432231903076172
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.6323237419128418
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.7534346580505371
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.6914236545562744
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 235660
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7647128105163574
Epoch: 1, Steps: 7 | Train Loss: 2.577 Vali Loss: 2.083 Vali Acc: 0.347 Test Loss: 2.083 Test Acc: 0.347
Validation loss decreased (inf --> -0.347201).  Saving model ...
Epoch: 2 cost time: 0.8371255397796631
Epoch: 2, Steps: 7 | Train Loss: 1.261 Vali Loss: 0.773 Vali Acc: 0.861 Test Loss: 0.773 Test Acc: 0.861
Validation loss decreased (-0.347201 --> -0.861103).  Saving model ...
Epoch: 3 cost time: 0.8572993278503418
Epoch: 3, Steps: 7 | Train Loss: 0.227 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
Validation loss decreased (-0.861103 --> -0.888885).  Saving model ...
Epoch: 4 cost time: 0.8152480125427246
Epoch: 4, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 5 cost time: 0.8334081172943115
Epoch: 5, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8644404411315918
Epoch: 6, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 0.808950662612915
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.393 Vali Acc: 0.903 Test Loss: 0.393 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8535788059234619
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.661 Vali Acc: 0.861 Test Loss: 0.661 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8831384181976318
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.889 Test Loss: 0.538 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8334441184997559
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8458654880523682
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.393 Vali Acc: 0.889 Test Loss: 0.393 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9897611141204834
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.839231014251709
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.827322244644165
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8016173839569092
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.7576191425323486
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.7944707870483398
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.8214864730834961
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.8086395263671875
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.8430111408233643
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.7206497192382812
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.8515214920043945
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.8468024730682373
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.8502860069274902
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.8105864524841309
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.815485954284668
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.7893414497375488
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.8270020484924316
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.843341588973999
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.842320442199707
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.7770028114318848
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.7976715564727783
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.8595821857452393
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.7565944194793701
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.8183143138885498
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.866222620010376
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.82912278175354
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.8207881450653076
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.8639776706695557
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.8712813854217529
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.7865309715270996
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.9486660957336426
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.962106466293335
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.8674874305725098
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.8152749538421631
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.876955509185791
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.8442440032958984
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.8910760879516602
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.9906787872314453
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.9449820518493652
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 0.9425420761108398
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 0.8352508544921875
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 0.8304252624511719
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 1.0211315155029297
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.8686070442199707
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 0.8415381908416748
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 0.9002821445465088
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.796269416809082
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 0.9109790325164795
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 0.850428581237793
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8956050872802734
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.906487226486206
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.8520944118499756
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 64 cost time: 0.9328033924102783
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.834766149520874
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.8653919696807861
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.8775928020477295
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 68 cost time: 0.8629982471466064
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 69 cost time: 0.9243392944335938
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 70 cost time: 1.0481529235839844
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 71 cost time: 0.9622471332550049
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 72 cost time: 0.812889575958252
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.9177346229553223
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.7479588985443115
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 75 cost time: 0.9279522895812988
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8398094177246094
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 77 cost time: 0.909792423248291
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 78 cost time: 0.9780850410461426
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.8830277919769287
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 80 cost time: 0.9261724948883057
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 81 cost time: 0.8440365791320801
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 82 cost time: 0.8834846019744873
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 83 cost time: 0.9330451488494873
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 84 cost time: 1.0103552341461182
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.8930361270904541
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.030353307723999
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.8203532695770264
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.9670979976654053
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 0.900376558303833
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 0.8231534957885742
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 91 cost time: 0.9644989967346191
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.8341662883758545
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.9769461154937744
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.92197585105896
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.8891053199768066
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.9644412994384766
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 0.8671255111694336
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.8470513820648193
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 0.8372950553894043
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 100 cost time: 0.8938479423522949
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 831756
model size : 5.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4768431186676025
Epoch: 1, Steps: 7 | Train Loss: 2.746 Vali Loss: 2.378 Vali Acc: 0.083 Test Loss: 2.378 Test Acc: 0.083
Validation loss decreased (inf --> -0.083310).  Saving model ...
Epoch: 2 cost time: 0.757500171661377
Epoch: 2, Steps: 7 | Train Loss: 1.823 Vali Loss: 1.274 Vali Acc: 0.792 Test Loss: 1.274 Test Acc: 0.792
Validation loss decreased (-0.083310 --> -0.791654).  Saving model ...
Epoch: 3 cost time: 0.8677797317504883
Epoch: 3, Steps: 7 | Train Loss: 0.678 Vali Loss: 0.630 Vali Acc: 0.861 Test Loss: 0.630 Test Acc: 0.861
Validation loss decreased (-0.791654 --> -0.861105).  Saving model ...
Epoch: 4 cost time: 0.8064181804656982
Epoch: 4, Steps: 7 | Train Loss: 0.185 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874996).  Saving model ...
Epoch: 5 cost time: 0.8045682907104492
Epoch: 5, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.505 Vali Acc: 0.889 Test Loss: 0.505 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 0.7811813354492188
Epoch: 6, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.8751828670501709
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.7808551788330078
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.8567395210266113
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.7897148132324219
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7483053207397461
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7488794326782227
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7223970890045166
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7869381904602051
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7351791858673096
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.773754358291626
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7285423278808594
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7801871299743652
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7413017749786377
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 466956
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3346920013427734
Epoch: 1, Steps: 7 | Train Loss: 2.574 Vali Loss: 2.275 Vali Acc: 0.236 Test Loss: 2.275 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 0.8430600166320801
Epoch: 2, Steps: 7 | Train Loss: 1.962 Vali Loss: 1.552 Vali Acc: 0.583 Test Loss: 1.552 Test Acc: 0.583
Validation loss decreased (-0.236088 --> -0.583318).  Saving model ...
Epoch: 3 cost time: 0.776353120803833
Epoch: 3, Steps: 7 | Train Loss: 1.033 Vali Loss: 0.809 Vali Acc: 0.833 Test Loss: 0.809 Test Acc: 0.833
Validation loss decreased (-0.583318 --> -0.833325).  Saving model ...
Epoch: 4 cost time: 0.8511672019958496
Epoch: 4, Steps: 7 | Train Loss: 0.375 Vali Loss: 0.507 Vali Acc: 0.875 Test Loss: 0.507 Test Acc: 0.875
Validation loss decreased (-0.833325 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 0.7681350708007812
Epoch: 5, Steps: 7 | Train Loss: 0.152 Vali Loss: 0.389 Vali Acc: 0.861 Test Loss: 0.389 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8412389755249023
Epoch: 6, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.383 Vali Acc: 0.889 Test Loss: 0.383 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.7510676383972168
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 0.8375339508056641
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.8534386157989502
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.7870450019836426
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.8493304252624512
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.8571360111236572
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8302719593048096
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9595909118652344
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9341444969177246
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.963050365447998
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8278062343597412
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9690258502960205
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8600389957427979
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.871739387512207
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8312287330627441
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 350988
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df128_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.319951295852661
Epoch: 1, Steps: 7 | Train Loss: 2.746 Vali Loss: 2.443 Vali Acc: 0.167 Test Loss: 2.443 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 0.9149162769317627
Epoch: 2, Steps: 7 | Train Loss: 2.209 Vali Loss: 1.781 Vali Acc: 0.625 Test Loss: 1.781 Test Acc: 0.625
Validation loss decreased (-0.166642 --> -0.624982).  Saving model ...
Epoch: 3 cost time: 0.7685260772705078
Epoch: 3, Steps: 7 | Train Loss: 1.424 Vali Loss: 1.111 Vali Acc: 0.722 Test Loss: 1.111 Test Acc: 0.722
Validation loss decreased (-0.624982 --> -0.722211).  Saving model ...
Epoch: 4 cost time: 0.7746784687042236
Epoch: 4, Steps: 7 | Train Loss: 0.657 Vali Loss: 0.720 Vali Acc: 0.847 Test Loss: 0.720 Test Acc: 0.847
Validation loss decreased (-0.722211 --> -0.847215).  Saving model ...
Epoch: 5 cost time: 0.9588391780853271
Epoch: 5, Steps: 7 | Train Loss: 0.264 Vali Loss: 0.483 Vali Acc: 0.861 Test Loss: 0.483 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 0.8355205059051514
Epoch: 6, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 1.0180680751800537
Epoch: 7, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.8925971984863281
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9693770408630371
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9401931762695312
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8494465351104736
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.8063523769378662
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.8378503322601318
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9256494045257568
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.7598118782043457
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.8388910293579102
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8469488620758057
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9204988479614258
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7854149341583252
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7084977626800537
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.720172643661499
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.7192385196685791
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.7565581798553467
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.913109302520752
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.9242572784423828
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8789019584655762
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9025201797485352
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.7989118099212646
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8575186729431152
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8206555843353271
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.9308407306671143
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9232146739959717
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8486981391906738
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0870709419250488
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 1.055384635925293
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.8916451930999756
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.8121201992034912
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.8663499355316162
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.8998565673828125
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8892972469329834
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8164832592010498
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8999600410461426
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.8944194316864014
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.9426584243774414
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.7933456897735596
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8682765960693359
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.813939094543457
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8611736297607422
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7621784210205078
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.9069597721099854
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8513801097869873
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7342057228088379
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8158154487609863
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.7953648567199707
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.8485867977142334
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.848778486251831
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 57 cost time: 0.8060159683227539
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 0.7972097396850586
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8283700942993164
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 60 cost time: 0.8363254070281982
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9328696727752686
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9439194202423096
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.8700911998748779
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.8237996101379395
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.8011641502380371
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.824115514755249
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.8329432010650635
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.8775808811187744
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.8857131004333496
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 70 cost time: 0.8290448188781738
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 71 cost time: 0.9114289283752441
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 72 cost time: 0.8486418724060059
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.9442424774169922
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.9577019214630127
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.6970083713531494
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.9738316535949707
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.9091372489929199
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.865349531173706
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.7929353713989258
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.9310445785522461
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.9259746074676514
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 82 cost time: 0.8700213432312012
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.9284932613372803
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 84 cost time: 0.75956130027771
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 85 cost time: 0.9713113307952881
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 86 cost time: 0.802215576171875
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 87 cost time: 0.9404778480529785
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 88 cost time: 0.8407742977142334
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 89 cost time: 0.8126814365386963
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 90 cost time: 0.9504764080047607
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 91 cost time: 0.8845536708831787
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.9327702522277832
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.9615330696105957
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.92598557472229
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.9375576972961426
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.9746463298797607
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 0.9061470031738281
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.905388355255127
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 0.9912919998168945
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 0.9915211200714111
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df128_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 290316
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4251248836517334
Epoch: 1, Steps: 7 | Train Loss: 2.580 Vali Loss: 2.437 Vali Acc: 0.153 Test Loss: 2.437 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.7547969818115234
Epoch: 2, Steps: 7 | Train Loss: 2.149 Vali Loss: 1.931 Vali Acc: 0.389 Test Loss: 1.931 Test Acc: 0.389
Validation loss decreased (-0.152753 --> -0.388870).  Saving model ...
Epoch: 3 cost time: 0.741318941116333
Epoch: 3, Steps: 7 | Train Loss: 1.507 Vali Loss: 1.367 Vali Acc: 0.667 Test Loss: 1.367 Test Acc: 0.667
Validation loss decreased (-0.388870 --> -0.666653).  Saving model ...
Epoch: 4 cost time: 0.7674558162689209
Epoch: 4, Steps: 7 | Train Loss: 0.887 Vali Loss: 0.890 Vali Acc: 0.819 Test Loss: 0.890 Test Acc: 0.819
Validation loss decreased (-0.666653 --> -0.819436).  Saving model ...
Epoch: 5 cost time: 0.7237155437469482
Epoch: 5, Steps: 7 | Train Loss: 0.444 Vali Loss: 0.571 Vali Acc: 0.861 Test Loss: 0.571 Test Acc: 0.861
Validation loss decreased (-0.819436 --> -0.861105).  Saving model ...
Epoch: 6 cost time: 0.7722392082214355
Epoch: 6, Steps: 7 | Train Loss: 0.195 Vali Loss: 0.447 Vali Acc: 0.861 Test Loss: 0.447 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.7522156238555908
Epoch: 7, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.8450131416320801
Epoch: 8, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.7654578685760498
Epoch: 9, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.8423349857330322
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8165996074676514
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.8116195201873779
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.8737807273864746
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.8072323799133301
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.8857760429382324
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8280866146087646
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.8148200511932373
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.8435585498809814
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.8516156673431396
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.9302623271942139
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.8248128890991211
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.8265907764434814
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.7498736381530762
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.7746443748474121
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8386642932891846
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.7605443000793457
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.8107824325561523
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.8253114223480225
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.7851717472076416
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.7848947048187256
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.7598373889923096
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.7748904228210449
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.7588672637939453
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8394472599029541
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.7338073253631592
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.865941047668457
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8574867248535156
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9465682506561279
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7355709075927734
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8024106025695801
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8162853717803955
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9446356296539307
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9314785003662109
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.7161471843719482
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7871429920196533
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 46 cost time: 0.7855491638183594
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 47 cost time: 0.8755488395690918
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 48 cost time: 0.715857744216919
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8161001205444336
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.721440315246582
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7352101802825928
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.7233867645263672
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 53 cost time: 0.7274222373962402
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 54 cost time: 0.7035424709320068
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 55 cost time: 0.7449195384979248
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 56 cost time: 0.7632801532745361
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 57 cost time: 0.7092392444610596
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7307541370391846
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 59 cost time: 0.8189740180969238
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 60 cost time: 0.7256083488464355
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7315144538879395
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.6870894432067871
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.7381808757781982
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.7645735740661621
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.7601151466369629
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.8729372024536133
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 67 cost time: 0.7827308177947998
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 68 cost time: 0.7672970294952393
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 69 cost time: 0.7697579860687256
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 70 cost time: 0.8585617542266846
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8163759708404541
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.8638491630554199
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.809417724609375
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.8331277370452881
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.7574832439422607
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.8474547863006592
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 77 cost time: 0.7222981452941895
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.81123948097229
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.8408312797546387
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.784273624420166
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.9185729026794434
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.8146355152130127
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 0.7862856388092041
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 0.9571962356567383
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 0.8685197830200195
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 86 cost time: 0.8837697505950928
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 87 cost time: 0.7998127937316895
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 88 cost time: 0.841200590133667
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.8302416801452637
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 90 cost time: 0.75042724609375
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 91 cost time: 0.803466796875
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.8441035747528076
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.8231754302978516
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.8266928195953369
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.7870383262634277
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.8603923320770264
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 97 cost time: 0.7935364246368408
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.8587157726287842
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 99 cost time: 0.875274658203125
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 100 cost time: 0.9217064380645752
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 242700
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df128_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3346452713012695
Epoch: 1, Steps: 7 | Train Loss: 2.607 Vali Loss: 2.623 Vali Acc: 0.042 Test Loss: 2.623 Test Acc: 0.042
Validation loss decreased (inf --> -0.041640).  Saving model ...
Epoch: 2 cost time: 0.6125907897949219
Epoch: 2, Steps: 7 | Train Loss: 2.399 Vali Loss: 2.170 Vali Acc: 0.319 Test Loss: 2.170 Test Acc: 0.319
Validation loss decreased (-0.041640 --> -0.319423).  Saving model ...
Epoch: 3 cost time: 0.6562886238098145
Epoch: 3, Steps: 7 | Train Loss: 1.768 Vali Loss: 1.652 Vali Acc: 0.667 Test Loss: 1.652 Test Acc: 0.667
Validation loss decreased (-0.319423 --> -0.666650).  Saving model ...
Epoch: 4 cost time: 0.689277172088623
Epoch: 4, Steps: 7 | Train Loss: 1.172 Vali Loss: 1.191 Vali Acc: 0.750 Test Loss: 1.191 Test Acc: 0.750
Validation loss decreased (-0.666650 --> -0.749988).  Saving model ...
Epoch: 5 cost time: 0.5701990127563477
Epoch: 5, Steps: 7 | Train Loss: 0.691 Vali Loss: 0.834 Vali Acc: 0.819 Test Loss: 0.834 Test Acc: 0.819
Validation loss decreased (-0.749988 --> -0.819436).  Saving model ...
Epoch: 6 cost time: 0.6835181713104248
Epoch: 6, Steps: 7 | Train Loss: 0.364 Vali Loss: 0.617 Vali Acc: 0.833 Test Loss: 0.617 Test Acc: 0.833
Validation loss decreased (-0.819436 --> -0.833327).  Saving model ...
Epoch: 7 cost time: 0.6676106452941895
Epoch: 7, Steps: 7 | Train Loss: 0.204 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
Validation loss decreased (-0.833327 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 0.5728473663330078
Epoch: 8, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.423 Vali Acc: 0.889 Test Loss: 0.423 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.6415534019470215
Epoch: 9, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.385 Vali Acc: 0.889 Test Loss: 0.385 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.7116780281066895
Epoch: 10, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 0.6882591247558594
Epoch: 11, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 0.5780844688415527
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7250857353210449
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 14 cost time: 0.6362829208374023
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6979236602783203
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6825201511383057
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.555795431137085
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5932064056396484
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6309149265289307
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6908371448516846
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6190919876098633
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6617765426635742
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.6731088161468506
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7537639141082764
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.7079102993011475
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.6467947959899902
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.691110372543335
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6235742568969727
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7028846740722656
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7346653938293457
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7067110538482666
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6622836589813232
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6352112293243408
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6972534656524658
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6801319122314453
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df128_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 213516
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.327299118041992
Epoch: 1, Steps: 7 | Train Loss: 2.677 Vali Loss: 2.549 Vali Acc: 0.181 Test Loss: 2.549 Test Acc: 0.181
Validation loss decreased (inf --> -0.180530).  Saving model ...
Epoch: 2 cost time: 0.6991984844207764
Epoch: 2, Steps: 7 | Train Loss: 2.361 Vali Loss: 2.184 Vali Acc: 0.292 Test Loss: 2.184 Test Acc: 0.292
Validation loss decreased (-0.180530 --> -0.291645).  Saving model ...
Epoch: 3 cost time: 0.6543426513671875
Epoch: 3, Steps: 7 | Train Loss: 1.822 Vali Loss: 1.714 Vali Acc: 0.639 Test Loss: 1.714 Test Acc: 0.639
Validation loss decreased (-0.291645 --> -0.638872).  Saving model ...
Epoch: 4 cost time: 0.754000186920166
Epoch: 4, Steps: 7 | Train Loss: 1.310 Vali Loss: 1.261 Vali Acc: 0.750 Test Loss: 1.261 Test Acc: 0.750
Validation loss decreased (-0.638872 --> -0.749987).  Saving model ...
Epoch: 5 cost time: 0.6348228454589844
Epoch: 5, Steps: 7 | Train Loss: 0.897 Vali Loss: 0.911 Vali Acc: 0.847 Test Loss: 0.911 Test Acc: 0.847
Validation loss decreased (-0.749987 --> -0.847213).  Saving model ...
Epoch: 6 cost time: 0.6754794120788574
Epoch: 6, Steps: 7 | Train Loss: 0.507 Vali Loss: 0.674 Vali Acc: 0.861 Test Loss: 0.674 Test Acc: 0.861
Validation loss decreased (-0.847213 --> -0.861104).  Saving model ...
Epoch: 7 cost time: 0.6576085090637207
Epoch: 7, Steps: 7 | Train Loss: 0.314 Vali Loss: 0.531 Vali Acc: 0.875 Test Loss: 0.531 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 0.689037561416626
Epoch: 8, Steps: 7 | Train Loss: 0.156 Vali Loss: 0.462 Vali Acc: 0.861 Test Loss: 0.462 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.705010175704956
Epoch: 9, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 0.640770435333252
Epoch: 10, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 0.6459870338439941
Epoch: 11, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 12 cost time: 0.6931576728820801
Epoch: 12, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.360 Vali Acc: 0.861 Test Loss: 0.360 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.618828535079956
Epoch: 13, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.351 Vali Acc: 0.861 Test Loss: 0.351 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6920688152313232
Epoch: 14, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 15 cost time: 0.6371011734008789
Epoch: 15, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 16 cost time: 0.6269941329956055
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 17 cost time: 0.6298763751983643
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 18 cost time: 0.7043168544769287
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 19 cost time: 0.7294168472290039
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.323 Vali Acc: 0.875 Test Loss: 0.323 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 20 cost time: 0.7199158668518066
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 21 cost time: 0.6789350509643555
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 22 cost time: 0.6974484920501709
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.6728439331054688
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.6074202060699463
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6567611694335938
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.6147825717926025
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6688618659973145
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.5808894634246826
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.6488256454467773
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.7259483337402344
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 0.668046236038208
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 0.6028196811676025
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6071891784667969
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6355259418487549
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7096638679504395
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.710968017578125
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7940959930419922
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6234948635101318
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.649404764175415
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8073925971984863
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6522362232208252
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 202764
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7322843074798584
Epoch: 1, Steps: 7 | Train Loss: 2.531 Vali Loss: 2.067 Vali Acc: 0.458 Test Loss: 2.067 Test Acc: 0.458
Validation loss decreased (inf --> -0.458313).  Saving model ...
Epoch: 2 cost time: 1.0527522563934326
Epoch: 2, Steps: 7 | Train Loss: 1.370 Vali Loss: 0.773 Vali Acc: 0.847 Test Loss: 0.773 Test Acc: 0.847
Validation loss decreased (-0.458313 --> -0.847214).  Saving model ...
Epoch: 3 cost time: 0.9217407703399658
Epoch: 3, Steps: 7 | Train Loss: 0.250 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
Validation loss decreased (-0.847214 --> -0.888885).  Saving model ...
Epoch: 4 cost time: 1.0751898288726807
Epoch: 4, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.355 Vali Acc: 0.917 Test Loss: 0.355 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 1.0504202842712402
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9396264553070068
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.484 Vali Acc: 0.833 Test Loss: 0.484 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0645289421081543
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.404 Vali Acc: 0.861 Test Loss: 0.404 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9935178756713867
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9850983619689941
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.9415078163146973
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.016242265701294
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.9524040222167969
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.9640278816223145
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.9950041770935059
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.0534381866455078
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.969412088394165
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.9833948612213135
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.9577503204345703
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.9139404296875
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.0278682708740234
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.8716483116149902
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0359759330749512
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9402027130126953
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9963045120239258
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.9779736995697021
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.0458800792694092
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9760777950286865
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0489578247070312
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0073797702789307
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.9629645347595215
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.06695556640625
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 1.142519235610962
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.9220449924468994
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1250452995300293
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9321227073669434
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.9994802474975586
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.9293181896209717
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 1.008321762084961
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 1.0153651237487793
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.9566178321838379
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.044459581375122
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1029565334320068
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0494277477264404
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.9763288497924805
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1174700260162354
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.9928848743438721
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.884035587310791
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.065312147140503
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9826068878173828
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.856046199798584
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.0376107692718506
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 0.8307371139526367
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 53 cost time: 1.0089938640594482
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 54 cost time: 0.8944382667541504
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 55 cost time: 0.9332866668701172
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.035233497619629
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.9300825595855713
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.926626443862915
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.9170176982879639
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 60 cost time: 0.9861547946929932
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 61 cost time: 0.8815746307373047
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 62 cost time: 0.9833035469055176
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.9500868320465088
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.0488922595977783
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.9910175800323486
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.997053861618042
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.9542016983032227
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.0048620700836182
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.9566555023193359
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 1.0189707279205322
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.8563416004180908
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 815308
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8473126888275146
Epoch: 1, Steps: 7 | Train Loss: 2.581 Vali Loss: 2.185 Vali Acc: 0.264 Test Loss: 2.185 Test Acc: 0.264
Validation loss decreased (inf --> -0.263867).  Saving model ...
Epoch: 2 cost time: 0.8380639553070068
Epoch: 2, Steps: 7 | Train Loss: 1.713 Vali Loss: 1.203 Vali Acc: 0.750 Test Loss: 1.203 Test Acc: 0.750
Validation loss decreased (-0.263867 --> -0.749988).  Saving model ...
Epoch: 3 cost time: 1.018584966659546
Epoch: 3, Steps: 7 | Train Loss: 0.602 Vali Loss: 0.622 Vali Acc: 0.847 Test Loss: 0.622 Test Acc: 0.847
Validation loss decreased (-0.749988 --> -0.847216).  Saving model ...
Epoch: 4 cost time: 0.9119265079498291
Epoch: 4, Steps: 7 | Train Loss: 0.208 Vali Loss: 0.436 Vali Acc: 0.847 Test Loss: 0.436 Test Acc: 0.847
Validation loss decreased (-0.847216 --> -0.847218).  Saving model ...
Epoch: 5 cost time: 0.8999392986297607
Epoch: 5, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.514 Vali Acc: 0.889 Test Loss: 0.514 Test Acc: 0.889
Validation loss decreased (-0.847218 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 0.9706664085388184
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.9285893440246582
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.9436407089233398
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.8484232425689697
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.9537882804870605
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.9986522197723389
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9484424591064453
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9596490859985352
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9288902282714844
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9014127254486084
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.941159725189209
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8977446556091309
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8322229385375977
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.029900312423706
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.862511157989502
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 450508
model size : 4.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.472397565841675
Epoch: 1, Steps: 7 | Train Loss: 2.591 Vali Loss: 2.289 Vali Acc: 0.208 Test Loss: 2.289 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 0.9742746353149414
Epoch: 2, Steps: 7 | Train Loss: 1.893 Vali Loss: 1.454 Vali Acc: 0.722 Test Loss: 1.454 Test Acc: 0.722
Validation loss decreased (-0.208310 --> -0.722208).  Saving model ...
Epoch: 3 cost time: 0.8456687927246094
Epoch: 3, Steps: 7 | Train Loss: 0.959 Vali Loss: 0.767 Vali Acc: 0.917 Test Loss: 0.767 Test Acc: 0.917
Validation loss decreased (-0.722208 --> -0.916659).  Saving model ...
Epoch: 4 cost time: 0.8756370544433594
Epoch: 4, Steps: 7 | Train Loss: 0.370 Vali Loss: 0.492 Vali Acc: 0.875 Test Loss: 0.492 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.819692850112915
Epoch: 5, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9469344615936279
Epoch: 6, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916659 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 0.9010510444641113
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9488048553466797
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9013080596923828
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0471525192260742
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9838552474975586
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0186073780059814
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.9109983444213867
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.8927688598632812
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.8749172687530518
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.8953366279602051
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.9011027812957764
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.9434490203857422
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.8985681533813477
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0267243385314941
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0699427127838135
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9857239723205566
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0046517848968506
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0078766345977783
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9053962230682373
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0128612518310547
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9320855140686035
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.038792610168457
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 334540
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df64_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6625609397888184
Epoch: 1, Steps: 7 | Train Loss: 2.664 Vali Loss: 2.460 Vali Acc: 0.139 Test Loss: 2.460 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.8047187328338623
Epoch: 2, Steps: 7 | Train Loss: 2.133 Vali Loss: 1.784 Vali Acc: 0.569 Test Loss: 1.784 Test Acc: 0.569
Validation loss decreased (-0.138864 --> -0.569427).  Saving model ...
Epoch: 3 cost time: 0.922584056854248
Epoch: 3, Steps: 7 | Train Loss: 1.304 Vali Loss: 1.106 Vali Acc: 0.750 Test Loss: 1.106 Test Acc: 0.750
Validation loss decreased (-0.569427 --> -0.749989).  Saving model ...
Epoch: 4 cost time: 0.8718216419219971
Epoch: 4, Steps: 7 | Train Loss: 0.619 Vali Loss: 0.664 Vali Acc: 0.875 Test Loss: 0.664 Test Acc: 0.875
Validation loss decreased (-0.749989 --> -0.874993).  Saving model ...
Epoch: 5 cost time: 0.9351906776428223
Epoch: 5, Steps: 7 | Train Loss: 0.245 Vali Loss: 0.441 Vali Acc: 0.903 Test Loss: 0.441 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902773).  Saving model ...
Epoch: 6 cost time: 1.051800012588501
Epoch: 6, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.9208052158355713
Epoch: 7, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.9452359676361084
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.8657128810882568
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.8081037998199463
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.8200905323028564
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.7570474147796631
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.8619472980499268
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.7579607963562012
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.7714483737945557
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.7857024669647217
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.8649396896362305
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.8821980953216553
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8406898975372314
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8357763290405273
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.8434169292449951
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.7153263092041016
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.9124510288238525
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.93576979637146
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.7856507301330566
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8778243064880371
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0091166496276855
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9211785793304443
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8541364669799805
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8204195499420166
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6416275501251221
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.7492678165435791
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.8119795322418213
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7671875953674316
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.7986757755279541
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8155519962310791
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.791295051574707
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8475508689880371
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.797123908996582
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.8998773097991943
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8791310787200928
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8434069156646729
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9081273078918457
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.7527742385864258
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.8689465522766113
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.9000887870788574
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.8181631565093994
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8874280452728271
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7780458927154541
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.8898043632507324
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 0.83402419090271
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 0.9233927726745605
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8262226581573486
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.8369102478027344
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 0.9410123825073242
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 0.7812082767486572
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8992550373077393
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 0.6931698322296143
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 0.6846587657928467
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7714753150939941
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.7635807991027832
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.8772866725921631
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.7472970485687256
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.7891454696655273
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.8488702774047852
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.8604311943054199
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 67 cost time: 0.8980653285980225
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 68 cost time: 0.8659195899963379
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 69 cost time: 0.800194501876831
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 70 cost time: 0.8396942615509033
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7574887275695801
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.8501076698303223
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.8388309478759766
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.8285486698150635
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 75 cost time: 0.8000164031982422
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8822391033172607
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.7530663013458252
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.790367603302002
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.023782730102539
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.8830420970916748
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.8427324295043945
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 82 cost time: 0.8612830638885498
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 83 cost time: 0.8165521621704102
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.8392016887664795
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 85 cost time: 0.7003192901611328
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.8064022064208984
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.8652360439300537
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.7121953964233398
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.6710946559906006
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 0.7260870933532715
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 0.6493194103240967
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 0.839489221572876
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 0.8346142768859863
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 0.7607731819152832
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df64_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 273868
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5021493434906006
Epoch: 1, Steps: 7 | Train Loss: 2.471 Vali Loss: 2.337 Vali Acc: 0.167 Test Loss: 2.337 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.8169353008270264
Epoch: 2, Steps: 7 | Train Loss: 2.051 Vali Loss: 1.836 Vali Acc: 0.597 Test Loss: 1.836 Test Acc: 0.597
Validation loss decreased (-0.166643 --> -0.597204).  Saving model ...
Epoch: 3 cost time: 0.8957457542419434
Epoch: 3, Steps: 7 | Train Loss: 1.457 Vali Loss: 1.288 Vali Acc: 0.764 Test Loss: 1.288 Test Acc: 0.764
Validation loss decreased (-0.597204 --> -0.763876).  Saving model ...
Epoch: 4 cost time: 0.7570428848266602
Epoch: 4, Steps: 7 | Train Loss: 0.812 Vali Loss: 0.879 Vali Acc: 0.778 Test Loss: 0.879 Test Acc: 0.778
Validation loss decreased (-0.763876 --> -0.777769).  Saving model ...
Epoch: 5 cost time: 0.9087555408477783
Epoch: 5, Steps: 7 | Train Loss: 0.443 Vali Loss: 0.617 Vali Acc: 0.847 Test Loss: 0.617 Test Acc: 0.847
Validation loss decreased (-0.777769 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 0.8167378902435303
Epoch: 6, Steps: 7 | Train Loss: 0.226 Vali Loss: 0.443 Vali Acc: 0.903 Test Loss: 0.443 Test Acc: 0.903
Validation loss decreased (-0.847216 --> -0.902773).  Saving model ...
Epoch: 7 cost time: 0.761995792388916
Epoch: 7, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.843569278717041
Epoch: 8, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.411 Vali Acc: 0.847 Test Loss: 0.411 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.828671932220459
Epoch: 9, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7635376453399658
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 0.7134425640106201
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.7157399654388428
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.8332624435424805
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.8120384216308594
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7416608333587646
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7639956474304199
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.861351490020752
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.8261294364929199
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7726907730102539
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8194630146026611
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8157355785369873
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8918285369873047
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.857541561126709
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.8299126625061035
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8680374622344971
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7753100395202637
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8896763324737549
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8730766773223877
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.7611379623413086
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.8011195659637451
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.7653727531433105
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.8555388450622559
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0239076614379883
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.8641936779022217
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.8023951053619385
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.7401776313781738
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.78525710105896
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7807066440582275
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.7360291481018066
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.6948812007904053
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.7267634868621826
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7796511650085449
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.8329181671142578
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7762665748596191
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.862616777420044
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9247555732727051
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7883634567260742
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8458552360534668
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8479921817779541
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8515918254852295
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.8895571231842041
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.849233865737915
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.8170909881591797
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.7741086483001709
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 226252
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df64_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3517539501190186
Epoch: 1, Steps: 7 | Train Loss: 2.644 Vali Loss: 2.401 Vali Acc: 0.111 Test Loss: 2.401 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 0.6842632293701172
Epoch: 2, Steps: 7 | Train Loss: 2.261 Vali Loss: 2.006 Vali Acc: 0.472 Test Loss: 2.006 Test Acc: 0.472
Validation loss decreased (-0.111087 --> -0.472202).  Saving model ...
Epoch: 3 cost time: 0.8132433891296387
Epoch: 3, Steps: 7 | Train Loss: 1.740 Vali Loss: 1.500 Vali Acc: 0.653 Test Loss: 1.500 Test Acc: 0.653
Validation loss decreased (-0.472202 --> -0.652763).  Saving model ...
Epoch: 4 cost time: 0.7826292514801025
Epoch: 4, Steps: 7 | Train Loss: 1.113 Vali Loss: 1.069 Vali Acc: 0.778 Test Loss: 1.069 Test Acc: 0.778
Validation loss decreased (-0.652763 --> -0.777767).  Saving model ...
Epoch: 5 cost time: 0.6870269775390625
Epoch: 5, Steps: 7 | Train Loss: 0.673 Vali Loss: 0.768 Vali Acc: 0.847 Test Loss: 0.768 Test Acc: 0.847
Validation loss decreased (-0.777767 --> -0.847215).  Saving model ...
Epoch: 6 cost time: 0.7919712066650391
Epoch: 6, Steps: 7 | Train Loss: 0.367 Vali Loss: 0.577 Vali Acc: 0.847 Test Loss: 0.577 Test Acc: 0.847
Validation loss decreased (-0.847215 --> -0.847216).  Saving model ...
Epoch: 7 cost time: 0.8632972240447998
Epoch: 7, Steps: 7 | Train Loss: 0.187 Vali Loss: 0.476 Vali Acc: 0.861 Test Loss: 0.476 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 0.7048845291137695
Epoch: 8, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.413 Vali Acc: 0.861 Test Loss: 0.413 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 9 cost time: 0.64249587059021
Epoch: 9, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.7454547882080078
Epoch: 10, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.771296501159668
Epoch: 11, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 0.7290873527526855
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 0.7511751651763916
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.7112281322479248
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.6817941665649414
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.7819268703460693
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.7091925144195557
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.8089025020599365
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.756873607635498
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.7215580940246582
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7538089752197266
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.7718753814697266
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.6789462566375732
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7751903533935547
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8588128089904785
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.7206757068634033
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.7293434143066406
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.7184774875640869
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.7863497734069824
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.751962423324585
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.7383887767791748
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.935521125793457
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.7653021812438965
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7541842460632324
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.7277421951293945
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.7588567733764648
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.8532774448394775
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7449827194213867
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.8050997257232666
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.8019092082977295
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.8015859127044678
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.6799650192260742
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8228428363800049
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7558658123016357
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6731927394866943
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7413656711578369
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8071563243865967
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.7212960720062256
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.7362878322601318
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7326078414916992
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.7105209827423096
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7398984432220459
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 0.821042537689209
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.8302741050720215
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.741208553314209
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7634432315826416
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7325222492218018
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.8891267776489258
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.7790257930755615
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.7340559959411621
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 0.7235283851623535
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 62 cost time: 0.753990650177002
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 63 cost time: 0.8847603797912598
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 64 cost time: 0.7972748279571533
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 65 cost time: 0.8435781002044678
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 66 cost time: 0.8312714099884033
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 67 cost time: 0.824634313583374
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 68 cost time: 0.8571653366088867
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 69 cost time: 0.77099609375
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.773047685623169
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.8168578147888184
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.7883694171905518
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.6738460063934326
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 74 cost time: 0.8253099918365479
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 75 cost time: 0.749802827835083
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 76 cost time: 0.8377068042755127
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 77 cost time: 0.79646897315979
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 78 cost time: 0.7827715873718262
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 79 cost time: 0.9186310768127441
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.8247334957122803
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.7801446914672852
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.8706445693969727
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.8468821048736572
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 84 cost time: 0.837458610534668
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 85 cost time: 0.8256580829620361
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 86 cost time: 0.826674222946167
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.8615994453430176
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 88 cost time: 0.750514030456543
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 89 cost time: 0.8734195232391357
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.8395485877990723
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 91 cost time: 0.7990479469299316
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.7568614482879639
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.780393123626709
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 94 cost time: 0.8155922889709473
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 95 cost time: 0.900458574295044
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 96 cost time: 0.7313313484191895
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 97 cost time: 0.8103928565979004
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.7842493057250977
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.7916507720947266
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 0.8204135894775391
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df64_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 197068
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.45115065574646
Epoch: 1, Steps: 7 | Train Loss: 2.614 Vali Loss: 2.466 Vali Acc: 0.125 Test Loss: 2.466 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.7220981121063232
Epoch: 2, Steps: 7 | Train Loss: 2.296 Vali Loss: 2.125 Vali Acc: 0.361 Test Loss: 2.125 Test Acc: 0.361
Validation loss decreased (-0.124975 --> -0.361090).  Saving model ...
Epoch: 3 cost time: 0.7220396995544434
Epoch: 3, Steps: 7 | Train Loss: 1.816 Vali Loss: 1.696 Vali Acc: 0.514 Test Loss: 1.696 Test Acc: 0.514
Validation loss decreased (-0.361090 --> -0.513872).  Saving model ...
Epoch: 4 cost time: 0.7150933742523193
Epoch: 4, Steps: 7 | Train Loss: 1.305 Vali Loss: 1.308 Vali Acc: 0.667 Test Loss: 1.308 Test Acc: 0.667
Validation loss decreased (-0.513872 --> -0.666654).  Saving model ...
Epoch: 5 cost time: 0.7709717750549316
Epoch: 5, Steps: 7 | Train Loss: 0.848 Vali Loss: 0.984 Vali Acc: 0.722 Test Loss: 0.984 Test Acc: 0.722
Validation loss decreased (-0.666654 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 0.8099014759063721
Epoch: 6, Steps: 7 | Train Loss: 0.491 Vali Loss: 0.731 Vali Acc: 0.792 Test Loss: 0.731 Test Acc: 0.792
Validation loss decreased (-0.722212 --> -0.791659).  Saving model ...
Epoch: 7 cost time: 0.7268199920654297
Epoch: 7, Steps: 7 | Train Loss: 0.278 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
Validation loss decreased (-0.791659 --> -0.819439).  Saving model ...
Epoch: 8 cost time: 0.799083948135376
Epoch: 8, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
Validation loss decreased (-0.819439 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 0.7787973880767822
Epoch: 9, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.447 Vali Acc: 0.861 Test Loss: 0.447 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 10 cost time: 0.8676905632019043
Epoch: 10, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 0.7588777542114258
Epoch: 11, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 0.7644698619842529
Epoch: 12, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 0.7924604415893555
Epoch: 13, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.7725510597229004
Epoch: 14, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.7335784435272217
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.8403713703155518
Epoch: 16, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.7697443962097168
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.7936673164367676
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.7865359783172607
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.70493483543396
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.706061840057373
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.7076952457427979
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.7384228706359863
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.7496418952941895
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7287616729736328
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.768970251083374
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7849514484405518
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7466022968292236
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7799060344696045
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7612893581390381
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7636227607727051
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7194948196411133
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7107884883880615
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm128_nh16_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 186316
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.673999786376953
Epoch: 1, Steps: 7 | Train Loss: 2.614 Vali Loss: 2.345 Vali Acc: 0.194 Test Loss: 2.345 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 1.1462225914001465
Epoch: 2, Steps: 7 | Train Loss: 1.866 Vali Loss: 1.479 Vali Acc: 0.681 Test Loss: 1.479 Test Acc: 0.681
Validation loss decreased (-0.194421 --> -0.680541).  Saving model ...
Epoch: 3 cost time: 1.1630504131317139
Epoch: 3, Steps: 7 | Train Loss: 0.829 Vali Loss: 0.754 Vali Acc: 0.833 Test Loss: 0.754 Test Acc: 0.833
Validation loss decreased (-0.680541 --> -0.833326).  Saving model ...
Epoch: 4 cost time: 1.1308958530426025
Epoch: 4, Steps: 7 | Train Loss: 0.244 Vali Loss: 0.461 Vali Acc: 0.861 Test Loss: 0.461 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861107).  Saving model ...
Epoch: 5 cost time: 1.2030460834503174
Epoch: 5, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.1663448810577393
Epoch: 6, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 1.0838932991027832
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1379921436309814
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.328 Vali Acc: 0.931 Test Loss: 0.328 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 1.1553659439086914
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1498284339904785
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0524578094482422
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1630065441131592
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2236888408660889
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.1264700889587402
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.2050189971923828
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.0274384021759033
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.148662805557251
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.163252830505371
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2019898891448975
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1617422103881836
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1799581050872803
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1790354251861572
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1416268348693848
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2080621719360352
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.125251054763794
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0776634216308594
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 416076
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6808688640594482
Epoch: 1, Steps: 7 | Train Loss: 2.491 Vali Loss: 2.274 Vali Acc: 0.194 Test Loss: 2.274 Test Acc: 0.194
Validation loss decreased (inf --> -0.194422).  Saving model ...
Epoch: 2 cost time: 1.0790302753448486
Epoch: 2, Steps: 7 | Train Loss: 2.030 Vali Loss: 1.629 Vali Acc: 0.708 Test Loss: 1.629 Test Acc: 0.708
Validation loss decreased (-0.194422 --> -0.708317).  Saving model ...
Epoch: 3 cost time: 0.9628291130065918
Epoch: 3, Steps: 7 | Train Loss: 1.275 Vali Loss: 0.998 Vali Acc: 0.847 Test Loss: 0.998 Test Acc: 0.847
Validation loss decreased (-0.708317 --> -0.847212).  Saving model ...
Epoch: 4 cost time: 0.9803202152252197
Epoch: 4, Steps: 7 | Train Loss: 0.622 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
Validation loss decreased (-0.847212 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 1.0375099182128906
Epoch: 5, Steps: 7 | Train Loss: 0.255 Vali Loss: 0.413 Vali Acc: 0.903 Test Loss: 0.413 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 1.048130989074707
Epoch: 6, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.087024450302124
Epoch: 7, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.9814467430114746
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9917871952056885
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
Validation loss decreased (-0.916664 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 1.0801818370819092
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0958421230316162
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1467034816741943
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0569255352020264
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0893559455871582
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0670287609100342
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0951368808746338
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1020090579986572
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9402501583099365
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9950001239776611
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 233676
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7172915935516357
Epoch: 1, Steps: 7 | Train Loss: 2.529 Vali Loss: 2.371 Vali Acc: 0.236 Test Loss: 2.371 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 0.970421314239502
Epoch: 2, Steps: 7 | Train Loss: 2.150 Vali Loss: 1.902 Vali Acc: 0.514 Test Loss: 1.902 Test Acc: 0.514
Validation loss decreased (-0.236087 --> -0.513870).  Saving model ...
Epoch: 3 cost time: 1.0765886306762695
Epoch: 3, Steps: 7 | Train Loss: 1.586 Vali Loss: 1.365 Vali Acc: 0.750 Test Loss: 1.365 Test Acc: 0.750
Validation loss decreased (-0.513870 --> -0.749986).  Saving model ...
Epoch: 4 cost time: 0.9884986877441406
Epoch: 4, Steps: 7 | Train Loss: 0.926 Vali Loss: 0.931 Vali Acc: 0.833 Test Loss: 0.931 Test Acc: 0.833
Validation loss decreased (-0.749986 --> -0.833324).  Saving model ...
Epoch: 5 cost time: 1.014112949371338
Epoch: 5, Steps: 7 | Train Loss: 0.529 Vali Loss: 0.609 Vali Acc: 0.889 Test Loss: 0.609 Test Acc: 0.889
Validation loss decreased (-0.833324 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 0.9550626277923584
Epoch: 6, Steps: 7 | Train Loss: 0.284 Vali Loss: 0.448 Vali Acc: 0.861 Test Loss: 0.448 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1021883487701416
Epoch: 7, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.370 Vali Acc: 0.889 Test Loss: 0.370 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.0723235607147217
Epoch: 8, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.027515172958374
Epoch: 9, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.0337278842926025
Epoch: 10, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.0728733539581299
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 1.0245428085327148
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 1.0394387245178223
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.990170955657959
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.9297389984130859
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.9506003856658936
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.9896197319030762
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1454880237579346
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0743823051452637
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0478050708770752
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.0768311023712158
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9851677417755127
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0670926570892334
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.903 Test Loss: 0.214 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0241761207580566
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9871969223022461
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 26 cost time: 0.9861559867858887
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 27 cost time: 0.9157888889312744
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 28 cost time: 1.0046610832214355
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 29 cost time: 0.9902820587158203
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.017387866973877
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 31 cost time: 0.9794418811798096
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 32 cost time: 0.9606554508209229
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9367787837982178
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 34 cost time: 0.9371538162231445
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 35 cost time: 1.0293872356414795
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 36 cost time: 0.9940180778503418
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 37 cost time: 1.0087904930114746
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0249168872833252
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 39 cost time: 1.0211138725280762
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 40 cost time: 0.9392938613891602
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8963136672973633
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8859200477600098
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8600690364837646
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8870432376861572
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.917783260345459
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8972539901733398
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9745810031890869
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0672998428344727
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9470770359039307
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 175692
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df256_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4272024631500244
Epoch: 1, Steps: 7 | Train Loss: 2.430 Vali Loss: 2.271 Vali Acc: 0.139 Test Loss: 2.271 Test Acc: 0.139
Validation loss decreased (inf --> -0.138866).  Saving model ...
Epoch: 2 cost time: 0.743178129196167
Epoch: 2, Steps: 7 | Train Loss: 2.148 Vali Loss: 1.881 Vali Acc: 0.597 Test Loss: 1.881 Test Acc: 0.597
Validation loss decreased (-0.138866 --> -0.597203).  Saving model ...
Epoch: 3 cost time: 0.8035891056060791
Epoch: 3, Steps: 7 | Train Loss: 1.697 Vali Loss: 1.416 Vali Acc: 0.667 Test Loss: 1.416 Test Acc: 0.667
Validation loss decreased (-0.597203 --> -0.666653).  Saving model ...
Epoch: 4 cost time: 0.7567751407623291
Epoch: 4, Steps: 7 | Train Loss: 1.115 Vali Loss: 0.984 Vali Acc: 0.792 Test Loss: 0.984 Test Acc: 0.792
Validation loss decreased (-0.666653 --> -0.791657).  Saving model ...
Epoch: 5 cost time: 0.7848773002624512
Epoch: 5, Steps: 7 | Train Loss: 0.611 Vali Loss: 0.675 Vali Acc: 0.861 Test Loss: 0.675 Test Acc: 0.861
Validation loss decreased (-0.791657 --> -0.861104).  Saving model ...
Epoch: 6 cost time: 0.7578096389770508
Epoch: 6, Steps: 7 | Train Loss: 0.363 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 0.7756409645080566
Epoch: 7, Steps: 7 | Train Loss: 0.174 Vali Loss: 0.433 Vali Acc: 0.861 Test Loss: 0.433 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 0.7507061958312988
Epoch: 8, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.410 Vali Acc: 0.889 Test Loss: 0.410 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.7033796310424805
Epoch: 9, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.714555025100708
Epoch: 10, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.732612133026123
Epoch: 11, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.7209382057189941
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7075607776641846
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6610610485076904
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.7524721622467041
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.731748104095459
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.6707139015197754
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.7319681644439697
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.7180230617523193
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.7015600204467773
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.822751522064209
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.665215015411377
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.7298009395599365
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.712045431137085
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.7978603839874268
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.6729495525360107
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6672520637512207
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6817657947540283
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7675096988677979
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.791966438293457
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.7748832702636719
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.7170801162719727
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7083945274353027
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.7103977203369141
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.7753381729125977
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7313745021820068
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.7417631149291992
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.7431623935699463
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.7787919044494629
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7486658096313477
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8243446350097656
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7275848388671875
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.7969775199890137
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.7395844459533691
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6862707138061523
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6837961673736572
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7108736038208008
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.74100661277771
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.6960263252258301
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.6748855113983154
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 0.7515692710876465
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.7192447185516357
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7234928607940674
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.786919355392456
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.7991626262664795
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.7205939292907715
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.8196744918823242
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.7560100555419922
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.724463701248169
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.7743608951568604
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.8933284282684326
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df256_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 145356
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.397606134414673
Epoch: 1, Steps: 7 | Train Loss: 2.532 Vali Loss: 2.503 Vali Acc: 0.042 Test Loss: 2.503 Test Acc: 0.042
Validation loss decreased (inf --> -0.041642).  Saving model ...
Epoch: 2 cost time: 0.8542401790618896
Epoch: 2, Steps: 7 | Train Loss: 2.294 Vali Loss: 2.197 Vali Acc: 0.347 Test Loss: 2.197 Test Acc: 0.347
Validation loss decreased (-0.041642 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 0.7285146713256836
Epoch: 3, Steps: 7 | Train Loss: 1.939 Vali Loss: 1.780 Vali Acc: 0.639 Test Loss: 1.780 Test Acc: 0.639
Validation loss decreased (-0.347200 --> -0.638871).  Saving model ...
Epoch: 4 cost time: 0.7903811931610107
Epoch: 4, Steps: 7 | Train Loss: 1.535 Vali Loss: 1.356 Vali Acc: 0.722 Test Loss: 1.356 Test Acc: 0.722
Validation loss decreased (-0.638871 --> -0.722209).  Saving model ...
Epoch: 5 cost time: 0.7525155544281006
Epoch: 5, Steps: 7 | Train Loss: 1.069 Vali Loss: 0.997 Vali Acc: 0.847 Test Loss: 0.997 Test Acc: 0.847
Validation loss decreased (-0.722209 --> -0.847212).  Saving model ...
Epoch: 6 cost time: 0.7004139423370361
Epoch: 6, Steps: 7 | Train Loss: 0.663 Vali Loss: 0.727 Vali Acc: 0.903 Test Loss: 0.727 Test Acc: 0.903
Validation loss decreased (-0.847212 --> -0.902771).  Saving model ...
Epoch: 7 cost time: 0.8323655128479004
Epoch: 7, Steps: 7 | Train Loss: 0.378 Vali Loss: 0.535 Vali Acc: 0.931 Test Loss: 0.535 Test Acc: 0.931
Validation loss decreased (-0.902771 --> -0.930550).  Saving model ...
Epoch: 8 cost time: 0.8183221817016602
Epoch: 8, Steps: 7 | Train Loss: 0.214 Vali Loss: 0.434 Vali Acc: 0.931 Test Loss: 0.434 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930551).  Saving model ...
Epoch: 9 cost time: 0.8059637546539307
Epoch: 9, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.367 Vali Acc: 0.931 Test Loss: 0.367 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.6916570663452148
Epoch: 10, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.340 Vali Acc: 0.931 Test Loss: 0.340 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 0.8241844177246094
Epoch: 11, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.6889133453369141
Epoch: 12, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.6888339519500732
Epoch: 13, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.736133337020874
Epoch: 14, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.7195377349853516
Epoch: 15, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.7373495101928711
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.7657244205474854
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.7448453903198242
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.7190546989440918
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.7472848892211914
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.8233959674835205
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.7897396087646484
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.7350747585296631
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.8007807731628418
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.7384800910949707
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.8164072036743164
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.8095476627349854
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.8367640972137451
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.714160680770874
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.6657075881958008
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.7652812004089355
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.7148022651672363
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.7622573375701904
Epoch: 33, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8054475784301758
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7354493141174316
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7785699367523193
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6889419555664062
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7692503929138184
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6305980682373047
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.7720975875854492
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.7316653728485107
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.7407457828521729
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.6583817005157471
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.7149899005889893
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7997565269470215
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7942767143249512
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7633881568908691
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.705070972442627
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.7042341232299805
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.7499539852142334
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 0.7183651924133301
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 0.6616277694702148
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 0.6754856109619141
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.7005398273468018
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 0.6430702209472656
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 0.6370384693145752
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 57 cost time: 0.7086789608001709
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 58 cost time: 0.7950284481048584
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 59 cost time: 0.6361217498779297
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 60 cost time: 0.7034130096435547
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 61 cost time: 0.6994099617004395
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 62 cost time: 0.7498373985290527
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6347830295562744
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.7418618202209473
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.6373283863067627
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 66 cost time: 0.6488103866577148
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 67 cost time: 0.6919660568237305
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 68 cost time: 0.7174966335296631
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 69 cost time: 0.7551896572113037
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 70 cost time: 0.7095217704772949
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.6712279319763184
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.6618025302886963
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 73 cost time: 0.7646090984344482
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 74 cost time: 0.69034743309021
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.7351284027099609
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.7672502994537354
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.7370212078094482
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.7153561115264893
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.700594425201416
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 80 cost time: 0.7415978908538818
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 81 cost time: 0.7311768531799316
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 82 cost time: 0.5923359394073486
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 83 cost time: 0.7108569145202637
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.7631092071533203
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 85 cost time: 0.7208800315856934
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.7677788734436035
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 87 cost time: 0.7407565116882324
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.7285981178283691
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 89 cost time: 0.6932432651519775
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 90 cost time: 0.7075304985046387
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 91 cost time: 0.7049915790557861
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 92 cost time: 0.6925802230834961
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 93 cost time: 0.6041438579559326
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 94 cost time: 0.7484526634216309
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 95 cost time: 0.7355208396911621
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.764517068862915
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.8049266338348389
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 98 cost time: 0.7851881980895996
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.7697544097900391
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.740680456161499
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 121548
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df256_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.383549451828003
Epoch: 1, Steps: 7 | Train Loss: 2.557 Vali Loss: 2.443 Vali Acc: 0.056 Test Loss: 2.443 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.7279870510101318
Epoch: 2, Steps: 7 | Train Loss: 2.459 Vali Loss: 2.224 Vali Acc: 0.167 Test Loss: 2.224 Test Acc: 0.167
Validation loss decreased (-0.055531 --> -0.166644).  Saving model ...
Epoch: 3 cost time: 0.6094613075256348
Epoch: 3, Steps: 7 | Train Loss: 2.098 Vali Loss: 1.917 Vali Acc: 0.500 Test Loss: 1.917 Test Acc: 0.500
Validation loss decreased (-0.166644 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 0.6301279067993164
Epoch: 4, Steps: 7 | Train Loss: 1.724 Vali Loss: 1.591 Vali Acc: 0.681 Test Loss: 1.591 Test Acc: 0.681
Validation loss decreased (-0.499981 --> -0.680540).  Saving model ...
Epoch: 5 cost time: 0.7600774765014648
Epoch: 5, Steps: 7 | Train Loss: 1.313 Vali Loss: 1.283 Vali Acc: 0.750 Test Loss: 1.283 Test Acc: 0.750
Validation loss decreased (-0.680540 --> -0.749987).  Saving model ...
Epoch: 6 cost time: 0.6395235061645508
Epoch: 6, Steps: 7 | Train Loss: 0.999 Vali Loss: 1.017 Vali Acc: 0.792 Test Loss: 1.017 Test Acc: 0.792
Validation loss decreased (-0.749987 --> -0.791656).  Saving model ...
Epoch: 7 cost time: 0.7370896339416504
Epoch: 7, Steps: 7 | Train Loss: 0.694 Vali Loss: 0.812 Vali Acc: 0.778 Test Loss: 0.812 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7342884540557861
Epoch: 8, Steps: 7 | Train Loss: 0.437 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
Validation loss decreased (-0.791656 --> -0.805549).  Saving model ...
Epoch: 9 cost time: 0.6647136211395264
Epoch: 9, Steps: 7 | Train Loss: 0.296 Vali Loss: 0.535 Vali Acc: 0.847 Test Loss: 0.535 Test Acc: 0.847
Validation loss decreased (-0.805549 --> -0.847217).  Saving model ...
Epoch: 10 cost time: 0.7140293121337891
Epoch: 10, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.459 Vali Acc: 0.861 Test Loss: 0.459 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 0.766711950302124
Epoch: 11, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.426 Vali Acc: 0.847 Test Loss: 0.426 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7403843402862549
Epoch: 12, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.394 Vali Acc: 0.861 Test Loss: 0.394 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 0.7162835597991943
Epoch: 13, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 14 cost time: 0.6355457305908203
Epoch: 14, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 0.7272946834564209
Epoch: 15, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.7634949684143066
Epoch: 16, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.7163786888122559
Epoch: 17, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.8040854930877686
Epoch: 18, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7603023052215576
Epoch: 19, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7235889434814453
Epoch: 20, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6672921180725098
Epoch: 21, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7733607292175293
Epoch: 22, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8039054870605469
Epoch: 23, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.705230712890625
Epoch: 24, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7326545715332031
Epoch: 25, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.754523515701294
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7703065872192383
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df256_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 106956
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3912367820739746
Epoch: 1, Steps: 7 | Train Loss: 2.602 Vali Loss: 2.495 Vali Acc: 0.125 Test Loss: 2.495 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.7044641971588135
Epoch: 2, Steps: 7 | Train Loss: 2.488 Vali Loss: 2.285 Vali Acc: 0.236 Test Loss: 2.285 Test Acc: 0.236
Validation loss decreased (-0.124975 --> -0.236088).  Saving model ...
Epoch: 3 cost time: 0.6595945358276367
Epoch: 3, Steps: 7 | Train Loss: 2.153 Vali Loss: 2.013 Vali Acc: 0.472 Test Loss: 2.013 Test Acc: 0.472
Validation loss decreased (-0.236088 --> -0.472202).  Saving model ...
Epoch: 4 cost time: 0.703646183013916
Epoch: 4, Steps: 7 | Train Loss: 1.850 Vali Loss: 1.712 Vali Acc: 0.556 Test Loss: 1.712 Test Acc: 0.556
Validation loss decreased (-0.472202 --> -0.555538).  Saving model ...
Epoch: 5 cost time: 0.6973483562469482
Epoch: 5, Steps: 7 | Train Loss: 1.486 Vali Loss: 1.431 Vali Acc: 0.694 Test Loss: 1.431 Test Acc: 0.694
Validation loss decreased (-0.555538 --> -0.694430).  Saving model ...
Epoch: 6 cost time: 0.6529285907745361
Epoch: 6, Steps: 7 | Train Loss: 1.131 Vali Loss: 1.170 Vali Acc: 0.722 Test Loss: 1.170 Test Acc: 0.722
Validation loss decreased (-0.694430 --> -0.722211).  Saving model ...
Epoch: 7 cost time: 0.7048614025115967
Epoch: 7, Steps: 7 | Train Loss: 0.807 Vali Loss: 0.944 Vali Acc: 0.764 Test Loss: 0.944 Test Acc: 0.764
Validation loss decreased (-0.722211 --> -0.763879).  Saving model ...
Epoch: 8 cost time: 0.6831188201904297
Epoch: 8, Steps: 7 | Train Loss: 0.578 Vali Loss: 0.778 Vali Acc: 0.764 Test Loss: 0.778 Test Acc: 0.764
Validation loss decreased (-0.763879 --> -0.763881).  Saving model ...
Epoch: 9 cost time: 0.6741104125976562
Epoch: 9, Steps: 7 | Train Loss: 0.395 Vali Loss: 0.641 Vali Acc: 0.819 Test Loss: 0.641 Test Acc: 0.819
Validation loss decreased (-0.763881 --> -0.819438).  Saving model ...
Epoch: 10 cost time: 0.6368443965911865
Epoch: 10, Steps: 7 | Train Loss: 0.254 Vali Loss: 0.559 Vali Acc: 0.861 Test Loss: 0.559 Test Acc: 0.861
Validation loss decreased (-0.819438 --> -0.861106).  Saving model ...
Epoch: 11 cost time: 0.6236770153045654
Epoch: 11, Steps: 7 | Train Loss: 0.160 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5874533653259277
Epoch: 12, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.497 Vali Acc: 0.833 Test Loss: 0.497 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6875808238983154
Epoch: 13, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.432 Vali Acc: 0.847 Test Loss: 0.432 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5945219993591309
Epoch: 14, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.400 Vali Acc: 0.861 Test Loss: 0.400 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 0.5827033519744873
Epoch: 15, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.387 Vali Acc: 0.847 Test Loss: 0.387 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.620074987411499
Epoch: 16, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.385 Vali Acc: 0.861 Test Loss: 0.385 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 17 cost time: 0.5524232387542725
Epoch: 17, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.383 Vali Acc: 0.847 Test Loss: 0.383 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6209554672241211
Epoch: 18, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.375 Vali Acc: 0.847 Test Loss: 0.375 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6433694362640381
Epoch: 19, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.373 Vali Acc: 0.861 Test Loss: 0.373 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 20 cost time: 0.6763207912445068
Epoch: 20, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.365 Vali Acc: 0.861 Test Loss: 0.365 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 21 cost time: 0.6250314712524414
Epoch: 21, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.358 Vali Acc: 0.861 Test Loss: 0.358 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 22 cost time: 0.7590279579162598
Epoch: 22, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.359 Vali Acc: 0.861 Test Loss: 0.359 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6989994049072266
Epoch: 23, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.357 Vali Acc: 0.861 Test Loss: 0.357 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 24 cost time: 0.6947939395904541
Epoch: 24, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.349 Vali Acc: 0.861 Test Loss: 0.349 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 25 cost time: 0.7261676788330078
Epoch: 25, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.343 Vali Acc: 0.861 Test Loss: 0.343 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 26 cost time: 0.6945705413818359
Epoch: 26, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.339 Vali Acc: 0.861 Test Loss: 0.339 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 27 cost time: 0.7735264301300049
Epoch: 27, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 28 cost time: 0.7925493717193604
Epoch: 28, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 29 cost time: 0.7054805755615234
Epoch: 29, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 30 cost time: 0.7224752902984619
Epoch: 30, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 31 cost time: 0.7097640037536621
Epoch: 31, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 32 cost time: 0.6639108657836914
Epoch: 32, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7000641822814941
Epoch: 33, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7697920799255371
Epoch: 34, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6717202663421631
Epoch: 35, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6860113143920898
Epoch: 36, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 37 cost time: 0.8216533660888672
Epoch: 37, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 38 cost time: 0.7308595180511475
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7103047370910645
Epoch: 39, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 40 cost time: 0.7252306938171387
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 41 cost time: 0.779202938079834
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 42 cost time: 0.7031326293945312
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 43 cost time: 0.8028435707092285
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8510575294494629
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7587451934814453
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7287533283233643
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7764923572540283
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6988704204559326
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6771788597106934
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8349049091339111
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.7324075698852539
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 52 cost time: 0.7620174884796143
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 53 cost time: 0.7695400714874268
Epoch: 53, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.308 Vali Acc: 0.875 Test Loss: 0.308 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 54 cost time: 0.661069393157959
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 55 cost time: 0.766075611114502
Epoch: 55, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 56 cost time: 0.7350471019744873
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 57 cost time: 0.8182003498077393
Epoch: 57, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6791093349456787
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.8334827423095703
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 60 cost time: 0.7050690650939941
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 61 cost time: 0.7179388999938965
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.830608606338501
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.7725658416748047
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.7353057861328125
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.6937861442565918
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.794837474822998
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.7304794788360596
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.7793362140655518
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.7846322059631348
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.7443931102752686
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 101580
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6359922885894775
Epoch: 1, Steps: 7 | Train Loss: 2.688 Vali Loss: 2.314 Vali Acc: 0.292 Test Loss: 2.314 Test Acc: 0.292
Validation loss decreased (inf --> -0.291644).  Saving model ...
Epoch: 2 cost time: 0.8658528327941895
Epoch: 2, Steps: 7 | Train Loss: 1.923 Vali Loss: 1.410 Vali Acc: 0.708 Test Loss: 1.410 Test Acc: 0.708
Validation loss decreased (-0.291644 --> -0.708319).  Saving model ...
Epoch: 3 cost time: 0.7920088768005371
Epoch: 3, Steps: 7 | Train Loss: 0.801 Vali Loss: 0.684 Vali Acc: 0.847 Test Loss: 0.684 Test Acc: 0.847
Validation loss decreased (-0.708319 --> -0.847215).  Saving model ...
Epoch: 4 cost time: 0.8784723281860352
Epoch: 4, Steps: 7 | Train Loss: 0.235 Vali Loss: 0.436 Vali Acc: 0.917 Test Loss: 0.436 Test Acc: 0.917
Validation loss decreased (-0.847215 --> -0.916662).  Saving model ...
Epoch: 5 cost time: 0.8365812301635742
Epoch: 5, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 0.8839395046234131
Epoch: 6, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 0.8178427219390869
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8868153095245361
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9274330139160156
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.860518217086792
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7401080131530762
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9581034183502197
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9242186546325684
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0312256813049316
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9434821605682373
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 1.0274019241333008
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.9944217205047607
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.890700101852417
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.8868551254272461
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8521261215209961
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8708786964416504
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.931431770324707
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8954017162322998
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9527950286865234
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9895753860473633
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9766979217529297
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9378225803375244
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8054418563842773
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 399564
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4046080112457275
Epoch: 1, Steps: 7 | Train Loss: 2.682 Vali Loss: 2.326 Vali Acc: 0.139 Test Loss: 2.326 Test Acc: 0.139
Validation loss decreased (inf --> -0.138866).  Saving model ...
Epoch: 2 cost time: 0.9282069206237793
Epoch: 2, Steps: 7 | Train Loss: 2.171 Vali Loss: 1.707 Vali Acc: 0.611 Test Loss: 1.707 Test Acc: 0.611
Validation loss decreased (-0.138866 --> -0.611094).  Saving model ...
Epoch: 3 cost time: 0.9684975147247314
Epoch: 3, Steps: 7 | Train Loss: 1.292 Vali Loss: 1.012 Vali Acc: 0.833 Test Loss: 1.012 Test Acc: 0.833
Validation loss decreased (-0.611094 --> -0.833323).  Saving model ...
Epoch: 4 cost time: 0.8160812854766846
Epoch: 4, Steps: 7 | Train Loss: 0.635 Vali Loss: 0.598 Vali Acc: 0.861 Test Loss: 0.598 Test Acc: 0.861
Validation loss decreased (-0.833323 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 0.9423551559448242
Epoch: 5, Steps: 7 | Train Loss: 0.272 Vali Loss: 0.440 Vali Acc: 0.917 Test Loss: 0.440 Test Acc: 0.917
Validation loss decreased (-0.861105 --> -0.916662).  Saving model ...
Epoch: 6 cost time: 0.8107194900512695
Epoch: 6, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9264845848083496
Epoch: 7, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.8276019096374512
Epoch: 8, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9015758037567139
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9878056049346924
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.8050179481506348
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.862464189529419
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.8601446151733398
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.9273676872253418
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.7336733341217041
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9354958534240723
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9338831901550293
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8546106815338135
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.9112112522125244
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.9750099182128906
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0952389240264893
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.9506826400756836
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.9289746284484863
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0223958492279053
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8571171760559082
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0342981815338135
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.953383207321167
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.8703811168670654
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8976669311523438
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8638887405395508
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7697553634643555
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8794054985046387
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.7978489398956299
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.7837378978729248
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8991773128509521
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9601156711578369
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8967559337615967
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9543330669403076
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.7450416088104248
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.8739364147186279
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7851426601409912
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.9548928737640381
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.9756424427032471
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.9511697292327881
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.8600256443023682
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.8914065361022949
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.9470438957214355
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.9344611167907715
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8904054164886475
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.865109920501709
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0136840343475342
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 52 cost time: 1.030914306640625
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 53 cost time: 0.8835079669952393
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.975956916809082
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.0658066272735596
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9312455654144287
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.8871500492095947
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.9445943832397461
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.9299337863922119
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.9583666324615479
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.9683084487915039
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.908728837966919
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 217164
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7625069618225098
Epoch: 1, Steps: 7 | Train Loss: 2.581 Vali Loss: 2.387 Vali Acc: 0.222 Test Loss: 2.387 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.9695353507995605
Epoch: 2, Steps: 7 | Train Loss: 2.209 Vali Loss: 1.899 Vali Acc: 0.472 Test Loss: 1.899 Test Acc: 0.472
Validation loss decreased (-0.222198 --> -0.472203).  Saving model ...
Epoch: 3 cost time: 0.8738505840301514
Epoch: 3, Steps: 7 | Train Loss: 1.548 Vali Loss: 1.348 Vali Acc: 0.764 Test Loss: 1.348 Test Acc: 0.764
Validation loss decreased (-0.472203 --> -0.763875).  Saving model ...
Epoch: 4 cost time: 0.9093983173370361
Epoch: 4, Steps: 7 | Train Loss: 0.950 Vali Loss: 0.895 Vali Acc: 0.833 Test Loss: 0.895 Test Acc: 0.833
Validation loss decreased (-0.763875 --> -0.833324).  Saving model ...
Epoch: 5 cost time: 0.9184482097625732
Epoch: 5, Steps: 7 | Train Loss: 0.505 Vali Loss: 0.637 Vali Acc: 0.861 Test Loss: 0.637 Test Acc: 0.861
Validation loss decreased (-0.833324 --> -0.861105).  Saving model ...
Epoch: 6 cost time: 0.9296989440917969
Epoch: 6, Steps: 7 | Train Loss: 0.244 Vali Loss: 0.439 Vali Acc: 0.903 Test Loss: 0.439 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902773).  Saving model ...
Epoch: 7 cost time: 0.8739948272705078
Epoch: 7, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.8863973617553711
Epoch: 8, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0384101867675781
Epoch: 9, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9054644107818604
Epoch: 10, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.8854053020477295
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8973300457000732
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.9411215782165527
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.9789111614227295
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.938385009765625
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.0675466060638428
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9665288925170898
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.9106626510620117
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.9809212684631348
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.0212726593017578
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.9958686828613281
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.0289416313171387
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.9570827484130859
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.9007644653320312
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.0068080425262451
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.9622979164123535
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9927411079406738
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8940207958221436
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9920086860656738
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0330796241760254
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9526631832122803
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9833042621612549
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0036256313323975
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.036372423171997
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9153409004211426
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.9086096286773682
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.9558427333831787
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.978203535079956
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8717141151428223
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.024266242980957
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9196662902832031
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.97867751121521
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.8930583000183105
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.8872568607330322
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.003216028213501
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.9872634410858154
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.98703932762146
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9662725925445557
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 1.0708329677581787
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 1.0361747741699219
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 51 cost time: 0.9424495697021484
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 52 cost time: 0.849794864654541
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 53 cost time: 0.9462487697601318
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0064783096313477
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.977471113204956
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9968705177307129
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.0018985271453857
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.9461166858673096
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.9513115882873535
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.9688849449157715
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.0040490627288818
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 62 cost time: 1.013084888458252
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.0041348934173584
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.9854662418365479
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 65 cost time: 0.9746806621551514
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 66 cost time: 0.9651069641113281
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0508389472961426
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.9431450366973877
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.0437555313110352
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 70 cost time: 1.03464674949646
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.9568400382995605
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 72 cost time: 0.8890230655670166
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 73 cost time: 0.9143707752227783
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 74 cost time: 0.8266072273254395
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.8178505897521973
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 76 cost time: 0.7614481449127197
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.8824553489685059
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 78 cost time: 1.0216443538665771
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 79 cost time: 0.8421590328216553
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.9835207462310791
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.028306007385254
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.9720237255096436
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 1.0189340114593506
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.9514689445495605
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.9861142635345459
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 1.0312066078186035
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 1.0367028713226318
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 0.9613888263702393
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 159180
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df128_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3793442249298096
Epoch: 1, Steps: 7 | Train Loss: 2.839 Vali Loss: 2.606 Vali Acc: 0.056 Test Loss: 2.606 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 0.7686281204223633
Epoch: 2, Steps: 7 | Train Loss: 2.484 Vali Loss: 2.165 Vali Acc: 0.264 Test Loss: 2.165 Test Acc: 0.264
Validation loss decreased (-0.055529 --> -0.263867).  Saving model ...
Epoch: 3 cost time: 0.7533881664276123
Epoch: 3, Steps: 7 | Train Loss: 1.967 Vali Loss: 1.677 Vali Acc: 0.625 Test Loss: 1.677 Test Acc: 0.625
Validation loss decreased (-0.263867 --> -0.624983).  Saving model ...
Epoch: 4 cost time: 0.6642589569091797
Epoch: 4, Steps: 7 | Train Loss: 1.312 Vali Loss: 1.202 Vali Acc: 0.736 Test Loss: 1.202 Test Acc: 0.736
Validation loss decreased (-0.624983 --> -0.736099).  Saving model ...
Epoch: 5 cost time: 0.7092323303222656
Epoch: 5, Steps: 7 | Train Loss: 0.820 Vali Loss: 0.829 Vali Acc: 0.875 Test Loss: 0.829 Test Acc: 0.875
Validation loss decreased (-0.736099 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.6800622940063477
Epoch: 6, Steps: 7 | Train Loss: 0.445 Vali Loss: 0.591 Vali Acc: 0.903 Test Loss: 0.591 Test Acc: 0.903
Validation loss decreased (-0.874992 --> -0.902772).  Saving model ...
Epoch: 7 cost time: 0.657137393951416
Epoch: 7, Steps: 7 | Train Loss: 0.237 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7669370174407959
Epoch: 8, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6989121437072754
Epoch: 9, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.634087324142456
Epoch: 10, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.7920668125152588
Epoch: 11, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.7838068008422852
Epoch: 12, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.7796387672424316
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.7316181659698486
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.6990170478820801
Epoch: 15, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.7328066825866699
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6912059783935547
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7891976833343506
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6752066612243652
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6671450138092041
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8047287464141846
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7784333229064941
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6980633735656738
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6951408386230469
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6783416271209717
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df128_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 128844
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.542064905166626
Epoch: 1, Steps: 7 | Train Loss: 2.587 Vali Loss: 2.456 Vali Acc: 0.167 Test Loss: 2.456 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 0.6504764556884766
Epoch: 2, Steps: 7 | Train Loss: 2.305 Vali Loss: 2.150 Vali Acc: 0.403 Test Loss: 2.150 Test Acc: 0.403
Validation loss decreased (-0.166642 --> -0.402756).  Saving model ...
Epoch: 3 cost time: 0.709583044052124
Epoch: 3, Steps: 7 | Train Loss: 1.932 Vali Loss: 1.762 Vali Acc: 0.653 Test Loss: 1.762 Test Acc: 0.653
Validation loss decreased (-0.402756 --> -0.652760).  Saving model ...
Epoch: 4 cost time: 0.7170367240905762
Epoch: 4, Steps: 7 | Train Loss: 1.458 Vali Loss: 1.365 Vali Acc: 0.778 Test Loss: 1.365 Test Acc: 0.778
Validation loss decreased (-0.652760 --> -0.777764).  Saving model ...
Epoch: 5 cost time: 0.6543900966644287
Epoch: 5, Steps: 7 | Train Loss: 1.070 Vali Loss: 1.017 Vali Acc: 0.833 Test Loss: 1.017 Test Acc: 0.833
Validation loss decreased (-0.777764 --> -0.833323).  Saving model ...
Epoch: 6 cost time: 0.6501150131225586
Epoch: 6, Steps: 7 | Train Loss: 0.717 Vali Loss: 0.756 Vali Acc: 0.861 Test Loss: 0.756 Test Acc: 0.861
Validation loss decreased (-0.833323 --> -0.861104).  Saving model ...
Epoch: 7 cost time: 0.6529757976531982
Epoch: 7, Steps: 7 | Train Loss: 0.440 Vali Loss: 0.596 Vali Acc: 0.861 Test Loss: 0.596 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861105).  Saving model ...
Epoch: 8 cost time: 0.591050386428833
Epoch: 8, Steps: 7 | Train Loss: 0.254 Vali Loss: 0.466 Vali Acc: 0.875 Test Loss: 0.466 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 0.7312502861022949
Epoch: 9, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 0.6587724685668945
Epoch: 10, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 0.6099774837493896
Epoch: 11, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.6553359031677246
Epoch: 12, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.6547191143035889
Epoch: 13, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.6682586669921875
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.5819127559661865
Epoch: 15, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.607107400894165
Epoch: 16, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.6664621829986572
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.6449451446533203
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7122151851654053
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6939699649810791
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.6909399032592773
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.6217236518859863
Epoch: 22, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.6741809844970703
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.5895853042602539
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.6718268394470215
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 26 cost time: 0.7096302509307861
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 27 cost time: 0.6675832271575928
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 28 cost time: 0.6091108322143555
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6917130947113037
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.636101245880127
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 31 cost time: 0.6608288288116455
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 32 cost time: 0.6804900169372559
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 33 cost time: 0.5572059154510498
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 34 cost time: 0.7042615413665771
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.903 Test Loss: 0.203 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6267585754394531
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.903 Test Loss: 0.202 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6320030689239502
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6383650302886963
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5953283309936523
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.903 Test Loss: 0.198 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7128798961639404
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.903 Test Loss: 0.196 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7252564430236816
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.903 Test Loss: 0.195 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6561737060546875
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.903 Test Loss: 0.196 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.6977372169494629
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.903 Test Loss: 0.197 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.651212215423584
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.903 Test Loss: 0.196 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 105036
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df128_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3703417778015137
Epoch: 1, Steps: 7 | Train Loss: 2.670 Vali Loss: 2.526 Vali Acc: 0.083 Test Loss: 2.526 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.7780804634094238
Epoch: 2, Steps: 7 | Train Loss: 2.448 Vali Loss: 2.282 Vali Acc: 0.264 Test Loss: 2.282 Test Acc: 0.264
Validation loss decreased (-0.083308 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 0.6143980026245117
Epoch: 3, Steps: 7 | Train Loss: 2.143 Vali Loss: 1.963 Vali Acc: 0.472 Test Loss: 1.963 Test Acc: 0.472
Validation loss decreased (-0.263866 --> -0.472203).  Saving model ...
Epoch: 4 cost time: 0.7991986274719238
Epoch: 4, Steps: 7 | Train Loss: 1.745 Vali Loss: 1.625 Vali Acc: 0.667 Test Loss: 1.625 Test Acc: 0.667
Validation loss decreased (-0.472203 --> -0.666650).  Saving model ...
Epoch: 5 cost time: 0.7091324329376221
Epoch: 5, Steps: 7 | Train Loss: 1.387 Vali Loss: 1.299 Vali Acc: 0.764 Test Loss: 1.299 Test Acc: 0.764
Validation loss decreased (-0.666650 --> -0.763876).  Saving model ...
Epoch: 6 cost time: 0.7832696437835693
Epoch: 6, Steps: 7 | Train Loss: 1.038 Vali Loss: 1.026 Vali Acc: 0.792 Test Loss: 1.026 Test Acc: 0.792
Validation loss decreased (-0.763876 --> -0.791656).  Saving model ...
Epoch: 7 cost time: 0.7308225631713867
Epoch: 7, Steps: 7 | Train Loss: 0.710 Vali Loss: 0.802 Vali Acc: 0.819 Test Loss: 0.802 Test Acc: 0.819
Validation loss decreased (-0.791656 --> -0.819436).  Saving model ...
Epoch: 8 cost time: 0.6680872440338135
Epoch: 8, Steps: 7 | Train Loss: 0.470 Vali Loss: 0.638 Vali Acc: 0.833 Test Loss: 0.638 Test Acc: 0.833
Validation loss decreased (-0.819436 --> -0.833327).  Saving model ...
Epoch: 9 cost time: 0.7455484867095947
Epoch: 9, Steps: 7 | Train Loss: 0.285 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
Validation loss decreased (-0.833327 --> -0.874995).  Saving model ...
Epoch: 10 cost time: 0.6900014877319336
Epoch: 10, Steps: 7 | Train Loss: 0.186 Vali Loss: 0.451 Vali Acc: 0.903 Test Loss: 0.451 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902773).  Saving model ...
Epoch: 11 cost time: 0.676016092300415
Epoch: 11, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.405 Vali Acc: 0.889 Test Loss: 0.405 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7385029792785645
Epoch: 12, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6820776462554932
Epoch: 13, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7567591667175293
Epoch: 14, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7017438411712646
Epoch: 15, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.722235918045044
Epoch: 16, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.7023923397064209
Epoch: 17, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.8263144493103027
Epoch: 18, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8511013984680176
Epoch: 19, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.8369929790496826
Epoch: 20, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.676591157913208
Epoch: 21, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.7339353561401367
Epoch: 22, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.743466854095459
Epoch: 23, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.786893367767334
Epoch: 24, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.6755414009094238
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.7271513938903809
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.7244346141815186
Epoch: 27, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7530317306518555
Epoch: 28, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6492569446563721
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.6618142127990723
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.6994156837463379
Epoch: 31, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7352328300476074
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7668344974517822
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.713341474533081
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.7555170059204102
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.7558789253234863
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.776585578918457
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.6753637790679932
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.7259440422058105
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7191076278686523
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7564043998718262
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7628762722015381
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7522807121276855
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.7698080539703369
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.7019624710083008
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.7946124076843262
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.7142548561096191
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8412575721740723
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.7388064861297607
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.7547163963317871
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7447600364685059
Epoch: 51, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7207980155944824
Epoch: 52, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 0.7078025341033936
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.7466638088226318
Epoch: 54, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 0.8214561939239502
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 0.8240036964416504
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7291696071624756
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.793006420135498
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 0.7783832550048828
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 60 cost time: 0.7607724666595459
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 0.7605106830596924
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6122353076934814
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 63 cost time: 0.6839628219604492
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 64 cost time: 0.6952946186065674
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7188260555267334
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 66 cost time: 0.8000771999359131
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 67 cost time: 0.6816508769989014
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 68 cost time: 0.6298661231994629
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.7232539653778076
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.7587425708770752
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.8040785789489746
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.7244999408721924
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.6877303123474121
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.7893173694610596
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.6753039360046387
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.7340221405029297
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.6952776908874512
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df128_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 90444
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.211561679840088
Epoch: 1, Steps: 7 | Train Loss: 2.599 Vali Loss: 2.515 Vali Acc: 0.056 Test Loss: 2.515 Test Acc: 0.056
Validation loss decreased (inf --> -0.055530).  Saving model ...
Epoch: 2 cost time: 0.6521720886230469
Epoch: 2, Steps: 7 | Train Loss: 2.398 Vali Loss: 2.304 Vali Acc: 0.139 Test Loss: 2.304 Test Acc: 0.139
Validation loss decreased (-0.055530 --> -0.138866).  Saving model ...
Epoch: 3 cost time: 0.5820050239562988
Epoch: 3, Steps: 7 | Train Loss: 2.145 Vali Loss: 2.015 Vali Acc: 0.458 Test Loss: 2.015 Test Acc: 0.458
Validation loss decreased (-0.138866 --> -0.458313).  Saving model ...
Epoch: 4 cost time: 0.5911974906921387
Epoch: 4, Steps: 7 | Train Loss: 1.784 Vali Loss: 1.706 Vali Acc: 0.653 Test Loss: 1.706 Test Acc: 0.653
Validation loss decreased (-0.458313 --> -0.652761).  Saving model ...
Epoch: 5 cost time: 0.6807765960693359
Epoch: 5, Steps: 7 | Train Loss: 1.381 Vali Loss: 1.405 Vali Acc: 0.750 Test Loss: 1.405 Test Acc: 0.750
Validation loss decreased (-0.652761 --> -0.749986).  Saving model ...
Epoch: 6 cost time: 0.6668012142181396
Epoch: 6, Steps: 7 | Train Loss: 1.074 Vali Loss: 1.136 Vali Acc: 0.806 Test Loss: 1.136 Test Acc: 0.806
Validation loss decreased (-0.749986 --> -0.805544).  Saving model ...
Epoch: 7 cost time: 0.6598918437957764
Epoch: 7, Steps: 7 | Train Loss: 0.832 Vali Loss: 0.919 Vali Acc: 0.819 Test Loss: 0.919 Test Acc: 0.819
Validation loss decreased (-0.805544 --> -0.819435).  Saving model ...
Epoch: 8 cost time: 0.6446144580841064
Epoch: 8, Steps: 7 | Train Loss: 0.555 Vali Loss: 0.737 Vali Acc: 0.903 Test Loss: 0.737 Test Acc: 0.903
Validation loss decreased (-0.819435 --> -0.902770).  Saving model ...
Epoch: 9 cost time: 0.6092665195465088
Epoch: 9, Steps: 7 | Train Loss: 0.383 Vali Loss: 0.603 Vali Acc: 0.931 Test Loss: 0.603 Test Acc: 0.931
Validation loss decreased (-0.902770 --> -0.930550).  Saving model ...
Epoch: 10 cost time: 0.6541674137115479
Epoch: 10, Steps: 7 | Train Loss: 0.270 Vali Loss: 0.519 Vali Acc: 0.917 Test Loss: 0.519 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5819556713104248
Epoch: 11, Steps: 7 | Train Loss: 0.179 Vali Loss: 0.471 Vali Acc: 0.903 Test Loss: 0.471 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7445919513702393
Epoch: 12, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.413 Vali Acc: 0.917 Test Loss: 0.413 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6465706825256348
Epoch: 13, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.379 Vali Acc: 0.903 Test Loss: 0.379 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7451577186584473
Epoch: 14, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.361 Vali Acc: 0.917 Test Loss: 0.361 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6196868419647217
Epoch: 15, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.351 Vali Acc: 0.917 Test Loss: 0.351 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6293313503265381
Epoch: 16, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.337 Vali Acc: 0.931 Test Loss: 0.337 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 0.6501963138580322
Epoch: 17, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6823298931121826
Epoch: 18, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.639641284942627
Epoch: 19, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6418192386627197
Epoch: 20, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.5803461074829102
Epoch: 21, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6309070587158203
Epoch: 22, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.5998642444610596
Epoch: 23, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.6872401237487793
Epoch: 24, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.6345469951629639
Epoch: 25, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6411952972412109
Epoch: 26, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.5762825012207031
Epoch: 27, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.5955584049224854
Epoch: 28, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.6296777725219727
Epoch: 29, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.5988354682922363
Epoch: 30, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.6106021404266357
Epoch: 31, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.69425368309021
Epoch: 32, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.6212377548217773
Epoch: 33, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.6106085777282715
Epoch: 34, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.6268794536590576
Epoch: 35, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.6176261901855469
Epoch: 36, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.6393487453460693
Epoch: 37, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.6187474727630615
Epoch: 38, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.6166636943817139
Epoch: 39, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.6096317768096924
Epoch: 40, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.6715109348297119
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.670445442199707
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6016004085540771
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6735153198242188
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.6115758419036865
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6697902679443359
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6693859100341797
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6216299533843994
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6978306770324707
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6212069988250732
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.6919772624969482
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.6418483257293701
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 0.6513340473175049
Epoch: 53, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7190020084381104
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.6827163696289062
Epoch: 55, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6924524307250977
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.6179194450378418
Epoch: 57, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.6894845962524414
Epoch: 58, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.6761264801025391
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.7458984851837158
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.7394542694091797
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.7702572345733643
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 85068
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6935529708862305
Epoch: 1, Steps: 7 | Train Loss: 2.559 Vali Loss: 2.239 Vali Acc: 0.250 Test Loss: 2.239 Test Acc: 0.250
Validation loss decreased (inf --> -0.249978).  Saving model ...
Epoch: 2 cost time: 1.024487018585205
Epoch: 2, Steps: 7 | Train Loss: 1.830 Vali Loss: 1.375 Vali Acc: 0.722 Test Loss: 1.375 Test Acc: 0.722
Validation loss decreased (-0.249978 --> -0.722208).  Saving model ...
Epoch: 3 cost time: 0.9733917713165283
Epoch: 3, Steps: 7 | Train Loss: 0.828 Vali Loss: 0.705 Vali Acc: 0.889 Test Loss: 0.705 Test Acc: 0.889
Validation loss decreased (-0.722208 --> -0.888882).  Saving model ...
Epoch: 4 cost time: 1.110154390335083
Epoch: 4, Steps: 7 | Train Loss: 0.307 Vali Loss: 0.407 Vali Acc: 0.917 Test Loss: 0.407 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 1.133028507232666
Epoch: 5, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1651098728179932
Epoch: 6, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 1.1826775074005127
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 1.0741441249847412
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.151216983795166
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1257035732269287
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.206526279449463
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.240670919418335
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 1.138514757156372
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 1.1232750415802002
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 1.1720600128173828
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 1.0989642143249512
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.179417610168457
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9197838306427002
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 1.0166499614715576
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 1.1885418891906738
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 1.1257057189941406
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 1.1606180667877197
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 1.2012012004852295
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1614017486572266
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2015910148620605
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2399697303771973
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1451222896575928
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 1.2048592567443848
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 1.166975736618042
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 1.149456262588501
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 31 cost time: 1.1321346759796143
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 32 cost time: 1.0543901920318604
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.231377124786377
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2526977062225342
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3079636096954346
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1765341758728027
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1688330173492432
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2635400295257568
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.105884313583374
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2747721672058105
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1864650249481201
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 391308
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7947723865509033
Epoch: 1, Steps: 7 | Train Loss: 2.482 Vali Loss: 2.299 Vali Acc: 0.264 Test Loss: 2.299 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 0.8988502025604248
Epoch: 2, Steps: 7 | Train Loss: 1.983 Vali Loss: 1.664 Vali Acc: 0.722 Test Loss: 1.664 Test Acc: 0.722
Validation loss decreased (-0.263866 --> -0.722206).  Saving model ...
Epoch: 3 cost time: 1.050861120223999
Epoch: 3, Steps: 7 | Train Loss: 1.252 Vali Loss: 1.007 Vali Acc: 0.833 Test Loss: 1.007 Test Acc: 0.833
Validation loss decreased (-0.722206 --> -0.833323).  Saving model ...
Epoch: 4 cost time: 1.0486195087432861
Epoch: 4, Steps: 7 | Train Loss: 0.607 Vali Loss: 0.603 Vali Acc: 0.861 Test Loss: 0.603 Test Acc: 0.861
Validation loss decreased (-0.833323 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 0.9471566677093506
Epoch: 5, Steps: 7 | Train Loss: 0.252 Vali Loss: 0.444 Vali Acc: 0.847 Test Loss: 0.444 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9881579875946045
Epoch: 6, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888886).  Saving model ...
Epoch: 7 cost time: 0.9978475570678711
Epoch: 7, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9769988059997559
Epoch: 8, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.0103204250335693
Epoch: 9, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.972895622253418
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9856410026550293
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9245743751525879
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.972440242767334
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9457356929779053
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8465757369995117
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0007202625274658
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.004631519317627
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9337327480316162
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8176114559173584
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 208908
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.437215566635132
Epoch: 1, Steps: 7 | Train Loss: 2.606 Vali Loss: 2.440 Vali Acc: 0.153 Test Loss: 2.440 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.9035894870758057
Epoch: 2, Steps: 7 | Train Loss: 2.224 Vali Loss: 1.963 Vali Acc: 0.431 Test Loss: 1.963 Test Acc: 0.431
Validation loss decreased (-0.152753 --> -0.430536).  Saving model ...
Epoch: 3 cost time: 0.9851377010345459
Epoch: 3, Steps: 7 | Train Loss: 1.656 Vali Loss: 1.416 Vali Acc: 0.750 Test Loss: 1.416 Test Acc: 0.750
Validation loss decreased (-0.430536 --> -0.749986).  Saving model ...
Epoch: 4 cost time: 0.7725529670715332
Epoch: 4, Steps: 7 | Train Loss: 0.958 Vali Loss: 0.941 Vali Acc: 0.833 Test Loss: 0.941 Test Acc: 0.833
Validation loss decreased (-0.749986 --> -0.833324).  Saving model ...
Epoch: 5 cost time: 0.8843448162078857
Epoch: 5, Steps: 7 | Train Loss: 0.546 Vali Loss: 0.649 Vali Acc: 0.833 Test Loss: 0.649 Test Acc: 0.833
Validation loss decreased (-0.833324 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 0.9829263687133789
Epoch: 6, Steps: 7 | Train Loss: 0.253 Vali Loss: 0.471 Vali Acc: 0.889 Test Loss: 0.471 Test Acc: 0.889
Validation loss decreased (-0.833327 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 0.9516570568084717
Epoch: 7, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.8774709701538086
Epoch: 8, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0461978912353516
Epoch: 9, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.9249396324157715
Epoch: 10, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.046079158782959
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.7049386501312256
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.9542782306671143
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.9858353137969971
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9961588382720947
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.006145715713501
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9628453254699707
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9603230953216553
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8826334476470947
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.0450859069824219
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9873056411743164
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8537623882293701
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9961528778076172
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.8441498279571533
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.9863157272338867
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.99454665184021
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.9011497497558594
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.9770777225494385
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.9420924186706543
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.9539241790771484
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.0049426555633545
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.9303402900695801
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.955622673034668
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.831681489944458
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.8757543563842773
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.8670074939727783
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.8257482051849365
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8436613082885742
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.8414528369903564
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 40 cost time: 0.7395923137664795
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 41 cost time: 0.9106581211090088
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 42 cost time: 0.9564907550811768
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 43 cost time: 0.9655368328094482
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 44 cost time: 0.9568045139312744
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8989875316619873
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9375307559967041
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9053733348846436
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9319276809692383
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.8880095481872559
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 50 cost time: 0.9635703563690186
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 51 cost time: 1.0017824172973633
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0020091533660889
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.8980422019958496
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 54 cost time: 1.0726675987243652
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 55 cost time: 0.8564109802246094
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 56 cost time: 0.8337032794952393
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 57 cost time: 0.9308228492736816
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 58 cost time: 0.7897520065307617
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8264758586883545
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 60 cost time: 0.869692325592041
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 61 cost time: 0.9333388805389404
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9617927074432373
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 63 cost time: 0.9454555511474609
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 64 cost time: 0.8466267585754395
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.9347314834594727
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.8155231475830078
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.922435998916626
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.9860861301422119
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.8306658267974854
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.9123728275299072
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 71 cost time: 0.806779146194458
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.7678999900817871
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 73 cost time: 0.8524119853973389
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.9348227977752686
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 75 cost time: 0.8419089317321777
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 76 cost time: 0.8888187408447266
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.9129908084869385
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.9093368053436279
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 79 cost time: 0.8778607845306396
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 80 cost time: 0.8514847755432129
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.8521261215209961
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 82 cost time: 1.0308477878570557
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 83 cost time: 0.9033815860748291
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 84 cost time: 0.9996469020843506
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 85 cost time: 0.9433202743530273
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 86 cost time: 0.9249851703643799
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.763148307800293
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.8996760845184326
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.8114728927612305
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 0.8977305889129639
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 0.8081660270690918
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 0.8150696754455566
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 0.8663535118103027
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 0.8736870288848877
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 0.8716456890106201
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 150924
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df64_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.161412000656128
Epoch: 1, Steps: 7 | Train Loss: 2.561 Vali Loss: 2.394 Vali Acc: 0.153 Test Loss: 2.394 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.6315085887908936
Epoch: 2, Steps: 7 | Train Loss: 2.282 Vali Loss: 1.974 Vali Acc: 0.444 Test Loss: 1.974 Test Acc: 0.444
Validation loss decreased (-0.152754 --> -0.444425).  Saving model ...
Epoch: 3 cost time: 0.6868891716003418
Epoch: 3, Steps: 7 | Train Loss: 1.705 Vali Loss: 1.487 Vali Acc: 0.806 Test Loss: 1.487 Test Acc: 0.806
Validation loss decreased (-0.444425 --> -0.805541).  Saving model ...
Epoch: 4 cost time: 0.7254652976989746
Epoch: 4, Steps: 7 | Train Loss: 1.195 Vali Loss: 1.048 Vali Acc: 0.861 Test Loss: 1.048 Test Acc: 0.861
Validation loss decreased (-0.805541 --> -0.861101).  Saving model ...
Epoch: 5 cost time: 0.6485593318939209
Epoch: 5, Steps: 7 | Train Loss: 0.693 Vali Loss: 0.724 Vali Acc: 0.889 Test Loss: 0.724 Test Acc: 0.889
Validation loss decreased (-0.861101 --> -0.888882).  Saving model ...
Epoch: 6 cost time: 0.7473118305206299
Epoch: 6, Steps: 7 | Train Loss: 0.397 Vali Loss: 0.524 Vali Acc: 0.889 Test Loss: 0.524 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 0.647932767868042
Epoch: 7, Steps: 7 | Train Loss: 0.207 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6628012657165527
Epoch: 8, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5941193103790283
Epoch: 9, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.6930398941040039
Epoch: 10, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.5946335792541504
Epoch: 11, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.6750025749206543
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5708482265472412
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7043397426605225
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.7212514877319336
Epoch: 15, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.682288408279419
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.5925633907318115
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5857672691345215
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7450976371765137
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7104992866516113
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.6808011531829834
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.7519617080688477
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.6666085720062256
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.6820087432861328
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.6512813568115234
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.7144186496734619
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.6673457622528076
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.6319239139556885
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6558351516723633
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.6695249080657959
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6454446315765381
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6140937805175781
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6303157806396484
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6397268772125244
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.720618724822998
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.6455574035644531
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.6247930526733398
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6705799102783203
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.6630301475524902
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6448450088500977
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7131545543670654
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7619156837463379
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.6672656536102295
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.6870965957641602
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.682802677154541
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.6473932266235352
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.7285361289978027
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.751162052154541
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7983648777008057
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6126906871795654
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 0.6943104267120361
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.6509332656860352
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 0.6621637344360352
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 0.5357668399810791
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7256448268890381
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.699566125869751
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.6390612125396729
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.6174557209014893
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.6309807300567627
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.6643004417419434
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.6613128185272217
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.7200829982757568
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.687835693359375
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.7327005863189697
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.6267709732055664
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.691662073135376
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.5950133800506592
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.7393803596496582
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.6977589130401611
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df64_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 120588
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3653759956359863
Epoch: 1, Steps: 7 | Train Loss: 2.534 Vali Loss: 2.382 Vali Acc: 0.181 Test Loss: 2.382 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 0.808199405670166
Epoch: 2, Steps: 7 | Train Loss: 2.330 Vali Loss: 2.074 Vali Acc: 0.403 Test Loss: 2.074 Test Acc: 0.403
Validation loss decreased (-0.180532 --> -0.402757).  Saving model ...
Epoch: 3 cost time: 0.6253266334533691
Epoch: 3, Steps: 7 | Train Loss: 1.915 Vali Loss: 1.696 Vali Acc: 0.639 Test Loss: 1.696 Test Acc: 0.639
Validation loss decreased (-0.402757 --> -0.638872).  Saving model ...
Epoch: 4 cost time: 0.6708946228027344
Epoch: 4, Steps: 7 | Train Loss: 1.471 Vali Loss: 1.310 Vali Acc: 0.764 Test Loss: 1.310 Test Acc: 0.764
Validation loss decreased (-0.638872 --> -0.763876).  Saving model ...
Epoch: 5 cost time: 0.7076983451843262
Epoch: 5, Steps: 7 | Train Loss: 1.060 Vali Loss: 0.982 Vali Acc: 0.792 Test Loss: 0.982 Test Acc: 0.792
Validation loss decreased (-0.763876 --> -0.791657).  Saving model ...
Epoch: 6 cost time: 0.6920802593231201
Epoch: 6, Steps: 7 | Train Loss: 0.645 Vali Loss: 0.740 Vali Acc: 0.861 Test Loss: 0.740 Test Acc: 0.861
Validation loss decreased (-0.791657 --> -0.861104).  Saving model ...
Epoch: 7 cost time: 0.6618936061859131
Epoch: 7, Steps: 7 | Train Loss: 0.400 Vali Loss: 0.562 Vali Acc: 0.889 Test Loss: 0.562 Test Acc: 0.889
Validation loss decreased (-0.861104 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 0.7094671726226807
Epoch: 8, Steps: 7 | Train Loss: 0.269 Vali Loss: 0.453 Vali Acc: 0.861 Test Loss: 0.453 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7202534675598145
Epoch: 9, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.6504724025726318
Epoch: 10, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 0.6753976345062256
Epoch: 11, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.5923538208007812
Epoch: 12, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.5853571891784668
Epoch: 13, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.7412416934967041
Epoch: 14, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.6492164134979248
Epoch: 15, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6491038799285889
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7291455268859863
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6412220001220703
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7288691997528076
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.585174560546875
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7206509113311768
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7668755054473877
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7409169673919678
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6800663471221924
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 96780
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df64_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2894513607025146
Epoch: 1, Steps: 7 | Train Loss: 2.587 Vali Loss: 2.593 Vali Acc: 0.042 Test Loss: 2.593 Test Acc: 0.042
Validation loss decreased (inf --> -0.041641).  Saving model ...
Epoch: 2 cost time: 0.6721189022064209
Epoch: 2, Steps: 7 | Train Loss: 2.436 Vali Loss: 2.342 Vali Acc: 0.125 Test Loss: 2.342 Test Acc: 0.125
Validation loss decreased (-0.041641 --> -0.124977).  Saving model ...
Epoch: 3 cost time: 0.6308341026306152
Epoch: 3, Steps: 7 | Train Loss: 2.151 Vali Loss: 2.022 Vali Acc: 0.403 Test Loss: 2.022 Test Acc: 0.403
Validation loss decreased (-0.124977 --> -0.402758).  Saving model ...
Epoch: 4 cost time: 0.694511890411377
Epoch: 4, Steps: 7 | Train Loss: 1.756 Vali Loss: 1.682 Vali Acc: 0.639 Test Loss: 1.682 Test Acc: 0.639
Validation loss decreased (-0.402758 --> -0.638872).  Saving model ...
Epoch: 5 cost time: 0.7272651195526123
Epoch: 5, Steps: 7 | Train Loss: 1.334 Vali Loss: 1.362 Vali Acc: 0.694 Test Loss: 1.362 Test Acc: 0.694
Validation loss decreased (-0.638872 --> -0.694431).  Saving model ...
Epoch: 6 cost time: 0.6735243797302246
Epoch: 6, Steps: 7 | Train Loss: 0.975 Vali Loss: 1.076 Vali Acc: 0.792 Test Loss: 1.076 Test Acc: 0.792
Validation loss decreased (-0.694431 --> -0.791656).  Saving model ...
Epoch: 7 cost time: 0.7123363018035889
Epoch: 7, Steps: 7 | Train Loss: 0.745 Vali Loss: 0.859 Vali Acc: 0.806 Test Loss: 0.859 Test Acc: 0.806
Validation loss decreased (-0.791656 --> -0.805547).  Saving model ...
Epoch: 8 cost time: 0.6131851673126221
Epoch: 8, Steps: 7 | Train Loss: 0.492 Vali Loss: 0.717 Vali Acc: 0.847 Test Loss: 0.717 Test Acc: 0.847
Validation loss decreased (-0.805547 --> -0.847215).  Saving model ...
Epoch: 9 cost time: 0.6188943386077881
Epoch: 9, Steps: 7 | Train Loss: 0.317 Vali Loss: 0.604 Vali Acc: 0.847 Test Loss: 0.604 Test Acc: 0.847
Validation loss decreased (-0.847215 --> -0.847216).  Saving model ...
Epoch: 10 cost time: 0.6181416511535645
Epoch: 10, Steps: 7 | Train Loss: 0.226 Vali Loss: 0.510 Vali Acc: 0.875 Test Loss: 0.510 Test Acc: 0.875
Validation loss decreased (-0.847216 --> -0.874995).  Saving model ...
Epoch: 11 cost time: 0.6361255645751953
Epoch: 11, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.441 Vali Acc: 0.889 Test Loss: 0.441 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 0.684913158416748
Epoch: 12, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.403 Vali Acc: 0.875 Test Loss: 0.403 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6935718059539795
Epoch: 13, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.396 Vali Acc: 0.861 Test Loss: 0.396 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6174728870391846
Epoch: 14, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6751339435577393
Epoch: 15, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7279467582702637
Epoch: 16, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7529428005218506
Epoch: 17, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6353223323822021
Epoch: 18, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.6633481979370117
Epoch: 19, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6849203109741211
Epoch: 20, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7642560005187988
Epoch: 21, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.6594269275665283
Epoch: 22, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.65627121925354
Epoch: 23, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7474737167358398
Epoch: 24, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7810332775115967
Epoch: 25, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7093548774719238
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6506562232971191
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.6115403175354004
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.5964887142181396
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.7014124393463135
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5946235656738281
Epoch: 31, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.555523157119751
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6300160884857178
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.275 Vali Acc: 0.875 Test Loss: 0.275 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6231462955474854
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.273 Vali Acc: 0.875 Test Loss: 0.273 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6094729900360107
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.273 Vali Acc: 0.875 Test Loss: 0.273 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6421191692352295
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.273 Vali Acc: 0.875 Test Loss: 0.273 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6241581439971924
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.271 Vali Acc: 0.875 Test Loss: 0.271 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6713857650756836
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 0.671623706817627
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 0.6164641380310059
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 41 cost time: 0.6619718074798584
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 0.6582212448120117
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6575508117675781
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.875 Test Loss: 0.261 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6358435153961182
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.875 Test Loss: 0.260 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6312637329101562
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 0.5591843128204346
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 47 cost time: 0.6395041942596436
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 48 cost time: 0.6036937236785889
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 49 cost time: 0.6191210746765137
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 50 cost time: 0.6538689136505127
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 51 cost time: 0.5766916275024414
Epoch: 51, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.655846118927002
Epoch: 52, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6170899868011475
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.6611928939819336
Epoch: 54, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 55 cost time: 0.6633923053741455
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 56 cost time: 0.722527265548706
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 57 cost time: 0.6288249492645264
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 58 cost time: 0.6199822425842285
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6542468070983887
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 60 cost time: 0.6884839534759521
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 61 cost time: 0.6981902122497559
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.705935001373291
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 63 cost time: 0.7833478450775146
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6225564479827881
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 65 cost time: 0.6589272022247314
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 66 cost time: 0.6046013832092285
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 67 cost time: 0.6506171226501465
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 68 cost time: 0.5790274143218994
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 69 cost time: 0.6619694232940674
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 70 cost time: 0.6663932800292969
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.6062376499176025
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.6230227947235107
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.580298662185669
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.609260082244873
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.6161959171295166
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.889 Test Loss: 0.239 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 76 cost time: 0.6142780780792236
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.889 Test Loss: 0.238 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888887).  Saving model ...
Epoch: 77 cost time: 0.5651929378509521
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.889 Test Loss: 0.238 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 78 cost time: 0.5323102474212646
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 79 cost time: 0.620816707611084
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.889 Test Loss: 0.238 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.5914759635925293
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 81 cost time: 0.5770883560180664
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 82 cost time: 0.635582447052002
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 83 cost time: 0.6215739250183105
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 84 cost time: 0.6474509239196777
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 85 cost time: 0.6686153411865234
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.7405176162719727
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.6544063091278076
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.6346633434295654
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.6291177272796631
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 0.6082994937896729
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.889 Test Loss: 0.231 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 91 cost time: 0.6720407009124756
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.7135293483734131
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.889 Test Loss: 0.231 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 93 cost time: 0.6810975074768066
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.889 Test Loss: 0.231 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 94 cost time: 0.625495195388794
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.889 Test Loss: 0.230 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 95 cost time: 0.5802726745605469
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 96 cost time: 0.6897068023681641
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.889 Test Loss: 0.230 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.6486556529998779
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 98 cost time: 0.582036018371582
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 99 cost time: 0.6097545623779297
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 100 cost time: 0.6283161640167236
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.889 Test Loss: 0.228 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df64_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 82188
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2363436222076416
Epoch: 1, Steps: 7 | Train Loss: 2.752 Vali Loss: 2.485 Vali Acc: 0.111 Test Loss: 2.485 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.6551764011383057
Epoch: 2, Steps: 7 | Train Loss: 2.508 Vali Loss: 2.290 Vali Acc: 0.222 Test Loss: 2.290 Test Acc: 0.222
Validation loss decreased (-0.111086 --> -0.222199).  Saving model ...
Epoch: 3 cost time: 0.6956672668457031
Epoch: 3, Steps: 7 | Train Loss: 2.252 Vali Loss: 2.017 Vali Acc: 0.458 Test Loss: 2.017 Test Acc: 0.458
Validation loss decreased (-0.222199 --> -0.458313).  Saving model ...
Epoch: 4 cost time: 0.6853244304656982
Epoch: 4, Steps: 7 | Train Loss: 1.874 Vali Loss: 1.714 Vali Acc: 0.597 Test Loss: 1.714 Test Acc: 0.597
Validation loss decreased (-0.458313 --> -0.597205).  Saving model ...
Epoch: 5 cost time: 0.77545166015625
Epoch: 5, Steps: 7 | Train Loss: 1.520 Vali Loss: 1.421 Vali Acc: 0.764 Test Loss: 1.421 Test Acc: 0.764
Validation loss decreased (-0.597205 --> -0.763875).  Saving model ...
Epoch: 6 cost time: 0.666755199432373
Epoch: 6, Steps: 7 | Train Loss: 1.113 Vali Loss: 1.168 Vali Acc: 0.792 Test Loss: 1.168 Test Acc: 0.792
Validation loss decreased (-0.763875 --> -0.791655).  Saving model ...
Epoch: 7 cost time: 0.6974644660949707
Epoch: 7, Steps: 7 | Train Loss: 0.844 Vali Loss: 0.959 Vali Acc: 0.778 Test Loss: 0.959 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7515325546264648
Epoch: 8, Steps: 7 | Train Loss: 0.611 Vali Loss: 0.784 Vali Acc: 0.833 Test Loss: 0.784 Test Acc: 0.833
Validation loss decreased (-0.791655 --> -0.833325).  Saving model ...
Epoch: 9 cost time: 0.7103426456451416
Epoch: 9, Steps: 7 | Train Loss: 0.410 Vali Loss: 0.670 Vali Acc: 0.833 Test Loss: 0.670 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 0.6607379913330078
Epoch: 10, Steps: 7 | Train Loss: 0.288 Vali Loss: 0.569 Vali Acc: 0.847 Test Loss: 0.569 Test Acc: 0.847
Validation loss decreased (-0.833327 --> -0.847217).  Saving model ...
Epoch: 11 cost time: 0.6530122756958008
Epoch: 11, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.506 Vali Acc: 0.861 Test Loss: 0.506 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861106).  Saving model ...
Epoch: 12 cost time: 0.638232946395874
Epoch: 12, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.454 Vali Acc: 0.847 Test Loss: 0.454 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6262133121490479
Epoch: 13, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.420 Vali Acc: 0.833 Test Loss: 0.420 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7047898769378662
Epoch: 14, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.411 Vali Acc: 0.847 Test Loss: 0.411 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7124927043914795
Epoch: 15, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.408 Vali Acc: 0.847 Test Loss: 0.408 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7096400260925293
Epoch: 16, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.391 Vali Acc: 0.847 Test Loss: 0.391 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6670792102813721
Epoch: 17, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 18 cost time: 0.6153759956359863
Epoch: 18, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.366 Vali Acc: 0.861 Test Loss: 0.366 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 0.6064724922180176
Epoch: 19, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.359 Vali Acc: 0.861 Test Loss: 0.359 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 20 cost time: 0.7082164287567139
Epoch: 20, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874996).  Saving model ...
Epoch: 21 cost time: 0.5838546752929688
Epoch: 21, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 0.6826269626617432
Epoch: 22, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 23 cost time: 0.7191014289855957
Epoch: 23, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7041630744934082
Epoch: 24, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 25 cost time: 0.591702938079834
Epoch: 25, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.336 Vali Acc: 0.875 Test Loss: 0.336 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 26 cost time: 0.6191422939300537
Epoch: 26, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 27 cost time: 0.687828779220581
Epoch: 27, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 28 cost time: 0.6763014793395996
Epoch: 28, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 29 cost time: 0.6944363117218018
Epoch: 29, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 30 cost time: 0.7128243446350098
Epoch: 30, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 31 cost time: 0.7277538776397705
Epoch: 31, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 32 cost time: 0.68056321144104
Epoch: 32, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.320 Vali Acc: 0.875 Test Loss: 0.320 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6868324279785156
Epoch: 33, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6597511768341064
Epoch: 34, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6534881591796875
Epoch: 35, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7129459381103516
Epoch: 36, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6936821937561035
Epoch: 37, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 38 cost time: 0.6566824913024902
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 0.7392482757568359
Epoch: 39, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 0.6358318328857422
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7665607929229736
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.687934160232544
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6742544174194336
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6702208518981934
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 0.7200064659118652
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 0.7502419948577881
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6626086235046387
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 48 cost time: 0.575524091720581
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6645095348358154
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6824612617492676
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 51 cost time: 0.708646297454834
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 52 cost time: 0.6192753314971924
Epoch: 52, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 53 cost time: 0.6896352767944336
Epoch: 53, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6345295906066895
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5785348415374756
Epoch: 55, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.5989937782287598
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.7037675380706787
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 58 cost time: 0.6743652820587158
Epoch: 58, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6516087055206299
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.6526257991790771
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 61 cost time: 0.6731278896331787
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 62 cost time: 0.6962635517120361
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 63 cost time: 0.6668777465820312
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 64 cost time: 0.6016397476196289
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 65 cost time: 0.6162521839141846
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 66 cost time: 0.6181635856628418
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6217677593231201
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.664874792098999
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.6939709186553955
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.8638041019439697
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.6887950897216797
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.6382639408111572
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.6510770320892334
Epoch: 73, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.7364742755889893
Epoch: 74, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.6616742610931396
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm64_nh16_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 76812
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2674999237060547
Epoch: 1, Steps: 7 | Train Loss: 2.493 Vali Loss: 2.264 Vali Acc: 0.319 Test Loss: 2.264 Test Acc: 0.319
Validation loss decreased (inf --> -0.319422).  Saving model ...
Epoch: 2 cost time: 0.6713259220123291
Epoch: 2, Steps: 7 | Train Loss: 2.099 Vali Loss: 1.801 Vali Acc: 0.556 Test Loss: 1.801 Test Acc: 0.556
Validation loss decreased (-0.319422 --> -0.555538).  Saving model ...
Epoch: 3 cost time: 0.702996015548706
Epoch: 3, Steps: 7 | Train Loss: 1.450 Vali Loss: 1.240 Vali Acc: 0.847 Test Loss: 1.240 Test Acc: 0.847
Validation loss decreased (-0.555538 --> -0.847210).  Saving model ...
Epoch: 4 cost time: 0.6869981288909912
Epoch: 4, Steps: 7 | Train Loss: 0.789 Vali Loss: 0.750 Vali Acc: 0.889 Test Loss: 0.750 Test Acc: 0.889
Validation loss decreased (-0.847210 --> -0.888881).  Saving model ...
Epoch: 5 cost time: 0.6652565002441406
Epoch: 5, Steps: 7 | Train Loss: 0.400 Vali Loss: 0.483 Vali Acc: 0.889 Test Loss: 0.483 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 0.7966034412384033
Epoch: 6, Steps: 7 | Train Loss: 0.167 Vali Loss: 0.380 Vali Acc: 0.917 Test Loss: 0.380 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 0.7017452716827393
Epoch: 7, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.7382025718688965
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.6636710166931152
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.6271395683288574
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 0.655874490737915
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.645763635635376
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.6861016750335693
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.7356207370758057
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.7391674518585205
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.6912219524383545
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.6928715705871582
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.7874770164489746
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7564656734466553
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6792557239532471
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.77451491355896
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7736992835998535
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.732151985168457
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7259893417358398
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.723578691482544
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7526929378509521
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6652734279632568
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.7614560127258301
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 0.669675350189209
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 0.790696382522583
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7577931880950928
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8065629005432129
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7057483196258545
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6796436309814453
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7226593494415283
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 0.6931424140930176
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 0.7383124828338623
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 38 cost time: 0.720435619354248
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 0.710289478302002
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 0.79062819480896
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.6413083076477051
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8703713417053223
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8675112724304199
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8646705150604248
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8742222785949707
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.8462579250335693
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.8316023349761963
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.8240578174591064
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.8283612728118896
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.8309414386749268
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8176274299621582
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7251665592193604
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.7819681167602539
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 54 cost time: 0.7687017917633057
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8313853740692139
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 56 cost time: 0.7856063842773438
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7868094444274902
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.7913362979888916
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.7644064426422119
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.8729727268218994
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.8064789772033691
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 62 cost time: 0.7876245975494385
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7789433002471924
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.7777562141418457
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 65 cost time: 0.8600950241088867
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 66 cost time: 0.809309720993042
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 67 cost time: 0.8717894554138184
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.797309160232544
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 69 cost time: 0.8186261653900146
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 70 cost time: 0.8240926265716553
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 71 cost time: 0.7118027210235596
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 72 cost time: 0.7236669063568115
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.8415603637695312
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.8217110633850098
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.8009779453277588
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.7880358695983887
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.786658763885498
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.7774209976196289
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 79 cost time: 0.9379358291625977
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 80 cost time: 0.8285598754882812
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 81 cost time: 0.8301434516906738
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 82 cost time: 0.7551865577697754
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.8170256614685059
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.8069701194763184
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.8260982036590576
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.8010649681091309
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 87 cost time: 0.8198890686035156
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.7495536804199219
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 0.6920645236968994
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.777601957321167
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 0.8063552379608154
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 0.8220422267913818
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 0.8196694850921631
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 0.7985134124755859
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 0.7944269180297852
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 96 cost time: 0.785330057144165
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 204076
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2907328605651855
Epoch: 1, Steps: 7 | Train Loss: 2.640 Vali Loss: 2.504 Vali Acc: 0.222 Test Loss: 2.504 Test Acc: 0.222
Validation loss decreased (inf --> -0.222197).  Saving model ...
Epoch: 2 cost time: 0.6543359756469727
Epoch: 2, Steps: 7 | Train Loss: 2.289 Vali Loss: 2.125 Vali Acc: 0.403 Test Loss: 2.125 Test Acc: 0.403
Validation loss decreased (-0.222197 --> -0.402757).  Saving model ...
Epoch: 3 cost time: 0.6302549839019775
Epoch: 3, Steps: 7 | Train Loss: 1.880 Vali Loss: 1.672 Vali Acc: 0.653 Test Loss: 1.672 Test Acc: 0.653
Validation loss decreased (-0.402757 --> -0.652761).  Saving model ...
Epoch: 4 cost time: 0.6532115936279297
Epoch: 4, Steps: 7 | Train Loss: 1.351 Vali Loss: 1.209 Vali Acc: 0.806 Test Loss: 1.209 Test Acc: 0.806
Validation loss decreased (-0.652761 --> -0.805543).  Saving model ...
Epoch: 5 cost time: 0.7480332851409912
Epoch: 5, Steps: 7 | Train Loss: 0.915 Vali Loss: 0.837 Vali Acc: 0.875 Test Loss: 0.837 Test Acc: 0.875
Validation loss decreased (-0.805543 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.641521692276001
Epoch: 6, Steps: 7 | Train Loss: 0.500 Vali Loss: 0.609 Vali Acc: 0.903 Test Loss: 0.609 Test Acc: 0.903
Validation loss decreased (-0.874992 --> -0.902772).  Saving model ...
Epoch: 7 cost time: 0.6237034797668457
Epoch: 7, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.424 Vali Acc: 0.931 Test Loss: 0.424 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930551).  Saving model ...
Epoch: 8 cost time: 0.6542046070098877
Epoch: 8, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.365 Vali Acc: 0.903 Test Loss: 0.365 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6359550952911377
Epoch: 9, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6881663799285889
Epoch: 10, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6276030540466309
Epoch: 11, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6165711879730225
Epoch: 12, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6189398765563965
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6027977466583252
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6430110931396484
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6491942405700684
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6849217414855957
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.6819667816162109
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6907243728637695
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7107689380645752
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6731212139129639
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.63144850730896
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.6750450134277344
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.6179132461547852
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.7245473861694336
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.6508398056030273
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.6131858825683594
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.6534514427185059
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6022062301635742
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5768582820892334
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.5943789482116699
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6479170322418213
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5777018070220947
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6230514049530029
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6279447078704834
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6034350395202637
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5632824897766113
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7582964897155762
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5924947261810303
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6247129440307617
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.6262075901031494
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.6842324733734131
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7089951038360596
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7137017250061035
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.651677131652832
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7206885814666748
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7484652996063232
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.845142126083374
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6343283653259277
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6027019023895264
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.6712229251861572
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 112876
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.274522304534912
Epoch: 1, Steps: 7 | Train Loss: 2.715 Vali Loss: 2.418 Vali Acc: 0.208 Test Loss: 2.418 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.6384034156799316
Epoch: 2, Steps: 7 | Train Loss: 2.430 Vali Loss: 2.140 Vali Acc: 0.361 Test Loss: 2.140 Test Acc: 0.361
Validation loss decreased (-0.208309 --> -0.361090).  Saving model ...
Epoch: 3 cost time: 0.679772138595581
Epoch: 3, Steps: 7 | Train Loss: 2.070 Vali Loss: 1.776 Vali Acc: 0.639 Test Loss: 1.776 Test Acc: 0.639
Validation loss decreased (-0.361090 --> -0.638871).  Saving model ...
Epoch: 4 cost time: 0.7186570167541504
Epoch: 4, Steps: 7 | Train Loss: 1.595 Vali Loss: 1.380 Vali Acc: 0.736 Test Loss: 1.380 Test Acc: 0.736
Validation loss decreased (-0.638871 --> -0.736097).  Saving model ...
Epoch: 5 cost time: 0.6755683422088623
Epoch: 5, Steps: 7 | Train Loss: 1.137 Vali Loss: 1.005 Vali Acc: 0.792 Test Loss: 1.005 Test Acc: 0.792
Validation loss decreased (-0.736097 --> -0.791657).  Saving model ...
Epoch: 6 cost time: 0.6918525695800781
Epoch: 6, Steps: 7 | Train Loss: 0.723 Vali Loss: 0.733 Vali Acc: 0.889 Test Loss: 0.733 Test Acc: 0.889
Validation loss decreased (-0.791657 --> -0.888882).  Saving model ...
Epoch: 7 cost time: 0.6740171909332275
Epoch: 7, Steps: 7 | Train Loss: 0.441 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7029309272766113
Epoch: 8, Steps: 7 | Train Loss: 0.257 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.6952347755432129
Epoch: 9, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.335 Vali Acc: 0.958 Test Loss: 0.335 Test Acc: 0.958
Validation loss decreased (-0.888885 --> -0.958330).  Saving model ...
Epoch: 10 cost time: 0.6382522583007812
Epoch: 10, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.736351728439331
Epoch: 11, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6635804176330566
Epoch: 12, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8222386837005615
Epoch: 13, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7613484859466553
Epoch: 14, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7165884971618652
Epoch: 15, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5983805656433105
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7093193531036377
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8851146697998047
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6711101531982422
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 83884
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df256_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2030155658721924
Epoch: 1, Steps: 7 | Train Loss: 2.656 Vali Loss: 2.597 Vali Acc: 0.042 Test Loss: 2.597 Test Acc: 0.042
Validation loss decreased (inf --> -0.041641).  Saving model ...
Epoch: 2 cost time: 0.5752074718475342
Epoch: 2, Steps: 7 | Train Loss: 2.455 Vali Loss: 2.319 Vali Acc: 0.208 Test Loss: 2.319 Test Acc: 0.208
Validation loss decreased (-0.041641 --> -0.208310).  Saving model ...
Epoch: 3 cost time: 0.6088545322418213
Epoch: 3, Steps: 7 | Train Loss: 2.183 Vali Loss: 1.982 Vali Acc: 0.514 Test Loss: 1.982 Test Acc: 0.514
Validation loss decreased (-0.208310 --> -0.513869).  Saving model ...
Epoch: 4 cost time: 0.8802065849304199
Epoch: 4, Steps: 7 | Train Loss: 1.705 Vali Loss: 1.637 Vali Acc: 0.667 Test Loss: 1.637 Test Acc: 0.667
Validation loss decreased (-0.513869 --> -0.666650).  Saving model ...
Epoch: 5 cost time: 0.6201975345611572
Epoch: 5, Steps: 7 | Train Loss: 1.324 Vali Loss: 1.315 Vali Acc: 0.750 Test Loss: 1.315 Test Acc: 0.750
Validation loss decreased (-0.666650 --> -0.749987).  Saving model ...
Epoch: 6 cost time: 0.7112772464752197
Epoch: 6, Steps: 7 | Train Loss: 1.022 Vali Loss: 1.029 Vali Acc: 0.806 Test Loss: 1.029 Test Acc: 0.806
Validation loss decreased (-0.749987 --> -0.805545).  Saving model ...
Epoch: 7 cost time: 0.6268994808197021
Epoch: 7, Steps: 7 | Train Loss: 0.680 Vali Loss: 0.790 Vali Acc: 0.875 Test Loss: 0.790 Test Acc: 0.875
Validation loss decreased (-0.805545 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 0.6594576835632324
Epoch: 8, Steps: 7 | Train Loss: 0.453 Vali Loss: 0.636 Vali Acc: 0.875 Test Loss: 0.636 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 0.6987385749816895
Epoch: 9, Steps: 7 | Train Loss: 0.280 Vali Loss: 0.523 Vali Acc: 0.875 Test Loss: 0.523 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 10 cost time: 0.6949648857116699
Epoch: 10, Steps: 7 | Train Loss: 0.187 Vali Loss: 0.431 Vali Acc: 0.903 Test Loss: 0.431 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902773).  Saving model ...
Epoch: 11 cost time: 0.674382209777832
Epoch: 11, Steps: 7 | Train Loss: 0.114 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6667141914367676
Epoch: 12, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5875105857849121
Epoch: 13, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 0.6460294723510742
Epoch: 14, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 0.675382137298584
Epoch: 15, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.6802365779876709
Epoch: 16, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.7017161846160889
Epoch: 17, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.7160582542419434
Epoch: 18, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6752338409423828
Epoch: 19, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.7940928936004639
Epoch: 20, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.6052937507629395
Epoch: 21, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.6504335403442383
Epoch: 22, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.6856136322021484
Epoch: 23, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.7004406452178955
Epoch: 24, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6572296619415283
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.6488292217254639
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.6950461864471436
Epoch: 27, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.5857415199279785
Epoch: 28, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.7893292903900146
Epoch: 29, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.7498757839202881
Epoch: 30, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.6664376258850098
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.6430690288543701
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.7022676467895508
Epoch: 33, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.639972448348999
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.6475632190704346
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.6885144710540771
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.6240808963775635
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.5663766860961914
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.7140252590179443
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6002559661865234
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6892681121826172
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.6589646339416504
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.6778311729431152
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.618600606918335
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5808744430541992
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.6486012935638428
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.6159090995788574
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.7511749267578125
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.6836178302764893
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.5880372524261475
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.7036082744598389
Epoch: 51, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6365921497344971
Epoch: 52, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 53 cost time: 0.6616556644439697
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.667973518371582
Epoch: 54, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 55 cost time: 0.6524817943572998
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 56 cost time: 0.6744375228881836
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 57 cost time: 0.5940229892730713
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7197208404541016
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.6261963844299316
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 60 cost time: 0.6263983249664307
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 61 cost time: 0.5744016170501709
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 62 cost time: 0.6634752750396729
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 63 cost time: 0.7223532199859619
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 64 cost time: 0.6491835117340088
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 65 cost time: 0.6321852207183838
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.903 Test Loss: 0.218 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 66 cost time: 0.6178183555603027
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.902776 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 0.6385140419006348
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 68 cost time: 0.6118271350860596
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 69 cost time: 0.6782829761505127
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930553).  Saving model ...
Epoch: 70 cost time: 0.6707363128662109
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.695439338684082
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 72 cost time: 0.660700798034668
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.6327855587005615
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.6566321849822998
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.6579997539520264
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.6042788028717041
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.6626801490783691
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.6700284481048584
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.7131705284118652
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 80 cost time: 0.7190077304840088
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.6447081565856934
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.6864814758300781
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.6138186454772949
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.7045989036560059
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 85 cost time: 0.69576096534729
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 86 cost time: 0.7915401458740234
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 87 cost time: 0.6644628047943115
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 88 cost time: 0.7256665229797363
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.6630909442901611
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.6726689338684082
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 0.6817238330841064
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 0.6026389598846436
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 0.6222424507141113
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 0.7080450057983398
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 0.7255654335021973
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 0.6541640758514404
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 0.6941099166870117
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df256_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 68716
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.17962908744812
Epoch: 1, Steps: 7 | Train Loss: 2.515 Vali Loss: 2.416 Vali Acc: 0.194 Test Loss: 2.416 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 0.6314771175384521
Epoch: 2, Steps: 7 | Train Loss: 2.419 Vali Loss: 2.253 Vali Acc: 0.264 Test Loss: 2.253 Test Acc: 0.264
Validation loss decreased (-0.194420 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 0.6416628360748291
Epoch: 3, Steps: 7 | Train Loss: 2.141 Vali Loss: 2.026 Vali Acc: 0.472 Test Loss: 2.026 Test Acc: 0.472
Validation loss decreased (-0.263866 --> -0.472202).  Saving model ...
Epoch: 4 cost time: 0.6794624328613281
Epoch: 4, Steps: 7 | Train Loss: 1.887 Vali Loss: 1.759 Vali Acc: 0.653 Test Loss: 1.759 Test Acc: 0.653
Validation loss decreased (-0.472202 --> -0.652760).  Saving model ...
Epoch: 5 cost time: 0.6473801136016846
Epoch: 5, Steps: 7 | Train Loss: 1.571 Vali Loss: 1.482 Vali Acc: 0.764 Test Loss: 1.482 Test Acc: 0.764
Validation loss decreased (-0.652760 --> -0.763874).  Saving model ...
Epoch: 6 cost time: 0.6052234172821045
Epoch: 6, Steps: 7 | Train Loss: 1.244 Vali Loss: 1.220 Vali Acc: 0.792 Test Loss: 1.220 Test Acc: 0.792
Validation loss decreased (-0.763874 --> -0.791654).  Saving model ...
Epoch: 7 cost time: 0.667689323425293
Epoch: 7, Steps: 7 | Train Loss: 0.982 Vali Loss: 0.985 Vali Acc: 0.819 Test Loss: 0.985 Test Acc: 0.819
Validation loss decreased (-0.791654 --> -0.819435).  Saving model ...
Epoch: 8 cost time: 0.710524320602417
Epoch: 8, Steps: 7 | Train Loss: 0.723 Vali Loss: 0.786 Vali Acc: 0.861 Test Loss: 0.786 Test Acc: 0.861
Validation loss decreased (-0.819435 --> -0.861103).  Saving model ...
Epoch: 9 cost time: 0.6300344467163086
Epoch: 9, Steps: 7 | Train Loss: 0.523 Vali Loss: 0.633 Vali Acc: 0.875 Test Loss: 0.633 Test Acc: 0.875
Validation loss decreased (-0.861103 --> -0.874994).  Saving model ...
Epoch: 10 cost time: 0.6631772518157959
Epoch: 10, Steps: 7 | Train Loss: 0.380 Vali Loss: 0.522 Vali Acc: 0.875 Test Loss: 0.522 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 11 cost time: 0.682816743850708
Epoch: 11, Steps: 7 | Train Loss: 0.245 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 12 cost time: 0.6397860050201416
Epoch: 12, Steps: 7 | Train Loss: 0.176 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 13 cost time: 0.6520345211029053
Epoch: 13, Steps: 7 | Train Loss: 0.122 Vali Loss: 0.366 Vali Acc: 0.889 Test Loss: 0.366 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.6817760467529297
Epoch: 14, Steps: 7 | Train Loss: 0.096 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 0.536022424697876
Epoch: 15, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 0.5950684547424316
Epoch: 16, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.5807981491088867
Epoch: 17, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.5961019992828369
Epoch: 18, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.6000280380249023
Epoch: 19, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.6282901763916016
Epoch: 20, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.662405252456665
Epoch: 21, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.695737361907959
Epoch: 22, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.7002596855163574
Epoch: 23, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.6151015758514404
Epoch: 24, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.6336956024169922
Epoch: 25, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6397240161895752
Epoch: 26, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5808818340301514
Epoch: 27, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.6323342323303223
Epoch: 28, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.6340177059173584
Epoch: 29, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.6182751655578613
Epoch: 30, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.5993366241455078
Epoch: 31, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6874752044677734
Epoch: 32, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.763775110244751
Epoch: 33, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.6772875785827637
Epoch: 34, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6406354904174805
Epoch: 35, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7130131721496582
Epoch: 36, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.6386024951934814
Epoch: 37, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.6409237384796143
Epoch: 38, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.6089749336242676
Epoch: 39, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.5875132083892822
Epoch: 40, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.5817215442657471
Epoch: 41, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.70853590965271
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6137499809265137
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.6538131237030029
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.6894450187683105
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.6602194309234619
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6680335998535156
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.6341311931610107
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7094259262084961
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.6537148952484131
Epoch: 50, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 0.7043139934539795
Epoch: 51, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.6533055305480957
Epoch: 52, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 0.7088749408721924
Epoch: 53, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 0.6614646911621094
Epoch: 54, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 0.6343297958374023
Epoch: 55, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7042944431304932
Epoch: 56, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 0.6077980995178223
Epoch: 57, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 0.6397180557250977
Epoch: 58, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5777044296264648
Epoch: 59, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.688370943069458
Epoch: 60, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.6116232872009277
Epoch: 61, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.5722322463989258
Epoch: 62, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.6295671463012695
Epoch: 63, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.7000186443328857
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.6131422519683838
Epoch: 65, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.6300301551818848
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.6276648044586182
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 56812
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df256_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.232983112335205
Epoch: 1, Steps: 7 | Train Loss: 2.537 Vali Loss: 2.487 Vali Acc: 0.083 Test Loss: 2.487 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.6758854389190674
Epoch: 2, Steps: 7 | Train Loss: 2.446 Vali Loss: 2.372 Vali Acc: 0.264 Test Loss: 2.372 Test Acc: 0.264
Validation loss decreased (-0.083308 --> -0.263865).  Saving model ...
Epoch: 3 cost time: 0.6277823448181152
Epoch: 3, Steps: 7 | Train Loss: 2.218 Vali Loss: 2.204 Vali Acc: 0.403 Test Loss: 2.204 Test Acc: 0.403
Validation loss decreased (-0.263865 --> -0.402756).  Saving model ...
Epoch: 4 cost time: 0.6625595092773438
Epoch: 4, Steps: 7 | Train Loss: 2.082 Vali Loss: 2.004 Vali Acc: 0.486 Test Loss: 2.004 Test Acc: 0.486
Validation loss decreased (-0.402756 --> -0.486091).  Saving model ...
Epoch: 5 cost time: 0.6202619075775146
Epoch: 5, Steps: 7 | Train Loss: 1.808 Vali Loss: 1.783 Vali Acc: 0.556 Test Loss: 1.783 Test Acc: 0.556
Validation loss decreased (-0.486091 --> -0.555538).  Saving model ...
Epoch: 6 cost time: 0.611598014831543
Epoch: 6, Steps: 7 | Train Loss: 1.543 Vali Loss: 1.556 Vali Acc: 0.625 Test Loss: 1.556 Test Acc: 0.625
Validation loss decreased (-0.555538 --> -0.624984).  Saving model ...
Epoch: 7 cost time: 0.6133782863616943
Epoch: 7, Steps: 7 | Train Loss: 1.309 Vali Loss: 1.346 Vali Acc: 0.681 Test Loss: 1.346 Test Acc: 0.681
Validation loss decreased (-0.624984 --> -0.680542).  Saving model ...
Epoch: 8 cost time: 0.6735799312591553
Epoch: 8, Steps: 7 | Train Loss: 1.059 Vali Loss: 1.139 Vali Acc: 0.736 Test Loss: 1.139 Test Acc: 0.736
Validation loss decreased (-0.680542 --> -0.736100).  Saving model ...
Epoch: 9 cost time: 0.608633279800415
Epoch: 9, Steps: 7 | Train Loss: 0.792 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
Validation loss decreased (-0.736100 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 0.6175203323364258
Epoch: 10, Steps: 7 | Train Loss: 0.624 Vali Loss: 0.811 Vali Acc: 0.806 Test Loss: 0.811 Test Acc: 0.806
Validation loss decreased (-0.749990 --> -0.805547).  Saving model ...
Epoch: 11 cost time: 0.6897685527801514
Epoch: 11, Steps: 7 | Train Loss: 0.466 Vali Loss: 0.692 Vali Acc: 0.833 Test Loss: 0.692 Test Acc: 0.833
Validation loss decreased (-0.805547 --> -0.833326).  Saving model ...
Epoch: 12 cost time: 0.6655552387237549
Epoch: 12, Steps: 7 | Train Loss: 0.340 Vali Loss: 0.602 Vali Acc: 0.847 Test Loss: 0.602 Test Acc: 0.847
Validation loss decreased (-0.833326 --> -0.847216).  Saving model ...
Epoch: 13 cost time: 0.6518464088439941
Epoch: 13, Steps: 7 | Train Loss: 0.266 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861106).  Saving model ...
Epoch: 14 cost time: 0.6125068664550781
Epoch: 14, Steps: 7 | Train Loss: 0.193 Vali Loss: 0.519 Vali Acc: 0.833 Test Loss: 0.519 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6685550212860107
Epoch: 15, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.475 Vali Acc: 0.861 Test Loss: 0.475 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 16 cost time: 0.6709749698638916
Epoch: 16, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.442 Vali Acc: 0.861 Test Loss: 0.442 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 17 cost time: 0.6485323905944824
Epoch: 17, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 18 cost time: 0.548142671585083
Epoch: 18, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.404 Vali Acc: 0.861 Test Loss: 0.404 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 0.5574989318847656
Epoch: 19, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 0.6474816799163818
Epoch: 20, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.393 Vali Acc: 0.889 Test Loss: 0.393 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 21 cost time: 0.6558020114898682
Epoch: 21, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 22 cost time: 0.6264133453369141
Epoch: 22, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.6360204219818115
Epoch: 23, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6718552112579346
Epoch: 24, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 25 cost time: 0.6778008937835693
Epoch: 25, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.352 Vali Acc: 0.903 Test Loss: 0.352 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 26 cost time: 0.6584634780883789
Epoch: 26, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 27 cost time: 0.6479182243347168
Epoch: 27, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 28 cost time: 0.659804105758667
Epoch: 28, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 29 cost time: 0.6377410888671875
Epoch: 29, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 30 cost time: 0.6689317226409912
Epoch: 30, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.5486311912536621
Epoch: 31, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.6855614185333252
Epoch: 32, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.6136808395385742
Epoch: 33, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.6445455551147461
Epoch: 34, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.6848940849304199
Epoch: 35, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.600557804107666
Epoch: 36, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.6134500503540039
Epoch: 37, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.6801338195800781
Epoch: 38, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.6673109531402588
Epoch: 39, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.6070468425750732
Epoch: 40, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.6150157451629639
Epoch: 41, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.579033613204956
Epoch: 42, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.5735585689544678
Epoch: 43, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.6206953525543213
Epoch: 44, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.6768491268157959
Epoch: 45, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.6471359729766846
Epoch: 46, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.5800106525421143
Epoch: 47, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.7455031871795654
Epoch: 48, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.6596293449401855
Epoch: 49, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.6289308071136475
Epoch: 50, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.5853292942047119
Epoch: 51, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.5768094062805176
Epoch: 52, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.6446382999420166
Epoch: 53, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6483500003814697
Epoch: 54, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.6764707565307617
Epoch: 55, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.7031514644622803
Epoch: 56, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 57 cost time: 0.6772937774658203
Epoch: 57, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 0.7488200664520264
Epoch: 58, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6638941764831543
Epoch: 59, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 60 cost time: 0.631784200668335
Epoch: 60, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.6668343544006348
Epoch: 61, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.6232395172119141
Epoch: 62, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 0.5849566459655762
Epoch: 63, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6974494457244873
Epoch: 64, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 0.553626298904419
Epoch: 65, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.6961934566497803
Epoch: 66, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.5689842700958252
Epoch: 67, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.641165018081665
Epoch: 68, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.5619916915893555
Epoch: 69, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.6087701320648193
Epoch: 70, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.661022424697876
Epoch: 71, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.6604108810424805
Epoch: 72, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.6582682132720947
Epoch: 73, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.6515591144561768
Epoch: 74, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df256_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 49516
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1912331581115723
Epoch: 1, Steps: 7 | Train Loss: 2.688 Vali Loss: 2.581 Vali Acc: 0.083 Test Loss: 2.581 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.7188644409179688
Epoch: 2, Steps: 7 | Train Loss: 2.691 Vali Loss: 2.458 Vali Acc: 0.153 Test Loss: 2.458 Test Acc: 0.153
Validation loss decreased (-0.083308 --> -0.152753).  Saving model ...
Epoch: 3 cost time: 0.6228561401367188
Epoch: 3, Steps: 7 | Train Loss: 2.441 Vali Loss: 2.289 Vali Acc: 0.250 Test Loss: 2.289 Test Acc: 0.250
Validation loss decreased (-0.152753 --> -0.249977).  Saving model ...
Epoch: 4 cost time: 0.6387636661529541
Epoch: 4, Steps: 7 | Train Loss: 2.292 Vali Loss: 2.088 Vali Acc: 0.361 Test Loss: 2.088 Test Acc: 0.361
Validation loss decreased (-0.249977 --> -0.361090).  Saving model ...
Epoch: 5 cost time: 0.640200138092041
Epoch: 5, Steps: 7 | Train Loss: 2.009 Vali Loss: 1.883 Vali Acc: 0.528 Test Loss: 1.883 Test Acc: 0.528
Validation loss decreased (-0.361090 --> -0.527759).  Saving model ...
Epoch: 6 cost time: 0.6054396629333496
Epoch: 6, Steps: 7 | Train Loss: 1.774 Vali Loss: 1.671 Vali Acc: 0.639 Test Loss: 1.671 Test Acc: 0.639
Validation loss decreased (-0.527759 --> -0.638872).  Saving model ...
Epoch: 7 cost time: 0.6792757511138916
Epoch: 7, Steps: 7 | Train Loss: 1.491 Vali Loss: 1.466 Vali Acc: 0.653 Test Loss: 1.466 Test Acc: 0.653
Validation loss decreased (-0.638872 --> -0.652763).  Saving model ...
Epoch: 8 cost time: 0.7463645935058594
Epoch: 8, Steps: 7 | Train Loss: 1.276 Vali Loss: 1.264 Vali Acc: 0.764 Test Loss: 1.264 Test Acc: 0.764
Validation loss decreased (-0.652763 --> -0.763876).  Saving model ...
Epoch: 9 cost time: 0.6540749073028564
Epoch: 9, Steps: 7 | Train Loss: 1.043 Vali Loss: 1.070 Vali Acc: 0.806 Test Loss: 1.070 Test Acc: 0.806
Validation loss decreased (-0.763876 --> -0.805545).  Saving model ...
Epoch: 10 cost time: 0.6265673637390137
Epoch: 10, Steps: 7 | Train Loss: 0.831 Vali Loss: 0.922 Vali Acc: 0.806 Test Loss: 0.922 Test Acc: 0.806
Validation loss decreased (-0.805545 --> -0.805546).  Saving model ...
Epoch: 11 cost time: 0.628868579864502
Epoch: 11, Steps: 7 | Train Loss: 0.706 Vali Loss: 0.776 Vali Acc: 0.819 Test Loss: 0.776 Test Acc: 0.819
Validation loss decreased (-0.805546 --> -0.819437).  Saving model ...
Epoch: 12 cost time: 0.6149215698242188
Epoch: 12, Steps: 7 | Train Loss: 0.514 Vali Loss: 0.661 Vali Acc: 0.847 Test Loss: 0.661 Test Acc: 0.847
Validation loss decreased (-0.819437 --> -0.847216).  Saving model ...
Epoch: 13 cost time: 0.6926453113555908
Epoch: 13, Steps: 7 | Train Loss: 0.360 Vali Loss: 0.581 Vali Acc: 0.889 Test Loss: 0.581 Test Acc: 0.889
Validation loss decreased (-0.847216 --> -0.888883).  Saving model ...
Epoch: 14 cost time: 0.7014007568359375
Epoch: 14, Steps: 7 | Train Loss: 0.297 Vali Loss: 0.523 Vali Acc: 0.903 Test Loss: 0.523 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902773).  Saving model ...
Epoch: 15 cost time: 0.592374324798584
Epoch: 15, Steps: 7 | Train Loss: 0.239 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6771736145019531
Epoch: 16, Steps: 7 | Train Loss: 0.179 Vali Loss: 0.451 Vali Acc: 0.903 Test Loss: 0.451 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 17 cost time: 0.6072864532470703
Epoch: 17, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.425 Vali Acc: 0.917 Test Loss: 0.425 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916662).  Saving model ...
Epoch: 18 cost time: 0.6239559650421143
Epoch: 18, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.407 Vali Acc: 0.903 Test Loss: 0.407 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6342663764953613
Epoch: 19, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.398 Vali Acc: 0.917 Test Loss: 0.398 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 0.6415624618530273
Epoch: 20, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.380 Vali Acc: 0.903 Test Loss: 0.380 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6528146266937256
Epoch: 21, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.366 Vali Acc: 0.917 Test Loss: 0.366 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 22 cost time: 0.5983896255493164
Epoch: 22, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.359 Vali Acc: 0.931 Test Loss: 0.359 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 23 cost time: 0.6143476963043213
Epoch: 23, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.353 Vali Acc: 0.917 Test Loss: 0.353 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5948727130889893
Epoch: 24, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.341 Vali Acc: 0.931 Test Loss: 0.341 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 25 cost time: 0.6383664608001709
Epoch: 25, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.338 Vali Acc: 0.931 Test Loss: 0.338 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 26 cost time: 0.6274280548095703
Epoch: 26, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.335 Vali Acc: 0.931 Test Loss: 0.335 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 27 cost time: 0.6101195812225342
Epoch: 27, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.333 Vali Acc: 0.931 Test Loss: 0.333 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 28 cost time: 0.6073410511016846
Epoch: 28, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.329 Vali Acc: 0.931 Test Loss: 0.329 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 29 cost time: 0.6888108253479004
Epoch: 29, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.322 Vali Acc: 0.931 Test Loss: 0.322 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 30 cost time: 0.6481881141662598
Epoch: 30, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.316 Vali Acc: 0.931 Test Loss: 0.316 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 31 cost time: 0.6761574745178223
Epoch: 31, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 32 cost time: 0.642845869064331
Epoch: 32, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 33 cost time: 0.6143336296081543
Epoch: 33, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6020433902740479
Epoch: 34, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.309 Vali Acc: 0.931 Test Loss: 0.309 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 35 cost time: 0.7833669185638428
Epoch: 35, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.6282205581665039
Epoch: 36, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.6474893093109131
Epoch: 37, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.6572105884552002
Epoch: 38, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.6571776866912842
Epoch: 39, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.6225886344909668
Epoch: 40, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.6256074905395508
Epoch: 41, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.5837118625640869
Epoch: 42, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.285 Vali Acc: 0.931 Test Loss: 0.285 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.6298069953918457
Epoch: 43, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.7786967754364014
Epoch: 44, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.6526236534118652
Epoch: 45, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.6688098907470703
Epoch: 46, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.6305665969848633
Epoch: 47, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.6452417373657227
Epoch: 48, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.6494238376617432
Epoch: 49, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.6321883201599121
Epoch: 50, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 0.7771148681640625
Epoch: 51, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 0.7354879379272461
Epoch: 52, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 0.5845980644226074
Epoch: 53, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7074990272521973
Epoch: 54, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5948531627655029
Epoch: 55, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 0.7235090732574463
Epoch: 56, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 0.684760570526123
Epoch: 57, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 0.8240952491760254
Epoch: 58, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7253265380859375
Epoch: 59, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.7451574802398682
Epoch: 60, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.7363793849945068
Epoch: 61, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.9320113658905029
Epoch: 62, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.6885955333709717
Epoch: 63, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 64 cost time: 0.7078778743743896
Epoch: 64, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 65 cost time: 0.6704177856445312
Epoch: 65, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.6485066413879395
Epoch: 66, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.7348427772521973
Epoch: 67, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.6375417709350586
Epoch: 68, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.69223952293396
Epoch: 69, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.6284081935882568
Epoch: 70, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.6116271018981934
Epoch: 71, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.6704864501953125
Epoch: 72, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.6083133220672607
Epoch: 73, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.6616072654724121
Epoch: 74, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 46828
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.548417329788208
Epoch: 1, Steps: 7 | Train Loss: 2.550 Vali Loss: 2.443 Vali Acc: 0.181 Test Loss: 2.443 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.6823797225952148
Epoch: 2, Steps: 7 | Train Loss: 2.137 Vali Loss: 1.885 Vali Acc: 0.514 Test Loss: 1.885 Test Acc: 0.514
Validation loss decreased (-0.180531 --> -0.513870).  Saving model ...
Epoch: 3 cost time: 0.7196106910705566
Epoch: 3, Steps: 7 | Train Loss: 1.543 Vali Loss: 1.338 Vali Acc: 0.764 Test Loss: 1.338 Test Acc: 0.764
Validation loss decreased (-0.513870 --> -0.763876).  Saving model ...
Epoch: 4 cost time: 0.704937219619751
Epoch: 4, Steps: 7 | Train Loss: 0.877 Vali Loss: 0.875 Vali Acc: 0.861 Test Loss: 0.875 Test Acc: 0.861
Validation loss decreased (-0.763876 --> -0.861102).  Saving model ...
Epoch: 5 cost time: 0.6590204238891602
Epoch: 5, Steps: 7 | Train Loss: 0.443 Vali Loss: 0.552 Vali Acc: 0.917 Test Loss: 0.552 Test Acc: 0.917
Validation loss decreased (-0.861102 --> -0.916661).  Saving model ...
Epoch: 6 cost time: 0.7253398895263672
Epoch: 6, Steps: 7 | Train Loss: 0.192 Vali Loss: 0.418 Vali Acc: 0.889 Test Loss: 0.418 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7896442413330078
Epoch: 7, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.765256404876709
Epoch: 8, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.308 Vali Acc: 0.931 Test Loss: 0.308 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.7514095306396484
Epoch: 9, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.7968235015869141
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7136659622192383
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7900757789611816
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8458817005157471
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.7714464664459229
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.7781920433044434
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.741135835647583
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.7661118507385254
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.8238711357116699
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.794865608215332
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.6549592018127441
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.8049478530883789
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7296135425567627
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8069076538085938
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7834270000457764
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8964416980743408
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8417401313781738
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.806704044342041
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7182862758636475
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8731503486633301
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7268080711364746
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.8357973098754883
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.7778956890106201
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.6951563358306885
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.7241611480712891
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9864771366119385
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7965555191040039
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.7969350814819336
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.7976000308990479
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.92677903175354
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8182766437530518
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.6885504722595215
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.9074349403381348
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7498528957366943
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.8074581623077393
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.7509548664093018
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7572479248046875
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8668951988220215
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.8341104984283447
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8480250835418701
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7164785861968994
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7862913608551025
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.7705755233764648
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.7373359203338623
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.7433695793151855
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.7562754154205322
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.692253828048706
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.7681539058685303
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 195756
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.329477548599243
Epoch: 1, Steps: 7 | Train Loss: 2.564 Vali Loss: 2.354 Vali Acc: 0.194 Test Loss: 2.354 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 0.6202023029327393
Epoch: 2, Steps: 7 | Train Loss: 2.383 Vali Loss: 2.008 Vali Acc: 0.444 Test Loss: 2.008 Test Acc: 0.444
Validation loss decreased (-0.194421 --> -0.444424).  Saving model ...
Epoch: 3 cost time: 0.6509830951690674
Epoch: 3, Steps: 7 | Train Loss: 1.858 Vali Loss: 1.582 Vali Acc: 0.736 Test Loss: 1.582 Test Acc: 0.736
Validation loss decreased (-0.444424 --> -0.736095).  Saving model ...
Epoch: 4 cost time: 0.6673409938812256
Epoch: 4, Steps: 7 | Train Loss: 1.380 Vali Loss: 1.184 Vali Acc: 0.833 Test Loss: 1.184 Test Acc: 0.833
Validation loss decreased (-0.736095 --> -0.833321).  Saving model ...
Epoch: 5 cost time: 0.624631404876709
Epoch: 5, Steps: 7 | Train Loss: 0.885 Vali Loss: 0.827 Vali Acc: 0.903 Test Loss: 0.827 Test Acc: 0.903
Validation loss decreased (-0.833321 --> -0.902770).  Saving model ...
Epoch: 6 cost time: 0.6023690700531006
Epoch: 6, Steps: 7 | Train Loss: 0.547 Vali Loss: 0.579 Vali Acc: 0.917 Test Loss: 0.579 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916661).  Saving model ...
Epoch: 7 cost time: 0.73502516746521
Epoch: 7, Steps: 7 | Train Loss: 0.310 Vali Loss: 0.440 Vali Acc: 0.917 Test Loss: 0.440 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 0.6622321605682373
Epoch: 8, Steps: 7 | Train Loss: 0.170 Vali Loss: 0.368 Vali Acc: 0.931 Test Loss: 0.368 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.6025815010070801
Epoch: 9, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7375833988189697
Epoch: 10, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6645481586456299
Epoch: 11, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.6564285755157471
Epoch: 12, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.6096880435943604
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.6246979236602783
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6642930507659912
Epoch: 15, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.754326343536377
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.6353311538696289
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.6591641902923584
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.6667125225067139
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.6691091060638428
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.6202638149261475
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7009272575378418
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.6672830581665039
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.6661045551300049
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.6199686527252197
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.6613137722015381
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5628015995025635
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6439926624298096
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6071574687957764
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5686607360839844
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.658254861831665
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.73008131980896
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5915255546569824
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.6264948844909668
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.5874876976013184
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6030466556549072
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5701146125793457
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7477829456329346
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5820479393005371
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.652193546295166
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6725175380706787
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6061875820159912
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6241552829742432
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6265666484832764
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 104556
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2687625885009766
Epoch: 1, Steps: 7 | Train Loss: 2.552 Vali Loss: 2.469 Vali Acc: 0.139 Test Loss: 2.469 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.6628825664520264
Epoch: 2, Steps: 7 | Train Loss: 2.386 Vali Loss: 2.174 Vali Acc: 0.472 Test Loss: 2.174 Test Acc: 0.472
Validation loss decreased (-0.138864 --> -0.472200).  Saving model ...
Epoch: 3 cost time: 0.6730217933654785
Epoch: 3, Steps: 7 | Train Loss: 2.018 Vali Loss: 1.817 Vali Acc: 0.597 Test Loss: 1.817 Test Acc: 0.597
Validation loss decreased (-0.472200 --> -0.597204).  Saving model ...
Epoch: 4 cost time: 0.6163303852081299
Epoch: 4, Steps: 7 | Train Loss: 1.657 Vali Loss: 1.469 Vali Acc: 0.694 Test Loss: 1.469 Test Acc: 0.694
Validation loss decreased (-0.597204 --> -0.694430).  Saving model ...
Epoch: 5 cost time: 0.6437630653381348
Epoch: 5, Steps: 7 | Train Loss: 1.210 Vali Loss: 1.123 Vali Acc: 0.778 Test Loss: 1.123 Test Acc: 0.778
Validation loss decreased (-0.694430 --> -0.777767).  Saving model ...
Epoch: 6 cost time: 0.6125020980834961
Epoch: 6, Steps: 7 | Train Loss: 0.807 Vali Loss: 0.847 Vali Acc: 0.861 Test Loss: 0.847 Test Acc: 0.861
Validation loss decreased (-0.777767 --> -0.861103).  Saving model ...
Epoch: 7 cost time: 0.641333818435669
Epoch: 7, Steps: 7 | Train Loss: 0.519 Vali Loss: 0.653 Vali Acc: 0.875 Test Loss: 0.653 Test Acc: 0.875
Validation loss decreased (-0.861103 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 0.6374785900115967
Epoch: 8, Steps: 7 | Train Loss: 0.324 Vali Loss: 0.518 Vali Acc: 0.903 Test Loss: 0.518 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 0.6738848686218262
Epoch: 9, Steps: 7 | Train Loss: 0.186 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6233072280883789
Epoch: 10, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.384 Vali Acc: 0.917 Test Loss: 0.384 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.6937041282653809
Epoch: 11, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6544439792633057
Epoch: 12, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6260111331939697
Epoch: 13, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.5991880893707275
Epoch: 14, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.7274858951568604
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6680252552032471
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6401166915893555
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.6588778495788574
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.6137361526489258
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.6447255611419678
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.732011079788208
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6617827415466309
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.754645586013794
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6730048656463623
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.6320602893829346
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.634023904800415
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.683868408203125
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.6329424381256104
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7228238582611084
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6571922302246094
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.6269946098327637
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.659705638885498
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.6698145866394043
Epoch: 33, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.6422958374023438
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.6228375434875488
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.6274840831756592
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.7255258560180664
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.6361410617828369
Epoch: 38, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6043000221252441
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5942599773406982
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6783843040466309
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6170094013214111
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6210894584655762
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.6530802249908447
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.5907135009765625
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.64013671875
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.6663877964019775
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7081444263458252
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.7099997997283936
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.7388901710510254
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 0.5476043224334717
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 0.6669576168060303
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 0.6342384815216064
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.7176716327667236
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 0.6707644462585449
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6178240776062012
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.6432976722717285
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.5991017818450928
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6008977890014648
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.6046974658966064
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.6862132549285889
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.658735990524292
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.5922060012817383
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.6104402542114258
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 75564
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df128_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3962080478668213
Epoch: 1, Steps: 7 | Train Loss: 2.724 Vali Loss: 2.597 Vali Acc: 0.125 Test Loss: 2.597 Test Acc: 0.125
Validation loss decreased (inf --> -0.124974).  Saving model ...
Epoch: 2 cost time: 0.6452982425689697
Epoch: 2, Steps: 7 | Train Loss: 2.528 Vali Loss: 2.340 Vali Acc: 0.208 Test Loss: 2.340 Test Acc: 0.208
Validation loss decreased (-0.124974 --> -0.208310).  Saving model ...
Epoch: 3 cost time: 0.7198464870452881
Epoch: 3, Steps: 7 | Train Loss: 2.196 Vali Loss: 1.993 Vali Acc: 0.514 Test Loss: 1.993 Test Acc: 0.514
Validation loss decreased (-0.208310 --> -0.513869).  Saving model ...
Epoch: 4 cost time: 0.6910839080810547
Epoch: 4, Steps: 7 | Train Loss: 1.828 Vali Loss: 1.622 Vali Acc: 0.653 Test Loss: 1.622 Test Acc: 0.653
Validation loss decreased (-0.513869 --> -0.652762).  Saving model ...
Epoch: 5 cost time: 0.6672530174255371
Epoch: 5, Steps: 7 | Train Loss: 1.355 Vali Loss: 1.283 Vali Acc: 0.778 Test Loss: 1.283 Test Acc: 0.778
Validation loss decreased (-0.652762 --> -0.777765).  Saving model ...
Epoch: 6 cost time: 0.6503195762634277
Epoch: 6, Steps: 7 | Train Loss: 1.019 Vali Loss: 0.988 Vali Acc: 0.847 Test Loss: 0.988 Test Acc: 0.847
Validation loss decreased (-0.777765 --> -0.847212).  Saving model ...
Epoch: 7 cost time: 0.6609337329864502
Epoch: 7, Steps: 7 | Train Loss: 0.677 Vali Loss: 0.752 Vali Acc: 0.903 Test Loss: 0.752 Test Acc: 0.903
Validation loss decreased (-0.847212 --> -0.902770).  Saving model ...
Epoch: 8 cost time: 0.6080718040466309
Epoch: 8, Steps: 7 | Train Loss: 0.477 Vali Loss: 0.583 Vali Acc: 0.903 Test Loss: 0.583 Test Acc: 0.903
Validation loss decreased (-0.902770 --> -0.902772).  Saving model ...
Epoch: 9 cost time: 0.5881783962249756
Epoch: 9, Steps: 7 | Train Loss: 0.314 Vali Loss: 0.480 Vali Acc: 0.903 Test Loss: 0.480 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 10 cost time: 0.6510334014892578
Epoch: 10, Steps: 7 | Train Loss: 0.205 Vali Loss: 0.410 Vali Acc: 0.917 Test Loss: 0.410 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.618415117263794
Epoch: 11, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.386 Vali Acc: 0.903 Test Loss: 0.386 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6080129146575928
Epoch: 12, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7714383602142334
Epoch: 13, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 0.6411135196685791
Epoch: 14, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6424274444580078
Epoch: 15, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.6295225620269775
Epoch: 16, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.6644928455352783
Epoch: 17, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.6186342239379883
Epoch: 18, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.6230142116546631
Epoch: 19, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.6680781841278076
Epoch: 20, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.5572819709777832
Epoch: 21, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.5354664325714111
Epoch: 22, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.6351439952850342
Epoch: 23, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.7378957271575928
Epoch: 24, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.5549366474151611
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.702326774597168
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.6897745132446289
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.7851133346557617
Epoch: 28, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.6691763401031494
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.6579198837280273
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.670661449432373
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.6806325912475586
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.6137244701385498
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.7096784114837646
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6484591960906982
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.7339701652526855
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.6932251453399658
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.682354211807251
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.7227678298950195
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.7377336025238037
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7647936344146729
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6731991767883301
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7799324989318848
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6860377788543701
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.6459169387817383
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.6466274261474609
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.6536333560943604
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6088898181915283
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.6660468578338623
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.7010695934295654
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6527771949768066
Epoch: 51, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.6920762062072754
Epoch: 52, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 0.628201961517334
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7360429763793945
Epoch: 54, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.692474365234375
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 0.7296538352966309
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 0.7272307872772217
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.6674158573150635
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6652357578277588
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.6800868511199951
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 0.7568984031677246
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7005126476287842
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.731231689453125
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.8249821662902832
Epoch: 64, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.6746244430541992
Epoch: 65, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.7780778408050537
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.6913068294525146
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.6915061473846436
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.7084786891937256
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 70 cost time: 0.734682559967041
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 71 cost time: 0.717414379119873
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 72 cost time: 0.641878604888916
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 73 cost time: 0.6988317966461182
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 74 cost time: 0.6074633598327637
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.7902987003326416
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.5933480262756348
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.718768835067749
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.6224980354309082
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.597663164138794
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.7308981418609619
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.6969943046569824
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.6662111282348633
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.6444962024688721
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df128_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 60396
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3442118167877197
Epoch: 1, Steps: 7 | Train Loss: 2.744 Vali Loss: 2.588 Vali Acc: 0.069 Test Loss: 2.588 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.5832474231719971
Epoch: 2, Steps: 7 | Train Loss: 2.522 Vali Loss: 2.417 Vali Acc: 0.125 Test Loss: 2.417 Test Acc: 0.125
Validation loss decreased (-0.069419 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 0.6309328079223633
Epoch: 3, Steps: 7 | Train Loss: 2.338 Vali Loss: 2.179 Vali Acc: 0.319 Test Loss: 2.179 Test Acc: 0.319
Validation loss decreased (-0.124976 --> -0.319423).  Saving model ...
Epoch: 4 cost time: 0.6415407657623291
Epoch: 4, Steps: 7 | Train Loss: 2.039 Vali Loss: 1.904 Vali Acc: 0.542 Test Loss: 1.904 Test Acc: 0.542
Validation loss decreased (-0.319423 --> -0.541648).  Saving model ...
Epoch: 5 cost time: 0.6737160682678223
Epoch: 5, Steps: 7 | Train Loss: 1.683 Vali Loss: 1.615 Vali Acc: 0.750 Test Loss: 1.615 Test Acc: 0.750
Validation loss decreased (-0.541648 --> -0.749984).  Saving model ...
Epoch: 6 cost time: 0.6087849140167236
Epoch: 6, Steps: 7 | Train Loss: 1.441 Vali Loss: 1.334 Vali Acc: 0.806 Test Loss: 1.334 Test Acc: 0.806
Validation loss decreased (-0.749984 --> -0.805542).  Saving model ...
Epoch: 7 cost time: 0.7140166759490967
Epoch: 7, Steps: 7 | Train Loss: 1.096 Vali Loss: 1.077 Vali Acc: 0.847 Test Loss: 1.077 Test Acc: 0.847
Validation loss decreased (-0.805542 --> -0.847211).  Saving model ...
Epoch: 8 cost time: 0.7659645080566406
Epoch: 8, Steps: 7 | Train Loss: 0.836 Vali Loss: 0.858 Vali Acc: 0.875 Test Loss: 0.858 Test Acc: 0.875
Validation loss decreased (-0.847211 --> -0.874991).  Saving model ...
Epoch: 9 cost time: 0.6377747058868408
Epoch: 9, Steps: 7 | Train Loss: 0.573 Vali Loss: 0.698 Vali Acc: 0.889 Test Loss: 0.698 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888882).  Saving model ...
Epoch: 10 cost time: 0.7013654708862305
Epoch: 10, Steps: 7 | Train Loss: 0.412 Vali Loss: 0.587 Vali Acc: 0.889 Test Loss: 0.587 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 11 cost time: 0.7094392776489258
Epoch: 11, Steps: 7 | Train Loss: 0.283 Vali Loss: 0.495 Vali Acc: 0.889 Test Loss: 0.495 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 0.7310287952423096
Epoch: 12, Steps: 7 | Train Loss: 0.206 Vali Loss: 0.443 Vali Acc: 0.903 Test Loss: 0.443 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902773).  Saving model ...
Epoch: 13 cost time: 0.6667094230651855
Epoch: 13, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.414 Vali Acc: 0.903 Test Loss: 0.414 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 0.6325881481170654
Epoch: 14, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.389 Vali Acc: 0.903 Test Loss: 0.389 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 0.6317663192749023
Epoch: 15, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 0.7423577308654785
Epoch: 16, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 0.6509084701538086
Epoch: 17, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.335 Vali Acc: 0.903 Test Loss: 0.335 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 18 cost time: 0.6791961193084717
Epoch: 18, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 19 cost time: 0.6624462604522705
Epoch: 19, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 0.75339674949646
Epoch: 20, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.7764310836791992
Epoch: 21, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.6873996257781982
Epoch: 22, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7528262138366699
Epoch: 23, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6764111518859863
Epoch: 24, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7750239372253418
Epoch: 25, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.632739782333374
Epoch: 26, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.797696590423584
Epoch: 27, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6110332012176514
Epoch: 28, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.615567684173584
Epoch: 29, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.6579279899597168
Epoch: 30, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.6001472473144531
Epoch: 31, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6463654041290283
Epoch: 32, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.6278369426727295
Epoch: 33, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.6343910694122314
Epoch: 34, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.5855116844177246
Epoch: 35, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.6484062671661377
Epoch: 36, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.6788666248321533
Epoch: 37, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.7089524269104004
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.6144328117370605
Epoch: 39, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.7086091041564941
Epoch: 40, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.6200509071350098
Epoch: 41, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7935523986816406
Epoch: 42, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7144520282745361
Epoch: 43, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.67645263671875
Epoch: 44, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6318705081939697
Epoch: 45, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.7544074058532715
Epoch: 46, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.6251442432403564
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.655651330947876
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6140804290771484
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6513271331787109
Epoch: 50, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.6502022743225098
Epoch: 51, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.7389934062957764
Epoch: 52, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 0.6332077980041504
Epoch: 53, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.6615536212921143
Epoch: 54, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 0.6467056274414062
Epoch: 55, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 0.660292387008667
Epoch: 56, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 57 cost time: 0.6533150672912598
Epoch: 57, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 58 cost time: 0.6658270359039307
Epoch: 58, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 59 cost time: 0.7224314212799072
Epoch: 59, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7804045677185059
Epoch: 60, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 61 cost time: 0.6958234310150146
Epoch: 61, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 62 cost time: 0.7274906635284424
Epoch: 62, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 63 cost time: 0.6208178997039795
Epoch: 63, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 64 cost time: 0.6203596591949463
Epoch: 64, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.6629128456115723
Epoch: 65, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 66 cost time: 0.6777477264404297
Epoch: 66, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 67 cost time: 0.5683214664459229
Epoch: 67, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 68 cost time: 0.5951330661773682
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 69 cost time: 0.5689167976379395
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.6639034748077393
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.6519463062286377
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.6526763439178467
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.6593413352966309
Epoch: 73, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.6853988170623779
Epoch: 74, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.6133601665496826
Epoch: 75, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 76 cost time: 0.603602409362793
Epoch: 76, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 77 cost time: 0.6837091445922852
Epoch: 77, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.6640803813934326
Epoch: 78, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 79 cost time: 0.6125950813293457
Epoch: 79, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 80 cost time: 0.692936897277832
Epoch: 80, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 81 cost time: 0.6338317394256592
Epoch: 81, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 82 cost time: 0.6700382232666016
Epoch: 82, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 83 cost time: 0.60971999168396
Epoch: 83, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.6820096969604492
Epoch: 84, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 85 cost time: 0.6904644966125488
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.6319394111633301
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 87 cost time: 0.8474686145782471
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 88 cost time: 0.6756973266601562
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 89 cost time: 0.6922495365142822
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 90 cost time: 0.6697196960449219
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 91 cost time: 0.6585586071014404
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 92 cost time: 0.561913251876831
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 93 cost time: 0.7367539405822754
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.6603264808654785
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.5710420608520508
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.7020645141601562
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 97 cost time: 0.5987594127655029
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 98 cost time: 0.6056368350982666
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 99 cost time: 0.6609058380126953
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 100 cost time: 0.7065310478210449
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 48492
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df128_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2102532386779785
Epoch: 1, Steps: 7 | Train Loss: 2.685 Vali Loss: 2.591 Vali Acc: 0.111 Test Loss: 2.591 Test Acc: 0.111
Validation loss decreased (inf --> -0.111085).  Saving model ...
Epoch: 2 cost time: 0.6206305027008057
Epoch: 2, Steps: 7 | Train Loss: 2.560 Vali Loss: 2.453 Vali Acc: 0.111 Test Loss: 2.453 Test Acc: 0.111
Validation loss decreased (-0.111085 --> -0.111087).  Saving model ...
Epoch: 3 cost time: 0.6495933532714844
Epoch: 3, Steps: 7 | Train Loss: 2.352 Vali Loss: 2.267 Vali Acc: 0.194 Test Loss: 2.267 Test Acc: 0.194
Validation loss decreased (-0.111087 --> -0.194422).  Saving model ...
Epoch: 4 cost time: 0.7977457046508789
Epoch: 4, Steps: 7 | Train Loss: 2.204 Vali Loss: 2.053 Vali Acc: 0.347 Test Loss: 2.053 Test Acc: 0.347
Validation loss decreased (-0.194422 --> -0.347202).  Saving model ...
Epoch: 5 cost time: 0.6922793388366699
Epoch: 5, Steps: 7 | Train Loss: 1.896 Vali Loss: 1.827 Vali Acc: 0.528 Test Loss: 1.827 Test Acc: 0.528
Validation loss decreased (-0.347202 --> -0.527760).  Saving model ...
Epoch: 6 cost time: 0.6309483051300049
Epoch: 6, Steps: 7 | Train Loss: 1.674 Vali Loss: 1.594 Vali Acc: 0.556 Test Loss: 1.594 Test Acc: 0.556
Validation loss decreased (-0.527760 --> -0.555540).  Saving model ...
Epoch: 7 cost time: 0.7228391170501709
Epoch: 7, Steps: 7 | Train Loss: 1.320 Vali Loss: 1.372 Vali Acc: 0.653 Test Loss: 1.372 Test Acc: 0.653
Validation loss decreased (-0.555540 --> -0.652764).  Saving model ...
Epoch: 8 cost time: 0.690039873123169
Epoch: 8, Steps: 7 | Train Loss: 1.156 Vali Loss: 1.163 Vali Acc: 0.722 Test Loss: 1.163 Test Acc: 0.722
Validation loss decreased (-0.652764 --> -0.722211).  Saving model ...
Epoch: 9 cost time: 0.6637136936187744
Epoch: 9, Steps: 7 | Train Loss: 0.904 Vali Loss: 0.978 Vali Acc: 0.722 Test Loss: 0.978 Test Acc: 0.722
Validation loss decreased (-0.722211 --> -0.722212).  Saving model ...
Epoch: 10 cost time: 0.7376298904418945
Epoch: 10, Steps: 7 | Train Loss: 0.693 Vali Loss: 0.828 Vali Acc: 0.792 Test Loss: 0.828 Test Acc: 0.792
Validation loss decreased (-0.722212 --> -0.791658).  Saving model ...
Epoch: 11 cost time: 0.687169075012207
Epoch: 11, Steps: 7 | Train Loss: 0.495 Vali Loss: 0.699 Vali Acc: 0.861 Test Loss: 0.699 Test Acc: 0.861
Validation loss decreased (-0.791658 --> -0.861104).  Saving model ...
Epoch: 12 cost time: 0.7189922332763672
Epoch: 12, Steps: 7 | Train Loss: 0.393 Vali Loss: 0.608 Vali Acc: 0.847 Test Loss: 0.608 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6897482872009277
Epoch: 13, Steps: 7 | Train Loss: 0.295 Vali Loss: 0.555 Vali Acc: 0.847 Test Loss: 0.555 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7149844169616699
Epoch: 14, Steps: 7 | Train Loss: 0.225 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 0.6784484386444092
Epoch: 15, Steps: 7 | Train Loss: 0.157 Vali Loss: 0.466 Vali Acc: 0.861 Test Loss: 0.466 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.810504674911499
Epoch: 16, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 0.7402355670928955
Epoch: 17, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 0.6507904529571533
Epoch: 18, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.412 Vali Acc: 0.861 Test Loss: 0.412 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6524202823638916
Epoch: 19, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.390 Vali Acc: 0.861 Test Loss: 0.390 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6800689697265625
Epoch: 20, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.379 Vali Acc: 0.861 Test Loss: 0.379 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6987676620483398
Epoch: 21, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.370 Vali Acc: 0.861 Test Loss: 0.370 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7630250453948975
Epoch: 22, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6380054950714111
Epoch: 23, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7165377140045166
Epoch: 24, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 25 cost time: 0.6371889114379883
Epoch: 25, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 26 cost time: 0.6337451934814453
Epoch: 26, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.6434729099273682
Epoch: 27, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.5980057716369629
Epoch: 28, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.7770941257476807
Epoch: 29, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.6855192184448242
Epoch: 30, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 0.697615385055542
Epoch: 31, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 0.7261631488800049
Epoch: 32, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 0.8451697826385498
Epoch: 33, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 34 cost time: 0.704376220703125
Epoch: 34, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.691953182220459
Epoch: 35, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 0.6332986354827881
Epoch: 36, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.660541296005249
Epoch: 37, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5759515762329102
Epoch: 38, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7035980224609375
Epoch: 39, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.7021255493164062
Epoch: 40, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.7163631916046143
Epoch: 41, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.7233545780181885
Epoch: 42, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.6594054698944092
Epoch: 43, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.7240622043609619
Epoch: 44, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.658092737197876
Epoch: 45, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7355124950408936
Epoch: 46, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.6254458427429199
Epoch: 47, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.8667073249816895
Epoch: 48, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.7091383934020996
Epoch: 49, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.705899715423584
Epoch: 50, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.8282639980316162
Epoch: 51, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.7054460048675537
Epoch: 52, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7691154479980469
Epoch: 53, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6906602382659912
Epoch: 54, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.7904946804046631
Epoch: 55, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.7086544036865234
Epoch: 56, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 57 cost time: 0.7421965599060059
Epoch: 57, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 0.7015104293823242
Epoch: 58, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 59 cost time: 0.6914834976196289
Epoch: 59, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7524387836456299
Epoch: 60, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.6447703838348389
Epoch: 61, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.6571676731109619
Epoch: 62, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.7261316776275635
Epoch: 63, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 64 cost time: 0.7272791862487793
Epoch: 64, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 65 cost time: 0.7079777717590332
Epoch: 65, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 66 cost time: 0.7000329494476318
Epoch: 66, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 67 cost time: 0.7021796703338623
Epoch: 67, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 68 cost time: 0.7250778675079346
Epoch: 68, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 69 cost time: 0.6991257667541504
Epoch: 69, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.6820733547210693
Epoch: 70, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.705517053604126
Epoch: 71, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.7461690902709961
Epoch: 72, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.8684520721435547
Epoch: 73, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 74 cost time: 0.6841940879821777
Epoch: 74, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 75 cost time: 0.6528143882751465
Epoch: 75, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 76 cost time: 0.6443653106689453
Epoch: 76, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 77 cost time: 0.7328090667724609
Epoch: 77, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.6291141510009766
Epoch: 78, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.7419486045837402
Epoch: 79, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.6638572216033936
Epoch: 80, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 81 cost time: 0.6975557804107666
Epoch: 81, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 82 cost time: 0.7201783657073975
Epoch: 82, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 83 cost time: 0.8378314971923828
Epoch: 83, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.7590217590332031
Epoch: 84, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.7858679294586182
Epoch: 85, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 86 cost time: 0.7452654838562012
Epoch: 86, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 87 cost time: 0.7143635749816895
Epoch: 87, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.8052864074707031
Epoch: 88, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 89 cost time: 0.783355712890625
Epoch: 89, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 90 cost time: 0.7492091655731201
Epoch: 90, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.7709169387817383
Epoch: 91, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.7529661655426025
Epoch: 92, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.756488561630249
Epoch: 93, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.7719922065734863
Epoch: 94, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.7483880519866943
Epoch: 95, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 0.6887004375457764
Epoch: 96, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 0.6703410148620605
Epoch: 97, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 98 cost time: 0.6676309108734131
Epoch: 98, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 99 cost time: 0.7385299205780029
Epoch: 99, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df128_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 41196
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6329498291015625
Epoch: 1, Steps: 7 | Train Loss: 2.558 Vali Loss: 2.337 Vali Acc: 0.278 Test Loss: 2.337 Test Acc: 0.278
Validation loss decreased (inf --> -0.277754).  Saving model ...
Epoch: 2 cost time: 0.6957893371582031
Epoch: 2, Steps: 7 | Train Loss: 2.404 Vali Loss: 2.216 Vali Acc: 0.361 Test Loss: 2.216 Test Acc: 0.361
Validation loss decreased (-0.277754 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 0.7236006259918213
Epoch: 3, Steps: 7 | Train Loss: 2.294 Vali Loss: 2.057 Vali Acc: 0.444 Test Loss: 2.057 Test Acc: 0.444
Validation loss decreased (-0.361089 --> -0.444424).  Saving model ...
Epoch: 4 cost time: 0.6972062587738037
Epoch: 4, Steps: 7 | Train Loss: 2.081 Vali Loss: 1.880 Vali Acc: 0.569 Test Loss: 1.880 Test Acc: 0.569
Validation loss decreased (-0.444424 --> -0.569426).  Saving model ...
Epoch: 5 cost time: 0.7008779048919678
Epoch: 5, Steps: 7 | Train Loss: 1.923 Vali Loss: 1.698 Vali Acc: 0.625 Test Loss: 1.698 Test Acc: 0.625
Validation loss decreased (-0.569426 --> -0.624983).  Saving model ...
Epoch: 6 cost time: 0.6516635417938232
Epoch: 6, Steps: 7 | Train Loss: 1.611 Vali Loss: 1.517 Vali Acc: 0.708 Test Loss: 1.517 Test Acc: 0.708
Validation loss decreased (-0.624983 --> -0.708318).  Saving model ...
Epoch: 7 cost time: 0.6361360549926758
Epoch: 7, Steps: 7 | Train Loss: 1.381 Vali Loss: 1.342 Vali Acc: 0.750 Test Loss: 1.342 Test Acc: 0.750
Validation loss decreased (-0.708318 --> -0.749987).  Saving model ...
Epoch: 8 cost time: 0.7928919792175293
Epoch: 8, Steps: 7 | Train Loss: 1.185 Vali Loss: 1.179 Vali Acc: 0.778 Test Loss: 1.179 Test Acc: 0.778
Validation loss decreased (-0.749987 --> -0.777766).  Saving model ...
Epoch: 9 cost time: 0.6749892234802246
Epoch: 9, Steps: 7 | Train Loss: 0.943 Vali Loss: 1.031 Vali Acc: 0.806 Test Loss: 1.031 Test Acc: 0.806
Validation loss decreased (-0.777766 --> -0.805545).  Saving model ...
Epoch: 10 cost time: 0.642953634262085
Epoch: 10, Steps: 7 | Train Loss: 0.761 Vali Loss: 0.909 Vali Acc: 0.819 Test Loss: 0.909 Test Acc: 0.819
Validation loss decreased (-0.805545 --> -0.819435).  Saving model ...
Epoch: 11 cost time: 0.604053258895874
Epoch: 11, Steps: 7 | Train Loss: 0.639 Vali Loss: 0.790 Vali Acc: 0.833 Test Loss: 0.790 Test Acc: 0.833
Validation loss decreased (-0.819435 --> -0.833325).  Saving model ...
Epoch: 12 cost time: 0.6723029613494873
Epoch: 12, Steps: 7 | Train Loss: 0.483 Vali Loss: 0.702 Vali Acc: 0.819 Test Loss: 0.702 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.541877031326294
Epoch: 13, Steps: 7 | Train Loss: 0.349 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833327).  Saving model ...
Epoch: 14 cost time: 0.725365400314331
Epoch: 14, Steps: 7 | Train Loss: 0.305 Vali Loss: 0.578 Vali Acc: 0.847 Test Loss: 0.578 Test Acc: 0.847
Validation loss decreased (-0.833327 --> -0.847216).  Saving model ...
Epoch: 15 cost time: 0.6411323547363281
Epoch: 15, Steps: 7 | Train Loss: 0.236 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6838302612304688
Epoch: 16, Steps: 7 | Train Loss: 0.182 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861106).  Saving model ...
Epoch: 17 cost time: 0.6340138912200928
Epoch: 17, Steps: 7 | Train Loss: 0.160 Vali Loss: 0.489 Vali Acc: 0.861 Test Loss: 0.489 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 18 cost time: 0.7919802665710449
Epoch: 18, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.473 Vali Acc: 0.861 Test Loss: 0.473 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 19 cost time: 0.6511662006378174
Epoch: 19, Steps: 7 | Train Loss: 0.108 Vali Loss: 0.461 Vali Acc: 0.861 Test Loss: 0.461 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 20 cost time: 0.6707758903503418
Epoch: 20, Steps: 7 | Train Loss: 0.096 Vali Loss: 0.451 Vali Acc: 0.861 Test Loss: 0.451 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 21 cost time: 0.6919205188751221
Epoch: 21, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.440 Vali Acc: 0.861 Test Loss: 0.440 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 22 cost time: 0.6926670074462891
Epoch: 22, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.434 Vali Acc: 0.847 Test Loss: 0.434 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.712080717086792
Epoch: 23, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 24 cost time: 0.6416816711425781
Epoch: 24, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 25 cost time: 0.7366528511047363
Epoch: 25, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 26 cost time: 0.6768627166748047
Epoch: 26, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 27 cost time: 0.71240234375
Epoch: 27, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.400 Vali Acc: 0.861 Test Loss: 0.400 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6728713512420654
Epoch: 28, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 29 cost time: 0.6681313514709473
Epoch: 29, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.396 Vali Acc: 0.861 Test Loss: 0.396 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6811552047729492
Epoch: 30, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.396 Vali Acc: 0.861 Test Loss: 0.396 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6517021656036377
Epoch: 31, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.395 Vali Acc: 0.861 Test Loss: 0.395 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7494642734527588
Epoch: 32, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.393 Vali Acc: 0.861 Test Loss: 0.393 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7178549766540527
Epoch: 33, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 34 cost time: 0.613774299621582
Epoch: 34, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.389 Vali Acc: 0.861 Test Loss: 0.389 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.68636155128479
Epoch: 35, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 36 cost time: 0.6687774658203125
Epoch: 36, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.372 Vali Acc: 0.889 Test Loss: 0.372 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 37 cost time: 0.598008394241333
Epoch: 37, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5979917049407959
Epoch: 38, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 39 cost time: 0.6212117671966553
Epoch: 39, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 40 cost time: 0.7489128112792969
Epoch: 40, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6680557727813721
Epoch: 41, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7022302150726318
Epoch: 42, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7793989181518555
Epoch: 43, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6475522518157959
Epoch: 44, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 45 cost time: 0.6726281642913818
Epoch: 45, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.361 Vali Acc: 0.889 Test Loss: 0.361 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 46 cost time: 0.6754226684570312
Epoch: 46, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7004783153533936
Epoch: 47, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 48 cost time: 0.6183393001556396
Epoch: 48, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6488325595855713
Epoch: 49, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 50 cost time: 0.6536428928375244
Epoch: 50, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 51 cost time: 0.6081173419952393
Epoch: 51, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 52 cost time: 0.7300946712493896
Epoch: 52, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.6746361255645752
Epoch: 53, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6257150173187256
Epoch: 54, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.343 Vali Acc: 0.889 Test Loss: 0.343 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.7283015251159668
Epoch: 55, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.6883831024169922
Epoch: 56, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.635308027267456
Epoch: 57, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.6509628295898438
Epoch: 58, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.6032087802886963
Epoch: 59, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.5888643264770508
Epoch: 60, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.7646739482879639
Epoch: 61, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.343 Vali Acc: 0.889 Test Loss: 0.343 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 38508
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3920178413391113
Epoch: 1, Steps: 7 | Train Loss: 2.526 Vali Loss: 2.383 Vali Acc: 0.111 Test Loss: 2.383 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 0.7959246635437012
Epoch: 2, Steps: 7 | Train Loss: 2.151 Vali Loss: 1.888 Vali Acc: 0.486 Test Loss: 1.888 Test Acc: 0.486
Validation loss decreased (-0.111087 --> -0.486092).  Saving model ...
Epoch: 3 cost time: 0.7551920413970947
Epoch: 3, Steps: 7 | Train Loss: 1.481 Vali Loss: 1.272 Vali Acc: 0.778 Test Loss: 1.272 Test Acc: 0.778
Validation loss decreased (-0.486092 --> -0.777765).  Saving model ...
Epoch: 4 cost time: 0.8797318935394287
Epoch: 4, Steps: 7 | Train Loss: 0.910 Vali Loss: 0.843 Vali Acc: 0.889 Test Loss: 0.843 Test Acc: 0.889
Validation loss decreased (-0.777765 --> -0.888880).  Saving model ...
Epoch: 5 cost time: 0.8600895404815674
Epoch: 5, Steps: 7 | Train Loss: 0.432 Vali Loss: 0.589 Vali Acc: 0.889 Test Loss: 0.589 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 0.7968790531158447
Epoch: 6, Steps: 7 | Train Loss: 0.219 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8143572807312012
Epoch: 7, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 0.7442007064819336
Epoch: 8, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7810375690460205
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.841963529586792
Epoch: 10, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.7913291454315186
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.8003661632537842
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.8081092834472656
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.8183286190032959
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.7967226505279541
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.778501033782959
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.782904863357544
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8965482711791992
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.835747241973877
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8182022571563721
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8046972751617432
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9001407623291016
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7822225093841553
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8136811256408691
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8670017719268799
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 191596
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.210836887359619
Epoch: 1, Steps: 7 | Train Loss: 2.502 Vali Loss: 2.428 Vali Acc: 0.139 Test Loss: 2.428 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.7381167411804199
Epoch: 2, Steps: 7 | Train Loss: 2.333 Vali Loss: 2.060 Vali Acc: 0.417 Test Loss: 2.060 Test Acc: 0.417
Validation loss decreased (-0.138865 --> -0.416646).  Saving model ...
Epoch: 3 cost time: 0.6698291301727295
Epoch: 3, Steps: 7 | Train Loss: 1.829 Vali Loss: 1.656 Vali Acc: 0.611 Test Loss: 1.656 Test Acc: 0.611
Validation loss decreased (-0.416646 --> -0.611095).  Saving model ...
Epoch: 4 cost time: 0.6517679691314697
Epoch: 4, Steps: 7 | Train Loss: 1.373 Vali Loss: 1.234 Vali Acc: 0.750 Test Loss: 1.234 Test Acc: 0.750
Validation loss decreased (-0.611095 --> -0.749988).  Saving model ...
Epoch: 5 cost time: 0.6257095336914062
Epoch: 5, Steps: 7 | Train Loss: 0.891 Vali Loss: 0.851 Vali Acc: 0.847 Test Loss: 0.851 Test Acc: 0.847
Validation loss decreased (-0.749988 --> -0.847214).  Saving model ...
Epoch: 6 cost time: 0.6629714965820312
Epoch: 6, Steps: 7 | Train Loss: 0.550 Vali Loss: 0.633 Vali Acc: 0.889 Test Loss: 0.633 Test Acc: 0.889
Validation loss decreased (-0.847214 --> -0.888883).  Saving model ...
Epoch: 7 cost time: 0.6735742092132568
Epoch: 7, Steps: 7 | Train Loss: 0.308 Vali Loss: 0.486 Vali Acc: 0.889 Test Loss: 0.486 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.660830020904541
Epoch: 8, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.390 Vali Acc: 0.889 Test Loss: 0.390 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.6572656631469727
Epoch: 9, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.344 Vali Acc: 0.903 Test Loss: 0.344 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.6633353233337402
Epoch: 10, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6768693923950195
Epoch: 11, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.645491361618042
Epoch: 12, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6870944499969482
Epoch: 13, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.6059079170227051
Epoch: 14, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.618767261505127
Epoch: 15, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.610281229019165
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.7014057636260986
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.7554948329925537
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.6279089450836182
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.6476378440856934
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.8147175312042236
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.6964530944824219
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.6639180183410645
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.6941416263580322
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.6551122665405273
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.5991125106811523
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6205141544342041
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.7002110481262207
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.6872766017913818
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.6889700889587402
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.7099876403808594
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.7095494270324707
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5934419631958008
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.6623449325561523
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6313467025756836
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7343423366546631
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.669456958770752
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6828837394714355
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6487917900085449
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6271164417266846
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6489243507385254
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.6074204444885254
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6919612884521484
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 100396
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3328564167022705
Epoch: 1, Steps: 7 | Train Loss: 2.534 Vali Loss: 2.387 Vali Acc: 0.153 Test Loss: 2.387 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.6860344409942627
Epoch: 2, Steps: 7 | Train Loss: 2.329 Vali Loss: 2.161 Vali Acc: 0.375 Test Loss: 2.161 Test Acc: 0.375
Validation loss decreased (-0.152754 --> -0.374978).  Saving model ...
Epoch: 3 cost time: 0.6129395961761475
Epoch: 3, Steps: 7 | Train Loss: 1.916 Vali Loss: 1.841 Vali Acc: 0.556 Test Loss: 1.841 Test Acc: 0.556
Validation loss decreased (-0.374978 --> -0.555537).  Saving model ...
Epoch: 4 cost time: 0.6867825984954834
Epoch: 4, Steps: 7 | Train Loss: 1.561 Vali Loss: 1.486 Vali Acc: 0.764 Test Loss: 1.486 Test Acc: 0.764
Validation loss decreased (-0.555537 --> -0.763874).  Saving model ...
Epoch: 5 cost time: 0.6125450134277344
Epoch: 5, Steps: 7 | Train Loss: 1.133 Vali Loss: 1.143 Vali Acc: 0.792 Test Loss: 1.143 Test Acc: 0.792
Validation loss decreased (-0.763874 --> -0.791655).  Saving model ...
Epoch: 6 cost time: 0.6473934650421143
Epoch: 6, Steps: 7 | Train Loss: 0.758 Vali Loss: 0.871 Vali Acc: 0.819 Test Loss: 0.871 Test Acc: 0.819
Validation loss decreased (-0.791655 --> -0.819436).  Saving model ...
Epoch: 7 cost time: 0.7028179168701172
Epoch: 7, Steps: 7 | Train Loss: 0.492 Vali Loss: 0.672 Vali Acc: 0.847 Test Loss: 0.672 Test Acc: 0.847
Validation loss decreased (-0.819436 --> -0.847215).  Saving model ...
Epoch: 8 cost time: 0.6640257835388184
Epoch: 8, Steps: 7 | Train Loss: 0.297 Vali Loss: 0.559 Vali Acc: 0.861 Test Loss: 0.559 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 0.6068449020385742
Epoch: 9, Steps: 7 | Train Loss: 0.186 Vali Loss: 0.468 Vali Acc: 0.889 Test Loss: 0.468 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 0.6826779842376709
Epoch: 10, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 0.6547293663024902
Epoch: 11, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.6864817142486572
Epoch: 12, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.366 Vali Acc: 0.889 Test Loss: 0.366 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.706193208694458
Epoch: 13, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 0.7016646862030029
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7095355987548828
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.682126522064209
Epoch: 16, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.5973825454711914
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.6545836925506592
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6253261566162109
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7204782962799072
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.6443333625793457
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.6440925598144531
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6650285720825195
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6560268402099609
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6449308395385742
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.743638277053833
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7029871940612793
Epoch: 27, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6475648880004883
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6593246459960938
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6651639938354492
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.697394847869873
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 71404
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df64_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3251614570617676
Epoch: 1, Steps: 7 | Train Loss: 2.594 Vali Loss: 2.467 Vali Acc: 0.111 Test Loss: 2.467 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.6815650463104248
Epoch: 2, Steps: 7 | Train Loss: 2.477 Vali Loss: 2.203 Vali Acc: 0.319 Test Loss: 2.203 Test Acc: 0.319
Validation loss decreased (-0.111086 --> -0.319422).  Saving model ...
Epoch: 3 cost time: 0.6355364322662354
Epoch: 3, Steps: 7 | Train Loss: 2.129 Vali Loss: 1.875 Vali Acc: 0.542 Test Loss: 1.875 Test Acc: 0.542
Validation loss decreased (-0.319422 --> -0.541648).  Saving model ...
Epoch: 4 cost time: 0.6677231788635254
Epoch: 4, Steps: 7 | Train Loss: 1.767 Vali Loss: 1.547 Vali Acc: 0.736 Test Loss: 1.547 Test Acc: 0.736
Validation loss decreased (-0.541648 --> -0.736096).  Saving model ...
Epoch: 5 cost time: 0.7127060890197754
Epoch: 5, Steps: 7 | Train Loss: 1.373 Vali Loss: 1.238 Vali Acc: 0.764 Test Loss: 1.238 Test Acc: 0.764
Validation loss decreased (-0.736096 --> -0.763877).  Saving model ...
Epoch: 6 cost time: 0.744520902633667
Epoch: 6, Steps: 7 | Train Loss: 1.061 Vali Loss: 0.967 Vali Acc: 0.792 Test Loss: 0.967 Test Acc: 0.792
Validation loss decreased (-0.763877 --> -0.791657).  Saving model ...
Epoch: 7 cost time: 0.6912815570831299
Epoch: 7, Steps: 7 | Train Loss: 0.759 Vali Loss: 0.759 Vali Acc: 0.847 Test Loss: 0.759 Test Acc: 0.847
Validation loss decreased (-0.791657 --> -0.847215).  Saving model ...
Epoch: 8 cost time: 0.7647366523742676
Epoch: 8, Steps: 7 | Train Loss: 0.504 Vali Loss: 0.598 Vali Acc: 0.847 Test Loss: 0.598 Test Acc: 0.847
Validation loss decreased (-0.847215 --> -0.847216).  Saving model ...
Epoch: 9 cost time: 0.7121810913085938
Epoch: 9, Steps: 7 | Train Loss: 0.320 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
Validation loss decreased (-0.847216 --> -0.847217).  Saving model ...
Epoch: 10 cost time: 0.6922664642333984
Epoch: 10, Steps: 7 | Train Loss: 0.214 Vali Loss: 0.452 Vali Acc: 0.819 Test Loss: 0.452 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6960680484771729
Epoch: 11, Steps: 7 | Train Loss: 0.147 Vali Loss: 0.414 Vali Acc: 0.861 Test Loss: 0.414 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861107).  Saving model ...
Epoch: 12 cost time: 0.6389124393463135
Epoch: 12, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 0.6844222545623779
Epoch: 13, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.6327722072601318
Epoch: 14, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.6874549388885498
Epoch: 15, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 0.616889476776123
Epoch: 16, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7279047966003418
Epoch: 17, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5659444332122803
Epoch: 18, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.663344144821167
Epoch: 19, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6109836101531982
Epoch: 20, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7093064785003662
Epoch: 21, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7240607738494873
Epoch: 22, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6450271606445312
Epoch: 23, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7543759346008301
Epoch: 24, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.6621105670928955
Epoch: 25, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.7055454254150391
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.7255804538726807
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.7393929958343506
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7016990184783936
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6959218978881836
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6811151504516602
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8086271286010742
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6655187606811523
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.67417311668396
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.755509614944458
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7140343189239502
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6141970157623291
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df64_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 56236
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3474247455596924
Epoch: 1, Steps: 7 | Train Loss: 2.639 Vali Loss: 2.637 Vali Acc: 0.056 Test Loss: 2.637 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 0.6916766166687012
Epoch: 2, Steps: 7 | Train Loss: 2.514 Vali Loss: 2.472 Vali Acc: 0.097 Test Loss: 2.472 Test Acc: 0.097
Validation loss decreased (-0.055529 --> -0.097198).  Saving model ...
Epoch: 3 cost time: 0.5327358245849609
Epoch: 3, Steps: 7 | Train Loss: 2.268 Vali Loss: 2.243 Vali Acc: 0.264 Test Loss: 2.243 Test Acc: 0.264
Validation loss decreased (-0.097198 --> -0.263866).  Saving model ...
Epoch: 4 cost time: 0.5715670585632324
Epoch: 4, Steps: 7 | Train Loss: 1.996 Vali Loss: 1.984 Vali Acc: 0.389 Test Loss: 1.984 Test Acc: 0.389
Validation loss decreased (-0.263866 --> -0.388869).  Saving model ...
Epoch: 5 cost time: 0.6335861682891846
Epoch: 5, Steps: 7 | Train Loss: 1.677 Vali Loss: 1.717 Vali Acc: 0.583 Test Loss: 1.717 Test Acc: 0.583
Validation loss decreased (-0.388869 --> -0.583316).  Saving model ...
Epoch: 6 cost time: 0.7021315097808838
Epoch: 6, Steps: 7 | Train Loss: 1.432 Vali Loss: 1.463 Vali Acc: 0.708 Test Loss: 1.463 Test Acc: 0.708
Validation loss decreased (-0.583316 --> -0.708319).  Saving model ...
Epoch: 7 cost time: 0.6130599975585938
Epoch: 7, Steps: 7 | Train Loss: 1.107 Vali Loss: 1.208 Vali Acc: 0.764 Test Loss: 1.208 Test Acc: 0.764
Validation loss decreased (-0.708319 --> -0.763877).  Saving model ...
Epoch: 8 cost time: 0.5675415992736816
Epoch: 8, Steps: 7 | Train Loss: 0.882 Vali Loss: 0.995 Vali Acc: 0.833 Test Loss: 0.995 Test Acc: 0.833
Validation loss decreased (-0.763877 --> -0.833323).  Saving model ...
Epoch: 9 cost time: 0.7672779560089111
Epoch: 9, Steps: 7 | Train Loss: 0.658 Vali Loss: 0.820 Vali Acc: 0.819 Test Loss: 0.820 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.78224778175354
Epoch: 10, Steps: 7 | Train Loss: 0.455 Vali Loss: 0.683 Vali Acc: 0.847 Test Loss: 0.683 Test Acc: 0.847
Validation loss decreased (-0.833323 --> -0.847215).  Saving model ...
Epoch: 11 cost time: 0.7532103061676025
Epoch: 11, Steps: 7 | Train Loss: 0.303 Vali Loss: 0.584 Vali Acc: 0.875 Test Loss: 0.584 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874994).  Saving model ...
Epoch: 12 cost time: 0.5895638465881348
Epoch: 12, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.522 Vali Acc: 0.861 Test Loss: 0.522 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6892375946044922
Epoch: 13, Steps: 7 | Train Loss: 0.162 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 14 cost time: 0.609910249710083
Epoch: 14, Steps: 7 | Train Loss: 0.126 Vali Loss: 0.423 Vali Acc: 0.889 Test Loss: 0.423 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 0.5289435386657715
Epoch: 15, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 0.6224873065948486
Epoch: 16, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.392 Vali Acc: 0.889 Test Loss: 0.392 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 0.8494284152984619
Epoch: 17, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 0.6818506717681885
Epoch: 18, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.372 Vali Acc: 0.903 Test Loss: 0.372 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 19 cost time: 0.702549934387207
Epoch: 19, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 20 cost time: 0.7713730335235596
Epoch: 20, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 21 cost time: 0.6351222991943359
Epoch: 21, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 0.6160738468170166
Epoch: 22, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.6569821834564209
Epoch: 23, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 24 cost time: 0.6517243385314941
Epoch: 24, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 25 cost time: 0.7150990962982178
Epoch: 25, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 0.6661641597747803
Epoch: 26, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.6872880458831787
Epoch: 27, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.6853146553039551
Epoch: 28, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.6670475006103516
Epoch: 29, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.6728641986846924
Epoch: 30, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.7003004550933838
Epoch: 31, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.7630410194396973
Epoch: 32, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.682471513748169
Epoch: 33, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.691352367401123
Epoch: 34, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.6561276912689209
Epoch: 35, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.655620813369751
Epoch: 36, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.7266488075256348
Epoch: 37, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.705106258392334
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.6726269721984863
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.7039284706115723
Epoch: 40, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.7071506977081299
Epoch: 41, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.6432185173034668
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6704938411712646
Epoch: 43, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7305352687835693
Epoch: 44, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.7012929916381836
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.7373206615447998
Epoch: 46, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.6617445945739746
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.7108774185180664
Epoch: 48, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.6701128482818604
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6919703483581543
Epoch: 50, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.691544771194458
Epoch: 51, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.7454030513763428
Epoch: 52, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.733405351638794
Epoch: 53, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6229398250579834
Epoch: 54, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 0.7037830352783203
Epoch: 55, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 0.654975414276123
Epoch: 56, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6752917766571045
Epoch: 57, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 0.7211112976074219
Epoch: 58, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 0.6667284965515137
Epoch: 59, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.6634838581085205
Epoch: 60, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.6548812389373779
Epoch: 61, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 62 cost time: 0.6369309425354004
Epoch: 62, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6961653232574463
Epoch: 63, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 0.6442265510559082
Epoch: 64, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 0.6094212532043457
Epoch: 65, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 0.6794872283935547
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 0.6657912731170654
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 0.5873997211456299
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 0.6707892417907715
Epoch: 69, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 0.6992721557617188
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 0.6490993499755859
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 0.673785924911499
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.6944291591644287
Epoch: 73, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 74 cost time: 0.6782622337341309
Epoch: 74, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.5967481136322021
Epoch: 75, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.6751458644866943
Epoch: 76, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.6393997669219971
Epoch: 77, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 78 cost time: 0.6673030853271484
Epoch: 78, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 79 cost time: 0.6512284278869629
Epoch: 79, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 80 cost time: 0.6849672794342041
Epoch: 80, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 81 cost time: 0.5709927082061768
Epoch: 81, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 82 cost time: 0.5774760246276855
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.6027078628540039
Epoch: 83, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 84 cost time: 0.6047954559326172
Epoch: 84, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.6382625102996826
Epoch: 85, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 86 cost time: 0.6873347759246826
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 87 cost time: 0.6325230598449707
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.7097365856170654
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 89 cost time: 0.6538147926330566
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 90 cost time: 0.6044955253601074
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.6791069507598877
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.7118475437164307
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.6096980571746826
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.6333787441253662
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.6641561985015869
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 0.6067807674407959
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 97 cost time: 0.6652474403381348
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.7124288082122803
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.7454121112823486
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 0.6764378547668457
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 44332
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df64_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.026257276535034
Epoch: 1, Steps: 7 | Train Loss: 2.596 Vali Loss: 2.540 Vali Acc: 0.111 Test Loss: 2.540 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.567568302154541
Epoch: 2, Steps: 7 | Train Loss: 2.507 Vali Loss: 2.401 Vali Acc: 0.194 Test Loss: 2.401 Test Acc: 0.194
Validation loss decreased (-0.111086 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 0.7644844055175781
Epoch: 3, Steps: 7 | Train Loss: 2.316 Vali Loss: 2.216 Vali Acc: 0.347 Test Loss: 2.216 Test Acc: 0.347
Validation loss decreased (-0.194420 --> -0.347200).  Saving model ...
Epoch: 4 cost time: 0.6765491962432861
Epoch: 4, Steps: 7 | Train Loss: 2.116 Vali Loss: 2.003 Vali Acc: 0.444 Test Loss: 2.003 Test Acc: 0.444
Validation loss decreased (-0.347200 --> -0.444424).  Saving model ...
Epoch: 5 cost time: 0.7153041362762451
Epoch: 5, Steps: 7 | Train Loss: 1.888 Vali Loss: 1.790 Vali Acc: 0.514 Test Loss: 1.790 Test Acc: 0.514
Validation loss decreased (-0.444424 --> -0.513871).  Saving model ...
Epoch: 6 cost time: 0.6438977718353271
Epoch: 6, Steps: 7 | Train Loss: 1.657 Vali Loss: 1.578 Vali Acc: 0.639 Test Loss: 1.578 Test Acc: 0.639
Validation loss decreased (-0.513871 --> -0.638873).  Saving model ...
Epoch: 7 cost time: 0.7358245849609375
Epoch: 7, Steps: 7 | Train Loss: 1.384 Vali Loss: 1.364 Vali Acc: 0.736 Test Loss: 1.364 Test Acc: 0.736
Validation loss decreased (-0.638873 --> -0.736097).  Saving model ...
Epoch: 8 cost time: 0.6831099987030029
Epoch: 8, Steps: 7 | Train Loss: 1.168 Vali Loss: 1.172 Vali Acc: 0.764 Test Loss: 1.172 Test Acc: 0.764
Validation loss decreased (-0.736097 --> -0.763877).  Saving model ...
Epoch: 9 cost time: 0.636085033416748
Epoch: 9, Steps: 7 | Train Loss: 0.872 Vali Loss: 0.991 Vali Acc: 0.806 Test Loss: 0.991 Test Acc: 0.806
Validation loss decreased (-0.763877 --> -0.805546).  Saving model ...
Epoch: 10 cost time: 0.7359569072723389
Epoch: 10, Steps: 7 | Train Loss: 0.691 Vali Loss: 0.821 Vali Acc: 0.806 Test Loss: 0.821 Test Acc: 0.806
Validation loss decreased (-0.805546 --> -0.805547).  Saving model ...
Epoch: 11 cost time: 0.6339027881622314
Epoch: 11, Steps: 7 | Train Loss: 0.529 Vali Loss: 0.693 Vali Acc: 0.833 Test Loss: 0.693 Test Acc: 0.833
Validation loss decreased (-0.805547 --> -0.833326).  Saving model ...
Epoch: 12 cost time: 0.6924371719360352
Epoch: 12, Steps: 7 | Train Loss: 0.406 Vali Loss: 0.600 Vali Acc: 0.861 Test Loss: 0.600 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861105).  Saving model ...
Epoch: 13 cost time: 0.7923188209533691
Epoch: 13, Steps: 7 | Train Loss: 0.322 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 14 cost time: 0.7591235637664795
Epoch: 14, Steps: 7 | Train Loss: 0.228 Vali Loss: 0.475 Vali Acc: 0.875 Test Loss: 0.475 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 0.6843705177307129
Epoch: 15, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.433 Vali Acc: 0.889 Test Loss: 0.433 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 0.690911054611206
Epoch: 16, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.409 Vali Acc: 0.889 Test Loss: 0.409 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 0.6915669441223145
Epoch: 17, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 0.6806457042694092
Epoch: 18, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7314133644104004
Epoch: 19, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 0.6830260753631592
Epoch: 20, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7553651332855225
Epoch: 21, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6351938247680664
Epoch: 22, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6508667469024658
Epoch: 23, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.6368489265441895
Epoch: 24, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.678879976272583
Epoch: 25, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6758699417114258
Epoch: 26, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7050783634185791
Epoch: 27, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.7441987991333008
Epoch: 28, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.7474184036254883
Epoch: 29, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6816015243530273
Epoch: 30, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.817530632019043
Epoch: 31, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.750617504119873
Epoch: 32, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7173607349395752
Epoch: 33, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8297998905181885
Epoch: 34, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6966803073883057
Epoch: 35, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.6895408630371094
Epoch: 36, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.7078115940093994
Epoch: 37, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.7069804668426514
Epoch: 38, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.7606463432312012
Epoch: 39, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.6701221466064453
Epoch: 40, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.5701050758361816
Epoch: 41, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.6341171264648438
Epoch: 42, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.7311990261077881
Epoch: 43, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.6743085384368896
Epoch: 44, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6410117149353027
Epoch: 45, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7629735469818115
Epoch: 46, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.7647795677185059
Epoch: 47, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.7033693790435791
Epoch: 48, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.6547386646270752
Epoch: 49, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.7220509052276611
Epoch: 50, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 0.6448612213134766
Epoch: 51, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.6206834316253662
Epoch: 52, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.707772970199585
Epoch: 53, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.7181129455566406
Epoch: 54, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 0.6887533664703369
Epoch: 55, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 0.694718599319458
Epoch: 56, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 0.7310867309570312
Epoch: 57, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 0.7487118244171143
Epoch: 58, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 0.567805290222168
Epoch: 59, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.6855955123901367
Epoch: 60, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 0.8097822666168213
Epoch: 61, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 62 cost time: 0.7246279716491699
Epoch: 62, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.772557258605957
Epoch: 63, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.827167272567749
Epoch: 64, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.7262148857116699
Epoch: 65, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 0.7103803157806396
Epoch: 66, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 0.6421489715576172
Epoch: 67, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 0.6005311012268066
Epoch: 68, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 0.7833189964294434
Epoch: 69, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 0.7029592990875244
Epoch: 70, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 0.7704484462738037
Epoch: 71, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.6518325805664062
Epoch: 72, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 73 cost time: 0.6722748279571533
Epoch: 73, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.6913888454437256
Epoch: 74, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.6112136840820312
Epoch: 75, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.6848287582397461
Epoch: 76, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.6947200298309326
Epoch: 77, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.8231105804443359
Epoch: 78, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 79 cost time: 0.7908134460449219
Epoch: 79, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 80 cost time: 0.6245079040527344
Epoch: 80, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 81 cost time: 0.8068587779998779
Epoch: 81, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 82 cost time: 0.6696569919586182
Epoch: 82, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 83 cost time: 0.7561218738555908
Epoch: 83, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.6505346298217773
Epoch: 84, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.7298519611358643
Epoch: 85, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 86 cost time: 0.7681303024291992
Epoch: 86, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 87 cost time: 0.6841940879821777
Epoch: 87, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 88 cost time: 0.6825108528137207
Epoch: 88, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.7069120407104492
Epoch: 89, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.6935675144195557
Epoch: 90, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 0.6460235118865967
Epoch: 91, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 0.712486982345581
Epoch: 92, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 0.6539754867553711
Epoch: 93, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 0.7023622989654541
Epoch: 94, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 95 cost time: 0.7331926822662354
Epoch: 95, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.7465732097625732
Epoch: 96, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.6988372802734375
Epoch: 97, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 0.6788835525512695
Epoch: 98, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 0.7275586128234863
Epoch: 99, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 0.7220468521118164
Epoch: 100, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df64_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 37036
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2617974281311035
Epoch: 1, Steps: 7 | Train Loss: 2.763 Vali Loss: 2.541 Vali Acc: 0.097 Test Loss: 2.541 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.6803522109985352
Epoch: 2, Steps: 7 | Train Loss: 2.647 Vali Loss: 2.446 Vali Acc: 0.125 Test Loss: 2.446 Test Acc: 0.125
Validation loss decreased (-0.097197 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 0.7289347648620605
Epoch: 3, Steps: 7 | Train Loss: 2.507 Vali Loss: 2.296 Vali Acc: 0.222 Test Loss: 2.296 Test Acc: 0.222
Validation loss decreased (-0.124976 --> -0.222199).  Saving model ...
Epoch: 4 cost time: 0.6602590084075928
Epoch: 4, Steps: 7 | Train Loss: 2.280 Vali Loss: 2.115 Vali Acc: 0.375 Test Loss: 2.115 Test Acc: 0.375
Validation loss decreased (-0.222199 --> -0.374979).  Saving model ...
Epoch: 5 cost time: 0.6619670391082764
Epoch: 5, Steps: 7 | Train Loss: 2.010 Vali Loss: 1.918 Vali Acc: 0.556 Test Loss: 1.918 Test Acc: 0.556
Validation loss decreased (-0.374979 --> -0.555536).  Saving model ...
Epoch: 6 cost time: 0.6709058284759521
Epoch: 6, Steps: 7 | Train Loss: 1.786 Vali Loss: 1.722 Vali Acc: 0.611 Test Loss: 1.722 Test Acc: 0.611
Validation loss decreased (-0.555536 --> -0.611094).  Saving model ...
Epoch: 7 cost time: 0.6131381988525391
Epoch: 7, Steps: 7 | Train Loss: 1.546 Vali Loss: 1.523 Vali Acc: 0.694 Test Loss: 1.523 Test Acc: 0.694
Validation loss decreased (-0.611094 --> -0.694429).  Saving model ...
Epoch: 8 cost time: 0.7214272022247314
Epoch: 8, Steps: 7 | Train Loss: 1.259 Vali Loss: 1.325 Vali Acc: 0.764 Test Loss: 1.325 Test Acc: 0.764
Validation loss decreased (-0.694429 --> -0.763876).  Saving model ...
Epoch: 9 cost time: 0.7520463466644287
Epoch: 9, Steps: 7 | Train Loss: 1.058 Vali Loss: 1.147 Vali Acc: 0.806 Test Loss: 1.147 Test Acc: 0.806
Validation loss decreased (-0.763876 --> -0.805544).  Saving model ...
Epoch: 10 cost time: 0.7018887996673584
Epoch: 10, Steps: 7 | Train Loss: 0.884 Vali Loss: 0.992 Vali Acc: 0.833 Test Loss: 0.992 Test Acc: 0.833
Validation loss decreased (-0.805544 --> -0.833323).  Saving model ...
Epoch: 11 cost time: 0.6717891693115234
Epoch: 11, Steps: 7 | Train Loss: 0.676 Vali Loss: 0.856 Vali Acc: 0.875 Test Loss: 0.856 Test Acc: 0.875
Validation loss decreased (-0.833323 --> -0.874991).  Saving model ...
Epoch: 12 cost time: 0.6661503314971924
Epoch: 12, Steps: 7 | Train Loss: 0.542 Vali Loss: 0.755 Vali Acc: 0.861 Test Loss: 0.755 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6264743804931641
Epoch: 13, Steps: 7 | Train Loss: 0.413 Vali Loss: 0.680 Vali Acc: 0.861 Test Loss: 0.680 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6546452045440674
Epoch: 14, Steps: 7 | Train Loss: 0.310 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6416151523590088
Epoch: 15, Steps: 7 | Train Loss: 0.245 Vali Loss: 0.563 Vali Acc: 0.875 Test Loss: 0.563 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874994).  Saving model ...
Epoch: 16 cost time: 0.5864758491516113
Epoch: 16, Steps: 7 | Train Loss: 0.208 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6351718902587891
Epoch: 17, Steps: 7 | Train Loss: 0.160 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7470905780792236
Epoch: 18, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.493 Vali Acc: 0.861 Test Loss: 0.493 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6953694820404053
Epoch: 19, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 20 cost time: 0.6195471286773682
Epoch: 20, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.450 Vali Acc: 0.889 Test Loss: 0.450 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888884).  Saving model ...
Epoch: 21 cost time: 0.6861691474914551
Epoch: 21, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.444 Vali Acc: 0.889 Test Loss: 0.444 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 22 cost time: 0.6698641777038574
Epoch: 22, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.437 Vali Acc: 0.889 Test Loss: 0.437 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 23 cost time: 0.6754224300384521
Epoch: 23, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.442 Vali Acc: 0.861 Test Loss: 0.442 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7240147590637207
Epoch: 24, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.438 Vali Acc: 0.861 Test Loss: 0.438 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6987488269805908
Epoch: 25, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.431 Vali Acc: 0.861 Test Loss: 0.431 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7649478912353516
Epoch: 26, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.426 Vali Acc: 0.861 Test Loss: 0.426 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8098726272583008
Epoch: 27, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7829370498657227
Epoch: 28, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.731581449508667
Epoch: 29, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6832671165466309
Epoch: 30, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6731986999511719
Epoch: 31, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7650454044342041
Epoch: 32, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm32_nh4_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 34348
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df256_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2483437061309814
Epoch: 1, Steps: 7 | Train Loss: 2.676 Vali Loss: 2.509 Vali Acc: 0.139 Test Loss: 2.509 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.7221455574035645
Epoch: 2, Steps: 7 | Train Loss: 2.409 Vali Loss: 2.261 Vali Acc: 0.278 Test Loss: 2.261 Test Acc: 0.278
Validation loss decreased (-0.138864 --> -0.277755).  Saving model ...
Epoch: 3 cost time: 0.6777873039245605
Epoch: 3, Steps: 7 | Train Loss: 2.081 Vali Loss: 1.926 Vali Acc: 0.569 Test Loss: 1.926 Test Acc: 0.569
Validation loss decreased (-0.277755 --> -0.569425).  Saving model ...
Epoch: 4 cost time: 0.6393885612487793
Epoch: 4, Steps: 7 | Train Loss: 1.648 Vali Loss: 1.540 Vali Acc: 0.750 Test Loss: 1.540 Test Acc: 0.750
Validation loss decreased (-0.569425 --> -0.749985).  Saving model ...
Epoch: 5 cost time: 0.6137127876281738
Epoch: 5, Steps: 7 | Train Loss: 1.225 Vali Loss: 1.183 Vali Acc: 0.764 Test Loss: 1.183 Test Acc: 0.764
Validation loss decreased (-0.749985 --> -0.763877).  Saving model ...
Epoch: 6 cost time: 0.7533149719238281
Epoch: 6, Steps: 7 | Train Loss: 0.823 Vali Loss: 0.843 Vali Acc: 0.847 Test Loss: 0.843 Test Acc: 0.847
Validation loss decreased (-0.763877 --> -0.847214).  Saving model ...
Epoch: 7 cost time: 0.7072610855102539
Epoch: 7, Steps: 7 | Train Loss: 0.462 Vali Loss: 0.632 Vali Acc: 0.861 Test Loss: 0.632 Test Acc: 0.861
Validation loss decreased (-0.847214 --> -0.861105).  Saving model ...
Epoch: 8 cost time: 0.7593252658843994
Epoch: 8, Steps: 7 | Train Loss: 0.283 Vali Loss: 0.493 Vali Acc: 0.917 Test Loss: 0.493 Test Acc: 0.917
Validation loss decreased (-0.861105 --> -0.916662).  Saving model ...
Epoch: 9 cost time: 0.6449599266052246
Epoch: 9, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.406 Vali Acc: 0.889 Test Loss: 0.406 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6923627853393555
Epoch: 10, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7281718254089355
Epoch: 11, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7588565349578857
Epoch: 12, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.5966031551361084
Epoch: 13, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.633612871170044
Epoch: 14, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.6231894493103027
Epoch: 15, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.6500930786132812
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.6301126480102539
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6217236518859863
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6027741432189941
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.605156421661377
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6350612640380859
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6287736892700195
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6935765743255615
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5919771194458008
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.7270369529724121
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.6143224239349365
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.6908304691314697
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6840734481811523
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.647345781326294
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7209115028381348
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7426841259002686
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6446690559387207
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7229664325714111
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6354250907897949
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6328890323638916
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.750093936920166
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df256_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 101148
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df256_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4404492378234863
Epoch: 1, Steps: 7 | Train Loss: 2.588 Vali Loss: 2.495 Vali Acc: 0.264 Test Loss: 2.495 Test Acc: 0.264
Validation loss decreased (inf --> -0.263864).  Saving model ...
Epoch: 2 cost time: 0.7121014595031738
Epoch: 2, Steps: 7 | Train Loss: 2.390 Vali Loss: 2.293 Vali Acc: 0.347 Test Loss: 2.293 Test Acc: 0.347
Validation loss decreased (-0.263864 --> -0.347199).  Saving model ...
Epoch: 3 cost time: 0.6341578960418701
Epoch: 3, Steps: 7 | Train Loss: 2.129 Vali Loss: 2.011 Vali Acc: 0.528 Test Loss: 2.011 Test Acc: 0.528
Validation loss decreased (-0.347199 --> -0.527758).  Saving model ...
Epoch: 4 cost time: 0.6621701717376709
Epoch: 4, Steps: 7 | Train Loss: 1.803 Vali Loss: 1.702 Vali Acc: 0.625 Test Loss: 1.702 Test Acc: 0.625
Validation loss decreased (-0.527758 --> -0.624983).  Saving model ...
Epoch: 5 cost time: 0.6396896839141846
Epoch: 5, Steps: 7 | Train Loss: 1.488 Vali Loss: 1.381 Vali Acc: 0.736 Test Loss: 1.381 Test Acc: 0.736
Validation loss decreased (-0.624983 --> -0.736097).  Saving model ...
Epoch: 6 cost time: 0.6240990161895752
Epoch: 6, Steps: 7 | Train Loss: 1.124 Vali Loss: 1.100 Vali Acc: 0.833 Test Loss: 1.100 Test Acc: 0.833
Validation loss decreased (-0.736097 --> -0.833322).  Saving model ...
Epoch: 7 cost time: 0.6006507873535156
Epoch: 7, Steps: 7 | Train Loss: 0.793 Vali Loss: 0.838 Vali Acc: 0.806 Test Loss: 0.838 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6820755004882812
Epoch: 8, Steps: 7 | Train Loss: 0.540 Vali Loss: 0.652 Vali Acc: 0.833 Test Loss: 0.652 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833327).  Saving model ...
Epoch: 9 cost time: 0.6256825923919678
Epoch: 9, Steps: 7 | Train Loss: 0.367 Vali Loss: 0.538 Vali Acc: 0.847 Test Loss: 0.538 Test Acc: 0.847
Validation loss decreased (-0.833327 --> -0.847217).  Saving model ...
Epoch: 10 cost time: 0.6639964580535889
Epoch: 10, Steps: 7 | Train Loss: 0.238 Vali Loss: 0.440 Vali Acc: 0.847 Test Loss: 0.440 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847218).  Saving model ...
Epoch: 11 cost time: 0.6541445255279541
Epoch: 11, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.378 Vali Acc: 0.889 Test Loss: 0.378 Test Acc: 0.889
Validation loss decreased (-0.847218 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 0.6719610691070557
Epoch: 12, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 0.6670277118682861
Epoch: 13, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.6428108215332031
Epoch: 14, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.6508233547210693
Epoch: 15, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.7102653980255127
Epoch: 16, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.6807386875152588
Epoch: 17, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.6876792907714844
Epoch: 18, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.652949333190918
Epoch: 19, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.7500991821289062
Epoch: 20, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7298300266265869
Epoch: 21, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7243468761444092
Epoch: 22, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.637742280960083
Epoch: 23, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6255319118499756
Epoch: 24, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.621875524520874
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.5678155422210693
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.6895196437835693
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.6459698677062988
Epoch: 28, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.6347062587738037
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.6864666938781738
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.6606326103210449
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.6001315116882324
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.6317999362945557
Epoch: 33, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.6542727947235107
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 35 cost time: 0.7031028270721436
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 36 cost time: 0.7151379585266113
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 37 cost time: 0.6555886268615723
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6718604564666748
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 39 cost time: 0.7097883224487305
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 40 cost time: 0.6219148635864258
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 41 cost time: 0.7650835514068604
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 42 cost time: 0.7035458087921143
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 43 cost time: 0.622067928314209
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 44 cost time: 0.6376020908355713
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6518075466156006
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 46 cost time: 0.6314349174499512
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 47 cost time: 0.607797384262085
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 48 cost time: 0.667102575302124
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 49 cost time: 0.6383218765258789
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 50 cost time: 0.7187225818634033
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 51 cost time: 0.5879662036895752
Epoch: 51, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5759165287017822
Epoch: 52, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6244096755981445
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.5949561595916748
Epoch: 54, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.7099857330322266
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 56 cost time: 0.7166643142700195
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 57 cost time: 0.6966342926025391
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 58 cost time: 0.7152104377746582
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 59 cost time: 0.6872282028198242
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 60 cost time: 0.6030349731445312
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 61 cost time: 0.6453719139099121
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 62 cost time: 0.6311743259429932
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6123478412628174
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 64 cost time: 0.6790258884429932
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.6171448230743408
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.583132266998291
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.525043249130249
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.6353507041931152
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 69 cost time: 0.5819034576416016
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 70 cost time: 0.6447744369506836
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 71 cost time: 0.5795211791992188
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 72 cost time: 0.6959400177001953
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 73 cost time: 0.6049149036407471
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.6404316425323486
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.6815979480743408
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.670222282409668
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 77 cost time: 0.7481727600097656
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 78 cost time: 0.6415750980377197
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 79 cost time: 0.5594940185546875
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.598992109298706
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.5791800022125244
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.6332077980041504
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 83 cost time: 0.6656129360198975
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.6900975704193115
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.6747763156890869
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.6902821063995361
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.6494836807250977
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.6229374408721924
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 0.6808896064758301
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 0.6881523132324219
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 0.6764094829559326
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 0.7355473041534424
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df256_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 55548
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2804455757141113
Epoch: 1, Steps: 7 | Train Loss: 2.751 Vali Loss: 2.711 Vali Acc: 0.083 Test Loss: 2.711 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 0.7005870342254639
Epoch: 2, Steps: 7 | Train Loss: 2.624 Vali Loss: 2.538 Vali Acc: 0.139 Test Loss: 2.538 Test Acc: 0.139
Validation loss decreased (-0.083306 --> -0.138864).  Saving model ...
Epoch: 3 cost time: 0.5687768459320068
Epoch: 3, Steps: 7 | Train Loss: 2.419 Vali Loss: 2.300 Vali Acc: 0.306 Test Loss: 2.300 Test Acc: 0.306
Validation loss decreased (-0.138864 --> -0.305533).  Saving model ...
Epoch: 4 cost time: 0.6502268314361572
Epoch: 4, Steps: 7 | Train Loss: 2.138 Vali Loss: 2.042 Vali Acc: 0.458 Test Loss: 2.042 Test Acc: 0.458
Validation loss decreased (-0.305533 --> -0.458313).  Saving model ...
Epoch: 5 cost time: 0.6734378337860107
Epoch: 5, Steps: 7 | Train Loss: 1.865 Vali Loss: 1.765 Vali Acc: 0.611 Test Loss: 1.765 Test Acc: 0.611
Validation loss decreased (-0.458313 --> -0.611093).  Saving model ...
Epoch: 6 cost time: 0.632195234298706
Epoch: 6, Steps: 7 | Train Loss: 1.578 Vali Loss: 1.474 Vali Acc: 0.764 Test Loss: 1.474 Test Acc: 0.764
Validation loss decreased (-0.611093 --> -0.763874).  Saving model ...
Epoch: 7 cost time: 0.6233177185058594
Epoch: 7, Steps: 7 | Train Loss: 1.305 Vali Loss: 1.202 Vali Acc: 0.778 Test Loss: 1.202 Test Acc: 0.778
Validation loss decreased (-0.763874 --> -0.777766).  Saving model ...
Epoch: 8 cost time: 0.6806802749633789
Epoch: 8, Steps: 7 | Train Loss: 0.953 Vali Loss: 0.961 Vali Acc: 0.806 Test Loss: 0.961 Test Acc: 0.806
Validation loss decreased (-0.777766 --> -0.805546).  Saving model ...
Epoch: 9 cost time: 0.6177382469177246
Epoch: 9, Steps: 7 | Train Loss: 0.687 Vali Loss: 0.764 Vali Acc: 0.833 Test Loss: 0.764 Test Acc: 0.833
Validation loss decreased (-0.805546 --> -0.833326).  Saving model ...
Epoch: 10 cost time: 0.534062385559082
Epoch: 10, Steps: 7 | Train Loss: 0.502 Vali Loss: 0.621 Vali Acc: 0.847 Test Loss: 0.621 Test Acc: 0.847
Validation loss decreased (-0.833326 --> -0.847216).  Saving model ...
Epoch: 11 cost time: 0.6558830738067627
Epoch: 11, Steps: 7 | Train Loss: 0.343 Vali Loss: 0.513 Vali Acc: 0.903 Test Loss: 0.513 Test Acc: 0.903
Validation loss decreased (-0.847216 --> -0.902773).  Saving model ...
Epoch: 12 cost time: 0.5914578437805176
Epoch: 12, Steps: 7 | Train Loss: 0.240 Vali Loss: 0.443 Vali Acc: 0.889 Test Loss: 0.443 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5984065532684326
Epoch: 13, Steps: 7 | Train Loss: 0.167 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5886280536651611
Epoch: 14, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 0.662966251373291
Epoch: 15, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6095635890960693
Epoch: 16, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7476246356964111
Epoch: 17, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6213111877441406
Epoch: 18, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.7077727317810059
Epoch: 19, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.7125499248504639
Epoch: 20, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7410590648651123
Epoch: 21, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.743924617767334
Epoch: 22, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.7335724830627441
Epoch: 23, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6697998046875
Epoch: 24, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.7265172004699707
Epoch: 25, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.6688916683197021
Epoch: 26, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.673537015914917
Epoch: 27, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.642207145690918
Epoch: 28, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.63130784034729
Epoch: 29, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.6237020492553711
Epoch: 30, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.6498839855194092
Epoch: 31, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.6187071800231934
Epoch: 32, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.6826324462890625
Epoch: 33, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.6802060604095459
Epoch: 34, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.6816866397857666
Epoch: 35, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.6905944347381592
Epoch: 36, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.6729466915130615
Epoch: 37, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 38 cost time: 0.6741023063659668
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6281266212463379
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 40 cost time: 0.6516439914703369
Epoch: 40, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7256388664245605
Epoch: 41, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6902124881744385
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 43 cost time: 0.6845588684082031
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 44 cost time: 0.7603378295898438
Epoch: 44, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 45 cost time: 0.661055326461792
Epoch: 45, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 46 cost time: 0.7524254322052002
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 47 cost time: 0.7524352073669434
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 48 cost time: 0.6585736274719238
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 49 cost time: 0.6286361217498779
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 50 cost time: 0.6252329349517822
Epoch: 50, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 51 cost time: 0.680994987487793
Epoch: 51, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 52 cost time: 0.6844911575317383
Epoch: 52, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 53 cost time: 0.7352252006530762
Epoch: 53, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 54 cost time: 0.6660616397857666
Epoch: 54, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 55 cost time: 0.6735379695892334
Epoch: 55, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6696250438690186
Epoch: 56, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.7120907306671143
Epoch: 57, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.6728250980377197
Epoch: 58, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6575548648834229
Epoch: 59, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 60 cost time: 0.6946909427642822
Epoch: 60, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 61 cost time: 0.6592936515808105
Epoch: 61, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6580164432525635
Epoch: 62, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 63 cost time: 0.6048934459686279
Epoch: 63, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 64 cost time: 0.7694287300109863
Epoch: 64, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 65 cost time: 0.6021344661712646
Epoch: 65, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 66 cost time: 0.6053762435913086
Epoch: 66, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6788532733917236
Epoch: 67, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 68 cost time: 0.6223547458648682
Epoch: 68, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 69 cost time: 0.6308355331420898
Epoch: 69, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 70 cost time: 0.7032356262207031
Epoch: 70, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 71 cost time: 0.7758638858795166
Epoch: 71, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 72 cost time: 0.7692928314208984
Epoch: 72, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.712052583694458
Epoch: 73, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.7802176475524902
Epoch: 74, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.6663737297058105
Epoch: 75, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.6626462936401367
Epoch: 76, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 77 cost time: 0.6487259864807129
Epoch: 77, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.6201276779174805
Epoch: 78, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.6576180458068848
Epoch: 79, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.917 Test Loss: 0.184 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.649846076965332
Epoch: 80, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.917 Test Loss: 0.184 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.700397253036499
Epoch: 81, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.917 Test Loss: 0.184 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.703514814376831
Epoch: 82, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 83 cost time: 0.6265227794647217
Epoch: 83, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.6312832832336426
Epoch: 84, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 85 cost time: 0.6449673175811768
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 86 cost time: 0.6884078979492188
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 87 cost time: 0.6671700477600098
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 88 cost time: 0.7490828037261963
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.6387784481048584
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 90 cost time: 0.6943001747131348
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.917 Test Loss: 0.181 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.6340329647064209
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.917 Test Loss: 0.181 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.7302134037017822
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.917 Test Loss: 0.180 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.798095703125
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.917 Test Loss: 0.180 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.6473562717437744
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 95 cost time: 0.6925785541534424
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.6647658348083496
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.917 Test Loss: 0.178 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.6483118534088135
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 0.7490999698638916
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 0.6307518482208252
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 100 cost time: 0.712576150894165
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 41052
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df256_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0272462368011475
Epoch: 1, Steps: 7 | Train Loss: 2.462 Vali Loss: 2.408 Vali Acc: 0.125 Test Loss: 2.408 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 0.6336846351623535
Epoch: 2, Steps: 7 | Train Loss: 2.396 Vali Loss: 2.293 Vali Acc: 0.208 Test Loss: 2.293 Test Acc: 0.208
Validation loss decreased (-0.124976 --> -0.208310).  Saving model ...
Epoch: 3 cost time: 0.5032632350921631
Epoch: 3, Steps: 7 | Train Loss: 2.219 Vali Loss: 2.127 Vali Acc: 0.319 Test Loss: 2.127 Test Acc: 0.319
Validation loss decreased (-0.208310 --> -0.319423).  Saving model ...
Epoch: 4 cost time: 0.5975031852722168
Epoch: 4, Steps: 7 | Train Loss: 2.018 Vali Loss: 1.925 Vali Acc: 0.500 Test Loss: 1.925 Test Acc: 0.500
Validation loss decreased (-0.319423 --> -0.499981).  Saving model ...
Epoch: 5 cost time: 0.6335251331329346
Epoch: 5, Steps: 7 | Train Loss: 1.758 Vali Loss: 1.705 Vali Acc: 0.639 Test Loss: 1.705 Test Acc: 0.639
Validation loss decreased (-0.499981 --> -0.638872).  Saving model ...
Epoch: 6 cost time: 0.6026620864868164
Epoch: 6, Steps: 7 | Train Loss: 1.564 Vali Loss: 1.472 Vali Acc: 0.681 Test Loss: 1.472 Test Acc: 0.681
Validation loss decreased (-0.638872 --> -0.680541).  Saving model ...
Epoch: 7 cost time: 0.5736241340637207
Epoch: 7, Steps: 7 | Train Loss: 1.304 Vali Loss: 1.246 Vali Acc: 0.764 Test Loss: 1.246 Test Acc: 0.764
Validation loss decreased (-0.680541 --> -0.763876).  Saving model ...
Epoch: 8 cost time: 0.5558297634124756
Epoch: 8, Steps: 7 | Train Loss: 1.063 Vali Loss: 1.040 Vali Acc: 0.806 Test Loss: 1.040 Test Acc: 0.806
Validation loss decreased (-0.763876 --> -0.805545).  Saving model ...
Epoch: 9 cost time: 0.6037712097167969
Epoch: 9, Steps: 7 | Train Loss: 0.831 Vali Loss: 0.869 Vali Acc: 0.833 Test Loss: 0.869 Test Acc: 0.833
Validation loss decreased (-0.805545 --> -0.833325).  Saving model ...
Epoch: 10 cost time: 0.5484981536865234
Epoch: 10, Steps: 7 | Train Loss: 0.615 Vali Loss: 0.720 Vali Acc: 0.875 Test Loss: 0.720 Test Acc: 0.875
Validation loss decreased (-0.833325 --> -0.874993).  Saving model ...
Epoch: 11 cost time: 0.6704146862030029
Epoch: 11, Steps: 7 | Train Loss: 0.488 Vali Loss: 0.604 Vali Acc: 0.875 Test Loss: 0.604 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 12 cost time: 0.5892105102539062
Epoch: 12, Steps: 7 | Train Loss: 0.354 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 13 cost time: 0.5245285034179688
Epoch: 13, Steps: 7 | Train Loss: 0.259 Vali Loss: 0.463 Vali Acc: 0.861 Test Loss: 0.463 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6438827514648438
Epoch: 14, Steps: 7 | Train Loss: 0.207 Vali Loss: 0.429 Vali Acc: 0.903 Test Loss: 0.429 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902773).  Saving model ...
Epoch: 15 cost time: 0.5538625717163086
Epoch: 15, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.391 Vali Acc: 0.903 Test Loss: 0.391 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 0.5679764747619629
Epoch: 16, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7418386936187744
Epoch: 17, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6112320423126221
Epoch: 18, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 19 cost time: 0.6052641868591309
Epoch: 19, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.6178603172302246
Epoch: 20, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.5061535835266113
Epoch: 21, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.5120730400085449
Epoch: 22, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6337153911590576
Epoch: 23, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7314484119415283
Epoch: 24, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5331528186798096
Epoch: 25, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.5792837142944336
Epoch: 26, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.5180377960205078
Epoch: 27, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.5925936698913574
Epoch: 28, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.5992686748504639
Epoch: 29, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.5411100387573242
Epoch: 30, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.6069214344024658
Epoch: 31, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6509151458740234
Epoch: 32, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6395096778869629
Epoch: 33, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6441256999969482
Epoch: 34, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6218597888946533
Epoch: 35, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6365516185760498
Epoch: 36, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6560103893280029
Epoch: 37, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6274971961975098
Epoch: 38, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6289317607879639
Epoch: 39, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5700395107269287
Epoch: 40, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df256_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 33468
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.21108341217041
Epoch: 1, Steps: 7 | Train Loss: 2.613 Vali Loss: 2.481 Vali Acc: 0.111 Test Loss: 2.481 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.5864465236663818
Epoch: 2, Steps: 7 | Train Loss: 2.572 Vali Loss: 2.383 Vali Acc: 0.139 Test Loss: 2.383 Test Acc: 0.139
Validation loss decreased (-0.111086 --> -0.138865).  Saving model ...
Epoch: 3 cost time: 0.5705609321594238
Epoch: 3, Steps: 7 | Train Loss: 2.413 Vali Loss: 2.242 Vali Acc: 0.139 Test Loss: 2.242 Test Acc: 0.139
Validation loss decreased (-0.138865 --> -0.138866).  Saving model ...
Epoch: 4 cost time: 0.5976312160491943
Epoch: 4, Steps: 7 | Train Loss: 2.239 Vali Loss: 2.076 Vali Acc: 0.333 Test Loss: 2.076 Test Acc: 0.333
Validation loss decreased (-0.138866 --> -0.333313).  Saving model ...
Epoch: 5 cost time: 0.6308255195617676
Epoch: 5, Steps: 7 | Train Loss: 2.037 Vali Loss: 1.889 Vali Acc: 0.500 Test Loss: 1.889 Test Acc: 0.500
Validation loss decreased (-0.333313 --> -0.499981).  Saving model ...
Epoch: 6 cost time: 0.6282854080200195
Epoch: 6, Steps: 7 | Train Loss: 1.816 Vali Loss: 1.690 Vali Acc: 0.611 Test Loss: 1.690 Test Acc: 0.611
Validation loss decreased (-0.499981 --> -0.611094).  Saving model ...
Epoch: 7 cost time: 0.6212325096130371
Epoch: 7, Steps: 7 | Train Loss: 1.564 Vali Loss: 1.493 Vali Acc: 0.736 Test Loss: 1.493 Test Acc: 0.736
Validation loss decreased (-0.611094 --> -0.736096).  Saving model ...
Epoch: 8 cost time: 0.5602235794067383
Epoch: 8, Steps: 7 | Train Loss: 1.432 Vali Loss: 1.293 Vali Acc: 0.750 Test Loss: 1.293 Test Acc: 0.750
Validation loss decreased (-0.736096 --> -0.749987).  Saving model ...
Epoch: 9 cost time: 0.6326076984405518
Epoch: 9, Steps: 7 | Train Loss: 1.132 Vali Loss: 1.111 Vali Acc: 0.819 Test Loss: 1.111 Test Acc: 0.819
Validation loss decreased (-0.749987 --> -0.819433).  Saving model ...
Epoch: 10 cost time: 0.6429378986358643
Epoch: 10, Steps: 7 | Train Loss: 0.936 Vali Loss: 0.937 Vali Acc: 0.861 Test Loss: 0.937 Test Acc: 0.861
Validation loss decreased (-0.819433 --> -0.861102).  Saving model ...
Epoch: 11 cost time: 0.636408805847168
Epoch: 11, Steps: 7 | Train Loss: 0.777 Vali Loss: 0.793 Vali Acc: 0.889 Test Loss: 0.793 Test Acc: 0.889
Validation loss decreased (-0.861102 --> -0.888881).  Saving model ...
Epoch: 12 cost time: 0.5886738300323486
Epoch: 12, Steps: 7 | Train Loss: 0.623 Vali Loss: 0.682 Vali Acc: 0.889 Test Loss: 0.682 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888882).  Saving model ...
Epoch: 13 cost time: 0.5838456153869629
Epoch: 13, Steps: 7 | Train Loss: 0.481 Vali Loss: 0.597 Vali Acc: 0.889 Test Loss: 0.597 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 14 cost time: 0.5135798454284668
Epoch: 14, Steps: 7 | Train Loss: 0.405 Vali Loss: 0.523 Vali Acc: 0.889 Test Loss: 0.523 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 15 cost time: 0.543628454208374
Epoch: 15, Steps: 7 | Train Loss: 0.296 Vali Loss: 0.479 Vali Acc: 0.889 Test Loss: 0.479 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 16 cost time: 0.5994868278503418
Epoch: 16, Steps: 7 | Train Loss: 0.234 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4973607063293457
Epoch: 17, Steps: 7 | Train Loss: 0.202 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6324071884155273
Epoch: 18, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6366541385650635
Epoch: 19, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.361 Vali Acc: 0.917 Test Loss: 0.361 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 0.627204418182373
Epoch: 20, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.345 Vali Acc: 0.917 Test Loss: 0.345 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 21 cost time: 0.6145572662353516
Epoch: 21, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 22 cost time: 0.5604009628295898
Epoch: 22, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5969412326812744
Epoch: 23, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6454410552978516
Epoch: 24, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.5531759262084961
Epoch: 25, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.6031630039215088
Epoch: 26, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5758144855499268
Epoch: 27, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6233518123626709
Epoch: 28, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.5450987815856934
Epoch: 29, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.6499524116516113
Epoch: 30, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.6217756271362305
Epoch: 31, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.6541216373443604
Epoch: 32, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.5971724987030029
Epoch: 33, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.6335678100585938
Epoch: 34, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6152927875518799
Epoch: 35, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6208319664001465
Epoch: 36, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6549301147460938
Epoch: 37, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6025259494781494
Epoch: 38, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5821323394775391
Epoch: 39, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6064314842224121
Epoch: 40, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6118297576904297
Epoch: 41, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.621971845626831
Epoch: 42, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6366522312164307
Epoch: 43, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 27516
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df256_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.220696210861206
Epoch: 1, Steps: 7 | Train Loss: 2.632 Vali Loss: 2.626 Vali Acc: 0.042 Test Loss: 2.626 Test Acc: 0.042
Validation loss decreased (inf --> -0.041640).  Saving model ...
Epoch: 2 cost time: 0.6317687034606934
Epoch: 2, Steps: 7 | Train Loss: 2.583 Vali Loss: 2.530 Vali Acc: 0.069 Test Loss: 2.530 Test Acc: 0.069
Validation loss decreased (-0.041640 --> -0.069419).  Saving model ...
Epoch: 3 cost time: 0.5861878395080566
Epoch: 3, Steps: 7 | Train Loss: 2.454 Vali Loss: 2.417 Vali Acc: 0.069 Test Loss: 2.417 Test Acc: 0.069
Validation loss decreased (-0.069419 --> -0.069420).  Saving model ...
Epoch: 4 cost time: 0.5493049621582031
Epoch: 4, Steps: 7 | Train Loss: 2.300 Vali Loss: 2.284 Vali Acc: 0.208 Test Loss: 2.284 Test Acc: 0.208
Validation loss decreased (-0.069420 --> -0.208310).  Saving model ...
Epoch: 5 cost time: 0.5923755168914795
Epoch: 5, Steps: 7 | Train Loss: 2.095 Vali Loss: 2.142 Vali Acc: 0.319 Test Loss: 2.142 Test Acc: 0.319
Validation loss decreased (-0.208310 --> -0.319423).  Saving model ...
Epoch: 6 cost time: 0.6420180797576904
Epoch: 6, Steps: 7 | Train Loss: 1.981 Vali Loss: 1.985 Vali Acc: 0.472 Test Loss: 1.985 Test Acc: 0.472
Validation loss decreased (-0.319423 --> -0.472202).  Saving model ...
Epoch: 7 cost time: 0.6176211833953857
Epoch: 7, Steps: 7 | Train Loss: 1.856 Vali Loss: 1.827 Vali Acc: 0.514 Test Loss: 1.827 Test Acc: 0.514
Validation loss decreased (-0.472202 --> -0.513871).  Saving model ...
Epoch: 8 cost time: 0.5747411251068115
Epoch: 8, Steps: 7 | Train Loss: 1.633 Vali Loss: 1.671 Vali Acc: 0.556 Test Loss: 1.671 Test Acc: 0.556
Validation loss decreased (-0.513871 --> -0.555539).  Saving model ...
Epoch: 9 cost time: 0.6049790382385254
Epoch: 9, Steps: 7 | Train Loss: 1.451 Vali Loss: 1.509 Vali Acc: 0.625 Test Loss: 1.509 Test Acc: 0.625
Validation loss decreased (-0.555539 --> -0.624985).  Saving model ...
Epoch: 10 cost time: 0.5622444152832031
Epoch: 10, Steps: 7 | Train Loss: 1.282 Vali Loss: 1.350 Vali Acc: 0.694 Test Loss: 1.350 Test Acc: 0.694
Validation loss decreased (-0.624985 --> -0.694431).  Saving model ...
Epoch: 11 cost time: 0.669083833694458
Epoch: 11, Steps: 7 | Train Loss: 1.118 Vali Loss: 1.196 Vali Acc: 0.764 Test Loss: 1.196 Test Acc: 0.764
Validation loss decreased (-0.694431 --> -0.763877).  Saving model ...
Epoch: 12 cost time: 0.5623898506164551
Epoch: 12, Steps: 7 | Train Loss: 0.974 Vali Loss: 1.069 Vali Acc: 0.792 Test Loss: 1.069 Test Acc: 0.792
Validation loss decreased (-0.763877 --> -0.791656).  Saving model ...
Epoch: 13 cost time: 0.6219320297241211
Epoch: 13, Steps: 7 | Train Loss: 0.804 Vali Loss: 0.951 Vali Acc: 0.833 Test Loss: 0.951 Test Acc: 0.833
Validation loss decreased (-0.791656 --> -0.833324).  Saving model ...
Epoch: 14 cost time: 0.6506805419921875
Epoch: 14, Steps: 7 | Train Loss: 0.695 Vali Loss: 0.834 Vali Acc: 0.847 Test Loss: 0.834 Test Acc: 0.847
Validation loss decreased (-0.833324 --> -0.847214).  Saving model ...
Epoch: 15 cost time: 0.6693062782287598
Epoch: 15, Steps: 7 | Train Loss: 0.552 Vali Loss: 0.740 Vali Acc: 0.861 Test Loss: 0.740 Test Acc: 0.861
Validation loss decreased (-0.847214 --> -0.861104).  Saving model ...
Epoch: 16 cost time: 0.5891132354736328
Epoch: 16, Steps: 7 | Train Loss: 0.476 Vali Loss: 0.673 Vali Acc: 0.903 Test Loss: 0.673 Test Acc: 0.903
Validation loss decreased (-0.861104 --> -0.902771).  Saving model ...
Epoch: 17 cost time: 0.6780073642730713
Epoch: 17, Steps: 7 | Train Loss: 0.405 Vali Loss: 0.607 Vali Acc: 0.889 Test Loss: 0.607 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5528051853179932
Epoch: 18, Steps: 7 | Train Loss: 0.317 Vali Loss: 0.560 Vali Acc: 0.903 Test Loss: 0.560 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902772).  Saving model ...
Epoch: 19 cost time: 0.6553668975830078
Epoch: 19, Steps: 7 | Train Loss: 0.270 Vali Loss: 0.516 Vali Acc: 0.917 Test Loss: 0.516 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916662).  Saving model ...
Epoch: 20 cost time: 0.6553242206573486
Epoch: 20, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.488 Vali Acc: 0.917 Test Loss: 0.488 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 21 cost time: 0.6728570461273193
Epoch: 21, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.462 Vali Acc: 0.931 Test Loss: 0.462 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 22 cost time: 0.6264119148254395
Epoch: 22, Steps: 7 | Train Loss: 0.174 Vali Loss: 0.444 Vali Acc: 0.944 Test Loss: 0.444 Test Acc: 0.944
Validation loss decreased (-0.930551 --> -0.944440).  Saving model ...
Epoch: 23 cost time: 0.7028849124908447
Epoch: 23, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.432 Vali Acc: 0.931 Test Loss: 0.432 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6296098232269287
Epoch: 24, Steps: 7 | Train Loss: 0.147 Vali Loss: 0.417 Vali Acc: 0.931 Test Loss: 0.417 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5887446403503418
Epoch: 25, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.406 Vali Acc: 0.931 Test Loss: 0.406 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5392112731933594
Epoch: 26, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.391 Vali Acc: 0.931 Test Loss: 0.391 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6108348369598389
Epoch: 27, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.376 Vali Acc: 0.931 Test Loss: 0.376 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5956578254699707
Epoch: 28, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.368 Vali Acc: 0.931 Test Loss: 0.368 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6495015621185303
Epoch: 29, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.354 Vali Acc: 0.931 Test Loss: 0.354 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5649285316467285
Epoch: 30, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.347 Vali Acc: 0.931 Test Loss: 0.347 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5803213119506836
Epoch: 31, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.342 Vali Acc: 0.931 Test Loss: 0.342 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6266252994537354
Epoch: 32, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.339 Vali Acc: 0.931 Test Loss: 0.339 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df256_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 23868
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.362281084060669
Epoch: 1, Steps: 7 | Train Loss: 2.552 Vali Loss: 2.497 Vali Acc: 0.097 Test Loss: 2.497 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.6189544200897217
Epoch: 2, Steps: 7 | Train Loss: 2.508 Vali Loss: 2.403 Vali Acc: 0.111 Test Loss: 2.403 Test Acc: 0.111
Validation loss decreased (-0.097197 --> -0.111087).  Saving model ...
Epoch: 3 cost time: 0.6661396026611328
Epoch: 3, Steps: 7 | Train Loss: 2.393 Vali Loss: 2.290 Vali Acc: 0.181 Test Loss: 2.290 Test Acc: 0.181
Validation loss decreased (-0.111087 --> -0.180533).  Saving model ...
Epoch: 4 cost time: 0.6363301277160645
Epoch: 4, Steps: 7 | Train Loss: 2.258 Vali Loss: 2.165 Vali Acc: 0.361 Test Loss: 2.165 Test Acc: 0.361
Validation loss decreased (-0.180533 --> -0.361089).  Saving model ...
Epoch: 5 cost time: 0.6648051738739014
Epoch: 5, Steps: 7 | Train Loss: 2.158 Vali Loss: 2.035 Vali Acc: 0.528 Test Loss: 2.035 Test Acc: 0.528
Validation loss decreased (-0.361089 --> -0.527757).  Saving model ...
Epoch: 6 cost time: 0.6406111717224121
Epoch: 6, Steps: 7 | Train Loss: 1.995 Vali Loss: 1.899 Vali Acc: 0.597 Test Loss: 1.899 Test Acc: 0.597
Validation loss decreased (-0.527757 --> -0.597203).  Saving model ...
Epoch: 7 cost time: 0.6146402359008789
Epoch: 7, Steps: 7 | Train Loss: 1.834 Vali Loss: 1.769 Vali Acc: 0.653 Test Loss: 1.769 Test Acc: 0.653
Validation loss decreased (-0.597203 --> -0.652760).  Saving model ...
Epoch: 8 cost time: 0.6451427936553955
Epoch: 8, Steps: 7 | Train Loss: 1.705 Vali Loss: 1.634 Vali Acc: 0.708 Test Loss: 1.634 Test Acc: 0.708
Validation loss decreased (-0.652760 --> -0.708317).  Saving model ...
Epoch: 9 cost time: 0.5803899765014648
Epoch: 9, Steps: 7 | Train Loss: 1.609 Vali Loss: 1.504 Vali Acc: 0.736 Test Loss: 1.504 Test Acc: 0.736
Validation loss decreased (-0.708317 --> -0.736096).  Saving model ...
Epoch: 10 cost time: 0.6604020595550537
Epoch: 10, Steps: 7 | Train Loss: 1.390 Vali Loss: 1.370 Vali Acc: 0.778 Test Loss: 1.370 Test Acc: 0.778
Validation loss decreased (-0.736096 --> -0.777764).  Saving model ...
Epoch: 11 cost time: 0.594702959060669
Epoch: 11, Steps: 7 | Train Loss: 1.195 Vali Loss: 1.245 Vali Acc: 0.778 Test Loss: 1.245 Test Acc: 0.778
Validation loss decreased (-0.777764 --> -0.777765).  Saving model ...
Epoch: 12 cost time: 0.6007108688354492
Epoch: 12, Steps: 7 | Train Loss: 1.062 Vali Loss: 1.132 Vali Acc: 0.819 Test Loss: 1.132 Test Acc: 0.819
Validation loss decreased (-0.777765 --> -0.819433).  Saving model ...
Epoch: 13 cost time: 0.6301054954528809
Epoch: 13, Steps: 7 | Train Loss: 0.974 Vali Loss: 1.023 Vali Acc: 0.819 Test Loss: 1.023 Test Acc: 0.819
Validation loss decreased (-0.819433 --> -0.819434).  Saving model ...
Epoch: 14 cost time: 0.6005768775939941
Epoch: 14, Steps: 7 | Train Loss: 0.809 Vali Loss: 0.926 Vali Acc: 0.847 Test Loss: 0.926 Test Acc: 0.847
Validation loss decreased (-0.819434 --> -0.847213).  Saving model ...
Epoch: 15 cost time: 0.6042592525482178
Epoch: 15, Steps: 7 | Train Loss: 0.718 Vali Loss: 0.840 Vali Acc: 0.861 Test Loss: 0.840 Test Acc: 0.861
Validation loss decreased (-0.847213 --> -0.861103).  Saving model ...
Epoch: 16 cost time: 0.5648376941680908
Epoch: 16, Steps: 7 | Train Loss: 0.587 Vali Loss: 0.763 Vali Acc: 0.861 Test Loss: 0.763 Test Acc: 0.861
Validation loss decreased (-0.861103 --> -0.861103).  Saving model ...
Epoch: 17 cost time: 0.5819549560546875
Epoch: 17, Steps: 7 | Train Loss: 0.523 Vali Loss: 0.700 Vali Acc: 0.861 Test Loss: 0.700 Test Acc: 0.861
Validation loss decreased (-0.861103 --> -0.861104).  Saving model ...
Epoch: 18 cost time: 0.5515334606170654
Epoch: 18, Steps: 7 | Train Loss: 0.451 Vali Loss: 0.646 Vali Acc: 0.861 Test Loss: 0.646 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861105).  Saving model ...
Epoch: 19 cost time: 0.6639358997344971
Epoch: 19, Steps: 7 | Train Loss: 0.377 Vali Loss: 0.603 Vali Acc: 0.875 Test Loss: 0.603 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874994).  Saving model ...
Epoch: 20 cost time: 0.7074618339538574
Epoch: 20, Steps: 7 | Train Loss: 0.317 Vali Loss: 0.570 Vali Acc: 0.875 Test Loss: 0.570 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 21 cost time: 0.6405675411224365
Epoch: 21, Steps: 7 | Train Loss: 0.287 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 22 cost time: 0.6187665462493896
Epoch: 22, Steps: 7 | Train Loss: 0.229 Vali Loss: 0.521 Vali Acc: 0.875 Test Loss: 0.521 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 0.6615328788757324
Epoch: 23, Steps: 7 | Train Loss: 0.219 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 24 cost time: 0.5994446277618408
Epoch: 24, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 25 cost time: 0.6702196598052979
Epoch: 25, Steps: 7 | Train Loss: 0.178 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 26 cost time: 0.5926418304443359
Epoch: 26, Steps: 7 | Train Loss: 0.170 Vali Loss: 0.460 Vali Acc: 0.889 Test Loss: 0.460 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888884).  Saving model ...
Epoch: 27 cost time: 0.6056098937988281
Epoch: 27, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6280426979064941
Epoch: 28, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6621654033660889
Epoch: 29, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6026883125305176
Epoch: 30, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.417 Vali Acc: 0.903 Test Loss: 0.417 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 31 cost time: 0.6501262187957764
Epoch: 31, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5880498886108398
Epoch: 32, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6220574378967285
Epoch: 33, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5864002704620361
Epoch: 34, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.387 Vali Acc: 0.903 Test Loss: 0.387 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 35 cost time: 0.6430454254150391
Epoch: 35, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.383 Vali Acc: 0.903 Test Loss: 0.383 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 36 cost time: 0.7314848899841309
Epoch: 36, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.380 Vali Acc: 0.903 Test Loss: 0.380 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 37 cost time: 0.6370570659637451
Epoch: 37, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.373 Vali Acc: 0.903 Test Loss: 0.373 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 38 cost time: 0.6358098983764648
Epoch: 38, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.373 Vali Acc: 0.903 Test Loss: 0.373 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 39 cost time: 0.6018221378326416
Epoch: 39, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 40 cost time: 0.6653578281402588
Epoch: 40, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 41 cost time: 0.6422891616821289
Epoch: 41, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 42 cost time: 0.6191372871398926
Epoch: 42, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 43 cost time: 0.5897965431213379
Epoch: 43, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.356 Vali Acc: 0.903 Test Loss: 0.356 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 44 cost time: 0.6001729965209961
Epoch: 44, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 45 cost time: 0.6655292510986328
Epoch: 45, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7467546463012695
Epoch: 46, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5814509391784668
Epoch: 47, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6627306938171387
Epoch: 48, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5823323726654053
Epoch: 49, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6283750534057617
Epoch: 50, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.626082181930542
Epoch: 51, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.6728715896606445
Epoch: 52, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.6011013984680176
Epoch: 53, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.599041223526001
Epoch: 54, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 22524
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df128_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.118501663208008
Epoch: 1, Steps: 7 | Train Loss: 2.529 Vali Loss: 2.448 Vali Acc: 0.208 Test Loss: 2.448 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.5641233921051025
Epoch: 2, Steps: 7 | Train Loss: 2.354 Vali Loss: 2.180 Vali Acc: 0.319 Test Loss: 2.180 Test Acc: 0.319
Validation loss decreased (-0.208309 --> -0.319423).  Saving model ...
Epoch: 3 cost time: 0.6561038494110107
Epoch: 3, Steps: 7 | Train Loss: 2.029 Vali Loss: 1.882 Vali Acc: 0.597 Test Loss: 1.882 Test Acc: 0.597
Validation loss decreased (-0.319423 --> -0.597203).  Saving model ...
Epoch: 4 cost time: 0.5410032272338867
Epoch: 4, Steps: 7 | Train Loss: 1.697 Vali Loss: 1.540 Vali Acc: 0.681 Test Loss: 1.540 Test Acc: 0.681
Validation loss decreased (-0.597203 --> -0.680540).  Saving model ...
Epoch: 5 cost time: 0.6111667156219482
Epoch: 5, Steps: 7 | Train Loss: 1.311 Vali Loss: 1.222 Vali Acc: 0.764 Test Loss: 1.222 Test Acc: 0.764
Validation loss decreased (-0.680540 --> -0.763877).  Saving model ...
Epoch: 6 cost time: 0.6069202423095703
Epoch: 6, Steps: 7 | Train Loss: 0.935 Vali Loss: 0.903 Vali Acc: 0.875 Test Loss: 0.903 Test Acc: 0.875
Validation loss decreased (-0.763877 --> -0.874991).  Saving model ...
Epoch: 7 cost time: 0.5784425735473633
Epoch: 7, Steps: 7 | Train Loss: 0.578 Vali Loss: 0.673 Vali Acc: 0.861 Test Loss: 0.673 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6711735725402832
Epoch: 8, Steps: 7 | Train Loss: 0.381 Vali Loss: 0.534 Vali Acc: 0.917 Test Loss: 0.534 Test Acc: 0.917
Validation loss decreased (-0.874991 --> -0.916661).  Saving model ...
Epoch: 9 cost time: 0.6352899074554443
Epoch: 9, Steps: 7 | Train Loss: 0.222 Vali Loss: 0.436 Vali Acc: 0.903 Test Loss: 0.436 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6179344654083252
Epoch: 10, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.362 Vali Acc: 0.931 Test Loss: 0.362 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 0.6323723793029785
Epoch: 11, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.300 Vali Acc: 0.944 Test Loss: 0.300 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 0.5503103733062744
Epoch: 12, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.5975997447967529
Epoch: 13, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.5312607288360596
Epoch: 14, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.555274248123169
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.5685725212097168
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5816342830657959
Epoch: 17, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5895590782165527
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5526981353759766
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6359670162200928
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5730075836181641
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.6124157905578613
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.6444525718688965
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.5713374614715576
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.6254932880401611
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5882077217102051
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.6148514747619629
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6147236824035645
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5816524028778076
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5587601661682129
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.5533707141876221
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4975392818450928
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5133588314056396
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.5611965656280518
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.588005781173706
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.565619945526123
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.5842788219451904
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.533076286315918
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5529985427856445
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.549572229385376
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5570919513702393
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.618401288986206
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.6354079246520996
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.6284112930297852
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5856025218963623
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6180086135864258
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5502614974975586
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 0.6744134426116943
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5703964233398438
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5916926860809326
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 51 cost time: 0.6412084102630615
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 52 cost time: 0.6107192039489746
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 53 cost time: 0.5405242443084717
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6093862056732178
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5233669281005859
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.5488624572753906
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.6204404830932617
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.5648634433746338
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 59 cost time: 0.5438716411590576
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 60 cost time: 0.5190122127532959
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 61 cost time: 0.6077919006347656
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 62 cost time: 0.5257425308227539
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6480960845947266
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.5817406177520752
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.6223587989807129
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.621208667755127
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 67 cost time: 0.5588662624359131
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 68 cost time: 0.5389935970306396
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 69 cost time: 0.5459249019622803
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.6683435440063477
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.6120419502258301
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.634127140045166
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.6152594089508057
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.5726985931396484
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.6222314834594727
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.5185370445251465
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.6281542778015137
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.6170663833618164
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df128_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 96924
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df128_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1391496658325195
Epoch: 1, Steps: 7 | Train Loss: 2.673 Vali Loss: 2.637 Vali Acc: 0.097 Test Loss: 2.637 Test Acc: 0.097
Validation loss decreased (inf --> -0.097196).  Saving model ...
Epoch: 2 cost time: 0.5683255195617676
Epoch: 2, Steps: 7 | Train Loss: 2.517 Vali Loss: 2.406 Vali Acc: 0.208 Test Loss: 2.406 Test Acc: 0.208
Validation loss decreased (-0.097196 --> -0.208309).  Saving model ...
Epoch: 3 cost time: 0.5903365612030029
Epoch: 3, Steps: 7 | Train Loss: 2.236 Vali Loss: 2.156 Vali Acc: 0.389 Test Loss: 2.156 Test Acc: 0.389
Validation loss decreased (-0.208309 --> -0.388867).  Saving model ...
Epoch: 4 cost time: 0.6303126811981201
Epoch: 4, Steps: 7 | Train Loss: 1.991 Vali Loss: 1.887 Vali Acc: 0.528 Test Loss: 1.887 Test Acc: 0.528
Validation loss decreased (-0.388867 --> -0.527759).  Saving model ...
Epoch: 5 cost time: 0.5834622383117676
Epoch: 5, Steps: 7 | Train Loss: 1.665 Vali Loss: 1.604 Vali Acc: 0.639 Test Loss: 1.604 Test Acc: 0.639
Validation loss decreased (-0.527759 --> -0.638873).  Saving model ...
Epoch: 6 cost time: 0.6120374202728271
Epoch: 6, Steps: 7 | Train Loss: 1.377 Vali Loss: 1.340 Vali Acc: 0.736 Test Loss: 1.340 Test Acc: 0.736
Validation loss decreased (-0.638873 --> -0.736098).  Saving model ...
Epoch: 7 cost time: 0.5308747291564941
Epoch: 7, Steps: 7 | Train Loss: 1.073 Vali Loss: 1.088 Vali Acc: 0.792 Test Loss: 1.088 Test Acc: 0.792
Validation loss decreased (-0.736098 --> -0.791656).  Saving model ...
Epoch: 8 cost time: 0.560887336730957
Epoch: 8, Steps: 7 | Train Loss: 0.786 Vali Loss: 0.861 Vali Acc: 0.806 Test Loss: 0.861 Test Acc: 0.806
Validation loss decreased (-0.791656 --> -0.805547).  Saving model ...
Epoch: 9 cost time: 0.5525410175323486
Epoch: 9, Steps: 7 | Train Loss: 0.543 Vali Loss: 0.672 Vali Acc: 0.861 Test Loss: 0.672 Test Acc: 0.861
Validation loss decreased (-0.805547 --> -0.861104).  Saving model ...
Epoch: 10 cost time: 0.5775375366210938
Epoch: 10, Steps: 7 | Train Loss: 0.350 Vali Loss: 0.566 Vali Acc: 0.861 Test Loss: 0.566 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861105).  Saving model ...
Epoch: 11 cost time: 0.549959659576416
Epoch: 11, Steps: 7 | Train Loss: 0.219 Vali Loss: 0.475 Vali Acc: 0.875 Test Loss: 0.475 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 12 cost time: 0.5958821773529053
Epoch: 12, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.414 Vali Acc: 0.903 Test Loss: 0.414 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 0.5295124053955078
Epoch: 13, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5755670070648193
Epoch: 14, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5309381484985352
Epoch: 15, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6339211463928223
Epoch: 16, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6017153263092041
Epoch: 17, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.6861729621887207
Epoch: 18, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.5632522106170654
Epoch: 19, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6922154426574707
Epoch: 20, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.5967240333557129
Epoch: 21, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.6747329235076904
Epoch: 22, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.630185604095459
Epoch: 23, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.5913364887237549
Epoch: 24, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.6023116111755371
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.6262516975402832
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.6056764125823975
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5841679573059082
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5852136611938477
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5661442279815674
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5773582458496094
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.5985641479492188
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.5819685459136963
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.6678297519683838
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.6800177097320557
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.6718349456787109
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.6576642990112305
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.5560338497161865
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.6600551605224609
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.6878359317779541
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.6661500930786133
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.7004909515380859
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.5764942169189453
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.5683767795562744
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.5611951351165771
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.5869889259338379
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.6847212314605713
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.6332073211669922
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.6155507564544678
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.6297805309295654
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 0.584625244140625
Epoch: 51, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 0.6230871677398682
Epoch: 52, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 0.6947381496429443
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.6247251033782959
Epoch: 54, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6445746421813965
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5621628761291504
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.5467326641082764
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.6198179721832275
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.6612038612365723
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.6012239456176758
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.6464531421661377
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 62 cost time: 0.5842099189758301
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7129538059234619
Epoch: 63, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 64 cost time: 0.723109245300293
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 65 cost time: 0.6218631267547607
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 66 cost time: 0.6041874885559082
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 67 cost time: 0.6546273231506348
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 68 cost time: 0.5948808193206787
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.6386020183563232
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 70 cost time: 0.6635286808013916
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 71 cost time: 0.6925880908966064
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 72 cost time: 0.6562132835388184
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 73 cost time: 0.6538205146789551
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 74 cost time: 0.6617043018341064
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 75 cost time: 0.67496657371521
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.6338744163513184
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 77 cost time: 0.6228978633880615
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 78 cost time: 0.6441500186920166
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 79 cost time: 0.6184215545654297
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 80 cost time: 0.5651521682739258
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 81 cost time: 0.7022483348846436
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.6184217929840088
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.5693018436431885
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.5978457927703857
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.6382725238800049
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.6221034526824951
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.661489725112915
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.6857328414916992
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 0.6631438732147217
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.6812827587127686
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df128_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 51324
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3435468673706055
Epoch: 1, Steps: 7 | Train Loss: 2.675 Vali Loss: 2.580 Vali Acc: 0.028 Test Loss: 2.580 Test Acc: 0.028
Validation loss decreased (inf --> -0.027752).  Saving model ...
Epoch: 2 cost time: 0.7421305179595947
Epoch: 2, Steps: 7 | Train Loss: 2.540 Vali Loss: 2.436 Vali Acc: 0.083 Test Loss: 2.436 Test Acc: 0.083
Validation loss decreased (-0.027752 --> -0.083309).  Saving model ...
Epoch: 3 cost time: 0.558459997177124
Epoch: 3, Steps: 7 | Train Loss: 2.381 Vali Loss: 2.231 Vali Acc: 0.250 Test Loss: 2.231 Test Acc: 0.250
Validation loss decreased (-0.083309 --> -0.249978).  Saving model ...
Epoch: 4 cost time: 0.6213324069976807
Epoch: 4, Steps: 7 | Train Loss: 2.147 Vali Loss: 2.008 Vali Acc: 0.514 Test Loss: 2.008 Test Acc: 0.514
Validation loss decreased (-0.249978 --> -0.513869).  Saving model ...
Epoch: 5 cost time: 0.6155862808227539
Epoch: 5, Steps: 7 | Train Loss: 1.892 Vali Loss: 1.762 Vali Acc: 0.597 Test Loss: 1.762 Test Acc: 0.597
Validation loss decreased (-0.513869 --> -0.597205).  Saving model ...
Epoch: 6 cost time: 0.5950961112976074
Epoch: 6, Steps: 7 | Train Loss: 1.574 Vali Loss: 1.516 Vali Acc: 0.722 Test Loss: 1.516 Test Acc: 0.722
Validation loss decreased (-0.597205 --> -0.722207).  Saving model ...
Epoch: 7 cost time: 0.6535537242889404
Epoch: 7, Steps: 7 | Train Loss: 1.292 Vali Loss: 1.258 Vali Acc: 0.750 Test Loss: 1.258 Test Acc: 0.750
Validation loss decreased (-0.722207 --> -0.749987).  Saving model ...
Epoch: 8 cost time: 0.7041440010070801
Epoch: 8, Steps: 7 | Train Loss: 1.045 Vali Loss: 1.037 Vali Acc: 0.819 Test Loss: 1.037 Test Acc: 0.819
Validation loss decreased (-0.749987 --> -0.819434).  Saving model ...
Epoch: 9 cost time: 0.5880331993103027
Epoch: 9, Steps: 7 | Train Loss: 0.795 Vali Loss: 0.842 Vali Acc: 0.833 Test Loss: 0.842 Test Acc: 0.833
Validation loss decreased (-0.819434 --> -0.833325).  Saving model ...
Epoch: 10 cost time: 0.6679098606109619
Epoch: 10, Steps: 7 | Train Loss: 0.554 Vali Loss: 0.685 Vali Acc: 0.833 Test Loss: 0.685 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833326).  Saving model ...
Epoch: 11 cost time: 0.6262788772583008
Epoch: 11, Steps: 7 | Train Loss: 0.403 Vali Loss: 0.551 Vali Acc: 0.889 Test Loss: 0.551 Test Acc: 0.889
Validation loss decreased (-0.833326 --> -0.888883).  Saving model ...
Epoch: 12 cost time: 0.6130199432373047
Epoch: 12, Steps: 7 | Train Loss: 0.281 Vali Loss: 0.478 Vali Acc: 0.847 Test Loss: 0.478 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6194202899932861
Epoch: 13, Steps: 7 | Train Loss: 0.198 Vali Loss: 0.423 Vali Acc: 0.903 Test Loss: 0.423 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 0.6290550231933594
Epoch: 14, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.373 Vali Acc: 0.917 Test Loss: 0.373 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.5761768817901611
Epoch: 15, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7393856048583984
Epoch: 16, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6976850032806396
Epoch: 17, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7209672927856445
Epoch: 18, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6167123317718506
Epoch: 19, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7580921649932861
Epoch: 20, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.598931074142456
Epoch: 21, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.6512138843536377
Epoch: 22, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7012267112731934
Epoch: 23, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6485974788665771
Epoch: 24, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6202561855316162
Epoch: 25, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.637535810470581
Epoch: 26, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.6632132530212402
Epoch: 27, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5896005630493164
Epoch: 28, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.6575579643249512
Epoch: 29, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.6419744491577148
Epoch: 30, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.6119358539581299
Epoch: 31, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.6222052574157715
Epoch: 32, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.6787981986999512
Epoch: 33, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.5905013084411621
Epoch: 34, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.6533396244049072
Epoch: 35, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6273422241210938
Epoch: 36, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6334030628204346
Epoch: 37, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6665096282958984
Epoch: 38, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6521100997924805
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.5575249195098877
Epoch: 40, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.6714832782745361
Epoch: 41, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.6555306911468506
Epoch: 42, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.6537036895751953
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.6529495716094971
Epoch: 44, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7270281314849854
Epoch: 45, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6742281913757324
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7325286865234375
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7146074771881104
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.652423620223999
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6412763595581055
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.903 Test Loss: 0.204 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.6947071552276611
Epoch: 51, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.7082779407501221
Epoch: 52, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.7731215953826904
Epoch: 53, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 36828
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df128_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.320659875869751
Epoch: 1, Steps: 7 | Train Loss: 2.702 Vali Loss: 2.423 Vali Acc: 0.236 Test Loss: 2.423 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 0.6108837127685547
Epoch: 2, Steps: 7 | Train Loss: 2.588 Vali Loss: 2.315 Vali Acc: 0.292 Test Loss: 2.315 Test Acc: 0.292
Validation loss decreased (-0.236087 --> -0.291644).  Saving model ...
Epoch: 3 cost time: 0.7240939140319824
Epoch: 3, Steps: 7 | Train Loss: 2.398 Vali Loss: 2.160 Vali Acc: 0.333 Test Loss: 2.160 Test Acc: 0.333
Validation loss decreased (-0.291644 --> -0.333312).  Saving model ...
Epoch: 4 cost time: 0.6643574237823486
Epoch: 4, Steps: 7 | Train Loss: 2.190 Vali Loss: 1.970 Vali Acc: 0.514 Test Loss: 1.970 Test Acc: 0.514
Validation loss decreased (-0.333312 --> -0.513869).  Saving model ...
Epoch: 5 cost time: 0.6132509708404541
Epoch: 5, Steps: 7 | Train Loss: 1.962 Vali Loss: 1.756 Vali Acc: 0.625 Test Loss: 1.756 Test Acc: 0.625
Validation loss decreased (-0.513869 --> -0.624982).  Saving model ...
Epoch: 6 cost time: 0.6216731071472168
Epoch: 6, Steps: 7 | Train Loss: 1.732 Vali Loss: 1.522 Vali Acc: 0.708 Test Loss: 1.522 Test Acc: 0.708
Validation loss decreased (-0.624982 --> -0.708318).  Saving model ...
Epoch: 7 cost time: 0.5855422019958496
Epoch: 7, Steps: 7 | Train Loss: 1.423 Vali Loss: 1.292 Vali Acc: 0.764 Test Loss: 1.292 Test Acc: 0.764
Validation loss decreased (-0.708318 --> -0.763876).  Saving model ...
Epoch: 8 cost time: 0.6564121246337891
Epoch: 8, Steps: 7 | Train Loss: 1.151 Vali Loss: 1.072 Vali Acc: 0.847 Test Loss: 1.072 Test Acc: 0.847
Validation loss decreased (-0.763876 --> -0.847211).  Saving model ...
Epoch: 9 cost time: 0.6396586894989014
Epoch: 9, Steps: 7 | Train Loss: 0.909 Vali Loss: 0.885 Vali Acc: 0.889 Test Loss: 0.885 Test Acc: 0.889
Validation loss decreased (-0.847211 --> -0.888880).  Saving model ...
Epoch: 10 cost time: 0.6691563129425049
Epoch: 10, Steps: 7 | Train Loss: 0.688 Vali Loss: 0.728 Vali Acc: 0.903 Test Loss: 0.728 Test Acc: 0.903
Validation loss decreased (-0.888880 --> -0.902771).  Saving model ...
Epoch: 11 cost time: 0.5923559665679932
Epoch: 11, Steps: 7 | Train Loss: 0.549 Vali Loss: 0.611 Vali Acc: 0.917 Test Loss: 0.611 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916661).  Saving model ...
Epoch: 12 cost time: 0.6169326305389404
Epoch: 12, Steps: 7 | Train Loss: 0.358 Vali Loss: 0.504 Vali Acc: 0.944 Test Loss: 0.504 Test Acc: 0.944
Validation loss decreased (-0.916661 --> -0.944439).  Saving model ...
Epoch: 13 cost time: 0.6126632690429688
Epoch: 13, Steps: 7 | Train Loss: 0.273 Vali Loss: 0.430 Vali Acc: 0.944 Test Loss: 0.430 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 14 cost time: 0.6355524063110352
Epoch: 14, Steps: 7 | Train Loss: 0.221 Vali Loss: 0.383 Vali Acc: 0.958 Test Loss: 0.383 Test Acc: 0.958
Validation loss decreased (-0.944440 --> -0.958330).  Saving model ...
Epoch: 15 cost time: 0.6378653049468994
Epoch: 15, Steps: 7 | Train Loss: 0.149 Vali Loss: 0.357 Vali Acc: 0.944 Test Loss: 0.357 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6895568370819092
Epoch: 16, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.339 Vali Acc: 0.958 Test Loss: 0.339 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 17 cost time: 0.599761962890625
Epoch: 17, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.312 Vali Acc: 0.958 Test Loss: 0.312 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 18 cost time: 0.6358954906463623
Epoch: 18, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.298 Vali Acc: 0.958 Test Loss: 0.298 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 19 cost time: 0.6779773235321045
Epoch: 19, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7039330005645752
Epoch: 20, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.277 Vali Acc: 0.958 Test Loss: 0.277 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.6699049472808838
Epoch: 21, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.265 Vali Acc: 0.958 Test Loss: 0.265 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.6347446441650391
Epoch: 22, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.6191794872283936
Epoch: 23, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.258 Vali Acc: 0.958 Test Loss: 0.258 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.6077251434326172
Epoch: 24, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.257 Vali Acc: 0.958 Test Loss: 0.257 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.6104738712310791
Epoch: 25, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.252 Vali Acc: 0.958 Test Loss: 0.252 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.6260426044464111
Epoch: 26, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.245 Vali Acc: 0.958 Test Loss: 0.245 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.5524356365203857
Epoch: 27, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.6310904026031494
Epoch: 28, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.5770597457885742
Epoch: 29, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.5695343017578125
Epoch: 30, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.6532316207885742
Epoch: 31, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.6542758941650391
Epoch: 32, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.5724236965179443
Epoch: 33, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.5636634826660156
Epoch: 34, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.6341955661773682
Epoch: 35, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.6511228084564209
Epoch: 36, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.5652270317077637
Epoch: 37, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5945296287536621
Epoch: 38, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.6016254425048828
Epoch: 39, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.6290113925933838
Epoch: 40, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.6084105968475342
Epoch: 41, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.5819664001464844
Epoch: 42, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.721907377243042
Epoch: 43, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.6515498161315918
Epoch: 44, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6910216808319092
Epoch: 45, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 0.6293962001800537
Epoch: 46, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 0.7130470275878906
Epoch: 47, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 0.6265304088592529
Epoch: 48, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 0.6973469257354736
Epoch: 49, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.6632058620452881
Epoch: 50, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 51 cost time: 0.7005488872528076
Epoch: 51, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 52 cost time: 0.6341149806976318
Epoch: 52, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 53 cost time: 0.6585044860839844
Epoch: 53, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 54 cost time: 0.5902471542358398
Epoch: 54, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 55 cost time: 0.7274632453918457
Epoch: 55, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 56 cost time: 0.604013204574585
Epoch: 56, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.5906970500946045
Epoch: 57, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6028649806976318
Epoch: 58, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.6070942878723145
Epoch: 59, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.6550953388214111
Epoch: 60, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.7426400184631348
Epoch: 61, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.7527308464050293
Epoch: 62, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.6352696418762207
Epoch: 63, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.732384443283081
Epoch: 64, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 65 cost time: 0.7160441875457764
Epoch: 65, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 66 cost time: 0.679309606552124
Epoch: 66, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6238768100738525
Epoch: 67, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 68 cost time: 0.6603777408599854
Epoch: 68, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 69 cost time: 0.673736572265625
Epoch: 69, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 70 cost time: 0.6349287033081055
Epoch: 70, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 71 cost time: 0.626636266708374
Epoch: 71, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 72 cost time: 0.5792727470397949
Epoch: 72, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.6825680732727051
Epoch: 73, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 74 cost time: 0.6226446628570557
Epoch: 74, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 75 cost time: 0.5879683494567871
Epoch: 75, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.6377055644989014
Epoch: 76, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.6796989440917969
Epoch: 77, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 78 cost time: 0.5498533248901367
Epoch: 78, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.6167635917663574
Epoch: 79, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.5999135971069336
Epoch: 80, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.6381721496582031
Epoch: 81, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.6508266925811768
Epoch: 82, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.6734797954559326
Epoch: 83, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.7287302017211914
Epoch: 84, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.7148230075836182
Epoch: 85, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 86 cost time: 0.6928763389587402
Epoch: 86, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 87 cost time: 0.7049281597137451
Epoch: 87, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 88 cost time: 0.60445237159729
Epoch: 88, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 89 cost time: 0.6193687915802002
Epoch: 89, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.6522903442382812
Epoch: 90, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 91 cost time: 0.6374177932739258
Epoch: 91, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.6766817569732666
Epoch: 92, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.6484987735748291
Epoch: 93, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.6640121936798096
Epoch: 94, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.698101282119751
Epoch: 95, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.6028749942779541
Epoch: 96, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 0.6080384254455566
Epoch: 97, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.5949206352233887
Epoch: 98, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 0.7129209041595459
Epoch: 99, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 100 cost time: 0.5873851776123047
Epoch: 100, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df128_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 29244
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.128854513168335
Epoch: 1, Steps: 7 | Train Loss: 2.551 Vali Loss: 2.429 Vali Acc: 0.097 Test Loss: 2.429 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.6618945598602295
Epoch: 2, Steps: 7 | Train Loss: 2.443 Vali Loss: 2.331 Vali Acc: 0.125 Test Loss: 2.331 Test Acc: 0.125
Validation loss decreased (-0.097198 --> -0.124977).  Saving model ...
Epoch: 3 cost time: 0.620955228805542
Epoch: 3, Steps: 7 | Train Loss: 2.350 Vali Loss: 2.186 Vali Acc: 0.236 Test Loss: 2.186 Test Acc: 0.236
Validation loss decreased (-0.124977 --> -0.236089).  Saving model ...
Epoch: 4 cost time: 0.6521928310394287
Epoch: 4, Steps: 7 | Train Loss: 2.226 Vali Loss: 2.012 Vali Acc: 0.389 Test Loss: 2.012 Test Acc: 0.389
Validation loss decreased (-0.236089 --> -0.388869).  Saving model ...
Epoch: 5 cost time: 0.5832633972167969
Epoch: 5, Steps: 7 | Train Loss: 1.962 Vali Loss: 1.826 Vali Acc: 0.542 Test Loss: 1.826 Test Acc: 0.542
Validation loss decreased (-0.388869 --> -0.541648).  Saving model ...
Epoch: 6 cost time: 0.605942964553833
Epoch: 6, Steps: 7 | Train Loss: 1.776 Vali Loss: 1.632 Vali Acc: 0.694 Test Loss: 1.632 Test Acc: 0.694
Validation loss decreased (-0.541648 --> -0.694428).  Saving model ...
Epoch: 7 cost time: 0.5520429611206055
Epoch: 7, Steps: 7 | Train Loss: 1.590 Vali Loss: 1.434 Vali Acc: 0.764 Test Loss: 1.434 Test Acc: 0.764
Validation loss decreased (-0.694428 --> -0.763875).  Saving model ...
Epoch: 8 cost time: 0.6293470859527588
Epoch: 8, Steps: 7 | Train Loss: 1.356 Vali Loss: 1.244 Vali Acc: 0.806 Test Loss: 1.244 Test Acc: 0.806
Validation loss decreased (-0.763875 --> -0.805543).  Saving model ...
Epoch: 9 cost time: 0.6153371334075928
Epoch: 9, Steps: 7 | Train Loss: 1.107 Vali Loss: 1.064 Vali Acc: 0.833 Test Loss: 1.064 Test Acc: 0.833
Validation loss decreased (-0.805543 --> -0.833323).  Saving model ...
Epoch: 10 cost time: 0.6974692344665527
Epoch: 10, Steps: 7 | Train Loss: 0.907 Vali Loss: 0.905 Vali Acc: 0.861 Test Loss: 0.905 Test Acc: 0.861
Validation loss decreased (-0.833323 --> -0.861102).  Saving model ...
Epoch: 11 cost time: 0.6672775745391846
Epoch: 11, Steps: 7 | Train Loss: 0.735 Vali Loss: 0.776 Vali Acc: 0.875 Test Loss: 0.776 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874992).  Saving model ...
Epoch: 12 cost time: 0.6467087268829346
Epoch: 12, Steps: 7 | Train Loss: 0.575 Vali Loss: 0.671 Vali Acc: 0.889 Test Loss: 0.671 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888882).  Saving model ...
Epoch: 13 cost time: 0.6649525165557861
Epoch: 13, Steps: 7 | Train Loss: 0.445 Vali Loss: 0.590 Vali Acc: 0.889 Test Loss: 0.590 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 14 cost time: 0.6191024780273438
Epoch: 14, Steps: 7 | Train Loss: 0.348 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6718909740447998
Epoch: 15, Steps: 7 | Train Loss: 0.287 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6004164218902588
Epoch: 16, Steps: 7 | Train Loss: 0.234 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6692907810211182
Epoch: 17, Steps: 7 | Train Loss: 0.189 Vali Loss: 0.423 Vali Acc: 0.903 Test Loss: 0.423 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902774).  Saving model ...
Epoch: 18 cost time: 0.6851949691772461
Epoch: 18, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.401 Vali Acc: 0.903 Test Loss: 0.401 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 19 cost time: 0.7145304679870605
Epoch: 19, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 20 cost time: 0.5801286697387695
Epoch: 20, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.365 Vali Acc: 0.903 Test Loss: 0.365 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 21 cost time: 0.6678476333618164
Epoch: 21, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 0.6001312732696533
Epoch: 22, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 23 cost time: 0.6646459102630615
Epoch: 23, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 24 cost time: 0.617504358291626
Epoch: 24, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 25 cost time: 0.7051591873168945
Epoch: 25, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 0.6398983001708984
Epoch: 26, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.6299967765808105
Epoch: 27, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.5676765441894531
Epoch: 28, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6567354202270508
Epoch: 29, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7056562900543213
Epoch: 30, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6170578002929688
Epoch: 31, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5533101558685303
Epoch: 32, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6246340274810791
Epoch: 33, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.6422069072723389
Epoch: 34, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6328530311584473
Epoch: 35, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.6920092105865479
Epoch: 36, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.6218063831329346
Epoch: 37, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.6120352745056152
Epoch: 38, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.7402005195617676
Epoch: 39, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6890490055084229
Epoch: 40, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6593058109283447
Epoch: 41, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6005985736846924
Epoch: 42, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6425478458404541
Epoch: 43, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.5455515384674072
Epoch: 44, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.5988602638244629
Epoch: 45, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.5188477039337158
Epoch: 46, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.6445062160491943
Epoch: 47, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6251676082611084
Epoch: 48, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.6131384372711182
Epoch: 49, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.6128048896789551
Epoch: 50, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 51 cost time: 0.5673983097076416
Epoch: 51, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 52 cost time: 0.6711006164550781
Epoch: 52, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 0.6643731594085693
Epoch: 53, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 0.6733658313751221
Epoch: 54, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.686316728591919
Epoch: 55, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6803281307220459
Epoch: 56, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 0.6271517276763916
Epoch: 57, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.7079524993896484
Epoch: 58, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.670438289642334
Epoch: 59, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.6722192764282227
Epoch: 60, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 0.6204657554626465
Epoch: 61, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6958446502685547
Epoch: 62, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.612858772277832
Epoch: 63, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.7399036884307861
Epoch: 64, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.6950914859771729
Epoch: 65, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 66 cost time: 0.5874483585357666
Epoch: 66, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 67 cost time: 0.6594686508178711
Epoch: 67, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6461787223815918
Epoch: 68, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.6160778999328613
Epoch: 69, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.7128477096557617
Epoch: 70, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.6690607070922852
Epoch: 71, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.6188764572143555
Epoch: 72, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.6258065700531006
Epoch: 73, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.7264795303344727
Epoch: 74, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.6887550354003906
Epoch: 75, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.6370620727539062
Epoch: 76, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 23292
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df128_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5206515789031982
Epoch: 1, Steps: 7 | Train Loss: 2.763 Vali Loss: 2.676 Vali Acc: 0.056 Test Loss: 2.676 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 0.5953657627105713
Epoch: 2, Steps: 7 | Train Loss: 2.748 Vali Loss: 2.621 Vali Acc: 0.069 Test Loss: 2.621 Test Acc: 0.069
Validation loss decreased (-0.055529 --> -0.069418).  Saving model ...
Epoch: 3 cost time: 0.5471835136413574
Epoch: 3, Steps: 7 | Train Loss: 2.607 Vali Loss: 2.527 Vali Acc: 0.083 Test Loss: 2.527 Test Acc: 0.083
Validation loss decreased (-0.069418 --> -0.083308).  Saving model ...
Epoch: 4 cost time: 0.6120669841766357
Epoch: 4, Steps: 7 | Train Loss: 2.467 Vali Loss: 2.400 Vali Acc: 0.153 Test Loss: 2.400 Test Acc: 0.153
Validation loss decreased (-0.083308 --> -0.152754).  Saving model ...
Epoch: 5 cost time: 0.7206552028656006
Epoch: 5, Steps: 7 | Train Loss: 2.270 Vali Loss: 2.249 Vali Acc: 0.236 Test Loss: 2.249 Test Acc: 0.236
Validation loss decreased (-0.152754 --> -0.236089).  Saving model ...
Epoch: 6 cost time: 0.5779650211334229
Epoch: 6, Steps: 7 | Train Loss: 2.142 Vali Loss: 2.080 Vali Acc: 0.389 Test Loss: 2.080 Test Acc: 0.389
Validation loss decreased (-0.236089 --> -0.388868).  Saving model ...
Epoch: 7 cost time: 0.6173992156982422
Epoch: 7, Steps: 7 | Train Loss: 1.955 Vali Loss: 1.907 Vali Acc: 0.514 Test Loss: 1.907 Test Acc: 0.514
Validation loss decreased (-0.388868 --> -0.513870).  Saving model ...
Epoch: 8 cost time: 0.5540661811828613
Epoch: 8, Steps: 7 | Train Loss: 1.756 Vali Loss: 1.733 Vali Acc: 0.639 Test Loss: 1.733 Test Acc: 0.639
Validation loss decreased (-0.513870 --> -0.638872).  Saving model ...
Epoch: 9 cost time: 0.5632197856903076
Epoch: 9, Steps: 7 | Train Loss: 1.534 Vali Loss: 1.549 Vali Acc: 0.681 Test Loss: 1.549 Test Acc: 0.681
Validation loss decreased (-0.638872 --> -0.680540).  Saving model ...
Epoch: 10 cost time: 0.6130356788635254
Epoch: 10, Steps: 7 | Train Loss: 1.367 Vali Loss: 1.380 Vali Acc: 0.694 Test Loss: 1.380 Test Acc: 0.694
Validation loss decreased (-0.680540 --> -0.694431).  Saving model ...
Epoch: 11 cost time: 0.564178466796875
Epoch: 11, Steps: 7 | Train Loss: 1.216 Vali Loss: 1.217 Vali Acc: 0.708 Test Loss: 1.217 Test Acc: 0.708
Validation loss decreased (-0.694431 --> -0.708321).  Saving model ...
Epoch: 12 cost time: 0.6258575916290283
Epoch: 12, Steps: 7 | Train Loss: 0.972 Vali Loss: 1.064 Vali Acc: 0.778 Test Loss: 1.064 Test Acc: 0.778
Validation loss decreased (-0.708321 --> -0.777767).  Saving model ...
Epoch: 13 cost time: 0.6078991889953613
Epoch: 13, Steps: 7 | Train Loss: 0.815 Vali Loss: 0.934 Vali Acc: 0.819 Test Loss: 0.934 Test Acc: 0.819
Validation loss decreased (-0.777767 --> -0.819435).  Saving model ...
Epoch: 14 cost time: 0.5938031673431396
Epoch: 14, Steps: 7 | Train Loss: 0.708 Vali Loss: 0.825 Vali Acc: 0.861 Test Loss: 0.825 Test Acc: 0.861
Validation loss decreased (-0.819435 --> -0.861103).  Saving model ...
Epoch: 15 cost time: 0.5859344005584717
Epoch: 15, Steps: 7 | Train Loss: 0.575 Vali Loss: 0.734 Vali Acc: 0.875 Test Loss: 0.734 Test Acc: 0.875
Validation loss decreased (-0.861103 --> -0.874993).  Saving model ...
Epoch: 16 cost time: 0.6516032218933105
Epoch: 16, Steps: 7 | Train Loss: 0.469 Vali Loss: 0.667 Vali Acc: 0.875 Test Loss: 0.667 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 17 cost time: 0.583831787109375
Epoch: 17, Steps: 7 | Train Loss: 0.412 Vali Loss: 0.603 Vali Acc: 0.875 Test Loss: 0.603 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 0.6096827983856201
Epoch: 18, Steps: 7 | Train Loss: 0.337 Vali Loss: 0.559 Vali Acc: 0.875 Test Loss: 0.559 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 19 cost time: 0.6250269412994385
Epoch: 19, Steps: 7 | Train Loss: 0.292 Vali Loss: 0.514 Vali Acc: 0.875 Test Loss: 0.514 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 20 cost time: 0.648928165435791
Epoch: 20, Steps: 7 | Train Loss: 0.255 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 0.6140451431274414
Epoch: 21, Steps: 7 | Train Loss: 0.205 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 22 cost time: 0.7209556102752686
Epoch: 22, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 23 cost time: 0.5909309387207031
Epoch: 23, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 24 cost time: 0.6383926868438721
Epoch: 24, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 25 cost time: 0.5594742298126221
Epoch: 25, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 26 cost time: 0.5952057838439941
Epoch: 26, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.400 Vali Acc: 0.889 Test Loss: 0.400 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 27 cost time: 0.6313350200653076
Epoch: 27, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5495352745056152
Epoch: 28, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 29 cost time: 0.596350908279419
Epoch: 29, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 30 cost time: 0.5947999954223633
Epoch: 30, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.372 Vali Acc: 0.889 Test Loss: 0.372 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 31 cost time: 0.6165704727172852
Epoch: 31, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 32 cost time: 0.6160316467285156
Epoch: 32, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.361 Vali Acc: 0.889 Test Loss: 0.361 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 33 cost time: 0.6586976051330566
Epoch: 33, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 34 cost time: 0.7714471817016602
Epoch: 34, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 35 cost time: 0.6640224456787109
Epoch: 35, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 36 cost time: 0.6203434467315674
Epoch: 36, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 0.5714342594146729
Epoch: 37, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 0.5566952228546143
Epoch: 38, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 0.5940978527069092
Epoch: 39, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916663).  Saving model ...
Epoch: 40 cost time: 0.646033763885498
Epoch: 40, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6950564384460449
Epoch: 41, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6871781349182129
Epoch: 42, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5717558860778809
Epoch: 43, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6462771892547607
Epoch: 44, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6484208106994629
Epoch: 45, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7470455169677734
Epoch: 46, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6797380447387695
Epoch: 47, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.6162636280059814
Epoch: 48, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.6339318752288818
Epoch: 49, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df128_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 19644
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3501367568969727
Epoch: 1, Steps: 7 | Train Loss: 2.547 Vali Loss: 2.539 Vali Acc: 0.111 Test Loss: 2.539 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.6492574214935303
Epoch: 2, Steps: 7 | Train Loss: 2.403 Vali Loss: 2.462 Vali Acc: 0.167 Test Loss: 2.462 Test Acc: 0.167
Validation loss decreased (-0.111086 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 0.6885039806365967
Epoch: 3, Steps: 7 | Train Loss: 2.343 Vali Loss: 2.358 Vali Acc: 0.222 Test Loss: 2.358 Test Acc: 0.222
Validation loss decreased (-0.166642 --> -0.222199).  Saving model ...
Epoch: 4 cost time: 0.7203240394592285
Epoch: 4, Steps: 7 | Train Loss: 2.284 Vali Loss: 2.244 Vali Acc: 0.292 Test Loss: 2.244 Test Acc: 0.292
Validation loss decreased (-0.222199 --> -0.291644).  Saving model ...
Epoch: 5 cost time: 0.706998348236084
Epoch: 5, Steps: 7 | Train Loss: 2.103 Vali Loss: 2.118 Vali Acc: 0.375 Test Loss: 2.118 Test Acc: 0.375
Validation loss decreased (-0.291644 --> -0.374979).  Saving model ...
Epoch: 6 cost time: 0.5894372463226318
Epoch: 6, Steps: 7 | Train Loss: 1.962 Vali Loss: 1.994 Vali Acc: 0.486 Test Loss: 1.994 Test Acc: 0.486
Validation loss decreased (-0.374979 --> -0.486091).  Saving model ...
Epoch: 7 cost time: 0.6646175384521484
Epoch: 7, Steps: 7 | Train Loss: 1.837 Vali Loss: 1.857 Vali Acc: 0.556 Test Loss: 1.857 Test Acc: 0.556
Validation loss decreased (-0.486091 --> -0.555537).  Saving model ...
Epoch: 8 cost time: 0.6517844200134277
Epoch: 8, Steps: 7 | Train Loss: 1.610 Vali Loss: 1.714 Vali Acc: 0.625 Test Loss: 1.714 Test Acc: 0.625
Validation loss decreased (-0.555537 --> -0.624983).  Saving model ...
Epoch: 9 cost time: 0.6909708976745605
Epoch: 9, Steps: 7 | Train Loss: 1.486 Vali Loss: 1.570 Vali Acc: 0.667 Test Loss: 1.570 Test Acc: 0.667
Validation loss decreased (-0.624983 --> -0.666651).  Saving model ...
Epoch: 10 cost time: 0.6589934825897217
Epoch: 10, Steps: 7 | Train Loss: 1.315 Vali Loss: 1.431 Vali Acc: 0.694 Test Loss: 1.431 Test Acc: 0.694
Validation loss decreased (-0.666651 --> -0.694430).  Saving model ...
Epoch: 11 cost time: 0.6421680450439453
Epoch: 11, Steps: 7 | Train Loss: 1.175 Vali Loss: 1.296 Vali Acc: 0.764 Test Loss: 1.296 Test Acc: 0.764
Validation loss decreased (-0.694430 --> -0.763876).  Saving model ...
Epoch: 12 cost time: 0.6855988502502441
Epoch: 12, Steps: 7 | Train Loss: 1.037 Vali Loss: 1.161 Vali Acc: 0.792 Test Loss: 1.161 Test Acc: 0.792
Validation loss decreased (-0.763876 --> -0.791655).  Saving model ...
Epoch: 13 cost time: 0.6630754470825195
Epoch: 13, Steps: 7 | Train Loss: 0.892 Vali Loss: 1.038 Vali Acc: 0.833 Test Loss: 1.038 Test Acc: 0.833
Validation loss decreased (-0.791655 --> -0.833323).  Saving model ...
Epoch: 14 cost time: 0.6543838977813721
Epoch: 14, Steps: 7 | Train Loss: 0.762 Vali Loss: 0.930 Vali Acc: 0.847 Test Loss: 0.930 Test Acc: 0.847
Validation loss decreased (-0.833323 --> -0.847213).  Saving model ...
Epoch: 15 cost time: 0.815748929977417
Epoch: 15, Steps: 7 | Train Loss: 0.661 Vali Loss: 0.839 Vali Acc: 0.875 Test Loss: 0.839 Test Acc: 0.875
Validation loss decreased (-0.847213 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.6542878150939941
Epoch: 16, Steps: 7 | Train Loss: 0.529 Vali Loss: 0.757 Vali Acc: 0.889 Test Loss: 0.757 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888881).  Saving model ...
Epoch: 17 cost time: 0.6626865863800049
Epoch: 17, Steps: 7 | Train Loss: 0.518 Vali Loss: 0.698 Vali Acc: 0.875 Test Loss: 0.698 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6112809181213379
Epoch: 18, Steps: 7 | Train Loss: 0.390 Vali Loss: 0.652 Vali Acc: 0.875 Test Loss: 0.652 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6160876750946045
Epoch: 19, Steps: 7 | Train Loss: 0.364 Vali Loss: 0.608 Vali Acc: 0.889 Test Loss: 0.608 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888883).  Saving model ...
Epoch: 20 cost time: 0.6078848838806152
Epoch: 20, Steps: 7 | Train Loss: 0.301 Vali Loss: 0.580 Vali Acc: 0.889 Test Loss: 0.580 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 21 cost time: 0.5627865791320801
Epoch: 21, Steps: 7 | Train Loss: 0.264 Vali Loss: 0.555 Vali Acc: 0.889 Test Loss: 0.555 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 22 cost time: 0.696622371673584
Epoch: 22, Steps: 7 | Train Loss: 0.238 Vali Loss: 0.541 Vali Acc: 0.875 Test Loss: 0.541 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.539038896560669
Epoch: 23, Steps: 7 | Train Loss: 0.202 Vali Loss: 0.513 Vali Acc: 0.903 Test Loss: 0.513 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902773).  Saving model ...
Epoch: 24 cost time: 0.6268308162689209
Epoch: 24, Steps: 7 | Train Loss: 0.195 Vali Loss: 0.493 Vali Acc: 0.903 Test Loss: 0.493 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 25 cost time: 0.6184797286987305
Epoch: 25, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.481 Vali Acc: 0.903 Test Loss: 0.481 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 26 cost time: 0.8004465103149414
Epoch: 26, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.473 Vali Acc: 0.889 Test Loss: 0.473 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6769943237304688
Epoch: 27, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.459 Vali Acc: 0.903 Test Loss: 0.459 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 28 cost time: 0.647284746170044
Epoch: 28, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.450 Vali Acc: 0.903 Test Loss: 0.450 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 29 cost time: 0.6448945999145508
Epoch: 29, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.443 Vali Acc: 0.889 Test Loss: 0.443 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6336941719055176
Epoch: 30, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.435 Vali Acc: 0.889 Test Loss: 0.435 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6490035057067871
Epoch: 31, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.430 Vali Acc: 0.889 Test Loss: 0.430 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7041821479797363
Epoch: 32, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.421 Vali Acc: 0.889 Test Loss: 0.421 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.556154727935791
Epoch: 33, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.648505449295044
Epoch: 34, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7674529552459717
Epoch: 35, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6195156574249268
Epoch: 36, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.405 Vali Acc: 0.889 Test Loss: 0.405 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6317498683929443
Epoch: 37, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6601057052612305
Epoch: 38, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 18300
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df64_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.170881748199463
Epoch: 1, Steps: 7 | Train Loss: 2.632 Vali Loss: 2.486 Vali Acc: 0.208 Test Loss: 2.486 Test Acc: 0.208
Validation loss decreased (inf --> -0.208308).  Saving model ...
Epoch: 2 cost time: 0.5956470966339111
Epoch: 2, Steps: 7 | Train Loss: 2.455 Vali Loss: 2.212 Vali Acc: 0.292 Test Loss: 2.212 Test Acc: 0.292
Validation loss decreased (-0.208308 --> -0.291645).  Saving model ...
Epoch: 3 cost time: 0.587958574295044
Epoch: 3, Steps: 7 | Train Loss: 2.101 Vali Loss: 1.903 Vali Acc: 0.500 Test Loss: 1.903 Test Acc: 0.500
Validation loss decreased (-0.291645 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 0.5874607563018799
Epoch: 4, Steps: 7 | Train Loss: 1.729 Vali Loss: 1.558 Vali Acc: 0.750 Test Loss: 1.558 Test Acc: 0.750
Validation loss decreased (-0.499981 --> -0.749984).  Saving model ...
Epoch: 5 cost time: 0.64951491355896
Epoch: 5, Steps: 7 | Train Loss: 1.251 Vali Loss: 1.206 Vali Acc: 0.833 Test Loss: 1.206 Test Acc: 0.833
Validation loss decreased (-0.749984 --> -0.833321).  Saving model ...
Epoch: 6 cost time: 0.5951061248779297
Epoch: 6, Steps: 7 | Train Loss: 0.880 Vali Loss: 0.902 Vali Acc: 0.889 Test Loss: 0.902 Test Acc: 0.889
Validation loss decreased (-0.833321 --> -0.888880).  Saving model ...
Epoch: 7 cost time: 0.6420025825500488
Epoch: 7, Steps: 7 | Train Loss: 0.545 Vali Loss: 0.671 Vali Acc: 0.875 Test Loss: 0.671 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6114466190338135
Epoch: 8, Steps: 7 | Train Loss: 0.342 Vali Loss: 0.548 Vali Acc: 0.903 Test Loss: 0.548 Test Acc: 0.903
Validation loss decreased (-0.888880 --> -0.902772).  Saving model ...
Epoch: 9 cost time: 0.6116354465484619
Epoch: 9, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6780147552490234
Epoch: 10, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.352 Vali Acc: 0.931 Test Loss: 0.352 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 0.6423952579498291
Epoch: 11, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.640052318572998
Epoch: 12, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.6392822265625
Epoch: 13, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.5866270065307617
Epoch: 14, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.5843980312347412
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6555955410003662
Epoch: 16, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.5562887191772461
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5806529521942139
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.6158699989318848
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5483748912811279
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.6439604759216309
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.5924012660980225
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.6238856315612793
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.5329806804656982
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.6253101825714111
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.6040966510772705
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5705142021179199
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5872464179992676
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.6067030429840088
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5868327617645264
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.5741114616394043
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5659985542297363
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5694200992584229
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.5896937847137451
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.5228395462036133
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.5413496494293213
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5903658866882324
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6772305965423584
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6141045093536377
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.6022183895111084
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.6391842365264893
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.6335763931274414
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6494274139404297
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6251764297485352
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6717839241027832
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.5951788425445557
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6733484268188477
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.631366491317749
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.5586371421813965
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.5790829658508301
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 0.6122341156005859
Epoch: 51, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958331).  Saving model ...
Epoch: 52 cost time: 0.5543465614318848
Epoch: 52, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 53 cost time: 0.565070629119873
Epoch: 53, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5899651050567627
Epoch: 54, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5630707740783691
Epoch: 55, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6580750942230225
Epoch: 56, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.6738779544830322
Epoch: 57, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.6097557544708252
Epoch: 58, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.5582461357116699
Epoch: 59, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.5873374938964844
Epoch: 60, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.7299916744232178
Epoch: 61, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.6395764350891113
Epoch: 62, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df64_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 94812
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df64_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1836209297180176
Epoch: 1, Steps: 7 | Train Loss: 2.602 Vali Loss: 2.425 Vali Acc: 0.139 Test Loss: 2.425 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.5989775657653809
Epoch: 2, Steps: 7 | Train Loss: 2.442 Vali Loss: 2.235 Vali Acc: 0.236 Test Loss: 2.235 Test Acc: 0.236
Validation loss decreased (-0.138865 --> -0.236089).  Saving model ...
Epoch: 3 cost time: 0.6091980934143066
Epoch: 3, Steps: 7 | Train Loss: 2.255 Vali Loss: 1.988 Vali Acc: 0.417 Test Loss: 1.988 Test Acc: 0.417
Validation loss decreased (-0.236089 --> -0.416647).  Saving model ...
Epoch: 4 cost time: 0.6066930294036865
Epoch: 4, Steps: 7 | Train Loss: 1.856 Vali Loss: 1.700 Vali Acc: 0.625 Test Loss: 1.700 Test Acc: 0.625
Validation loss decreased (-0.416647 --> -0.624983).  Saving model ...
Epoch: 5 cost time: 0.7073802947998047
Epoch: 5, Steps: 7 | Train Loss: 1.620 Vali Loss: 1.396 Vali Acc: 0.722 Test Loss: 1.396 Test Acc: 0.722
Validation loss decreased (-0.624983 --> -0.722208).  Saving model ...
Epoch: 6 cost time: 0.6032931804656982
Epoch: 6, Steps: 7 | Train Loss: 1.189 Vali Loss: 1.103 Vali Acc: 0.847 Test Loss: 1.103 Test Acc: 0.847
Validation loss decreased (-0.722208 --> -0.847211).  Saving model ...
Epoch: 7 cost time: 0.672149658203125
Epoch: 7, Steps: 7 | Train Loss: 0.910 Vali Loss: 0.878 Vali Acc: 0.861 Test Loss: 0.878 Test Acc: 0.861
Validation loss decreased (-0.847211 --> -0.861102).  Saving model ...
Epoch: 8 cost time: 0.617171049118042
Epoch: 8, Steps: 7 | Train Loss: 0.660 Vali Loss: 0.694 Vali Acc: 0.861 Test Loss: 0.694 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861104).  Saving model ...
Epoch: 9 cost time: 0.688232421875
Epoch: 9, Steps: 7 | Train Loss: 0.436 Vali Loss: 0.557 Vali Acc: 0.903 Test Loss: 0.557 Test Acc: 0.903
Validation loss decreased (-0.861104 --> -0.902772).  Saving model ...
Epoch: 10 cost time: 0.7552332878112793
Epoch: 10, Steps: 7 | Train Loss: 0.304 Vali Loss: 0.448 Vali Acc: 0.917 Test Loss: 0.448 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916662).  Saving model ...
Epoch: 11 cost time: 0.6494050025939941
Epoch: 11, Steps: 7 | Train Loss: 0.190 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.674081563949585
Epoch: 12, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.353 Vali Acc: 0.889 Test Loss: 0.353 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6891944408416748
Epoch: 13, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.318 Vali Acc: 0.931 Test Loss: 0.318 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 14 cost time: 0.6025309562683105
Epoch: 14, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.6258766651153564
Epoch: 15, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.6531691551208496
Epoch: 16, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.6564333438873291
Epoch: 17, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.262 Vali Acc: 0.958 Test Loss: 0.262 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.5819952487945557
Epoch: 18, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.250 Vali Acc: 0.958 Test Loss: 0.250 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.5358893871307373
Epoch: 19, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.244 Vali Acc: 0.958 Test Loss: 0.244 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.663689136505127
Epoch: 20, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.6705570220947266
Epoch: 21, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.6650381088256836
Epoch: 22, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.6636562347412109
Epoch: 23, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.6604387760162354
Epoch: 24, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7121388912200928
Epoch: 25, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.7018325328826904
Epoch: 26, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.6638169288635254
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.6977441310882568
Epoch: 28, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.601142406463623
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.6285905838012695
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.6062431335449219
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.7121322154998779
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6169731616973877
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.6599581241607666
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.6148827075958252
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.6228697299957275
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.6220049858093262
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6593520641326904
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.6891820430755615
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.6375570297241211
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.6532018184661865
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.6607739925384521
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.6822695732116699
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.7910003662109375
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.6221811771392822
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 0.7021076679229736
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 0.6727797985076904
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 0.6814837455749512
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6581108570098877
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6480052471160889
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.6392533779144287
Epoch: 51, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.5942080020904541
Epoch: 52, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.6915886402130127
Epoch: 53, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.7212660312652588
Epoch: 54, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.7413487434387207
Epoch: 55, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 56 cost time: 0.6658055782318115
Epoch: 56, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 57 cost time: 0.649669885635376
Epoch: 57, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 58 cost time: 0.6947550773620605
Epoch: 58, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 59 cost time: 0.6648581027984619
Epoch: 59, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 60 cost time: 0.6731975078582764
Epoch: 60, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 61 cost time: 0.6512818336486816
Epoch: 61, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6370811462402344
Epoch: 62, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.6443657875061035
Epoch: 63, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 64 cost time: 0.6994106769561768
Epoch: 64, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 65 cost time: 0.6763055324554443
Epoch: 65, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 66 cost time: 0.5875499248504639
Epoch: 66, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6562497615814209
Epoch: 67, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6267292499542236
Epoch: 68, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.6986203193664551
Epoch: 69, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.7077679634094238
Epoch: 70, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 71 cost time: 0.5936522483825684
Epoch: 71, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 72 cost time: 0.7125649452209473
Epoch: 72, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 73 cost time: 0.6350612640380859
Epoch: 73, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 74 cost time: 0.5759449005126953
Epoch: 74, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 75 cost time: 0.5620555877685547
Epoch: 75, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 76 cost time: 0.6199491024017334
Epoch: 76, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.7037975788116455
Epoch: 77, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.8614661693572998
Epoch: 78, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 79 cost time: 0.7074160575866699
Epoch: 79, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.7042539119720459
Epoch: 80, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 81 cost time: 0.6199524402618408
Epoch: 81, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 82 cost time: 0.642573356628418
Epoch: 82, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 83 cost time: 0.6487550735473633
Epoch: 83, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.5986974239349365
Epoch: 84, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 85 cost time: 0.6284897327423096
Epoch: 85, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 86 cost time: 0.6640243530273438
Epoch: 86, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 87 cost time: 0.6418123245239258
Epoch: 87, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 88 cost time: 0.6747109889984131
Epoch: 88, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 89 cost time: 0.6474902629852295
Epoch: 89, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.7014648914337158
Epoch: 90, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 91 cost time: 0.639312744140625
Epoch: 91, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 92 cost time: 0.6222410202026367
Epoch: 92, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 93 cost time: 0.7058455944061279
Epoch: 93, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 94 cost time: 0.6663374900817871
Epoch: 94, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 95 cost time: 0.704669713973999
Epoch: 95, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.6500098705291748
Epoch: 96, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 97 cost time: 0.6064863204956055
Epoch: 97, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.5949254035949707
Epoch: 98, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.6165854930877686
Epoch: 99, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 0.642812967300415
Epoch: 100, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df64_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 49212
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.005929946899414
Epoch: 1, Steps: 7 | Train Loss: 2.633 Vali Loss: 2.530 Vali Acc: 0.097 Test Loss: 2.530 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.6046955585479736
Epoch: 2, Steps: 7 | Train Loss: 2.558 Vali Loss: 2.361 Vali Acc: 0.153 Test Loss: 2.361 Test Acc: 0.153
Validation loss decreased (-0.097197 --> -0.152754).  Saving model ...
Epoch: 3 cost time: 0.5892348289489746
Epoch: 3, Steps: 7 | Train Loss: 2.335 Vali Loss: 2.137 Vali Acc: 0.389 Test Loss: 2.137 Test Acc: 0.389
Validation loss decreased (-0.152754 --> -0.388868).  Saving model ...
Epoch: 4 cost time: 0.5849673748016357
Epoch: 4, Steps: 7 | Train Loss: 2.046 Vali Loss: 1.892 Vali Acc: 0.569 Test Loss: 1.892 Test Acc: 0.569
Validation loss decreased (-0.388868 --> -0.569426).  Saving model ...
Epoch: 5 cost time: 0.5463929176330566
Epoch: 5, Steps: 7 | Train Loss: 1.700 Vali Loss: 1.639 Vali Acc: 0.653 Test Loss: 1.639 Test Acc: 0.653
Validation loss decreased (-0.569426 --> -0.652761).  Saving model ...
Epoch: 6 cost time: 0.5795648097991943
Epoch: 6, Steps: 7 | Train Loss: 1.489 Vali Loss: 1.387 Vali Acc: 0.736 Test Loss: 1.387 Test Acc: 0.736
Validation loss decreased (-0.652761 --> -0.736097).  Saving model ...
Epoch: 7 cost time: 0.577197790145874
Epoch: 7, Steps: 7 | Train Loss: 1.222 Vali Loss: 1.146 Vali Acc: 0.792 Test Loss: 1.146 Test Acc: 0.792
Validation loss decreased (-0.736097 --> -0.791655).  Saving model ...
Epoch: 8 cost time: 0.5433743000030518
Epoch: 8, Steps: 7 | Train Loss: 0.958 Vali Loss: 0.942 Vali Acc: 0.792 Test Loss: 0.942 Test Acc: 0.792
Validation loss decreased (-0.791655 --> -0.791657).  Saving model ...
Epoch: 9 cost time: 0.5298399925231934
Epoch: 9, Steps: 7 | Train Loss: 0.697 Vali Loss: 0.760 Vali Acc: 0.875 Test Loss: 0.760 Test Acc: 0.875
Validation loss decreased (-0.791657 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 0.5544629096984863
Epoch: 10, Steps: 7 | Train Loss: 0.506 Vali Loss: 0.622 Vali Acc: 0.889 Test Loss: 0.622 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888883).  Saving model ...
Epoch: 11 cost time: 0.5445103645324707
Epoch: 11, Steps: 7 | Train Loss: 0.358 Vali Loss: 0.509 Vali Acc: 0.889 Test Loss: 0.509 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 0.5654220581054688
Epoch: 12, Steps: 7 | Train Loss: 0.268 Vali Loss: 0.431 Vali Acc: 0.889 Test Loss: 0.431 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 0.5964639186859131
Epoch: 13, Steps: 7 | Train Loss: 0.180 Vali Loss: 0.385 Vali Acc: 0.889 Test Loss: 0.385 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.5971436500549316
Epoch: 14, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 0.5891332626342773
Epoch: 15, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.5188155174255371
Epoch: 16, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.5109503269195557
Epoch: 17, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5619258880615234
Epoch: 18, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.5527839660644531
Epoch: 19, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.6097588539123535
Epoch: 20, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.5787162780761719
Epoch: 21, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.5672833919525146
Epoch: 22, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.5318412780761719
Epoch: 23, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.5540177822113037
Epoch: 24, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6146163940429688
Epoch: 25, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5197772979736328
Epoch: 26, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.541595458984375
Epoch: 27, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5604736804962158
Epoch: 28, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.538135290145874
Epoch: 29, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.6246457099914551
Epoch: 30, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5896615982055664
Epoch: 31, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6265981197357178
Epoch: 32, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5345203876495361
Epoch: 33, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6007862091064453
Epoch: 34, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5916016101837158
Epoch: 35, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6447975635528564
Epoch: 36, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5959608554840088
Epoch: 37, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5894455909729004
Epoch: 38, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6103909015655518
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 34716
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df64_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.043760061264038
Epoch: 1, Steps: 7 | Train Loss: 2.588 Vali Loss: 2.624 Vali Acc: 0.083 Test Loss: 2.624 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 0.5261359214782715
Epoch: 2, Steps: 7 | Train Loss: 2.492 Vali Loss: 2.492 Vali Acc: 0.111 Test Loss: 2.492 Test Acc: 0.111
Validation loss decreased (-0.083307 --> -0.111086).  Saving model ...
Epoch: 3 cost time: 0.6234695911407471
Epoch: 3, Steps: 7 | Train Loss: 2.319 Vali Loss: 2.302 Vali Acc: 0.222 Test Loss: 2.302 Test Acc: 0.222
Validation loss decreased (-0.111086 --> -0.222199).  Saving model ...
Epoch: 4 cost time: 0.5672051906585693
Epoch: 4, Steps: 7 | Train Loss: 2.128 Vali Loss: 2.090 Vali Acc: 0.389 Test Loss: 2.090 Test Acc: 0.389
Validation loss decreased (-0.222199 --> -0.388868).  Saving model ...
Epoch: 5 cost time: 0.553774356842041
Epoch: 5, Steps: 7 | Train Loss: 1.890 Vali Loss: 1.851 Vali Acc: 0.486 Test Loss: 1.851 Test Acc: 0.486
Validation loss decreased (-0.388868 --> -0.486093).  Saving model ...
Epoch: 6 cost time: 0.6333794593811035
Epoch: 6, Steps: 7 | Train Loss: 1.648 Vali Loss: 1.608 Vali Acc: 0.653 Test Loss: 1.608 Test Acc: 0.653
Validation loss decreased (-0.486093 --> -0.652762).  Saving model ...
Epoch: 7 cost time: 0.5690600872039795
Epoch: 7, Steps: 7 | Train Loss: 1.375 Vali Loss: 1.372 Vali Acc: 0.778 Test Loss: 1.372 Test Acc: 0.778
Validation loss decreased (-0.652762 --> -0.777764).  Saving model ...
Epoch: 8 cost time: 0.6137487888336182
Epoch: 8, Steps: 7 | Train Loss: 1.134 Vali Loss: 1.147 Vali Acc: 0.806 Test Loss: 1.147 Test Acc: 0.806
Validation loss decreased (-0.777764 --> -0.805544).  Saving model ...
Epoch: 9 cost time: 0.5707588195800781
Epoch: 9, Steps: 7 | Train Loss: 0.913 Vali Loss: 0.950 Vali Acc: 0.806 Test Loss: 0.950 Test Acc: 0.806
Validation loss decreased (-0.805544 --> -0.805546).  Saving model ...
Epoch: 10 cost time: 0.5773961544036865
Epoch: 10, Steps: 7 | Train Loss: 0.682 Vali Loss: 0.794 Vali Acc: 0.847 Test Loss: 0.794 Test Acc: 0.847
Validation loss decreased (-0.805546 --> -0.847214).  Saving model ...
Epoch: 11 cost time: 0.5777013301849365
Epoch: 11, Steps: 7 | Train Loss: 0.526 Vali Loss: 0.658 Vali Acc: 0.875 Test Loss: 0.658 Test Acc: 0.875
Validation loss decreased (-0.847214 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 0.5736534595489502
Epoch: 12, Steps: 7 | Train Loss: 0.383 Vali Loss: 0.566 Vali Acc: 0.875 Test Loss: 0.566 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 0.5607810020446777
Epoch: 13, Steps: 7 | Train Loss: 0.306 Vali Loss: 0.497 Vali Acc: 0.875 Test Loss: 0.497 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 14 cost time: 0.5274713039398193
Epoch: 14, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.448 Vali Acc: 0.889 Test Loss: 0.448 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888884).  Saving model ...
Epoch: 15 cost time: 0.5792195796966553
Epoch: 15, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 0.6578736305236816
Epoch: 16, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 0.5979416370391846
Epoch: 17, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5612912178039551
Epoch: 18, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.358 Vali Acc: 0.861 Test Loss: 0.358 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6343693733215332
Epoch: 19, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.348 Vali Acc: 0.861 Test Loss: 0.348 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.533867597579956
Epoch: 20, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.5612056255340576
Epoch: 21, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.6134138107299805
Epoch: 22, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.5689098834991455
Epoch: 23, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.6366546154022217
Epoch: 24, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.6040749549865723
Epoch: 25, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.5919971466064453
Epoch: 26, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.6065070629119873
Epoch: 27, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.635901927947998
Epoch: 28, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.5776317119598389
Epoch: 29, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.6051747798919678
Epoch: 30, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.578571081161499
Epoch: 31, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.6560430526733398
Epoch: 32, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.5610418319702148
Epoch: 33, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.6309552192687988
Epoch: 34, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.5966498851776123
Epoch: 35, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.6305558681488037
Epoch: 36, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.6453769207000732
Epoch: 37, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.6266927719116211
Epoch: 38, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.6266913414001465
Epoch: 39, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.646005392074585
Epoch: 40, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.621514081954956
Epoch: 41, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6763391494750977
Epoch: 42, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6257271766662598
Epoch: 43, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6031403541564941
Epoch: 44, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.5559887886047363
Epoch: 45, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5652165412902832
Epoch: 46, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.5894603729248047
Epoch: 47, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.5592408180236816
Epoch: 48, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.5964217185974121
Epoch: 49, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.618363618850708
Epoch: 50, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 0.7024247646331787
Epoch: 51, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.6993887424468994
Epoch: 52, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 0.5592513084411621
Epoch: 53, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 0.5833241939544678
Epoch: 54, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 0.6082634925842285
Epoch: 55, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.5775511264801025
Epoch: 56, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.6687040328979492
Epoch: 57, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 0.5544643402099609
Epoch: 58, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 0.6096155643463135
Epoch: 59, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.5608594417572021
Epoch: 60, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.5620541572570801
Epoch: 61, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.5624539852142334
Epoch: 62, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 0.5862386226654053
Epoch: 63, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5209400653839111
Epoch: 64, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 0.5533514022827148
Epoch: 65, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 0.5501837730407715
Epoch: 66, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 0.6674957275390625
Epoch: 67, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6318120956420898
Epoch: 68, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 0.5797779560089111
Epoch: 69, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 0.5671188831329346
Epoch: 70, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 0.5762019157409668
Epoch: 71, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 0.6156070232391357
Epoch: 72, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 73 cost time: 0.56280517578125
Epoch: 73, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7370045185089111
Epoch: 74, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.6070165634155273
Epoch: 75, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.592257022857666
Epoch: 76, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.6162984371185303
Epoch: 77, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.642467737197876
Epoch: 78, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.5848104953765869
Epoch: 79, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.6587207317352295
Epoch: 80, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 81 cost time: 0.6063578128814697
Epoch: 81, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 82 cost time: 0.5494740009307861
Epoch: 82, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.5822582244873047
Epoch: 83, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.6159493923187256
Epoch: 84, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.6227123737335205
Epoch: 85, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.565859317779541
Epoch: 86, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.5634353160858154
Epoch: 87, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 0.5016834735870361
Epoch: 88, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 0.5353946685791016
Epoch: 89, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 0.5893149375915527
Epoch: 90, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 0.6084420680999756
Epoch: 91, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df64_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 27132
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.381039619445801
Epoch: 1, Steps: 7 | Train Loss: 2.639 Vali Loss: 2.641 Vali Acc: 0.028 Test Loss: 2.641 Test Acc: 0.028
Validation loss decreased (inf --> -0.027751).  Saving model ...
Epoch: 2 cost time: 0.6127688884735107
Epoch: 2, Steps: 7 | Train Loss: 2.550 Vali Loss: 2.552 Vali Acc: 0.125 Test Loss: 2.552 Test Acc: 0.125
Validation loss decreased (-0.027751 --> -0.124974).  Saving model ...
Epoch: 3 cost time: 0.6305952072143555
Epoch: 3, Steps: 7 | Train Loss: 2.408 Vali Loss: 2.411 Vali Acc: 0.181 Test Loss: 2.411 Test Acc: 0.181
Validation loss decreased (-0.124974 --> -0.180531).  Saving model ...
Epoch: 4 cost time: 0.5932950973510742
Epoch: 4, Steps: 7 | Train Loss: 2.171 Vali Loss: 2.241 Vali Acc: 0.264 Test Loss: 2.241 Test Acc: 0.264
Validation loss decreased (-0.180531 --> -0.263866).  Saving model ...
Epoch: 5 cost time: 0.5873327255249023
Epoch: 5, Steps: 7 | Train Loss: 2.039 Vali Loss: 2.057 Vali Acc: 0.389 Test Loss: 2.057 Test Acc: 0.389
Validation loss decreased (-0.263866 --> -0.388868).  Saving model ...
Epoch: 6 cost time: 0.6202661991119385
Epoch: 6, Steps: 7 | Train Loss: 1.932 Vali Loss: 1.874 Vali Acc: 0.542 Test Loss: 1.874 Test Acc: 0.542
Validation loss decreased (-0.388868 --> -0.541648).  Saving model ...
Epoch: 7 cost time: 0.5114915370941162
Epoch: 7, Steps: 7 | Train Loss: 1.670 Vali Loss: 1.679 Vali Acc: 0.653 Test Loss: 1.679 Test Acc: 0.653
Validation loss decreased (-0.541648 --> -0.652761).  Saving model ...
Epoch: 8 cost time: 0.5715513229370117
Epoch: 8, Steps: 7 | Train Loss: 1.460 Vali Loss: 1.485 Vali Acc: 0.653 Test Loss: 1.485 Test Acc: 0.653
Validation loss decreased (-0.652761 --> -0.652763).  Saving model ...
Epoch: 9 cost time: 0.5224502086639404
Epoch: 9, Steps: 7 | Train Loss: 1.197 Vali Loss: 1.302 Vali Acc: 0.681 Test Loss: 1.302 Test Acc: 0.681
Validation loss decreased (-0.652763 --> -0.680543).  Saving model ...
Epoch: 10 cost time: 0.5856518745422363
Epoch: 10, Steps: 7 | Train Loss: 1.007 Vali Loss: 1.130 Vali Acc: 0.722 Test Loss: 1.130 Test Acc: 0.722
Validation loss decreased (-0.680543 --> -0.722211).  Saving model ...
Epoch: 11 cost time: 0.5173437595367432
Epoch: 11, Steps: 7 | Train Loss: 0.790 Vali Loss: 0.972 Vali Acc: 0.778 Test Loss: 0.972 Test Acc: 0.778
Validation loss decreased (-0.722211 --> -0.777768).  Saving model ...
Epoch: 12 cost time: 0.6424548625946045
Epoch: 12, Steps: 7 | Train Loss: 0.644 Vali Loss: 0.830 Vali Acc: 0.792 Test Loss: 0.830 Test Acc: 0.792
Validation loss decreased (-0.777768 --> -0.791658).  Saving model ...
Epoch: 13 cost time: 0.6135063171386719
Epoch: 13, Steps: 7 | Train Loss: 0.534 Vali Loss: 0.723 Vali Acc: 0.875 Test Loss: 0.723 Test Acc: 0.875
Validation loss decreased (-0.791658 --> -0.874993).  Saving model ...
Epoch: 14 cost time: 0.6050906181335449
Epoch: 14, Steps: 7 | Train Loss: 0.424 Vali Loss: 0.641 Vali Acc: 0.889 Test Loss: 0.641 Test Acc: 0.889
Validation loss decreased (-0.874993 --> -0.888882).  Saving model ...
Epoch: 15 cost time: 0.7282602787017822
Epoch: 15, Steps: 7 | Train Loss: 0.315 Vali Loss: 0.578 Vali Acc: 0.889 Test Loss: 0.578 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 16 cost time: 0.6540284156799316
Epoch: 16, Steps: 7 | Train Loss: 0.270 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6877522468566895
Epoch: 17, Steps: 7 | Train Loss: 0.219 Vali Loss: 0.503 Vali Acc: 0.889 Test Loss: 0.503 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 18 cost time: 0.6231746673583984
Epoch: 18, Steps: 7 | Train Loss: 0.183 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6697490215301514
Epoch: 19, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.451 Vali Acc: 0.861 Test Loss: 0.451 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6005427837371826
Epoch: 20, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5787529945373535
Epoch: 21, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.629258394241333
Epoch: 22, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5488286018371582
Epoch: 23, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.411 Vali Acc: 0.861 Test Loss: 0.411 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5745656490325928
Epoch: 24, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.395 Vali Acc: 0.861 Test Loss: 0.395 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6005115509033203
Epoch: 25, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6107299327850342
Epoch: 26, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 27 cost time: 0.6793150901794434
Epoch: 27, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 28 cost time: 0.5843250751495361
Epoch: 28, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 29 cost time: 0.6180565357208252
Epoch: 29, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6297645568847656
Epoch: 30, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5765056610107422
Epoch: 31, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7420074939727783
Epoch: 32, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6235156059265137
Epoch: 33, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6465909481048584
Epoch: 34, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6093006134033203
Epoch: 35, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6147873401641846
Epoch: 36, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5833568572998047
Epoch: 37, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.5825135707855225
Epoch: 38, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 21180
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df64_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1303181648254395
Epoch: 1, Steps: 7 | Train Loss: 2.634 Vali Loss: 2.580 Vali Acc: 0.069 Test Loss: 2.580 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.5646278858184814
Epoch: 2, Steps: 7 | Train Loss: 2.604 Vali Loss: 2.529 Vali Acc: 0.069 Test Loss: 2.529 Test Acc: 0.069
Validation loss decreased (-0.069419 --> -0.069419).  Saving model ...
Epoch: 3 cost time: 0.6206569671630859
Epoch: 3, Steps: 7 | Train Loss: 2.489 Vali Loss: 2.450 Vali Acc: 0.139 Test Loss: 2.450 Test Acc: 0.139
Validation loss decreased (-0.069419 --> -0.138864).  Saving model ...
Epoch: 4 cost time: 0.5201053619384766
Epoch: 4, Steps: 7 | Train Loss: 2.335 Vali Loss: 2.346 Vali Acc: 0.236 Test Loss: 2.346 Test Acc: 0.236
Validation loss decreased (-0.138864 --> -0.236088).  Saving model ...
Epoch: 5 cost time: 0.5528700351715088
Epoch: 5, Steps: 7 | Train Loss: 2.212 Vali Loss: 2.224 Vali Acc: 0.278 Test Loss: 2.224 Test Acc: 0.278
Validation loss decreased (-0.236088 --> -0.277756).  Saving model ...
Epoch: 6 cost time: 0.5818450450897217
Epoch: 6, Steps: 7 | Train Loss: 2.112 Vali Loss: 2.099 Vali Acc: 0.333 Test Loss: 2.099 Test Acc: 0.333
Validation loss decreased (-0.277756 --> -0.333312).  Saving model ...
Epoch: 7 cost time: 0.5560834407806396
Epoch: 7, Steps: 7 | Train Loss: 1.912 Vali Loss: 1.959 Vali Acc: 0.417 Test Loss: 1.959 Test Acc: 0.417
Validation loss decreased (-0.333312 --> -0.416647).  Saving model ...
Epoch: 8 cost time: 0.6139109134674072
Epoch: 8, Steps: 7 | Train Loss: 1.758 Vali Loss: 1.821 Vali Acc: 0.500 Test Loss: 1.821 Test Acc: 0.500
Validation loss decreased (-0.416647 --> -0.499982).  Saving model ...
Epoch: 9 cost time: 0.6231157779693604
Epoch: 9, Steps: 7 | Train Loss: 1.582 Vali Loss: 1.682 Vali Acc: 0.569 Test Loss: 1.682 Test Acc: 0.569
Validation loss decreased (-0.499982 --> -0.569428).  Saving model ...
Epoch: 10 cost time: 0.6940231323242188
Epoch: 10, Steps: 7 | Train Loss: 1.388 Vali Loss: 1.542 Vali Acc: 0.611 Test Loss: 1.542 Test Acc: 0.611
Validation loss decreased (-0.569428 --> -0.611096).  Saving model ...
Epoch: 11 cost time: 0.6005704402923584
Epoch: 11, Steps: 7 | Train Loss: 1.271 Vali Loss: 1.401 Vali Acc: 0.681 Test Loss: 1.401 Test Acc: 0.681
Validation loss decreased (-0.611096 --> -0.680542).  Saving model ...
Epoch: 12 cost time: 0.6205601692199707
Epoch: 12, Steps: 7 | Train Loss: 1.100 Vali Loss: 1.261 Vali Acc: 0.681 Test Loss: 1.261 Test Acc: 0.681
Validation loss decreased (-0.680542 --> -0.680543).  Saving model ...
Epoch: 13 cost time: 0.6469535827636719
Epoch: 13, Steps: 7 | Train Loss: 0.981 Vali Loss: 1.127 Vali Acc: 0.694 Test Loss: 1.127 Test Acc: 0.694
Validation loss decreased (-0.680543 --> -0.694433).  Saving model ...
Epoch: 14 cost time: 0.6000244617462158
Epoch: 14, Steps: 7 | Train Loss: 0.801 Vali Loss: 1.008 Vali Acc: 0.736 Test Loss: 1.008 Test Acc: 0.736
Validation loss decreased (-0.694433 --> -0.736101).  Saving model ...
Epoch: 15 cost time: 0.5373382568359375
Epoch: 15, Steps: 7 | Train Loss: 0.665 Vali Loss: 0.900 Vali Acc: 0.764 Test Loss: 0.900 Test Acc: 0.764
Validation loss decreased (-0.736101 --> -0.763880).  Saving model ...
Epoch: 16 cost time: 0.565955638885498
Epoch: 16, Steps: 7 | Train Loss: 0.551 Vali Loss: 0.808 Vali Acc: 0.778 Test Loss: 0.808 Test Acc: 0.778
Validation loss decreased (-0.763880 --> -0.777770).  Saving model ...
Epoch: 17 cost time: 0.5875957012176514
Epoch: 17, Steps: 7 | Train Loss: 0.470 Vali Loss: 0.731 Vali Acc: 0.792 Test Loss: 0.731 Test Acc: 0.792
Validation loss decreased (-0.777770 --> -0.791659).  Saving model ...
Epoch: 18 cost time: 0.5690567493438721
Epoch: 18, Steps: 7 | Train Loss: 0.390 Vali Loss: 0.666 Vali Acc: 0.819 Test Loss: 0.666 Test Acc: 0.819
Validation loss decreased (-0.791659 --> -0.819438).  Saving model ...
Epoch: 19 cost time: 0.618544340133667
Epoch: 19, Steps: 7 | Train Loss: 0.323 Vali Loss: 0.623 Vali Acc: 0.819 Test Loss: 0.623 Test Acc: 0.819
Validation loss decreased (-0.819438 --> -0.819438).  Saving model ...
Epoch: 20 cost time: 0.6141386032104492
Epoch: 20, Steps: 7 | Train Loss: 0.259 Vali Loss: 0.585 Vali Acc: 0.833 Test Loss: 0.585 Test Acc: 0.833
Validation loss decreased (-0.819438 --> -0.833327).  Saving model ...
Epoch: 21 cost time: 0.5880098342895508
Epoch: 21, Steps: 7 | Train Loss: 0.237 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 22 cost time: 0.6129233837127686
Epoch: 22, Steps: 7 | Train Loss: 0.211 Vali Loss: 0.531 Vali Acc: 0.847 Test Loss: 0.531 Test Acc: 0.847
Validation loss decreased (-0.833328 --> -0.847217).  Saving model ...
Epoch: 23 cost time: 0.6406204700469971
Epoch: 23, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6892921924591064
Epoch: 24, Steps: 7 | Train Loss: 0.157 Vali Loss: 0.500 Vali Acc: 0.833 Test Loss: 0.500 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5730383396148682
Epoch: 25, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.483 Vali Acc: 0.847 Test Loss: 0.483 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847217).  Saving model ...
Epoch: 26 cost time: 0.5879864692687988
Epoch: 26, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.475 Vali Acc: 0.833 Test Loss: 0.475 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5642147064208984
Epoch: 27, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.462 Vali Acc: 0.847 Test Loss: 0.462 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847218).  Saving model ...
Epoch: 28 cost time: 0.5554335117340088
Epoch: 28, Steps: 7 | Train Loss: 0.108 Vali Loss: 0.444 Vali Acc: 0.847 Test Loss: 0.444 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 29 cost time: 0.7118854522705078
Epoch: 29, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.429 Vali Acc: 0.847 Test Loss: 0.429 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 30 cost time: 0.6596927642822266
Epoch: 30, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.418 Vali Acc: 0.861 Test Loss: 0.418 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861107).  Saving model ...
Epoch: 31 cost time: 0.5909740924835205
Epoch: 31, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.411 Vali Acc: 0.847 Test Loss: 0.411 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5895090103149414
Epoch: 32, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 33 cost time: 0.5465497970581055
Epoch: 33, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.394 Vali Acc: 0.903 Test Loss: 0.394 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 34 cost time: 0.5858030319213867
Epoch: 34, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5963163375854492
Epoch: 35, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.593416690826416
Epoch: 36, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 37 cost time: 0.5935499668121338
Epoch: 37, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.370 Vali Acc: 0.903 Test Loss: 0.370 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 38 cost time: 0.5916337966918945
Epoch: 38, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 39 cost time: 0.5699324607849121
Epoch: 39, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 40 cost time: 0.5769257545471191
Epoch: 40, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 41 cost time: 0.6238090991973877
Epoch: 41, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 42 cost time: 0.5775735378265381
Epoch: 42, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 43 cost time: 0.6313512325286865
Epoch: 43, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 44 cost time: 0.620164155960083
Epoch: 44, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 45 cost time: 0.5949118137359619
Epoch: 45, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 46 cost time: 0.5363335609436035
Epoch: 46, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 47 cost time: 0.5992472171783447
Epoch: 47, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 48 cost time: 0.5908951759338379
Epoch: 48, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 49 cost time: 0.662895917892456
Epoch: 49, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 50 cost time: 0.5980467796325684
Epoch: 50, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 0.6727597713470459
Epoch: 51, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.5802397727966309
Epoch: 52, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 0.646204948425293
Epoch: 53, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 0.5781948566436768
Epoch: 54, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 0.7160582542419434
Epoch: 55, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 0.6011667251586914
Epoch: 56, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 0.6087422370910645
Epoch: 57, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 0.5869276523590088
Epoch: 58, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 0.6193890571594238
Epoch: 59, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.533477783203125
Epoch: 60, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.6538496017456055
Epoch: 61, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.6233329772949219
Epoch: 62, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.6416361331939697
Epoch: 63, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.6117801666259766
Epoch: 64, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.6478581428527832
Epoch: 65, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.5671231746673584
Epoch: 66, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.5687015056610107
Epoch: 67, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.5618312358856201
Epoch: 68, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.6251368522644043
Epoch: 69, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df64_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 17532
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1604251861572266
Epoch: 1, Steps: 7 | Train Loss: 2.550 Vali Loss: 2.490 Vali Acc: 0.167 Test Loss: 2.490 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 0.5288605690002441
Epoch: 2, Steps: 7 | Train Loss: 2.564 Vali Loss: 2.423 Vali Acc: 0.167 Test Loss: 2.423 Test Acc: 0.167
Validation loss decreased (-0.166642 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 0.6259593963623047
Epoch: 3, Steps: 7 | Train Loss: 2.423 Vali Loss: 2.327 Vali Acc: 0.167 Test Loss: 2.327 Test Acc: 0.167
Validation loss decreased (-0.166642 --> -0.166643).  Saving model ...
Epoch: 4 cost time: 0.5871334075927734
Epoch: 4, Steps: 7 | Train Loss: 2.317 Vali Loss: 2.209 Vali Acc: 0.222 Test Loss: 2.209 Test Acc: 0.222
Validation loss decreased (-0.166643 --> -0.222200).  Saving model ...
Epoch: 5 cost time: 0.5908763408660889
Epoch: 5, Steps: 7 | Train Loss: 2.187 Vali Loss: 2.083 Vali Acc: 0.333 Test Loss: 2.083 Test Acc: 0.333
Validation loss decreased (-0.222200 --> -0.333313).  Saving model ...
Epoch: 6 cost time: 0.5485100746154785
Epoch: 6, Steps: 7 | Train Loss: 1.976 Vali Loss: 1.951 Vali Acc: 0.431 Test Loss: 1.951 Test Acc: 0.431
Validation loss decreased (-0.333313 --> -0.430536).  Saving model ...
Epoch: 7 cost time: 0.548900842666626
Epoch: 7, Steps: 7 | Train Loss: 1.851 Vali Loss: 1.811 Vali Acc: 0.500 Test Loss: 1.811 Test Acc: 0.500
Validation loss decreased (-0.430536 --> -0.499982).  Saving model ...
Epoch: 8 cost time: 0.5662651062011719
Epoch: 8, Steps: 7 | Train Loss: 1.697 Vali Loss: 1.676 Vali Acc: 0.583 Test Loss: 1.676 Test Acc: 0.583
Validation loss decreased (-0.499982 --> -0.583317).  Saving model ...
Epoch: 9 cost time: 0.5817670822143555
Epoch: 9, Steps: 7 | Train Loss: 1.507 Vali Loss: 1.535 Vali Acc: 0.653 Test Loss: 1.535 Test Acc: 0.653
Validation loss decreased (-0.583317 --> -0.652762).  Saving model ...
Epoch: 10 cost time: 0.6598396301269531
Epoch: 10, Steps: 7 | Train Loss: 1.347 Vali Loss: 1.397 Vali Acc: 0.764 Test Loss: 1.397 Test Acc: 0.764
Validation loss decreased (-0.652762 --> -0.763875).  Saving model ...
Epoch: 11 cost time: 0.5253348350524902
Epoch: 11, Steps: 7 | Train Loss: 1.249 Vali Loss: 1.271 Vali Acc: 0.778 Test Loss: 1.271 Test Acc: 0.778
Validation loss decreased (-0.763875 --> -0.777765).  Saving model ...
Epoch: 12 cost time: 0.5991370677947998
Epoch: 12, Steps: 7 | Train Loss: 1.040 Vali Loss: 1.149 Vali Acc: 0.792 Test Loss: 1.149 Test Acc: 0.792
Validation loss decreased (-0.777765 --> -0.791655).  Saving model ...
Epoch: 13 cost time: 0.5682621002197266
Epoch: 13, Steps: 7 | Train Loss: 0.930 Vali Loss: 1.030 Vali Acc: 0.819 Test Loss: 1.030 Test Acc: 0.819
Validation loss decreased (-0.791655 --> -0.819434).  Saving model ...
Epoch: 14 cost time: 0.6080811023712158
Epoch: 14, Steps: 7 | Train Loss: 0.795 Vali Loss: 0.926 Vali Acc: 0.819 Test Loss: 0.926 Test Acc: 0.819
Validation loss decreased (-0.819434 --> -0.819435).  Saving model ...
Epoch: 15 cost time: 0.5908522605895996
Epoch: 15, Steps: 7 | Train Loss: 0.665 Vali Loss: 0.837 Vali Acc: 0.847 Test Loss: 0.837 Test Acc: 0.847
Validation loss decreased (-0.819435 --> -0.847214).  Saving model ...
Epoch: 16 cost time: 0.711359977722168
Epoch: 16, Steps: 7 | Train Loss: 0.581 Vali Loss: 0.763 Vali Acc: 0.833 Test Loss: 0.763 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6018807888031006
Epoch: 17, Steps: 7 | Train Loss: 0.490 Vali Loss: 0.703 Vali Acc: 0.847 Test Loss: 0.703 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847215).  Saving model ...
Epoch: 18 cost time: 0.6729540824890137
Epoch: 18, Steps: 7 | Train Loss: 0.413 Vali Loss: 0.654 Vali Acc: 0.833 Test Loss: 0.654 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5427501201629639
Epoch: 19, Steps: 7 | Train Loss: 0.365 Vali Loss: 0.613 Vali Acc: 0.847 Test Loss: 0.613 Test Acc: 0.847
Validation loss decreased (-0.847215 --> -0.847216).  Saving model ...
Epoch: 20 cost time: 0.614220380783081
Epoch: 20, Steps: 7 | Train Loss: 0.312 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6167938709259033
Epoch: 21, Steps: 7 | Train Loss: 0.294 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6015355587005615
Epoch: 22, Steps: 7 | Train Loss: 0.269 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.649834394454956
Epoch: 23, Steps: 7 | Train Loss: 0.239 Vali Loss: 0.515 Vali Acc: 0.847 Test Loss: 0.515 Test Acc: 0.847
Validation loss decreased (-0.847216 --> -0.847217).  Saving model ...
Epoch: 24 cost time: 0.5569415092468262
Epoch: 24, Steps: 7 | Train Loss: 0.196 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847217).  Saving model ...
Epoch: 25 cost time: 0.6262195110321045
Epoch: 25, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.484 Vali Acc: 0.847 Test Loss: 0.484 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847217).  Saving model ...
Epoch: 26 cost time: 0.5814745426177979
Epoch: 26, Steps: 7 | Train Loss: 0.165 Vali Loss: 0.465 Vali Acc: 0.847 Test Loss: 0.465 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847218).  Saving model ...
Epoch: 27 cost time: 0.582709550857544
Epoch: 27, Steps: 7 | Train Loss: 0.149 Vali Loss: 0.456 Vali Acc: 0.833 Test Loss: 0.456 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5696067810058594
Epoch: 28, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.448 Vali Acc: 0.847 Test Loss: 0.448 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 29 cost time: 0.5548832416534424
Epoch: 29, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.438 Vali Acc: 0.847 Test Loss: 0.438 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 30 cost time: 0.60066819190979
Epoch: 30, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.439 Vali Acc: 0.847 Test Loss: 0.439 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5630233287811279
Epoch: 31, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.440 Vali Acc: 0.847 Test Loss: 0.440 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5283725261688232
Epoch: 32, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.429 Vali Acc: 0.847 Test Loss: 0.429 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 33 cost time: 0.5808768272399902
Epoch: 33, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5664353370666504
Epoch: 34, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.400 Vali Acc: 0.861 Test Loss: 0.400 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861107).  Saving model ...
Epoch: 35 cost time: 0.6317954063415527
Epoch: 35, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.394 Vali Acc: 0.847 Test Loss: 0.394 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.621159553527832
Epoch: 36, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.393 Vali Acc: 0.861 Test Loss: 0.393 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 37 cost time: 0.5938057899475098
Epoch: 37, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.392 Vali Acc: 0.861 Test Loss: 0.392 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 38 cost time: 0.6144304275512695
Epoch: 38, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.389 Vali Acc: 0.875 Test Loss: 0.389 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 39 cost time: 0.5876283645629883
Epoch: 39, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6403155326843262
Epoch: 40, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5695137977600098
Epoch: 41, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.385 Vali Acc: 0.861 Test Loss: 0.385 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5864162445068359
Epoch: 42, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5958089828491211
Epoch: 43, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6440730094909668
Epoch: 44, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 45 cost time: 0.6097927093505859
Epoch: 45, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.368 Vali Acc: 0.861 Test Loss: 0.368 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5936412811279297
Epoch: 46, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 47 cost time: 0.6231734752655029
Epoch: 47, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 48 cost time: 0.5330138206481934
Epoch: 48, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5943582057952881
Epoch: 49, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5652389526367188
Epoch: 50, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 51 cost time: 0.5863454341888428
Epoch: 51, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 52 cost time: 0.5706400871276855
Epoch: 52, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 53 cost time: 0.558129072189331
Epoch: 53, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5959103107452393
Epoch: 54, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.364 Vali Acc: 0.861 Test Loss: 0.364 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5738987922668457
Epoch: 55, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.362 Vali Acc: 0.847 Test Loss: 0.362 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6229588985443115
Epoch: 56, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.356 Vali Acc: 0.861 Test Loss: 0.356 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.5922725200653076
Epoch: 57, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.5834763050079346
Epoch: 58, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.5746665000915527
Epoch: 59, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.6013007164001465
Epoch: 60, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.6184296607971191
Epoch: 61, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.350 Vali Acc: 0.861 Test Loss: 0.350 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.5563642978668213
Epoch: 62, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.350 Vali Acc: 0.861 Test Loss: 0.350 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_PatchTST_UEA_ftM_sl1197_ll0_pl0_el1_dm16_nh4_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 16188
model size : 0.38MB
