Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         1                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 17.04693031311035
Epoch: 1, Steps: 50 | Train Loss: 254.234 Vali Loss: 245.406 Vali Acc: 0.220 Test Loss: 245.406 Test Acc: 0.220
Validation loss decreased (inf --> -0.217546).  Saving model ...
Epoch: 2 cost time: 15.677953720092773
Epoch: 2, Steps: 50 | Train Loss: 30.656 Vali Loss: 154.378 Vali Acc: 0.200 Test Loss: 154.378 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.002856731414795
Epoch: 3, Steps: 50 | Train Loss: 0.000 Vali Loss: 119.416 Vali Acc: 0.260 Test Loss: 119.416 Test Acc: 0.260
Validation loss decreased (-0.217546 --> -0.258806).  Saving model ...
Epoch: 4 cost time: 16.094422101974487
Epoch: 4, Steps: 50 | Train Loss: 0.000 Vali Loss: 115.400 Vali Acc: 0.240 Test Loss: 115.400 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.976932048797607
Epoch: 5, Steps: 50 | Train Loss: 0.000 Vali Loss: 115.296 Vali Acc: 0.240 Test Loss: 115.296 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.17308735847473
Epoch: 6, Steps: 50 | Train Loss: 0.000 Vali Loss: 115.188 Vali Acc: 0.240 Test Loss: 115.188 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.61231517791748
Epoch: 7, Steps: 50 | Train Loss: 0.000 Vali Loss: 115.274 Vali Acc: 0.240 Test Loss: 115.274 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.19899320602417
Epoch: 8, Steps: 50 | Train Loss: 0.000 Vali Loss: 115.341 Vali Acc: 0.240 Test Loss: 115.341 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 16.507653951644897
Epoch: 9, Steps: 50 | Train Loss: 0.000 Vali Loss: 113.964 Vali Acc: 0.260 Test Loss: 113.964 Test Acc: 0.260
Validation loss decreased (-0.258806 --> -0.258860).  Saving model ...
Epoch: 10 cost time: 16.092766761779785
Epoch: 10, Steps: 50 | Train Loss: 0.000 Vali Loss: 114.028 Vali Acc: 0.240 Test Loss: 114.028 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 16.221192836761475
Epoch: 11, Steps: 50 | Train Loss: 0.000 Vali Loss: 114.307 Vali Acc: 0.240 Test Loss: 114.307 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 16.319684743881226
Epoch: 12, Steps: 50 | Train Loss: 0.000 Vali Loss: 114.198 Vali Acc: 0.240 Test Loss: 114.198 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 16.497830629348755
Epoch: 13, Steps: 50 | Train Loss: 0.000 Vali Loss: 114.217 Vali Acc: 0.240 Test Loss: 114.217 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 16.290189266204834
Epoch: 14, Steps: 50 | Train Loss: 0.000 Vali Loss: 114.326 Vali Acc: 0.240 Test Loss: 114.326 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 16.349295377731323
Epoch: 15, Steps: 50 | Train Loss: 0.000 Vali Loss: 114.257 Vali Acc: 0.240 Test Loss: 114.257 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 16.472233057022095
Epoch: 16, Steps: 50 | Train Loss: 0.000 Vali Loss: 114.135 Vali Acc: 0.240 Test Loss: 114.135 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 16.49146842956543
Epoch: 17, Steps: 50 | Train Loss: 0.000 Vali Loss: 114.158 Vali Acc: 0.240 Test Loss: 114.158 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 16.478473901748657
Epoch: 18, Steps: 50 | Train Loss: 0.000 Vali Loss: 114.382 Vali Acc: 0.240 Test Loss: 114.382 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 16.450679540634155
Epoch: 19, Steps: 50 | Train Loss: 0.000 Vali Loss: 114.252 Vali Acc: 0.240 Test Loss: 114.252 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 58072197
model size : 223.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.372251510620117
Epoch: 1, Steps: 13 | Train Loss: 9.901 Vali Loss: 26.633 Vali Acc: 0.220 Test Loss: 26.633 Test Acc: 0.220
Validation loss decreased (inf --> -0.219734).  Saving model ...
Epoch: 2 cost time: 6.832463026046753
Epoch: 2, Steps: 13 | Train Loss: 4.348 Vali Loss: 78.346 Vali Acc: 0.200 Test Loss: 78.346 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.803533554077148
Epoch: 3, Steps: 13 | Train Loss: 5.203 Vali Loss: 233.523 Vali Acc: 0.200 Test Loss: 233.523 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.918983697891235
Epoch: 4, Steps: 13 | Train Loss: 12.161 Vali Loss: 201.906 Vali Acc: 0.220 Test Loss: 201.906 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.15095591545105
Epoch: 5, Steps: 13 | Train Loss: 5.498 Vali Loss: 110.357 Vali Acc: 0.200 Test Loss: 110.357 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.0281407833099365
Epoch: 6, Steps: 13 | Train Loss: 1.587 Vali Loss: 217.171 Vali Acc: 0.220 Test Loss: 217.171 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.911066293716431
Epoch: 7, Steps: 13 | Train Loss: 8.802 Vali Loss: 135.532 Vali Acc: 0.160 Test Loss: 135.532 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.95818567276001
Epoch: 8, Steps: 13 | Train Loss: 6.693 Vali Loss: 158.934 Vali Acc: 0.260 Test Loss: 158.934 Test Acc: 0.260
Validation loss decreased (-0.219734 --> -0.258411).  Saving model ...
Epoch: 9 cost time: 6.966444730758667
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 198.633 Vali Acc: 0.240 Test Loss: 198.633 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.189132928848267
Epoch: 10, Steps: 13 | Train Loss: 0.259 Vali Loss: 231.954 Vali Acc: 0.180 Test Loss: 231.954 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.8241541385650635
Epoch: 11, Steps: 13 | Train Loss: 3.815 Vali Loss: 234.336 Vali Acc: 0.200 Test Loss: 234.336 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.878570318222046
Epoch: 12, Steps: 13 | Train Loss: 9.348 Vali Loss: 266.663 Vali Acc: 0.180 Test Loss: 266.663 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.955342769622803
Epoch: 13, Steps: 13 | Train Loss: 0.899 Vali Loss: 389.420 Vali Acc: 0.220 Test Loss: 389.420 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.973729848861694
Epoch: 14, Steps: 13 | Train Loss: 1.753 Vali Loss: 316.566 Vali Acc: 0.240 Test Loss: 316.566 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.056137561798096
Epoch: 15, Steps: 13 | Train Loss: 2.010 Vali Loss: 234.790 Vali Acc: 0.220 Test Loss: 234.790 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.007885456085205
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 195.278 Vali Acc: 0.200 Test Loss: 195.278 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.995485544204712
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 202.934 Vali Acc: 0.180 Test Loss: 202.934 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.133464574813843
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 209.377 Vali Acc: 0.180 Test Loss: 209.377 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 33109893
model size : 128.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.450340032577515
Epoch: 1, Steps: 13 | Train Loss: 10.539 Vali Loss: 24.503 Vali Acc: 0.200 Test Loss: 24.503 Test Acc: 0.200
Validation loss decreased (inf --> -0.199755).  Saving model ...
Epoch: 2 cost time: 4.156800270080566
Epoch: 2, Steps: 13 | Train Loss: 2.281 Vali Loss: 57.882 Vali Acc: 0.160 Test Loss: 57.882 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.226483345031738
Epoch: 3, Steps: 13 | Train Loss: 5.440 Vali Loss: 62.111 Vali Acc: 0.200 Test Loss: 62.111 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.203988790512085
Epoch: 4, Steps: 13 | Train Loss: 1.113 Vali Loss: 76.174 Vali Acc: 0.140 Test Loss: 76.174 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.440831899642944
Epoch: 5, Steps: 13 | Train Loss: 0.880 Vali Loss: 63.237 Vali Acc: 0.200 Test Loss: 63.237 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.332971572875977
Epoch: 6, Steps: 13 | Train Loss: 0.079 Vali Loss: 115.262 Vali Acc: 0.160 Test Loss: 115.262 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.292989253997803
Epoch: 7, Steps: 13 | Train Loss: 0.939 Vali Loss: 95.554 Vali Acc: 0.200 Test Loss: 95.554 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.439746379852295
Epoch: 8, Steps: 13 | Train Loss: 0.958 Vali Loss: 118.821 Vali Acc: 0.160 Test Loss: 118.821 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.360487937927246
Epoch: 9, Steps: 13 | Train Loss: 0.066 Vali Loss: 116.476 Vali Acc: 0.060 Test Loss: 116.476 Test Acc: 0.060
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.2405030727386475
Epoch: 10, Steps: 13 | Train Loss: 3.960 Vali Loss: 121.283 Vali Acc: 0.180 Test Loss: 121.283 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.404125452041626
Epoch: 11, Steps: 13 | Train Loss: 1.964 Vali Loss: 105.819 Vali Acc: 0.140 Test Loss: 105.819 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 21059589
model size : 82.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df256_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.055939435958862
Epoch: 1, Steps: 13 | Train Loss: 6.378 Vali Loss: 10.322 Vali Acc: 0.080 Test Loss: 10.322 Test Acc: 0.080
Validation loss decreased (inf --> -0.079897).  Saving model ...
Epoch: 2 cost time: 3.633733034133911
Epoch: 2, Steps: 13 | Train Loss: 2.353 Vali Loss: 48.913 Vali Acc: 0.240 Test Loss: 48.913 Test Acc: 0.240
Validation loss decreased (-0.079897 --> -0.239511).  Saving model ...
Epoch: 3 cost time: 3.6165950298309326
Epoch: 3, Steps: 13 | Train Loss: 0.209 Vali Loss: 45.041 Vali Acc: 0.180 Test Loss: 45.041 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.600813388824463
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 64.682 Vali Acc: 0.180 Test Loss: 64.682 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.6186013221740723
Epoch: 5, Steps: 13 | Train Loss: 0.138 Vali Loss: 71.143 Vali Acc: 0.120 Test Loss: 71.143 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.7648086547851562
Epoch: 6, Steps: 13 | Train Loss: 2.691 Vali Loss: 81.179 Vali Acc: 0.200 Test Loss: 81.179 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.7287983894348145
Epoch: 7, Steps: 13 | Train Loss: 6.502 Vali Loss: 112.547 Vali Acc: 0.180 Test Loss: 112.547 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.7255656719207764
Epoch: 8, Steps: 13 | Train Loss: 2.537 Vali Loss: 141.747 Vali Acc: 0.140 Test Loss: 141.747 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.738795757293701
Epoch: 9, Steps: 13 | Train Loss: 2.249 Vali Loss: 128.514 Vali Acc: 0.220 Test Loss: 128.514 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.66282320022583
Epoch: 10, Steps: 13 | Train Loss: 3.150 Vali Loss: 116.031 Vali Acc: 0.120 Test Loss: 116.031 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.742622137069702
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 136.160 Vali Acc: 0.160 Test Loss: 136.160 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.5081915855407715
Epoch: 12, Steps: 13 | Train Loss: 0.431 Vali Loss: 124.233 Vali Acc: 0.160 Test Loss: 124.233 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df256_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 16756357
model size : 66.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.327754259109497
Epoch: 1, Steps: 13 | Train Loss: 4.489 Vali Loss: 10.188 Vali Acc: 0.220 Test Loss: 10.188 Test Acc: 0.220
Validation loss decreased (inf --> -0.219898).  Saving model ...
Epoch: 2 cost time: 2.732754707336426
Epoch: 2, Steps: 13 | Train Loss: 0.039 Vali Loss: 26.498 Vali Acc: 0.220 Test Loss: 26.498 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.799381732940674
Epoch: 3, Steps: 13 | Train Loss: 0.361 Vali Loss: 35.875 Vali Acc: 0.240 Test Loss: 35.875 Test Acc: 0.240
Validation loss decreased (-0.219898 --> -0.239641).  Saving model ...
Epoch: 4 cost time: 2.719259262084961
Epoch: 4, Steps: 13 | Train Loss: 0.002 Vali Loss: 42.207 Vali Acc: 0.160 Test Loss: 42.207 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.776414155960083
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 50.275 Vali Acc: 0.160 Test Loss: 50.275 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.792819023132324
Epoch: 6, Steps: 13 | Train Loss: 0.029 Vali Loss: 42.766 Vali Acc: 0.140 Test Loss: 42.766 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.700415849685669
Epoch: 7, Steps: 13 | Train Loss: 0.608 Vali Loss: 57.320 Vali Acc: 0.160 Test Loss: 57.320 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.6751465797424316
Epoch: 8, Steps: 13 | Train Loss: 2.775 Vali Loss: 67.387 Vali Acc: 0.140 Test Loss: 67.387 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6493871212005615
Epoch: 9, Steps: 13 | Train Loss: 2.390 Vali Loss: 58.274 Vali Acc: 0.180 Test Loss: 58.274 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.7031989097595215
Epoch: 10, Steps: 13 | Train Loss: 2.321 Vali Loss: 62.332 Vali Acc: 0.220 Test Loss: 62.332 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.700505018234253
Epoch: 11, Steps: 13 | Train Loss: 0.008 Vali Loss: 69.851 Vali Acc: 0.220 Test Loss: 69.851 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.806621551513672
Epoch: 12, Steps: 13 | Train Loss: 0.777 Vali Loss: 76.297 Vali Acc: 0.180 Test Loss: 76.297 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.676234245300293
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 61.340 Vali Acc: 0.160 Test Loss: 61.340 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 10732549
model size : 43.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df256_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.957892894744873
Epoch: 1, Steps: 13 | Train Loss: 3.276 Vali Loss: 9.022 Vali Acc: 0.160 Test Loss: 9.022 Test Acc: 0.160
Validation loss decreased (inf --> -0.159910).  Saving model ...
Epoch: 2 cost time: 2.3803207874298096
Epoch: 2, Steps: 13 | Train Loss: 1.408 Vali Loss: 16.028 Vali Acc: 0.180 Test Loss: 16.028 Test Acc: 0.180
Validation loss decreased (-0.159910 --> -0.179840).  Saving model ...
Epoch: 3 cost time: 2.3768527507781982
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 49.373 Vali Acc: 0.180 Test Loss: 49.373 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.411444664001465
Epoch: 4, Steps: 13 | Train Loss: 0.960 Vali Loss: 32.160 Vali Acc: 0.160 Test Loss: 32.160 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.397376537322998
Epoch: 5, Steps: 13 | Train Loss: 0.953 Vali Loss: 27.212 Vali Acc: 0.100 Test Loss: 27.212 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.462059736251831
Epoch: 6, Steps: 13 | Train Loss: 1.031 Vali Loss: 43.028 Vali Acc: 0.200 Test Loss: 43.028 Test Acc: 0.200
Validation loss decreased (-0.179840 --> -0.199570).  Saving model ...
Epoch: 7 cost time: 2.4365322589874268
Epoch: 7, Steps: 13 | Train Loss: 0.013 Vali Loss: 42.679 Vali Acc: 0.160 Test Loss: 42.679 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4255590438842773
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 56.916 Vali Acc: 0.220 Test Loss: 56.916 Test Acc: 0.220
Validation loss decreased (-0.199570 --> -0.219431).  Saving model ...
Epoch: 9 cost time: 2.403426170349121
Epoch: 9, Steps: 13 | Train Loss: 1.173 Vali Loss: 42.916 Vali Acc: 0.200 Test Loss: 42.916 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4117813110351562
Epoch: 10, Steps: 13 | Train Loss: 0.681 Vali Loss: 74.429 Vali Acc: 0.180 Test Loss: 74.429 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4227890968322754
Epoch: 11, Steps: 13 | Train Loss: 1.738 Vali Loss: 87.190 Vali Acc: 0.200 Test Loss: 87.190 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4689855575561523
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 67.512 Vali Acc: 0.180 Test Loss: 67.512 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.417344570159912
Epoch: 13, Steps: 13 | Train Loss: 0.499 Vali Loss: 70.335 Vali Acc: 0.140 Test Loss: 70.335 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.33508563041687
Epoch: 14, Steps: 13 | Train Loss: 0.483 Vali Loss: 70.623 Vali Acc: 0.160 Test Loss: 70.623 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.40114164352417
Epoch: 15, Steps: 13 | Train Loss: 0.436 Vali Loss: 82.996 Vali Acc: 0.160 Test Loss: 82.996 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.385132312774658
Epoch: 16, Steps: 13 | Train Loss: 0.778 Vali Loss: 70.567 Vali Acc: 0.160 Test Loss: 70.567 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5568418502807617
Epoch: 17, Steps: 13 | Train Loss: 1.731 Vali Loss: 70.836 Vali Acc: 0.140 Test Loss: 70.836 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.431272506713867
Epoch: 18, Steps: 13 | Train Loss: 0.294 Vali Loss: 73.127 Vali Acc: 0.140 Test Loss: 73.127 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df256_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 9012613
model size : 36.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6675920486450195
Epoch: 1, Steps: 13 | Train Loss: 2.958 Vali Loss: 5.539 Vali Acc: 0.180 Test Loss: 5.539 Test Acc: 0.180
Validation loss decreased (inf --> -0.179945).  Saving model ...
Epoch: 2 cost time: 2.048569440841675
Epoch: 2, Steps: 13 | Train Loss: 0.136 Vali Loss: 12.283 Vali Acc: 0.180 Test Loss: 12.283 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0956709384918213
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 13.398 Vali Acc: 0.320 Test Loss: 13.398 Test Acc: 0.320
Validation loss decreased (-0.179945 --> -0.319866).  Saving model ...
Epoch: 4 cost time: 2.1004300117492676
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.355 Vali Acc: 0.280 Test Loss: 14.355 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0796709060668945
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.709 Vali Acc: 0.280 Test Loss: 14.709 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.006366014480591
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.840 Vali Acc: 0.280 Test Loss: 14.840 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0694737434387207
Epoch: 7, Steps: 13 | Train Loss: 0.032 Vali Loss: 17.816 Vali Acc: 0.280 Test Loss: 17.816 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0092716217041016
Epoch: 8, Steps: 13 | Train Loss: 0.100 Vali Loss: 41.889 Vali Acc: 0.180 Test Loss: 41.889 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0638458728790283
Epoch: 9, Steps: 13 | Train Loss: 0.449 Vali Loss: 32.325 Vali Acc: 0.180 Test Loss: 32.325 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1159324645996094
Epoch: 10, Steps: 13 | Train Loss: 3.019 Vali Loss: 36.867 Vali Acc: 0.240 Test Loss: 36.867 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.117103099822998
Epoch: 11, Steps: 13 | Train Loss: 4.155 Vali Loss: 46.379 Vali Acc: 0.120 Test Loss: 46.379 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.1316137313842773
Epoch: 12, Steps: 13 | Train Loss: 2.388 Vali Loss: 57.974 Vali Acc: 0.080 Test Loss: 57.974 Test Acc: 0.080
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.221717357635498
Epoch: 13, Steps: 13 | Train Loss: 2.323 Vali Loss: 64.907 Vali Acc: 0.080 Test Loss: 64.907 Test Acc: 0.080
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 6432005
model size : 27.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 16.332927942276
Epoch: 1, Steps: 25 | Train Loss: 68.714 Vali Loss: 92.667 Vali Acc: 0.240 Test Loss: 92.667 Test Acc: 0.240
Validation loss decreased (inf --> -0.239073).  Saving model ...
Epoch: 2 cost time: 15.336200475692749
Epoch: 2, Steps: 25 | Train Loss: 22.206 Vali Loss: 131.653 Vali Acc: 0.120 Test Loss: 131.653 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.525593280792236
Epoch: 3, Steps: 25 | Train Loss: 10.523 Vali Loss: 202.204 Vali Acc: 0.140 Test Loss: 202.204 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.565532684326172
Epoch: 4, Steps: 25 | Train Loss: 2.768 Vali Loss: 195.303 Vali Acc: 0.180 Test Loss: 195.303 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 15.645354747772217
Epoch: 5, Steps: 25 | Train Loss: 14.758 Vali Loss: 249.804 Vali Acc: 0.220 Test Loss: 249.804 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 15.664869785308838
Epoch: 6, Steps: 25 | Train Loss: 18.463 Vali Loss: 235.751 Vali Acc: 0.220 Test Loss: 235.751 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 15.581186771392822
Epoch: 7, Steps: 25 | Train Loss: 5.226 Vali Loss: 148.069 Vali Acc: 0.200 Test Loss: 148.069 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 15.514708995819092
Epoch: 8, Steps: 25 | Train Loss: 3.387 Vali Loss: 170.822 Vali Acc: 0.240 Test Loss: 170.822 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 15.433926343917847
Epoch: 9, Steps: 25 | Train Loss: 0.000 Vali Loss: 155.115 Vali Acc: 0.260 Test Loss: 155.115 Test Acc: 0.260
Validation loss decreased (-0.239073 --> -0.258449).  Saving model ...
Epoch: 10 cost time: 15.270862340927124
Epoch: 10, Steps: 25 | Train Loss: 0.000 Vali Loss: 157.264 Vali Acc: 0.220 Test Loss: 157.264 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.833306550979614
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 158.120 Vali Acc: 0.220 Test Loss: 158.120 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 15.729825735092163
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 158.024 Vali Acc: 0.220 Test Loss: 158.024 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 15.717297077178955
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 158.038 Vali Acc: 0.220 Test Loss: 158.038 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 15.59719204902649
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 157.640 Vali Acc: 0.220 Test Loss: 157.640 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 15.461598873138428
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 157.705 Vali Acc: 0.220 Test Loss: 157.705 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 15.699997663497925
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 157.475 Vali Acc: 0.220 Test Loss: 157.475 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 15.386322259902954
Epoch: 17, Steps: 25 | Train Loss: 0.000 Vali Loss: 157.961 Vali Acc: 0.220 Test Loss: 157.961 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 15.645161867141724
Epoch: 18, Steps: 25 | Train Loss: 0.000 Vali Loss: 157.681 Vali Acc: 0.220 Test Loss: 157.681 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 15.552433729171753
Epoch: 19, Steps: 25 | Train Loss: 0.000 Vali Loss: 157.775 Vali Acc: 0.220 Test Loss: 157.775 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 57973509
model size : 223.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 9.17691159248352
Epoch: 1, Steps: 13 | Train Loss: 13.296 Vali Loss: 43.175 Vali Acc: 0.160 Test Loss: 43.175 Test Acc: 0.160
Validation loss decreased (inf --> -0.159568).  Saving model ...
Epoch: 2 cost time: 7.5578694343566895
Epoch: 2, Steps: 13 | Train Loss: 5.505 Vali Loss: 51.650 Vali Acc: 0.200 Test Loss: 51.650 Test Acc: 0.200
Validation loss decreased (-0.159568 --> -0.199484).  Saving model ...
Epoch: 3 cost time: 7.6109840869903564
Epoch: 3, Steps: 13 | Train Loss: 10.787 Vali Loss: 107.022 Vali Acc: 0.180 Test Loss: 107.022 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.693510055541992
Epoch: 4, Steps: 13 | Train Loss: 21.046 Vali Loss: 140.201 Vali Acc: 0.240 Test Loss: 140.201 Test Acc: 0.240
Validation loss decreased (-0.199484 --> -0.238598).  Saving model ...
Epoch: 5 cost time: 7.802089691162109
Epoch: 5, Steps: 13 | Train Loss: 1.795 Vali Loss: 85.431 Vali Acc: 0.200 Test Loss: 85.431 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.72680139541626
Epoch: 6, Steps: 13 | Train Loss: 2.743 Vali Loss: 129.207 Vali Acc: 0.220 Test Loss: 129.207 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.799389600753784
Epoch: 7, Steps: 13 | Train Loss: 20.794 Vali Loss: 98.714 Vali Acc: 0.160 Test Loss: 98.714 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.685758352279663
Epoch: 8, Steps: 13 | Train Loss: 0.820 Vali Loss: 148.163 Vali Acc: 0.140 Test Loss: 148.163 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.671998977661133
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 141.144 Vali Acc: 0.140 Test Loss: 141.144 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.602236747741699
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 149.237 Vali Acc: 0.120 Test Loss: 149.237 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.715795516967773
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 152.687 Vali Acc: 0.120 Test Loss: 152.687 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.919740438461304
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 153.746 Vali Acc: 0.120 Test Loss: 153.746 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.7461771965026855
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 154.319 Vali Acc: 0.120 Test Loss: 154.319 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.504355192184448
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 154.038 Vali Acc: 0.120 Test Loss: 154.038 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 33011205
model size : 128.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.614678621292114
Epoch: 1, Steps: 13 | Train Loss: 10.064 Vali Loss: 24.418 Vali Acc: 0.200 Test Loss: 24.418 Test Acc: 0.200
Validation loss decreased (inf --> -0.199756).  Saving model ...
Epoch: 2 cost time: 3.8059592247009277
Epoch: 2, Steps: 13 | Train Loss: 3.135 Vali Loss: 72.680 Vali Acc: 0.200 Test Loss: 72.680 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9395787715911865
Epoch: 3, Steps: 13 | Train Loss: 4.882 Vali Loss: 109.009 Vali Acc: 0.200 Test Loss: 109.009 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9631519317626953
Epoch: 4, Steps: 13 | Train Loss: 0.970 Vali Loss: 116.922 Vali Acc: 0.240 Test Loss: 116.922 Test Acc: 0.240
Validation loss decreased (-0.199756 --> -0.238831).  Saving model ...
Epoch: 5 cost time: 3.958277702331543
Epoch: 5, Steps: 13 | Train Loss: 1.293 Vali Loss: 87.343 Vali Acc: 0.220 Test Loss: 87.343 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.046383619308472
Epoch: 6, Steps: 13 | Train Loss: 0.548 Vali Loss: 83.332 Vali Acc: 0.260 Test Loss: 83.332 Test Acc: 0.260
Validation loss decreased (-0.238831 --> -0.259167).  Saving model ...
Epoch: 7 cost time: 3.9394054412841797
Epoch: 7, Steps: 13 | Train Loss: 2.221 Vali Loss: 94.631 Vali Acc: 0.260 Test Loss: 94.631 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.084033966064453
Epoch: 8, Steps: 13 | Train Loss: 3.046 Vali Loss: 99.979 Vali Acc: 0.240 Test Loss: 99.979 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.245812892913818
Epoch: 9, Steps: 13 | Train Loss: 4.936 Vali Loss: 100.877 Vali Acc: 0.160 Test Loss: 100.877 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.2121076583862305
Epoch: 10, Steps: 13 | Train Loss: 1.798 Vali Loss: 88.147 Vali Acc: 0.180 Test Loss: 88.147 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.182301044464111
Epoch: 11, Steps: 13 | Train Loss: 0.405 Vali Loss: 103.932 Vali Acc: 0.140 Test Loss: 103.932 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.1224205493927
Epoch: 12, Steps: 13 | Train Loss: 0.252 Vali Loss: 102.589 Vali Acc: 0.220 Test Loss: 102.589 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.0384135246276855
Epoch: 13, Steps: 13 | Train Loss: 7.383 Vali Loss: 139.938 Vali Acc: 0.180 Test Loss: 139.938 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.023930549621582
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 144.405 Vali Acc: 0.180 Test Loss: 144.405 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.173563003540039
Epoch: 15, Steps: 13 | Train Loss: 0.676 Vali Loss: 137.327 Vali Acc: 0.160 Test Loss: 137.327 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.099592447280884
Epoch: 16, Steps: 13 | Train Loss: 0.482 Vali Loss: 143.937 Vali Acc: 0.180 Test Loss: 143.937 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 20960901
model size : 82.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df128_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.762439966201782
Epoch: 1, Steps: 13 | Train Loss: 5.798 Vali Loss: 13.609 Vali Acc: 0.160 Test Loss: 13.609 Test Acc: 0.160
Validation loss decreased (inf --> -0.159864).  Saving model ...
Epoch: 2 cost time: 3.21760630607605
Epoch: 2, Steps: 13 | Train Loss: 1.440 Vali Loss: 36.397 Vali Acc: 0.220 Test Loss: 36.397 Test Acc: 0.220
Validation loss decreased (-0.159864 --> -0.219636).  Saving model ...
Epoch: 3 cost time: 3.140071153640747
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 63.434 Vali Acc: 0.200 Test Loss: 63.434 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.11962628364563
Epoch: 4, Steps: 13 | Train Loss: 2.447 Vali Loss: 48.681 Vali Acc: 0.200 Test Loss: 48.681 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1429855823516846
Epoch: 5, Steps: 13 | Train Loss: 0.435 Vali Loss: 64.082 Vali Acc: 0.120 Test Loss: 64.082 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3128585815429688
Epoch: 6, Steps: 13 | Train Loss: 0.036 Vali Loss: 75.059 Vali Acc: 0.200 Test Loss: 75.059 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.308830976486206
Epoch: 7, Steps: 13 | Train Loss: 4.516 Vali Loss: 103.935 Vali Acc: 0.200 Test Loss: 103.935 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.3863186836242676
Epoch: 8, Steps: 13 | Train Loss: 3.907 Vali Loss: 94.369 Vali Acc: 0.160 Test Loss: 94.369 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.3267476558685303
Epoch: 9, Steps: 13 | Train Loss: 4.673 Vali Loss: 142.133 Vali Acc: 0.220 Test Loss: 142.133 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.397106170654297
Epoch: 10, Steps: 13 | Train Loss: 3.258 Vali Loss: 105.469 Vali Acc: 0.120 Test Loss: 105.469 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.3074824810028076
Epoch: 11, Steps: 13 | Train Loss: 0.416 Vali Loss: 148.264 Vali Acc: 0.180 Test Loss: 148.264 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.473285436630249
Epoch: 12, Steps: 13 | Train Loss: 0.216 Vali Loss: 109.534 Vali Acc: 0.100 Test Loss: 109.534 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df128_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 16657669
model size : 66.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9077301025390625
Epoch: 1, Steps: 13 | Train Loss: 3.446 Vali Loss: 9.962 Vali Acc: 0.140 Test Loss: 9.962 Test Acc: 0.140
Validation loss decreased (inf --> -0.139900).  Saving model ...
Epoch: 2 cost time: 2.4375669956207275
Epoch: 2, Steps: 13 | Train Loss: 0.512 Vali Loss: 28.898 Vali Acc: 0.180 Test Loss: 28.898 Test Acc: 0.180
Validation loss decreased (-0.139900 --> -0.179711).  Saving model ...
Epoch: 3 cost time: 2.410632848739624
Epoch: 3, Steps: 13 | Train Loss: 1.842 Vali Loss: 32.889 Vali Acc: 0.160 Test Loss: 32.889 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.46874737739563
Epoch: 4, Steps: 13 | Train Loss: 0.113 Vali Loss: 38.512 Vali Acc: 0.160 Test Loss: 38.512 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3516008853912354
Epoch: 5, Steps: 13 | Train Loss: 0.774 Vali Loss: 33.816 Vali Acc: 0.160 Test Loss: 33.816 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5467069149017334
Epoch: 6, Steps: 13 | Train Loss: 0.346 Vali Loss: 63.645 Vali Acc: 0.180 Test Loss: 63.645 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.413919448852539
Epoch: 7, Steps: 13 | Train Loss: 0.243 Vali Loss: 50.987 Vali Acc: 0.120 Test Loss: 50.987 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.363510847091675
Epoch: 8, Steps: 13 | Train Loss: 0.691 Vali Loss: 54.120 Vali Acc: 0.160 Test Loss: 54.120 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.510690450668335
Epoch: 9, Steps: 13 | Train Loss: 0.810 Vali Loss: 62.172 Vali Acc: 0.080 Test Loss: 62.172 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.462125778198242
Epoch: 10, Steps: 13 | Train Loss: 0.887 Vali Loss: 93.702 Vali Acc: 0.180 Test Loss: 93.702 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5623250007629395
Epoch: 11, Steps: 13 | Train Loss: 2.906 Vali Loss: 81.571 Vali Acc: 0.140 Test Loss: 81.571 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.540604591369629
Epoch: 12, Steps: 13 | Train Loss: 5.935 Vali Loss: 94.172 Vali Acc: 0.160 Test Loss: 94.172 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.18
model parameter : 10633861
model size : 43.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df128_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.104940176010132
Epoch: 1, Steps: 13 | Train Loss: 3.954 Vali Loss: 6.954 Vali Acc: 0.260 Test Loss: 6.954 Test Acc: 0.260
Validation loss decreased (inf --> -0.259930).  Saving model ...
Epoch: 2 cost time: 2.3477892875671387
Epoch: 2, Steps: 13 | Train Loss: 0.537 Vali Loss: 36.206 Vali Acc: 0.200 Test Loss: 36.206 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2948663234710693
Epoch: 3, Steps: 13 | Train Loss: 0.192 Vali Loss: 41.745 Vali Acc: 0.200 Test Loss: 41.745 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.34116530418396
Epoch: 4, Steps: 13 | Train Loss: 0.434 Vali Loss: 51.729 Vali Acc: 0.120 Test Loss: 51.729 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3649489879608154
Epoch: 5, Steps: 13 | Train Loss: 0.002 Vali Loss: 52.330 Vali Acc: 0.120 Test Loss: 52.330 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.298588275909424
Epoch: 6, Steps: 13 | Train Loss: 0.301 Vali Loss: 60.586 Vali Acc: 0.220 Test Loss: 60.586 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.412914514541626
Epoch: 7, Steps: 13 | Train Loss: 0.363 Vali Loss: 57.030 Vali Acc: 0.180 Test Loss: 57.030 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.3270416259765625
Epoch: 8, Steps: 13 | Train Loss: 1.393 Vali Loss: 50.247 Vali Acc: 0.200 Test Loss: 50.247 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.3751089572906494
Epoch: 9, Steps: 13 | Train Loss: 0.431 Vali Loss: 44.501 Vali Acc: 0.200 Test Loss: 44.501 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.281611204147339
Epoch: 10, Steps: 13 | Train Loss: 0.952 Vali Loss: 50.919 Vali Acc: 0.220 Test Loss: 50.919 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.2643792629241943
Epoch: 11, Steps: 13 | Train Loss: 0.083 Vali Loss: 63.393 Vali Acc: 0.240 Test Loss: 63.393 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df128_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 8913925
model size : 36.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.673306465148926
Epoch: 1, Steps: 13 | Train Loss: 2.543 Vali Loss: 4.354 Vali Acc: 0.280 Test Loss: 4.354 Test Acc: 0.280
Validation loss decreased (inf --> -0.279956).  Saving model ...
Epoch: 2 cost time: 1.9176051616668701
Epoch: 2, Steps: 13 | Train Loss: 0.030 Vali Loss: 15.371 Vali Acc: 0.240 Test Loss: 15.371 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9932584762573242
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 22.876 Vali Acc: 0.180 Test Loss: 22.876 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0543322563171387
Epoch: 4, Steps: 13 | Train Loss: 0.002 Vali Loss: 14.130 Vali Acc: 0.180 Test Loss: 14.130 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8811659812927246
Epoch: 5, Steps: 13 | Train Loss: 0.271 Vali Loss: 13.738 Vali Acc: 0.220 Test Loss: 13.738 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9487223625183105
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 22.779 Vali Acc: 0.180 Test Loss: 22.779 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9225378036499023
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.678 Vali Acc: 0.180 Test Loss: 26.678 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9777765274047852
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 27.049 Vali Acc: 0.160 Test Loss: 27.049 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.857731819152832
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 27.131 Vali Acc: 0.180 Test Loss: 27.131 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.776839017868042
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 27.564 Vali Acc: 0.160 Test Loss: 27.564 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8510661125183105
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.801 Vali Acc: 0.180 Test Loss: 26.801 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 6333317
model size : 26.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 15.134597539901733
Epoch: 1, Steps: 25 | Train Loss: 61.436 Vali Loss: 147.679 Vali Acc: 0.160 Test Loss: 147.679 Test Acc: 0.160
Validation loss decreased (inf --> -0.158523).  Saving model ...
Epoch: 2 cost time: 14.013062238693237
Epoch: 2, Steps: 25 | Train Loss: 63.502 Vali Loss: 131.067 Vali Acc: 0.180 Test Loss: 131.067 Test Acc: 0.180
Validation loss decreased (-0.158523 --> -0.178689).  Saving model ...
Epoch: 3 cost time: 14.334177732467651
Epoch: 3, Steps: 25 | Train Loss: 3.947 Vali Loss: 270.407 Vali Acc: 0.140 Test Loss: 270.407 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.419795989990234
Epoch: 4, Steps: 25 | Train Loss: 2.169 Vali Loss: 317.653 Vali Acc: 0.120 Test Loss: 317.653 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.313351392745972
Epoch: 5, Steps: 25 | Train Loss: 3.555 Vali Loss: 312.934 Vali Acc: 0.160 Test Loss: 312.934 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.244674921035767
Epoch: 6, Steps: 25 | Train Loss: 31.389 Vali Loss: 348.338 Vali Acc: 0.200 Test Loss: 348.338 Test Acc: 0.200
Validation loss decreased (-0.178689 --> -0.196517).  Saving model ...
Epoch: 7 cost time: 13.949460744857788
Epoch: 7, Steps: 25 | Train Loss: 9.984 Vali Loss: 313.421 Vali Acc: 0.180 Test Loss: 313.421 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.217101812362671
Epoch: 8, Steps: 25 | Train Loss: 0.839 Vali Loss: 160.183 Vali Acc: 0.200 Test Loss: 160.183 Test Acc: 0.200
Validation loss decreased (-0.196517 --> -0.198398).  Saving model ...
Epoch: 9 cost time: 14.055878639221191
Epoch: 9, Steps: 25 | Train Loss: 2.351 Vali Loss: 89.076 Vali Acc: 0.200 Test Loss: 89.076 Test Acc: 0.200
Validation loss decreased (-0.198398 --> -0.199109).  Saving model ...
Epoch: 10 cost time: 14.147235631942749
Epoch: 10, Steps: 25 | Train Loss: 0.000 Vali Loss: 85.434 Vali Acc: 0.160 Test Loss: 85.434 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 14.13564133644104
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 85.214 Vali Acc: 0.160 Test Loss: 85.214 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.172217607498169
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 85.322 Vali Acc: 0.160 Test Loss: 85.322 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 14.381439447402954
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 85.185 Vali Acc: 0.160 Test Loss: 85.185 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 14.433831214904785
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 85.308 Vali Acc: 0.160 Test Loss: 85.308 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 14.254780769348145
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 85.275 Vali Acc: 0.160 Test Loss: 85.275 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 14.39759111404419
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 85.159 Vali Acc: 0.160 Test Loss: 85.159 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 14.527880191802979
Epoch: 17, Steps: 25 | Train Loss: 0.000 Vali Loss: 85.288 Vali Acc: 0.160 Test Loss: 85.288 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 14.61165452003479
Epoch: 18, Steps: 25 | Train Loss: 0.000 Vali Loss: 85.322 Vali Acc: 0.160 Test Loss: 85.322 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 14.367793560028076
Epoch: 19, Steps: 25 | Train Loss: 0.000 Vali Loss: 85.295 Vali Acc: 0.160 Test Loss: 85.295 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 57924165
model size : 223.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.091609716415405
Epoch: 1, Steps: 13 | Train Loss: 10.780 Vali Loss: 35.729 Vali Acc: 0.200 Test Loss: 35.729 Test Acc: 0.200
Validation loss decreased (inf --> -0.199643).  Saving model ...
Epoch: 2 cost time: 6.578646183013916
Epoch: 2, Steps: 13 | Train Loss: 12.466 Vali Loss: 174.098 Vali Acc: 0.200 Test Loss: 174.098 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.783214569091797
Epoch: 3, Steps: 13 | Train Loss: 5.675 Vali Loss: 92.983 Vali Acc: 0.120 Test Loss: 92.983 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.93780779838562
Epoch: 4, Steps: 13 | Train Loss: 0.673 Vali Loss: 94.212 Vali Acc: 0.200 Test Loss: 94.212 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.832067012786865
Epoch: 5, Steps: 13 | Train Loss: 3.877 Vali Loss: 248.992 Vali Acc: 0.160 Test Loss: 248.992 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.017297983169556
Epoch: 6, Steps: 13 | Train Loss: 16.023 Vali Loss: 225.621 Vali Acc: 0.180 Test Loss: 225.621 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.778273582458496
Epoch: 7, Steps: 13 | Train Loss: 8.926 Vali Loss: 125.658 Vali Acc: 0.200 Test Loss: 125.658 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.828016757965088
Epoch: 8, Steps: 13 | Train Loss: 5.803 Vali Loss: 179.320 Vali Acc: 0.180 Test Loss: 179.320 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.828643321990967
Epoch: 9, Steps: 13 | Train Loss: 0.483 Vali Loss: 245.719 Vali Acc: 0.180 Test Loss: 245.719 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.945249080657959
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 197.583 Vali Acc: 0.180 Test Loss: 197.583 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.842431545257568
Epoch: 11, Steps: 13 | Train Loss: 5.314 Vali Loss: 224.233 Vali Acc: 0.200 Test Loss: 224.233 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 32961861
model size : 128.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.274343252182007
Epoch: 1, Steps: 13 | Train Loss: 8.532 Vali Loss: 19.389 Vali Acc: 0.240 Test Loss: 19.389 Test Acc: 0.240
Validation loss decreased (inf --> -0.239806).  Saving model ...
Epoch: 2 cost time: 3.6924569606781006
Epoch: 2, Steps: 13 | Train Loss: 2.554 Vali Loss: 33.706 Vali Acc: 0.160 Test Loss: 33.706 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.628289222717285
Epoch: 3, Steps: 13 | Train Loss: 0.447 Vali Loss: 85.454 Vali Acc: 0.200 Test Loss: 85.454 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.6560425758361816
Epoch: 4, Steps: 13 | Train Loss: 0.069 Vali Loss: 52.758 Vali Acc: 0.140 Test Loss: 52.758 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.6237399578094482
Epoch: 5, Steps: 13 | Train Loss: 2.486 Vali Loss: 83.395 Vali Acc: 0.200 Test Loss: 83.395 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.6307222843170166
Epoch: 6, Steps: 13 | Train Loss: 3.219 Vali Loss: 110.967 Vali Acc: 0.280 Test Loss: 110.967 Test Acc: 0.280
Validation loss decreased (-0.239806 --> -0.278890).  Saving model ...
Epoch: 7 cost time: 3.637589693069458
Epoch: 7, Steps: 13 | Train Loss: 5.068 Vali Loss: 139.829 Vali Acc: 0.120 Test Loss: 139.829 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6198716163635254
Epoch: 8, Steps: 13 | Train Loss: 14.358 Vali Loss: 88.694 Vali Acc: 0.180 Test Loss: 88.694 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7294580936431885
Epoch: 9, Steps: 13 | Train Loss: 18.063 Vali Loss: 124.759 Vali Acc: 0.260 Test Loss: 124.759 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.8178136348724365
Epoch: 10, Steps: 13 | Train Loss: 1.323 Vali Loss: 162.452 Vali Acc: 0.200 Test Loss: 162.452 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.6801228523254395
Epoch: 11, Steps: 13 | Train Loss: 4.082 Vali Loss: 145.342 Vali Acc: 0.200 Test Loss: 145.342 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.713698387145996
Epoch: 12, Steps: 13 | Train Loss: 3.847 Vali Loss: 246.242 Vali Acc: 0.200 Test Loss: 246.242 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.660656690597534
Epoch: 13, Steps: 13 | Train Loss: 1.622 Vali Loss: 120.181 Vali Acc: 0.180 Test Loss: 120.181 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.7367143630981445
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 95.804 Vali Acc: 0.200 Test Loss: 95.804 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.7656736373901367
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 97.887 Vali Acc: 0.220 Test Loss: 97.887 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.7975306510925293
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 99.690 Vali Acc: 0.200 Test Loss: 99.690 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 20911557
model size : 82.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df64_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.39628529548645
Epoch: 1, Steps: 13 | Train Loss: 4.373 Vali Loss: 14.350 Vali Acc: 0.140 Test Loss: 14.350 Test Acc: 0.140
Validation loss decreased (inf --> -0.139856).  Saving model ...
Epoch: 2 cost time: 3.0027058124542236
Epoch: 2, Steps: 13 | Train Loss: 0.968 Vali Loss: 25.346 Vali Acc: 0.200 Test Loss: 25.346 Test Acc: 0.200
Validation loss decreased (-0.139856 --> -0.199747).  Saving model ...
Epoch: 3 cost time: 2.9632341861724854
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 39.704 Vali Acc: 0.140 Test Loss: 39.704 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.130340576171875
Epoch: 4, Steps: 13 | Train Loss: 0.899 Vali Loss: 37.974 Vali Acc: 0.200 Test Loss: 37.974 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0474109649658203
Epoch: 5, Steps: 13 | Train Loss: 1.587 Vali Loss: 82.411 Vali Acc: 0.180 Test Loss: 82.411 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0689423084259033
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 71.865 Vali Acc: 0.200 Test Loss: 71.865 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0453708171844482
Epoch: 7, Steps: 13 | Train Loss: 4.593 Vali Loss: 73.649 Vali Acc: 0.120 Test Loss: 73.649 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.111985206604004
Epoch: 8, Steps: 13 | Train Loss: 1.356 Vali Loss: 112.235 Vali Acc: 0.160 Test Loss: 112.235 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.080111265182495
Epoch: 9, Steps: 13 | Train Loss: 2.680 Vali Loss: 107.784 Vali Acc: 0.080 Test Loss: 107.784 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.2083003520965576
Epoch: 10, Steps: 13 | Train Loss: 6.501 Vali Loss: 147.110 Vali Acc: 0.200 Test Loss: 147.110 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.063817262649536
Epoch: 11, Steps: 13 | Train Loss: 9.887 Vali Loss: 155.337 Vali Acc: 0.120 Test Loss: 155.337 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.2039408683776855
Epoch: 12, Steps: 13 | Train Loss: 4.522 Vali Loss: 115.533 Vali Acc: 0.120 Test Loss: 115.533 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df64_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 16608325
model size : 65.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9990479946136475
Epoch: 1, Steps: 13 | Train Loss: 3.457 Vali Loss: 9.198 Vali Acc: 0.160 Test Loss: 9.198 Test Acc: 0.160
Validation loss decreased (inf --> -0.159908).  Saving model ...
Epoch: 2 cost time: 2.383760452270508
Epoch: 2, Steps: 13 | Train Loss: 0.478 Vali Loss: 17.936 Vali Acc: 0.180 Test Loss: 17.936 Test Acc: 0.180
Validation loss decreased (-0.159908 --> -0.179821).  Saving model ...
Epoch: 3 cost time: 2.3145060539245605
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 29.125 Vali Acc: 0.200 Test Loss: 29.125 Test Acc: 0.200
Validation loss decreased (-0.179821 --> -0.199709).  Saving model ...
Epoch: 4 cost time: 2.443244457244873
Epoch: 4, Steps: 13 | Train Loss: 0.001 Vali Loss: 37.723 Vali Acc: 0.200 Test Loss: 37.723 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.354161500930786
Epoch: 5, Steps: 13 | Train Loss: 0.132 Vali Loss: 46.662 Vali Acc: 0.140 Test Loss: 46.662 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4353420734405518
Epoch: 6, Steps: 13 | Train Loss: 0.802 Vali Loss: 33.807 Vali Acc: 0.280 Test Loss: 33.807 Test Acc: 0.280
Validation loss decreased (-0.199709 --> -0.279662).  Saving model ...
Epoch: 7 cost time: 2.339341640472412
Epoch: 7, Steps: 13 | Train Loss: 0.199 Vali Loss: 41.216 Vali Acc: 0.180 Test Loss: 41.216 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.42417573928833
Epoch: 8, Steps: 13 | Train Loss: 1.272 Vali Loss: 50.127 Vali Acc: 0.140 Test Loss: 50.127 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3177385330200195
Epoch: 9, Steps: 13 | Train Loss: 2.526 Vali Loss: 69.926 Vali Acc: 0.160 Test Loss: 69.926 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3452465534210205
Epoch: 10, Steps: 13 | Train Loss: 5.746 Vali Loss: 84.019 Vali Acc: 0.180 Test Loss: 84.019 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.397836685180664
Epoch: 11, Steps: 13 | Train Loss: 8.207 Vali Loss: 82.469 Vali Acc: 0.260 Test Loss: 82.469 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4732232093811035
Epoch: 12, Steps: 13 | Train Loss: 2.056 Vali Loss: 103.578 Vali Acc: 0.160 Test Loss: 103.578 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6471636295318604
Epoch: 13, Steps: 13 | Train Loss: 0.831 Vali Loss: 111.674 Vali Acc: 0.200 Test Loss: 111.674 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.484456777572632
Epoch: 14, Steps: 13 | Train Loss: 0.498 Vali Loss: 126.068 Vali Acc: 0.180 Test Loss: 126.068 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.67561936378479
Epoch: 15, Steps: 13 | Train Loss: 0.149 Vali Loss: 124.693 Vali Acc: 0.220 Test Loss: 124.693 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5002942085266113
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 90.184 Vali Acc: 0.160 Test Loss: 90.184 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 10584517
model size : 42.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df64_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.079027891159058
Epoch: 1, Steps: 13 | Train Loss: 4.893 Vali Loss: 11.959 Vali Acc: 0.200 Test Loss: 11.959 Test Acc: 0.200
Validation loss decreased (inf --> -0.199880).  Saving model ...
Epoch: 2 cost time: 2.233924627304077
Epoch: 2, Steps: 13 | Train Loss: 0.434 Vali Loss: 22.109 Vali Acc: 0.140 Test Loss: 22.109 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.132776975631714
Epoch: 3, Steps: 13 | Train Loss: 0.008 Vali Loss: 21.811 Vali Acc: 0.260 Test Loss: 21.811 Test Acc: 0.260
Validation loss decreased (-0.199880 --> -0.259782).  Saving model ...
Epoch: 4 cost time: 2.121415615081787
Epoch: 4, Steps: 13 | Train Loss: 0.353 Vali Loss: 32.684 Vali Acc: 0.200 Test Loss: 32.684 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1006672382354736
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 30.232 Vali Acc: 0.140 Test Loss: 30.232 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.141897678375244
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 33.837 Vali Acc: 0.120 Test Loss: 33.837 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.205604076385498
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 45.407 Vali Acc: 0.160 Test Loss: 45.407 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0682976245880127
Epoch: 8, Steps: 13 | Train Loss: 0.157 Vali Loss: 30.379 Vali Acc: 0.140 Test Loss: 30.379 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0822181701660156
Epoch: 9, Steps: 13 | Train Loss: 3.123 Vali Loss: 44.366 Vali Acc: 0.220 Test Loss: 44.366 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.163713216781616
Epoch: 10, Steps: 13 | Train Loss: 0.155 Vali Loss: 42.215 Vali Acc: 0.260 Test Loss: 42.215 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3426618576049805
Epoch: 11, Steps: 13 | Train Loss: 2.659 Vali Loss: 46.834 Vali Acc: 0.200 Test Loss: 46.834 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3321614265441895
Epoch: 12, Steps: 13 | Train Loss: 6.525 Vali Loss: 47.367 Vali Acc: 0.160 Test Loss: 47.367 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.166405200958252
Epoch: 13, Steps: 13 | Train Loss: 2.298 Vali Loss: 57.963 Vali Acc: 0.180 Test Loss: 57.963 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df64_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 8864581
model size : 36.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.492274284362793
Epoch: 1, Steps: 13 | Train Loss: 2.762 Vali Loss: 4.561 Vali Acc: 0.180 Test Loss: 4.561 Test Acc: 0.180
Validation loss decreased (inf --> -0.179954).  Saving model ...
Epoch: 2 cost time: 1.7652318477630615
Epoch: 2, Steps: 13 | Train Loss: 0.133 Vali Loss: 9.246 Vali Acc: 0.120 Test Loss: 9.246 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7653465270996094
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.993 Vali Acc: 0.160 Test Loss: 12.993 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7521934509277344
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.094 Vali Acc: 0.160 Test Loss: 14.094 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.732149362564087
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.610 Vali Acc: 0.160 Test Loss: 14.610 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7588913440704346
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.970 Vali Acc: 0.160 Test Loss: 14.970 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.783524990081787
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.901 Vali Acc: 0.160 Test Loss: 14.901 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6919474601745605
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.061 Vali Acc: 0.160 Test Loss: 14.061 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7306199073791504
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.229 Vali Acc: 0.160 Test Loss: 14.229 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8485920429229736
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.163 Vali Acc: 0.160 Test Loss: 14.163 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7466208934783936
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.156 Vali Acc: 0.160 Test Loss: 14.156 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm128_nh16_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.18
model parameter : 6283973
model size : 26.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 15.117035627365112
Epoch: 1, Steps: 25 | Train Loss: 31.353 Vali Loss: 82.550 Vali Acc: 0.240 Test Loss: 82.550 Test Acc: 0.240
Validation loss decreased (inf --> -0.239175).  Saving model ...
Epoch: 2 cost time: 13.980959415435791
Epoch: 2, Steps: 25 | Train Loss: 24.290 Vali Loss: 130.120 Vali Acc: 0.180 Test Loss: 130.120 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.193230628967285
Epoch: 3, Steps: 25 | Train Loss: 35.493 Vali Loss: 172.210 Vali Acc: 0.220 Test Loss: 172.210 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.424877405166626
Epoch: 4, Steps: 25 | Train Loss: 1.039 Vali Loss: 200.260 Vali Acc: 0.160 Test Loss: 200.260 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.433176040649414
Epoch: 5, Steps: 25 | Train Loss: 9.072 Vali Loss: 180.901 Vali Acc: 0.220 Test Loss: 180.901 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.258111476898193
Epoch: 6, Steps: 25 | Train Loss: 0.000 Vali Loss: 164.198 Vali Acc: 0.200 Test Loss: 164.198 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 14.415321350097656
Epoch: 7, Steps: 25 | Train Loss: 0.000 Vali Loss: 165.568 Vali Acc: 0.220 Test Loss: 165.568 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 14.611060380935669
Epoch: 8, Steps: 25 | Train Loss: 0.116 Vali Loss: 305.530 Vali Acc: 0.200 Test Loss: 305.530 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.73684310913086
Epoch: 9, Steps: 25 | Train Loss: 9.795 Vali Loss: 165.810 Vali Acc: 0.100 Test Loss: 165.810 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 14.642940521240234
Epoch: 10, Steps: 25 | Train Loss: 0.000 Vali Loss: 203.023 Vali Acc: 0.140 Test Loss: 203.023 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 14.356104612350464
Epoch: 11, Steps: 25 | Train Loss: 0.003 Vali Loss: 202.231 Vali Acc: 0.140 Test Loss: 202.231 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 28987333
model size : 111.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.883728981018066
Epoch: 1, Steps: 13 | Train Loss: 6.987 Vali Loss: 15.166 Vali Acc: 0.200 Test Loss: 15.166 Test Acc: 0.200
Validation loss decreased (inf --> -0.199848).  Saving model ...
Epoch: 2 cost time: 6.290349721908569
Epoch: 2, Steps: 13 | Train Loss: 2.375 Vali Loss: 57.350 Vali Acc: 0.160 Test Loss: 57.350 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.3762366771698
Epoch: 3, Steps: 13 | Train Loss: 5.891 Vali Loss: 89.640 Vali Acc: 0.220 Test Loss: 89.640 Test Acc: 0.220
Validation loss decreased (-0.199848 --> -0.219104).  Saving model ...
Epoch: 4 cost time: 6.516903400421143
Epoch: 4, Steps: 13 | Train Loss: 3.110 Vali Loss: 62.539 Vali Acc: 0.220 Test Loss: 62.539 Test Acc: 0.220
Validation loss decreased (-0.219104 --> -0.219375).  Saving model ...
Epoch: 5 cost time: 6.533250331878662
Epoch: 5, Steps: 13 | Train Loss: 1.303 Vali Loss: 98.341 Vali Acc: 0.100 Test Loss: 98.341 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.513894557952881
Epoch: 6, Steps: 13 | Train Loss: 2.119 Vali Loss: 90.839 Vali Acc: 0.200 Test Loss: 90.839 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.547480821609497
Epoch: 7, Steps: 13 | Train Loss: 2.096 Vali Loss: 102.734 Vali Acc: 0.140 Test Loss: 102.734 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.480767488479614
Epoch: 8, Steps: 13 | Train Loss: 0.659 Vali Loss: 113.663 Vali Acc: 0.220 Test Loss: 113.663 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.5341432094573975
Epoch: 9, Steps: 13 | Train Loss: 0.450 Vali Loss: 116.542 Vali Acc: 0.160 Test Loss: 116.542 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.578435182571411
Epoch: 10, Steps: 13 | Train Loss: 2.352 Vali Loss: 100.463 Vali Acc: 0.160 Test Loss: 100.463 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.509500980377197
Epoch: 11, Steps: 13 | Train Loss: 0.185 Vali Loss: 135.204 Vali Acc: 0.200 Test Loss: 135.204 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.559763431549072
Epoch: 12, Steps: 13 | Train Loss: 4.773 Vali Loss: 155.330 Vali Acc: 0.220 Test Loss: 155.330 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.568775415420532
Epoch: 13, Steps: 13 | Train Loss: 0.289 Vali Loss: 98.538 Vali Acc: 0.180 Test Loss: 98.538 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.553887605667114
Epoch: 14, Steps: 13 | Train Loss: 1.028 Vali Loss: 118.167 Vali Acc: 0.140 Test Loss: 118.167 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 16506181
model size : 64.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.01044225692749
Epoch: 1, Steps: 13 | Train Loss: 4.123 Vali Loss: 9.296 Vali Acc: 0.200 Test Loss: 9.296 Test Acc: 0.200
Validation loss decreased (inf --> -0.199907).  Saving model ...
Epoch: 2 cost time: 3.5699355602264404
Epoch: 2, Steps: 13 | Train Loss: 0.437 Vali Loss: 25.895 Vali Acc: 0.180 Test Loss: 25.895 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.488323926925659
Epoch: 3, Steps: 13 | Train Loss: 1.067 Vali Loss: 32.855 Vali Acc: 0.160 Test Loss: 32.855 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5443263053894043
Epoch: 4, Steps: 13 | Train Loss: 1.043 Vali Loss: 55.017 Vali Acc: 0.180 Test Loss: 55.017 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.489548683166504
Epoch: 5, Steps: 13 | Train Loss: 1.114 Vali Loss: 42.144 Vali Acc: 0.140 Test Loss: 42.144 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.4840590953826904
Epoch: 6, Steps: 13 | Train Loss: 0.248 Vali Loss: 53.340 Vali Acc: 0.160 Test Loss: 53.340 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.5069544315338135
Epoch: 7, Steps: 13 | Train Loss: 1.525 Vali Loss: 42.008 Vali Acc: 0.120 Test Loss: 42.008 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.4546241760253906
Epoch: 8, Steps: 13 | Train Loss: 0.315 Vali Loss: 44.154 Vali Acc: 0.220 Test Loss: 44.154 Test Acc: 0.220
Validation loss decreased (-0.199907 --> -0.219558).  Saving model ...
Epoch: 9 cost time: 3.537414789199829
Epoch: 9, Steps: 13 | Train Loss: 0.922 Vali Loss: 57.261 Vali Acc: 0.160 Test Loss: 57.261 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6657090187072754
Epoch: 10, Steps: 13 | Train Loss: 3.929 Vali Loss: 72.556 Vali Acc: 0.140 Test Loss: 72.556 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.602872610092163
Epoch: 11, Steps: 13 | Train Loss: 5.013 Vali Loss: 58.329 Vali Acc: 0.200 Test Loss: 58.329 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.7600934505462646
Epoch: 12, Steps: 13 | Train Loss: 0.730 Vali Loss: 73.753 Vali Acc: 0.160 Test Loss: 73.753 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.4982259273529053
Epoch: 13, Steps: 13 | Train Loss: 0.065 Vali Loss: 77.191 Vali Acc: 0.240 Test Loss: 77.191 Test Acc: 0.240
Validation loss decreased (-0.219558 --> -0.239228).  Saving model ...
Epoch: 14 cost time: 3.6249403953552246
Epoch: 14, Steps: 13 | Train Loss: 2.839 Vali Loss: 95.871 Vali Acc: 0.200 Test Loss: 95.871 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.519501209259033
Epoch: 15, Steps: 13 | Train Loss: 0.612 Vali Loss: 77.868 Vali Acc: 0.240 Test Loss: 77.868 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6825602054595947
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 81.280 Vali Acc: 0.180 Test Loss: 81.280 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.556060552597046
Epoch: 17, Steps: 13 | Train Loss: 0.301 Vali Loss: 79.798 Vali Acc: 0.200 Test Loss: 79.798 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6757125854492188
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 97.932 Vali Acc: 0.220 Test Loss: 97.932 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.7433853149414062
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 104.761 Vali Acc: 0.200 Test Loss: 104.761 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.6528141498565674
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 106.443 Vali Acc: 0.200 Test Loss: 106.443 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.5530800819396973
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 106.763 Vali Acc: 0.200 Test Loss: 106.763 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.4957544803619385
Epoch: 22, Steps: 13 | Train Loss: 0.002 Vali Loss: 95.681 Vali Acc: 0.220 Test Loss: 95.681 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.5378358364105225
Epoch: 23, Steps: 13 | Train Loss: 0.001 Vali Loss: 93.114 Vali Acc: 0.220 Test Loss: 93.114 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 10481029
model size : 41.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df256_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.416110992431641
Epoch: 1, Steps: 13 | Train Loss: 3.285 Vali Loss: 7.547 Vali Acc: 0.240 Test Loss: 7.547 Test Acc: 0.240
Validation loss decreased (inf --> -0.239925).  Saving model ...
Epoch: 2 cost time: 2.950340747833252
Epoch: 2, Steps: 13 | Train Loss: 0.536 Vali Loss: 17.775 Vali Acc: 0.180 Test Loss: 17.775 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.060734748840332
Epoch: 3, Steps: 13 | Train Loss: 1.718 Vali Loss: 33.305 Vali Acc: 0.200 Test Loss: 33.305 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9403531551361084
Epoch: 4, Steps: 13 | Train Loss: 1.396 Vali Loss: 33.747 Vali Acc: 0.220 Test Loss: 33.747 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.03348970413208
Epoch: 5, Steps: 13 | Train Loss: 0.017 Vali Loss: 41.584 Vali Acc: 0.140 Test Loss: 41.584 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.978555202484131
Epoch: 6, Steps: 13 | Train Loss: 0.032 Vali Loss: 37.703 Vali Acc: 0.160 Test Loss: 37.703 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.97186279296875
Epoch: 7, Steps: 13 | Train Loss: 0.032 Vali Loss: 44.391 Vali Acc: 0.240 Test Loss: 44.391 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.862429141998291
Epoch: 8, Steps: 13 | Train Loss: 1.369 Vali Loss: 43.091 Vali Acc: 0.160 Test Loss: 43.091 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.0349066257476807
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 47.971 Vali Acc: 0.080 Test Loss: 47.971 Test Acc: 0.080
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.0333526134490967
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 50.412 Vali Acc: 0.100 Test Loss: 50.412 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.048879623413086
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 51.108 Vali Acc: 0.100 Test Loss: 51.108 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df256_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 8329413
model size : 33.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8662209510803223
Epoch: 1, Steps: 13 | Train Loss: 2.165 Vali Loss: 6.568 Vali Acc: 0.160 Test Loss: 6.568 Test Acc: 0.160
Validation loss decreased (inf --> -0.159934).  Saving model ...
Epoch: 2 cost time: 2.264949083328247
Epoch: 2, Steps: 13 | Train Loss: 0.431 Vali Loss: 19.633 Vali Acc: 0.200 Test Loss: 19.633 Test Acc: 0.200
Validation loss decreased (-0.159934 --> -0.199804).  Saving model ...
Epoch: 3 cost time: 2.4134137630462646
Epoch: 3, Steps: 13 | Train Loss: 0.002 Vali Loss: 14.858 Vali Acc: 0.200 Test Loss: 14.858 Test Acc: 0.200
Validation loss decreased (-0.199804 --> -0.199851).  Saving model ...
Epoch: 4 cost time: 2.3290140628814697
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.119 Vali Acc: 0.120 Test Loss: 18.119 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2514820098876953
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.332 Vali Acc: 0.120 Test Loss: 21.332 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.251873016357422
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 22.438 Vali Acc: 0.120 Test Loss: 22.438 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2755894660949707
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 22.752 Vali Acc: 0.120 Test Loss: 22.752 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3067195415496826
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 22.910 Vali Acc: 0.140 Test Loss: 22.910 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.369398355484009
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 22.920 Vali Acc: 0.140 Test Loss: 22.920 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.287323474884033
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 22.883 Vali Acc: 0.120 Test Loss: 22.883 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3085997104644775
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 22.822 Vali Acc: 0.120 Test Loss: 22.822 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3771445751190186
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 22.755 Vali Acc: 0.120 Test Loss: 22.755 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.289442777633667
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 22.818 Vali Acc: 0.120 Test Loss: 22.818 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 5317509
model size : 21.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df256_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9771361351013184
Epoch: 1, Steps: 13 | Train Loss: 2.206 Vali Loss: 7.102 Vali Acc: 0.180 Test Loss: 7.102 Test Acc: 0.180
Validation loss decreased (inf --> -0.179929).  Saving model ...
Epoch: 2 cost time: 2.088500738143921
Epoch: 2, Steps: 13 | Train Loss: 0.126 Vali Loss: 8.182 Vali Acc: 0.220 Test Loss: 8.182 Test Acc: 0.220
Validation loss decreased (-0.179929 --> -0.219918).  Saving model ...
Epoch: 3 cost time: 1.9840824604034424
Epoch: 3, Steps: 13 | Train Loss: 0.003 Vali Loss: 11.664 Vali Acc: 0.160 Test Loss: 11.664 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0128793716430664
Epoch: 4, Steps: 13 | Train Loss: 0.007 Vali Loss: 14.021 Vali Acc: 0.200 Test Loss: 14.021 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9631905555725098
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.686 Vali Acc: 0.220 Test Loss: 16.686 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.051976442337036
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.452 Vali Acc: 0.200 Test Loss: 18.452 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9185960292816162
Epoch: 7, Steps: 13 | Train Loss: 0.001 Vali Loss: 25.307 Vali Acc: 0.220 Test Loss: 25.307 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.020759105682373
Epoch: 8, Steps: 13 | Train Loss: 0.144 Vali Loss: 31.703 Vali Acc: 0.140 Test Loss: 31.703 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.167294979095459
Epoch: 9, Steps: 13 | Train Loss: 3.943 Vali Loss: 39.109 Vali Acc: 0.180 Test Loss: 39.109 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.045959949493408
Epoch: 10, Steps: 13 | Train Loss: 0.806 Vali Loss: 28.338 Vali Acc: 0.120 Test Loss: 28.338 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9483435153961182
Epoch: 11, Steps: 13 | Train Loss: 0.770 Vali Loss: 31.782 Vali Acc: 0.160 Test Loss: 31.782 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.1717984676361084
Epoch: 12, Steps: 13 | Train Loss: 0.307 Vali Loss: 35.855 Vali Acc: 0.220 Test Loss: 35.855 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df256_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 4457541
model size : 18.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7694270610809326
Epoch: 1, Steps: 13 | Train Loss: 2.182 Vali Loss: 2.973 Vali Acc: 0.100 Test Loss: 2.973 Test Acc: 0.100
Validation loss decreased (inf --> -0.099970).  Saving model ...
Epoch: 2 cost time: 1.6014196872711182
Epoch: 2, Steps: 13 | Train Loss: 0.020 Vali Loss: 5.640 Vali Acc: 0.140 Test Loss: 5.640 Test Acc: 0.140
Validation loss decreased (-0.099970 --> -0.139944).  Saving model ...
Epoch: 3 cost time: 1.6860487461090088
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.021 Vali Acc: 0.220 Test Loss: 9.021 Test Acc: 0.220
Validation loss decreased (-0.139944 --> -0.219910).  Saving model ...
Epoch: 4 cost time: 1.6601495742797852
Epoch: 4, Steps: 13 | Train Loss: 0.002 Vali Loss: 8.850 Vali Acc: 0.180 Test Loss: 8.850 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6690325736999512
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.940 Vali Acc: 0.180 Test Loss: 10.940 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7250256538391113
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.045 Vali Acc: 0.180 Test Loss: 12.045 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.720491647720337
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.818 Vali Acc: 0.160 Test Loss: 11.818 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7840614318847656
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.320 Vali Acc: 0.180 Test Loss: 11.320 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6570141315460205
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.194 Vali Acc: 0.180 Test Loss: 11.194 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7634093761444092
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.175 Vali Acc: 0.180 Test Loss: 11.175 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.771934986114502
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.181 Vali Acc: 0.180 Test Loss: 11.181 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.805267095565796
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.276 Vali Acc: 0.180 Test Loss: 11.276 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.652716875076294
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.230 Vali Acc: 0.180 Test Loss: 11.230 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 3167237
model size : 13.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 13.57493782043457
Epoch: 1, Steps: 25 | Train Loss: 48.811 Vali Loss: 53.004 Vali Acc: 0.200 Test Loss: 53.004 Test Acc: 0.200
Validation loss decreased (inf --> -0.199470).  Saving model ...
Epoch: 2 cost time: 11.799665451049805
Epoch: 2, Steps: 25 | Train Loss: 28.592 Vali Loss: 154.771 Vali Acc: 0.160 Test Loss: 154.771 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.172879219055176
Epoch: 3, Steps: 25 | Train Loss: 30.793 Vali Loss: 150.485 Vali Acc: 0.180 Test Loss: 150.485 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.279996871948242
Epoch: 4, Steps: 25 | Train Loss: 1.708 Vali Loss: 203.944 Vali Acc: 0.200 Test Loss: 203.944 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.42398190498352
Epoch: 5, Steps: 25 | Train Loss: 1.064 Vali Loss: 172.438 Vali Acc: 0.140 Test Loss: 172.438 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.227332353591919
Epoch: 6, Steps: 25 | Train Loss: 0.589 Vali Loss: 208.933 Vali Acc: 0.140 Test Loss: 208.933 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.037365198135376
Epoch: 7, Steps: 25 | Train Loss: 0.794 Vali Loss: 211.568 Vali Acc: 0.160 Test Loss: 211.568 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 12.187230587005615
Epoch: 8, Steps: 25 | Train Loss: 5.649 Vali Loss: 303.430 Vali Acc: 0.180 Test Loss: 303.430 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.350488424301147
Epoch: 9, Steps: 25 | Train Loss: 9.381 Vali Loss: 259.312 Vali Acc: 0.160 Test Loss: 259.312 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 12.53787350654602
Epoch: 10, Steps: 25 | Train Loss: 0.008 Vali Loss: 339.075 Vali Acc: 0.180 Test Loss: 339.075 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 12.31443452835083
Epoch: 11, Steps: 25 | Train Loss: 2.384 Vali Loss: 266.572 Vali Acc: 0.080 Test Loss: 266.572 Test Acc: 0.080
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 28937797
model size : 111.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.540147304534912
Epoch: 1, Steps: 13 | Train Loss: 7.557 Vali Loss: 19.799 Vali Acc: 0.180 Test Loss: 19.799 Test Acc: 0.180
Validation loss decreased (inf --> -0.179802).  Saving model ...
Epoch: 2 cost time: 4.938823223114014
Epoch: 2, Steps: 13 | Train Loss: 4.501 Vali Loss: 30.036 Vali Acc: 0.200 Test Loss: 30.036 Test Acc: 0.200
Validation loss decreased (-0.179802 --> -0.199700).  Saving model ...
Epoch: 3 cost time: 5.0787882804870605
Epoch: 3, Steps: 13 | Train Loss: 0.881 Vali Loss: 46.198 Vali Acc: 0.080 Test Loss: 46.198 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.068490028381348
Epoch: 4, Steps: 13 | Train Loss: 1.045 Vali Loss: 68.977 Vali Acc: 0.160 Test Loss: 68.977 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.162756443023682
Epoch: 5, Steps: 13 | Train Loss: 0.339 Vali Loss: 65.765 Vali Acc: 0.180 Test Loss: 65.765 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.258617639541626
Epoch: 6, Steps: 13 | Train Loss: 2.874 Vali Loss: 78.257 Vali Acc: 0.220 Test Loss: 78.257 Test Acc: 0.220
Validation loss decreased (-0.199700 --> -0.219217).  Saving model ...
Epoch: 7 cost time: 5.218261241912842
Epoch: 7, Steps: 13 | Train Loss: 7.395 Vali Loss: 66.977 Vali Acc: 0.200 Test Loss: 66.977 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.06130838394165
Epoch: 8, Steps: 13 | Train Loss: 14.257 Vali Loss: 113.062 Vali Acc: 0.060 Test Loss: 113.062 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.0341925621032715
Epoch: 9, Steps: 13 | Train Loss: 0.626 Vali Loss: 141.612 Vali Acc: 0.220 Test Loss: 141.612 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.096098184585571
Epoch: 10, Steps: 13 | Train Loss: 3.078 Vali Loss: 172.376 Vali Acc: 0.180 Test Loss: 172.376 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.227674245834351
Epoch: 11, Steps: 13 | Train Loss: 0.826 Vali Loss: 118.258 Vali Acc: 0.120 Test Loss: 118.258 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.1276535987854
Epoch: 12, Steps: 13 | Train Loss: 0.394 Vali Loss: 135.217 Vali Acc: 0.160 Test Loss: 135.217 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.12149715423584
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 156.942 Vali Acc: 0.120 Test Loss: 156.942 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.084503173828125
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 152.037 Vali Acc: 0.120 Test Loss: 152.037 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.29727029800415
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 156.105 Vali Acc: 0.120 Test Loss: 156.105 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.138429403305054
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 157.635 Vali Acc: 0.120 Test Loss: 157.635 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 16456645
model size : 64.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.43330717086792
Epoch: 1, Steps: 13 | Train Loss: 5.198 Vali Loss: 16.407 Vali Acc: 0.200 Test Loss: 16.407 Test Acc: 0.200
Validation loss decreased (inf --> -0.199836).  Saving model ...
Epoch: 2 cost time: 2.8497745990753174
Epoch: 2, Steps: 13 | Train Loss: 1.463 Vali Loss: 40.660 Vali Acc: 0.180 Test Loss: 40.660 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.839797258377075
Epoch: 3, Steps: 13 | Train Loss: 1.168 Vali Loss: 44.162 Vali Acc: 0.200 Test Loss: 44.162 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.767242670059204
Epoch: 4, Steps: 13 | Train Loss: 1.642 Vali Loss: 46.494 Vali Acc: 0.160 Test Loss: 46.494 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8245861530303955
Epoch: 5, Steps: 13 | Train Loss: 0.136 Vali Loss: 54.451 Vali Acc: 0.160 Test Loss: 54.451 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.8430850505828857
Epoch: 6, Steps: 13 | Train Loss: 1.153 Vali Loss: 36.326 Vali Acc: 0.220 Test Loss: 36.326 Test Acc: 0.220
Validation loss decreased (-0.199836 --> -0.219637).  Saving model ...
Epoch: 7 cost time: 2.802736759185791
Epoch: 7, Steps: 13 | Train Loss: 0.551 Vali Loss: 54.007 Vali Acc: 0.220 Test Loss: 54.007 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9705710411071777
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 53.498 Vali Acc: 0.200 Test Loss: 53.498 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7953813076019287
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 67.914 Vali Acc: 0.180 Test Loss: 67.914 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.758265972137451
Epoch: 10, Steps: 13 | Train Loss: 1.179 Vali Loss: 44.203 Vali Acc: 0.140 Test Loss: 44.203 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9784655570983887
Epoch: 11, Steps: 13 | Train Loss: 1.257 Vali Loss: 73.476 Vali Acc: 0.240 Test Loss: 73.476 Test Acc: 0.240
Validation loss decreased (-0.219637 --> -0.239265).  Saving model ...
Epoch: 12 cost time: 2.8215339183807373
Epoch: 12, Steps: 13 | Train Loss: 0.273 Vali Loss: 69.097 Vali Acc: 0.200 Test Loss: 69.097 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9195785522460938
Epoch: 13, Steps: 13 | Train Loss: 8.028 Vali Loss: 103.506 Vali Acc: 0.200 Test Loss: 103.506 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.972421407699585
Epoch: 14, Steps: 13 | Train Loss: 1.275 Vali Loss: 93.644 Vali Acc: 0.220 Test Loss: 93.644 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.1440863609313965
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 74.413 Vali Acc: 0.260 Test Loss: 74.413 Test Acc: 0.260
Validation loss decreased (-0.239265 --> -0.259256).  Saving model ...
Epoch: 16 cost time: 2.7436420917510986
Epoch: 16, Steps: 13 | Train Loss: 2.117 Vali Loss: 96.931 Vali Acc: 0.160 Test Loss: 96.931 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8406999111175537
Epoch: 17, Steps: 13 | Train Loss: 0.282 Vali Loss: 92.835 Vali Acc: 0.140 Test Loss: 92.835 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8036584854125977
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 136.971 Vali Acc: 0.160 Test Loss: 136.971 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.8906748294830322
Epoch: 19, Steps: 13 | Train Loss: 5.939 Vali Loss: 108.398 Vali Acc: 0.140 Test Loss: 108.398 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.010885238647461
Epoch: 20, Steps: 13 | Train Loss: 0.906 Vali Loss: 90.553 Vali Acc: 0.160 Test Loss: 90.553 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.912855386734009
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 108.665 Vali Acc: 0.200 Test Loss: 108.665 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.8974108695983887
Epoch: 22, Steps: 13 | Train Loss: 0.466 Vali Loss: 112.581 Vali Acc: 0.180 Test Loss: 112.581 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.9689440727233887
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 113.610 Vali Acc: 0.200 Test Loss: 113.610 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.9222068786621094
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 118.513 Vali Acc: 0.180 Test Loss: 118.513 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.8860957622528076
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 120.378 Vali Acc: 0.180 Test Loss: 120.378 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 10431493
model size : 41.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df128_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.054196357727051
Epoch: 1, Steps: 13 | Train Loss: 3.529 Vali Loss: 7.385 Vali Acc: 0.180 Test Loss: 7.385 Test Acc: 0.180
Validation loss decreased (inf --> -0.179926).  Saving model ...
Epoch: 2 cost time: 2.501371383666992
Epoch: 2, Steps: 13 | Train Loss: 0.598 Vali Loss: 26.577 Vali Acc: 0.180 Test Loss: 26.577 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.532780885696411
Epoch: 3, Steps: 13 | Train Loss: 2.219 Vali Loss: 36.006 Vali Acc: 0.200 Test Loss: 36.006 Test Acc: 0.200
Validation loss decreased (-0.179926 --> -0.199640).  Saving model ...
Epoch: 4 cost time: 2.5691709518432617
Epoch: 4, Steps: 13 | Train Loss: 0.710 Vali Loss: 36.057 Vali Acc: 0.220 Test Loss: 36.057 Test Acc: 0.220
Validation loss decreased (-0.199640 --> -0.219639).  Saving model ...
Epoch: 5 cost time: 2.7083663940429688
Epoch: 5, Steps: 13 | Train Loss: 0.001 Vali Loss: 35.338 Vali Acc: 0.220 Test Loss: 35.338 Test Acc: 0.220
Validation loss decreased (-0.219639 --> -0.219647).  Saving model ...
Epoch: 6 cost time: 2.5521514415740967
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 43.860 Vali Acc: 0.200 Test Loss: 43.860 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.613393783569336
Epoch: 7, Steps: 13 | Train Loss: 0.031 Vali Loss: 47.035 Vali Acc: 0.180 Test Loss: 47.035 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6643660068511963
Epoch: 8, Steps: 13 | Train Loss: 0.366 Vali Loss: 57.614 Vali Acc: 0.180 Test Loss: 57.614 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8537845611572266
Epoch: 9, Steps: 13 | Train Loss: 1.205 Vali Loss: 47.667 Vali Acc: 0.120 Test Loss: 47.667 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.8097071647644043
Epoch: 10, Steps: 13 | Train Loss: 1.630 Vali Loss: 65.752 Vali Acc: 0.160 Test Loss: 65.752 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.813490152359009
Epoch: 11, Steps: 13 | Train Loss: 2.391 Vali Loss: 87.570 Vali Acc: 0.160 Test Loss: 87.570 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.8998215198516846
Epoch: 12, Steps: 13 | Train Loss: 0.321 Vali Loss: 69.753 Vali Acc: 0.140 Test Loss: 69.753 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.7158877849578857
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 113.680 Vali Acc: 0.160 Test Loss: 113.680 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.695326566696167
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 130.400 Vali Acc: 0.160 Test Loss: 130.400 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.6449196338653564
Epoch: 15, Steps: 13 | Train Loss: 0.213 Vali Loss: 123.590 Vali Acc: 0.160 Test Loss: 123.590 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df128_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 8279877
model size : 32.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.48396897315979
Epoch: 1, Steps: 13 | Train Loss: 3.496 Vali Loss: 5.624 Vali Acc: 0.260 Test Loss: 5.624 Test Acc: 0.260
Validation loss decreased (inf --> -0.259944).  Saving model ...
Epoch: 2 cost time: 1.9572033882141113
Epoch: 2, Steps: 13 | Train Loss: 0.161 Vali Loss: 9.123 Vali Acc: 0.160 Test Loss: 9.123 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.87532377243042
Epoch: 3, Steps: 13 | Train Loss: 0.312 Vali Loss: 12.093 Vali Acc: 0.160 Test Loss: 12.093 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.952650547027588
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 20.954 Vali Acc: 0.140 Test Loss: 20.954 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.954881191253662
Epoch: 5, Steps: 13 | Train Loss: 0.077 Vali Loss: 21.868 Vali Acc: 0.100 Test Loss: 21.868 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.932626485824585
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.426 Vali Acc: 0.160 Test Loss: 26.426 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0853867530822754
Epoch: 7, Steps: 13 | Train Loss: 0.706 Vali Loss: 22.655 Vali Acc: 0.120 Test Loss: 22.655 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9353814125061035
Epoch: 8, Steps: 13 | Train Loss: 0.254 Vali Loss: 26.791 Vali Acc: 0.260 Test Loss: 26.791 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.0824015140533447
Epoch: 9, Steps: 13 | Train Loss: 0.457 Vali Loss: 36.285 Vali Acc: 0.180 Test Loss: 36.285 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.063838243484497
Epoch: 10, Steps: 13 | Train Loss: 0.871 Vali Loss: 31.943 Vali Acc: 0.220 Test Loss: 31.943 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.0187745094299316
Epoch: 11, Steps: 13 | Train Loss: 0.509 Vali Loss: 37.977 Vali Acc: 0.180 Test Loss: 37.977 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 5267973
model size : 21.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df128_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.426670551300049
Epoch: 1, Steps: 13 | Train Loss: 2.372 Vali Loss: 2.784 Vali Acc: 0.200 Test Loss: 2.784 Test Acc: 0.200
Validation loss decreased (inf --> -0.199972).  Saving model ...
Epoch: 2 cost time: 1.9105477333068848
Epoch: 2, Steps: 13 | Train Loss: 0.119 Vali Loss: 8.767 Vali Acc: 0.180 Test Loss: 8.767 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9415318965911865
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.110 Vali Acc: 0.180 Test Loss: 9.110 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.811089038848877
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.878 Vali Acc: 0.160 Test Loss: 10.878 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.690011978149414
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.570 Vali Acc: 0.180 Test Loss: 11.570 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.006171941757202
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.745 Vali Acc: 0.160 Test Loss: 11.745 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.876692771911621
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.712 Vali Acc: 0.160 Test Loss: 11.712 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.757889986038208
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.677 Vali Acc: 0.160 Test Loss: 11.677 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.823209285736084
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.717 Vali Acc: 0.160 Test Loss: 11.717 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8965365886688232
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.761 Vali Acc: 0.160 Test Loss: 11.761 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8881266117095947
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.704 Vali Acc: 0.160 Test Loss: 11.704 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df128_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 4408005
model size : 18.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.433093786239624
Epoch: 1, Steps: 13 | Train Loss: 2.377 Vali Loss: 2.774 Vali Acc: 0.200 Test Loss: 2.774 Test Acc: 0.200
Validation loss decreased (inf --> -0.199972).  Saving model ...
Epoch: 2 cost time: 1.537482738494873
Epoch: 2, Steps: 13 | Train Loss: 0.003 Vali Loss: 7.967 Vali Acc: 0.180 Test Loss: 7.967 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.575730562210083
Epoch: 3, Steps: 13 | Train Loss: 0.002 Vali Loss: 7.487 Vali Acc: 0.200 Test Loss: 7.487 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5831077098846436
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.326 Vali Acc: 0.180 Test Loss: 11.326 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.547985553741455
Epoch: 5, Steps: 13 | Train Loss: 0.001 Vali Loss: 10.409 Vali Acc: 0.220 Test Loss: 10.409 Test Acc: 0.220
Validation loss decreased (-0.199972 --> -0.219896).  Saving model ...
Epoch: 6 cost time: 1.7164678573608398
Epoch: 6, Steps: 13 | Train Loss: 0.002 Vali Loss: 12.670 Vali Acc: 0.280 Test Loss: 12.670 Test Acc: 0.280
Validation loss decreased (-0.219896 --> -0.279873).  Saving model ...
Epoch: 7 cost time: 1.6976170539855957
Epoch: 7, Steps: 13 | Train Loss: 0.028 Vali Loss: 13.901 Vali Acc: 0.220 Test Loss: 13.901 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6602909564971924
Epoch: 8, Steps: 13 | Train Loss: 0.023 Vali Loss: 16.689 Vali Acc: 0.180 Test Loss: 16.689 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5706028938293457
Epoch: 9, Steps: 13 | Train Loss: 0.216 Vali Loss: 23.241 Vali Acc: 0.200 Test Loss: 23.241 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.536463975906372
Epoch: 10, Steps: 13 | Train Loss: 0.274 Vali Loss: 23.553 Vali Acc: 0.100 Test Loss: 23.553 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5803766250610352
Epoch: 11, Steps: 13 | Train Loss: 0.647 Vali Loss: 22.022 Vali Acc: 0.220 Test Loss: 22.022 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5715303421020508
Epoch: 12, Steps: 13 | Train Loss: 1.354 Vali Loss: 26.507 Vali Acc: 0.140 Test Loss: 26.507 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5584590435028076
Epoch: 13, Steps: 13 | Train Loss: 0.281 Vali Loss: 23.769 Vali Acc: 0.220 Test Loss: 23.769 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.536104440689087
Epoch: 14, Steps: 13 | Train Loss: 0.221 Vali Loss: 32.510 Vali Acc: 0.160 Test Loss: 32.510 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6497259140014648
Epoch: 15, Steps: 13 | Train Loss: 0.245 Vali Loss: 41.178 Vali Acc: 0.160 Test Loss: 41.178 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.612257719039917
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 35.911 Vali Acc: 0.120 Test Loss: 35.911 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 3117701
model size : 13.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 12.758463144302368
Epoch: 1, Steps: 25 | Train Loss: 44.851 Vali Loss: 98.799 Vali Acc: 0.200 Test Loss: 98.799 Test Acc: 0.200
Validation loss decreased (inf --> -0.199012).  Saving model ...
Epoch: 2 cost time: 11.33559513092041
Epoch: 2, Steps: 25 | Train Loss: 33.713 Vali Loss: 102.295 Vali Acc: 0.160 Test Loss: 102.295 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.722248792648315
Epoch: 3, Steps: 25 | Train Loss: 17.746 Vali Loss: 80.400 Vali Acc: 0.240 Test Loss: 80.400 Test Acc: 0.240
Validation loss decreased (-0.199012 --> -0.239196).  Saving model ...
Epoch: 4 cost time: 11.645264863967896
Epoch: 4, Steps: 25 | Train Loss: 14.457 Vali Loss: 287.188 Vali Acc: 0.200 Test Loss: 287.188 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.597306489944458
Epoch: 5, Steps: 25 | Train Loss: 11.859 Vali Loss: 176.579 Vali Acc: 0.080 Test Loss: 176.579 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.751848220825195
Epoch: 6, Steps: 25 | Train Loss: 1.258 Vali Loss: 152.065 Vali Acc: 0.180 Test Loss: 152.065 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.832876920700073
Epoch: 7, Steps: 25 | Train Loss: 0.000 Vali Loss: 165.813 Vali Acc: 0.200 Test Loss: 165.813 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.756562232971191
Epoch: 8, Steps: 25 | Train Loss: 0.000 Vali Loss: 165.449 Vali Acc: 0.200 Test Loss: 165.449 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.706746816635132
Epoch: 9, Steps: 25 | Train Loss: 5.562 Vali Loss: 256.834 Vali Acc: 0.180 Test Loss: 256.834 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.757900476455688
Epoch: 10, Steps: 25 | Train Loss: 2.381 Vali Loss: 212.985 Vali Acc: 0.120 Test Loss: 212.985 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 11.966435194015503
Epoch: 11, Steps: 25 | Train Loss: 5.909 Vali Loss: 350.556 Vali Acc: 0.200 Test Loss: 350.556 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 11.81430459022522
Epoch: 12, Steps: 25 | Train Loss: 3.019 Vali Loss: 261.584 Vali Acc: 0.180 Test Loss: 261.584 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 11.752915859222412
Epoch: 13, Steps: 25 | Train Loss: 5.424 Vali Loss: 171.310 Vali Acc: 0.100 Test Loss: 171.310 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 28913029
model size : 111.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.994581699371338
Epoch: 1, Steps: 13 | Train Loss: 7.850 Vali Loss: 15.047 Vali Acc: 0.120 Test Loss: 15.047 Test Acc: 0.120
Validation loss decreased (inf --> -0.119850).  Saving model ...
Epoch: 2 cost time: 4.558516263961792
Epoch: 2, Steps: 13 | Train Loss: 1.740 Vali Loss: 31.456 Vali Acc: 0.160 Test Loss: 31.456 Test Acc: 0.160
Validation loss decreased (-0.119850 --> -0.159685).  Saving model ...
Epoch: 3 cost time: 4.459486722946167
Epoch: 3, Steps: 13 | Train Loss: 4.351 Vali Loss: 38.930 Vali Acc: 0.220 Test Loss: 38.930 Test Acc: 0.220
Validation loss decreased (-0.159685 --> -0.219611).  Saving model ...
Epoch: 4 cost time: 4.5436928272247314
Epoch: 4, Steps: 13 | Train Loss: 1.124 Vali Loss: 61.509 Vali Acc: 0.100 Test Loss: 61.509 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.616540193557739
Epoch: 5, Steps: 13 | Train Loss: 5.214 Vali Loss: 82.527 Vali Acc: 0.200 Test Loss: 82.527 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.771144866943359
Epoch: 6, Steps: 13 | Train Loss: 3.138 Vali Loss: 99.424 Vali Acc: 0.220 Test Loss: 99.424 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.789364337921143
Epoch: 7, Steps: 13 | Train Loss: 1.747 Vali Loss: 77.041 Vali Acc: 0.140 Test Loss: 77.041 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.762141942977905
Epoch: 8, Steps: 13 | Train Loss: 1.633 Vali Loss: 122.138 Vali Acc: 0.200 Test Loss: 122.138 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.720470666885376
Epoch: 9, Steps: 13 | Train Loss: 7.164 Vali Loss: 164.289 Vali Acc: 0.100 Test Loss: 164.289 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.700839281082153
Epoch: 10, Steps: 13 | Train Loss: 6.913 Vali Loss: 231.580 Vali Acc: 0.220 Test Loss: 231.580 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.6886045932769775
Epoch: 11, Steps: 13 | Train Loss: 18.825 Vali Loss: 147.879 Vali Acc: 0.120 Test Loss: 147.879 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.53275990486145
Epoch: 12, Steps: 13 | Train Loss: 2.630 Vali Loss: 150.471 Vali Acc: 0.160 Test Loss: 150.471 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.631001234054565
Epoch: 13, Steps: 13 | Train Loss: 0.918 Vali Loss: 128.985 Vali Acc: 0.240 Test Loss: 128.985 Test Acc: 0.240
Validation loss decreased (-0.219611 --> -0.238710).  Saving model ...
Epoch: 14 cost time: 4.544174671173096
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 171.084 Vali Acc: 0.180 Test Loss: 171.084 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.550591707229614
Epoch: 15, Steps: 13 | Train Loss: 1.082 Vali Loss: 132.517 Vali Acc: 0.200 Test Loss: 132.517 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.580023765563965
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 132.466 Vali Acc: 0.220 Test Loss: 132.466 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.656339883804321
Epoch: 17, Steps: 13 | Train Loss: 0.316 Vali Loss: 127.547 Vali Acc: 0.180 Test Loss: 127.547 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.556338787078857
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 154.092 Vali Acc: 0.200 Test Loss: 154.092 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.563110113143921
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 164.727 Vali Acc: 0.200 Test Loss: 164.727 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.511752128601074
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 168.507 Vali Acc: 0.200 Test Loss: 168.507 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.551088809967041
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 169.123 Vali Acc: 0.200 Test Loss: 169.123 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.599258899688721
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 169.566 Vali Acc: 0.200 Test Loss: 169.566 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.521691560745239
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 171.130 Vali Acc: 0.180 Test Loss: 171.130 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 16431877
model size : 63.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.120804786682129
Epoch: 1, Steps: 13 | Train Loss: 5.404 Vali Loss: 12.291 Vali Acc: 0.260 Test Loss: 12.291 Test Acc: 0.260
Validation loss decreased (inf --> -0.259877).  Saving model ...
Epoch: 2 cost time: 2.6457438468933105
Epoch: 2, Steps: 13 | Train Loss: 0.131 Vali Loss: 27.903 Vali Acc: 0.200 Test Loss: 27.903 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7543914318084717
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.647 Vali Acc: 0.240 Test Loss: 21.647 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8519389629364014
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.666 Vali Acc: 0.180 Test Loss: 24.666 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.677229642868042
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.109 Vali Acc: 0.160 Test Loss: 26.109 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6528358459472656
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.567 Vali Acc: 0.160 Test Loss: 26.567 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.782498359680176
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.752 Vali Acc: 0.160 Test Loss: 26.752 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.690931558609009
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.829 Vali Acc: 0.180 Test Loss: 26.829 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.713181495666504
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.820 Vali Acc: 0.180 Test Loss: 26.820 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.7001352310180664
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.739 Vali Acc: 0.160 Test Loss: 26.739 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.7058427333831787
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.772 Vali Acc: 0.160 Test Loss: 26.772 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 10406725
model size : 40.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df64_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.286667585372925
Epoch: 1, Steps: 13 | Train Loss: 2.941 Vali Loss: 6.983 Vali Acc: 0.180 Test Loss: 6.983 Test Acc: 0.180
Validation loss decreased (inf --> -0.179930).  Saving model ...
Epoch: 2 cost time: 2.5835421085357666
Epoch: 2, Steps: 13 | Train Loss: 0.366 Vali Loss: 23.901 Vali Acc: 0.180 Test Loss: 23.901 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5605106353759766
Epoch: 3, Steps: 13 | Train Loss: 0.091 Vali Loss: 24.630 Vali Acc: 0.140 Test Loss: 24.630 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4649274349212646
Epoch: 4, Steps: 13 | Train Loss: 0.387 Vali Loss: 37.940 Vali Acc: 0.140 Test Loss: 37.940 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4934046268463135
Epoch: 5, Steps: 13 | Train Loss: 0.056 Vali Loss: 40.042 Vali Acc: 0.180 Test Loss: 40.042 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.427685260772705
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 43.160 Vali Acc: 0.180 Test Loss: 43.160 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5568158626556396
Epoch: 7, Steps: 13 | Train Loss: 0.036 Vali Loss: 50.777 Vali Acc: 0.160 Test Loss: 50.777 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.561141014099121
Epoch: 8, Steps: 13 | Train Loss: 3.707 Vali Loss: 83.586 Vali Acc: 0.200 Test Loss: 83.586 Test Acc: 0.200
Validation loss decreased (-0.179930 --> -0.199164).  Saving model ...
Epoch: 9 cost time: 2.6549668312072754
Epoch: 9, Steps: 13 | Train Loss: 9.809 Vali Loss: 98.757 Vali Acc: 0.160 Test Loss: 98.757 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6087770462036133
Epoch: 10, Steps: 13 | Train Loss: 9.167 Vali Loss: 132.397 Vali Acc: 0.120 Test Loss: 132.397 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6191649436950684
Epoch: 11, Steps: 13 | Train Loss: 2.044 Vali Loss: 98.880 Vali Acc: 0.100 Test Loss: 98.880 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5954878330230713
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 98.056 Vali Acc: 0.140 Test Loss: 98.056 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.570599317550659
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 98.570 Vali Acc: 0.100 Test Loss: 98.570 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.593317747116089
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 98.844 Vali Acc: 0.120 Test Loss: 98.844 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.561307191848755
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 98.797 Vali Acc: 0.100 Test Loss: 98.797 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.571969747543335
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 98.494 Vali Acc: 0.100 Test Loss: 98.494 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.578815221786499
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 98.497 Vali Acc: 0.100 Test Loss: 98.497 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5090537071228027
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 98.530 Vali Acc: 0.100 Test Loss: 98.530 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df64_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 8255109
model size : 32.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.697941780090332
Epoch: 1, Steps: 13 | Train Loss: 2.595 Vali Loss: 4.885 Vali Acc: 0.220 Test Loss: 4.885 Test Acc: 0.220
Validation loss decreased (inf --> -0.219951).  Saving model ...
Epoch: 2 cost time: 1.8586890697479248
Epoch: 2, Steps: 13 | Train Loss: 0.272 Vali Loss: 16.170 Vali Acc: 0.160 Test Loss: 16.170 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9493141174316406
Epoch: 3, Steps: 13 | Train Loss: 0.371 Vali Loss: 13.104 Vali Acc: 0.180 Test Loss: 13.104 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9000749588012695
Epoch: 4, Steps: 13 | Train Loss: 0.345 Vali Loss: 13.686 Vali Acc: 0.160 Test Loss: 13.686 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9341800212860107
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.112 Vali Acc: 0.140 Test Loss: 17.112 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9255313873291016
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.652 Vali Acc: 0.140 Test Loss: 14.652 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.89265775680542
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 15.256 Vali Acc: 0.120 Test Loss: 15.256 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9045777320861816
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.822 Vali Acc: 0.160 Test Loss: 19.822 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9559853076934814
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.543 Vali Acc: 0.180 Test Loss: 23.543 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9692773818969727
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.994 Vali Acc: 0.180 Test Loss: 23.994 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.0043528079986572
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.887 Vali Acc: 0.180 Test Loss: 23.887 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 5243205
model size : 21.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df64_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5218286514282227
Epoch: 1, Steps: 13 | Train Loss: 2.796 Vali Loss: 4.837 Vali Acc: 0.140 Test Loss: 4.837 Test Acc: 0.140
Validation loss decreased (inf --> -0.139952).  Saving model ...
Epoch: 2 cost time: 1.689051628112793
Epoch: 2, Steps: 13 | Train Loss: 0.009 Vali Loss: 6.312 Vali Acc: 0.220 Test Loss: 6.312 Test Acc: 0.220
Validation loss decreased (-0.139952 --> -0.219937).  Saving model ...
Epoch: 3 cost time: 1.722343921661377
Epoch: 3, Steps: 13 | Train Loss: 0.109 Vali Loss: 8.887 Vali Acc: 0.240 Test Loss: 8.887 Test Acc: 0.240
Validation loss decreased (-0.219937 --> -0.239911).  Saving model ...
Epoch: 4 cost time: 1.9329438209533691
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.123 Vali Acc: 0.160 Test Loss: 12.123 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7404255867004395
Epoch: 5, Steps: 13 | Train Loss: 0.020 Vali Loss: 16.526 Vali Acc: 0.200 Test Loss: 16.526 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5816147327423096
Epoch: 6, Steps: 13 | Train Loss: 0.114 Vali Loss: 22.528 Vali Acc: 0.180 Test Loss: 22.528 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6169896125793457
Epoch: 7, Steps: 13 | Train Loss: 0.944 Vali Loss: 21.192 Vali Acc: 0.200 Test Loss: 21.192 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.567298412322998
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 20.257 Vali Acc: 0.200 Test Loss: 20.257 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5986168384552002
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.358 Vali Acc: 0.200 Test Loss: 26.358 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5875399112701416
Epoch: 10, Steps: 13 | Train Loss: 0.095 Vali Loss: 22.923 Vali Acc: 0.200 Test Loss: 22.923 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.588059902191162
Epoch: 11, Steps: 13 | Train Loss: 0.103 Vali Loss: 28.220 Vali Acc: 0.180 Test Loss: 28.220 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6334609985351562
Epoch: 12, Steps: 13 | Train Loss: 2.025 Vali Loss: 36.953 Vali Acc: 0.160 Test Loss: 36.953 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6757264137268066
Epoch: 13, Steps: 13 | Train Loss: 2.307 Vali Loss: 50.759 Vali Acc: 0.260 Test Loss: 50.759 Test Acc: 0.260
Validation loss decreased (-0.239911 --> -0.259492).  Saving model ...
Epoch: 14 cost time: 1.6832306385040283
Epoch: 14, Steps: 13 | Train Loss: 0.503 Vali Loss: 57.012 Vali Acc: 0.300 Test Loss: 57.012 Test Acc: 0.300
Validation loss decreased (-0.259492 --> -0.299430).  Saving model ...
Epoch: 15 cost time: 1.6602082252502441
Epoch: 15, Steps: 13 | Train Loss: 0.580 Vali Loss: 55.807 Vali Acc: 0.240 Test Loss: 55.807 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.74501633644104
Epoch: 16, Steps: 13 | Train Loss: 0.627 Vali Loss: 56.918 Vali Acc: 0.200 Test Loss: 56.918 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7028844356536865
Epoch: 17, Steps: 13 | Train Loss: 0.011 Vali Loss: 57.372 Vali Acc: 0.160 Test Loss: 57.372 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6904330253601074
Epoch: 18, Steps: 13 | Train Loss: 0.310 Vali Loss: 61.505 Vali Acc: 0.180 Test Loss: 61.505 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6486279964447021
Epoch: 19, Steps: 13 | Train Loss: 0.248 Vali Loss: 80.053 Vali Acc: 0.160 Test Loss: 80.053 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7327179908752441
Epoch: 20, Steps: 13 | Train Loss: 0.328 Vali Loss: 67.676 Vali Acc: 0.200 Test Loss: 67.676 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6524932384490967
Epoch: 21, Steps: 13 | Train Loss: 0.487 Vali Loss: 80.052 Vali Acc: 0.180 Test Loss: 80.052 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6347875595092773
Epoch: 22, Steps: 13 | Train Loss: 0.483 Vali Loss: 78.067 Vali Acc: 0.240 Test Loss: 78.067 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6299166679382324
Epoch: 23, Steps: 13 | Train Loss: 0.006 Vali Loss: 73.477 Vali Acc: 0.200 Test Loss: 73.477 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6619503498077393
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 71.355 Vali Acc: 0.200 Test Loss: 71.355 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df64_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 4383237
model size : 17.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.056919813156128
Epoch: 1, Steps: 13 | Train Loss: 2.158 Vali Loss: 4.439 Vali Acc: 0.160 Test Loss: 4.439 Test Acc: 0.160
Validation loss decreased (inf --> -0.159956).  Saving model ...
Epoch: 2 cost time: 1.4432971477508545
Epoch: 2, Steps: 13 | Train Loss: 0.021 Vali Loss: 5.364 Vali Acc: 0.120 Test Loss: 5.364 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4485161304473877
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.796 Vali Acc: 0.120 Test Loss: 7.796 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.380795955657959
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.691 Vali Acc: 0.120 Test Loss: 8.691 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.457367181777954
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.057 Vali Acc: 0.120 Test Loss: 9.057 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4542725086212158
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.116 Vali Acc: 0.120 Test Loss: 9.116 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.390366792678833
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.206 Vali Acc: 0.120 Test Loss: 9.206 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4509923458099365
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.166 Vali Acc: 0.120 Test Loss: 9.166 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.467548131942749
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.168 Vali Acc: 0.120 Test Loss: 9.168 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5250656604766846
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.237 Vali Acc: 0.120 Test Loss: 9.237 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.459503173828125
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.159 Vali Acc: 0.120 Test Loss: 9.159 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm64_nh16_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.16
model parameter : 3092933
model size : 13.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.2126548290252686
Epoch: 1, Steps: 25 | Train Loss: 21.053 Vali Loss: 34.719 Vali Acc: 0.220 Test Loss: 34.719 Test Acc: 0.220
Validation loss decreased (inf --> -0.219653).  Saving model ...
Epoch: 2 cost time: 5.758762836456299
Epoch: 2, Steps: 25 | Train Loss: 7.214 Vali Loss: 42.825 Vali Acc: 0.180 Test Loss: 42.825 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.726411819458008
Epoch: 3, Steps: 25 | Train Loss: 6.680 Vali Loss: 46.188 Vali Acc: 0.200 Test Loss: 46.188 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.687418699264526
Epoch: 4, Steps: 25 | Train Loss: 2.028 Vali Loss: 86.389 Vali Acc: 0.220 Test Loss: 86.389 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.823307275772095
Epoch: 5, Steps: 25 | Train Loss: 3.521 Vali Loss: 134.185 Vali Acc: 0.140 Test Loss: 134.185 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.832019805908203
Epoch: 6, Steps: 25 | Train Loss: 3.653 Vali Loss: 68.809 Vali Acc: 0.180 Test Loss: 68.809 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.687505483627319
Epoch: 7, Steps: 25 | Train Loss: 0.000 Vali Loss: 105.338 Vali Acc: 0.220 Test Loss: 105.338 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.948626518249512
Epoch: 8, Steps: 25 | Train Loss: 1.355 Vali Loss: 107.299 Vali Acc: 0.180 Test Loss: 107.299 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.759436845779419
Epoch: 9, Steps: 25 | Train Loss: 0.000 Vali Loss: 162.453 Vali Acc: 0.120 Test Loss: 162.453 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.670304536819458
Epoch: 10, Steps: 25 | Train Loss: 1.615 Vali Loss: 108.860 Vali Acc: 0.140 Test Loss: 108.860 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.924443483352661
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 129.716 Vali Acc: 0.180 Test Loss: 129.716 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 14481765
model size : 55.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.065042972564697
Epoch: 1, Steps: 13 | Train Loss: 3.955 Vali Loss: 10.022 Vali Acc: 0.200 Test Loss: 10.022 Test Acc: 0.200
Validation loss decreased (inf --> -0.199900).  Saving model ...
Epoch: 2 cost time: 3.3512091636657715
Epoch: 2, Steps: 13 | Train Loss: 1.045 Vali Loss: 25.592 Vali Acc: 0.220 Test Loss: 25.592 Test Acc: 0.220
Validation loss decreased (-0.199900 --> -0.219744).  Saving model ...
Epoch: 3 cost time: 3.4117813110351562
Epoch: 3, Steps: 13 | Train Loss: 0.354 Vali Loss: 39.004 Vali Acc: 0.140 Test Loss: 39.004 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5470259189605713
Epoch: 4, Steps: 13 | Train Loss: 0.255 Vali Loss: 30.729 Vali Acc: 0.180 Test Loss: 30.729 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3751003742218018
Epoch: 5, Steps: 13 | Train Loss: 0.935 Vali Loss: 42.448 Vali Acc: 0.220 Test Loss: 42.448 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.5449166297912598
Epoch: 6, Steps: 13 | Train Loss: 1.753 Vali Loss: 48.352 Vali Acc: 0.220 Test Loss: 48.352 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.486858606338501
Epoch: 7, Steps: 13 | Train Loss: 2.073 Vali Loss: 50.346 Vali Acc: 0.160 Test Loss: 50.346 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.339770793914795
Epoch: 8, Steps: 13 | Train Loss: 1.614 Vali Loss: 41.165 Vali Acc: 0.220 Test Loss: 41.165 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.3427631855010986
Epoch: 9, Steps: 13 | Train Loss: 1.005 Vali Loss: 54.281 Vali Acc: 0.200 Test Loss: 54.281 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.608060121536255
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 57.219 Vali Acc: 0.160 Test Loss: 57.219 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.3614025115966797
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 59.896 Vali Acc: 0.200 Test Loss: 59.896 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.5088417530059814
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 60.288 Vali Acc: 0.220 Test Loss: 60.288 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 8241189
model size : 32.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.060184717178345
Epoch: 1, Steps: 13 | Train Loss: 2.880 Vali Loss: 5.023 Vali Acc: 0.200 Test Loss: 5.023 Test Acc: 0.200
Validation loss decreased (inf --> -0.199950).  Saving model ...
Epoch: 2 cost time: 2.0652966499328613
Epoch: 2, Steps: 13 | Train Loss: 0.870 Vali Loss: 18.910 Vali Acc: 0.200 Test Loss: 18.910 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1141574382781982
Epoch: 3, Steps: 13 | Train Loss: 0.577 Vali Loss: 17.449 Vali Acc: 0.140 Test Loss: 17.449 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.103126287460327
Epoch: 4, Steps: 13 | Train Loss: 2.271 Vali Loss: 21.709 Vali Acc: 0.140 Test Loss: 21.709 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.095794916152954
Epoch: 5, Steps: 13 | Train Loss: 0.866 Vali Loss: 21.586 Vali Acc: 0.100 Test Loss: 21.586 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.090317964553833
Epoch: 6, Steps: 13 | Train Loss: 0.459 Vali Loss: 22.581 Vali Acc: 0.160 Test Loss: 22.581 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1598565578460693
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.278 Vali Acc: 0.180 Test Loss: 26.278 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2656092643737793
Epoch: 8, Steps: 13 | Train Loss: 0.168 Vali Loss: 23.177 Vali Acc: 0.160 Test Loss: 23.177 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.0746700763702393
Epoch: 9, Steps: 13 | Train Loss: 0.286 Vali Loss: 23.497 Vali Acc: 0.140 Test Loss: 23.497 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.0613222122192383
Epoch: 10, Steps: 13 | Train Loss: 2.088 Vali Loss: 25.383 Vali Acc: 0.200 Test Loss: 25.383 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.0558345317840576
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 24.766 Vali Acc: 0.120 Test Loss: 24.766 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 5228613
model size : 20.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df256_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7976632118225098
Epoch: 1, Steps: 13 | Train Loss: 2.442 Vali Loss: 3.830 Vali Acc: 0.220 Test Loss: 3.830 Test Acc: 0.220
Validation loss decreased (inf --> -0.219962).  Saving model ...
Epoch: 2 cost time: 2.021286964416504
Epoch: 2, Steps: 13 | Train Loss: 0.038 Vali Loss: 11.565 Vali Acc: 0.120 Test Loss: 11.565 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9342584609985352
Epoch: 3, Steps: 13 | Train Loss: 0.160 Vali Loss: 11.579 Vali Acc: 0.180 Test Loss: 11.579 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0475213527679443
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.351 Vali Acc: 0.100 Test Loss: 17.351 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.979933738708496
Epoch: 5, Steps: 13 | Train Loss: 0.211 Vali Loss: 14.441 Vali Acc: 0.180 Test Loss: 14.441 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1943604946136475
Epoch: 6, Steps: 13 | Train Loss: 0.936 Vali Loss: 26.575 Vali Acc: 0.200 Test Loss: 26.575 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0189642906188965
Epoch: 7, Steps: 13 | Train Loss: 0.321 Vali Loss: 17.159 Vali Acc: 0.120 Test Loss: 17.159 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.167921781539917
Epoch: 8, Steps: 13 | Train Loss: 0.014 Vali Loss: 32.732 Vali Acc: 0.200 Test Loss: 32.732 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.124392032623291
Epoch: 9, Steps: 13 | Train Loss: 1.163 Vali Loss: 39.138 Vali Acc: 0.160 Test Loss: 39.138 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.034210681915283
Epoch: 10, Steps: 13 | Train Loss: 1.787 Vali Loss: 28.965 Vali Acc: 0.140 Test Loss: 28.965 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9970934391021729
Epoch: 11, Steps: 13 | Train Loss: 0.636 Vali Loss: 32.842 Vali Acc: 0.240 Test Loss: 32.842 Test Acc: 0.240
Validation loss decreased (-0.219962 --> -0.239672).  Saving model ...
Epoch: 12 cost time: 2.0588855743408203
Epoch: 12, Steps: 13 | Train Loss: 0.370 Vali Loss: 34.005 Vali Acc: 0.200 Test Loss: 34.005 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0810654163360596
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 34.380 Vali Acc: 0.100 Test Loss: 34.380 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.058999538421631
Epoch: 14, Steps: 13 | Train Loss: 0.082 Vali Loss: 31.426 Vali Acc: 0.160 Test Loss: 31.426 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1797475814819336
Epoch: 15, Steps: 13 | Train Loss: 2.018 Vali Loss: 35.055 Vali Acc: 0.160 Test Loss: 35.055 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2394678592681885
Epoch: 16, Steps: 13 | Train Loss: 1.062 Vali Loss: 58.858 Vali Acc: 0.120 Test Loss: 58.858 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.10735821723938
Epoch: 17, Steps: 13 | Train Loss: 2.084 Vali Loss: 45.723 Vali Acc: 0.200 Test Loss: 45.723 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.072659969329834
Epoch: 18, Steps: 13 | Train Loss: 0.610 Vali Loss: 52.557 Vali Acc: 0.100 Test Loss: 52.557 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.0880699157714844
Epoch: 19, Steps: 13 | Train Loss: 0.004 Vali Loss: 69.563 Vali Acc: 0.160 Test Loss: 69.563 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0337271690368652
Epoch: 20, Steps: 13 | Train Loss: 0.363 Vali Loss: 78.783 Vali Acc: 0.220 Test Loss: 78.783 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.131540536880493
Epoch: 21, Steps: 13 | Train Loss: 0.396 Vali Loss: 62.662 Vali Acc: 0.160 Test Loss: 62.662 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df256_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 4152805
model size : 16.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1161868572235107
Epoch: 1, Steps: 13 | Train Loss: 2.109 Vali Loss: 6.163 Vali Acc: 0.200 Test Loss: 6.163 Test Acc: 0.200
Validation loss decreased (inf --> -0.199938).  Saving model ...
Epoch: 2 cost time: 1.4180057048797607
Epoch: 2, Steps: 13 | Train Loss: 0.144 Vali Loss: 6.310 Vali Acc: 0.160 Test Loss: 6.310 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.447674036026001
Epoch: 3, Steps: 13 | Train Loss: 0.077 Vali Loss: 8.482 Vali Acc: 0.140 Test Loss: 8.482 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3816370964050293
Epoch: 4, Steps: 13 | Train Loss: 0.139 Vali Loss: 12.272 Vali Acc: 0.220 Test Loss: 12.272 Test Acc: 0.220
Validation loss decreased (-0.199938 --> -0.219877).  Saving model ...
Epoch: 5 cost time: 1.445739507675171
Epoch: 5, Steps: 13 | Train Loss: 0.585 Vali Loss: 15.968 Vali Acc: 0.180 Test Loss: 15.968 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5509772300720215
Epoch: 6, Steps: 13 | Train Loss: 0.236 Vali Loss: 12.369 Vali Acc: 0.100 Test Loss: 12.369 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5555415153503418
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.312 Vali Acc: 0.260 Test Loss: 12.312 Test Acc: 0.260
Validation loss decreased (-0.219877 --> -0.259877).  Saving model ...
Epoch: 8 cost time: 1.6604068279266357
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 11.739 Vali Acc: 0.220 Test Loss: 11.739 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5735218524932861
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 15.774 Vali Acc: 0.240 Test Loss: 15.774 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.569976806640625
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 15.218 Vali Acc: 0.240 Test Loss: 15.218 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5995018482208252
Epoch: 11, Steps: 13 | Train Loss: 0.017 Vali Loss: 15.270 Vali Acc: 0.280 Test Loss: 15.270 Test Acc: 0.280
Validation loss decreased (-0.259877 --> -0.279847).  Saving model ...
Epoch: 12 cost time: 1.5697252750396729
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.631 Vali Acc: 0.220 Test Loss: 17.631 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7955937385559082
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.405 Vali Acc: 0.240 Test Loss: 17.405 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5833325386047363
Epoch: 14, Steps: 13 | Train Loss: 0.201 Vali Loss: 17.599 Vali Acc: 0.180 Test Loss: 17.599 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.633143424987793
Epoch: 15, Steps: 13 | Train Loss: 0.034 Vali Loss: 21.633 Vali Acc: 0.220 Test Loss: 21.633 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5808825492858887
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 20.369 Vali Acc: 0.200 Test Loss: 20.369 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6741113662719727
Epoch: 17, Steps: 13 | Train Loss: 0.206 Vali Loss: 21.628 Vali Acc: 0.240 Test Loss: 21.628 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6472532749176025
Epoch: 18, Steps: 13 | Train Loss: 0.167 Vali Loss: 33.439 Vali Acc: 0.220 Test Loss: 33.439 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5981521606445312
Epoch: 19, Steps: 13 | Train Loss: 0.442 Vali Loss: 32.803 Vali Acc: 0.260 Test Loss: 32.803 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7243413925170898
Epoch: 20, Steps: 13 | Train Loss: 0.149 Vali Loss: 28.172 Vali Acc: 0.260 Test Loss: 28.172 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5220856666564941
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 30.345 Vali Acc: 0.220 Test Loss: 30.345 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 2646853
model size : 10.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df256_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3343725204467773
Epoch: 1, Steps: 13 | Train Loss: 1.992 Vali Loss: 2.625 Vali Acc: 0.180 Test Loss: 2.625 Test Acc: 0.180
Validation loss decreased (inf --> -0.179974).  Saving model ...
Epoch: 2 cost time: 1.502718448638916
Epoch: 2, Steps: 13 | Train Loss: 0.050 Vali Loss: 5.693 Vali Acc: 0.260 Test Loss: 5.693 Test Acc: 0.260
Validation loss decreased (-0.179974 --> -0.259943).  Saving model ...
Epoch: 3 cost time: 1.4821863174438477
Epoch: 3, Steps: 13 | Train Loss: 0.032 Vali Loss: 9.095 Vali Acc: 0.140 Test Loss: 9.095 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.377901315689087
Epoch: 4, Steps: 13 | Train Loss: 0.092 Vali Loss: 11.456 Vali Acc: 0.200 Test Loss: 11.456 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.343036413192749
Epoch: 5, Steps: 13 | Train Loss: 0.097 Vali Loss: 8.145 Vali Acc: 0.200 Test Loss: 8.145 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4142014980316162
Epoch: 6, Steps: 13 | Train Loss: 0.001 Vali Loss: 8.438 Vali Acc: 0.220 Test Loss: 8.438 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4584476947784424
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.889 Vali Acc: 0.260 Test Loss: 8.889 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.363326072692871
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.579 Vali Acc: 0.280 Test Loss: 8.579 Test Acc: 0.280
Validation loss decreased (-0.259943 --> -0.279914).  Saving model ...
Epoch: 9 cost time: 1.5017364025115967
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.566 Vali Acc: 0.240 Test Loss: 8.566 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4444518089294434
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.564 Vali Acc: 0.240 Test Loss: 8.564 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4198589324951172
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.541 Vali Acc: 0.240 Test Loss: 8.541 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.526648759841919
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.527 Vali Acc: 0.260 Test Loss: 8.527 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5887377262115479
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.492 Vali Acc: 0.260 Test Loss: 8.492 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4306154251098633
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.389 Vali Acc: 0.260 Test Loss: 8.389 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3999135494232178
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.373 Vali Acc: 0.260 Test Loss: 8.373 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4455747604370117
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.385 Vali Acc: 0.260 Test Loss: 8.385 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4032557010650635
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.402 Vali Acc: 0.260 Test Loss: 8.402 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5033905506134033
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.415 Vali Acc: 0.260 Test Loss: 8.415 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df256_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 2216869
model size : 9.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1306469440460205
Epoch: 1, Steps: 13 | Train Loss: 1.783 Vali Loss: 1.954 Vali Acc: 0.160 Test Loss: 1.954 Test Acc: 0.160
Validation loss decreased (inf --> -0.159980).  Saving model ...
Epoch: 2 cost time: 1.3269248008728027
Epoch: 2, Steps: 13 | Train Loss: 0.015 Vali Loss: 3.296 Vali Acc: 0.180 Test Loss: 3.296 Test Acc: 0.180
Validation loss decreased (-0.159980 --> -0.179967).  Saving model ...
Epoch: 3 cost time: 1.3181240558624268
Epoch: 3, Steps: 13 | Train Loss: 0.020 Vali Loss: 5.912 Vali Acc: 0.120 Test Loss: 5.912 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.280954122543335
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.670 Vali Acc: 0.100 Test Loss: 5.670 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3264164924621582
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.933 Vali Acc: 0.120 Test Loss: 5.933 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.376387357711792
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.031 Vali Acc: 0.120 Test Loss: 6.031 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4108965396881104
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.947 Vali Acc: 0.120 Test Loss: 5.947 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.499485969543457
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.956 Vali Acc: 0.120 Test Loss: 5.956 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4302515983581543
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.900 Vali Acc: 0.120 Test Loss: 5.900 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.310194730758667
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.921 Vali Acc: 0.120 Test Loss: 5.921 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.410963773727417
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.939 Vali Acc: 0.120 Test Loss: 5.939 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.430511713027954
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.879 Vali Acc: 0.120 Test Loss: 5.879 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.18
model parameter : 1571717
model size : 6.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.780914068222046
Epoch: 1, Steps: 25 | Train Loss: 18.281 Vali Loss: 36.146 Vali Acc: 0.200 Test Loss: 36.146 Test Acc: 0.200
Validation loss decreased (inf --> -0.199639).  Saving model ...
Epoch: 2 cost time: 5.1792685985565186
Epoch: 2, Steps: 25 | Train Loss: 8.350 Vali Loss: 50.039 Vali Acc: 0.180 Test Loss: 50.039 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.1565210819244385
Epoch: 3, Steps: 25 | Train Loss: 0.921 Vali Loss: 83.064 Vali Acc: 0.200 Test Loss: 83.064 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.1639392375946045
Epoch: 4, Steps: 25 | Train Loss: 8.010 Vali Loss: 108.326 Vali Acc: 0.180 Test Loss: 108.326 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.325202226638794
Epoch: 5, Steps: 25 | Train Loss: 12.753 Vali Loss: 74.197 Vali Acc: 0.220 Test Loss: 74.197 Test Acc: 0.220
Validation loss decreased (-0.199639 --> -0.219258).  Saving model ...
Epoch: 6 cost time: 5.406198024749756
Epoch: 6, Steps: 25 | Train Loss: 1.660 Vali Loss: 102.234 Vali Acc: 0.240 Test Loss: 102.234 Test Acc: 0.240
Validation loss decreased (-0.219258 --> -0.238978).  Saving model ...
Epoch: 7 cost time: 5.180747032165527
Epoch: 7, Steps: 25 | Train Loss: 0.415 Vali Loss: 99.880 Vali Acc: 0.200 Test Loss: 99.880 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.4585394859313965
Epoch: 8, Steps: 25 | Train Loss: 7.715 Vali Loss: 152.013 Vali Acc: 0.220 Test Loss: 152.013 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.29847264289856
Epoch: 9, Steps: 25 | Train Loss: 3.566 Vali Loss: 121.778 Vali Acc: 0.140 Test Loss: 121.778 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.302045583724976
Epoch: 10, Steps: 25 | Train Loss: 0.000 Vali Loss: 142.150 Vali Acc: 0.160 Test Loss: 142.150 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.147178411483765
Epoch: 11, Steps: 25 | Train Loss: 1.406 Vali Loss: 141.144 Vali Acc: 0.100 Test Loss: 141.144 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.232656478881836
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 149.787 Vali Acc: 0.200 Test Loss: 149.787 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.289515972137451
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 153.077 Vali Acc: 0.200 Test Loss: 153.077 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.249950885772705
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 151.024 Vali Acc: 0.200 Test Loss: 151.024 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.22732138633728
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 151.458 Vali Acc: 0.200 Test Loss: 151.458 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.505735635757446
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 153.410 Vali Acc: 0.200 Test Loss: 153.410 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 14456805
model size : 55.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.108877897262573
Epoch: 1, Steps: 13 | Train Loss: 7.193 Vali Loss: 8.631 Vali Acc: 0.180 Test Loss: 8.631 Test Acc: 0.180
Validation loss decreased (inf --> -0.179914).  Saving model ...
Epoch: 2 cost time: 3.047703742980957
Epoch: 2, Steps: 13 | Train Loss: 0.978 Vali Loss: 11.961 Vali Acc: 0.160 Test Loss: 11.961 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.965648889541626
Epoch: 3, Steps: 13 | Train Loss: 2.525 Vali Loss: 36.740 Vali Acc: 0.200 Test Loss: 36.740 Test Acc: 0.200
Validation loss decreased (-0.179914 --> -0.199633).  Saving model ...
Epoch: 4 cost time: 3.0156936645507812
Epoch: 4, Steps: 13 | Train Loss: 0.528 Vali Loss: 35.838 Vali Acc: 0.200 Test Loss: 35.838 Test Acc: 0.200
Validation loss decreased (-0.199633 --> -0.199642).  Saving model ...
Epoch: 5 cost time: 3.0238983631134033
Epoch: 5, Steps: 13 | Train Loss: 0.861 Vali Loss: 32.009 Vali Acc: 0.180 Test Loss: 32.009 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.910484552383423
Epoch: 6, Steps: 13 | Train Loss: 0.757 Vali Loss: 39.816 Vali Acc: 0.140 Test Loss: 39.816 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.146543502807617
Epoch: 7, Steps: 13 | Train Loss: 0.669 Vali Loss: 43.130 Vali Acc: 0.200 Test Loss: 43.130 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8662874698638916
Epoch: 8, Steps: 13 | Train Loss: 0.061 Vali Loss: 52.454 Vali Acc: 0.200 Test Loss: 52.454 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9747772216796875
Epoch: 9, Steps: 13 | Train Loss: 1.006 Vali Loss: 108.972 Vali Acc: 0.160 Test Loss: 108.972 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.0108673572540283
Epoch: 10, Steps: 13 | Train Loss: 7.880 Vali Loss: 57.903 Vali Acc: 0.200 Test Loss: 57.903 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.0170230865478516
Epoch: 11, Steps: 13 | Train Loss: 1.400 Vali Loss: 92.134 Vali Acc: 0.200 Test Loss: 92.134 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.893845319747925
Epoch: 12, Steps: 13 | Train Loss: 1.153 Vali Loss: 111.196 Vali Acc: 0.200 Test Loss: 111.196 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.152949571609497
Epoch: 13, Steps: 13 | Train Loss: 0.926 Vali Loss: 73.275 Vali Acc: 0.200 Test Loss: 73.275 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.100376844406128
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 88.717 Vali Acc: 0.180 Test Loss: 88.717 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 8216229
model size : 31.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7723770141601562
Epoch: 1, Steps: 13 | Train Loss: 3.637 Vali Loss: 5.094 Vali Acc: 0.180 Test Loss: 5.094 Test Acc: 0.180
Validation loss decreased (inf --> -0.179949).  Saving model ...
Epoch: 2 cost time: 2.086275339126587
Epoch: 2, Steps: 13 | Train Loss: 0.169 Vali Loss: 8.931 Vali Acc: 0.220 Test Loss: 8.931 Test Acc: 0.220
Validation loss decreased (-0.179949 --> -0.219911).  Saving model ...
Epoch: 3 cost time: 1.968522071838379
Epoch: 3, Steps: 13 | Train Loss: 0.224 Vali Loss: 21.224 Vali Acc: 0.220 Test Loss: 21.224 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0211422443389893
Epoch: 4, Steps: 13 | Train Loss: 0.015 Vali Loss: 10.321 Vali Acc: 0.240 Test Loss: 10.321 Test Acc: 0.240
Validation loss decreased (-0.219911 --> -0.239897).  Saving model ...
Epoch: 5 cost time: 2.0569422245025635
Epoch: 5, Steps: 13 | Train Loss: 0.308 Vali Loss: 16.207 Vali Acc: 0.180 Test Loss: 16.207 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0462539196014404
Epoch: 6, Steps: 13 | Train Loss: 0.935 Vali Loss: 26.333 Vali Acc: 0.140 Test Loss: 26.333 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.121751070022583
Epoch: 7, Steps: 13 | Train Loss: 0.312 Vali Loss: 27.006 Vali Acc: 0.180 Test Loss: 27.006 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1423139572143555
Epoch: 8, Steps: 13 | Train Loss: 0.378 Vali Loss: 17.489 Vali Acc: 0.240 Test Loss: 17.489 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9285852909088135
Epoch: 9, Steps: 13 | Train Loss: 0.009 Vali Loss: 37.513 Vali Acc: 0.180 Test Loss: 37.513 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8600735664367676
Epoch: 10, Steps: 13 | Train Loss: 0.238 Vali Loss: 41.874 Vali Acc: 0.240 Test Loss: 41.874 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.013275384902954
Epoch: 11, Steps: 13 | Train Loss: 1.851 Vali Loss: 33.834 Vali Acc: 0.240 Test Loss: 33.834 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9713549613952637
Epoch: 12, Steps: 13 | Train Loss: 3.785 Vali Loss: 76.717 Vali Acc: 0.200 Test Loss: 76.717 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0509233474731445
Epoch: 13, Steps: 13 | Train Loss: 3.940 Vali Loss: 49.604 Vali Acc: 0.200 Test Loss: 49.604 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.103661060333252
Epoch: 14, Steps: 13 | Train Loss: 1.379 Vali Loss: 49.585 Vali Acc: 0.120 Test Loss: 49.585 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 5203653
model size : 20.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df128_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7272121906280518
Epoch: 1, Steps: 13 | Train Loss: 2.447 Vali Loss: 3.952 Vali Acc: 0.180 Test Loss: 3.952 Test Acc: 0.180
Validation loss decreased (inf --> -0.179960).  Saving model ...
Epoch: 2 cost time: 2.196255683898926
Epoch: 2, Steps: 13 | Train Loss: 0.038 Vali Loss: 11.714 Vali Acc: 0.160 Test Loss: 11.714 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9816274642944336
Epoch: 3, Steps: 13 | Train Loss: 0.316 Vali Loss: 10.924 Vali Acc: 0.140 Test Loss: 10.924 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8202283382415771
Epoch: 4, Steps: 13 | Train Loss: 0.024 Vali Loss: 14.043 Vali Acc: 0.100 Test Loss: 14.043 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.836280345916748
Epoch: 5, Steps: 13 | Train Loss: 0.028 Vali Loss: 13.146 Vali Acc: 0.160 Test Loss: 13.146 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9201686382293701
Epoch: 6, Steps: 13 | Train Loss: 0.882 Vali Loss: 14.397 Vali Acc: 0.200 Test Loss: 14.397 Test Acc: 0.200
Validation loss decreased (-0.179960 --> -0.199856).  Saving model ...
Epoch: 7 cost time: 2.0104522705078125
Epoch: 7, Steps: 13 | Train Loss: 1.169 Vali Loss: 22.529 Vali Acc: 0.100 Test Loss: 22.529 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0680692195892334
Epoch: 8, Steps: 13 | Train Loss: 0.434 Vali Loss: 19.901 Vali Acc: 0.140 Test Loss: 19.901 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1163270473480225
Epoch: 9, Steps: 13 | Train Loss: 0.056 Vali Loss: 32.922 Vali Acc: 0.120 Test Loss: 32.922 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9190454483032227
Epoch: 10, Steps: 13 | Train Loss: 0.126 Vali Loss: 64.400 Vali Acc: 0.200 Test Loss: 64.400 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1017632484436035
Epoch: 11, Steps: 13 | Train Loss: 3.184 Vali Loss: 34.084 Vali Acc: 0.180 Test Loss: 34.084 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9634318351745605
Epoch: 12, Steps: 13 | Train Loss: 3.422 Vali Loss: 37.585 Vali Acc: 0.180 Test Loss: 37.585 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9429152011871338
Epoch: 13, Steps: 13 | Train Loss: 0.156 Vali Loss: 35.565 Vali Acc: 0.160 Test Loss: 35.565 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0254170894622803
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 55.756 Vali Acc: 0.160 Test Loss: 55.756 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8729121685028076
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 63.976 Vali Acc: 0.160 Test Loss: 63.976 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.109001398086548
Epoch: 16, Steps: 13 | Train Loss: 0.022 Vali Loss: 45.318 Vali Acc: 0.120 Test Loss: 45.318 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df128_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 4127845
model size : 16.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2168915271759033
Epoch: 1, Steps: 13 | Train Loss: 2.499 Vali Loss: 2.961 Vali Acc: 0.200 Test Loss: 2.961 Test Acc: 0.200
Validation loss decreased (inf --> -0.199970).  Saving model ...
Epoch: 2 cost time: 1.3944363594055176
Epoch: 2, Steps: 13 | Train Loss: 0.010 Vali Loss: 9.570 Vali Acc: 0.200 Test Loss: 9.570 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3987629413604736
Epoch: 3, Steps: 13 | Train Loss: 0.005 Vali Loss: 9.645 Vali Acc: 0.100 Test Loss: 9.645 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4562757015228271
Epoch: 4, Steps: 13 | Train Loss: 0.013 Vali Loss: 10.147 Vali Acc: 0.220 Test Loss: 10.147 Test Acc: 0.220
Validation loss decreased (-0.199970 --> -0.219899).  Saving model ...
Epoch: 5 cost time: 1.4502983093261719
Epoch: 5, Steps: 13 | Train Loss: 0.033 Vali Loss: 13.711 Vali Acc: 0.140 Test Loss: 13.711 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3074913024902344
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.012 Vali Acc: 0.200 Test Loss: 18.012 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3980097770690918
Epoch: 7, Steps: 13 | Train Loss: 0.107 Vali Loss: 12.039 Vali Acc: 0.220 Test Loss: 12.039 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3231477737426758
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 15.311 Vali Acc: 0.220 Test Loss: 15.311 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4299530982971191
Epoch: 9, Steps: 13 | Train Loss: 0.068 Vali Loss: 12.103 Vali Acc: 0.220 Test Loss: 12.103 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.438194990158081
Epoch: 10, Steps: 13 | Train Loss: 0.009 Vali Loss: 13.163 Vali Acc: 0.200 Test Loss: 13.163 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5796301364898682
Epoch: 11, Steps: 13 | Train Loss: 0.271 Vali Loss: 13.565 Vali Acc: 0.200 Test Loss: 13.565 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4955313205718994
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 20.779 Vali Acc: 0.160 Test Loss: 20.779 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5139491558074951
Epoch: 13, Steps: 13 | Train Loss: 0.019 Vali Loss: 18.677 Vali Acc: 0.200 Test Loss: 18.677 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6570966243743896
Epoch: 14, Steps: 13 | Train Loss: 0.004 Vali Loss: 26.726 Vali Acc: 0.220 Test Loss: 26.726 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 2621893
model size : 10.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df128_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1917622089385986
Epoch: 1, Steps: 13 | Train Loss: 1.881 Vali Loss: 3.016 Vali Acc: 0.200 Test Loss: 3.016 Test Acc: 0.200
Validation loss decreased (inf --> -0.199970).  Saving model ...
Epoch: 2 cost time: 1.3901019096374512
Epoch: 2, Steps: 13 | Train Loss: 0.029 Vali Loss: 8.110 Vali Acc: 0.220 Test Loss: 8.110 Test Acc: 0.220
Validation loss decreased (-0.199970 --> -0.219919).  Saving model ...
Epoch: 3 cost time: 1.4608383178710938
Epoch: 3, Steps: 13 | Train Loss: 0.362 Vali Loss: 6.720 Vali Acc: 0.200 Test Loss: 6.720 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4949510097503662
Epoch: 4, Steps: 13 | Train Loss: 0.020 Vali Loss: 6.991 Vali Acc: 0.140 Test Loss: 6.991 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.435448169708252
Epoch: 5, Steps: 13 | Train Loss: 0.017 Vali Loss: 12.694 Vali Acc: 0.200 Test Loss: 12.694 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4436142444610596
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.414 Vali Acc: 0.200 Test Loss: 14.414 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6351921558380127
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.972 Vali Acc: 0.180 Test Loss: 14.972 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4740209579467773
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.756 Vali Acc: 0.180 Test Loss: 14.756 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2985033988952637
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.686 Vali Acc: 0.200 Test Loss: 14.686 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3843531608581543
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.517 Vali Acc: 0.220 Test Loss: 14.517 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4424793720245361
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.527 Vali Acc: 0.220 Test Loss: 14.527 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.496436595916748
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.503 Vali Acc: 0.220 Test Loss: 14.503 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df128_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 2191909
model size : 8.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8020875453948975
Epoch: 1, Steps: 13 | Train Loss: 1.939 Vali Loss: 2.707 Vali Acc: 0.200 Test Loss: 2.707 Test Acc: 0.200
Validation loss decreased (inf --> -0.199973).  Saving model ...
Epoch: 2 cost time: 1.1855719089508057
Epoch: 2, Steps: 13 | Train Loss: 0.041 Vali Loss: 4.030 Vali Acc: 0.300 Test Loss: 4.030 Test Acc: 0.300
Validation loss decreased (-0.199973 --> -0.299960).  Saving model ...
Epoch: 3 cost time: 1.324702262878418
Epoch: 3, Steps: 13 | Train Loss: 0.002 Vali Loss: 6.316 Vali Acc: 0.160 Test Loss: 6.316 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4011118412017822
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.802 Vali Acc: 0.140 Test Loss: 7.802 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2963905334472656
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.415 Vali Acc: 0.120 Test Loss: 8.415 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2528316974639893
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.383 Vali Acc: 0.120 Test Loss: 8.383 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2310969829559326
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.363 Vali Acc: 0.120 Test Loss: 8.363 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1766631603240967
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.253 Vali Acc: 0.120 Test Loss: 8.253 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2246408462524414
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.219 Vali Acc: 0.120 Test Loss: 8.219 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3838143348693848
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.219 Vali Acc: 0.120 Test Loss: 8.219 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3027677536010742
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.141 Vali Acc: 0.120 Test Loss: 8.141 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2327635288238525
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.106 Vali Acc: 0.120 Test Loss: 8.106 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1546757
model size : 6.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.375010013580322
Epoch: 1, Steps: 25 | Train Loss: 30.643 Vali Loss: 42.751 Vali Acc: 0.160 Test Loss: 42.751 Test Acc: 0.160
Validation loss decreased (inf --> -0.159572).  Saving model ...
Epoch: 2 cost time: 4.726624965667725
Epoch: 2, Steps: 25 | Train Loss: 19.267 Vali Loss: 130.635 Vali Acc: 0.160 Test Loss: 130.635 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.6859471797943115
Epoch: 3, Steps: 25 | Train Loss: 27.325 Vali Loss: 132.151 Vali Acc: 0.200 Test Loss: 132.151 Test Acc: 0.200
Validation loss decreased (-0.159572 --> -0.198678).  Saving model ...
Epoch: 4 cost time: 4.826501131057739
Epoch: 4, Steps: 25 | Train Loss: 9.948 Vali Loss: 102.028 Vali Acc: 0.200 Test Loss: 102.028 Test Acc: 0.200
Validation loss decreased (-0.198678 --> -0.198980).  Saving model ...
Epoch: 5 cost time: 4.655508995056152
Epoch: 5, Steps: 25 | Train Loss: 9.478 Vali Loss: 244.126 Vali Acc: 0.200 Test Loss: 244.126 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.711150407791138
Epoch: 6, Steps: 25 | Train Loss: 6.383 Vali Loss: 124.867 Vali Acc: 0.200 Test Loss: 124.867 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.740565538406372
Epoch: 7, Steps: 25 | Train Loss: 2.366 Vali Loss: 81.523 Vali Acc: 0.280 Test Loss: 81.523 Test Acc: 0.280
Validation loss decreased (-0.198980 --> -0.279185).  Saving model ...
Epoch: 8 cost time: 4.850030899047852
Epoch: 8, Steps: 25 | Train Loss: 0.000 Vali Loss: 98.180 Vali Acc: 0.320 Test Loss: 98.180 Test Acc: 0.320
Validation loss decreased (-0.279185 --> -0.319018).  Saving model ...
Epoch: 9 cost time: 4.924815654754639
Epoch: 9, Steps: 25 | Train Loss: 0.000 Vali Loss: 100.250 Vali Acc: 0.320 Test Loss: 100.250 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.756415367126465
Epoch: 10, Steps: 25 | Train Loss: 0.000 Vali Loss: 100.915 Vali Acc: 0.320 Test Loss: 100.915 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.995707273483276
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 100.832 Vali Acc: 0.320 Test Loss: 100.832 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.854528188705444
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 100.235 Vali Acc: 0.320 Test Loss: 100.235 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.8820672035217285
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 99.545 Vali Acc: 0.300 Test Loss: 99.545 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.841303825378418
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 99.853 Vali Acc: 0.300 Test Loss: 99.853 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.875205039978027
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 99.589 Vali Acc: 0.300 Test Loss: 99.589 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.801694393157959
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 99.938 Vali Acc: 0.320 Test Loss: 99.938 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.849884748458862
Epoch: 17, Steps: 25 | Train Loss: 0.000 Vali Loss: 100.440 Vali Acc: 0.320 Test Loss: 100.440 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.710267782211304
Epoch: 18, Steps: 25 | Train Loss: 0.000 Vali Loss: 101.953 Vali Acc: 0.320 Test Loss: 101.953 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 14444325
model size : 55.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.551231384277344
Epoch: 1, Steps: 13 | Train Loss: 3.028 Vali Loss: 8.456 Vali Acc: 0.180 Test Loss: 8.456 Test Acc: 0.180
Validation loss decreased (inf --> -0.179915).  Saving model ...
Epoch: 2 cost time: 2.5137126445770264
Epoch: 2, Steps: 13 | Train Loss: 0.852 Vali Loss: 18.607 Vali Acc: 0.220 Test Loss: 18.607 Test Acc: 0.220
Validation loss decreased (-0.179915 --> -0.219814).  Saving model ...
Epoch: 3 cost time: 2.6275503635406494
Epoch: 3, Steps: 13 | Train Loss: 0.734 Vali Loss: 36.677 Vali Acc: 0.220 Test Loss: 36.677 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.769371271133423
Epoch: 4, Steps: 13 | Train Loss: 1.212 Vali Loss: 45.080 Vali Acc: 0.180 Test Loss: 45.080 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.77911376953125
Epoch: 5, Steps: 13 | Train Loss: 0.779 Vali Loss: 56.931 Vali Acc: 0.220 Test Loss: 56.931 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7049145698547363
Epoch: 6, Steps: 13 | Train Loss: 4.718 Vali Loss: 50.191 Vali Acc: 0.160 Test Loss: 50.191 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7259740829467773
Epoch: 7, Steps: 13 | Train Loss: 3.928 Vali Loss: 39.484 Vali Acc: 0.120 Test Loss: 39.484 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.585660457611084
Epoch: 8, Steps: 13 | Train Loss: 1.448 Vali Loss: 70.317 Vali Acc: 0.120 Test Loss: 70.317 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.756013870239258
Epoch: 9, Steps: 13 | Train Loss: 0.589 Vali Loss: 82.688 Vali Acc: 0.160 Test Loss: 82.688 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.8338229656219482
Epoch: 10, Steps: 13 | Train Loss: 3.445 Vali Loss: 57.698 Vali Acc: 0.140 Test Loss: 57.698 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.777026891708374
Epoch: 11, Steps: 13 | Train Loss: 1.549 Vali Loss: 80.201 Vali Acc: 0.160 Test Loss: 80.201 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.546959400177002
Epoch: 12, Steps: 13 | Train Loss: 3.168 Vali Loss: 96.227 Vali Acc: 0.220 Test Loss: 96.227 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 8203749
model size : 31.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6481518745422363
Epoch: 1, Steps: 13 | Train Loss: 3.346 Vali Loss: 9.172 Vali Acc: 0.200 Test Loss: 9.172 Test Acc: 0.200
Validation loss decreased (inf --> -0.199908).  Saving model ...
Epoch: 2 cost time: 1.8283722400665283
Epoch: 2, Steps: 13 | Train Loss: 0.367 Vali Loss: 6.947 Vali Acc: 0.120 Test Loss: 6.947 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7901456356048584
Epoch: 3, Steps: 13 | Train Loss: 0.440 Vali Loss: 14.092 Vali Acc: 0.180 Test Loss: 14.092 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8202691078186035
Epoch: 4, Steps: 13 | Train Loss: 1.034 Vali Loss: 34.736 Vali Acc: 0.160 Test Loss: 34.736 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7712714672088623
Epoch: 5, Steps: 13 | Train Loss: 0.856 Vali Loss: 29.586 Vali Acc: 0.180 Test Loss: 29.586 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8530020713806152
Epoch: 6, Steps: 13 | Train Loss: 0.913 Vali Loss: 32.892 Vali Acc: 0.240 Test Loss: 32.892 Test Acc: 0.240
Validation loss decreased (-0.199908 --> -0.239671).  Saving model ...
Epoch: 7 cost time: 1.8161017894744873
Epoch: 7, Steps: 13 | Train Loss: 1.112 Vali Loss: 24.811 Vali Acc: 0.260 Test Loss: 24.811 Test Acc: 0.260
Validation loss decreased (-0.239671 --> -0.259752).  Saving model ...
Epoch: 8 cost time: 1.894496202468872
Epoch: 8, Steps: 13 | Train Loss: 0.993 Vali Loss: 31.675 Vali Acc: 0.240 Test Loss: 31.675 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9208095073699951
Epoch: 9, Steps: 13 | Train Loss: 1.692 Vali Loss: 42.089 Vali Acc: 0.140 Test Loss: 42.089 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8510315418243408
Epoch: 10, Steps: 13 | Train Loss: 2.245 Vali Loss: 31.123 Vali Acc: 0.180 Test Loss: 31.123 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9182496070861816
Epoch: 11, Steps: 13 | Train Loss: 1.689 Vali Loss: 44.887 Vali Acc: 0.180 Test Loss: 44.887 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.912015676498413
Epoch: 12, Steps: 13 | Train Loss: 1.150 Vali Loss: 91.772 Vali Acc: 0.200 Test Loss: 91.772 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9154086112976074
Epoch: 13, Steps: 13 | Train Loss: 3.194 Vali Loss: 84.973 Vali Acc: 0.220 Test Loss: 84.973 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.916111946105957
Epoch: 14, Steps: 13 | Train Loss: 0.954 Vali Loss: 79.392 Vali Acc: 0.180 Test Loss: 79.392 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.016801595687866
Epoch: 15, Steps: 13 | Train Loss: 1.017 Vali Loss: 86.164 Vali Acc: 0.200 Test Loss: 86.164 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9270286560058594
Epoch: 16, Steps: 13 | Train Loss: 0.004 Vali Loss: 63.377 Vali Acc: 0.260 Test Loss: 63.377 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8437485694885254
Epoch: 17, Steps: 13 | Train Loss: 0.775 Vali Loss: 71.819 Vali Acc: 0.140 Test Loss: 71.819 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 5191173
model size : 20.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df64_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.289316177368164
Epoch: 1, Steps: 13 | Train Loss: 2.324 Vali Loss: 10.406 Vali Acc: 0.200 Test Loss: 10.406 Test Acc: 0.200
Validation loss decreased (inf --> -0.199896).  Saving model ...
Epoch: 2 cost time: 1.62380051612854
Epoch: 2, Steps: 13 | Train Loss: 0.166 Vali Loss: 9.550 Vali Acc: 0.220 Test Loss: 9.550 Test Acc: 0.220
Validation loss decreased (-0.199896 --> -0.219905).  Saving model ...
Epoch: 3 cost time: 1.5595502853393555
Epoch: 3, Steps: 13 | Train Loss: 0.001 Vali Loss: 11.499 Vali Acc: 0.140 Test Loss: 11.499 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6215765476226807
Epoch: 4, Steps: 13 | Train Loss: 0.003 Vali Loss: 23.271 Vali Acc: 0.200 Test Loss: 23.271 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6743378639221191
Epoch: 5, Steps: 13 | Train Loss: 0.032 Vali Loss: 27.429 Vali Acc: 0.160 Test Loss: 27.429 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.579096794128418
Epoch: 6, Steps: 13 | Train Loss: 0.140 Vali Loss: 34.127 Vali Acc: 0.200 Test Loss: 34.127 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7121613025665283
Epoch: 7, Steps: 13 | Train Loss: 0.052 Vali Loss: 23.868 Vali Acc: 0.160 Test Loss: 23.868 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.634397268295288
Epoch: 8, Steps: 13 | Train Loss: 1.490 Vali Loss: 19.355 Vali Acc: 0.180 Test Loss: 19.355 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.61946439743042
Epoch: 9, Steps: 13 | Train Loss: 0.723 Vali Loss: 46.844 Vali Acc: 0.140 Test Loss: 46.844 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6582772731781006
Epoch: 10, Steps: 13 | Train Loss: 0.546 Vali Loss: 47.855 Vali Acc: 0.160 Test Loss: 47.855 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.645641803741455
Epoch: 11, Steps: 13 | Train Loss: 1.116 Vali Loss: 54.701 Vali Acc: 0.160 Test Loss: 54.701 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7651419639587402
Epoch: 12, Steps: 13 | Train Loss: 1.494 Vali Loss: 45.295 Vali Acc: 0.100 Test Loss: 45.295 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df64_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 4115365
model size : 16.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.47605037689209
Epoch: 1, Steps: 13 | Train Loss: 2.001 Vali Loss: 4.061 Vali Acc: 0.180 Test Loss: 4.061 Test Acc: 0.180
Validation loss decreased (inf --> -0.179959).  Saving model ...
Epoch: 2 cost time: 1.416046142578125
Epoch: 2, Steps: 13 | Train Loss: 0.153 Vali Loss: 10.005 Vali Acc: 0.180 Test Loss: 10.005 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.621778964996338
Epoch: 3, Steps: 13 | Train Loss: 0.010 Vali Loss: 6.116 Vali Acc: 0.180 Test Loss: 6.116 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4684205055236816
Epoch: 4, Steps: 13 | Train Loss: 0.004 Vali Loss: 7.112 Vali Acc: 0.180 Test Loss: 7.112 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4742412567138672
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.235 Vali Acc: 0.160 Test Loss: 9.235 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5011205673217773
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.748 Vali Acc: 0.140 Test Loss: 9.748 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.49483323097229
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.538 Vali Acc: 0.180 Test Loss: 11.538 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.430112361907959
Epoch: 8, Steps: 13 | Train Loss: 0.208 Vali Loss: 17.555 Vali Acc: 0.160 Test Loss: 17.555 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4368391036987305
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 13.083 Vali Acc: 0.180 Test Loss: 13.083 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.397719144821167
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.210 Vali Acc: 0.160 Test Loss: 12.210 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.301504135131836
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.017 Vali Acc: 0.160 Test Loss: 12.017 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.18
model parameter : 2609413
model size : 10.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df64_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.019101142883301
Epoch: 1, Steps: 13 | Train Loss: 1.982 Vali Loss: 2.037 Vali Acc: 0.160 Test Loss: 2.037 Test Acc: 0.160
Validation loss decreased (inf --> -0.159980).  Saving model ...
Epoch: 2 cost time: 1.2756788730621338
Epoch: 2, Steps: 13 | Train Loss: 0.006 Vali Loss: 3.916 Vali Acc: 0.200 Test Loss: 3.916 Test Acc: 0.200
Validation loss decreased (-0.159980 --> -0.199961).  Saving model ...
Epoch: 3 cost time: 1.278099775314331
Epoch: 3, Steps: 13 | Train Loss: 0.004 Vali Loss: 6.287 Vali Acc: 0.180 Test Loss: 6.287 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.313722848892212
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.438 Vali Acc: 0.220 Test Loss: 8.438 Test Acc: 0.220
Validation loss decreased (-0.199961 --> -0.219916).  Saving model ...
Epoch: 5 cost time: 1.2945430278778076
Epoch: 5, Steps: 13 | Train Loss: 0.020 Vali Loss: 13.126 Vali Acc: 0.160 Test Loss: 13.126 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2850003242492676
Epoch: 6, Steps: 13 | Train Loss: 0.046 Vali Loss: 12.826 Vali Acc: 0.220 Test Loss: 12.826 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.296236276626587
Epoch: 7, Steps: 13 | Train Loss: 0.726 Vali Loss: 15.078 Vali Acc: 0.220 Test Loss: 15.078 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2719542980194092
Epoch: 8, Steps: 13 | Train Loss: 0.577 Vali Loss: 17.843 Vali Acc: 0.200 Test Loss: 17.843 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4081611633300781
Epoch: 9, Steps: 13 | Train Loss: 0.983 Vali Loss: 17.053 Vali Acc: 0.180 Test Loss: 17.053 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3430488109588623
Epoch: 10, Steps: 13 | Train Loss: 0.330 Vali Loss: 15.312 Vali Acc: 0.180 Test Loss: 15.312 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5016303062438965
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.732 Vali Acc: 0.260 Test Loss: 19.732 Test Acc: 0.260
Validation loss decreased (-0.219916 --> -0.259803).  Saving model ...
Epoch: 12 cost time: 1.3961234092712402
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.328 Vali Acc: 0.240 Test Loss: 21.328 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.496443271636963
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.666 Vali Acc: 0.240 Test Loss: 21.666 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4741172790527344
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.549 Vali Acc: 0.240 Test Loss: 21.549 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5066933631896973
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.643 Vali Acc: 0.240 Test Loss: 21.643 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3657305240631104
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.597 Vali Acc: 0.240 Test Loss: 21.597 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5560941696166992
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.437 Vali Acc: 0.240 Test Loss: 21.437 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4761462211608887
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.577 Vali Acc: 0.240 Test Loss: 21.577 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3478190898895264
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.411 Vali Acc: 0.240 Test Loss: 21.411 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4354474544525146
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.350 Vali Acc: 0.240 Test Loss: 21.350 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4385063648223877
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.416 Vali Acc: 0.240 Test Loss: 21.416 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df64_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 2179429
model size : 8.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4861936569213867
Epoch: 1, Steps: 13 | Train Loss: 2.075 Vali Loss: 2.692 Vali Acc: 0.280 Test Loss: 2.692 Test Acc: 0.280
Validation loss decreased (inf --> -0.279973).  Saving model ...
Epoch: 2 cost time: 1.300938367843628
Epoch: 2, Steps: 13 | Train Loss: 0.095 Vali Loss: 3.759 Vali Acc: 0.220 Test Loss: 3.759 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1569199562072754
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.869 Vali Acc: 0.140 Test Loss: 6.869 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1185076236724854
Epoch: 4, Steps: 13 | Train Loss: 0.004 Vali Loss: 4.937 Vali Acc: 0.180 Test Loss: 4.937 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.019869089126587
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.563 Vali Acc: 0.180 Test Loss: 5.563 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1445937156677246
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.943 Vali Acc: 0.180 Test Loss: 4.943 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1372435092926025
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.086 Vali Acc: 0.200 Test Loss: 6.086 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0234599113464355
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.690 Vali Acc: 0.140 Test Loss: 6.690 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1458404064178467
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.626 Vali Acc: 0.180 Test Loss: 6.626 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0374057292938232
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.428 Vali Acc: 0.180 Test Loss: 6.428 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2555387020111084
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.394 Vali Acc: 0.200 Test Loss: 6.394 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm32_nh4_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 1534277
model size : 6.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.497827768325806
Epoch: 1, Steps: 25 | Train Loss: 10.225 Vali Loss: 11.597 Vali Acc: 0.180 Test Loss: 11.597 Test Acc: 0.180
Validation loss decreased (inf --> -0.179884).  Saving model ...
Epoch: 2 cost time: 4.984326124191284
Epoch: 2, Steps: 25 | Train Loss: 2.418 Vali Loss: 50.544 Vali Acc: 0.180 Test Loss: 50.544 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.977473258972168
Epoch: 3, Steps: 25 | Train Loss: 5.005 Vali Loss: 71.565 Vali Acc: 0.180 Test Loss: 71.565 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.160712718963623
Epoch: 4, Steps: 25 | Train Loss: 1.887 Vali Loss: 44.673 Vali Acc: 0.180 Test Loss: 44.673 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.973248243331909
Epoch: 5, Steps: 25 | Train Loss: 2.469 Vali Loss: 42.365 Vali Acc: 0.200 Test Loss: 42.365 Test Acc: 0.200
Validation loss decreased (-0.179884 --> -0.199576).  Saving model ...
Epoch: 6 cost time: 5.084927797317505
Epoch: 6, Steps: 25 | Train Loss: 0.170 Vali Loss: 55.693 Vali Acc: 0.120 Test Loss: 55.693 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.039819955825806
Epoch: 7, Steps: 25 | Train Loss: 0.770 Vali Loss: 55.921 Vali Acc: 0.220 Test Loss: 55.921 Test Acc: 0.220
Validation loss decreased (-0.199576 --> -0.219441).  Saving model ...
Epoch: 8 cost time: 5.146329402923584
Epoch: 8, Steps: 25 | Train Loss: 0.000 Vali Loss: 57.284 Vali Acc: 0.220 Test Loss: 57.284 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.165747404098511
Epoch: 9, Steps: 25 | Train Loss: 0.000 Vali Loss: 57.424 Vali Acc: 0.220 Test Loss: 57.424 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.444693088531494
Epoch: 10, Steps: 25 | Train Loss: 0.000 Vali Loss: 57.517 Vali Acc: 0.220 Test Loss: 57.517 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.219753265380859
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 57.481 Vali Acc: 0.220 Test Loss: 57.481 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.42885947227478
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 57.427 Vali Acc: 0.220 Test Loss: 57.427 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.1758341789245605
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 57.383 Vali Acc: 0.220 Test Loss: 57.383 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.226694345474243
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 57.370 Vali Acc: 0.220 Test Loss: 57.370 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.2312939167022705
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 57.258 Vali Acc: 0.220 Test Loss: 57.258 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.198312520980835
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 57.108 Vali Acc: 0.220 Test Loss: 57.108 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.291869401931763
Epoch: 17, Steps: 25 | Train Loss: 0.000 Vali Loss: 57.176 Vali Acc: 0.220 Test Loss: 57.176 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 7238197
model size : 27.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.511981964111328
Epoch: 1, Steps: 13 | Train Loss: 2.539 Vali Loss: 4.922 Vali Acc: 0.200 Test Loss: 4.922 Test Acc: 0.200
Validation loss decreased (inf --> -0.199951).  Saving model ...
Epoch: 2 cost time: 3.0116450786590576
Epoch: 2, Steps: 13 | Train Loss: 0.399 Vali Loss: 6.551 Vali Acc: 0.140 Test Loss: 6.551 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9579877853393555
Epoch: 3, Steps: 13 | Train Loss: 0.093 Vali Loss: 26.259 Vali Acc: 0.200 Test Loss: 26.259 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0900487899780273
Epoch: 4, Steps: 13 | Train Loss: 1.425 Vali Loss: 19.123 Vali Acc: 0.200 Test Loss: 19.123 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0905184745788574
Epoch: 5, Steps: 13 | Train Loss: 0.122 Vali Loss: 15.465 Vali Acc: 0.180 Test Loss: 15.465 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.1194849014282227
Epoch: 6, Steps: 13 | Train Loss: 0.655 Vali Loss: 28.483 Vali Acc: 0.240 Test Loss: 28.483 Test Acc: 0.240
Validation loss decreased (-0.199951 --> -0.239715).  Saving model ...
Epoch: 7 cost time: 3.1229734420776367
Epoch: 7, Steps: 13 | Train Loss: 0.941 Vali Loss: 28.958 Vali Acc: 0.180 Test Loss: 28.958 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1835548877716064
Epoch: 8, Steps: 13 | Train Loss: 0.972 Vali Loss: 28.985 Vali Acc: 0.220 Test Loss: 28.985 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.176340341567993
Epoch: 9, Steps: 13 | Train Loss: 0.670 Vali Loss: 34.536 Vali Acc: 0.180 Test Loss: 34.536 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.225111484527588
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.711 Vali Acc: 0.260 Test Loss: 26.711 Test Acc: 0.260
Validation loss decreased (-0.239715 --> -0.259733).  Saving model ...
Epoch: 11 cost time: 3.134979009628296
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 29.871 Vali Acc: 0.200 Test Loss: 29.871 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0754008293151855
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.420 Vali Acc: 0.260 Test Loss: 24.420 Test Acc: 0.260
Validation loss decreased (-0.259733 --> -0.259756).  Saving model ...
Epoch: 13 cost time: 3.1543121337890625
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 44.830 Vali Acc: 0.160 Test Loss: 44.830 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2713468074798584
Epoch: 14, Steps: 13 | Train Loss: 0.802 Vali Loss: 41.140 Vali Acc: 0.180 Test Loss: 41.140 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.110645055770874
Epoch: 15, Steps: 13 | Train Loss: 1.187 Vali Loss: 42.001 Vali Acc: 0.200 Test Loss: 42.001 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1266069412231445
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 54.842 Vali Acc: 0.200 Test Loss: 54.842 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.1913247108459473
Epoch: 17, Steps: 13 | Train Loss: 0.529 Vali Loss: 49.743 Vali Acc: 0.240 Test Loss: 49.743 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.1390156745910645
Epoch: 18, Steps: 13 | Train Loss: 0.042 Vali Loss: 51.738 Vali Acc: 0.140 Test Loss: 51.738 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.280353546142578
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 60.349 Vali Acc: 0.180 Test Loss: 60.349 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.01596736907959
Epoch: 20, Steps: 13 | Train Loss: 0.215 Vali Loss: 48.406 Vali Acc: 0.200 Test Loss: 48.406 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.245413303375244
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 50.593 Vali Acc: 0.200 Test Loss: 50.593 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.057755470275879
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 51.560 Vali Acc: 0.220 Test Loss: 51.560 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 4117909
model size : 16.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.080442905426025
Epoch: 1, Steps: 13 | Train Loss: 2.761 Vali Loss: 4.394 Vali Acc: 0.200 Test Loss: 4.394 Test Acc: 0.200
Validation loss decreased (inf --> -0.199956).  Saving model ...
Epoch: 2 cost time: 2.129055976867676
Epoch: 2, Steps: 13 | Train Loss: 0.389 Vali Loss: 5.566 Vali Acc: 0.140 Test Loss: 5.566 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1450977325439453
Epoch: 3, Steps: 13 | Train Loss: 0.035 Vali Loss: 6.800 Vali Acc: 0.160 Test Loss: 6.800 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0245885848999023
Epoch: 4, Steps: 13 | Train Loss: 0.011 Vali Loss: 8.499 Vali Acc: 0.200 Test Loss: 8.499 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1029062271118164
Epoch: 5, Steps: 13 | Train Loss: 0.008 Vali Loss: 12.643 Vali Acc: 0.180 Test Loss: 12.643 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.116349697113037
Epoch: 6, Steps: 13 | Train Loss: 0.130 Vali Loss: 13.444 Vali Acc: 0.160 Test Loss: 13.444 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.147953987121582
Epoch: 7, Steps: 13 | Train Loss: 0.058 Vali Loss: 12.412 Vali Acc: 0.200 Test Loss: 12.412 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9462106227874756
Epoch: 8, Steps: 13 | Train Loss: 0.057 Vali Loss: 12.584 Vali Acc: 0.200 Test Loss: 12.584 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1591644287109375
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.234 Vali Acc: 0.180 Test Loss: 14.234 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.095059394836426
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 13.558 Vali Acc: 0.240 Test Loss: 13.558 Test Acc: 0.240
Validation loss decreased (-0.199956 --> -0.239864).  Saving model ...
Epoch: 11 cost time: 1.962883710861206
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.788 Vali Acc: 0.200 Test Loss: 12.788 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.975386142730713
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.755 Vali Acc: 0.180 Test Loss: 12.755 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0229780673980713
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.649 Vali Acc: 0.180 Test Loss: 12.649 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0360190868377686
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.672 Vali Acc: 0.180 Test Loss: 12.672 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9818851947784424
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.723 Vali Acc: 0.180 Test Loss: 12.723 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8579769134521484
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.723 Vali Acc: 0.180 Test Loss: 12.723 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8922357559204102
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.753 Vali Acc: 0.180 Test Loss: 12.753 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.029390335083008
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.671 Vali Acc: 0.200 Test Loss: 12.671 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9804017543792725
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.711 Vali Acc: 0.180 Test Loss: 12.711 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9184353351593018
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.796 Vali Acc: 0.180 Test Loss: 12.796 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 2611621
model size : 10.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df256_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.299503803253174
Epoch: 1, Steps: 13 | Train Loss: 2.145 Vali Loss: 2.860 Vali Acc: 0.200 Test Loss: 2.860 Test Acc: 0.200
Validation loss decreased (inf --> -0.199971).  Saving model ...
Epoch: 2 cost time: 1.7559027671813965
Epoch: 2, Steps: 13 | Train Loss: 0.067 Vali Loss: 5.356 Vali Acc: 0.200 Test Loss: 5.356 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7153346538543701
Epoch: 3, Steps: 13 | Train Loss: 0.003 Vali Loss: 7.283 Vali Acc: 0.200 Test Loss: 7.283 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.674675703048706
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.094 Vali Acc: 0.200 Test Loss: 7.094 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6958575248718262
Epoch: 5, Steps: 13 | Train Loss: 0.001 Vali Loss: 7.177 Vali Acc: 0.240 Test Loss: 7.177 Test Acc: 0.240
Validation loss decreased (-0.199971 --> -0.239928).  Saving model ...
Epoch: 6 cost time: 1.7834055423736572
Epoch: 6, Steps: 13 | Train Loss: 0.001 Vali Loss: 7.509 Vali Acc: 0.220 Test Loss: 7.509 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.829833984375
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 10.092 Vali Acc: 0.180 Test Loss: 10.092 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.728743314743042
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.516 Vali Acc: 0.240 Test Loss: 7.516 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7178292274475098
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.452 Vali Acc: 0.240 Test Loss: 7.452 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7925479412078857
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.262 Vali Acc: 0.220 Test Loss: 7.262 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.923154592514038
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.468 Vali Acc: 0.260 Test Loss: 7.468 Test Acc: 0.260
Validation loss decreased (-0.239928 --> -0.259925).  Saving model ...
Epoch: 12 cost time: 1.8144547939300537
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.507 Vali Acc: 0.260 Test Loss: 7.507 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.906569004058838
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.528 Vali Acc: 0.260 Test Loss: 7.528 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7695283889770508
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.480 Vali Acc: 0.260 Test Loss: 7.480 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9784903526306152
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.465 Vali Acc: 0.260 Test Loss: 7.465 Test Acc: 0.260
Validation loss decreased (-0.259925 --> -0.259925).  Saving model ...
Epoch: 16 cost time: 1.883810043334961
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.460 Vali Acc: 0.260 Test Loss: 7.460 Test Acc: 0.260
Validation loss decreased (-0.259925 --> -0.259925).  Saving model ...
Epoch: 17 cost time: 1.7909133434295654
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.446 Vali Acc: 0.260 Test Loss: 7.446 Test Acc: 0.260
Validation loss decreased (-0.259925 --> -0.259926).  Saving model ...
Epoch: 18 cost time: 1.8005247116088867
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.466 Vali Acc: 0.260 Test Loss: 7.466 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7358953952789307
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.441 Vali Acc: 0.260 Test Loss: 7.441 Test Acc: 0.260
Validation loss decreased (-0.259926 --> -0.259926).  Saving model ...
Epoch: 20 cost time: 1.7412011623382568
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.433 Vali Acc: 0.260 Test Loss: 7.433 Test Acc: 0.260
Validation loss decreased (-0.259926 --> -0.259926).  Saving model ...
Epoch: 21 cost time: 1.827864408493042
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.411 Vali Acc: 0.260 Test Loss: 7.411 Test Acc: 0.260
Validation loss decreased (-0.259926 --> -0.259926).  Saving model ...
Epoch: 22 cost time: 1.8310377597808838
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.445 Vali Acc: 0.260 Test Loss: 7.445 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.680466651916504
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.414 Vali Acc: 0.260 Test Loss: 7.414 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6343700885772705
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.377 Vali Acc: 0.260 Test Loss: 7.377 Test Acc: 0.260
Validation loss decreased (-0.259926 --> -0.259926).  Saving model ...
Epoch: 25 cost time: 1.7442359924316406
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.390 Vali Acc: 0.260 Test Loss: 7.390 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7122268676757812
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.374 Vali Acc: 0.260 Test Loss: 7.374 Test Acc: 0.260
Validation loss decreased (-0.259926 --> -0.259926).  Saving model ...
Epoch: 27 cost time: 1.7322382926940918
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.385 Vali Acc: 0.260 Test Loss: 7.385 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.791576623916626
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.391 Vali Acc: 0.260 Test Loss: 7.391 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8029811382293701
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.393 Vali Acc: 0.260 Test Loss: 7.393 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6398842334747314
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.373 Vali Acc: 0.260 Test Loss: 7.373 Test Acc: 0.260
Validation loss decreased (-0.259926 --> -0.259926).  Saving model ...
Epoch: 31 cost time: 1.6658108234405518
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.357 Vali Acc: 0.260 Test Loss: 7.357 Test Acc: 0.260
Validation loss decreased (-0.259926 --> -0.259926).  Saving model ...
Epoch: 32 cost time: 1.7824962139129639
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.355 Vali Acc: 0.260 Test Loss: 7.355 Test Acc: 0.260
Validation loss decreased (-0.259926 --> -0.259926).  Saving model ...
Epoch: 33 cost time: 1.820683479309082
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.359 Vali Acc: 0.260 Test Loss: 7.359 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.802884817123413
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.354 Vali Acc: 0.260 Test Loss: 7.354 Test Acc: 0.260
Validation loss decreased (-0.259926 --> -0.259926).  Saving model ...
Epoch: 35 cost time: 1.8010826110839844
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.351 Vali Acc: 0.260 Test Loss: 7.351 Test Acc: 0.260
Validation loss decreased (-0.259926 --> -0.259926).  Saving model ...
Epoch: 36 cost time: 1.7652170658111572
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.353 Vali Acc: 0.260 Test Loss: 7.353 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.6794474124908447
Epoch: 37, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.348 Vali Acc: 0.260 Test Loss: 7.348 Test Acc: 0.260
Validation loss decreased (-0.259926 --> -0.259927).  Saving model ...
Epoch: 38 cost time: 1.7206358909606934
Epoch: 38, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.361 Vali Acc: 0.260 Test Loss: 7.361 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7500169277191162
Epoch: 39, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.340 Vali Acc: 0.260 Test Loss: 7.340 Test Acc: 0.260
Validation loss decreased (-0.259927 --> -0.259927).  Saving model ...
Epoch: 40 cost time: 1.8376579284667969
Epoch: 40, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.357 Vali Acc: 0.260 Test Loss: 7.357 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.7623679637908936
Epoch: 41, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.333 Vali Acc: 0.260 Test Loss: 7.333 Test Acc: 0.260
Validation loss decreased (-0.259927 --> -0.259927).  Saving model ...
Epoch: 42 cost time: 1.987658977508545
Epoch: 42, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.331 Vali Acc: 0.240 Test Loss: 7.331 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.18815541267395
Epoch: 43, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.329 Vali Acc: 0.260 Test Loss: 7.329 Test Acc: 0.260
Validation loss decreased (-0.259927 --> -0.259927).  Saving model ...
Epoch: 44 cost time: 2.006708860397339
Epoch: 44, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.324 Vali Acc: 0.260 Test Loss: 7.324 Test Acc: 0.260
Validation loss decreased (-0.259927 --> -0.259927).  Saving model ...
Epoch: 45 cost time: 1.9043073654174805
Epoch: 45, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.342 Vali Acc: 0.260 Test Loss: 7.342 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.8805785179138184
Epoch: 46, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.336 Vali Acc: 0.260 Test Loss: 7.336 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.714850664138794
Epoch: 47, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.325 Vali Acc: 0.260 Test Loss: 7.325 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.8728697299957275
Epoch: 48, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.324 Vali Acc: 0.240 Test Loss: 7.324 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.9928109645843506
Epoch: 49, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.329 Vali Acc: 0.240 Test Loss: 7.329 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.0299503803253174
Epoch: 50, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.318 Vali Acc: 0.240 Test Loss: 7.318 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.8747501373291016
Epoch: 51, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.340 Vali Acc: 0.260 Test Loss: 7.340 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.8165454864501953
Epoch: 52, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.306 Vali Acc: 0.240 Test Loss: 7.306 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.917403221130371
Epoch: 53, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.315 Vali Acc: 0.240 Test Loss: 7.315 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.936450481414795
Epoch: 54, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.308 Vali Acc: 0.240 Test Loss: 7.308 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df256_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 2073717
model size : 8.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.021925449371338
Epoch: 1, Steps: 13 | Train Loss: 1.986 Vali Loss: 2.233 Vali Acc: 0.100 Test Loss: 2.233 Test Acc: 0.100
Validation loss decreased (inf --> -0.099978).  Saving model ...
Epoch: 2 cost time: 1.3396282196044922
Epoch: 2, Steps: 13 | Train Loss: 0.047 Vali Loss: 3.610 Vali Acc: 0.180 Test Loss: 3.610 Test Acc: 0.180
Validation loss decreased (-0.099978 --> -0.179964).  Saving model ...
Epoch: 3 cost time: 1.3251185417175293
Epoch: 3, Steps: 13 | Train Loss: 0.004 Vali Loss: 5.591 Vali Acc: 0.220 Test Loss: 5.591 Test Acc: 0.220
Validation loss decreased (-0.179964 --> -0.219944).  Saving model ...
Epoch: 4 cost time: 1.482072353363037
Epoch: 4, Steps: 13 | Train Loss: 0.055 Vali Loss: 7.447 Vali Acc: 0.180 Test Loss: 7.447 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3870320320129395
Epoch: 5, Steps: 13 | Train Loss: 0.040 Vali Loss: 5.415 Vali Acc: 0.180 Test Loss: 5.415 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5321044921875
Epoch: 6, Steps: 13 | Train Loss: 0.034 Vali Loss: 8.364 Vali Acc: 0.240 Test Loss: 8.364 Test Acc: 0.240
Validation loss decreased (-0.219944 --> -0.239916).  Saving model ...
Epoch: 7 cost time: 1.4883849620819092
Epoch: 7, Steps: 13 | Train Loss: 0.083 Vali Loss: 7.147 Vali Acc: 0.220 Test Loss: 7.147 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4279425144195557
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.986 Vali Acc: 0.180 Test Loss: 9.986 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4701204299926758
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.041 Vali Acc: 0.160 Test Loss: 11.041 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.389399528503418
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.235 Vali Acc: 0.160 Test Loss: 11.235 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5838329792022705
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.939 Vali Acc: 0.160 Test Loss: 10.939 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4144325256347656
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.720 Vali Acc: 0.160 Test Loss: 9.720 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4267165660858154
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.377 Vali Acc: 0.160 Test Loss: 9.377 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5171630382537842
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.331 Vali Acc: 0.160 Test Loss: 9.331 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5486760139465332
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.289 Vali Acc: 0.160 Test Loss: 9.289 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.500976800918579
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.349 Vali Acc: 0.160 Test Loss: 9.349 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 1320741
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df256_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.600196123123169
Epoch: 1, Steps: 13 | Train Loss: 2.021 Vali Loss: 1.899 Vali Acc: 0.240 Test Loss: 1.899 Test Acc: 0.240
Validation loss decreased (inf --> -0.239981).  Saving model ...
Epoch: 2 cost time: 1.3464610576629639
Epoch: 2, Steps: 13 | Train Loss: 0.076 Vali Loss: 3.617 Vali Acc: 0.220 Test Loss: 3.617 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5021681785583496
Epoch: 3, Steps: 13 | Train Loss: 0.022 Vali Loss: 3.458 Vali Acc: 0.260 Test Loss: 3.458 Test Acc: 0.260
Validation loss decreased (-0.239981 --> -0.259965).  Saving model ...
Epoch: 4 cost time: 1.554530382156372
Epoch: 4, Steps: 13 | Train Loss: 0.001 Vali Loss: 4.014 Vali Acc: 0.200 Test Loss: 4.014 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4108030796051025
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.729 Vali Acc: 0.220 Test Loss: 6.729 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3104803562164307
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.377 Vali Acc: 0.220 Test Loss: 6.377 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3503215312957764
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.237 Vali Acc: 0.200 Test Loss: 6.237 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3386671543121338
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.120 Vali Acc: 0.220 Test Loss: 6.120 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3050670623779297
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.121 Vali Acc: 0.220 Test Loss: 6.121 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3418445587158203
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.140 Vali Acc: 0.180 Test Loss: 6.140 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.297435998916626
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.988 Vali Acc: 0.220 Test Loss: 5.988 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3969981670379639
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.067 Vali Acc: 0.220 Test Loss: 6.067 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3583691120147705
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.030 Vali Acc: 0.220 Test Loss: 6.030 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df256_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 1105749
model size : 4.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.263573169708252
Epoch: 1, Steps: 13 | Train Loss: 1.987 Vali Loss: 1.928 Vali Acc: 0.220 Test Loss: 1.928 Test Acc: 0.220
Validation loss decreased (inf --> -0.219981).  Saving model ...
Epoch: 2 cost time: 1.465012550354004
Epoch: 2, Steps: 13 | Train Loss: 0.231 Vali Loss: 2.645 Vali Acc: 0.180 Test Loss: 2.645 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.363879680633545
Epoch: 3, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.583 Vali Acc: 0.260 Test Loss: 2.583 Test Acc: 0.260
Validation loss decreased (-0.219981 --> -0.259974).  Saving model ...
Epoch: 4 cost time: 1.3271517753601074
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.498 Vali Acc: 0.220 Test Loss: 3.498 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3599522113800049
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.710 Vali Acc: 0.220 Test Loss: 3.710 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3532390594482422
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.668 Vali Acc: 0.240 Test Loss: 3.668 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3481309413909912
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.637 Vali Acc: 0.240 Test Loss: 3.637 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3232390880584717
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.607 Vali Acc: 0.240 Test Loss: 3.607 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2217655181884766
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.585 Vali Acc: 0.240 Test Loss: 3.585 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3478097915649414
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.577 Vali Acc: 0.240 Test Loss: 3.577 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4410998821258545
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.546 Vali Acc: 0.240 Test Loss: 3.546 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2889049053192139
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.553 Vali Acc: 0.240 Test Loss: 3.553 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2489912509918213
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.536 Vali Acc: 0.240 Test Loss: 3.536 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 783173
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.170165300369263
Epoch: 1, Steps: 25 | Train Loss: 10.091 Vali Loss: 20.170 Vali Acc: 0.140 Test Loss: 20.170 Test Acc: 0.140
Validation loss decreased (inf --> -0.139798).  Saving model ...
Epoch: 2 cost time: 4.492549657821655
Epoch: 2, Steps: 25 | Train Loss: 5.398 Vali Loss: 28.668 Vali Acc: 0.200 Test Loss: 28.668 Test Acc: 0.200
Validation loss decreased (-0.139798 --> -0.199713).  Saving model ...
Epoch: 3 cost time: 4.3858253955841064
Epoch: 3, Steps: 25 | Train Loss: 5.997 Vali Loss: 60.103 Vali Acc: 0.200 Test Loss: 60.103 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.421359539031982
Epoch: 4, Steps: 25 | Train Loss: 2.790 Vali Loss: 61.736 Vali Acc: 0.120 Test Loss: 61.736 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.412990570068359
Epoch: 5, Steps: 25 | Train Loss: 1.292 Vali Loss: 58.379 Vali Acc: 0.180 Test Loss: 58.379 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.576504707336426
Epoch: 6, Steps: 25 | Train Loss: 1.639 Vali Loss: 69.755 Vali Acc: 0.200 Test Loss: 69.755 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.405059099197388
Epoch: 7, Steps: 25 | Train Loss: 1.392 Vali Loss: 63.372 Vali Acc: 0.140 Test Loss: 63.372 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.435360670089722
Epoch: 8, Steps: 25 | Train Loss: 1.305 Vali Loss: 76.269 Vali Acc: 0.240 Test Loss: 76.269 Test Acc: 0.240
Validation loss decreased (-0.199713 --> -0.239237).  Saving model ...
Epoch: 9 cost time: 4.369047403335571
Epoch: 9, Steps: 25 | Train Loss: 1.337 Vali Loss: 75.669 Vali Acc: 0.180 Test Loss: 75.669 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.4461469650268555
Epoch: 10, Steps: 25 | Train Loss: 0.047 Vali Loss: 63.286 Vali Acc: 0.240 Test Loss: 63.286 Test Acc: 0.240
Validation loss decreased (-0.239237 --> -0.239367).  Saving model ...
Epoch: 11 cost time: 4.3101487159729
Epoch: 11, Steps: 25 | Train Loss: 0.998 Vali Loss: 72.340 Vali Acc: 0.180 Test Loss: 72.340 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.5373969078063965
Epoch: 12, Steps: 25 | Train Loss: 0.641 Vali Loss: 142.565 Vali Acc: 0.180 Test Loss: 142.565 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.559217929840088
Epoch: 13, Steps: 25 | Train Loss: 0.505 Vali Loss: 101.471 Vali Acc: 0.160 Test Loss: 101.471 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.488681077957153
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 128.149 Vali Acc: 0.180 Test Loss: 128.149 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.340009689331055
Epoch: 15, Steps: 25 | Train Loss: 0.137 Vali Loss: 117.421 Vali Acc: 0.200 Test Loss: 117.421 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.507851839065552
Epoch: 16, Steps: 25 | Train Loss: 0.002 Vali Loss: 87.715 Vali Acc: 0.180 Test Loss: 87.715 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.431642770767212
Epoch: 17, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.482 Vali Acc: 0.260 Test Loss: 91.482 Test Acc: 0.260
Validation loss decreased (-0.239367 --> -0.259085).  Saving model ...
Epoch: 18 cost time: 4.411250829696655
Epoch: 18, Steps: 25 | Train Loss: 0.000 Vali Loss: 92.225 Vali Acc: 0.260 Test Loss: 92.225 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.427288293838501
Epoch: 19, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.960 Vali Acc: 0.260 Test Loss: 91.960 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.407203674316406
Epoch: 20, Steps: 25 | Train Loss: 0.000 Vali Loss: 92.016 Vali Acc: 0.260 Test Loss: 92.016 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.613696575164795
Epoch: 21, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.849 Vali Acc: 0.260 Test Loss: 91.849 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.483625173568726
Epoch: 22, Steps: 25 | Train Loss: 0.000 Vali Loss: 92.350 Vali Acc: 0.260 Test Loss: 92.350 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.46264910697937
Epoch: 23, Steps: 25 | Train Loss: 0.000 Vali Loss: 92.190 Vali Acc: 0.260 Test Loss: 92.190 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.494366645812988
Epoch: 24, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.884 Vali Acc: 0.260 Test Loss: 91.884 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.5884315967559814
Epoch: 25, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.557 Vali Acc: 0.260 Test Loss: 91.557 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.34551477432251
Epoch: 26, Steps: 25 | Train Loss: 0.000 Vali Loss: 92.166 Vali Acc: 0.260 Test Loss: 92.166 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.56187105178833
Epoch: 27, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.954 Vali Acc: 0.260 Test Loss: 91.954 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 7225525
model size : 27.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.312515735626221
Epoch: 1, Steps: 13 | Train Loss: 3.088 Vali Loss: 7.187 Vali Acc: 0.200 Test Loss: 7.187 Test Acc: 0.200
Validation loss decreased (inf --> -0.199928).  Saving model ...
Epoch: 2 cost time: 2.389655828475952
Epoch: 2, Steps: 13 | Train Loss: 0.420 Vali Loss: 9.596 Vali Acc: 0.140 Test Loss: 9.596 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4168741703033447
Epoch: 3, Steps: 13 | Train Loss: 0.212 Vali Loss: 7.762 Vali Acc: 0.220 Test Loss: 7.762 Test Acc: 0.220
Validation loss decreased (-0.199928 --> -0.219922).  Saving model ...
Epoch: 4 cost time: 2.348663330078125
Epoch: 4, Steps: 13 | Train Loss: 0.138 Vali Loss: 20.786 Vali Acc: 0.220 Test Loss: 20.786 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5192248821258545
Epoch: 5, Steps: 13 | Train Loss: 0.052 Vali Loss: 10.549 Vali Acc: 0.200 Test Loss: 10.549 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5285844802856445
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.302 Vali Acc: 0.180 Test Loss: 18.302 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4800243377685547
Epoch: 7, Steps: 13 | Train Loss: 0.420 Vali Loss: 10.444 Vali Acc: 0.260 Test Loss: 10.444 Test Acc: 0.260
Validation loss decreased (-0.219922 --> -0.259896).  Saving model ...
Epoch: 8 cost time: 2.573410749435425
Epoch: 8, Steps: 13 | Train Loss: 1.101 Vali Loss: 19.170 Vali Acc: 0.220 Test Loss: 19.170 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6979076862335205
Epoch: 9, Steps: 13 | Train Loss: 0.705 Vali Loss: 28.249 Vali Acc: 0.200 Test Loss: 28.249 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7053818702697754
Epoch: 10, Steps: 13 | Train Loss: 2.691 Vali Loss: 50.019 Vali Acc: 0.220 Test Loss: 50.019 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.796283721923828
Epoch: 11, Steps: 13 | Train Loss: 4.010 Vali Loss: 34.541 Vali Acc: 0.180 Test Loss: 34.541 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8314173221588135
Epoch: 12, Steps: 13 | Train Loss: 2.374 Vali Loss: 39.876 Vali Acc: 0.220 Test Loss: 39.876 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.0122807025909424
Epoch: 13, Steps: 13 | Train Loss: 1.483 Vali Loss: 35.203 Vali Acc: 0.220 Test Loss: 35.203 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7380199432373047
Epoch: 14, Steps: 13 | Train Loss: 0.228 Vali Loss: 40.894 Vali Acc: 0.060 Test Loss: 40.894 Test Acc: 0.060
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7424869537353516
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 41.313 Vali Acc: 0.140 Test Loss: 41.313 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.622870683670044
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 46.037 Vali Acc: 0.180 Test Loss: 46.037 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.501702308654785
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 47.551 Vali Acc: 0.180 Test Loss: 47.551 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 4105237
model size : 15.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.077486038208008
Epoch: 1, Steps: 13 | Train Loss: 1.883 Vali Loss: 4.486 Vali Acc: 0.180 Test Loss: 4.486 Test Acc: 0.180
Validation loss decreased (inf --> -0.179955).  Saving model ...
Epoch: 2 cost time: 2.053060531616211
Epoch: 2, Steps: 13 | Train Loss: 0.054 Vali Loss: 5.890 Vali Acc: 0.160 Test Loss: 5.890 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.887418270111084
Epoch: 3, Steps: 13 | Train Loss: 0.126 Vali Loss: 13.449 Vali Acc: 0.220 Test Loss: 13.449 Test Acc: 0.220
Validation loss decreased (-0.179955 --> -0.219866).  Saving model ...
Epoch: 4 cost time: 1.9037761688232422
Epoch: 4, Steps: 13 | Train Loss: 0.197 Vali Loss: 12.040 Vali Acc: 0.240 Test Loss: 12.040 Test Acc: 0.240
Validation loss decreased (-0.219866 --> -0.239880).  Saving model ...
Epoch: 5 cost time: 1.9051613807678223
Epoch: 5, Steps: 13 | Train Loss: 0.126 Vali Loss: 14.239 Vali Acc: 0.160 Test Loss: 14.239 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0023112297058105
Epoch: 6, Steps: 13 | Train Loss: 0.269 Vali Loss: 17.508 Vali Acc: 0.200 Test Loss: 17.508 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.867405891418457
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.599 Vali Acc: 0.180 Test Loss: 14.599 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8626477718353271
Epoch: 8, Steps: 13 | Train Loss: 0.047 Vali Loss: 13.224 Vali Acc: 0.220 Test Loss: 13.224 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8303172588348389
Epoch: 9, Steps: 13 | Train Loss: 0.168 Vali Loss: 16.182 Vali Acc: 0.180 Test Loss: 16.182 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7518508434295654
Epoch: 10, Steps: 13 | Train Loss: 1.064 Vali Loss: 32.835 Vali Acc: 0.200 Test Loss: 32.835 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8505825996398926
Epoch: 11, Steps: 13 | Train Loss: 0.390 Vali Loss: 30.786 Vali Acc: 0.200 Test Loss: 30.786 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9453907012939453
Epoch: 12, Steps: 13 | Train Loss: 0.456 Vali Loss: 44.404 Vali Acc: 0.180 Test Loss: 44.404 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9193179607391357
Epoch: 13, Steps: 13 | Train Loss: 0.298 Vali Loss: 32.297 Vali Acc: 0.160 Test Loss: 32.297 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7415413856506348
Epoch: 14, Steps: 13 | Train Loss: 0.641 Vali Loss: 36.720 Vali Acc: 0.160 Test Loss: 36.720 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 2598949
model size : 10.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df128_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3040144443511963
Epoch: 1, Steps: 13 | Train Loss: 2.169 Vali Loss: 3.116 Vali Acc: 0.220 Test Loss: 3.116 Test Acc: 0.220
Validation loss decreased (inf --> -0.219969).  Saving model ...
Epoch: 2 cost time: 1.550321102142334
Epoch: 2, Steps: 13 | Train Loss: 0.192 Vali Loss: 3.704 Vali Acc: 0.140 Test Loss: 3.704 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.606027603149414
Epoch: 3, Steps: 13 | Train Loss: 0.021 Vali Loss: 5.432 Vali Acc: 0.180 Test Loss: 5.432 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8887555599212646
Epoch: 4, Steps: 13 | Train Loss: 0.005 Vali Loss: 7.425 Vali Acc: 0.220 Test Loss: 7.425 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8257205486297607
Epoch: 5, Steps: 13 | Train Loss: 0.045 Vali Loss: 7.692 Vali Acc: 0.220 Test Loss: 7.692 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8243844509124756
Epoch: 6, Steps: 13 | Train Loss: 0.089 Vali Loss: 17.227 Vali Acc: 0.220 Test Loss: 17.227 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9813368320465088
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 10.738 Vali Acc: 0.160 Test Loss: 10.738 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0397088527679443
Epoch: 8, Steps: 13 | Train Loss: 0.120 Vali Loss: 28.863 Vali Acc: 0.220 Test Loss: 28.863 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8752551078796387
Epoch: 9, Steps: 13 | Train Loss: 1.369 Vali Loss: 23.757 Vali Acc: 0.160 Test Loss: 23.757 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6516602039337158
Epoch: 10, Steps: 13 | Train Loss: 0.016 Vali Loss: 16.877 Vali Acc: 0.220 Test Loss: 16.877 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9159021377563477
Epoch: 11, Steps: 13 | Train Loss: 0.228 Vali Loss: 19.329 Vali Acc: 0.180 Test Loss: 19.329 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df128_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 2061045
model size : 8.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1853034496307373
Epoch: 1, Steps: 13 | Train Loss: 1.812 Vali Loss: 1.966 Vali Acc: 0.260 Test Loss: 1.966 Test Acc: 0.260
Validation loss decreased (inf --> -0.259980).  Saving model ...
Epoch: 2 cost time: 1.3612301349639893
Epoch: 2, Steps: 13 | Train Loss: 0.064 Vali Loss: 4.011 Vali Acc: 0.160 Test Loss: 4.011 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3277149200439453
Epoch: 3, Steps: 13 | Train Loss: 0.063 Vali Loss: 4.706 Vali Acc: 0.220 Test Loss: 4.706 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4156177043914795
Epoch: 4, Steps: 13 | Train Loss: 0.001 Vali Loss: 5.055 Vali Acc: 0.180 Test Loss: 5.055 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.387279748916626
Epoch: 5, Steps: 13 | Train Loss: 0.004 Vali Loss: 4.503 Vali Acc: 0.200 Test Loss: 4.503 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3624818325042725
Epoch: 6, Steps: 13 | Train Loss: 0.005 Vali Loss: 6.318 Vali Acc: 0.180 Test Loss: 6.318 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3776609897613525
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.336 Vali Acc: 0.140 Test Loss: 5.336 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3936474323272705
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.686 Vali Acc: 0.140 Test Loss: 5.686 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3736140727996826
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.734 Vali Acc: 0.120 Test Loss: 5.734 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4070773124694824
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.712 Vali Acc: 0.120 Test Loss: 5.712 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6123638153076172
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.729 Vali Acc: 0.140 Test Loss: 5.729 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 1308069
model size : 5.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df128_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4126579761505127
Epoch: 1, Steps: 13 | Train Loss: 2.141 Vali Loss: 2.308 Vali Acc: 0.200 Test Loss: 2.308 Test Acc: 0.200
Validation loss decreased (inf --> -0.199977).  Saving model ...
Epoch: 2 cost time: 1.3957455158233643
Epoch: 2, Steps: 13 | Train Loss: 0.194 Vali Loss: 2.667 Vali Acc: 0.200 Test Loss: 2.667 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3958380222320557
Epoch: 3, Steps: 13 | Train Loss: 0.010 Vali Loss: 3.452 Vali Acc: 0.160 Test Loss: 3.452 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5007860660552979
Epoch: 4, Steps: 13 | Train Loss: 0.005 Vali Loss: 3.921 Vali Acc: 0.140 Test Loss: 3.921 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4161624908447266
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.244 Vali Acc: 0.180 Test Loss: 5.244 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3018412590026855
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.035 Vali Acc: 0.180 Test Loss: 6.035 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.26371169090271
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.224 Vali Acc: 0.180 Test Loss: 5.224 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3252768516540527
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.953 Vali Acc: 0.200 Test Loss: 4.953 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.401740550994873
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.883 Vali Acc: 0.200 Test Loss: 4.883 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2869243621826172
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.824 Vali Acc: 0.220 Test Loss: 4.824 Test Acc: 0.220
Validation loss decreased (-0.199977 --> -0.219952).  Saving model ...
Epoch: 11 cost time: 1.3070058822631836
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.819 Vali Acc: 0.220 Test Loss: 4.819 Test Acc: 0.220
Validation loss decreased (-0.219952 --> -0.219952).  Saving model ...
Epoch: 12 cost time: 1.3853566646575928
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.783 Vali Acc: 0.240 Test Loss: 4.783 Test Acc: 0.240
Validation loss decreased (-0.219952 --> -0.239952).  Saving model ...
Epoch: 13 cost time: 1.2096872329711914
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.753 Vali Acc: 0.240 Test Loss: 4.753 Test Acc: 0.240
Validation loss decreased (-0.239952 --> -0.239952).  Saving model ...
Epoch: 14 cost time: 1.2275927066802979
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.758 Vali Acc: 0.220 Test Loss: 4.758 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4664411544799805
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.750 Vali Acc: 0.240 Test Loss: 4.750 Test Acc: 0.240
Validation loss decreased (-0.239952 --> -0.239953).  Saving model ...
Epoch: 16 cost time: 1.3139123916625977
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.743 Vali Acc: 0.240 Test Loss: 4.743 Test Acc: 0.240
Validation loss decreased (-0.239953 --> -0.239953).  Saving model ...
Epoch: 17 cost time: 1.3516695499420166
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.725 Vali Acc: 0.240 Test Loss: 4.725 Test Acc: 0.240
Validation loss decreased (-0.239953 --> -0.239953).  Saving model ...
Epoch: 18 cost time: 1.2093369960784912
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.725 Vali Acc: 0.240 Test Loss: 4.725 Test Acc: 0.240
Validation loss decreased (-0.239953 --> -0.239953).  Saving model ...
Epoch: 19 cost time: 1.2751104831695557
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.708 Vali Acc: 0.240 Test Loss: 4.708 Test Acc: 0.240
Validation loss decreased (-0.239953 --> -0.239953).  Saving model ...
Epoch: 20 cost time: 1.2664854526519775
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.709 Vali Acc: 0.240 Test Loss: 4.709 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.326674222946167
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.679 Vali Acc: 0.240 Test Loss: 4.679 Test Acc: 0.240
Validation loss decreased (-0.239953 --> -0.239953).  Saving model ...
Epoch: 22 cost time: 1.3171422481536865
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.667 Vali Acc: 0.240 Test Loss: 4.667 Test Acc: 0.240
Validation loss decreased (-0.239953 --> -0.239953).  Saving model ...
Epoch: 23 cost time: 1.2916808128356934
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.665 Vali Acc: 0.240 Test Loss: 4.665 Test Acc: 0.240
Validation loss decreased (-0.239953 --> -0.239953).  Saving model ...
Epoch: 24 cost time: 1.305511474609375
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.657 Vali Acc: 0.240 Test Loss: 4.657 Test Acc: 0.240
Validation loss decreased (-0.239953 --> -0.239953).  Saving model ...
Epoch: 25 cost time: 1.3601365089416504
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.652 Vali Acc: 0.240 Test Loss: 4.652 Test Acc: 0.240
Validation loss decreased (-0.239953 --> -0.239953).  Saving model ...
Epoch: 26 cost time: 1.2820076942443848
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.641 Vali Acc: 0.240 Test Loss: 4.641 Test Acc: 0.240
Validation loss decreased (-0.239953 --> -0.239954).  Saving model ...
Epoch: 27 cost time: 1.4311885833740234
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.643 Vali Acc: 0.240 Test Loss: 4.643 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6009957790374756
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.641 Vali Acc: 0.240 Test Loss: 4.641 Test Acc: 0.240
Validation loss decreased (-0.239954 --> -0.239954).  Saving model ...
Epoch: 29 cost time: 1.4653708934783936
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.615 Vali Acc: 0.240 Test Loss: 4.615 Test Acc: 0.240
Validation loss decreased (-0.239954 --> -0.239954).  Saving model ...
Epoch: 30 cost time: 1.3837692737579346
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.606 Vali Acc: 0.240 Test Loss: 4.606 Test Acc: 0.240
Validation loss decreased (-0.239954 --> -0.239954).  Saving model ...
Epoch: 31 cost time: 1.310133934020996
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.617 Vali Acc: 0.240 Test Loss: 4.617 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3803198337554932
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.627 Vali Acc: 0.240 Test Loss: 4.627 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.389808177947998
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.620 Vali Acc: 0.260 Test Loss: 4.620 Test Acc: 0.260
Validation loss decreased (-0.239954 --> -0.259954).  Saving model ...
Epoch: 34 cost time: 1.3411548137664795
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.618 Vali Acc: 0.240 Test Loss: 4.618 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3571012020111084
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.615 Vali Acc: 0.240 Test Loss: 4.615 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.442868709564209
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.616 Vali Acc: 0.240 Test Loss: 4.616 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3902404308319092
Epoch: 37, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.596 Vali Acc: 0.240 Test Loss: 4.596 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2810249328613281
Epoch: 38, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.585 Vali Acc: 0.260 Test Loss: 4.585 Test Acc: 0.260
Validation loss decreased (-0.259954 --> -0.259954).  Saving model ...
Epoch: 39 cost time: 1.2475330829620361
Epoch: 39, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.583 Vali Acc: 0.260 Test Loss: 4.583 Test Acc: 0.260
Validation loss decreased (-0.259954 --> -0.259954).  Saving model ...
Epoch: 40 cost time: 1.3573486804962158
Epoch: 40, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.570 Vali Acc: 0.260 Test Loss: 4.570 Test Acc: 0.260
Validation loss decreased (-0.259954 --> -0.259954).  Saving model ...
Epoch: 41 cost time: 1.367703914642334
Epoch: 41, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.551 Vali Acc: 0.240 Test Loss: 4.551 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4259154796600342
Epoch: 42, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.560 Vali Acc: 0.240 Test Loss: 4.560 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.4248638153076172
Epoch: 43, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.550 Vali Acc: 0.240 Test Loss: 4.550 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2353804111480713
Epoch: 44, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.553 Vali Acc: 0.240 Test Loss: 4.553 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.311429738998413
Epoch: 45, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.548 Vali Acc: 0.240 Test Loss: 4.548 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.5729596614837646
Epoch: 46, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.548 Vali Acc: 0.240 Test Loss: 4.548 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3724467754364014
Epoch: 47, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.567 Vali Acc: 0.240 Test Loss: 4.567 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.4283103942871094
Epoch: 48, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.538 Vali Acc: 0.240 Test Loss: 4.538 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.314823865890503
Epoch: 49, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.538 Vali Acc: 0.240 Test Loss: 4.538 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.3835992813110352
Epoch: 50, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.523 Vali Acc: 0.240 Test Loss: 4.523 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df128_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 1093077
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1381993293762207
Epoch: 1, Steps: 13 | Train Loss: 1.987 Vali Loss: 1.668 Vali Acc: 0.220 Test Loss: 1.668 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.1179835796356201
Epoch: 2, Steps: 13 | Train Loss: 0.142 Vali Loss: 2.247 Vali Acc: 0.200 Test Loss: 2.247 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2036669254302979
Epoch: 3, Steps: 13 | Train Loss: 0.004 Vali Loss: 3.183 Vali Acc: 0.160 Test Loss: 3.183 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2156000137329102
Epoch: 4, Steps: 13 | Train Loss: 0.001 Vali Loss: 3.723 Vali Acc: 0.220 Test Loss: 3.723 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2308986186981201
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.598 Vali Acc: 0.220 Test Loss: 3.598 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1224756240844727
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.598 Vali Acc: 0.200 Test Loss: 3.598 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2493855953216553
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.601 Vali Acc: 0.220 Test Loss: 3.601 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2542681694030762
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.589 Vali Acc: 0.220 Test Loss: 3.589 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1566011905670166
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.586 Vali Acc: 0.220 Test Loss: 3.586 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.454627513885498
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.586 Vali Acc: 0.240 Test Loss: 3.586 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239964).  Saving model ...
Epoch: 11 cost time: 1.1035630702972412
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.571 Vali Acc: 0.220 Test Loss: 3.571 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1048190593719482
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.551 Vali Acc: 0.240 Test Loss: 3.551 Test Acc: 0.240
Validation loss decreased (-0.239964 --> -0.239964).  Saving model ...
Epoch: 13 cost time: 1.1860136985778809
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.546 Vali Acc: 0.260 Test Loss: 3.546 Test Acc: 0.260
Validation loss decreased (-0.239964 --> -0.259965).  Saving model ...
Epoch: 14 cost time: 1.140270471572876
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.537 Vali Acc: 0.240 Test Loss: 3.537 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1836223602294922
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.525 Vali Acc: 0.220 Test Loss: 3.525 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0529048442840576
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.519 Vali Acc: 0.220 Test Loss: 3.519 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2997562885284424
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.520 Vali Acc: 0.240 Test Loss: 3.520 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2749223709106445
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.513 Vali Acc: 0.240 Test Loss: 3.513 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.245100975036621
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.523 Vali Acc: 0.220 Test Loss: 3.523 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2756056785583496
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.510 Vali Acc: 0.240 Test Loss: 3.510 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1489644050598145
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.500 Vali Acc: 0.240 Test Loss: 3.500 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2317826747894287
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.497 Vali Acc: 0.240 Test Loss: 3.497 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1578919887542725
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.501 Vali Acc: 0.240 Test Loss: 3.501 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 770501
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.711761713027954
Epoch: 1, Steps: 25 | Train Loss: 13.457 Vali Loss: 22.306 Vali Acc: 0.220 Test Loss: 22.306 Test Acc: 0.220
Validation loss decreased (inf --> -0.219777).  Saving model ...
Epoch: 2 cost time: 3.840399742126465
Epoch: 2, Steps: 25 | Train Loss: 2.264 Vali Loss: 26.573 Vali Acc: 0.180 Test Loss: 26.573 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8934249877929688
Epoch: 3, Steps: 25 | Train Loss: 1.197 Vali Loss: 39.047 Vali Acc: 0.180 Test Loss: 39.047 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.826803684234619
Epoch: 4, Steps: 25 | Train Loss: 11.005 Vali Loss: 46.088 Vali Acc: 0.180 Test Loss: 46.088 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.9302902221679688
Epoch: 5, Steps: 25 | Train Loss: 3.192 Vali Loss: 28.689 Vali Acc: 0.180 Test Loss: 28.689 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.8765363693237305
Epoch: 6, Steps: 25 | Train Loss: 6.200 Vali Loss: 51.722 Vali Acc: 0.180 Test Loss: 51.722 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.923722982406616
Epoch: 7, Steps: 25 | Train Loss: 1.308 Vali Loss: 60.929 Vali Acc: 0.180 Test Loss: 60.929 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.9887986183166504
Epoch: 8, Steps: 25 | Train Loss: 2.823 Vali Loss: 57.585 Vali Acc: 0.200 Test Loss: 57.585 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.001143932342529
Epoch: 9, Steps: 25 | Train Loss: 2.353 Vali Loss: 86.365 Vali Acc: 0.180 Test Loss: 86.365 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.9841721057891846
Epoch: 10, Steps: 25 | Train Loss: 1.829 Vali Loss: 208.864 Vali Acc: 0.200 Test Loss: 208.864 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.163783311843872
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 160.541 Vali Acc: 0.120 Test Loss: 160.541 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 7219189
model size : 27.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8214802742004395
Epoch: 1, Steps: 13 | Train Loss: 2.504 Vali Loss: 5.513 Vali Acc: 0.240 Test Loss: 5.513 Test Acc: 0.240
Validation loss decreased (inf --> -0.239945).  Saving model ...
Epoch: 2 cost time: 2.06730318069458
Epoch: 2, Steps: 13 | Train Loss: 1.628 Vali Loss: 14.682 Vali Acc: 0.200 Test Loss: 14.682 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0579450130462646
Epoch: 3, Steps: 13 | Train Loss: 0.338 Vali Loss: 18.027 Vali Acc: 0.220 Test Loss: 18.027 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1489455699920654
Epoch: 4, Steps: 13 | Train Loss: 0.210 Vali Loss: 19.610 Vali Acc: 0.200 Test Loss: 19.610 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0678322315216064
Epoch: 5, Steps: 13 | Train Loss: 0.395 Vali Loss: 19.163 Vali Acc: 0.200 Test Loss: 19.163 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2555534839630127
Epoch: 6, Steps: 13 | Train Loss: 0.095 Vali Loss: 15.720 Vali Acc: 0.220 Test Loss: 15.720 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.2864010334014893
Epoch: 7, Steps: 13 | Train Loss: 2.914 Vali Loss: 33.653 Vali Acc: 0.220 Test Loss: 33.653 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0813896656036377
Epoch: 8, Steps: 13 | Train Loss: 2.565 Vali Loss: 48.945 Vali Acc: 0.220 Test Loss: 48.945 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1703996658325195
Epoch: 9, Steps: 13 | Train Loss: 7.229 Vali Loss: 41.530 Vali Acc: 0.200 Test Loss: 41.530 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.29872727394104
Epoch: 10, Steps: 13 | Train Loss: 2.945 Vali Loss: 45.455 Vali Acc: 0.120 Test Loss: 45.455 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.160029888153076
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 31.123 Vali Acc: 0.300 Test Loss: 31.123 Test Acc: 0.300
Validation loss decreased (-0.239945 --> -0.299689).  Saving model ...
Epoch: 12 cost time: 2.186173677444458
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 38.318 Vali Acc: 0.220 Test Loss: 38.318 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.238260269165039
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 43.521 Vali Acc: 0.200 Test Loss: 43.521 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.332789659500122
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 45.213 Vali Acc: 0.200 Test Loss: 45.213 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4682776927948
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 45.825 Vali Acc: 0.200 Test Loss: 45.825 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2054390907287598
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 45.933 Vali Acc: 0.200 Test Loss: 45.933 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.316689968109131
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 45.758 Vali Acc: 0.200 Test Loss: 45.758 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.212594747543335
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 45.856 Vali Acc: 0.200 Test Loss: 45.856 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.374533176422119
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 45.941 Vali Acc: 0.200 Test Loss: 45.941 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.35089373588562
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 45.692 Vali Acc: 0.200 Test Loss: 45.692 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2489209175109863
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 45.929 Vali Acc: 0.200 Test Loss: 45.929 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 4098901
model size : 15.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.384732484817505
Epoch: 1, Steps: 13 | Train Loss: 2.201 Vali Loss: 4.498 Vali Acc: 0.200 Test Loss: 4.498 Test Acc: 0.200
Validation loss decreased (inf --> -0.199955).  Saving model ...
Epoch: 2 cost time: 1.629000186920166
Epoch: 2, Steps: 13 | Train Loss: 0.116 Vali Loss: 7.217 Vali Acc: 0.200 Test Loss: 7.217 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8664875030517578
Epoch: 3, Steps: 13 | Train Loss: 0.036 Vali Loss: 6.806 Vali Acc: 0.140 Test Loss: 6.806 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8283381462097168
Epoch: 4, Steps: 13 | Train Loss: 0.166 Vali Loss: 7.717 Vali Acc: 0.140 Test Loss: 7.717 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7105011940002441
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.092 Vali Acc: 0.160 Test Loss: 8.092 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8575096130371094
Epoch: 6, Steps: 13 | Train Loss: 0.002 Vali Loss: 12.891 Vali Acc: 0.180 Test Loss: 12.891 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8109972476959229
Epoch: 7, Steps: 13 | Train Loss: 0.609 Vali Loss: 14.087 Vali Acc: 0.160 Test Loss: 14.087 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7632858753204346
Epoch: 8, Steps: 13 | Train Loss: 1.075 Vali Loss: 18.844 Vali Acc: 0.120 Test Loss: 18.844 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7289204597473145
Epoch: 9, Steps: 13 | Train Loss: 1.010 Vali Loss: 14.310 Vali Acc: 0.160 Test Loss: 14.310 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6671981811523438
Epoch: 10, Steps: 13 | Train Loss: 4.633 Vali Loss: 36.464 Vali Acc: 0.160 Test Loss: 36.464 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7894728183746338
Epoch: 11, Steps: 13 | Train Loss: 0.714 Vali Loss: 18.974 Vali Acc: 0.180 Test Loss: 18.974 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 2592613
model size : 10.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df64_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4191861152648926
Epoch: 1, Steps: 13 | Train Loss: 2.621 Vali Loss: 3.562 Vali Acc: 0.220 Test Loss: 3.562 Test Acc: 0.220
Validation loss decreased (inf --> -0.219964).  Saving model ...
Epoch: 2 cost time: 1.5634326934814453
Epoch: 2, Steps: 13 | Train Loss: 0.099 Vali Loss: 3.718 Vali Acc: 0.120 Test Loss: 3.718 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3650832176208496
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.183 Vali Acc: 0.160 Test Loss: 6.183 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4548070430755615
Epoch: 4, Steps: 13 | Train Loss: 0.004 Vali Loss: 6.891 Vali Acc: 0.120 Test Loss: 6.891 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4397213459014893
Epoch: 5, Steps: 13 | Train Loss: 0.001 Vali Loss: 5.828 Vali Acc: 0.120 Test Loss: 5.828 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5888054370880127
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.524 Vali Acc: 0.200 Test Loss: 7.524 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4739620685577393
Epoch: 7, Steps: 13 | Train Loss: 0.067 Vali Loss: 8.553 Vali Acc: 0.140 Test Loss: 8.553 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5106189250946045
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.712 Vali Acc: 0.120 Test Loss: 8.712 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5512793064117432
Epoch: 9, Steps: 13 | Train Loss: 0.096 Vali Loss: 15.692 Vali Acc: 0.180 Test Loss: 15.692 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6589841842651367
Epoch: 10, Steps: 13 | Train Loss: 1.206 Vali Loss: 19.598 Vali Acc: 0.220 Test Loss: 19.598 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4417898654937744
Epoch: 11, Steps: 13 | Train Loss: 2.752 Vali Loss: 15.812 Vali Acc: 0.200 Test Loss: 15.812 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df64_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 2054709
model size : 8.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0406856536865234
Epoch: 1, Steps: 13 | Train Loss: 1.920 Vali Loss: 2.971 Vali Acc: 0.200 Test Loss: 2.971 Test Acc: 0.200
Validation loss decreased (inf --> -0.199970).  Saving model ...
Epoch: 2 cost time: 1.2971875667572021
Epoch: 2, Steps: 13 | Train Loss: 0.070 Vali Loss: 3.187 Vali Acc: 0.240 Test Loss: 3.187 Test Acc: 0.240
Validation loss decreased (-0.199970 --> -0.239968).  Saving model ...
Epoch: 3 cost time: 1.290968656539917
Epoch: 3, Steps: 13 | Train Loss: 0.020 Vali Loss: 4.060 Vali Acc: 0.140 Test Loss: 4.060 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4631924629211426
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.319 Vali Acc: 0.220 Test Loss: 5.319 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2958698272705078
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.395 Vali Acc: 0.240 Test Loss: 5.395 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4483144283294678
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.284 Vali Acc: 0.220 Test Loss: 5.284 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2928144931793213
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.244 Vali Acc: 0.220 Test Loss: 5.244 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2976300716400146
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.222 Vali Acc: 0.220 Test Loss: 5.222 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2365648746490479
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.197 Vali Acc: 0.220 Test Loss: 5.197 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3460018634796143
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.177 Vali Acc: 0.220 Test Loss: 5.177 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2020483016967773
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.160 Vali Acc: 0.220 Test Loss: 5.160 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1777770519256592
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.131 Vali Acc: 0.220 Test Loss: 5.131 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 1301733
model size : 5.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df64_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.880821704864502
Epoch: 1, Steps: 13 | Train Loss: 1.887 Vali Loss: 1.955 Vali Acc: 0.180 Test Loss: 1.955 Test Acc: 0.180
Validation loss decreased (inf --> -0.179980).  Saving model ...
Epoch: 2 cost time: 1.1328210830688477
Epoch: 2, Steps: 13 | Train Loss: 0.213 Vali Loss: 3.468 Vali Acc: 0.220 Test Loss: 3.468 Test Acc: 0.220
Validation loss decreased (-0.179980 --> -0.219965).  Saving model ...
Epoch: 3 cost time: 1.2215821743011475
Epoch: 3, Steps: 13 | Train Loss: 0.011 Vali Loss: 4.072 Vali Acc: 0.140 Test Loss: 4.072 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.267390251159668
Epoch: 4, Steps: 13 | Train Loss: 0.007 Vali Loss: 4.154 Vali Acc: 0.220 Test Loss: 4.154 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5153563022613525
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.528 Vali Acc: 0.140 Test Loss: 5.528 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2282843589782715
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.583 Vali Acc: 0.240 Test Loss: 4.583 Test Acc: 0.240
Validation loss decreased (-0.219965 --> -0.239954).  Saving model ...
Epoch: 7 cost time: 1.2854630947113037
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.382 Vali Acc: 0.220 Test Loss: 4.382 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3088936805725098
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.295 Vali Acc: 0.220 Test Loss: 4.295 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2862341403961182
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.292 Vali Acc: 0.220 Test Loss: 4.292 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2932789325714111
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.281 Vali Acc: 0.220 Test Loss: 4.281 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4424853324890137
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.265 Vali Acc: 0.220 Test Loss: 4.265 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.342592716217041
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.246 Vali Acc: 0.220 Test Loss: 4.246 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2945139408111572
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.234 Vali Acc: 0.220 Test Loss: 4.234 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2886261940002441
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.234 Vali Acc: 0.220 Test Loss: 4.234 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2067575454711914
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.225 Vali Acc: 0.220 Test Loss: 4.225 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.226179838180542
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.221 Vali Acc: 0.220 Test Loss: 4.221 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df64_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 1086741
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7242677211761475
Epoch: 1, Steps: 13 | Train Loss: 1.766 Vali Loss: 1.819 Vali Acc: 0.160 Test Loss: 1.819 Test Acc: 0.160
Validation loss decreased (inf --> -0.159982).  Saving model ...
Epoch: 2 cost time: 1.2571187019348145
Epoch: 2, Steps: 13 | Train Loss: 0.120 Vali Loss: 2.542 Vali Acc: 0.180 Test Loss: 2.542 Test Acc: 0.180
Validation loss decreased (-0.159982 --> -0.179975).  Saving model ...
Epoch: 3 cost time: 1.122725248336792
Epoch: 3, Steps: 13 | Train Loss: 0.010 Vali Loss: 3.310 Vali Acc: 0.160 Test Loss: 3.310 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3544557094573975
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.497 Vali Acc: 0.240 Test Loss: 3.497 Test Acc: 0.240
Validation loss decreased (-0.179975 --> -0.239965).  Saving model ...
Epoch: 5 cost time: 1.203406810760498
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.304 Vali Acc: 0.220 Test Loss: 3.304 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2976608276367188
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.302 Vali Acc: 0.280 Test Loss: 3.302 Test Acc: 0.280
Validation loss decreased (-0.239965 --> -0.279967).  Saving model ...
Epoch: 7 cost time: 1.408496379852295
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.261 Vali Acc: 0.280 Test Loss: 3.261 Test Acc: 0.280
Validation loss decreased (-0.279967 --> -0.279967).  Saving model ...
Epoch: 8 cost time: 1.1961326599121094
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.241 Vali Acc: 0.280 Test Loss: 3.241 Test Acc: 0.280
Validation loss decreased (-0.279967 --> -0.279968).  Saving model ...
Epoch: 9 cost time: 1.294341802597046
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.226 Vali Acc: 0.260 Test Loss: 3.226 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.347482681274414
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.224 Vali Acc: 0.260 Test Loss: 3.224 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.577183485031128
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.218 Vali Acc: 0.260 Test Loss: 3.218 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4721081256866455
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.217 Vali Acc: 0.260 Test Loss: 3.217 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2523744106292725
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.224 Vali Acc: 0.260 Test Loss: 3.224 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.419442892074585
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.218 Vali Acc: 0.260 Test Loss: 3.218 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.340080738067627
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.206 Vali Acc: 0.260 Test Loss: 3.206 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3569657802581787
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.209 Vali Acc: 0.260 Test Loss: 3.209 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.296769618988037
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.203 Vali Acc: 0.260 Test Loss: 3.203 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2806899547576904
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.210 Vali Acc: 0.260 Test Loss: 3.210 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el3_dm16_nh4_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 764165
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 13.401590347290039
Epoch: 1, Steps: 25 | Train Loss: 69.416 Vali Loss: 112.465 Vali Acc: 0.180 Test Loss: 112.465 Test Acc: 0.180
Validation loss decreased (inf --> -0.178875).  Saving model ...
Epoch: 2 cost time: 12.024360418319702
Epoch: 2, Steps: 25 | Train Loss: 33.697 Vali Loss: 223.668 Vali Acc: 0.160 Test Loss: 223.668 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.253838777542114
Epoch: 3, Steps: 25 | Train Loss: 13.598 Vali Loss: 305.969 Vali Acc: 0.220 Test Loss: 305.969 Test Acc: 0.220
Validation loss decreased (-0.178875 --> -0.216940).  Saving model ...
Epoch: 4 cost time: 12.22968578338623
Epoch: 4, Steps: 25 | Train Loss: 23.944 Vali Loss: 330.197 Vali Acc: 0.220 Test Loss: 330.197 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.277077198028564
Epoch: 5, Steps: 25 | Train Loss: 6.350 Vali Loss: 412.787 Vali Acc: 0.220 Test Loss: 412.787 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.306261539459229
Epoch: 6, Steps: 25 | Train Loss: 10.857 Vali Loss: 465.093 Vali Acc: 0.140 Test Loss: 465.093 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.491437196731567
Epoch: 7, Steps: 25 | Train Loss: 5.443 Vali Loss: 328.652 Vali Acc: 0.180 Test Loss: 328.652 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.18234634399414
Epoch: 8, Steps: 25 | Train Loss: 5.708 Vali Loss: 303.880 Vali Acc: 0.240 Test Loss: 303.880 Test Acc: 0.240
Validation loss decreased (-0.216940 --> -0.236961).  Saving model ...
Epoch: 9 cost time: 12.193934917449951
Epoch: 9, Steps: 25 | Train Loss: 0.000 Vali Loss: 361.785 Vali Acc: 0.220 Test Loss: 361.785 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.399643421173096
Epoch: 10, Steps: 25 | Train Loss: 0.000 Vali Loss: 367.306 Vali Acc: 0.220 Test Loss: 367.306 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.454569578170776
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 367.979 Vali Acc: 0.220 Test Loss: 367.979 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 12.544729709625244
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 367.985 Vali Acc: 0.220 Test Loss: 367.985 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 12.435139417648315
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 368.738 Vali Acc: 0.220 Test Loss: 368.738 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 12.555519819259644
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 369.278 Vali Acc: 0.220 Test Loss: 369.278 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 12.665735483169556
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 369.409 Vali Acc: 0.220 Test Loss: 369.409 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 12.630379676818848
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 369.835 Vali Acc: 0.220 Test Loss: 369.835 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 12.728270769119263
Epoch: 17, Steps: 25 | Train Loss: 0.000 Vali Loss: 367.023 Vali Acc: 0.220 Test Loss: 367.023 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 12.671833992004395
Epoch: 18, Steps: 25 | Train Loss: 0.000 Vali Loss: 367.468 Vali Acc: 0.220 Test Loss: 367.468 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 57939717
model size : 223.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.8974363803863525
Epoch: 1, Steps: 13 | Train Loss: 15.707 Vali Loss: 58.583 Vali Acc: 0.220 Test Loss: 58.583 Test Acc: 0.220
Validation loss decreased (inf --> -0.219414).  Saving model ...
Epoch: 2 cost time: 6.223222017288208
Epoch: 2, Steps: 13 | Train Loss: 8.836 Vali Loss: 103.192 Vali Acc: 0.140 Test Loss: 103.192 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.396142244338989
Epoch: 3, Steps: 13 | Train Loss: 1.526 Vali Loss: 122.538 Vali Acc: 0.160 Test Loss: 122.538 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.208222150802612
Epoch: 4, Steps: 13 | Train Loss: 0.733 Vali Loss: 109.591 Vali Acc: 0.200 Test Loss: 109.591 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.3445799350738525
Epoch: 5, Steps: 13 | Train Loss: 3.524 Vali Loss: 158.108 Vali Acc: 0.240 Test Loss: 158.108 Test Acc: 0.240
Validation loss decreased (-0.219414 --> -0.238419).  Saving model ...
Epoch: 6 cost time: 6.489874839782715
Epoch: 6, Steps: 13 | Train Loss: 7.562 Vali Loss: 180.058 Vali Acc: 0.260 Test Loss: 180.058 Test Acc: 0.260
Validation loss decreased (-0.238419 --> -0.258199).  Saving model ...
Epoch: 7 cost time: 6.488182783126831
Epoch: 7, Steps: 13 | Train Loss: 19.530 Vali Loss: 196.227 Vali Acc: 0.200 Test Loss: 196.227 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.594702243804932
Epoch: 8, Steps: 13 | Train Loss: 3.228 Vali Loss: 146.889 Vali Acc: 0.180 Test Loss: 146.889 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.672759771347046
Epoch: 9, Steps: 13 | Train Loss: 7.204 Vali Loss: 165.387 Vali Acc: 0.120 Test Loss: 165.387 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.518662929534912
Epoch: 10, Steps: 13 | Train Loss: 0.892 Vali Loss: 175.375 Vali Acc: 0.120 Test Loss: 175.375 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.527419805526733
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 203.126 Vali Acc: 0.140 Test Loss: 203.126 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.388732194900513
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 213.011 Vali Acc: 0.140 Test Loss: 213.011 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.5310046672821045
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 215.612 Vali Acc: 0.140 Test Loss: 215.612 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.512359619140625
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 211.970 Vali Acc: 0.140 Test Loss: 211.970 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.552890777587891
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 210.602 Vali Acc: 0.140 Test Loss: 210.602 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.581235647201538
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 210.152 Vali Acc: 0.140 Test Loss: 210.152 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 32977413
model size : 128.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.951015472412109
Epoch: 1, Steps: 13 | Train Loss: 6.390 Vali Loss: 12.569 Vali Acc: 0.120 Test Loss: 12.569 Test Acc: 0.120
Validation loss decreased (inf --> -0.119874).  Saving model ...
Epoch: 2 cost time: 3.1162784099578857
Epoch: 2, Steps: 13 | Train Loss: 1.306 Vali Loss: 46.856 Vali Acc: 0.100 Test Loss: 46.856 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2919676303863525
Epoch: 3, Steps: 13 | Train Loss: 0.531 Vali Loss: 64.628 Vali Acc: 0.140 Test Loss: 64.628 Test Acc: 0.140
Validation loss decreased (-0.119874 --> -0.139354).  Saving model ...
Epoch: 4 cost time: 3.2853262424468994
Epoch: 4, Steps: 13 | Train Loss: 3.891 Vali Loss: 115.047 Vali Acc: 0.180 Test Loss: 115.047 Test Acc: 0.180
Validation loss decreased (-0.139354 --> -0.178850).  Saving model ...
Epoch: 5 cost time: 3.1874709129333496
Epoch: 5, Steps: 13 | Train Loss: 1.916 Vali Loss: 84.567 Vali Acc: 0.200 Test Loss: 84.567 Test Acc: 0.200
Validation loss decreased (-0.178850 --> -0.199154).  Saving model ...
Epoch: 6 cost time: 3.3811333179473877
Epoch: 6, Steps: 13 | Train Loss: 5.102 Vali Loss: 98.448 Vali Acc: 0.160 Test Loss: 98.448 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3146607875823975
Epoch: 7, Steps: 13 | Train Loss: 6.614 Vali Loss: 127.367 Vali Acc: 0.220 Test Loss: 127.367 Test Acc: 0.220
Validation loss decreased (-0.199154 --> -0.218726).  Saving model ...
Epoch: 8 cost time: 3.222249746322632
Epoch: 8, Steps: 13 | Train Loss: 4.942 Vali Loss: 85.704 Vali Acc: 0.200 Test Loss: 85.704 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2883458137512207
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 109.143 Vali Acc: 0.120 Test Loss: 109.143 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3579018115997314
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 125.703 Vali Acc: 0.100 Test Loss: 125.703 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.350883960723877
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 131.724 Vali Acc: 0.100 Test Loss: 131.724 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.4146242141723633
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 133.958 Vali Acc: 0.120 Test Loss: 133.958 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.3544137477874756
Epoch: 13, Steps: 13 | Train Loss: 0.779 Vali Loss: 129.274 Vali Acc: 0.180 Test Loss: 129.274 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.3221001625061035
Epoch: 14, Steps: 13 | Train Loss: 0.553 Vali Loss: 110.982 Vali Acc: 0.100 Test Loss: 110.982 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.3372836112976074
Epoch: 15, Steps: 13 | Train Loss: 1.904 Vali Loss: 149.584 Vali Acc: 0.160 Test Loss: 149.584 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.2384848594665527
Epoch: 16, Steps: 13 | Train Loss: 1.175 Vali Loss: 159.674 Vali Acc: 0.160 Test Loss: 159.674 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.348773956298828
Epoch: 17, Steps: 13 | Train Loss: 0.565 Vali Loss: 172.711 Vali Acc: 0.160 Test Loss: 172.711 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 20927109
model size : 82.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df256_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.882935285568237
Epoch: 1, Steps: 13 | Train Loss: 9.173 Vali Loss: 13.190 Vali Acc: 0.200 Test Loss: 13.190 Test Acc: 0.200
Validation loss decreased (inf --> -0.199868).  Saving model ...
Epoch: 2 cost time: 2.8479342460632324
Epoch: 2, Steps: 13 | Train Loss: 1.547 Vali Loss: 35.662 Vali Acc: 0.180 Test Loss: 35.662 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9252946376800537
Epoch: 3, Steps: 13 | Train Loss: 0.856 Vali Loss: 32.686 Vali Acc: 0.200 Test Loss: 32.686 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.883354902267456
Epoch: 4, Steps: 13 | Train Loss: 0.204 Vali Loss: 63.815 Vali Acc: 0.180 Test Loss: 63.815 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.855837345123291
Epoch: 5, Steps: 13 | Train Loss: 0.171 Vali Loss: 71.692 Vali Acc: 0.240 Test Loss: 71.692 Test Acc: 0.240
Validation loss decreased (-0.199868 --> -0.239283).  Saving model ...
Epoch: 6 cost time: 2.7187390327453613
Epoch: 6, Steps: 13 | Train Loss: 0.037 Vali Loss: 102.781 Vali Acc: 0.140 Test Loss: 102.781 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8121654987335205
Epoch: 7, Steps: 13 | Train Loss: 4.287 Vali Loss: 85.073 Vali Acc: 0.220 Test Loss: 85.073 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8419041633605957
Epoch: 8, Steps: 13 | Train Loss: 3.590 Vali Loss: 91.416 Vali Acc: 0.160 Test Loss: 91.416 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8615562915802
Epoch: 9, Steps: 13 | Train Loss: 1.815 Vali Loss: 107.563 Vali Acc: 0.180 Test Loss: 107.563 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.784911870956421
Epoch: 10, Steps: 13 | Train Loss: 0.362 Vali Loss: 188.779 Vali Acc: 0.220 Test Loss: 188.779 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.730044364929199
Epoch: 11, Steps: 13 | Train Loss: 0.485 Vali Loss: 174.899 Vali Acc: 0.240 Test Loss: 174.899 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.124101161956787
Epoch: 12, Steps: 13 | Train Loss: 0.765 Vali Loss: 173.732 Vali Acc: 0.200 Test Loss: 173.732 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.955129861831665
Epoch: 13, Steps: 13 | Train Loss: 5.357 Vali Loss: 159.825 Vali Acc: 0.280 Test Loss: 159.825 Test Acc: 0.280
Validation loss decreased (-0.239283 --> -0.278402).  Saving model ...
Epoch: 14 cost time: 2.8384742736816406
Epoch: 14, Steps: 13 | Train Loss: 1.657 Vali Loss: 192.539 Vali Acc: 0.160 Test Loss: 192.539 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.905275821685791
Epoch: 15, Steps: 13 | Train Loss: 0.986 Vali Loss: 212.182 Vali Acc: 0.220 Test Loss: 212.182 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.861544132232666
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 193.696 Vali Acc: 0.180 Test Loss: 193.696 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.7852227687835693
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 185.034 Vali Acc: 0.180 Test Loss: 185.034 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.78393816947937
Epoch: 18, Steps: 13 | Train Loss: 0.003 Vali Loss: 180.921 Vali Acc: 0.160 Test Loss: 180.921 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.9333951473236084
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 178.178 Vali Acc: 0.160 Test Loss: 178.178 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.097513437271118
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 176.970 Vali Acc: 0.160 Test Loss: 176.970 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.8668909072875977
Epoch: 21, Steps: 13 | Train Loss: 0.072 Vali Loss: 165.187 Vali Acc: 0.140 Test Loss: 165.187 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.8442375659942627
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 175.368 Vali Acc: 0.200 Test Loss: 175.368 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.8174686431884766
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 187.988 Vali Acc: 0.200 Test Loss: 187.988 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df256_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 16623877
model size : 65.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.871262788772583
Epoch: 1, Steps: 13 | Train Loss: 4.472 Vali Loss: 10.756 Vali Acc: 0.160 Test Loss: 10.756 Test Acc: 0.160
Validation loss decreased (inf --> -0.159892).  Saving model ...
Epoch: 2 cost time: 2.192215919494629
Epoch: 2, Steps: 13 | Train Loss: 0.770 Vali Loss: 15.135 Vali Acc: 0.180 Test Loss: 15.135 Test Acc: 0.180
Validation loss decreased (-0.159892 --> -0.179849).  Saving model ...
Epoch: 3 cost time: 2.0872366428375244
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 34.954 Vali Acc: 0.180 Test Loss: 34.954 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1380774974823
Epoch: 4, Steps: 13 | Train Loss: 0.049 Vali Loss: 41.600 Vali Acc: 0.220 Test Loss: 41.600 Test Acc: 0.220
Validation loss decreased (-0.179849 --> -0.219584).  Saving model ...
Epoch: 5 cost time: 2.151965856552124
Epoch: 5, Steps: 13 | Train Loss: 0.132 Vali Loss: 35.830 Vali Acc: 0.180 Test Loss: 35.830 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2070465087890625
Epoch: 6, Steps: 13 | Train Loss: 0.350 Vali Loss: 73.926 Vali Acc: 0.240 Test Loss: 73.926 Test Acc: 0.240
Validation loss decreased (-0.219584 --> -0.239261).  Saving model ...
Epoch: 7 cost time: 2.190639019012451
Epoch: 7, Steps: 13 | Train Loss: 3.634 Vali Loss: 63.135 Vali Acc: 0.220 Test Loss: 63.135 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0997135639190674
Epoch: 8, Steps: 13 | Train Loss: 1.713 Vali Loss: 58.798 Vali Acc: 0.200 Test Loss: 58.798 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.127093553543091
Epoch: 9, Steps: 13 | Train Loss: 0.742 Vali Loss: 66.064 Vali Acc: 0.260 Test Loss: 66.064 Test Acc: 0.260
Validation loss decreased (-0.239261 --> -0.259339).  Saving model ...
Epoch: 10 cost time: 2.2145960330963135
Epoch: 10, Steps: 13 | Train Loss: 0.385 Vali Loss: 82.289 Vali Acc: 0.160 Test Loss: 82.289 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.162670135498047
Epoch: 11, Steps: 13 | Train Loss: 2.416 Vali Loss: 86.310 Vali Acc: 0.180 Test Loss: 86.310 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0507562160491943
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 90.625 Vali Acc: 0.160 Test Loss: 90.625 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.089813709259033
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 97.560 Vali Acc: 0.100 Test Loss: 97.560 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1040234565734863
Epoch: 14, Steps: 13 | Train Loss: 0.180 Vali Loss: 96.792 Vali Acc: 0.160 Test Loss: 96.792 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0597925186157227
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 102.467 Vali Acc: 0.200 Test Loss: 102.467 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9848546981811523
Epoch: 16, Steps: 13 | Train Loss: 0.301 Vali Loss: 106.419 Vali Acc: 0.220 Test Loss: 106.419 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1158463954925537
Epoch: 17, Steps: 13 | Train Loss: 0.175 Vali Loss: 133.637 Vali Acc: 0.180 Test Loss: 133.637 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1585021018981934
Epoch: 18, Steps: 13 | Train Loss: 2.169 Vali Loss: 121.951 Vali Acc: 0.120 Test Loss: 121.951 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1254007816314697
Epoch: 19, Steps: 13 | Train Loss: 0.373 Vali Loss: 107.169 Vali Acc: 0.220 Test Loss: 107.169 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 10600069
model size : 42.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df256_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6960129737854004
Epoch: 1, Steps: 13 | Train Loss: 3.589 Vali Loss: 8.385 Vali Acc: 0.200 Test Loss: 8.385 Test Acc: 0.200
Validation loss decreased (inf --> -0.199916).  Saving model ...
Epoch: 2 cost time: 2.0571775436401367
Epoch: 2, Steps: 13 | Train Loss: 0.748 Vali Loss: 30.372 Vali Acc: 0.160 Test Loss: 30.372 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9926247596740723
Epoch: 3, Steps: 13 | Train Loss: 0.643 Vali Loss: 33.558 Vali Acc: 0.160 Test Loss: 33.558 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0937492847442627
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 25.592 Vali Acc: 0.180 Test Loss: 25.592 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1756138801574707
Epoch: 5, Steps: 13 | Train Loss: 0.001 Vali Loss: 27.698 Vali Acc: 0.180 Test Loss: 27.698 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1977925300598145
Epoch: 6, Steps: 13 | Train Loss: 0.068 Vali Loss: 45.304 Vali Acc: 0.240 Test Loss: 45.304 Test Acc: 0.240
Validation loss decreased (-0.199916 --> -0.239547).  Saving model ...
Epoch: 7 cost time: 2.000325918197632
Epoch: 7, Steps: 13 | Train Loss: 0.484 Vali Loss: 40.521 Vali Acc: 0.220 Test Loss: 40.521 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9692320823669434
Epoch: 8, Steps: 13 | Train Loss: 2.764 Vali Loss: 54.012 Vali Acc: 0.160 Test Loss: 54.012 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.049021005630493
Epoch: 9, Steps: 13 | Train Loss: 0.455 Vali Loss: 64.122 Vali Acc: 0.220 Test Loss: 64.122 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.31598162651062
Epoch: 10, Steps: 13 | Train Loss: 2.033 Vali Loss: 75.842 Vali Acc: 0.220 Test Loss: 75.842 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.238187313079834
Epoch: 11, Steps: 13 | Train Loss: 0.842 Vali Loss: 81.179 Vali Acc: 0.120 Test Loss: 81.179 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.1510682106018066
Epoch: 12, Steps: 13 | Train Loss: 1.409 Vali Loss: 77.538 Vali Acc: 0.180 Test Loss: 77.538 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1036643981933594
Epoch: 13, Steps: 13 | Train Loss: 0.747 Vali Loss: 81.353 Vali Acc: 0.200 Test Loss: 81.353 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0878171920776367
Epoch: 14, Steps: 13 | Train Loss: 1.813 Vali Loss: 81.869 Vali Acc: 0.220 Test Loss: 81.869 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0541088581085205
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 89.649 Vali Acc: 0.180 Test Loss: 89.649 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1561155319213867
Epoch: 16, Steps: 13 | Train Loss: 0.116 Vali Loss: 89.995 Vali Acc: 0.220 Test Loss: 89.995 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df256_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 8880133
model size : 36.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3103580474853516
Epoch: 1, Steps: 13 | Train Loss: 2.758 Vali Loss: 6.343 Vali Acc: 0.140 Test Loss: 6.343 Test Acc: 0.140
Validation loss decreased (inf --> -0.139937).  Saving model ...
Epoch: 2 cost time: 1.649656057357788
Epoch: 2, Steps: 13 | Train Loss: 0.016 Vali Loss: 9.747 Vali Acc: 0.160 Test Loss: 9.747 Test Acc: 0.160
Validation loss decreased (-0.139937 --> -0.159903).  Saving model ...
Epoch: 3 cost time: 1.8709030151367188
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.232 Vali Acc: 0.180 Test Loss: 14.232 Test Acc: 0.180
Validation loss decreased (-0.159903 --> -0.179858).  Saving model ...
Epoch: 4 cost time: 1.705296516418457
Epoch: 4, Steps: 13 | Train Loss: 0.007 Vali Loss: 15.111 Vali Acc: 0.200 Test Loss: 15.111 Test Acc: 0.200
Validation loss decreased (-0.179858 --> -0.199849).  Saving model ...
Epoch: 5 cost time: 1.6893787384033203
Epoch: 5, Steps: 13 | Train Loss: 0.537 Vali Loss: 22.938 Vali Acc: 0.240 Test Loss: 22.938 Test Acc: 0.240
Validation loss decreased (-0.199849 --> -0.239771).  Saving model ...
Epoch: 6 cost time: 1.6497879028320312
Epoch: 6, Steps: 13 | Train Loss: 0.240 Vali Loss: 26.017 Vali Acc: 0.140 Test Loss: 26.017 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6355342864990234
Epoch: 7, Steps: 13 | Train Loss: 1.338 Vali Loss: 29.953 Vali Acc: 0.160 Test Loss: 29.953 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6389951705932617
Epoch: 8, Steps: 13 | Train Loss: 0.313 Vali Loss: 43.328 Vali Acc: 0.220 Test Loss: 43.328 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.64436674118042
Epoch: 9, Steps: 13 | Train Loss: 0.879 Vali Loss: 50.781 Vali Acc: 0.140 Test Loss: 50.781 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.694913387298584
Epoch: 10, Steps: 13 | Train Loss: 1.941 Vali Loss: 51.140 Vali Acc: 0.140 Test Loss: 51.140 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7010507583618164
Epoch: 11, Steps: 13 | Train Loss: 0.015 Vali Loss: 53.472 Vali Acc: 0.100 Test Loss: 53.472 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.770691156387329
Epoch: 12, Steps: 13 | Train Loss: 1.160 Vali Loss: 44.857 Vali Acc: 0.180 Test Loss: 44.857 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6267518997192383
Epoch: 13, Steps: 13 | Train Loss: 0.561 Vali Loss: 52.329 Vali Acc: 0.140 Test Loss: 52.329 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5692012310028076
Epoch: 14, Steps: 13 | Train Loss: 0.162 Vali Loss: 65.282 Vali Acc: 0.180 Test Loss: 65.282 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.62147855758667
Epoch: 15, Steps: 13 | Train Loss: 0.129 Vali Loss: 69.762 Vali Acc: 0.160 Test Loss: 69.762 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 6299525
model size : 26.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 12.621219158172607
Epoch: 1, Steps: 25 | Train Loss: 57.835 Vali Loss: 100.879 Vali Acc: 0.180 Test Loss: 100.879 Test Acc: 0.180
Validation loss decreased (inf --> -0.178991).  Saving model ...
Epoch: 2 cost time: 10.836577892303467
Epoch: 2, Steps: 25 | Train Loss: 44.632 Vali Loss: 202.967 Vali Acc: 0.180 Test Loss: 202.967 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.20828104019165
Epoch: 3, Steps: 25 | Train Loss: 11.167 Vali Loss: 549.075 Vali Acc: 0.200 Test Loss: 549.075 Test Acc: 0.200
Validation loss decreased (-0.178991 --> -0.194509).  Saving model ...
Epoch: 4 cost time: 11.307094812393188
Epoch: 4, Steps: 25 | Train Loss: 26.983 Vali Loss: 281.099 Vali Acc: 0.240 Test Loss: 281.099 Test Acc: 0.240
Validation loss decreased (-0.194509 --> -0.237189).  Saving model ...
Epoch: 5 cost time: 11.135821342468262
Epoch: 5, Steps: 25 | Train Loss: 0.000 Vali Loss: 328.932 Vali Acc: 0.160 Test Loss: 328.932 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.510657787322998
Epoch: 6, Steps: 25 | Train Loss: 7.640 Vali Loss: 488.630 Vali Acc: 0.200 Test Loss: 488.630 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.835463523864746
Epoch: 7, Steps: 25 | Train Loss: 16.499 Vali Loss: 382.618 Vali Acc: 0.260 Test Loss: 382.618 Test Acc: 0.260
Validation loss decreased (-0.237189 --> -0.256174).  Saving model ...
Epoch: 8 cost time: 10.866784572601318
Epoch: 8, Steps: 25 | Train Loss: 6.296 Vali Loss: 365.591 Vali Acc: 0.220 Test Loss: 365.591 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.078321695327759
Epoch: 9, Steps: 25 | Train Loss: 1.666 Vali Loss: 385.302 Vali Acc: 0.260 Test Loss: 385.302 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.994309425354004
Epoch: 10, Steps: 25 | Train Loss: 0.848 Vali Loss: 613.953 Vali Acc: 0.200 Test Loss: 613.953 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.116525650024414
Epoch: 11, Steps: 25 | Train Loss: 4.604 Vali Loss: 624.282 Vali Acc: 0.200 Test Loss: 624.282 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.324815511703491
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 690.682 Vali Acc: 0.200 Test Loss: 690.682 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.280152082443237
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 699.467 Vali Acc: 0.180 Test Loss: 699.467 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.297816753387451
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 701.240 Vali Acc: 0.180 Test Loss: 701.240 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.916582107543945
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 699.751 Vali Acc: 0.180 Test Loss: 699.751 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.357303142547607
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 700.434 Vali Acc: 0.180 Test Loss: 700.434 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.225744009017944
Epoch: 17, Steps: 25 | Train Loss: 0.000 Vali Loss: 700.624 Vali Acc: 0.180 Test Loss: 700.624 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 57873925
model size : 223.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.187705993652344
Epoch: 1, Steps: 13 | Train Loss: 19.140 Vali Loss: 17.991 Vali Acc: 0.160 Test Loss: 17.991 Test Acc: 0.160
Validation loss decreased (inf --> -0.159820).  Saving model ...
Epoch: 2 cost time: 5.603071212768555
Epoch: 2, Steps: 13 | Train Loss: 9.103 Vali Loss: 60.241 Vali Acc: 0.200 Test Loss: 60.241 Test Acc: 0.200
Validation loss decreased (-0.159820 --> -0.199398).  Saving model ...
Epoch: 3 cost time: 5.592951536178589
Epoch: 3, Steps: 13 | Train Loss: 9.640 Vali Loss: 102.856 Vali Acc: 0.200 Test Loss: 102.856 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.771967172622681
Epoch: 4, Steps: 13 | Train Loss: 5.061 Vali Loss: 96.143 Vali Acc: 0.200 Test Loss: 96.143 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.531900405883789
Epoch: 5, Steps: 13 | Train Loss: 5.586 Vali Loss: 205.789 Vali Acc: 0.160 Test Loss: 205.789 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.766820907592773
Epoch: 6, Steps: 13 | Train Loss: 2.275 Vali Loss: 179.241 Vali Acc: 0.180 Test Loss: 179.241 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.720356225967407
Epoch: 7, Steps: 13 | Train Loss: 1.739 Vali Loss: 262.917 Vali Acc: 0.200 Test Loss: 262.917 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.768296957015991
Epoch: 8, Steps: 13 | Train Loss: 2.262 Vali Loss: 184.128 Vali Acc: 0.220 Test Loss: 184.128 Test Acc: 0.220
Validation loss decreased (-0.199398 --> -0.218159).  Saving model ...
Epoch: 9 cost time: 5.715503692626953
Epoch: 9, Steps: 13 | Train Loss: 0.464 Vali Loss: 205.539 Vali Acc: 0.240 Test Loss: 205.539 Test Acc: 0.240
Validation loss decreased (-0.218159 --> -0.237945).  Saving model ...
Epoch: 10 cost time: 5.708711385726929
Epoch: 10, Steps: 13 | Train Loss: 2.075 Vali Loss: 292.945 Vali Acc: 0.200 Test Loss: 292.945 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.639277935028076
Epoch: 11, Steps: 13 | Train Loss: 0.285 Vali Loss: 200.593 Vali Acc: 0.220 Test Loss: 200.593 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.5633485317230225
Epoch: 12, Steps: 13 | Train Loss: 1.715 Vali Loss: 216.066 Vali Acc: 0.280 Test Loss: 216.066 Test Acc: 0.280
Validation loss decreased (-0.237945 --> -0.277839).  Saving model ...
Epoch: 13 cost time: 5.599120378494263
Epoch: 13, Steps: 13 | Train Loss: 3.101 Vali Loss: 326.972 Vali Acc: 0.240 Test Loss: 326.972 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.5183775424957275
Epoch: 14, Steps: 13 | Train Loss: 0.253 Vali Loss: 339.910 Vali Acc: 0.220 Test Loss: 339.910 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.80679178237915
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 293.478 Vali Acc: 0.200 Test Loss: 293.478 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.605793714523315
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 440.937 Vali Acc: 0.180 Test Loss: 440.937 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.803186893463135
Epoch: 17, Steps: 13 | Train Loss: 3.672 Vali Loss: 281.963 Vali Acc: 0.120 Test Loss: 281.963 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.697980880737305
Epoch: 18, Steps: 13 | Train Loss: 4.215 Vali Loss: 209.742 Vali Acc: 0.100 Test Loss: 209.742 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.604316473007202
Epoch: 19, Steps: 13 | Train Loss: 5.555 Vali Loss: 210.700 Vali Acc: 0.100 Test Loss: 210.700 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.64401912689209
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 216.506 Vali Acc: 0.100 Test Loss: 216.506 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.593710899353027
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 256.777 Vali Acc: 0.120 Test Loss: 256.777 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.781293153762817
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 284.762 Vali Acc: 0.140 Test Loss: 284.762 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 32911621
model size : 128.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.0023033618927
Epoch: 1, Steps: 13 | Train Loss: 9.159 Vali Loss: 19.454 Vali Acc: 0.180 Test Loss: 19.454 Test Acc: 0.180
Validation loss decreased (inf --> -0.179805).  Saving model ...
Epoch: 2 cost time: 2.871891498565674
Epoch: 2, Steps: 13 | Train Loss: 1.526 Vali Loss: 61.955 Vali Acc: 0.200 Test Loss: 61.955 Test Acc: 0.200
Validation loss decreased (-0.179805 --> -0.199380).  Saving model ...
Epoch: 3 cost time: 2.8936312198638916
Epoch: 3, Steps: 13 | Train Loss: 5.448 Vali Loss: 102.333 Vali Acc: 0.200 Test Loss: 102.333 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8389265537261963
Epoch: 4, Steps: 13 | Train Loss: 2.750 Vali Loss: 66.020 Vali Acc: 0.200 Test Loss: 66.020 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0123233795166016
Epoch: 5, Steps: 13 | Train Loss: 3.865 Vali Loss: 81.631 Vali Acc: 0.200 Test Loss: 81.631 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.006969928741455
Epoch: 6, Steps: 13 | Train Loss: 0.695 Vali Loss: 89.645 Vali Acc: 0.220 Test Loss: 89.645 Test Acc: 0.220
Validation loss decreased (-0.199380 --> -0.219104).  Saving model ...
Epoch: 7 cost time: 3.0321171283721924
Epoch: 7, Steps: 13 | Train Loss: 0.109 Vali Loss: 108.703 Vali Acc: 0.200 Test Loss: 108.703 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9866974353790283
Epoch: 8, Steps: 13 | Train Loss: 7.283 Vali Loss: 126.363 Vali Acc: 0.240 Test Loss: 126.363 Test Acc: 0.240
Validation loss decreased (-0.219104 --> -0.238736).  Saving model ...
Epoch: 9 cost time: 3.054107189178467
Epoch: 9, Steps: 13 | Train Loss: 2.357 Vali Loss: 93.088 Vali Acc: 0.240 Test Loss: 93.088 Test Acc: 0.240
Validation loss decreased (-0.238736 --> -0.239069).  Saving model ...
Epoch: 10 cost time: 3.0503382682800293
Epoch: 10, Steps: 13 | Train Loss: 5.083 Vali Loss: 174.254 Vali Acc: 0.200 Test Loss: 174.254 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.070984125137329
Epoch: 11, Steps: 13 | Train Loss: 19.113 Vali Loss: 133.760 Vali Acc: 0.200 Test Loss: 133.760 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.084632635116577
Epoch: 12, Steps: 13 | Train Loss: 5.413 Vali Loss: 205.523 Vali Acc: 0.120 Test Loss: 205.523 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.9976844787597656
Epoch: 13, Steps: 13 | Train Loss: 0.418 Vali Loss: 206.943 Vali Acc: 0.140 Test Loss: 206.943 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.93347430229187
Epoch: 14, Steps: 13 | Train Loss: 3.486 Vali Loss: 162.463 Vali Acc: 0.160 Test Loss: 162.463 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.102416515350342
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 198.925 Vali Acc: 0.160 Test Loss: 198.925 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.0197229385375977
Epoch: 16, Steps: 13 | Train Loss: 0.016 Vali Loss: 173.566 Vali Acc: 0.180 Test Loss: 173.566 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.1068124771118164
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 207.164 Vali Acc: 0.200 Test Loss: 207.164 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.1485040187835693
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 209.207 Vali Acc: 0.220 Test Loss: 209.207 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.0943987369537354
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 209.364 Vali Acc: 0.220 Test Loss: 209.364 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 20861317
model size : 82.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df128_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.387802600860596
Epoch: 1, Steps: 13 | Train Loss: 4.437 Vali Loss: 15.707 Vali Acc: 0.200 Test Loss: 15.707 Test Acc: 0.200
Validation loss decreased (inf --> -0.199843).  Saving model ...
Epoch: 2 cost time: 2.5257341861724854
Epoch: 2, Steps: 13 | Train Loss: 2.551 Vali Loss: 35.018 Vali Acc: 0.140 Test Loss: 35.018 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5521788597106934
Epoch: 3, Steps: 13 | Train Loss: 2.121 Vali Loss: 49.626 Vali Acc: 0.120 Test Loss: 49.626 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6033754348754883
Epoch: 4, Steps: 13 | Train Loss: 0.667 Vali Loss: 52.886 Vali Acc: 0.200 Test Loss: 52.886 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.596018075942993
Epoch: 5, Steps: 13 | Train Loss: 0.444 Vali Loss: 74.556 Vali Acc: 0.180 Test Loss: 74.556 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.590850353240967
Epoch: 6, Steps: 13 | Train Loss: 0.988 Vali Loss: 63.508 Vali Acc: 0.160 Test Loss: 63.508 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.579045534133911
Epoch: 7, Steps: 13 | Train Loss: 11.186 Vali Loss: 96.751 Vali Acc: 0.080 Test Loss: 96.751 Test Acc: 0.080
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.6899311542510986
Epoch: 8, Steps: 13 | Train Loss: 3.178 Vali Loss: 88.061 Vali Acc: 0.120 Test Loss: 88.061 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6978466510772705
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 97.463 Vali Acc: 0.160 Test Loss: 97.463 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.801363468170166
Epoch: 10, Steps: 13 | Train Loss: 0.668 Vali Loss: 111.801 Vali Acc: 0.140 Test Loss: 111.801 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.575768232345581
Epoch: 11, Steps: 13 | Train Loss: 0.810 Vali Loss: 121.305 Vali Acc: 0.180 Test Loss: 121.305 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df128_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 16558085
model size : 65.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9051194190979004
Epoch: 1, Steps: 13 | Train Loss: 3.302 Vali Loss: 7.636 Vali Acc: 0.180 Test Loss: 7.636 Test Acc: 0.180
Validation loss decreased (inf --> -0.179924).  Saving model ...
Epoch: 2 cost time: 1.9323616027832031
Epoch: 2, Steps: 13 | Train Loss: 0.680 Vali Loss: 24.456 Vali Acc: 0.160 Test Loss: 24.456 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9251370429992676
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 28.598 Vali Acc: 0.160 Test Loss: 28.598 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9000511169433594
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 31.344 Vali Acc: 0.200 Test Loss: 31.344 Test Acc: 0.200
Validation loss decreased (-0.179924 --> -0.199687).  Saving model ...
Epoch: 5 cost time: 2.00945782661438
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.416 Vali Acc: 0.200 Test Loss: 32.416 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9079489707946777
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.728 Vali Acc: 0.200 Test Loss: 32.728 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.979255199432373
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.824 Vali Acc: 0.200 Test Loss: 32.824 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.166361093521118
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 33.093 Vali Acc: 0.200 Test Loss: 33.093 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0760536193847656
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.850 Vali Acc: 0.200 Test Loss: 32.850 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.085315465927124
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.919 Vali Acc: 0.200 Test Loss: 32.919 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9426021575927734
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 33.047 Vali Acc: 0.200 Test Loss: 33.047 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.053046703338623
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 33.129 Vali Acc: 0.200 Test Loss: 33.129 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.058999538421631
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.944 Vali Acc: 0.200 Test Loss: 32.944 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.0751664638519287
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.714 Vali Acc: 0.200 Test Loss: 32.714 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 10534277
model size : 42.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df128_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.48964786529541
Epoch: 1, Steps: 13 | Train Loss: 3.201 Vali Loss: 7.767 Vali Acc: 0.200 Test Loss: 7.767 Test Acc: 0.200
Validation loss decreased (inf --> -0.199922).  Saving model ...
Epoch: 2 cost time: 1.844792366027832
Epoch: 2, Steps: 13 | Train Loss: 0.790 Vali Loss: 18.532 Vali Acc: 0.120 Test Loss: 18.532 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7873280048370361
Epoch: 3, Steps: 13 | Train Loss: 0.315 Vali Loss: 23.713 Vali Acc: 0.200 Test Loss: 23.713 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8376834392547607
Epoch: 4, Steps: 13 | Train Loss: 0.271 Vali Loss: 51.953 Vali Acc: 0.180 Test Loss: 51.953 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9770853519439697
Epoch: 5, Steps: 13 | Train Loss: 0.838 Vali Loss: 42.991 Vali Acc: 0.160 Test Loss: 42.991 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.014752149581909
Epoch: 6, Steps: 13 | Train Loss: 0.729 Vali Loss: 41.219 Vali Acc: 0.160 Test Loss: 41.219 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.002955675125122
Epoch: 7, Steps: 13 | Train Loss: 0.433 Vali Loss: 49.740 Vali Acc: 0.240 Test Loss: 49.740 Test Acc: 0.240
Validation loss decreased (-0.199922 --> -0.239503).  Saving model ...
Epoch: 8 cost time: 1.903299331665039
Epoch: 8, Steps: 13 | Train Loss: 0.090 Vali Loss: 55.202 Vali Acc: 0.200 Test Loss: 55.202 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.02447772026062
Epoch: 9, Steps: 13 | Train Loss: 1.240 Vali Loss: 92.402 Vali Acc: 0.180 Test Loss: 92.402 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.244224786758423
Epoch: 10, Steps: 13 | Train Loss: 4.125 Vali Loss: 70.424 Vali Acc: 0.280 Test Loss: 70.424 Test Acc: 0.280
Validation loss decreased (-0.239503 --> -0.279296).  Saving model ...
Epoch: 11 cost time: 2.154524564743042
Epoch: 11, Steps: 13 | Train Loss: 1.850 Vali Loss: 95.991 Vali Acc: 0.260 Test Loss: 95.991 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.243518114089966
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 119.862 Vali Acc: 0.220 Test Loss: 119.862 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.04304575920105
Epoch: 13, Steps: 13 | Train Loss: 4.333 Vali Loss: 90.485 Vali Acc: 0.220 Test Loss: 90.485 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2918145656585693
Epoch: 14, Steps: 13 | Train Loss: 0.503 Vali Loss: 76.650 Vali Acc: 0.220 Test Loss: 76.650 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.129413366317749
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 82.033 Vali Acc: 0.260 Test Loss: 82.033 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9584307670593262
Epoch: 16, Steps: 13 | Train Loss: 0.313 Vali Loss: 91.554 Vali Acc: 0.220 Test Loss: 91.554 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0750279426574707
Epoch: 17, Steps: 13 | Train Loss: 0.174 Vali Loss: 96.540 Vali Acc: 0.240 Test Loss: 96.540 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9649326801300049
Epoch: 18, Steps: 13 | Train Loss: 0.631 Vali Loss: 83.313 Vali Acc: 0.180 Test Loss: 83.313 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9600839614868164
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 87.388 Vali Acc: 0.260 Test Loss: 87.388 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9574615955352783
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 91.870 Vali Acc: 0.240 Test Loss: 91.870 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df128_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 8814341
model size : 36.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5112757682800293
Epoch: 1, Steps: 13 | Train Loss: 3.000 Vali Loss: 5.983 Vali Acc: 0.180 Test Loss: 5.983 Test Acc: 0.180
Validation loss decreased (inf --> -0.179940).  Saving model ...
Epoch: 2 cost time: 1.6134331226348877
Epoch: 2, Steps: 13 | Train Loss: 0.005 Vali Loss: 10.298 Vali Acc: 0.220 Test Loss: 10.298 Test Acc: 0.220
Validation loss decreased (-0.179940 --> -0.219897).  Saving model ...
Epoch: 3 cost time: 1.6441519260406494
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 13.899 Vali Acc: 0.240 Test Loss: 13.899 Test Acc: 0.240
Validation loss decreased (-0.219897 --> -0.239861).  Saving model ...
Epoch: 4 cost time: 1.767662525177002
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 15.495 Vali Acc: 0.220 Test Loss: 15.495 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.879288911819458
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.096 Vali Acc: 0.220 Test Loss: 16.096 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6427247524261475
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.110 Vali Acc: 0.220 Test Loss: 16.110 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6935977935791016
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.070 Vali Acc: 0.220 Test Loss: 16.070 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5858023166656494
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.243 Vali Acc: 0.220 Test Loss: 16.243 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5805635452270508
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.281 Vali Acc: 0.220 Test Loss: 16.281 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5973875522613525
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.227 Vali Acc: 0.220 Test Loss: 16.227 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6091012954711914
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.040 Vali Acc: 0.220 Test Loss: 16.040 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5734517574310303
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.115 Vali Acc: 0.220 Test Loss: 16.115 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6602497100830078
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.305 Vali Acc: 0.220 Test Loss: 16.305 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 6233733
model size : 26.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 11.847481966018677
Epoch: 1, Steps: 25 | Train Loss: 62.075 Vali Loss: 94.461 Vali Acc: 0.180 Test Loss: 94.461 Test Acc: 0.180
Validation loss decreased (inf --> -0.179055).  Saving model ...
Epoch: 2 cost time: 10.415297508239746
Epoch: 2, Steps: 25 | Train Loss: 82.866 Vali Loss: 264.403 Vali Acc: 0.180 Test Loss: 264.403 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.499784231185913
Epoch: 3, Steps: 25 | Train Loss: 57.492 Vali Loss: 386.538 Vali Acc: 0.260 Test Loss: 386.538 Test Acc: 0.260
Validation loss decreased (-0.179055 --> -0.256135).  Saving model ...
Epoch: 4 cost time: 10.718775033950806
Epoch: 4, Steps: 25 | Train Loss: 36.395 Vali Loss: 319.611 Vali Acc: 0.140 Test Loss: 319.611 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.702472925186157
Epoch: 5, Steps: 25 | Train Loss: 11.970 Vali Loss: 318.796 Vali Acc: 0.160 Test Loss: 318.796 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.10460352897644
Epoch: 6, Steps: 25 | Train Loss: 12.814 Vali Loss: 264.687 Vali Acc: 0.200 Test Loss: 264.687 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.597380638122559
Epoch: 7, Steps: 25 | Train Loss: 0.000 Vali Loss: 295.052 Vali Acc: 0.140 Test Loss: 295.052 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.587332725524902
Epoch: 8, Steps: 25 | Train Loss: 0.057 Vali Loss: 282.578 Vali Acc: 0.160 Test Loss: 282.578 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.752894163131714
Epoch: 9, Steps: 25 | Train Loss: 0.000 Vali Loss: 308.378 Vali Acc: 0.240 Test Loss: 308.378 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.989931106567383
Epoch: 10, Steps: 25 | Train Loss: 0.000 Vali Loss: 317.236 Vali Acc: 0.220 Test Loss: 317.236 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.654946565628052
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 317.377 Vali Acc: 0.220 Test Loss: 317.377 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.763269186019897
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 318.019 Vali Acc: 0.220 Test Loss: 318.019 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 10.68505048751831
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 317.543 Vali Acc: 0.220 Test Loss: 317.543 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 57841029
model size : 223.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.578073740005493
Epoch: 1, Steps: 13 | Train Loss: 9.263 Vali Loss: 55.193 Vali Acc: 0.200 Test Loss: 55.193 Test Acc: 0.200
Validation loss decreased (inf --> -0.199448).  Saving model ...
Epoch: 2 cost time: 4.871218204498291
Epoch: 2, Steps: 13 | Train Loss: 8.901 Vali Loss: 117.058 Vali Acc: 0.180 Test Loss: 117.058 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.896843194961548
Epoch: 3, Steps: 13 | Train Loss: 4.376 Vali Loss: 87.968 Vali Acc: 0.240 Test Loss: 87.968 Test Acc: 0.240
Validation loss decreased (-0.199448 --> -0.239120).  Saving model ...
Epoch: 4 cost time: 5.027001619338989
Epoch: 4, Steps: 13 | Train Loss: 3.314 Vali Loss: 125.880 Vali Acc: 0.260 Test Loss: 125.880 Test Acc: 0.260
Validation loss decreased (-0.239120 --> -0.258741).  Saving model ...
Epoch: 5 cost time: 5.04294228553772
Epoch: 5, Steps: 13 | Train Loss: 6.247 Vali Loss: 156.572 Vali Acc: 0.200 Test Loss: 156.572 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.08893609046936
Epoch: 6, Steps: 13 | Train Loss: 3.452 Vali Loss: 169.722 Vali Acc: 0.120 Test Loss: 169.722 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.137234210968018
Epoch: 7, Steps: 13 | Train Loss: 0.001 Vali Loss: 129.045 Vali Acc: 0.160 Test Loss: 129.045 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.033541679382324
Epoch: 8, Steps: 13 | Train Loss: 1.339 Vali Loss: 198.687 Vali Acc: 0.140 Test Loss: 198.687 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.163124084472656
Epoch: 9, Steps: 13 | Train Loss: 3.667 Vali Loss: 149.965 Vali Acc: 0.140 Test Loss: 149.965 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.007709741592407
Epoch: 10, Steps: 13 | Train Loss: 7.770 Vali Loss: 332.020 Vali Acc: 0.200 Test Loss: 332.020 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.059318780899048
Epoch: 11, Steps: 13 | Train Loss: 8.244 Vali Loss: 229.895 Vali Acc: 0.220 Test Loss: 229.895 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.038088798522949
Epoch: 12, Steps: 13 | Train Loss: 7.828 Vali Loss: 237.770 Vali Acc: 0.120 Test Loss: 237.770 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.097965478897095
Epoch: 13, Steps: 13 | Train Loss: 5.886 Vali Loss: 280.752 Vali Acc: 0.260 Test Loss: 280.752 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.142981767654419
Epoch: 14, Steps: 13 | Train Loss: 8.223 Vali Loss: 229.432 Vali Acc: 0.140 Test Loss: 229.432 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 32878725
model size : 127.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.538561582565308
Epoch: 1, Steps: 13 | Train Loss: 5.814 Vali Loss: 25.577 Vali Acc: 0.140 Test Loss: 25.577 Test Acc: 0.140
Validation loss decreased (inf --> -0.139744).  Saving model ...
Epoch: 2 cost time: 2.9097931385040283
Epoch: 2, Steps: 13 | Train Loss: 6.160 Vali Loss: 60.613 Vali Acc: 0.160 Test Loss: 60.613 Test Acc: 0.160
Validation loss decreased (-0.139744 --> -0.159394).  Saving model ...
Epoch: 3 cost time: 2.9156599044799805
Epoch: 3, Steps: 13 | Train Loss: 3.918 Vali Loss: 110.149 Vali Acc: 0.200 Test Loss: 110.149 Test Acc: 0.200
Validation loss decreased (-0.159394 --> -0.198899).  Saving model ...
Epoch: 4 cost time: 2.931746006011963
Epoch: 4, Steps: 13 | Train Loss: 2.240 Vali Loss: 106.505 Vali Acc: 0.200 Test Loss: 106.505 Test Acc: 0.200
Validation loss decreased (-0.198899 --> -0.198935).  Saving model ...
Epoch: 5 cost time: 3.0039565563201904
Epoch: 5, Steps: 13 | Train Loss: 1.531 Vali Loss: 120.705 Vali Acc: 0.200 Test Loss: 120.705 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9453372955322266
Epoch: 6, Steps: 13 | Train Loss: 4.864 Vali Loss: 114.190 Vali Acc: 0.220 Test Loss: 114.190 Test Acc: 0.220
Validation loss decreased (-0.198935 --> -0.218858).  Saving model ...
Epoch: 7 cost time: 2.992772340774536
Epoch: 7, Steps: 13 | Train Loss: 8.073 Vali Loss: 121.050 Vali Acc: 0.160 Test Loss: 121.050 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1145777702331543
Epoch: 8, Steps: 13 | Train Loss: 3.513 Vali Loss: 166.384 Vali Acc: 0.180 Test Loss: 166.384 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1388261318206787
Epoch: 9, Steps: 13 | Train Loss: 3.870 Vali Loss: 192.952 Vali Acc: 0.200 Test Loss: 192.952 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.940953254699707
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 188.423 Vali Acc: 0.160 Test Loss: 188.423 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.03132700920105
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 190.815 Vali Acc: 0.180 Test Loss: 190.815 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.843130111694336
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 186.365 Vali Acc: 0.200 Test Loss: 186.365 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.9382033348083496
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 183.022 Vali Acc: 0.200 Test Loss: 183.022 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8994688987731934
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 182.097 Vali Acc: 0.200 Test Loss: 182.097 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.0985751152038574
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 181.724 Vali Acc: 0.200 Test Loss: 181.724 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.0403079986572266
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 182.223 Vali Acc: 0.200 Test Loss: 182.223 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 20828421
model size : 81.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df64_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.696858644485474
Epoch: 1, Steps: 13 | Train Loss: 9.608 Vali Loss: 32.223 Vali Acc: 0.200 Test Loss: 32.223 Test Acc: 0.200
Validation loss decreased (inf --> -0.199678).  Saving model ...
Epoch: 2 cost time: 2.391355037689209
Epoch: 2, Steps: 13 | Train Loss: 0.044 Vali Loss: 46.534 Vali Acc: 0.180 Test Loss: 46.534 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.459113836288452
Epoch: 3, Steps: 13 | Train Loss: 0.410 Vali Loss: 60.629 Vali Acc: 0.180 Test Loss: 60.629 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3498752117156982
Epoch: 4, Steps: 13 | Train Loss: 1.312 Vali Loss: 48.984 Vali Acc: 0.160 Test Loss: 48.984 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3298070430755615
Epoch: 5, Steps: 13 | Train Loss: 0.383 Vali Loss: 76.443 Vali Acc: 0.200 Test Loss: 76.443 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3375821113586426
Epoch: 6, Steps: 13 | Train Loss: 0.833 Vali Loss: 127.205 Vali Acc: 0.220 Test Loss: 127.205 Test Acc: 0.220
Validation loss decreased (-0.199678 --> -0.218728).  Saving model ...
Epoch: 7 cost time: 2.4575963020324707
Epoch: 7, Steps: 13 | Train Loss: 2.837 Vali Loss: 73.813 Vali Acc: 0.180 Test Loss: 73.813 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4452507495880127
Epoch: 8, Steps: 13 | Train Loss: 2.591 Vali Loss: 99.832 Vali Acc: 0.180 Test Loss: 99.832 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5149953365325928
Epoch: 9, Steps: 13 | Train Loss: 8.724 Vali Loss: 126.096 Vali Acc: 0.180 Test Loss: 126.096 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.512653112411499
Epoch: 10, Steps: 13 | Train Loss: 18.959 Vali Loss: 93.340 Vali Acc: 0.140 Test Loss: 93.340 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5099573135375977
Epoch: 11, Steps: 13 | Train Loss: 1.042 Vali Loss: 122.391 Vali Acc: 0.160 Test Loss: 122.391 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7337193489074707
Epoch: 12, Steps: 13 | Train Loss: 0.702 Vali Loss: 140.444 Vali Acc: 0.100 Test Loss: 140.444 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.684779644012451
Epoch: 13, Steps: 13 | Train Loss: 4.203 Vali Loss: 143.593 Vali Acc: 0.100 Test Loss: 143.593 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.4488542079925537
Epoch: 14, Steps: 13 | Train Loss: 2.294 Vali Loss: 129.293 Vali Acc: 0.120 Test Loss: 129.293 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4848151206970215
Epoch: 15, Steps: 13 | Train Loss: 0.019 Vali Loss: 151.939 Vali Acc: 0.100 Test Loss: 151.939 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.6021461486816406
Epoch: 16, Steps: 13 | Train Loss: 0.632 Vali Loss: 180.853 Vali Acc: 0.160 Test Loss: 180.853 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df64_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 16525189
model size : 65.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8552098274230957
Epoch: 1, Steps: 13 | Train Loss: 3.153 Vali Loss: 12.008 Vali Acc: 0.180 Test Loss: 12.008 Test Acc: 0.180
Validation loss decreased (inf --> -0.179880).  Saving model ...
Epoch: 2 cost time: 1.8952882289886475
Epoch: 2, Steps: 13 | Train Loss: 1.033 Vali Loss: 17.087 Vali Acc: 0.200 Test Loss: 17.087 Test Acc: 0.200
Validation loss decreased (-0.179880 --> -0.199829).  Saving model ...
Epoch: 3 cost time: 1.9689149856567383
Epoch: 3, Steps: 13 | Train Loss: 1.038 Vali Loss: 34.726 Vali Acc: 0.160 Test Loss: 34.726 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.02065372467041
Epoch: 4, Steps: 13 | Train Loss: 0.034 Vali Loss: 42.673 Vali Acc: 0.240 Test Loss: 42.673 Test Acc: 0.240
Validation loss decreased (-0.199829 --> -0.239573).  Saving model ...
Epoch: 5 cost time: 1.9746594429016113
Epoch: 5, Steps: 13 | Train Loss: 0.894 Vali Loss: 35.829 Vali Acc: 0.180 Test Loss: 35.829 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.954683780670166
Epoch: 6, Steps: 13 | Train Loss: 0.002 Vali Loss: 72.449 Vali Acc: 0.180 Test Loss: 72.449 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9552514553070068
Epoch: 7, Steps: 13 | Train Loss: 0.816 Vali Loss: 53.915 Vali Acc: 0.240 Test Loss: 53.915 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.990312099456787
Epoch: 8, Steps: 13 | Train Loss: 1.119 Vali Loss: 87.644 Vali Acc: 0.160 Test Loss: 87.644 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1005804538726807
Epoch: 9, Steps: 13 | Train Loss: 6.553 Vali Loss: 75.049 Vali Acc: 0.240 Test Loss: 75.049 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9903175830841064
Epoch: 10, Steps: 13 | Train Loss: 0.354 Vali Loss: 111.785 Vali Acc: 0.160 Test Loss: 111.785 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9436068534851074
Epoch: 11, Steps: 13 | Train Loss: 2.107 Vali Loss: 89.416 Vali Acc: 0.180 Test Loss: 89.416 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.0124340057373047
Epoch: 12, Steps: 13 | Train Loss: 3.200 Vali Loss: 103.143 Vali Acc: 0.120 Test Loss: 103.143 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9931137561798096
Epoch: 13, Steps: 13 | Train Loss: 0.224 Vali Loss: 107.095 Vali Acc: 0.120 Test Loss: 107.095 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8185927867889404
Epoch: 14, Steps: 13 | Train Loss: 0.680 Vali Loss: 118.196 Vali Acc: 0.100 Test Loss: 118.196 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 10501381
model size : 42.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df64_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2522146701812744
Epoch: 1, Steps: 13 | Train Loss: 3.118 Vali Loss: 7.698 Vali Acc: 0.200 Test Loss: 7.698 Test Acc: 0.200
Validation loss decreased (inf --> -0.199923).  Saving model ...
Epoch: 2 cost time: 1.7328920364379883
Epoch: 2, Steps: 13 | Train Loss: 0.394 Vali Loss: 22.836 Vali Acc: 0.180 Test Loss: 22.836 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7669203281402588
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 30.546 Vali Acc: 0.180 Test Loss: 30.546 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8930552005767822
Epoch: 4, Steps: 13 | Train Loss: 0.228 Vali Loss: 30.035 Vali Acc: 0.200 Test Loss: 30.035 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.900193691253662
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 33.332 Vali Acc: 0.240 Test Loss: 33.332 Test Acc: 0.240
Validation loss decreased (-0.199923 --> -0.239667).  Saving model ...
Epoch: 6 cost time: 1.9066803455352783
Epoch: 6, Steps: 13 | Train Loss: 0.004 Vali Loss: 33.002 Vali Acc: 0.140 Test Loss: 33.002 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9214897155761719
Epoch: 7, Steps: 13 | Train Loss: 0.387 Vali Loss: 37.150 Vali Acc: 0.240 Test Loss: 37.150 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8581418991088867
Epoch: 8, Steps: 13 | Train Loss: 0.919 Vali Loss: 43.854 Vali Acc: 0.220 Test Loss: 43.854 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.974790096282959
Epoch: 9, Steps: 13 | Train Loss: 1.300 Vali Loss: 50.168 Vali Acc: 0.280 Test Loss: 50.168 Test Acc: 0.280
Validation loss decreased (-0.239667 --> -0.279498).  Saving model ...
Epoch: 10 cost time: 1.9199633598327637
Epoch: 10, Steps: 13 | Train Loss: 5.010 Vali Loss: 75.594 Vali Acc: 0.220 Test Loss: 75.594 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.95717453956604
Epoch: 11, Steps: 13 | Train Loss: 2.397 Vali Loss: 57.026 Vali Acc: 0.240 Test Loss: 57.026 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9059221744537354
Epoch: 12, Steps: 13 | Train Loss: 1.409 Vali Loss: 56.253 Vali Acc: 0.260 Test Loss: 56.253 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8163111209869385
Epoch: 13, Steps: 13 | Train Loss: 3.315 Vali Loss: 59.008 Vali Acc: 0.260 Test Loss: 59.008 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7246246337890625
Epoch: 14, Steps: 13 | Train Loss: 16.924 Vali Loss: 98.629 Vali Acc: 0.160 Test Loss: 98.629 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.747154712677002
Epoch: 15, Steps: 13 | Train Loss: 1.248 Vali Loss: 95.507 Vali Acc: 0.200 Test Loss: 95.507 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8428261280059814
Epoch: 16, Steps: 13 | Train Loss: 3.770 Vali Loss: 80.613 Vali Acc: 0.260 Test Loss: 80.613 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7837042808532715
Epoch: 17, Steps: 13 | Train Loss: 0.037 Vali Loss: 82.388 Vali Acc: 0.240 Test Loss: 82.388 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8221657276153564
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 80.678 Vali Acc: 0.220 Test Loss: 80.678 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8548076152801514
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 84.566 Vali Acc: 0.200 Test Loss: 84.566 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df64_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 8781445
model size : 35.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4013235569000244
Epoch: 1, Steps: 13 | Train Loss: 2.351 Vali Loss: 6.132 Vali Acc: 0.220 Test Loss: 6.132 Test Acc: 0.220
Validation loss decreased (inf --> -0.219939).  Saving model ...
Epoch: 2 cost time: 1.5344362258911133
Epoch: 2, Steps: 13 | Train Loss: 0.019 Vali Loss: 17.848 Vali Acc: 0.200 Test Loss: 17.848 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4837052822113037
Epoch: 3, Steps: 13 | Train Loss: 0.037 Vali Loss: 13.826 Vali Acc: 0.160 Test Loss: 13.826 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5447914600372314
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 15.928 Vali Acc: 0.200 Test Loss: 15.928 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.546269178390503
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 22.390 Vali Acc: 0.140 Test Loss: 22.390 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6154630184173584
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 28.301 Vali Acc: 0.160 Test Loss: 28.301 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5877904891967773
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 30.105 Vali Acc: 0.160 Test Loss: 30.105 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6325623989105225
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 30.719 Vali Acc: 0.160 Test Loss: 30.719 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4998714923858643
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 30.956 Vali Acc: 0.140 Test Loss: 30.956 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5416591167449951
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 30.840 Vali Acc: 0.160 Test Loss: 30.840 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4536004066467285
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 30.904 Vali Acc: 0.140 Test Loss: 30.904 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm128_nh16_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 6200837
model size : 26.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 11.717037916183472
Epoch: 1, Steps: 25 | Train Loss: 51.771 Vali Loss: 81.410 Vali Acc: 0.220 Test Loss: 81.410 Test Acc: 0.220
Validation loss decreased (inf --> -0.219186).  Saving model ...
Epoch: 2 cost time: 9.860222816467285
Epoch: 2, Steps: 25 | Train Loss: 12.986 Vali Loss: 102.891 Vali Acc: 0.160 Test Loss: 102.891 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.213525295257568
Epoch: 3, Steps: 25 | Train Loss: 6.110 Vali Loss: 280.313 Vali Acc: 0.200 Test Loss: 280.313 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.13590931892395
Epoch: 4, Steps: 25 | Train Loss: 11.580 Vali Loss: 218.402 Vali Acc: 0.220 Test Loss: 218.402 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.22190237045288
Epoch: 5, Steps: 25 | Train Loss: 14.070 Vali Loss: 226.077 Vali Acc: 0.080 Test Loss: 226.077 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.434405088424683
Epoch: 6, Steps: 25 | Train Loss: 7.887 Vali Loss: 282.700 Vali Acc: 0.200 Test Loss: 282.700 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.368640661239624
Epoch: 7, Steps: 25 | Train Loss: 6.969 Vali Loss: 221.358 Vali Acc: 0.240 Test Loss: 221.358 Test Acc: 0.240
Validation loss decreased (-0.219186 --> -0.237786).  Saving model ...
Epoch: 8 cost time: 10.30997896194458
Epoch: 8, Steps: 25 | Train Loss: 0.211 Vali Loss: 230.001 Vali Acc: 0.240 Test Loss: 230.001 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.315699100494385
Epoch: 9, Steps: 25 | Train Loss: 3.091 Vali Loss: 187.303 Vali Acc: 0.200 Test Loss: 187.303 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.400806188583374
Epoch: 10, Steps: 25 | Train Loss: 0.006 Vali Loss: 189.072 Vali Acc: 0.220 Test Loss: 189.072 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.166634321212769
Epoch: 11, Steps: 25 | Train Loss: 2.813 Vali Loss: 185.739 Vali Acc: 0.200 Test Loss: 185.739 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.422226667404175
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 227.994 Vali Acc: 0.200 Test Loss: 227.994 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.232805967330933
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 239.096 Vali Acc: 0.220 Test Loss: 239.096 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.223810195922852
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 240.329 Vali Acc: 0.220 Test Loss: 240.329 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.312071800231934
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 240.492 Vali Acc: 0.220 Test Loss: 240.492 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.278433561325073
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 239.085 Vali Acc: 0.220 Test Loss: 239.085 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.2451012134552
Epoch: 17, Steps: 25 | Train Loss: 0.000 Vali Loss: 239.375 Vali Acc: 0.220 Test Loss: 239.375 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 28937349
model size : 111.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.2154340744018555
Epoch: 1, Steps: 13 | Train Loss: 10.927 Vali Loss: 27.838 Vali Acc: 0.200 Test Loss: 27.838 Test Acc: 0.200
Validation loss decreased (inf --> -0.199722).  Saving model ...
Epoch: 2 cost time: 4.475645542144775
Epoch: 2, Steps: 13 | Train Loss: 4.419 Vali Loss: 47.270 Vali Acc: 0.200 Test Loss: 47.270 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.604687929153442
Epoch: 3, Steps: 13 | Train Loss: 6.456 Vali Loss: 51.683 Vali Acc: 0.180 Test Loss: 51.683 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.61462926864624
Epoch: 4, Steps: 13 | Train Loss: 5.410 Vali Loss: 46.912 Vali Acc: 0.220 Test Loss: 46.912 Test Acc: 0.220
Validation loss decreased (-0.199722 --> -0.219531).  Saving model ...
Epoch: 5 cost time: 4.520292282104492
Epoch: 5, Steps: 13 | Train Loss: 7.284 Vali Loss: 96.001 Vali Acc: 0.180 Test Loss: 96.001 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.59845232963562
Epoch: 6, Steps: 13 | Train Loss: 2.557 Vali Loss: 81.101 Vali Acc: 0.200 Test Loss: 81.101 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.558403968811035
Epoch: 7, Steps: 13 | Train Loss: 0.429 Vali Loss: 68.553 Vali Acc: 0.180 Test Loss: 68.553 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.593790292739868
Epoch: 8, Steps: 13 | Train Loss: 0.378 Vali Loss: 108.827 Vali Acc: 0.140 Test Loss: 108.827 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.743966341018677
Epoch: 9, Steps: 13 | Train Loss: 1.550 Vali Loss: 92.509 Vali Acc: 0.180 Test Loss: 92.509 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.635279178619385
Epoch: 10, Steps: 13 | Train Loss: 0.090 Vali Loss: 97.066 Vali Acc: 0.180 Test Loss: 97.066 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.609143018722534
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 121.594 Vali Acc: 0.140 Test Loss: 121.594 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.800877332687378
Epoch: 12, Steps: 13 | Train Loss: 0.877 Vali Loss: 120.386 Vali Acc: 0.080 Test Loss: 120.386 Test Acc: 0.080
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.68923282623291
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 123.901 Vali Acc: 0.120 Test Loss: 123.901 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.619112491607666
Epoch: 14, Steps: 13 | Train Loss: 0.395 Vali Loss: 114.043 Vali Acc: 0.120 Test Loss: 114.043 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 16456197
model size : 64.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.154250621795654
Epoch: 1, Steps: 13 | Train Loss: 5.160 Vali Loss: 10.796 Vali Acc: 0.140 Test Loss: 10.796 Test Acc: 0.140
Validation loss decreased (inf --> -0.139892).  Saving model ...
Epoch: 2 cost time: 2.6360034942626953
Epoch: 2, Steps: 13 | Train Loss: 3.507 Vali Loss: 48.933 Vali Acc: 0.200 Test Loss: 48.933 Test Acc: 0.200
Validation loss decreased (-0.139892 --> -0.199511).  Saving model ...
Epoch: 3 cost time: 2.6484031677246094
Epoch: 3, Steps: 13 | Train Loss: 1.722 Vali Loss: 33.000 Vali Acc: 0.180 Test Loss: 33.000 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.567798614501953
Epoch: 4, Steps: 13 | Train Loss: 0.169 Vali Loss: 37.628 Vali Acc: 0.220 Test Loss: 37.628 Test Acc: 0.220
Validation loss decreased (-0.199511 --> -0.219624).  Saving model ...
Epoch: 5 cost time: 2.676812171936035
Epoch: 5, Steps: 13 | Train Loss: 0.697 Vali Loss: 32.183 Vali Acc: 0.220 Test Loss: 32.183 Test Acc: 0.220
Validation loss decreased (-0.219624 --> -0.219678).  Saving model ...
Epoch: 6 cost time: 2.6347975730895996
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 40.320 Vali Acc: 0.120 Test Loss: 40.320 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.66916561126709
Epoch: 7, Steps: 13 | Train Loss: 0.322 Vali Loss: 60.007 Vali Acc: 0.160 Test Loss: 60.007 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.609575033187866
Epoch: 8, Steps: 13 | Train Loss: 1.236 Vali Loss: 43.868 Vali Acc: 0.100 Test Loss: 43.868 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.63478422164917
Epoch: 9, Steps: 13 | Train Loss: 2.098 Vali Loss: 69.298 Vali Acc: 0.160 Test Loss: 69.298 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.575629472732544
Epoch: 10, Steps: 13 | Train Loss: 3.733 Vali Loss: 108.588 Vali Acc: 0.180 Test Loss: 108.588 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.520878553390503
Epoch: 11, Steps: 13 | Train Loss: 5.722 Vali Loss: 62.622 Vali Acc: 0.220 Test Loss: 62.622 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.6135709285736084
Epoch: 12, Steps: 13 | Train Loss: 0.033 Vali Loss: 72.052 Vali Acc: 0.240 Test Loss: 72.052 Test Acc: 0.240
Validation loss decreased (-0.219678 --> -0.239279).  Saving model ...
Epoch: 13 cost time: 2.6506619453430176
Epoch: 13, Steps: 13 | Train Loss: 1.380 Vali Loss: 89.207 Vali Acc: 0.200 Test Loss: 89.207 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5544636249542236
Epoch: 14, Steps: 13 | Train Loss: 0.925 Vali Loss: 79.470 Vali Acc: 0.200 Test Loss: 79.470 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.7074620723724365
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 84.652 Vali Acc: 0.180 Test Loss: 84.652 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.6796088218688965
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 87.943 Vali Acc: 0.160 Test Loss: 87.943 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.753530263900757
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 89.137 Vali Acc: 0.160 Test Loss: 89.137 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5934457778930664
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 89.518 Vali Acc: 0.160 Test Loss: 89.518 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.71952486038208
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 89.505 Vali Acc: 0.160 Test Loss: 89.505 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.641829252243042
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 89.653 Vali Acc: 0.160 Test Loss: 89.653 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.6363539695739746
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 89.462 Vali Acc: 0.160 Test Loss: 89.462 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.643716812133789
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 89.655 Vali Acc: 0.160 Test Loss: 89.655 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 10431045
model size : 41.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df256_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.831808567047119
Epoch: 1, Steps: 13 | Train Loss: 4.017 Vali Loss: 12.684 Vali Acc: 0.120 Test Loss: 12.684 Test Acc: 0.120
Validation loss decreased (inf --> -0.119873).  Saving model ...
Epoch: 2 cost time: 2.315417766571045
Epoch: 2, Steps: 13 | Train Loss: 0.880 Vali Loss: 33.187 Vali Acc: 0.160 Test Loss: 33.187 Test Acc: 0.160
Validation loss decreased (-0.119873 --> -0.159668).  Saving model ...
Epoch: 3 cost time: 2.229320526123047
Epoch: 3, Steps: 13 | Train Loss: 1.916 Vali Loss: 24.583 Vali Acc: 0.220 Test Loss: 24.583 Test Acc: 0.220
Validation loss decreased (-0.159668 --> -0.219754).  Saving model ...
Epoch: 4 cost time: 2.284303665161133
Epoch: 4, Steps: 13 | Train Loss: 1.727 Vali Loss: 32.138 Vali Acc: 0.220 Test Loss: 32.138 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.372243881225586
Epoch: 5, Steps: 13 | Train Loss: 0.274 Vali Loss: 34.598 Vali Acc: 0.200 Test Loss: 34.598 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.303118944168091
Epoch: 6, Steps: 13 | Train Loss: 0.019 Vali Loss: 37.974 Vali Acc: 0.160 Test Loss: 37.974 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3517649173736572
Epoch: 7, Steps: 13 | Train Loss: 0.100 Vali Loss: 39.413 Vali Acc: 0.120 Test Loss: 39.413 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3822152614593506
Epoch: 8, Steps: 13 | Train Loss: 0.423 Vali Loss: 54.349 Vali Acc: 0.180 Test Loss: 54.349 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3792452812194824
Epoch: 9, Steps: 13 | Train Loss: 0.929 Vali Loss: 48.775 Vali Acc: 0.180 Test Loss: 48.775 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2328240871429443
Epoch: 10, Steps: 13 | Train Loss: 0.335 Vali Loss: 61.461 Vali Acc: 0.200 Test Loss: 61.461 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.4514834880828857
Epoch: 11, Steps: 13 | Train Loss: 4.876 Vali Loss: 86.702 Vali Acc: 0.200 Test Loss: 86.702 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.36140513420105
Epoch: 12, Steps: 13 | Train Loss: 3.384 Vali Loss: 62.832 Vali Acc: 0.220 Test Loss: 62.832 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3739452362060547
Epoch: 13, Steps: 13 | Train Loss: 2.662 Vali Loss: 75.697 Vali Acc: 0.220 Test Loss: 75.697 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df256_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 8279429
model size : 32.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2955451011657715
Epoch: 1, Steps: 13 | Train Loss: 2.371 Vali Loss: 6.431 Vali Acc: 0.180 Test Loss: 6.431 Test Acc: 0.180
Validation loss decreased (inf --> -0.179936).  Saving model ...
Epoch: 2 cost time: 1.825369119644165
Epoch: 2, Steps: 13 | Train Loss: 0.233 Vali Loss: 12.503 Vali Acc: 0.180 Test Loss: 12.503 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7419099807739258
Epoch: 3, Steps: 13 | Train Loss: 0.211 Vali Loss: 17.515 Vali Acc: 0.160 Test Loss: 17.515 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8010005950927734
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.593 Vali Acc: 0.140 Test Loss: 18.593 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8431713581085205
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.824 Vali Acc: 0.180 Test Loss: 18.824 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9718341827392578
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.979 Vali Acc: 0.180 Test Loss: 18.979 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.793053150177002
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.068 Vali Acc: 0.180 Test Loss: 19.068 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8673739433288574
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.054 Vali Acc: 0.180 Test Loss: 19.054 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.789172887802124
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.093 Vali Acc: 0.180 Test Loss: 19.093 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7639107704162598
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.061 Vali Acc: 0.180 Test Loss: 19.061 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7144269943237305
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.058 Vali Acc: 0.180 Test Loss: 19.058 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.18
model parameter : 5267525
model size : 21.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df256_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3584015369415283
Epoch: 1, Steps: 13 | Train Loss: 2.681 Vali Loss: 6.758 Vali Acc: 0.200 Test Loss: 6.758 Test Acc: 0.200
Validation loss decreased (inf --> -0.199932).  Saving model ...
Epoch: 2 cost time: 1.6636154651641846
Epoch: 2, Steps: 13 | Train Loss: 0.172 Vali Loss: 9.813 Vali Acc: 0.160 Test Loss: 9.813 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.622793197631836
Epoch: 3, Steps: 13 | Train Loss: 0.010 Vali Loss: 25.710 Vali Acc: 0.200 Test Loss: 25.710 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6897780895233154
Epoch: 4, Steps: 13 | Train Loss: 0.073 Vali Loss: 16.295 Vali Acc: 0.180 Test Loss: 16.295 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6991081237792969
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 20.891 Vali Acc: 0.180 Test Loss: 20.891 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5940139293670654
Epoch: 6, Steps: 13 | Train Loss: 0.030 Vali Loss: 15.398 Vali Acc: 0.140 Test Loss: 15.398 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.645935297012329
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.352 Vali Acc: 0.220 Test Loss: 18.352 Test Acc: 0.220
Validation loss decreased (-0.199932 --> -0.219816).  Saving model ...
Epoch: 8 cost time: 1.6062521934509277
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 20.008 Vali Acc: 0.200 Test Loss: 20.008 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7699174880981445
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 20.551 Vali Acc: 0.200 Test Loss: 20.551 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8140819072723389
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 20.706 Vali Acc: 0.200 Test Loss: 20.706 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7333343029022217
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 20.890 Vali Acc: 0.220 Test Loss: 20.890 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7183098793029785
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 20.716 Vali Acc: 0.220 Test Loss: 20.716 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7399189472198486
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 20.787 Vali Acc: 0.200 Test Loss: 20.787 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6559617519378662
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 20.629 Vali Acc: 0.200 Test Loss: 20.629 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6004526615142822
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 20.756 Vali Acc: 0.220 Test Loss: 20.756 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7305660247802734
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 20.748 Vali Acc: 0.200 Test Loss: 20.748 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6993975639343262
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 20.609 Vali Acc: 0.200 Test Loss: 20.609 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df256_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 4407557
model size : 18.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.111417293548584
Epoch: 1, Steps: 13 | Train Loss: 2.147 Vali Loss: 3.746 Vali Acc: 0.160 Test Loss: 3.746 Test Acc: 0.160
Validation loss decreased (inf --> -0.159963).  Saving model ...
Epoch: 2 cost time: 1.2648131847381592
Epoch: 2, Steps: 13 | Train Loss: 0.011 Vali Loss: 8.735 Vali Acc: 0.180 Test Loss: 8.735 Test Acc: 0.180
Validation loss decreased (-0.159963 --> -0.179913).  Saving model ...
Epoch: 3 cost time: 1.456702470779419
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.837 Vali Acc: 0.200 Test Loss: 8.837 Test Acc: 0.200
Validation loss decreased (-0.179913 --> -0.199912).  Saving model ...
Epoch: 4 cost time: 1.483689546585083
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.646 Vali Acc: 0.180 Test Loss: 8.646 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4280314445495605
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.852 Vali Acc: 0.200 Test Loss: 8.852 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.517484188079834
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.953 Vali Acc: 0.180 Test Loss: 8.953 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4426217079162598
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.984 Vali Acc: 0.180 Test Loss: 8.984 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4775078296661377
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.099 Vali Acc: 0.180 Test Loss: 9.099 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4556231498718262
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.960 Vali Acc: 0.180 Test Loss: 8.960 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4209370613098145
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.931 Vali Acc: 0.180 Test Loss: 8.931 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4863810539245605
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.946 Vali Acc: 0.180 Test Loss: 8.946 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4944696426391602
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.883 Vali Acc: 0.180 Test Loss: 8.883 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4123680591583252
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.840 Vali Acc: 0.180 Test Loss: 8.840 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 3117253
model size : 13.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 10.2017240524292
Epoch: 1, Steps: 25 | Train Loss: 43.944 Vali Loss: 98.664 Vali Acc: 0.200 Test Loss: 98.664 Test Acc: 0.200
Validation loss decreased (inf --> -0.199013).  Saving model ...
Epoch: 2 cost time: 8.316932916641235
Epoch: 2, Steps: 25 | Train Loss: 27.712 Vali Loss: 120.919 Vali Acc: 0.220 Test Loss: 120.919 Test Acc: 0.220
Validation loss decreased (-0.199013 --> -0.218791).  Saving model ...
Epoch: 3 cost time: 8.532979488372803
Epoch: 3, Steps: 25 | Train Loss: 25.813 Vali Loss: 177.756 Vali Acc: 0.140 Test Loss: 177.756 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.704252243041992
Epoch: 4, Steps: 25 | Train Loss: 3.842 Vali Loss: 439.776 Vali Acc: 0.200 Test Loss: 439.776 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.799456357955933
Epoch: 5, Steps: 25 | Train Loss: 10.606 Vali Loss: 283.814 Vali Acc: 0.160 Test Loss: 283.814 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.590518474578857
Epoch: 6, Steps: 25 | Train Loss: 4.808 Vali Loss: 203.734 Vali Acc: 0.260 Test Loss: 203.734 Test Acc: 0.260
Validation loss decreased (-0.218791 --> -0.257963).  Saving model ...
Epoch: 7 cost time: 8.607020616531372
Epoch: 7, Steps: 25 | Train Loss: 0.026 Vali Loss: 226.307 Vali Acc: 0.180 Test Loss: 226.307 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.541281700134277
Epoch: 8, Steps: 25 | Train Loss: 2.514 Vali Loss: 190.997 Vali Acc: 0.240 Test Loss: 190.997 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.697403192520142
Epoch: 9, Steps: 25 | Train Loss: 0.000 Vali Loss: 194.124 Vali Acc: 0.240 Test Loss: 194.124 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.849806547164917
Epoch: 10, Steps: 25 | Train Loss: 0.000 Vali Loss: 196.747 Vali Acc: 0.240 Test Loss: 196.747 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.662303447723389
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 195.345 Vali Acc: 0.240 Test Loss: 195.345 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.772586345672607
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 197.198 Vali Acc: 0.240 Test Loss: 197.198 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.809821605682373
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 193.950 Vali Acc: 0.240 Test Loss: 193.950 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.825621843338013
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 194.066 Vali Acc: 0.240 Test Loss: 194.066 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.47454023361206
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 196.719 Vali Acc: 0.240 Test Loss: 196.719 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.689549446105957
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 196.372 Vali Acc: 0.240 Test Loss: 196.372 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 28904325
model size : 111.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.112498044967651
Epoch: 1, Steps: 13 | Train Loss: 8.560 Vali Loss: 11.274 Vali Acc: 0.160 Test Loss: 11.274 Test Acc: 0.160
Validation loss decreased (inf --> -0.159887).  Saving model ...
Epoch: 2 cost time: 3.5901317596435547
Epoch: 2, Steps: 13 | Train Loss: 2.764 Vali Loss: 58.664 Vali Acc: 0.140 Test Loss: 58.664 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6871986389160156
Epoch: 3, Steps: 13 | Train Loss: 0.350 Vali Loss: 40.262 Vali Acc: 0.160 Test Loss: 40.262 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.641876697540283
Epoch: 4, Steps: 13 | Train Loss: 2.518 Vali Loss: 78.269 Vali Acc: 0.140 Test Loss: 78.269 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.53438663482666
Epoch: 5, Steps: 13 | Train Loss: 8.153 Vali Loss: 47.676 Vali Acc: 0.200 Test Loss: 47.676 Test Acc: 0.200
Validation loss decreased (-0.159887 --> -0.199523).  Saving model ...
Epoch: 6 cost time: 3.729804039001465
Epoch: 6, Steps: 13 | Train Loss: 1.982 Vali Loss: 120.768 Vali Acc: 0.200 Test Loss: 120.768 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7749264240264893
Epoch: 7, Steps: 13 | Train Loss: 2.550 Vali Loss: 95.798 Vali Acc: 0.240 Test Loss: 95.798 Test Acc: 0.240
Validation loss decreased (-0.199523 --> -0.239042).  Saving model ...
Epoch: 8 cost time: 3.6890299320220947
Epoch: 8, Steps: 13 | Train Loss: 2.859 Vali Loss: 137.929 Vali Acc: 0.220 Test Loss: 137.929 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8044776916503906
Epoch: 9, Steps: 13 | Train Loss: 0.766 Vali Loss: 117.338 Vali Acc: 0.100 Test Loss: 117.338 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.816347599029541
Epoch: 10, Steps: 13 | Train Loss: 2.089 Vali Loss: 124.460 Vali Acc: 0.120 Test Loss: 124.460 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.699187994003296
Epoch: 11, Steps: 13 | Train Loss: 2.603 Vali Loss: 232.137 Vali Acc: 0.200 Test Loss: 232.137 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.7347300052642822
Epoch: 12, Steps: 13 | Train Loss: 3.012 Vali Loss: 199.673 Vali Acc: 0.220 Test Loss: 199.673 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.6573195457458496
Epoch: 13, Steps: 13 | Train Loss: 0.968 Vali Loss: 147.158 Vali Acc: 0.120 Test Loss: 147.158 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.6440248489379883
Epoch: 14, Steps: 13 | Train Loss: 0.030 Vali Loss: 159.526 Vali Acc: 0.180 Test Loss: 159.526 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.777812957763672
Epoch: 15, Steps: 13 | Train Loss: 1.710 Vali Loss: 158.435 Vali Acc: 0.160 Test Loss: 158.435 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.6920907497406006
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 190.118 Vali Acc: 0.160 Test Loss: 190.118 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.7007598876953125
Epoch: 17, Steps: 13 | Train Loss: 2.072 Vali Loss: 174.311 Vali Acc: 0.180 Test Loss: 174.311 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 16423173
model size : 63.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.652989387512207
Epoch: 1, Steps: 13 | Train Loss: 4.330 Vali Loss: 7.694 Vali Acc: 0.200 Test Loss: 7.694 Test Acc: 0.200
Validation loss decreased (inf --> -0.199923).  Saving model ...
Epoch: 2 cost time: 2.207120418548584
Epoch: 2, Steps: 13 | Train Loss: 1.671 Vali Loss: 18.731 Vali Acc: 0.200 Test Loss: 18.731 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.288851022720337
Epoch: 3, Steps: 13 | Train Loss: 1.966 Vali Loss: 38.610 Vali Acc: 0.180 Test Loss: 38.610 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.278320550918579
Epoch: 4, Steps: 13 | Train Loss: 3.112 Vali Loss: 43.488 Vali Acc: 0.220 Test Loss: 43.488 Test Acc: 0.220
Validation loss decreased (-0.199923 --> -0.219565).  Saving model ...
Epoch: 5 cost time: 2.2721104621887207
Epoch: 5, Steps: 13 | Train Loss: 5.260 Vali Loss: 76.308 Vali Acc: 0.200 Test Loss: 76.308 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1522457599639893
Epoch: 6, Steps: 13 | Train Loss: 5.236 Vali Loss: 102.667 Vali Acc: 0.200 Test Loss: 102.667 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1953318119049072
Epoch: 7, Steps: 13 | Train Loss: 1.690 Vali Loss: 64.656 Vali Acc: 0.180 Test Loss: 64.656 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1587886810302734
Epoch: 8, Steps: 13 | Train Loss: 2.320 Vali Loss: 72.369 Vali Acc: 0.080 Test Loss: 72.369 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1508982181549072
Epoch: 9, Steps: 13 | Train Loss: 4.063 Vali Loss: 98.626 Vali Acc: 0.160 Test Loss: 98.626 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0991904735565186
Epoch: 10, Steps: 13 | Train Loss: 0.069 Vali Loss: 91.314 Vali Acc: 0.100 Test Loss: 91.314 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.245009660720825
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 98.359 Vali Acc: 0.100 Test Loss: 98.359 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1942861080169678
Epoch: 12, Steps: 13 | Train Loss: 0.414 Vali Loss: 88.439 Vali Acc: 0.120 Test Loss: 88.439 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.186476230621338
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 94.671 Vali Acc: 0.200 Test Loss: 94.671 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.238734483718872
Epoch: 14, Steps: 13 | Train Loss: 0.276 Vali Loss: 88.413 Vali Acc: 0.160 Test Loss: 88.413 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 10398021
model size : 40.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df128_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5636746883392334
Epoch: 1, Steps: 13 | Train Loss: 3.836 Vali Loss: 10.375 Vali Acc: 0.180 Test Loss: 10.375 Test Acc: 0.180
Validation loss decreased (inf --> -0.179896).  Saving model ...
Epoch: 2 cost time: 2.19303560256958
Epoch: 2, Steps: 13 | Train Loss: 1.437 Vali Loss: 20.016 Vali Acc: 0.140 Test Loss: 20.016 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.108988046646118
Epoch: 3, Steps: 13 | Train Loss: 0.490 Vali Loss: 26.944 Vali Acc: 0.140 Test Loss: 26.944 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.082232713699341
Epoch: 4, Steps: 13 | Train Loss: 0.063 Vali Loss: 36.341 Vali Acc: 0.180 Test Loss: 36.341 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.069030284881592
Epoch: 5, Steps: 13 | Train Loss: 0.262 Vali Loss: 31.648 Vali Acc: 0.180 Test Loss: 31.648 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1381654739379883
Epoch: 6, Steps: 13 | Train Loss: 0.611 Vali Loss: 35.530 Vali Acc: 0.180 Test Loss: 35.530 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0761170387268066
Epoch: 7, Steps: 13 | Train Loss: 0.586 Vali Loss: 45.257 Vali Acc: 0.140 Test Loss: 45.257 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1162283420562744
Epoch: 8, Steps: 13 | Train Loss: 0.076 Vali Loss: 41.272 Vali Acc: 0.140 Test Loss: 41.272 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1479289531707764
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 43.609 Vali Acc: 0.120 Test Loss: 43.609 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.1060707569122314
Epoch: 10, Steps: 13 | Train Loss: 0.234 Vali Loss: 37.905 Vali Acc: 0.140 Test Loss: 37.905 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.0439653396606445
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 54.292 Vali Acc: 0.180 Test Loss: 54.292 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df128_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.18
model parameter : 8246405
model size : 32.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.184277057647705
Epoch: 1, Steps: 13 | Train Loss: 3.105 Vali Loss: 3.327 Vali Acc: 0.220 Test Loss: 3.327 Test Acc: 0.220
Validation loss decreased (inf --> -0.219967).  Saving model ...
Epoch: 2 cost time: 1.591568946838379
Epoch: 2, Steps: 13 | Train Loss: 0.533 Vali Loss: 11.510 Vali Acc: 0.140 Test Loss: 11.510 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6035187244415283
Epoch: 3, Steps: 13 | Train Loss: 0.374 Vali Loss: 18.872 Vali Acc: 0.160 Test Loss: 18.872 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5683541297912598
Epoch: 4, Steps: 13 | Train Loss: 0.077 Vali Loss: 20.233 Vali Acc: 0.180 Test Loss: 20.233 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5725429058074951
Epoch: 5, Steps: 13 | Train Loss: 1.227 Vali Loss: 22.780 Vali Acc: 0.160 Test Loss: 22.780 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5473811626434326
Epoch: 6, Steps: 13 | Train Loss: 0.964 Vali Loss: 34.967 Vali Acc: 0.160 Test Loss: 34.967 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6818797588348389
Epoch: 7, Steps: 13 | Train Loss: 0.027 Vali Loss: 27.949 Vali Acc: 0.180 Test Loss: 27.949 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6491732597351074
Epoch: 8, Steps: 13 | Train Loss: 0.061 Vali Loss: 31.196 Vali Acc: 0.160 Test Loss: 31.196 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6304147243499756
Epoch: 9, Steps: 13 | Train Loss: 0.248 Vali Loss: 43.765 Vali Acc: 0.140 Test Loss: 43.765 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.544863224029541
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 43.669 Vali Acc: 0.200 Test Loss: 43.669 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5301001071929932
Epoch: 11, Steps: 13 | Train Loss: 0.189 Vali Loss: 40.349 Vali Acc: 0.240 Test Loss: 40.349 Test Acc: 0.240
Validation loss decreased (-0.219967 --> -0.239597).  Saving model ...
Epoch: 12 cost time: 1.558656930923462
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 45.426 Vali Acc: 0.220 Test Loss: 45.426 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6216986179351807
Epoch: 13, Steps: 13 | Train Loss: 0.029 Vali Loss: 51.646 Vali Acc: 0.240 Test Loss: 51.646 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5317542552947998
Epoch: 14, Steps: 13 | Train Loss: 0.989 Vali Loss: 52.025 Vali Acc: 0.200 Test Loss: 52.025 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5483808517456055
Epoch: 15, Steps: 13 | Train Loss: 0.234 Vali Loss: 50.446 Vali Acc: 0.240 Test Loss: 50.446 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5312836170196533
Epoch: 16, Steps: 13 | Train Loss: 0.029 Vali Loss: 48.123 Vali Acc: 0.260 Test Loss: 48.123 Test Acc: 0.260
Validation loss decreased (-0.239597 --> -0.259519).  Saving model ...
Epoch: 17 cost time: 1.5576293468475342
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 50.980 Vali Acc: 0.240 Test Loss: 50.980 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6934106349945068
Epoch: 18, Steps: 13 | Train Loss: 0.175 Vali Loss: 60.467 Vali Acc: 0.180 Test Loss: 60.467 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5889575481414795
Epoch: 19, Steps: 13 | Train Loss: 0.715 Vali Loss: 70.090 Vali Acc: 0.180 Test Loss: 70.090 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6868350505828857
Epoch: 20, Steps: 13 | Train Loss: 0.549 Vali Loss: 65.170 Vali Acc: 0.240 Test Loss: 65.170 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8443257808685303
Epoch: 21, Steps: 13 | Train Loss: 3.483 Vali Loss: 92.406 Vali Acc: 0.200 Test Loss: 92.406 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6970627307891846
Epoch: 22, Steps: 13 | Train Loss: 1.374 Vali Loss: 119.694 Vali Acc: 0.120 Test Loss: 119.694 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5942680835723877
Epoch: 23, Steps: 13 | Train Loss: 2.114 Vali Loss: 138.582 Vali Acc: 0.160 Test Loss: 138.582 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6596269607543945
Epoch: 24, Steps: 13 | Train Loss: 0.665 Vali Loss: 106.033 Vali Acc: 0.180 Test Loss: 106.033 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.631028413772583
Epoch: 25, Steps: 13 | Train Loss: 1.664 Vali Loss: 103.223 Vali Acc: 0.240 Test Loss: 103.223 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6019315719604492
Epoch: 26, Steps: 13 | Train Loss: 0.201 Vali Loss: 97.243 Vali Acc: 0.200 Test Loss: 97.243 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 5234501
model size : 21.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df128_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2273313999176025
Epoch: 1, Steps: 13 | Train Loss: 2.581 Vali Loss: 7.540 Vali Acc: 0.180 Test Loss: 7.540 Test Acc: 0.180
Validation loss decreased (inf --> -0.179925).  Saving model ...
Epoch: 2 cost time: 1.5603785514831543
Epoch: 2, Steps: 13 | Train Loss: 0.139 Vali Loss: 12.922 Vali Acc: 0.200 Test Loss: 12.922 Test Acc: 0.200
Validation loss decreased (-0.179925 --> -0.199871).  Saving model ...
Epoch: 3 cost time: 1.5663468837738037
Epoch: 3, Steps: 13 | Train Loss: 0.058 Vali Loss: 11.392 Vali Acc: 0.200 Test Loss: 11.392 Test Acc: 0.200
Validation loss decreased (-0.199871 --> -0.199886).  Saving model ...
Epoch: 4 cost time: 1.5623042583465576
Epoch: 4, Steps: 13 | Train Loss: 0.002 Vali Loss: 16.172 Vali Acc: 0.160 Test Loss: 16.172 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5523223876953125
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.237 Vali Acc: 0.200 Test Loss: 16.237 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5319914817810059
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.150 Vali Acc: 0.200 Test Loss: 16.150 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5882415771484375
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.033 Vali Acc: 0.200 Test Loss: 16.033 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6893484592437744
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 15.842 Vali Acc: 0.200 Test Loss: 15.842 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6183369159698486
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.024 Vali Acc: 0.200 Test Loss: 16.024 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7401273250579834
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.153 Vali Acc: 0.200 Test Loss: 16.153 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5321204662322998
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.139 Vali Acc: 0.200 Test Loss: 16.139 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.632018804550171
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.146 Vali Acc: 0.200 Test Loss: 16.146 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5765407085418701
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.128 Vali Acc: 0.200 Test Loss: 16.128 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df128_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 4374533
model size : 17.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0510902404785156
Epoch: 1, Steps: 13 | Train Loss: 2.085 Vali Loss: 3.134 Vali Acc: 0.140 Test Loss: 3.134 Test Acc: 0.140
Validation loss decreased (inf --> -0.139969).  Saving model ...
Epoch: 2 cost time: 1.2170298099517822
Epoch: 2, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.716 Vali Acc: 0.160 Test Loss: 6.716 Test Acc: 0.160
Validation loss decreased (-0.139969 --> -0.159933).  Saving model ...
Epoch: 3 cost time: 1.1722393035888672
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.054 Vali Acc: 0.160 Test Loss: 8.054 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.288426399230957
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.488 Vali Acc: 0.180 Test Loss: 8.488 Test Acc: 0.180
Validation loss decreased (-0.159933 --> -0.179915).  Saving model ...
Epoch: 5 cost time: 1.2563672065734863
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.699 Vali Acc: 0.180 Test Loss: 8.699 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2657654285430908
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.701 Vali Acc: 0.160 Test Loss: 8.701 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2816298007965088
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.722 Vali Acc: 0.160 Test Loss: 8.722 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.297792673110962
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.756 Vali Acc: 0.160 Test Loss: 8.756 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3525803089141846
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.722 Vali Acc: 0.160 Test Loss: 8.722 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.308122158050537
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.755 Vali Acc: 0.160 Test Loss: 8.755 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2625956535339355
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.784 Vali Acc: 0.160 Test Loss: 8.784 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2314727306365967
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.760 Vali Acc: 0.160 Test Loss: 8.760 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.307835578918457
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.649 Vali Acc: 0.160 Test Loss: 8.649 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.252121925354004
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.667 Vali Acc: 0.160 Test Loss: 8.667 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.18
model parameter : 3084229
model size : 13.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 9.780447959899902
Epoch: 1, Steps: 25 | Train Loss: 41.672 Vali Loss: 56.920 Vali Acc: 0.260 Test Loss: 56.920 Test Acc: 0.260
Validation loss decreased (inf --> -0.259431).  Saving model ...
Epoch: 2 cost time: 8.13684892654419
Epoch: 2, Steps: 25 | Train Loss: 24.268 Vali Loss: 124.114 Vali Acc: 0.140 Test Loss: 124.114 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.135644674301147
Epoch: 3, Steps: 25 | Train Loss: 6.487 Vali Loss: 126.989 Vali Acc: 0.180 Test Loss: 126.989 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.50290560722351
Epoch: 4, Steps: 25 | Train Loss: 0.625 Vali Loss: 194.047 Vali Acc: 0.160 Test Loss: 194.047 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.246536016464233
Epoch: 5, Steps: 25 | Train Loss: 12.742 Vali Loss: 177.962 Vali Acc: 0.180 Test Loss: 177.962 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.369955062866211
Epoch: 6, Steps: 25 | Train Loss: 17.451 Vali Loss: 280.204 Vali Acc: 0.180 Test Loss: 280.204 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.254987955093384
Epoch: 7, Steps: 25 | Train Loss: 18.795 Vali Loss: 269.945 Vali Acc: 0.180 Test Loss: 269.945 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.269830703735352
Epoch: 8, Steps: 25 | Train Loss: 7.831 Vali Loss: 238.154 Vali Acc: 0.220 Test Loss: 238.154 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.345895290374756
Epoch: 9, Steps: 25 | Train Loss: 10.348 Vali Loss: 186.701 Vali Acc: 0.120 Test Loss: 186.701 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.393825054168701
Epoch: 10, Steps: 25 | Train Loss: 9.794 Vali Loss: 311.992 Vali Acc: 0.220 Test Loss: 311.992 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.23080062866211
Epoch: 11, Steps: 25 | Train Loss: 7.051 Vali Loss: 220.654 Vali Acc: 0.180 Test Loss: 220.654 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 28887813
model size : 111.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.076580762863159
Epoch: 1, Steps: 13 | Train Loss: 7.362 Vali Loss: 24.561 Vali Acc: 0.180 Test Loss: 24.561 Test Acc: 0.180
Validation loss decreased (inf --> -0.179754).  Saving model ...
Epoch: 2 cost time: 3.334484100341797
Epoch: 2, Steps: 13 | Train Loss: 1.414 Vali Loss: 30.238 Vali Acc: 0.200 Test Loss: 30.238 Test Acc: 0.200
Validation loss decreased (-0.179754 --> -0.199698).  Saving model ...
Epoch: 3 cost time: 3.394270658493042
Epoch: 3, Steps: 13 | Train Loss: 5.998 Vali Loss: 57.310 Vali Acc: 0.220 Test Loss: 57.310 Test Acc: 0.220
Validation loss decreased (-0.199698 --> -0.219427).  Saving model ...
Epoch: 4 cost time: 3.263110399246216
Epoch: 4, Steps: 13 | Train Loss: 1.554 Vali Loss: 58.032 Vali Acc: 0.160 Test Loss: 58.032 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4720089435577393
Epoch: 5, Steps: 13 | Train Loss: 0.161 Vali Loss: 57.758 Vali Acc: 0.200 Test Loss: 57.758 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2864856719970703
Epoch: 6, Steps: 13 | Train Loss: 1.988 Vali Loss: 94.369 Vali Acc: 0.200 Test Loss: 94.369 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.426130533218384
Epoch: 7, Steps: 13 | Train Loss: 0.508 Vali Loss: 89.785 Vali Acc: 0.200 Test Loss: 89.785 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.3294169902801514
Epoch: 8, Steps: 13 | Train Loss: 5.874 Vali Loss: 128.873 Vali Acc: 0.160 Test Loss: 128.873 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.3611371517181396
Epoch: 9, Steps: 13 | Train Loss: 0.237 Vali Loss: 99.936 Vali Acc: 0.200 Test Loss: 99.936 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.4993906021118164
Epoch: 10, Steps: 13 | Train Loss: 6.885 Vali Loss: 91.918 Vali Acc: 0.140 Test Loss: 91.918 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.4032657146453857
Epoch: 11, Steps: 13 | Train Loss: 4.833 Vali Loss: 104.153 Vali Acc: 0.140 Test Loss: 104.153 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.4147937297821045
Epoch: 12, Steps: 13 | Train Loss: 1.864 Vali Loss: 175.733 Vali Acc: 0.100 Test Loss: 175.733 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.454277276992798
Epoch: 13, Steps: 13 | Train Loss: 8.507 Vali Loss: 169.773 Vali Acc: 0.260 Test Loss: 169.773 Test Acc: 0.260
Validation loss decreased (-0.219427 --> -0.258302).  Saving model ...
Epoch: 14 cost time: 3.371382713317871
Epoch: 14, Steps: 13 | Train Loss: 23.078 Vali Loss: 198.792 Vali Acc: 0.180 Test Loss: 198.792 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.429014205932617
Epoch: 15, Steps: 13 | Train Loss: 2.067 Vali Loss: 176.218 Vali Acc: 0.140 Test Loss: 176.218 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4800379276275635
Epoch: 16, Steps: 13 | Train Loss: 3.531 Vali Loss: 164.985 Vali Acc: 0.120 Test Loss: 164.985 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5221359729766846
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 224.589 Vali Acc: 0.140 Test Loss: 224.589 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.3722095489501953
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 232.906 Vali Acc: 0.160 Test Loss: 232.906 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.359706163406372
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 206.904 Vali Acc: 0.180 Test Loss: 206.904 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.513827323913574
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 227.555 Vali Acc: 0.140 Test Loss: 227.555 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.3520562648773193
Epoch: 21, Steps: 13 | Train Loss: 0.544 Vali Loss: 213.060 Vali Acc: 0.200 Test Loss: 213.060 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.4113235473632812
Epoch: 22, Steps: 13 | Train Loss: 1.252 Vali Loss: 223.222 Vali Acc: 0.140 Test Loss: 223.222 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.3122406005859375
Epoch: 23, Steps: 13 | Train Loss: 0.432 Vali Loss: 293.153 Vali Acc: 0.200 Test Loss: 293.153 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 16406661
model size : 63.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7992103099823
Epoch: 1, Steps: 13 | Train Loss: 4.252 Vali Loss: 18.136 Vali Acc: 0.200 Test Loss: 18.136 Test Acc: 0.200
Validation loss decreased (inf --> -0.199819).  Saving model ...
Epoch: 2 cost time: 2.2107059955596924
Epoch: 2, Steps: 13 | Train Loss: 1.260 Vali Loss: 20.365 Vali Acc: 0.240 Test Loss: 20.365 Test Acc: 0.240
Validation loss decreased (-0.199819 --> -0.239796).  Saving model ...
Epoch: 3 cost time: 2.2863028049468994
Epoch: 3, Steps: 13 | Train Loss: 1.199 Vali Loss: 34.836 Vali Acc: 0.180 Test Loss: 34.836 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2165727615356445
Epoch: 4, Steps: 13 | Train Loss: 2.197 Vali Loss: 47.987 Vali Acc: 0.180 Test Loss: 47.987 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2650904655456543
Epoch: 5, Steps: 13 | Train Loss: 1.091 Vali Loss: 55.882 Vali Acc: 0.160 Test Loss: 55.882 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3246235847473145
Epoch: 6, Steps: 13 | Train Loss: 2.416 Vali Loss: 73.662 Vali Acc: 0.180 Test Loss: 73.662 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.29313063621521
Epoch: 7, Steps: 13 | Train Loss: 2.748 Vali Loss: 45.412 Vali Acc: 0.240 Test Loss: 45.412 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.349027633666992
Epoch: 8, Steps: 13 | Train Loss: 1.641 Vali Loss: 81.054 Vali Acc: 0.180 Test Loss: 81.054 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.411656618118286
Epoch: 9, Steps: 13 | Train Loss: 5.482 Vali Loss: 129.573 Vali Acc: 0.180 Test Loss: 129.573 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.2156283855438232
Epoch: 10, Steps: 13 | Train Loss: 4.913 Vali Loss: 91.820 Vali Acc: 0.220 Test Loss: 91.820 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.3023316860198975
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 89.256 Vali Acc: 0.240 Test Loss: 89.256 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.258530855178833
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 94.016 Vali Acc: 0.200 Test Loss: 94.016 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 10381509
model size : 40.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df64_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.836965799331665
Epoch: 1, Steps: 13 | Train Loss: 4.074 Vali Loss: 13.342 Vali Acc: 0.200 Test Loss: 13.342 Test Acc: 0.200
Validation loss decreased (inf --> -0.199867).  Saving model ...
Epoch: 2 cost time: 1.9568021297454834
Epoch: 2, Steps: 13 | Train Loss: 1.798 Vali Loss: 19.329 Vali Acc: 0.180 Test Loss: 19.329 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.043287992477417
Epoch: 3, Steps: 13 | Train Loss: 0.627 Vali Loss: 22.425 Vali Acc: 0.180 Test Loss: 22.425 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9358406066894531
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 25.619 Vali Acc: 0.140 Test Loss: 25.619 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9935593605041504
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.495 Vali Acc: 0.180 Test Loss: 23.495 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9551682472229004
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.325 Vali Acc: 0.180 Test Loss: 23.325 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.85701322555542
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.349 Vali Acc: 0.180 Test Loss: 23.349 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0294740200042725
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.339 Vali Acc: 0.180 Test Loss: 23.339 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.3149805068969727
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.271 Vali Acc: 0.160 Test Loss: 23.271 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.0601234436035156
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.217 Vali Acc: 0.160 Test Loss: 23.217 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.0267257690429688
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.235 Vali Acc: 0.180 Test Loss: 23.235 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df64_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 8229893
model size : 32.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0108213424682617
Epoch: 1, Steps: 13 | Train Loss: 2.307 Vali Loss: 4.840 Vali Acc: 0.120 Test Loss: 4.840 Test Acc: 0.120
Validation loss decreased (inf --> -0.119952).  Saving model ...
Epoch: 2 cost time: 1.5523948669433594
Epoch: 2, Steps: 13 | Train Loss: 0.244 Vali Loss: 16.092 Vali Acc: 0.160 Test Loss: 16.092 Test Acc: 0.160
Validation loss decreased (-0.119952 --> -0.159839).  Saving model ...
Epoch: 3 cost time: 1.665198564529419
Epoch: 3, Steps: 13 | Train Loss: 0.608 Vali Loss: 24.445 Vali Acc: 0.200 Test Loss: 24.445 Test Acc: 0.200
Validation loss decreased (-0.159839 --> -0.199756).  Saving model ...
Epoch: 4 cost time: 1.4932525157928467
Epoch: 4, Steps: 13 | Train Loss: 0.489 Vali Loss: 21.508 Vali Acc: 0.180 Test Loss: 21.508 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5413532257080078
Epoch: 5, Steps: 13 | Train Loss: 1.304 Vali Loss: 44.469 Vali Acc: 0.200 Test Loss: 44.469 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4629700183868408
Epoch: 6, Steps: 13 | Train Loss: 1.074 Vali Loss: 32.046 Vali Acc: 0.180 Test Loss: 32.046 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.46114182472229
Epoch: 7, Steps: 13 | Train Loss: 0.491 Vali Loss: 25.560 Vali Acc: 0.200 Test Loss: 25.560 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4695837497711182
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 35.975 Vali Acc: 0.160 Test Loss: 35.975 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5705981254577637
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 38.561 Vali Acc: 0.180 Test Loss: 38.561 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.573047161102295
Epoch: 10, Steps: 13 | Train Loss: 0.445 Vali Loss: 46.641 Vali Acc: 0.180 Test Loss: 46.641 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4908921718597412
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 57.090 Vali Acc: 0.160 Test Loss: 57.090 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6774320602416992
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 48.210 Vali Acc: 0.200 Test Loss: 48.210 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6135528087615967
Epoch: 13, Steps: 13 | Train Loss: 0.647 Vali Loss: 42.399 Vali Acc: 0.220 Test Loss: 42.399 Test Acc: 0.220
Validation loss decreased (-0.199756 --> -0.219576).  Saving model ...
Epoch: 14 cost time: 1.5762286186218262
Epoch: 14, Steps: 13 | Train Loss: 1.515 Vali Loss: 53.563 Vali Acc: 0.200 Test Loss: 53.563 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.594696044921875
Epoch: 15, Steps: 13 | Train Loss: 0.263 Vali Loss: 55.139 Vali Acc: 0.180 Test Loss: 55.139 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5764739513397217
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 64.500 Vali Acc: 0.220 Test Loss: 64.500 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6824805736541748
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 68.900 Vali Acc: 0.240 Test Loss: 68.900 Test Acc: 0.240
Validation loss decreased (-0.219576 --> -0.239311).  Saving model ...
Epoch: 18 cost time: 1.5369017124176025
Epoch: 18, Steps: 13 | Train Loss: 0.045 Vali Loss: 61.673 Vali Acc: 0.200 Test Loss: 61.673 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5440592765808105
Epoch: 19, Steps: 13 | Train Loss: 0.718 Vali Loss: 67.176 Vali Acc: 0.200 Test Loss: 67.176 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6456925868988037
Epoch: 20, Steps: 13 | Train Loss: 0.864 Vali Loss: 102.244 Vali Acc: 0.160 Test Loss: 102.244 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5626320838928223
Epoch: 21, Steps: 13 | Train Loss: 1.866 Vali Loss: 100.310 Vali Acc: 0.180 Test Loss: 100.310 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.544064998626709
Epoch: 22, Steps: 13 | Train Loss: 1.312 Vali Loss: 90.119 Vali Acc: 0.180 Test Loss: 90.119 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5176403522491455
Epoch: 23, Steps: 13 | Train Loss: 0.847 Vali Loss: 95.190 Vali Acc: 0.200 Test Loss: 95.190 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.604614496231079
Epoch: 24, Steps: 13 | Train Loss: 0.255 Vali Loss: 92.436 Vali Acc: 0.180 Test Loss: 92.436 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.570068597793579
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 108.769 Vali Acc: 0.200 Test Loss: 108.769 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6758532524108887
Epoch: 26, Steps: 13 | Train Loss: 0.013 Vali Loss: 110.927 Vali Acc: 0.200 Test Loss: 110.927 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5911481380462646
Epoch: 27, Steps: 13 | Train Loss: 0.056 Vali Loss: 108.550 Vali Acc: 0.140 Test Loss: 108.550 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 5217989
model size : 21.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df64_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.236292600631714
Epoch: 1, Steps: 13 | Train Loss: 2.407 Vali Loss: 5.192 Vali Acc: 0.180 Test Loss: 5.192 Test Acc: 0.180
Validation loss decreased (inf --> -0.179948).  Saving model ...
Epoch: 2 cost time: 1.5438010692596436
Epoch: 2, Steps: 13 | Train Loss: 0.006 Vali Loss: 8.025 Vali Acc: 0.140 Test Loss: 8.025 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4827172756195068
Epoch: 3, Steps: 13 | Train Loss: 0.094 Vali Loss: 11.670 Vali Acc: 0.120 Test Loss: 11.670 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5310542583465576
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.073 Vali Acc: 0.160 Test Loss: 18.073 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4995651245117188
Epoch: 5, Steps: 13 | Train Loss: 0.149 Vali Loss: 17.538 Vali Acc: 0.180 Test Loss: 17.538 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4843668937683105
Epoch: 6, Steps: 13 | Train Loss: 0.341 Vali Loss: 13.685 Vali Acc: 0.220 Test Loss: 13.685 Test Acc: 0.220
Validation loss decreased (-0.179948 --> -0.219863).  Saving model ...
Epoch: 7 cost time: 1.4806797504425049
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 25.237 Vali Acc: 0.220 Test Loss: 25.237 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4513440132141113
Epoch: 8, Steps: 13 | Train Loss: 0.362 Vali Loss: 28.060 Vali Acc: 0.160 Test Loss: 28.060 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.496917963027954
Epoch: 9, Steps: 13 | Train Loss: 0.552 Vali Loss: 29.212 Vali Acc: 0.200 Test Loss: 29.212 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4086782932281494
Epoch: 10, Steps: 13 | Train Loss: 1.046 Vali Loss: 47.073 Vali Acc: 0.180 Test Loss: 47.073 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5250661373138428
Epoch: 11, Steps: 13 | Train Loss: 0.616 Vali Loss: 50.266 Vali Acc: 0.180 Test Loss: 50.266 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4561114311218262
Epoch: 12, Steps: 13 | Train Loss: 1.911 Vali Loss: 51.729 Vali Acc: 0.180 Test Loss: 51.729 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4332001209259033
Epoch: 13, Steps: 13 | Train Loss: 0.192 Vali Loss: 48.504 Vali Acc: 0.240 Test Loss: 48.504 Test Acc: 0.240
Validation loss decreased (-0.219863 --> -0.239515).  Saving model ...
Epoch: 14 cost time: 1.4208719730377197
Epoch: 14, Steps: 13 | Train Loss: 0.159 Vali Loss: 49.611 Vali Acc: 0.260 Test Loss: 49.611 Test Acc: 0.260
Validation loss decreased (-0.239515 --> -0.259504).  Saving model ...
Epoch: 15 cost time: 1.4646430015563965
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 44.932 Vali Acc: 0.240 Test Loss: 44.932 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5172879695892334
Epoch: 16, Steps: 13 | Train Loss: 0.100 Vali Loss: 45.704 Vali Acc: 0.260 Test Loss: 45.704 Test Acc: 0.260
Validation loss decreased (-0.259504 --> -0.259543).  Saving model ...
Epoch: 17 cost time: 1.4479711055755615
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 54.869 Vali Acc: 0.220 Test Loss: 54.869 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3877956867218018
Epoch: 18, Steps: 13 | Train Loss: 0.019 Vali Loss: 44.573 Vali Acc: 0.240 Test Loss: 44.573 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5452394485473633
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 46.963 Vali Acc: 0.220 Test Loss: 46.963 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4604551792144775
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.395 Vali Acc: 0.220 Test Loss: 48.395 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5215582847595215
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.558 Vali Acc: 0.200 Test Loss: 48.558 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.548196792602539
Epoch: 22, Steps: 13 | Train Loss: 0.001 Vali Loss: 50.928 Vali Acc: 0.260 Test Loss: 50.928 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5365245342254639
Epoch: 23, Steps: 13 | Train Loss: 0.160 Vali Loss: 56.563 Vali Acc: 0.260 Test Loss: 56.563 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3744971752166748
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 58.447 Vali Acc: 0.240 Test Loss: 58.447 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.563767671585083
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 61.688 Vali Acc: 0.240 Test Loss: 61.688 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5213751792907715
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 61.698 Vali Acc: 0.220 Test Loss: 61.698 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df64_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 4358021
model size : 17.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.253838300704956
Epoch: 1, Steps: 13 | Train Loss: 2.280 Vali Loss: 3.970 Vali Acc: 0.160 Test Loss: 3.970 Test Acc: 0.160
Validation loss decreased (inf --> -0.159960).  Saving model ...
Epoch: 2 cost time: 1.5748803615570068
Epoch: 2, Steps: 13 | Train Loss: 0.070 Vali Loss: 7.988 Vali Acc: 0.200 Test Loss: 7.988 Test Acc: 0.200
Validation loss decreased (-0.159960 --> -0.199920).  Saving model ...
Epoch: 3 cost time: 1.3437752723693848
Epoch: 3, Steps: 13 | Train Loss: 0.003 Vali Loss: 8.549 Vali Acc: 0.200 Test Loss: 8.549 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4406845569610596
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.773 Vali Acc: 0.160 Test Loss: 11.773 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4315369129180908
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.418 Vali Acc: 0.160 Test Loss: 16.418 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3228447437286377
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.667 Vali Acc: 0.140 Test Loss: 12.667 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.437148094177246
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.447 Vali Acc: 0.180 Test Loss: 12.447 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4795758724212646
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.306 Vali Acc: 0.180 Test Loss: 12.306 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4408903121948242
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.252 Vali Acc: 0.160 Test Loss: 12.252 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4181909561157227
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.166 Vali Acc: 0.180 Test Loss: 12.166 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4741017818450928
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.195 Vali Acc: 0.180 Test Loss: 12.195 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.458505392074585
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.121 Vali Acc: 0.180 Test Loss: 12.121 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm64_nh16_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 3067717
model size : 12.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.740193128585815
Epoch: 1, Steps: 25 | Train Loss: 16.723 Vali Loss: 26.302 Vali Acc: 0.180 Test Loss: 26.302 Test Acc: 0.180
Validation loss decreased (inf --> -0.179737).  Saving model ...
Epoch: 2 cost time: 4.151944637298584
Epoch: 2, Steps: 25 | Train Loss: 16.701 Vali Loss: 96.441 Vali Acc: 0.240 Test Loss: 96.441 Test Acc: 0.240
Validation loss decreased (-0.179737 --> -0.239036).  Saving model ...
Epoch: 3 cost time: 4.194643974304199
Epoch: 3, Steps: 25 | Train Loss: 11.007 Vali Loss: 137.808 Vali Acc: 0.180 Test Loss: 137.808 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.371107339859009
Epoch: 4, Steps: 25 | Train Loss: 11.222 Vali Loss: 135.644 Vali Acc: 0.160 Test Loss: 135.644 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.202767848968506
Epoch: 5, Steps: 25 | Train Loss: 9.927 Vali Loss: 129.985 Vali Acc: 0.180 Test Loss: 129.985 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.178432464599609
Epoch: 6, Steps: 25 | Train Loss: 1.133 Vali Loss: 102.661 Vali Acc: 0.200 Test Loss: 102.661 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.261071681976318
Epoch: 7, Steps: 25 | Train Loss: 1.864 Vali Loss: 158.000 Vali Acc: 0.160 Test Loss: 158.000 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.240730047225952
Epoch: 8, Steps: 25 | Train Loss: 1.307 Vali Loss: 175.981 Vali Acc: 0.200 Test Loss: 175.981 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.216131687164307
Epoch: 9, Steps: 25 | Train Loss: 0.000 Vali Loss: 92.989 Vali Acc: 0.240 Test Loss: 92.989 Test Acc: 0.240
Validation loss decreased (-0.239036 --> -0.239070).  Saving model ...
Epoch: 10 cost time: 4.291416883468628
Epoch: 10, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.177 Vali Acc: 0.260 Test Loss: 91.177 Test Acc: 0.260
Validation loss decreased (-0.239070 --> -0.259088).  Saving model ...
Epoch: 11 cost time: 4.305790901184082
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.317 Vali Acc: 0.260 Test Loss: 91.317 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.368954181671143
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.178 Vali Acc: 0.240 Test Loss: 90.178 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.334359645843506
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.901 Vali Acc: 0.260 Test Loss: 91.901 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.298538684844971
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.442 Vali Acc: 0.260 Test Loss: 91.442 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.29856538772583
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 89.761 Vali Acc: 0.240 Test Loss: 89.761 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.412919521331787
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.194 Vali Acc: 0.240 Test Loss: 90.194 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.264347791671753
Epoch: 17, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.242 Vali Acc: 0.260 Test Loss: 91.242 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.290741205215454
Epoch: 18, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.612 Vali Acc: 0.260 Test Loss: 90.612 Test Acc: 0.260
Validation loss decreased (-0.259088 --> -0.259094).  Saving model ...
Epoch: 19 cost time: 4.202113389968872
Epoch: 19, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.356 Vali Acc: 0.240 Test Loss: 90.356 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.212069988250732
Epoch: 20, Steps: 25 | Train Loss: 0.000 Vali Loss: 89.350 Vali Acc: 0.240 Test Loss: 89.350 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.299049139022827
Epoch: 21, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.504 Vali Acc: 0.260 Test Loss: 90.504 Test Acc: 0.260
Validation loss decreased (-0.259094 --> -0.259095).  Saving model ...
Epoch: 22 cost time: 4.301808834075928
Epoch: 22, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.211 Vali Acc: 0.240 Test Loss: 90.211 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.252203941345215
Epoch: 23, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.055 Vali Acc: 0.260 Test Loss: 91.055 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.323947191238403
Epoch: 24, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.475 Vali Acc: 0.260 Test Loss: 90.475 Test Acc: 0.260
Validation loss decreased (-0.259095 --> -0.259095).  Saving model ...
Epoch: 25 cost time: 4.215204238891602
Epoch: 25, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.317 Vali Acc: 0.240 Test Loss: 90.317 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.311034440994263
Epoch: 26, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.875 Vali Acc: 0.260 Test Loss: 90.875 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.360091686248779
Epoch: 27, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.904 Vali Acc: 0.260 Test Loss: 90.904 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.271868944168091
Epoch: 28, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.578 Vali Acc: 0.260 Test Loss: 90.578 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.266600847244263
Epoch: 29, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.091 Vali Acc: 0.260 Test Loss: 91.091 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.188457012176514
Epoch: 30, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.366 Vali Acc: 0.240 Test Loss: 90.366 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.327454328536987
Epoch: 31, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.406 Vali Acc: 0.260 Test Loss: 90.406 Test Acc: 0.260
Validation loss decreased (-0.259095 --> -0.259096).  Saving model ...
Epoch: 32 cost time: 4.27924370765686
Epoch: 32, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.314 Vali Acc: 0.260 Test Loss: 90.314 Test Acc: 0.260
Validation loss decreased (-0.259096 --> -0.259097).  Saving model ...
Epoch: 33 cost time: 4.3068554401397705
Epoch: 33, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.972 Vali Acc: 0.260 Test Loss: 90.972 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.330078840255737
Epoch: 34, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.970 Vali Acc: 0.260 Test Loss: 90.970 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.340149641036987
Epoch: 35, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.266 Vali Acc: 0.240 Test Loss: 90.266 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.275936841964722
Epoch: 36, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.584 Vali Acc: 0.260 Test Loss: 91.584 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.34468674659729
Epoch: 37, Steps: 25 | Train Loss: 0.000 Vali Loss: 89.974 Vali Acc: 0.240 Test Loss: 89.974 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 4.277446508407593
Epoch: 38, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.032 Vali Acc: 0.240 Test Loss: 90.032 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 4.302501916885376
Epoch: 39, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.193 Vali Acc: 0.260 Test Loss: 91.193 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 4.212106227874756
Epoch: 40, Steps: 25 | Train Loss: 0.000 Vali Loss: 89.324 Vali Acc: 0.240 Test Loss: 89.324 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 4.471879243850708
Epoch: 41, Steps: 25 | Train Loss: 0.000 Vali Loss: 90.940 Vali Acc: 0.260 Test Loss: 90.940 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 4.331169366836548
Epoch: 42, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.514 Vali Acc: 0.260 Test Loss: 91.514 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 14460741
model size : 55.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.164135217666626
Epoch: 1, Steps: 13 | Train Loss: 4.362 Vali Loss: 11.119 Vali Acc: 0.200 Test Loss: 11.119 Test Acc: 0.200
Validation loss decreased (inf --> -0.199889).  Saving model ...
Epoch: 2 cost time: 2.5343074798583984
Epoch: 2, Steps: 13 | Train Loss: 0.546 Vali Loss: 26.165 Vali Acc: 0.200 Test Loss: 26.165 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.644575834274292
Epoch: 3, Steps: 13 | Train Loss: 1.633 Vali Loss: 21.881 Vali Acc: 0.200 Test Loss: 21.881 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.54876971244812
Epoch: 4, Steps: 13 | Train Loss: 0.529 Vali Loss: 55.685 Vali Acc: 0.200 Test Loss: 55.685 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5963082313537598
Epoch: 5, Steps: 13 | Train Loss: 1.640 Vali Loss: 59.627 Vali Acc: 0.200 Test Loss: 59.627 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5190751552581787
Epoch: 6, Steps: 13 | Train Loss: 6.360 Vali Loss: 57.055 Vali Acc: 0.180 Test Loss: 57.055 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.573103666305542
Epoch: 7, Steps: 13 | Train Loss: 3.116 Vali Loss: 38.715 Vali Acc: 0.260 Test Loss: 38.715 Test Acc: 0.260
Validation loss decreased (-0.199889 --> -0.259613).  Saving model ...
Epoch: 8 cost time: 2.7375993728637695
Epoch: 8, Steps: 13 | Train Loss: 3.954 Vali Loss: 54.397 Vali Acc: 0.140 Test Loss: 54.397 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5863027572631836
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 94.306 Vali Acc: 0.200 Test Loss: 94.306 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.682955026626587
Epoch: 10, Steps: 13 | Train Loss: 3.687 Vali Loss: 56.724 Vali Acc: 0.140 Test Loss: 56.724 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6622276306152344
Epoch: 11, Steps: 13 | Train Loss: 0.031 Vali Loss: 68.701 Vali Acc: 0.160 Test Loss: 68.701 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.571455240249634
Epoch: 12, Steps: 13 | Train Loss: 0.227 Vali Loss: 88.835 Vali Acc: 0.160 Test Loss: 88.835 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6130993366241455
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 108.236 Vali Acc: 0.200 Test Loss: 108.236 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7811293601989746
Epoch: 14, Steps: 13 | Train Loss: 0.132 Vali Loss: 75.682 Vali Acc: 0.160 Test Loss: 75.682 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.578733205795288
Epoch: 15, Steps: 13 | Train Loss: 0.780 Vali Loss: 79.938 Vali Acc: 0.140 Test Loss: 79.938 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.580773115158081
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 99.028 Vali Acc: 0.180 Test Loss: 99.028 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.717482328414917
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 114.120 Vali Acc: 0.180 Test Loss: 114.120 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 8220165
model size : 31.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4746336936950684
Epoch: 1, Steps: 13 | Train Loss: 2.771 Vali Loss: 9.107 Vali Acc: 0.180 Test Loss: 9.107 Test Acc: 0.180
Validation loss decreased (inf --> -0.179909).  Saving model ...
Epoch: 2 cost time: 1.7362060546875
Epoch: 2, Steps: 13 | Train Loss: 0.596 Vali Loss: 12.152 Vali Acc: 0.180 Test Loss: 12.152 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7356178760528564
Epoch: 3, Steps: 13 | Train Loss: 0.086 Vali Loss: 17.868 Vali Acc: 0.200 Test Loss: 17.868 Test Acc: 0.200
Validation loss decreased (-0.179909 --> -0.199821).  Saving model ...
Epoch: 4 cost time: 1.7177410125732422
Epoch: 4, Steps: 13 | Train Loss: 0.001 Vali Loss: 17.968 Vali Acc: 0.200 Test Loss: 17.968 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6101417541503906
Epoch: 5, Steps: 13 | Train Loss: 0.191 Vali Loss: 21.334 Vali Acc: 0.160 Test Loss: 21.334 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6485176086425781
Epoch: 6, Steps: 13 | Train Loss: 1.941 Vali Loss: 32.529 Vali Acc: 0.180 Test Loss: 32.529 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6328530311584473
Epoch: 7, Steps: 13 | Train Loss: 0.448 Vali Loss: 22.474 Vali Acc: 0.220 Test Loss: 22.474 Test Acc: 0.220
Validation loss decreased (-0.199821 --> -0.219775).  Saving model ...
Epoch: 8 cost time: 1.7724695205688477
Epoch: 8, Steps: 13 | Train Loss: 1.429 Vali Loss: 29.326 Vali Acc: 0.140 Test Loss: 29.326 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7478342056274414
Epoch: 9, Steps: 13 | Train Loss: 2.258 Vali Loss: 42.965 Vali Acc: 0.220 Test Loss: 42.965 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8702757358551025
Epoch: 10, Steps: 13 | Train Loss: 0.312 Vali Loss: 36.482 Vali Acc: 0.260 Test Loss: 36.482 Test Acc: 0.260
Validation loss decreased (-0.219775 --> -0.259635).  Saving model ...
Epoch: 11 cost time: 1.7709121704101562
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 35.947 Vali Acc: 0.160 Test Loss: 35.947 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7248117923736572
Epoch: 12, Steps: 13 | Train Loss: 0.011 Vali Loss: 28.868 Vali Acc: 0.120 Test Loss: 28.868 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.73514723777771
Epoch: 13, Steps: 13 | Train Loss: 0.100 Vali Loss: 46.487 Vali Acc: 0.180 Test Loss: 46.487 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.753915786743164
Epoch: 14, Steps: 13 | Train Loss: 0.849 Vali Loss: 51.631 Vali Acc: 0.220 Test Loss: 51.631 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.804948329925537
Epoch: 15, Steps: 13 | Train Loss: 1.905 Vali Loss: 92.439 Vali Acc: 0.220 Test Loss: 92.439 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7797048091888428
Epoch: 16, Steps: 13 | Train Loss: 0.664 Vali Loss: 58.057 Vali Acc: 0.160 Test Loss: 58.057 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7526869773864746
Epoch: 17, Steps: 13 | Train Loss: 1.046 Vali Loss: 61.279 Vali Acc: 0.120 Test Loss: 61.279 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7423758506774902
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 61.187 Vali Acc: 0.160 Test Loss: 61.187 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7772362232208252
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 61.388 Vali Acc: 0.140 Test Loss: 61.388 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8276309967041016
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 61.294 Vali Acc: 0.140 Test Loss: 61.294 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 5207589
model size : 20.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df256_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2439727783203125
Epoch: 1, Steps: 13 | Train Loss: 2.897 Vali Loss: 3.728 Vali Acc: 0.140 Test Loss: 3.728 Test Acc: 0.140
Validation loss decreased (inf --> -0.139963).  Saving model ...
Epoch: 2 cost time: 1.569873571395874
Epoch: 2, Steps: 13 | Train Loss: 0.112 Vali Loss: 9.538 Vali Acc: 0.180 Test Loss: 9.538 Test Acc: 0.180
Validation loss decreased (-0.139963 --> -0.179905).  Saving model ...
Epoch: 3 cost time: 1.6128506660461426
Epoch: 3, Steps: 13 | Train Loss: 0.392 Vali Loss: 24.866 Vali Acc: 0.200 Test Loss: 24.866 Test Acc: 0.200
Validation loss decreased (-0.179905 --> -0.199751).  Saving model ...
Epoch: 4 cost time: 1.680877685546875
Epoch: 4, Steps: 13 | Train Loss: 1.256 Vali Loss: 17.366 Vali Acc: 0.160 Test Loss: 17.366 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.627335548400879
Epoch: 5, Steps: 13 | Train Loss: 0.301 Vali Loss: 31.616 Vali Acc: 0.200 Test Loss: 31.616 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6358458995819092
Epoch: 6, Steps: 13 | Train Loss: 0.562 Vali Loss: 37.118 Vali Acc: 0.180 Test Loss: 37.118 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6494603157043457
Epoch: 7, Steps: 13 | Train Loss: 0.548 Vali Loss: 49.034 Vali Acc: 0.160 Test Loss: 49.034 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5256941318511963
Epoch: 8, Steps: 13 | Train Loss: 0.482 Vali Loss: 33.398 Vali Acc: 0.200 Test Loss: 33.398 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7204322814941406
Epoch: 9, Steps: 13 | Train Loss: 0.705 Vali Loss: 35.513 Vali Acc: 0.140 Test Loss: 35.513 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4759531021118164
Epoch: 10, Steps: 13 | Train Loss: 0.107 Vali Loss: 31.829 Vali Acc: 0.140 Test Loss: 31.829 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6390323638916016
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 36.783 Vali Acc: 0.180 Test Loss: 36.783 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7018954753875732
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 31.475 Vali Acc: 0.140 Test Loss: 31.475 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6370632648468018
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 37.335 Vali Acc: 0.200 Test Loss: 37.335 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df256_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 4131781
model size : 16.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.458634853363037
Epoch: 1, Steps: 13 | Train Loss: 1.824 Vali Loss: 3.634 Vali Acc: 0.180 Test Loss: 3.634 Test Acc: 0.180
Validation loss decreased (inf --> -0.179964).  Saving model ...
Epoch: 2 cost time: 1.368417501449585
Epoch: 2, Steps: 13 | Train Loss: 0.059 Vali Loss: 5.648 Vali Acc: 0.240 Test Loss: 5.648 Test Acc: 0.240
Validation loss decreased (-0.179964 --> -0.239944).  Saving model ...
Epoch: 3 cost time: 1.3925936222076416
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.021 Vali Acc: 0.200 Test Loss: 9.021 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3453655242919922
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.569 Vali Acc: 0.220 Test Loss: 9.569 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.370258092880249
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.685 Vali Acc: 0.200 Test Loss: 9.685 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.579897165298462
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.700 Vali Acc: 0.200 Test Loss: 9.700 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2620749473571777
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.671 Vali Acc: 0.200 Test Loss: 9.671 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.398878812789917
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.661 Vali Acc: 0.200 Test Loss: 9.661 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3780927658081055
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.618 Vali Acc: 0.200 Test Loss: 9.618 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2818500995635986
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.577 Vali Acc: 0.200 Test Loss: 9.577 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4072966575622559
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.557 Vali Acc: 0.200 Test Loss: 9.557 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.358069896697998
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.543 Vali Acc: 0.200 Test Loss: 9.543 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 2625829
model size : 10.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df256_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0811729431152344
Epoch: 1, Steps: 13 | Train Loss: 2.070 Vali Loss: 3.161 Vali Acc: 0.180 Test Loss: 3.161 Test Acc: 0.180
Validation loss decreased (inf --> -0.179968).  Saving model ...
Epoch: 2 cost time: 1.286238193511963
Epoch: 2, Steps: 13 | Train Loss: 0.021 Vali Loss: 5.743 Vali Acc: 0.160 Test Loss: 5.743 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2943041324615479
Epoch: 3, Steps: 13 | Train Loss: 0.006 Vali Loss: 6.106 Vali Acc: 0.100 Test Loss: 6.106 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4234414100646973
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.769 Vali Acc: 0.240 Test Loss: 7.769 Test Acc: 0.240
Validation loss decreased (-0.179968 --> -0.239922).  Saving model ...
Epoch: 5 cost time: 1.2702467441558838
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.616 Vali Acc: 0.220 Test Loss: 8.616 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1921522617340088
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.621 Vali Acc: 0.220 Test Loss: 8.621 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.233954668045044
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.504 Vali Acc: 0.220 Test Loss: 8.504 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3707354068756104
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.364 Vali Acc: 0.200 Test Loss: 8.364 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4453957080841064
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.306 Vali Acc: 0.200 Test Loss: 8.306 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3797268867492676
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.291 Vali Acc: 0.200 Test Loss: 8.291 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3261992931365967
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.224 Vali Acc: 0.200 Test Loss: 8.224 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3681817054748535
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.205 Vali Acc: 0.200 Test Loss: 8.205 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4211413860321045
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.193 Vali Acc: 0.200 Test Loss: 8.193 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4153738021850586
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.201 Vali Acc: 0.200 Test Loss: 8.201 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df256_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 2195845
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3468871116638184
Epoch: 1, Steps: 13 | Train Loss: 2.023 Vali Loss: 2.583 Vali Acc: 0.180 Test Loss: 2.583 Test Acc: 0.180
Validation loss decreased (inf --> -0.179974).  Saving model ...
Epoch: 2 cost time: 1.225372314453125
Epoch: 2, Steps: 13 | Train Loss: 0.026 Vali Loss: 5.322 Vali Acc: 0.180 Test Loss: 5.322 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0900392532348633
Epoch: 3, Steps: 13 | Train Loss: 0.002 Vali Loss: 5.597 Vali Acc: 0.200 Test Loss: 5.597 Test Acc: 0.200
Validation loss decreased (-0.179974 --> -0.199944).  Saving model ...
Epoch: 4 cost time: 1.1692712306976318
Epoch: 4, Steps: 13 | Train Loss: 0.001 Vali Loss: 5.789 Vali Acc: 0.140 Test Loss: 5.789 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2310667037963867
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.796 Vali Acc: 0.180 Test Loss: 8.796 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.187826156616211
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.998 Vali Acc: 0.180 Test Loss: 7.998 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2330126762390137
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.644 Vali Acc: 0.200 Test Loss: 6.644 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2586886882781982
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.455 Vali Acc: 0.200 Test Loss: 7.455 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.276066541671753
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.241 Vali Acc: 0.160 Test Loss: 7.241 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.329268455505371
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.004 Vali Acc: 0.200 Test Loss: 7.004 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3448257446289062
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.962 Vali Acc: 0.200 Test Loss: 6.962 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.341925859451294
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.931 Vali Acc: 0.200 Test Loss: 6.931 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2796876430511475
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.927 Vali Acc: 0.200 Test Loss: 6.927 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 1550693
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.737803936004639
Epoch: 1, Steps: 25 | Train Loss: 21.951 Vali Loss: 50.722 Vali Acc: 0.200 Test Loss: 50.722 Test Acc: 0.200
Validation loss decreased (inf --> -0.199493).  Saving model ...
Epoch: 2 cost time: 3.8009402751922607
Epoch: 2, Steps: 25 | Train Loss: 14.979 Vali Loss: 95.709 Vali Acc: 0.200 Test Loss: 95.709 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.0690529346466064
Epoch: 3, Steps: 25 | Train Loss: 3.299 Vali Loss: 60.690 Vali Acc: 0.200 Test Loss: 60.690 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.278465747833252
Epoch: 4, Steps: 25 | Train Loss: 5.859 Vali Loss: 67.531 Vali Acc: 0.140 Test Loss: 67.531 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.8504977226257324
Epoch: 5, Steps: 25 | Train Loss: 9.433 Vali Loss: 184.359 Vali Acc: 0.160 Test Loss: 184.359 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.8333590030670166
Epoch: 6, Steps: 25 | Train Loss: 19.477 Vali Loss: 93.117 Vali Acc: 0.140 Test Loss: 93.117 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.0067596435546875
Epoch: 7, Steps: 25 | Train Loss: 5.347 Vali Loss: 170.886 Vali Acc: 0.180 Test Loss: 170.886 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.943594217300415
Epoch: 8, Steps: 25 | Train Loss: 1.701 Vali Loss: 123.146 Vali Acc: 0.160 Test Loss: 123.146 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.988710880279541
Epoch: 9, Steps: 25 | Train Loss: 7.783 Vali Loss: 238.478 Vali Acc: 0.200 Test Loss: 238.478 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.940579891204834
Epoch: 10, Steps: 25 | Train Loss: 0.226 Vali Loss: 226.386 Vali Acc: 0.200 Test Loss: 226.386 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.847733736038208
Epoch: 11, Steps: 25 | Train Loss: 2.393 Vali Loss: 136.079 Vali Acc: 0.180 Test Loss: 136.079 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 14444101
model size : 55.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.108813762664795
Epoch: 1, Steps: 13 | Train Loss: 4.836 Vali Loss: 19.545 Vali Acc: 0.200 Test Loss: 19.545 Test Acc: 0.200
Validation loss decreased (inf --> -0.199805).  Saving model ...
Epoch: 2 cost time: 2.4274210929870605
Epoch: 2, Steps: 13 | Train Loss: 5.071 Vali Loss: 37.734 Vali Acc: 0.200 Test Loss: 37.734 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3601958751678467
Epoch: 3, Steps: 13 | Train Loss: 1.354 Vali Loss: 37.553 Vali Acc: 0.180 Test Loss: 37.553 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3177335262298584
Epoch: 4, Steps: 13 | Train Loss: 0.642 Vali Loss: 44.396 Vali Acc: 0.220 Test Loss: 44.396 Test Acc: 0.220
Validation loss decreased (-0.199805 --> -0.219556).  Saving model ...
Epoch: 5 cost time: 2.4242258071899414
Epoch: 5, Steps: 13 | Train Loss: 0.754 Vali Loss: 89.177 Vali Acc: 0.200 Test Loss: 89.177 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.415628433227539
Epoch: 6, Steps: 13 | Train Loss: 1.454 Vali Loss: 65.953 Vali Acc: 0.220 Test Loss: 65.953 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3790159225463867
Epoch: 7, Steps: 13 | Train Loss: 7.283 Vali Loss: 54.486 Vali Acc: 0.140 Test Loss: 54.486 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.297783136367798
Epoch: 8, Steps: 13 | Train Loss: 3.336 Vali Loss: 91.851 Vali Acc: 0.200 Test Loss: 91.851 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3548498153686523
Epoch: 9, Steps: 13 | Train Loss: 0.142 Vali Loss: 80.724 Vali Acc: 0.180 Test Loss: 80.724 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4021084308624268
Epoch: 10, Steps: 13 | Train Loss: 5.800 Vali Loss: 89.505 Vali Acc: 0.180 Test Loss: 89.505 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2997970581054688
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 66.437 Vali Acc: 0.120 Test Loss: 66.437 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4013495445251465
Epoch: 12, Steps: 13 | Train Loss: 0.463 Vali Loss: 97.039 Vali Acc: 0.240 Test Loss: 97.039 Test Acc: 0.240
Validation loss decreased (-0.219556 --> -0.239030).  Saving model ...
Epoch: 13 cost time: 2.207148313522339
Epoch: 13, Steps: 13 | Train Loss: 0.570 Vali Loss: 95.941 Vali Acc: 0.180 Test Loss: 95.941 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3219263553619385
Epoch: 14, Steps: 13 | Train Loss: 1.788 Vali Loss: 93.322 Vali Acc: 0.140 Test Loss: 93.322 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.389822244644165
Epoch: 15, Steps: 13 | Train Loss: 0.489 Vali Loss: 78.144 Vali Acc: 0.140 Test Loss: 78.144 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3048365116119385
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 105.416 Vali Acc: 0.120 Test Loss: 105.416 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4829649925231934
Epoch: 17, Steps: 13 | Train Loss: 0.324 Vali Loss: 112.500 Vali Acc: 0.200 Test Loss: 112.500 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3470280170440674
Epoch: 18, Steps: 13 | Train Loss: 1.190 Vali Loss: 100.291 Vali Acc: 0.120 Test Loss: 100.291 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.444521188735962
Epoch: 19, Steps: 13 | Train Loss: 0.357 Vali Loss: 99.472 Vali Acc: 0.120 Test Loss: 99.472 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.350210666656494
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 120.002 Vali Acc: 0.180 Test Loss: 120.002 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.362928628921509
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 130.605 Vali Acc: 0.160 Test Loss: 130.605 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4760496616363525
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 112.417 Vali Acc: 0.200 Test Loss: 112.417 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 8203525
model size : 31.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3542003631591797
Epoch: 1, Steps: 13 | Train Loss: 3.816 Vali Loss: 7.774 Vali Acc: 0.200 Test Loss: 7.774 Test Acc: 0.200
Validation loss decreased (inf --> -0.199922).  Saving model ...
Epoch: 2 cost time: 1.5921883583068848
Epoch: 2, Steps: 13 | Train Loss: 1.719 Vali Loss: 17.409 Vali Acc: 0.200 Test Loss: 17.409 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6285862922668457
Epoch: 3, Steps: 13 | Train Loss: 0.047 Vali Loss: 16.818 Vali Acc: 0.180 Test Loss: 16.818 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6181104183197021
Epoch: 4, Steps: 13 | Train Loss: 0.502 Vali Loss: 29.857 Vali Acc: 0.240 Test Loss: 29.857 Test Acc: 0.240
Validation loss decreased (-0.199922 --> -0.239701).  Saving model ...
Epoch: 5 cost time: 1.5735325813293457
Epoch: 5, Steps: 13 | Train Loss: 0.817 Vali Loss: 30.635 Vali Acc: 0.100 Test Loss: 30.635 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6449992656707764
Epoch: 6, Steps: 13 | Train Loss: 0.123 Vali Loss: 29.734 Vali Acc: 0.220 Test Loss: 29.734 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8235423564910889
Epoch: 7, Steps: 13 | Train Loss: 0.940 Vali Loss: 33.677 Vali Acc: 0.180 Test Loss: 33.677 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6460154056549072
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 29.699 Vali Acc: 0.180 Test Loss: 29.699 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.616652011871338
Epoch: 9, Steps: 13 | Train Loss: 0.192 Vali Loss: 32.749 Vali Acc: 0.180 Test Loss: 32.749 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7095739841461182
Epoch: 10, Steps: 13 | Train Loss: 1.187 Vali Loss: 29.384 Vali Acc: 0.180 Test Loss: 29.384 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6736667156219482
Epoch: 11, Steps: 13 | Train Loss: 0.872 Vali Loss: 28.431 Vali Acc: 0.180 Test Loss: 28.431 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5761840343475342
Epoch: 12, Steps: 13 | Train Loss: 0.792 Vali Loss: 62.151 Vali Acc: 0.100 Test Loss: 62.151 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7003872394561768
Epoch: 13, Steps: 13 | Train Loss: 1.678 Vali Loss: 42.346 Vali Acc: 0.140 Test Loss: 42.346 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6169815063476562
Epoch: 14, Steps: 13 | Train Loss: 0.545 Vali Loss: 44.753 Vali Acc: 0.160 Test Loss: 44.753 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 5190949
model size : 20.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df128_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.609840154647827
Epoch: 1, Steps: 13 | Train Loss: 2.385 Vali Loss: 7.675 Vali Acc: 0.140 Test Loss: 7.675 Test Acc: 0.140
Validation loss decreased (inf --> -0.139923).  Saving model ...
Epoch: 2 cost time: 1.4286072254180908
Epoch: 2, Steps: 13 | Train Loss: 0.133 Vali Loss: 12.554 Vali Acc: 0.120 Test Loss: 12.554 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4233620166778564
Epoch: 3, Steps: 13 | Train Loss: 0.054 Vali Loss: 13.490 Vali Acc: 0.220 Test Loss: 13.490 Test Acc: 0.220
Validation loss decreased (-0.139923 --> -0.219865).  Saving model ...
Epoch: 4 cost time: 1.6085362434387207
Epoch: 4, Steps: 13 | Train Loss: 0.119 Vali Loss: 13.907 Vali Acc: 0.120 Test Loss: 13.907 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5499653816223145
Epoch: 5, Steps: 13 | Train Loss: 0.629 Vali Loss: 29.619 Vali Acc: 0.220 Test Loss: 29.619 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.566467046737671
Epoch: 6, Steps: 13 | Train Loss: 0.002 Vali Loss: 19.240 Vali Acc: 0.060 Test Loss: 19.240 Test Acc: 0.060
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6134684085845947
Epoch: 7, Steps: 13 | Train Loss: 0.054 Vali Loss: 26.130 Vali Acc: 0.200 Test Loss: 26.130 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5453264713287354
Epoch: 8, Steps: 13 | Train Loss: 0.295 Vali Loss: 26.397 Vali Acc: 0.120 Test Loss: 26.397 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6694958209991455
Epoch: 9, Steps: 13 | Train Loss: 0.144 Vali Loss: 36.745 Vali Acc: 0.180 Test Loss: 36.745 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4952659606933594
Epoch: 10, Steps: 13 | Train Loss: 0.593 Vali Loss: 32.975 Vali Acc: 0.160 Test Loss: 32.975 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5395290851593018
Epoch: 11, Steps: 13 | Train Loss: 0.038 Vali Loss: 33.809 Vali Acc: 0.180 Test Loss: 33.809 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.490499496459961
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 39.982 Vali Acc: 0.220 Test Loss: 39.982 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5392718315124512
Epoch: 13, Steps: 13 | Train Loss: 0.209 Vali Loss: 40.387 Vali Acc: 0.180 Test Loss: 40.387 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df128_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 4115141
model size : 16.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2277817726135254
Epoch: 1, Steps: 13 | Train Loss: 2.226 Vali Loss: 3.121 Vali Acc: 0.160 Test Loss: 3.121 Test Acc: 0.160
Validation loss decreased (inf --> -0.159969).  Saving model ...
Epoch: 2 cost time: 1.3479640483856201
Epoch: 2, Steps: 13 | Train Loss: 0.007 Vali Loss: 5.820 Vali Acc: 0.180 Test Loss: 5.820 Test Acc: 0.180
Validation loss decreased (-0.159969 --> -0.179942).  Saving model ...
Epoch: 3 cost time: 1.360708236694336
Epoch: 3, Steps: 13 | Train Loss: 0.011 Vali Loss: 10.535 Vali Acc: 0.200 Test Loss: 10.535 Test Acc: 0.200
Validation loss decreased (-0.179942 --> -0.199895).  Saving model ...
Epoch: 4 cost time: 1.1853318214416504
Epoch: 4, Steps: 13 | Train Loss: 0.004 Vali Loss: 10.132 Vali Acc: 0.120 Test Loss: 10.132 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.169060468673706
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 13.562 Vali Acc: 0.180 Test Loss: 13.562 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.20967698097229
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.221 Vali Acc: 0.220 Test Loss: 9.221 Test Acc: 0.220
Validation loss decreased (-0.199895 --> -0.219908).  Saving model ...
Epoch: 7 cost time: 1.2192144393920898
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.432 Vali Acc: 0.200 Test Loss: 17.432 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2097206115722656
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 18.019 Vali Acc: 0.160 Test Loss: 18.019 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1616897583007812
Epoch: 9, Steps: 13 | Train Loss: 0.254 Vali Loss: 18.163 Vali Acc: 0.200 Test Loss: 18.163 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4114422798156738
Epoch: 10, Steps: 13 | Train Loss: 1.118 Vali Loss: 19.056 Vali Acc: 0.200 Test Loss: 19.056 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1953070163726807
Epoch: 11, Steps: 13 | Train Loss: 1.044 Vali Loss: 19.547 Vali Acc: 0.200 Test Loss: 19.547 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1609373092651367
Epoch: 12, Steps: 13 | Train Loss: 0.036 Vali Loss: 26.131 Vali Acc: 0.240 Test Loss: 26.131 Test Acc: 0.240
Validation loss decreased (-0.219908 --> -0.239739).  Saving model ...
Epoch: 13 cost time: 1.138298749923706
Epoch: 13, Steps: 13 | Train Loss: 0.092 Vali Loss: 20.550 Vali Acc: 0.200 Test Loss: 20.550 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.341902256011963
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.771 Vali Acc: 0.220 Test Loss: 19.771 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3817942142486572
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.566 Vali Acc: 0.220 Test Loss: 19.566 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3438835144042969
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.420 Vali Acc: 0.200 Test Loss: 19.420 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2647149562835693
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.352 Vali Acc: 0.200 Test Loss: 19.352 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2819409370422363
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.336 Vali Acc: 0.240 Test Loss: 19.336 Test Acc: 0.240
Validation loss decreased (-0.239739 --> -0.239807).  Saving model ...
Epoch: 19 cost time: 1.192338228225708
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.389 Vali Acc: 0.240 Test Loss: 19.389 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.306074857711792
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.373 Vali Acc: 0.240 Test Loss: 19.373 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.150491714477539
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.408 Vali Acc: 0.240 Test Loss: 19.408 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.250126838684082
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.513 Vali Acc: 0.240 Test Loss: 19.513 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3810410499572754
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.434 Vali Acc: 0.240 Test Loss: 19.434 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2670493125915527
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.427 Vali Acc: 0.240 Test Loss: 19.427 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3364453315734863
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.409 Vali Acc: 0.240 Test Loss: 19.409 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2280583381652832
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.410 Vali Acc: 0.240 Test Loss: 19.410 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2745451927185059
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.461 Vali Acc: 0.240 Test Loss: 19.461 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2835400104522705
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.459 Vali Acc: 0.240 Test Loss: 19.459 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 2609189
model size : 10.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df128_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.907780885696411
Epoch: 1, Steps: 13 | Train Loss: 2.394 Vali Loss: 2.547 Vali Acc: 0.160 Test Loss: 2.547 Test Acc: 0.160
Validation loss decreased (inf --> -0.159975).  Saving model ...
Epoch: 2 cost time: 1.187110185623169
Epoch: 2, Steps: 13 | Train Loss: 0.199 Vali Loss: 6.195 Vali Acc: 0.200 Test Loss: 6.195 Test Acc: 0.200
Validation loss decreased (-0.159975 --> -0.199938).  Saving model ...
Epoch: 3 cost time: 1.1945464611053467
Epoch: 3, Steps: 13 | Train Loss: 0.615 Vali Loss: 8.085 Vali Acc: 0.180 Test Loss: 8.085 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4268131256103516
Epoch: 4, Steps: 13 | Train Loss: 0.066 Vali Loss: 12.593 Vali Acc: 0.140 Test Loss: 12.593 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.362572431564331
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 13.168 Vali Acc: 0.200 Test Loss: 13.168 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2385475635528564
Epoch: 6, Steps: 13 | Train Loss: 0.001 Vali Loss: 14.560 Vali Acc: 0.120 Test Loss: 14.560 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3873810768127441
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.288 Vali Acc: 0.220 Test Loss: 14.288 Test Acc: 0.220
Validation loss decreased (-0.199938 --> -0.219857).  Saving model ...
Epoch: 8 cost time: 1.2914409637451172
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 12.390 Vali Acc: 0.240 Test Loss: 12.390 Test Acc: 0.240
Validation loss decreased (-0.219857 --> -0.239876).  Saving model ...
Epoch: 9 cost time: 1.2539422512054443
Epoch: 9, Steps: 13 | Train Loss: 0.015 Vali Loss: 13.362 Vali Acc: 0.160 Test Loss: 13.362 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2345526218414307
Epoch: 10, Steps: 13 | Train Loss: 0.039 Vali Loss: 10.874 Vali Acc: 0.240 Test Loss: 10.874 Test Acc: 0.240
Validation loss decreased (-0.239876 --> -0.239891).  Saving model ...
Epoch: 11 cost time: 1.2261242866516113
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 13.045 Vali Acc: 0.240 Test Loss: 13.045 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2236778736114502
Epoch: 12, Steps: 13 | Train Loss: 0.008 Vali Loss: 10.369 Vali Acc: 0.280 Test Loss: 10.369 Test Acc: 0.280
Validation loss decreased (-0.239891 --> -0.279896).  Saving model ...
Epoch: 13 cost time: 1.4389772415161133
Epoch: 13, Steps: 13 | Train Loss: 0.302 Vali Loss: 12.601 Vali Acc: 0.400 Test Loss: 12.601 Test Acc: 0.400
Validation loss decreased (-0.279896 --> -0.399874).  Saving model ...
Epoch: 14 cost time: 1.285247802734375
Epoch: 14, Steps: 13 | Train Loss: 0.269 Vali Loss: 19.681 Vali Acc: 0.260 Test Loss: 19.681 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2972636222839355
Epoch: 15, Steps: 13 | Train Loss: 0.422 Vali Loss: 26.513 Vali Acc: 0.220 Test Loss: 26.513 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3089122772216797
Epoch: 16, Steps: 13 | Train Loss: 0.256 Vali Loss: 25.016 Vali Acc: 0.160 Test Loss: 25.016 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2156388759613037
Epoch: 17, Steps: 13 | Train Loss: 0.312 Vali Loss: 26.846 Vali Acc: 0.220 Test Loss: 26.846 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2428011894226074
Epoch: 18, Steps: 13 | Train Loss: 0.444 Vali Loss: 31.409 Vali Acc: 0.240 Test Loss: 31.409 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3104770183563232
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 45.504 Vali Acc: 0.200 Test Loss: 45.504 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2304599285125732
Epoch: 20, Steps: 13 | Train Loss: 0.058 Vali Loss: 31.154 Vali Acc: 0.260 Test Loss: 31.154 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2105045318603516
Epoch: 21, Steps: 13 | Train Loss: 0.286 Vali Loss: 34.336 Vali Acc: 0.260 Test Loss: 34.336 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3104605674743652
Epoch: 22, Steps: 13 | Train Loss: 0.134 Vali Loss: 32.527 Vali Acc: 0.220 Test Loss: 32.527 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1742992401123047
Epoch: 23, Steps: 13 | Train Loss: 0.012 Vali Loss: 44.332 Vali Acc: 0.200 Test Loss: 44.332 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df128_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.4
model parameter : 2179205
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.083010673522949
Epoch: 1, Steps: 13 | Train Loss: 1.986 Vali Loss: 2.282 Vali Acc: 0.180 Test Loss: 2.282 Test Acc: 0.180
Validation loss decreased (inf --> -0.179977).  Saving model ...
Epoch: 2 cost time: 1.2063698768615723
Epoch: 2, Steps: 13 | Train Loss: 0.014 Vali Loss: 3.913 Vali Acc: 0.220 Test Loss: 3.913 Test Acc: 0.220
Validation loss decreased (-0.179977 --> -0.219961).  Saving model ...
Epoch: 3 cost time: 1.1067981719970703
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.521 Vali Acc: 0.180 Test Loss: 5.521 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3262667655944824
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.832 Vali Acc: 0.180 Test Loss: 5.832 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1669213771820068
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.902 Vali Acc: 0.140 Test Loss: 5.902 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1599760055541992
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.908 Vali Acc: 0.140 Test Loss: 5.908 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1317660808563232
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.909 Vali Acc: 0.120 Test Loss: 5.909 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0505683422088623
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.915 Vali Acc: 0.120 Test Loss: 5.915 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0833590030670166
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.934 Vali Acc: 0.120 Test Loss: 5.934 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4548990726470947
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.917 Vali Acc: 0.120 Test Loss: 5.917 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1014142036437988
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.908 Vali Acc: 0.120 Test Loss: 5.908 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1164019107818604
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.894 Vali Acc: 0.160 Test Loss: 5.894 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 1534053
model size : 6.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.336190223693848
Epoch: 1, Steps: 25 | Train Loss: 15.418 Vali Loss: 18.018 Vali Acc: 0.200 Test Loss: 18.018 Test Acc: 0.200
Validation loss decreased (inf --> -0.199820).  Saving model ...
Epoch: 2 cost time: 3.6728053092956543
Epoch: 2, Steps: 25 | Train Loss: 3.339 Vali Loss: 105.451 Vali Acc: 0.200 Test Loss: 105.451 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8643431663513184
Epoch: 3, Steps: 25 | Train Loss: 20.801 Vali Loss: 84.772 Vali Acc: 0.200 Test Loss: 84.772 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9178895950317383
Epoch: 4, Steps: 25 | Train Loss: 14.715 Vali Loss: 87.364 Vali Acc: 0.220 Test Loss: 87.364 Test Acc: 0.220
Validation loss decreased (-0.199820 --> -0.219126).  Saving model ...
Epoch: 5 cost time: 3.747014284133911
Epoch: 5, Steps: 25 | Train Loss: 0.527 Vali Loss: 87.777 Vali Acc: 0.200 Test Loss: 87.777 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.756316900253296
Epoch: 6, Steps: 25 | Train Loss: 0.816 Vali Loss: 78.104 Vali Acc: 0.160 Test Loss: 78.104 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.796609878540039
Epoch: 7, Steps: 25 | Train Loss: 7.096 Vali Loss: 63.593 Vali Acc: 0.260 Test Loss: 63.593 Test Acc: 0.260
Validation loss decreased (-0.219126 --> -0.259364).  Saving model ...
Epoch: 8 cost time: 3.8590853214263916
Epoch: 8, Steps: 25 | Train Loss: 6.901 Vali Loss: 166.276 Vali Acc: 0.240 Test Loss: 166.276 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6983277797698975
Epoch: 9, Steps: 25 | Train Loss: 15.081 Vali Loss: 173.265 Vali Acc: 0.160 Test Loss: 173.265 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.823762893676758
Epoch: 10, Steps: 25 | Train Loss: 3.103 Vali Loss: 281.088 Vali Acc: 0.260 Test Loss: 281.088 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7602601051330566
Epoch: 11, Steps: 25 | Train Loss: 13.778 Vali Loss: 230.302 Vali Acc: 0.180 Test Loss: 230.302 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.948240280151367
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 242.645 Vali Acc: 0.180 Test Loss: 242.645 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.004594087600708
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 245.422 Vali Acc: 0.180 Test Loss: 245.422 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.843438148498535
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 245.678 Vali Acc: 0.180 Test Loss: 245.678 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.860278606414795
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 246.049 Vali Acc: 0.180 Test Loss: 246.049 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.818693161010742
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 247.310 Vali Acc: 0.180 Test Loss: 247.310 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.731027841567993
Epoch: 17, Steps: 25 | Train Loss: 0.000 Vali Loss: 246.071 Vali Acc: 0.180 Test Loss: 246.071 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 14435781
model size : 55.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7528798580169678
Epoch: 1, Steps: 13 | Train Loss: 8.044 Vali Loss: 16.665 Vali Acc: 0.200 Test Loss: 16.665 Test Acc: 0.200
Validation loss decreased (inf --> -0.199833).  Saving model ...
Epoch: 2 cost time: 1.9145066738128662
Epoch: 2, Steps: 13 | Train Loss: 4.156 Vali Loss: 28.687 Vali Acc: 0.180 Test Loss: 28.687 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.003241539001465
Epoch: 3, Steps: 13 | Train Loss: 2.178 Vali Loss: 24.372 Vali Acc: 0.200 Test Loss: 24.372 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.099637746810913
Epoch: 4, Steps: 13 | Train Loss: 0.051 Vali Loss: 31.662 Vali Acc: 0.220 Test Loss: 31.662 Test Acc: 0.220
Validation loss decreased (-0.199833 --> -0.219683).  Saving model ...
Epoch: 5 cost time: 2.0271480083465576
Epoch: 5, Steps: 13 | Train Loss: 1.594 Vali Loss: 61.361 Vali Acc: 0.220 Test Loss: 61.361 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.029852867126465
Epoch: 6, Steps: 13 | Train Loss: 1.124 Vali Loss: 40.081 Vali Acc: 0.240 Test Loss: 40.081 Test Acc: 0.240
Validation loss decreased (-0.219683 --> -0.239599).  Saving model ...
Epoch: 7 cost time: 2.0272631645202637
Epoch: 7, Steps: 13 | Train Loss: 1.570 Vali Loss: 65.704 Vali Acc: 0.180 Test Loss: 65.704 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.098372459411621
Epoch: 8, Steps: 13 | Train Loss: 1.318 Vali Loss: 67.965 Vali Acc: 0.200 Test Loss: 67.965 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9274697303771973
Epoch: 9, Steps: 13 | Train Loss: 3.044 Vali Loss: 95.661 Vali Acc: 0.200 Test Loss: 95.661 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9810843467712402
Epoch: 10, Steps: 13 | Train Loss: 6.250 Vali Loss: 88.216 Vali Acc: 0.140 Test Loss: 88.216 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9950816631317139
Epoch: 11, Steps: 13 | Train Loss: 2.958 Vali Loss: 85.273 Vali Acc: 0.140 Test Loss: 85.273 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.143395185470581
Epoch: 12, Steps: 13 | Train Loss: 0.390 Vali Loss: 86.306 Vali Acc: 0.200 Test Loss: 86.306 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0154519081115723
Epoch: 13, Steps: 13 | Train Loss: 2.380 Vali Loss: 78.118 Vali Acc: 0.180 Test Loss: 78.118 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0819661617279053
Epoch: 14, Steps: 13 | Train Loss: 2.487 Vali Loss: 104.689 Vali Acc: 0.180 Test Loss: 104.689 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1219289302825928
Epoch: 15, Steps: 13 | Train Loss: 1.712 Vali Loss: 123.307 Vali Acc: 0.180 Test Loss: 123.307 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0074548721313477
Epoch: 16, Steps: 13 | Train Loss: 0.708 Vali Loss: 104.927 Vali Acc: 0.180 Test Loss: 104.927 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 8195205
model size : 31.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.305253505706787
Epoch: 1, Steps: 13 | Train Loss: 2.503 Vali Loss: 5.852 Vali Acc: 0.200 Test Loss: 5.852 Test Acc: 0.200
Validation loss decreased (inf --> -0.199941).  Saving model ...
Epoch: 2 cost time: 1.6848382949829102
Epoch: 2, Steps: 13 | Train Loss: 0.201 Vali Loss: 7.375 Vali Acc: 0.180 Test Loss: 7.375 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5976784229278564
Epoch: 3, Steps: 13 | Train Loss: 0.515 Vali Loss: 22.993 Vali Acc: 0.180 Test Loss: 22.993 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6315498352050781
Epoch: 4, Steps: 13 | Train Loss: 0.480 Vali Loss: 24.181 Vali Acc: 0.180 Test Loss: 24.181 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5797431468963623
Epoch: 5, Steps: 13 | Train Loss: 0.390 Vali Loss: 32.549 Vali Acc: 0.220 Test Loss: 32.549 Test Acc: 0.220
Validation loss decreased (-0.199941 --> -0.219675).  Saving model ...
Epoch: 6 cost time: 1.624312162399292
Epoch: 6, Steps: 13 | Train Loss: 0.785 Vali Loss: 24.605 Vali Acc: 0.120 Test Loss: 24.605 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6795921325683594
Epoch: 7, Steps: 13 | Train Loss: 0.675 Vali Loss: 29.089 Vali Acc: 0.140 Test Loss: 29.089 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5454556941986084
Epoch: 8, Steps: 13 | Train Loss: 2.161 Vali Loss: 45.275 Vali Acc: 0.160 Test Loss: 45.275 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6413180828094482
Epoch: 9, Steps: 13 | Train Loss: 1.436 Vali Loss: 30.671 Vali Acc: 0.180 Test Loss: 30.671 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6267073154449463
Epoch: 10, Steps: 13 | Train Loss: 1.366 Vali Loss: 60.102 Vali Acc: 0.180 Test Loss: 60.102 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5906546115875244
Epoch: 11, Steps: 13 | Train Loss: 5.171 Vali Loss: 47.218 Vali Acc: 0.200 Test Loss: 47.218 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5808565616607666
Epoch: 12, Steps: 13 | Train Loss: 1.040 Vali Loss: 59.935 Vali Acc: 0.200 Test Loss: 59.935 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6253621578216553
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 47.168 Vali Acc: 0.220 Test Loss: 47.168 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6075077056884766
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 49.333 Vali Acc: 0.240 Test Loss: 49.333 Test Acc: 0.240
Validation loss decreased (-0.219675 --> -0.239507).  Saving model ...
Epoch: 15 cost time: 1.658055305480957
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 51.344 Vali Acc: 0.240 Test Loss: 51.344 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8405497074127197
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.017 Vali Acc: 0.240 Test Loss: 52.017 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6344151496887207
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.462 Vali Acc: 0.240 Test Loss: 52.462 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6490724086761475
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.110 Vali Acc: 0.240 Test Loss: 52.110 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6957824230194092
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.539 Vali Acc: 0.240 Test Loss: 52.539 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.817568063735962
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.359 Vali Acc: 0.240 Test Loss: 52.359 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.640913724899292
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.549 Vali Acc: 0.240 Test Loss: 52.549 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.687990427017212
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.278 Vali Acc: 0.240 Test Loss: 52.278 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.678593635559082
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.351 Vali Acc: 0.240 Test Loss: 52.351 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.700923204421997
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.128 Vali Acc: 0.240 Test Loss: 52.128 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 5182629
model size : 20.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df64_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.08640193939209
Epoch: 1, Steps: 13 | Train Loss: 3.031 Vali Loss: 4.632 Vali Acc: 0.160 Test Loss: 4.632 Test Acc: 0.160
Validation loss decreased (inf --> -0.159954).  Saving model ...
Epoch: 2 cost time: 1.4736528396606445
Epoch: 2, Steps: 13 | Train Loss: 0.217 Vali Loss: 17.117 Vali Acc: 0.160 Test Loss: 17.117 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5435032844543457
Epoch: 3, Steps: 13 | Train Loss: 0.016 Vali Loss: 10.649 Vali Acc: 0.180 Test Loss: 10.649 Test Acc: 0.180
Validation loss decreased (-0.159954 --> -0.179894).  Saving model ...
Epoch: 4 cost time: 1.4120583534240723
Epoch: 4, Steps: 13 | Train Loss: 0.133 Vali Loss: 21.282 Vali Acc: 0.120 Test Loss: 21.282 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4417622089385986
Epoch: 5, Steps: 13 | Train Loss: 0.001 Vali Loss: 18.003 Vali Acc: 0.120 Test Loss: 18.003 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4800026416778564
Epoch: 6, Steps: 13 | Train Loss: 0.473 Vali Loss: 36.896 Vali Acc: 0.160 Test Loss: 36.896 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3612923622131348
Epoch: 7, Steps: 13 | Train Loss: 0.375 Vali Loss: 39.038 Vali Acc: 0.160 Test Loss: 39.038 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2840094566345215
Epoch: 8, Steps: 13 | Train Loss: 0.427 Vali Loss: 26.669 Vali Acc: 0.260 Test Loss: 26.669 Test Acc: 0.260
Validation loss decreased (-0.179894 --> -0.259733).  Saving model ...
Epoch: 9 cost time: 1.4965112209320068
Epoch: 9, Steps: 13 | Train Loss: 1.083 Vali Loss: 37.453 Vali Acc: 0.140 Test Loss: 37.453 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3839046955108643
Epoch: 10, Steps: 13 | Train Loss: 1.718 Vali Loss: 48.782 Vali Acc: 0.140 Test Loss: 48.782 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4842400550842285
Epoch: 11, Steps: 13 | Train Loss: 2.550 Vali Loss: 46.609 Vali Acc: 0.140 Test Loss: 46.609 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4160938262939453
Epoch: 12, Steps: 13 | Train Loss: 0.295 Vali Loss: 63.530 Vali Acc: 0.180 Test Loss: 63.530 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4319307804107666
Epoch: 13, Steps: 13 | Train Loss: 0.128 Vali Loss: 76.260 Vali Acc: 0.200 Test Loss: 76.260 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3951072692871094
Epoch: 14, Steps: 13 | Train Loss: 1.369 Vali Loss: 55.487 Vali Acc: 0.280 Test Loss: 55.487 Test Acc: 0.280
Validation loss decreased (-0.259733 --> -0.279445).  Saving model ...
Epoch: 15 cost time: 1.5068933963775635
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.919 Vali Acc: 0.200 Test Loss: 48.919 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.431715488433838
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.397 Vali Acc: 0.200 Test Loss: 48.397 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.688476324081421
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.135 Vali Acc: 0.200 Test Loss: 48.135 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5141401290893555
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.260 Vali Acc: 0.200 Test Loss: 48.260 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.506673812866211
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.250 Vali Acc: 0.200 Test Loss: 48.250 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5273423194885254
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.313 Vali Acc: 0.200 Test Loss: 48.313 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4239716529846191
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.526 Vali Acc: 0.180 Test Loss: 48.526 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.560115098953247
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.424 Vali Acc: 0.200 Test Loss: 48.424 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4843099117279053
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.728 Vali Acc: 0.200 Test Loss: 48.728 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5130844116210938
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.156 Vali Acc: 0.200 Test Loss: 48.156 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df64_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 4106821
model size : 16.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.873877763748169
Epoch: 1, Steps: 13 | Train Loss: 2.104 Vali Loss: 4.107 Vali Acc: 0.180 Test Loss: 4.107 Test Acc: 0.180
Validation loss decreased (inf --> -0.179959).  Saving model ...
Epoch: 2 cost time: 1.1532645225524902
Epoch: 2, Steps: 13 | Train Loss: 0.014 Vali Loss: 5.642 Vali Acc: 0.120 Test Loss: 5.642 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1378283500671387
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.405 Vali Acc: 0.260 Test Loss: 7.405 Test Acc: 0.260
Validation loss decreased (-0.179959 --> -0.259926).  Saving model ...
Epoch: 4 cost time: 1.1063446998596191
Epoch: 4, Steps: 13 | Train Loss: 0.002 Vali Loss: 10.999 Vali Acc: 0.120 Test Loss: 10.999 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.209038257598877
Epoch: 5, Steps: 13 | Train Loss: 0.089 Vali Loss: 8.734 Vali Acc: 0.180 Test Loss: 8.734 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.181885004043579
Epoch: 6, Steps: 13 | Train Loss: 0.246 Vali Loss: 19.584 Vali Acc: 0.160 Test Loss: 19.584 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2332468032836914
Epoch: 7, Steps: 13 | Train Loss: 0.588 Vali Loss: 20.588 Vali Acc: 0.180 Test Loss: 20.588 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2024250030517578
Epoch: 8, Steps: 13 | Train Loss: 0.616 Vali Loss: 16.865 Vali Acc: 0.200 Test Loss: 16.865 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2569572925567627
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.659 Vali Acc: 0.180 Test Loss: 21.659 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.16035795211792
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.745 Vali Acc: 0.160 Test Loss: 21.745 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2226078510284424
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.288 Vali Acc: 0.180 Test Loss: 21.288 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2361900806427002
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.069 Vali Acc: 0.180 Test Loss: 21.069 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0613746643066406
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.141 Vali Acc: 0.160 Test Loss: 21.141 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 2600869
model size : 10.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df64_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8695085048675537
Epoch: 1, Steps: 13 | Train Loss: 1.981 Vali Loss: 2.743 Vali Acc: 0.220 Test Loss: 2.743 Test Acc: 0.220
Validation loss decreased (inf --> -0.219973).  Saving model ...
Epoch: 2 cost time: 1.358508825302124
Epoch: 2, Steps: 13 | Train Loss: 0.004 Vali Loss: 5.698 Vali Acc: 0.200 Test Loss: 5.698 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3133149147033691
Epoch: 3, Steps: 13 | Train Loss: 0.063 Vali Loss: 6.785 Vali Acc: 0.180 Test Loss: 6.785 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2941749095916748
Epoch: 4, Steps: 13 | Train Loss: 0.024 Vali Loss: 6.905 Vali Acc: 0.180 Test Loss: 6.905 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2228209972381592
Epoch: 5, Steps: 13 | Train Loss: 0.017 Vali Loss: 7.960 Vali Acc: 0.160 Test Loss: 7.960 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.264047384262085
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.562 Vali Acc: 0.160 Test Loss: 7.562 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1709098815917969
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.833 Vali Acc: 0.220 Test Loss: 7.833 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.139890193939209
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.907 Vali Acc: 0.200 Test Loss: 7.907 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3425114154815674
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.958 Vali Acc: 0.200 Test Loss: 7.958 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2934465408325195
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.980 Vali Acc: 0.200 Test Loss: 7.980 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2915880680084229
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.960 Vali Acc: 0.200 Test Loss: 7.960 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df64_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 2170885
model size : 8.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1075568199157715
Epoch: 1, Steps: 13 | Train Loss: 2.094 Vali Loss: 2.430 Vali Acc: 0.240 Test Loss: 2.430 Test Acc: 0.240
Validation loss decreased (inf --> -0.239976).  Saving model ...
Epoch: 2 cost time: 1.262995719909668
Epoch: 2, Steps: 13 | Train Loss: 0.027 Vali Loss: 4.188 Vali Acc: 0.200 Test Loss: 4.188 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0605802536010742
Epoch: 3, Steps: 13 | Train Loss: 0.041 Vali Loss: 6.199 Vali Acc: 0.200 Test Loss: 6.199 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1051273345947266
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.957 Vali Acc: 0.200 Test Loss: 5.957 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1025609970092773
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.583 Vali Acc: 0.260 Test Loss: 5.583 Test Acc: 0.260
Validation loss decreased (-0.239976 --> -0.259944).  Saving model ...
Epoch: 6 cost time: 1.121617317199707
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.504 Vali Acc: 0.200 Test Loss: 5.504 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0727741718292236
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.531 Vali Acc: 0.180 Test Loss: 5.531 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0741848945617676
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.537 Vali Acc: 0.180 Test Loss: 5.537 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1813640594482422
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.546 Vali Acc: 0.180 Test Loss: 5.546 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1705210208892822
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.548 Vali Acc: 0.180 Test Loss: 5.548 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.205432415008545
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.553 Vali Acc: 0.200 Test Loss: 5.553 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4271693229675293
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.563 Vali Acc: 0.180 Test Loss: 5.563 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0797109603881836
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.554 Vali Acc: 0.180 Test Loss: 5.554 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2032806873321533
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.559 Vali Acc: 0.180 Test Loss: 5.559 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1296660900115967
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.577 Vali Acc: 0.180 Test Loss: 5.577 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm32_nh4_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 1525733
model size : 6.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.279474973678589
Epoch: 1, Steps: 25 | Train Loss: 11.930 Vali Loss: 19.051 Vali Acc: 0.160 Test Loss: 19.051 Test Acc: 0.160
Validation loss decreased (inf --> -0.159809).  Saving model ...
Epoch: 2 cost time: 3.621082305908203
Epoch: 2, Steps: 25 | Train Loss: 3.462 Vali Loss: 24.810 Vali Acc: 0.240 Test Loss: 24.810 Test Acc: 0.240
Validation loss decreased (-0.159809 --> -0.239752).  Saving model ...
Epoch: 3 cost time: 3.681835412979126
Epoch: 3, Steps: 25 | Train Loss: 3.080 Vali Loss: 33.767 Vali Acc: 0.180 Test Loss: 33.767 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9678354263305664
Epoch: 4, Steps: 25 | Train Loss: 1.948 Vali Loss: 36.629 Vali Acc: 0.160 Test Loss: 36.629 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.6347036361694336
Epoch: 5, Steps: 25 | Train Loss: 3.579 Vali Loss: 58.625 Vali Acc: 0.180 Test Loss: 58.625 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.6771745681762695
Epoch: 6, Steps: 25 | Train Loss: 7.364 Vali Loss: 62.054 Vali Acc: 0.140 Test Loss: 62.054 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.6662821769714355
Epoch: 7, Steps: 25 | Train Loss: 1.726 Vali Loss: 69.303 Vali Acc: 0.140 Test Loss: 69.303 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.794257879257202
Epoch: 8, Steps: 25 | Train Loss: 0.583 Vali Loss: 60.397 Vali Acc: 0.180 Test Loss: 60.397 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.658568859100342
Epoch: 9, Steps: 25 | Train Loss: 0.634 Vali Loss: 63.379 Vali Acc: 0.140 Test Loss: 63.379 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.7377865314483643
Epoch: 10, Steps: 25 | Train Loss: 0.605 Vali Loss: 110.991 Vali Acc: 0.220 Test Loss: 110.991 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.7358829975128174
Epoch: 11, Steps: 25 | Train Loss: 4.618 Vali Loss: 73.624 Vali Acc: 0.200 Test Loss: 73.624 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.934861183166504
Epoch: 12, Steps: 25 | Train Loss: 4.741 Vali Loss: 83.457 Vali Acc: 0.160 Test Loss: 83.457 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 7228581
model size : 27.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.989255428314209
Epoch: 1, Steps: 13 | Train Loss: 3.470 Vali Loss: 7.431 Vali Acc: 0.160 Test Loss: 7.431 Test Acc: 0.160
Validation loss decreased (inf --> -0.159926).  Saving model ...
Epoch: 2 cost time: 2.318930149078369
Epoch: 2, Steps: 13 | Train Loss: 1.859 Vali Loss: 22.800 Vali Acc: 0.200 Test Loss: 22.800 Test Acc: 0.200
Validation loss decreased (-0.159926 --> -0.199772).  Saving model ...
Epoch: 3 cost time: 2.284891128540039
Epoch: 3, Steps: 13 | Train Loss: 0.378 Vali Loss: 19.462 Vali Acc: 0.200 Test Loss: 19.462 Test Acc: 0.200
Validation loss decreased (-0.199772 --> -0.199805).  Saving model ...
Epoch: 4 cost time: 2.1927523612976074
Epoch: 4, Steps: 13 | Train Loss: 0.377 Vali Loss: 12.906 Vali Acc: 0.240 Test Loss: 12.906 Test Acc: 0.240
Validation loss decreased (-0.199805 --> -0.239871).  Saving model ...
Epoch: 5 cost time: 2.385584831237793
Epoch: 5, Steps: 13 | Train Loss: 0.741 Vali Loss: 20.265 Vali Acc: 0.180 Test Loss: 20.265 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3291962146759033
Epoch: 6, Steps: 13 | Train Loss: 0.094 Vali Loss: 28.365 Vali Acc: 0.160 Test Loss: 28.365 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.314612865447998
Epoch: 7, Steps: 13 | Train Loss: 4.175 Vali Loss: 46.863 Vali Acc: 0.200 Test Loss: 46.863 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.371021270751953
Epoch: 8, Steps: 13 | Train Loss: 0.909 Vali Loss: 37.609 Vali Acc: 0.220 Test Loss: 37.609 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2945899963378906
Epoch: 9, Steps: 13 | Train Loss: 3.009 Vali Loss: 25.696 Vali Acc: 0.260 Test Loss: 25.696 Test Acc: 0.260
Validation loss decreased (-0.239871 --> -0.259743).  Saving model ...
Epoch: 10 cost time: 2.4162142276763916
Epoch: 10, Steps: 13 | Train Loss: 0.170 Vali Loss: 44.110 Vali Acc: 0.200 Test Loss: 44.110 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.421060800552368
Epoch: 11, Steps: 13 | Train Loss: 0.976 Vali Loss: 28.877 Vali Acc: 0.160 Test Loss: 28.877 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.35205078125
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 28.741 Vali Acc: 0.220 Test Loss: 28.741 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2140426635742188
Epoch: 13, Steps: 13 | Train Loss: 0.016 Vali Loss: 26.272 Vali Acc: 0.220 Test Loss: 26.272 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1393861770629883
Epoch: 14, Steps: 13 | Train Loss: 0.068 Vali Loss: 50.595 Vali Acc: 0.160 Test Loss: 50.595 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3007092475891113
Epoch: 15, Steps: 13 | Train Loss: 1.191 Vali Loss: 40.879 Vali Acc: 0.160 Test Loss: 40.879 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3505845069885254
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 47.313 Vali Acc: 0.180 Test Loss: 47.313 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.229982852935791
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 44.979 Vali Acc: 0.200 Test Loss: 44.979 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.3008131980895996
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 44.789 Vali Acc: 0.200 Test Loss: 44.789 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.24174165725708
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 44.861 Vali Acc: 0.220 Test Loss: 44.861 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 4108293
model size : 15.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4039995670318604
Epoch: 1, Steps: 13 | Train Loss: 3.577 Vali Loss: 7.871 Vali Acc: 0.200 Test Loss: 7.871 Test Acc: 0.200
Validation loss decreased (inf --> -0.199921).  Saving model ...
Epoch: 2 cost time: 1.623349905014038
Epoch: 2, Steps: 13 | Train Loss: 0.392 Vali Loss: 6.780 Vali Acc: 0.140 Test Loss: 6.780 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5565240383148193
Epoch: 3, Steps: 13 | Train Loss: 0.076 Vali Loss: 13.367 Vali Acc: 0.180 Test Loss: 13.367 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4233157634735107
Epoch: 4, Steps: 13 | Train Loss: 0.248 Vali Loss: 8.715 Vali Acc: 0.100 Test Loss: 8.715 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6221165657043457
Epoch: 5, Steps: 13 | Train Loss: 0.083 Vali Loss: 11.093 Vali Acc: 0.160 Test Loss: 11.093 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6758451461791992
Epoch: 6, Steps: 13 | Train Loss: 0.042 Vali Loss: 10.401 Vali Acc: 0.160 Test Loss: 10.401 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.560551404953003
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 10.492 Vali Acc: 0.100 Test Loss: 10.492 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5358831882476807
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 15.713 Vali Acc: 0.240 Test Loss: 15.713 Test Acc: 0.240
Validation loss decreased (-0.199921 --> -0.239843).  Saving model ...
Epoch: 9 cost time: 1.6190674304962158
Epoch: 9, Steps: 13 | Train Loss: 0.147 Vali Loss: 17.797 Vali Acc: 0.180 Test Loss: 17.797 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.567694902420044
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 16.718 Vali Acc: 0.240 Test Loss: 16.718 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5993437767028809
Epoch: 11, Steps: 13 | Train Loss: 1.287 Vali Loss: 38.004 Vali Acc: 0.180 Test Loss: 38.004 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6612098217010498
Epoch: 12, Steps: 13 | Train Loss: 3.681 Vali Loss: 26.211 Vali Acc: 0.220 Test Loss: 26.211 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6059503555297852
Epoch: 13, Steps: 13 | Train Loss: 1.245 Vali Loss: 41.323 Vali Acc: 0.160 Test Loss: 41.323 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6636714935302734
Epoch: 14, Steps: 13 | Train Loss: 2.028 Vali Loss: 49.184 Vali Acc: 0.200 Test Loss: 49.184 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7080607414245605
Epoch: 15, Steps: 13 | Train Loss: 0.861 Vali Loss: 32.427 Vali Acc: 0.200 Test Loss: 32.427 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7690863609313965
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 36.206 Vali Acc: 0.120 Test Loss: 36.206 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6169021129608154
Epoch: 17, Steps: 13 | Train Loss: 0.019 Vali Loss: 32.189 Vali Acc: 0.120 Test Loss: 32.189 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5605583190917969
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 35.642 Vali Acc: 0.240 Test Loss: 35.642 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 2602005
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df256_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2740554809570312
Epoch: 1, Steps: 13 | Train Loss: 1.872 Vali Loss: 4.583 Vali Acc: 0.200 Test Loss: 4.583 Test Acc: 0.200
Validation loss decreased (inf --> -0.199954).  Saving model ...
Epoch: 2 cost time: 1.4138453006744385
Epoch: 2, Steps: 13 | Train Loss: 0.200 Vali Loss: 5.438 Vali Acc: 0.160 Test Loss: 5.438 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.560584306716919
Epoch: 3, Steps: 13 | Train Loss: 0.209 Vali Loss: 7.498 Vali Acc: 0.180 Test Loss: 7.498 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4662578105926514
Epoch: 4, Steps: 13 | Train Loss: 0.219 Vali Loss: 8.791 Vali Acc: 0.140 Test Loss: 8.791 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.542001724243164
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.190 Vali Acc: 0.080 Test Loss: 8.190 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3907673358917236
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.208 Vali Acc: 0.060 Test Loss: 8.208 Test Acc: 0.060
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3668289184570312
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.591 Vali Acc: 0.140 Test Loss: 8.591 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4362905025482178
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.687 Vali Acc: 0.140 Test Loss: 8.687 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3777744770050049
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.697 Vali Acc: 0.140 Test Loss: 8.697 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.465468406677246
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.739 Vali Acc: 0.140 Test Loss: 8.739 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.427217721939087
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.660 Vali Acc: 0.140 Test Loss: 8.660 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df256_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 2064101
model size : 8.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9001476764678955
Epoch: 1, Steps: 13 | Train Loss: 2.317 Vali Loss: 2.507 Vali Acc: 0.200 Test Loss: 2.507 Test Acc: 0.200
Validation loss decreased (inf --> -0.199975).  Saving model ...
Epoch: 2 cost time: 1.3627233505249023
Epoch: 2, Steps: 13 | Train Loss: 0.051 Vali Loss: 3.325 Vali Acc: 0.240 Test Loss: 3.325 Test Acc: 0.240
Validation loss decreased (-0.199975 --> -0.239967).  Saving model ...
Epoch: 3 cost time: 1.1566407680511475
Epoch: 3, Steps: 13 | Train Loss: 0.001 Vali Loss: 5.761 Vali Acc: 0.180 Test Loss: 5.761 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2909448146820068
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.858 Vali Acc: 0.220 Test Loss: 5.858 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2003610134124756
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.669 Vali Acc: 0.260 Test Loss: 5.669 Test Acc: 0.260
Validation loss decreased (-0.239967 --> -0.259943).  Saving model ...
Epoch: 6 cost time: 1.1620399951934814
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.565 Vali Acc: 0.240 Test Loss: 5.565 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.085958480834961
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.515 Vali Acc: 0.240 Test Loss: 5.515 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2437744140625
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.485 Vali Acc: 0.240 Test Loss: 5.485 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1180999279022217
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.474 Vali Acc: 0.240 Test Loss: 5.474 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.099111795425415
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.462 Vali Acc: 0.240 Test Loss: 5.462 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1172235012054443
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.446 Vali Acc: 0.240 Test Loss: 5.446 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.211855173110962
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.452 Vali Acc: 0.240 Test Loss: 5.452 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1956205368041992
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.438 Vali Acc: 0.260 Test Loss: 5.438 Test Acc: 0.260
Validation loss decreased (-0.259943 --> -0.259946).  Saving model ...
Epoch: 14 cost time: 1.2495272159576416
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.450 Vali Acc: 0.260 Test Loss: 5.450 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1753730773925781
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.447 Vali Acc: 0.260 Test Loss: 5.447 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3017382621765137
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.445 Vali Acc: 0.260 Test Loss: 5.445 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.201634168624878
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.425 Vali Acc: 0.260 Test Loss: 5.425 Test Acc: 0.260
Validation loss decreased (-0.259946 --> -0.259946).  Saving model ...
Epoch: 18 cost time: 1.1830592155456543
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.432 Vali Acc: 0.260 Test Loss: 5.432 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2314214706420898
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.415 Vali Acc: 0.260 Test Loss: 5.415 Test Acc: 0.260
Validation loss decreased (-0.259946 --> -0.259946).  Saving model ...
Epoch: 20 cost time: 1.166428565979004
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.411 Vali Acc: 0.260 Test Loss: 5.411 Test Acc: 0.260
Validation loss decreased (-0.259946 --> -0.259946).  Saving model ...
Epoch: 21 cost time: 1.1588621139526367
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.431 Vali Acc: 0.260 Test Loss: 5.431 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1987535953521729
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.433 Vali Acc: 0.260 Test Loss: 5.433 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3201711177825928
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.430 Vali Acc: 0.260 Test Loss: 5.430 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.291287899017334
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.420 Vali Acc: 0.260 Test Loss: 5.420 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3877358436584473
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.444 Vali Acc: 0.260 Test Loss: 5.444 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3650398254394531
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.436 Vali Acc: 0.260 Test Loss: 5.436 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1995861530303955
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.419 Vali Acc: 0.260 Test Loss: 5.419 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.248659372329712
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.419 Vali Acc: 0.260 Test Loss: 5.419 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.153662919998169
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.430 Vali Acc: 0.260 Test Loss: 5.430 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2950799465179443
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.413 Vali Acc: 0.260 Test Loss: 5.413 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 1311125
model size : 5.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df256_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.669032335281372
Epoch: 1, Steps: 13 | Train Loss: 1.847 Vali Loss: 2.273 Vali Acc: 0.180 Test Loss: 2.273 Test Acc: 0.180
Validation loss decreased (inf --> -0.179977).  Saving model ...
Epoch: 2 cost time: 1.1500706672668457
Epoch: 2, Steps: 13 | Train Loss: 0.095 Vali Loss: 3.478 Vali Acc: 0.200 Test Loss: 3.478 Test Acc: 0.200
Validation loss decreased (-0.179977 --> -0.199965).  Saving model ...
Epoch: 3 cost time: 1.1397175788879395
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.906 Vali Acc: 0.240 Test Loss: 3.906 Test Acc: 0.240
Validation loss decreased (-0.199965 --> -0.239961).  Saving model ...
Epoch: 4 cost time: 1.0965325832366943
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.096 Vali Acc: 0.260 Test Loss: 4.096 Test Acc: 0.260
Validation loss decreased (-0.239961 --> -0.259959).  Saving model ...
Epoch: 5 cost time: 1.1831107139587402
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.135 Vali Acc: 0.260 Test Loss: 4.135 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1793830394744873
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.151 Vali Acc: 0.240 Test Loss: 4.151 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1789822578430176
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.135 Vali Acc: 0.240 Test Loss: 4.135 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1760170459747314
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.141 Vali Acc: 0.240 Test Loss: 4.141 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0578083992004395
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.138 Vali Acc: 0.240 Test Loss: 4.138 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0980794429779053
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.132 Vali Acc: 0.240 Test Loss: 4.132 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0385971069335938
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.133 Vali Acc: 0.240 Test Loss: 4.133 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1313679218292236
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.130 Vali Acc: 0.240 Test Loss: 4.130 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1743502616882324
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.157 Vali Acc: 0.240 Test Loss: 4.157 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.143644094467163
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.137 Vali Acc: 0.260 Test Loss: 4.137 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df256_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 1096133
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7085840702056885
Epoch: 1, Steps: 13 | Train Loss: 1.827 Vali Loss: 2.112 Vali Acc: 0.200 Test Loss: 2.112 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 1.078418493270874
Epoch: 2, Steps: 13 | Train Loss: 0.161 Vali Loss: 2.675 Vali Acc: 0.260 Test Loss: 2.675 Test Acc: 0.260
Validation loss decreased (-0.199979 --> -0.259973).  Saving model ...
Epoch: 3 cost time: 0.9827568531036377
Epoch: 3, Steps: 13 | Train Loss: 0.023 Vali Loss: 3.282 Vali Acc: 0.160 Test Loss: 3.282 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0846896171569824
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.421 Vali Acc: 0.180 Test Loss: 3.421 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.040048599243164
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.470 Vali Acc: 0.200 Test Loss: 3.470 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9859721660614014
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.494 Vali Acc: 0.220 Test Loss: 3.494 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0262815952301025
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.496 Vali Acc: 0.240 Test Loss: 3.496 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9940719604492188
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.494 Vali Acc: 0.240 Test Loss: 3.494 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0849967002868652
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.485 Vali Acc: 0.240 Test Loss: 3.485 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9919087886810303
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.481 Vali Acc: 0.240 Test Loss: 3.481 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.999220609664917
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.474 Vali Acc: 0.240 Test Loss: 3.474 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1979773044586182
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.470 Vali Acc: 0.220 Test Loss: 3.470 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 773557
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.651486396789551
Epoch: 1, Steps: 25 | Train Loss: 9.230 Vali Loss: 19.523 Vali Acc: 0.200 Test Loss: 19.523 Test Acc: 0.200
Validation loss decreased (inf --> -0.199805).  Saving model ...
Epoch: 2 cost time: 3.1673054695129395
Epoch: 2, Steps: 25 | Train Loss: 4.682 Vali Loss: 43.024 Vali Acc: 0.180 Test Loss: 43.024 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2348179817199707
Epoch: 3, Steps: 25 | Train Loss: 5.354 Vali Loss: 87.929 Vali Acc: 0.200 Test Loss: 87.929 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.318401336669922
Epoch: 4, Steps: 25 | Train Loss: 10.307 Vali Loss: 119.442 Vali Acc: 0.160 Test Loss: 119.442 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.342635154724121
Epoch: 5, Steps: 25 | Train Loss: 4.765 Vali Loss: 73.551 Vali Acc: 0.180 Test Loss: 73.551 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.3340578079223633
Epoch: 6, Steps: 25 | Train Loss: 4.142 Vali Loss: 86.350 Vali Acc: 0.160 Test Loss: 86.350 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.233441114425659
Epoch: 7, Steps: 25 | Train Loss: 2.076 Vali Loss: 109.446 Vali Acc: 0.160 Test Loss: 109.446 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.2356696128845215
Epoch: 8, Steps: 25 | Train Loss: 0.000 Vali Loss: 92.868 Vali Acc: 0.140 Test Loss: 92.868 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.202378988265991
Epoch: 9, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.421 Vali Acc: 0.160 Test Loss: 91.421 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.293672800064087
Epoch: 10, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.460 Vali Acc: 0.160 Test Loss: 91.460 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.2701523303985596
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 91.411 Vali Acc: 0.160 Test Loss: 91.411 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 7220133
model size : 27.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.429521083831787
Epoch: 1, Steps: 13 | Train Loss: 2.771 Vali Loss: 6.322 Vali Acc: 0.200 Test Loss: 6.322 Test Acc: 0.200
Validation loss decreased (inf --> -0.199937).  Saving model ...
Epoch: 2 cost time: 1.881272554397583
Epoch: 2, Steps: 13 | Train Loss: 0.509 Vali Loss: 10.705 Vali Acc: 0.160 Test Loss: 10.705 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8100993633270264
Epoch: 3, Steps: 13 | Train Loss: 0.467 Vali Loss: 21.652 Vali Acc: 0.200 Test Loss: 21.652 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9044597148895264
Epoch: 4, Steps: 13 | Train Loss: 2.617 Vali Loss: 36.703 Vali Acc: 0.200 Test Loss: 36.703 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9151859283447266
Epoch: 5, Steps: 13 | Train Loss: 0.277 Vali Loss: 19.275 Vali Acc: 0.240 Test Loss: 19.275 Test Acc: 0.240
Validation loss decreased (-0.199937 --> -0.239807).  Saving model ...
Epoch: 6 cost time: 1.892209768295288
Epoch: 6, Steps: 13 | Train Loss: 1.591 Vali Loss: 29.626 Vali Acc: 0.200 Test Loss: 29.626 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.845952033996582
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 25.673 Vali Acc: 0.160 Test Loss: 25.673 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9230928421020508
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 40.164 Vali Acc: 0.180 Test Loss: 40.164 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8824198246002197
Epoch: 9, Steps: 13 | Train Loss: 1.086 Vali Loss: 25.790 Vali Acc: 0.220 Test Loss: 25.790 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8409686088562012
Epoch: 10, Steps: 13 | Train Loss: 0.971 Vali Loss: 36.953 Vali Acc: 0.220 Test Loss: 36.953 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9698090553283691
Epoch: 11, Steps: 13 | Train Loss: 0.007 Vali Loss: 44.709 Vali Acc: 0.160 Test Loss: 44.709 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9402852058410645
Epoch: 12, Steps: 13 | Train Loss: 0.119 Vali Loss: 64.181 Vali Acc: 0.200 Test Loss: 64.181 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8268508911132812
Epoch: 13, Steps: 13 | Train Loss: 0.634 Vali Loss: 45.430 Vali Acc: 0.120 Test Loss: 45.430 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9270761013031006
Epoch: 14, Steps: 13 | Train Loss: 6.154 Vali Loss: 54.036 Vali Acc: 0.200 Test Loss: 54.036 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.884577989578247
Epoch: 15, Steps: 13 | Train Loss: 1.241 Vali Loss: 93.507 Vali Acc: 0.200 Test Loss: 93.507 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 4099845
model size : 15.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.862877607345581
Epoch: 1, Steps: 13 | Train Loss: 2.215 Vali Loss: 2.956 Vali Acc: 0.200 Test Loss: 2.956 Test Acc: 0.200
Validation loss decreased (inf --> -0.199970).  Saving model ...
Epoch: 2 cost time: 1.3374133110046387
Epoch: 2, Steps: 13 | Train Loss: 0.311 Vali Loss: 10.770 Vali Acc: 0.200 Test Loss: 10.770 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4088749885559082
Epoch: 3, Steps: 13 | Train Loss: 0.005 Vali Loss: 7.113 Vali Acc: 0.200 Test Loss: 7.113 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3526842594146729
Epoch: 4, Steps: 13 | Train Loss: 0.229 Vali Loss: 15.375 Vali Acc: 0.180 Test Loss: 15.375 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.375394582748413
Epoch: 5, Steps: 13 | Train Loss: 0.165 Vali Loss: 14.129 Vali Acc: 0.180 Test Loss: 14.129 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3659508228302002
Epoch: 6, Steps: 13 | Train Loss: 0.144 Vali Loss: 19.514 Vali Acc: 0.180 Test Loss: 19.514 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3975574970245361
Epoch: 7, Steps: 13 | Train Loss: 0.808 Vali Loss: 18.570 Vali Acc: 0.180 Test Loss: 18.570 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4289681911468506
Epoch: 8, Steps: 13 | Train Loss: 1.321 Vali Loss: 40.991 Vali Acc: 0.200 Test Loss: 40.991 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.365224838256836
Epoch: 9, Steps: 13 | Train Loss: 2.087 Vali Loss: 26.713 Vali Acc: 0.180 Test Loss: 26.713 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4390020370483398
Epoch: 10, Steps: 13 | Train Loss: 0.199 Vali Loss: 18.198 Vali Acc: 0.120 Test Loss: 18.198 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.310408115386963
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 28.502 Vali Acc: 0.160 Test Loss: 28.502 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 2593557
model size : 10.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df128_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0057857036590576
Epoch: 1, Steps: 13 | Train Loss: 2.027 Vali Loss: 4.432 Vali Acc: 0.200 Test Loss: 4.432 Test Acc: 0.200
Validation loss decreased (inf --> -0.199956).  Saving model ...
Epoch: 2 cost time: 1.407320499420166
Epoch: 2, Steps: 13 | Train Loss: 0.166 Vali Loss: 7.476 Vali Acc: 0.200 Test Loss: 7.476 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.492814064025879
Epoch: 3, Steps: 13 | Train Loss: 0.048 Vali Loss: 9.654 Vali Acc: 0.160 Test Loss: 9.654 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3657917976379395
Epoch: 4, Steps: 13 | Train Loss: 0.427 Vali Loss: 12.673 Vali Acc: 0.180 Test Loss: 12.673 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.370133638381958
Epoch: 5, Steps: 13 | Train Loss: 0.044 Vali Loss: 12.756 Vali Acc: 0.160 Test Loss: 12.756 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4270274639129639
Epoch: 6, Steps: 13 | Train Loss: 0.056 Vali Loss: 12.990 Vali Acc: 0.160 Test Loss: 12.990 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3316617012023926
Epoch: 7, Steps: 13 | Train Loss: 0.122 Vali Loss: 18.794 Vali Acc: 0.200 Test Loss: 18.794 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5071251392364502
Epoch: 8, Steps: 13 | Train Loss: 0.026 Vali Loss: 10.834 Vali Acc: 0.180 Test Loss: 10.834 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3584768772125244
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.531 Vali Acc: 0.140 Test Loss: 11.531 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.344914197921753
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.869 Vali Acc: 0.100 Test Loss: 11.869 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3630659580230713
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.199 Vali Acc: 0.120 Test Loss: 12.199 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df128_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 2055653
model size : 8.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8575448989868164
Epoch: 1, Steps: 13 | Train Loss: 1.922 Vali Loss: 2.707 Vali Acc: 0.200 Test Loss: 2.707 Test Acc: 0.200
Validation loss decreased (inf --> -0.199973).  Saving model ...
Epoch: 2 cost time: 1.1009025573730469
Epoch: 2, Steps: 13 | Train Loss: 0.515 Vali Loss: 4.411 Vali Acc: 0.220 Test Loss: 4.411 Test Acc: 0.220
Validation loss decreased (-0.199973 --> -0.219956).  Saving model ...
Epoch: 3 cost time: 1.0836551189422607
Epoch: 3, Steps: 13 | Train Loss: 0.008 Vali Loss: 4.659 Vali Acc: 0.200 Test Loss: 4.659 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1451029777526855
Epoch: 4, Steps: 13 | Train Loss: 0.001 Vali Loss: 7.644 Vali Acc: 0.160 Test Loss: 7.644 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2877302169799805
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.498 Vali Acc: 0.140 Test Loss: 8.498 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1192214488983154
Epoch: 6, Steps: 13 | Train Loss: 0.001 Vali Loss: 7.390 Vali Acc: 0.220 Test Loss: 7.390 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1216437816619873
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.196 Vali Acc: 0.180 Test Loss: 9.196 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1487972736358643
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.516 Vali Acc: 0.180 Test Loss: 8.516 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3325252532958984
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.192 Vali Acc: 0.180 Test Loss: 8.192 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0948586463928223
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.123 Vali Acc: 0.180 Test Loss: 8.123 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1598458290100098
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.069 Vali Acc: 0.180 Test Loss: 8.069 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1341640949249268
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.045 Vali Acc: 0.180 Test Loss: 8.045 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 1302677
model size : 5.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df128_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4166133403778076
Epoch: 1, Steps: 13 | Train Loss: 1.871 Vali Loss: 2.035 Vali Acc: 0.140 Test Loss: 2.035 Test Acc: 0.140
Validation loss decreased (inf --> -0.139980).  Saving model ...
Epoch: 2 cost time: 0.9437742233276367
Epoch: 2, Steps: 13 | Train Loss: 0.156 Vali Loss: 3.146 Vali Acc: 0.200 Test Loss: 3.146 Test Acc: 0.200
Validation loss decreased (-0.139980 --> -0.199969).  Saving model ...
Epoch: 3 cost time: 1.014481782913208
Epoch: 3, Steps: 13 | Train Loss: 0.003 Vali Loss: 5.017 Vali Acc: 0.180 Test Loss: 5.017 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9683668613433838
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.385 Vali Acc: 0.200 Test Loss: 5.385 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9621143341064453
Epoch: 5, Steps: 13 | Train Loss: 0.004 Vali Loss: 4.612 Vali Acc: 0.140 Test Loss: 4.612 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9857006072998047
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.504 Vali Acc: 0.200 Test Loss: 6.504 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.014721155166626
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.301 Vali Acc: 0.200 Test Loss: 6.301 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9735367298126221
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.365 Vali Acc: 0.220 Test Loss: 6.365 Test Acc: 0.220
Validation loss decreased (-0.199969 --> -0.219936).  Saving model ...
Epoch: 9 cost time: 1.0721371173858643
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.210 Vali Acc: 0.220 Test Loss: 6.210 Test Acc: 0.220
Validation loss decreased (-0.219936 --> -0.219938).  Saving model ...
Epoch: 10 cost time: 1.0968151092529297
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.160 Vali Acc: 0.200 Test Loss: 6.160 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1307957172393799
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.106 Vali Acc: 0.200 Test Loss: 6.106 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0504124164581299
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.017 Vali Acc: 0.200 Test Loss: 6.017 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.08195161819458
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.016 Vali Acc: 0.200 Test Loss: 6.016 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1026928424835205
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.943 Vali Acc: 0.200 Test Loss: 5.943 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1332759857177734
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.913 Vali Acc: 0.200 Test Loss: 5.913 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1963145732879639
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.875 Vali Acc: 0.200 Test Loss: 5.875 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1090238094329834
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.839 Vali Acc: 0.200 Test Loss: 5.839 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9797379970550537
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.819 Vali Acc: 0.200 Test Loss: 5.819 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1336703300476074
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.801 Vali Acc: 0.200 Test Loss: 5.801 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df128_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 1087685
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.559372901916504
Epoch: 1, Steps: 13 | Train Loss: 1.750 Vali Loss: 1.974 Vali Acc: 0.200 Test Loss: 1.974 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 0.995966911315918
Epoch: 2, Steps: 13 | Train Loss: 0.146 Vali Loss: 2.424 Vali Acc: 0.180 Test Loss: 2.424 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.934828519821167
Epoch: 3, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.900 Vali Acc: 0.200 Test Loss: 2.900 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.857738733291626
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.127 Vali Acc: 0.180 Test Loss: 3.127 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0411860942840576
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.309 Vali Acc: 0.180 Test Loss: 3.309 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9623918533325195
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.339 Vali Acc: 0.180 Test Loss: 3.339 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9107542037963867
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.283 Vali Acc: 0.180 Test Loss: 3.283 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0292737483978271
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.261 Vali Acc: 0.200 Test Loss: 3.261 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9300732612609863
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.232 Vali Acc: 0.200 Test Loss: 3.232 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9688959121704102
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.218 Vali Acc: 0.200 Test Loss: 3.218 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9900434017181396
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.199 Vali Acc: 0.200 Test Loss: 3.199 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 765109
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.425710439682007
Epoch: 1, Steps: 25 | Train Loss: 11.955 Vali Loss: 11.808 Vali Acc: 0.200 Test Loss: 11.808 Test Acc: 0.200
Validation loss decreased (inf --> -0.199882).  Saving model ...
Epoch: 2 cost time: 2.8152570724487305
Epoch: 2, Steps: 25 | Train Loss: 6.258 Vali Loss: 48.100 Vali Acc: 0.200 Test Loss: 48.100 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.868772268295288
Epoch: 3, Steps: 25 | Train Loss: 5.277 Vali Loss: 47.674 Vali Acc: 0.180 Test Loss: 47.674 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.877499580383301
Epoch: 4, Steps: 25 | Train Loss: 4.488 Vali Loss: 38.746 Vali Acc: 0.240 Test Loss: 38.746 Test Acc: 0.240
Validation loss decreased (-0.199882 --> -0.239613).  Saving model ...
Epoch: 5 cost time: 2.9674956798553467
Epoch: 5, Steps: 25 | Train Loss: 2.176 Vali Loss: 83.347 Vali Acc: 0.180 Test Loss: 83.347 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.844714403152466
Epoch: 6, Steps: 25 | Train Loss: 5.052 Vali Loss: 62.346 Vali Acc: 0.240 Test Loss: 62.346 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.922745943069458
Epoch: 7, Steps: 25 | Train Loss: 6.356 Vali Loss: 69.373 Vali Acc: 0.240 Test Loss: 69.373 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8879289627075195
Epoch: 8, Steps: 25 | Train Loss: 1.378 Vali Loss: 127.643 Vali Acc: 0.240 Test Loss: 127.643 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9090018272399902
Epoch: 9, Steps: 25 | Train Loss: 4.492 Vali Loss: 111.361 Vali Acc: 0.180 Test Loss: 111.361 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8488829135894775
Epoch: 10, Steps: 25 | Train Loss: 13.267 Vali Loss: 91.999 Vali Acc: 0.140 Test Loss: 91.999 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.9074203968048096
Epoch: 11, Steps: 25 | Train Loss: 16.764 Vali Loss: 180.109 Vali Acc: 0.200 Test Loss: 180.109 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.0442676544189453
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 171.756 Vali Acc: 0.100 Test Loss: 171.756 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8238461017608643
Epoch: 13, Steps: 25 | Train Loss: 1.652 Vali Loss: 136.102 Vali Acc: 0.180 Test Loss: 136.102 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.828392744064331
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 133.715 Vali Acc: 0.200 Test Loss: 133.715 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 7215909
model size : 27.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2446348667144775
Epoch: 1, Steps: 13 | Train Loss: 2.927 Vali Loss: 2.985 Vali Acc: 0.200 Test Loss: 2.985 Test Acc: 0.200
Validation loss decreased (inf --> -0.199970).  Saving model ...
Epoch: 2 cost time: 1.808633804321289
Epoch: 2, Steps: 13 | Train Loss: 0.276 Vali Loss: 15.967 Vali Acc: 0.200 Test Loss: 15.967 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8042290210723877
Epoch: 3, Steps: 13 | Train Loss: 1.096 Vali Loss: 20.245 Vali Acc: 0.160 Test Loss: 20.245 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7312774658203125
Epoch: 4, Steps: 13 | Train Loss: 0.170 Vali Loss: 16.218 Vali Acc: 0.260 Test Loss: 16.218 Test Acc: 0.260
Validation loss decreased (-0.199970 --> -0.259838).  Saving model ...
Epoch: 5 cost time: 1.8090760707855225
Epoch: 5, Steps: 13 | Train Loss: 0.535 Vali Loss: 22.754 Vali Acc: 0.260 Test Loss: 22.754 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6777994632720947
Epoch: 6, Steps: 13 | Train Loss: 3.441 Vali Loss: 30.930 Vali Acc: 0.180 Test Loss: 30.930 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8490324020385742
Epoch: 7, Steps: 13 | Train Loss: 0.415 Vali Loss: 24.440 Vali Acc: 0.200 Test Loss: 24.440 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.613457202911377
Epoch: 8, Steps: 13 | Train Loss: 0.154 Vali Loss: 34.386 Vali Acc: 0.140 Test Loss: 34.386 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6103096008300781
Epoch: 9, Steps: 13 | Train Loss: 1.015 Vali Loss: 28.485 Vali Acc: 0.200 Test Loss: 28.485 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.621678113937378
Epoch: 10, Steps: 13 | Train Loss: 0.262 Vali Loss: 34.362 Vali Acc: 0.160 Test Loss: 34.362 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8138229846954346
Epoch: 11, Steps: 13 | Train Loss: 0.798 Vali Loss: 43.503 Vali Acc: 0.200 Test Loss: 43.503 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7306804656982422
Epoch: 12, Steps: 13 | Train Loss: 1.814 Vali Loss: 68.179 Vali Acc: 0.160 Test Loss: 68.179 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.609586238861084
Epoch: 13, Steps: 13 | Train Loss: 3.844 Vali Loss: 47.618 Vali Acc: 0.140 Test Loss: 47.618 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.55991530418396
Epoch: 14, Steps: 13 | Train Loss: 0.632 Vali Loss: 41.231 Vali Acc: 0.200 Test Loss: 41.231 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 4095621
model size : 15.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9271838665008545
Epoch: 1, Steps: 13 | Train Loss: 2.166 Vali Loss: 5.930 Vali Acc: 0.200 Test Loss: 5.930 Test Acc: 0.200
Validation loss decreased (inf --> -0.199941).  Saving model ...
Epoch: 2 cost time: 1.404083013534546
Epoch: 2, Steps: 13 | Train Loss: 0.215 Vali Loss: 6.607 Vali Acc: 0.160 Test Loss: 6.607 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.340813398361206
Epoch: 3, Steps: 13 | Train Loss: 0.235 Vali Loss: 9.387 Vali Acc: 0.260 Test Loss: 9.387 Test Acc: 0.260
Validation loss decreased (-0.199941 --> -0.259906).  Saving model ...
Epoch: 4 cost time: 1.2509076595306396
Epoch: 4, Steps: 13 | Train Loss: 0.052 Vali Loss: 9.438 Vali Acc: 0.200 Test Loss: 9.438 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4297645092010498
Epoch: 5, Steps: 13 | Train Loss: 0.169 Vali Loss: 9.695 Vali Acc: 0.220 Test Loss: 9.695 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2433297634124756
Epoch: 6, Steps: 13 | Train Loss: 0.317 Vali Loss: 14.245 Vali Acc: 0.140 Test Loss: 14.245 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.306133508682251
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 13.856 Vali Acc: 0.180 Test Loss: 13.856 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3617756366729736
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.662 Vali Acc: 0.240 Test Loss: 14.662 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.261063814163208
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.604 Vali Acc: 0.200 Test Loss: 14.604 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.386267900466919
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.612 Vali Acc: 0.200 Test Loss: 14.612 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3842418193817139
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.537 Vali Acc: 0.200 Test Loss: 14.537 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4870166778564453
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.473 Vali Acc: 0.200 Test Loss: 14.473 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.260284185409546
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.460 Vali Acc: 0.200 Test Loss: 14.460 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 2589333
model size : 10.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df64_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.681717872619629
Epoch: 1, Steps: 13 | Train Loss: 2.206 Vali Loss: 2.622 Vali Acc: 0.180 Test Loss: 2.622 Test Acc: 0.180
Validation loss decreased (inf --> -0.179974).  Saving model ...
Epoch: 2 cost time: 1.155562162399292
Epoch: 2, Steps: 13 | Train Loss: 0.031 Vali Loss: 4.698 Vali Acc: 0.160 Test Loss: 4.698 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.244140625
Epoch: 3, Steps: 13 | Train Loss: 0.128 Vali Loss: 7.457 Vali Acc: 0.220 Test Loss: 7.457 Test Acc: 0.220
Validation loss decreased (-0.179974 --> -0.219925).  Saving model ...
Epoch: 4 cost time: 1.1612088680267334
Epoch: 4, Steps: 13 | Train Loss: 0.047 Vali Loss: 5.607 Vali Acc: 0.200 Test Loss: 5.607 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1919302940368652
Epoch: 5, Steps: 13 | Train Loss: 0.001 Vali Loss: 6.143 Vali Acc: 0.240 Test Loss: 6.143 Test Acc: 0.240
Validation loss decreased (-0.219925 --> -0.239939).  Saving model ...
Epoch: 6 cost time: 1.193213701248169
Epoch: 6, Steps: 13 | Train Loss: 0.139 Vali Loss: 9.572 Vali Acc: 0.220 Test Loss: 9.572 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.332341194152832
Epoch: 7, Steps: 13 | Train Loss: 0.026 Vali Loss: 18.677 Vali Acc: 0.220 Test Loss: 18.677 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3505370616912842
Epoch: 8, Steps: 13 | Train Loss: 1.287 Vali Loss: 15.381 Vali Acc: 0.180 Test Loss: 15.381 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2405378818511963
Epoch: 9, Steps: 13 | Train Loss: 0.350 Vali Loss: 28.866 Vali Acc: 0.200 Test Loss: 28.866 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2243483066558838
Epoch: 10, Steps: 13 | Train Loss: 1.995 Vali Loss: 19.868 Vali Acc: 0.200 Test Loss: 19.868 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.212648630142212
Epoch: 11, Steps: 13 | Train Loss: 3.010 Vali Loss: 36.416 Vali Acc: 0.160 Test Loss: 36.416 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2688095569610596
Epoch: 12, Steps: 13 | Train Loss: 1.201 Vali Loss: 33.862 Vali Acc: 0.140 Test Loss: 33.862 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.149914026260376
Epoch: 13, Steps: 13 | Train Loss: 0.596 Vali Loss: 26.293 Vali Acc: 0.120 Test Loss: 26.293 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1709027290344238
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.754 Vali Acc: 0.140 Test Loss: 26.754 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1503195762634277
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 27.505 Vali Acc: 0.160 Test Loss: 27.505 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df64_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 2051429
model size : 8.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5334413051605225
Epoch: 1, Steps: 13 | Train Loss: 2.177 Vali Loss: 2.638 Vali Acc: 0.140 Test Loss: 2.638 Test Acc: 0.140
Validation loss decreased (inf --> -0.139974).  Saving model ...
Epoch: 2 cost time: 1.032200574874878
Epoch: 2, Steps: 13 | Train Loss: 0.098 Vali Loss: 4.459 Vali Acc: 0.180 Test Loss: 4.459 Test Acc: 0.180
Validation loss decreased (-0.139974 --> -0.179955).  Saving model ...
Epoch: 3 cost time: 1.031595230102539
Epoch: 3, Steps: 13 | Train Loss: 0.037 Vali Loss: 6.007 Vali Acc: 0.180 Test Loss: 6.007 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9865660667419434
Epoch: 4, Steps: 13 | Train Loss: 0.003 Vali Loss: 5.068 Vali Acc: 0.260 Test Loss: 5.068 Test Acc: 0.260
Validation loss decreased (-0.179955 --> -0.259949).  Saving model ...
Epoch: 5 cost time: 1.0447051525115967
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.134 Vali Acc: 0.280 Test Loss: 6.134 Test Acc: 0.280
Validation loss decreased (-0.259949 --> -0.279939).  Saving model ...
Epoch: 6 cost time: 1.130948781967163
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.130 Vali Acc: 0.260 Test Loss: 6.130 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0523293018341064
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.098 Vali Acc: 0.260 Test Loss: 6.098 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.102116584777832
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.983 Vali Acc: 0.260 Test Loss: 5.983 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0627751350402832
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.947 Vali Acc: 0.260 Test Loss: 5.947 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0314826965332031
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.919 Vali Acc: 0.260 Test Loss: 5.919 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1270263195037842
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.903 Vali Acc: 0.240 Test Loss: 5.903 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.080461025238037
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.875 Vali Acc: 0.240 Test Loss: 5.875 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9236640930175781
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.842 Vali Acc: 0.240 Test Loss: 5.842 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9663567543029785
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.839 Vali Acc: 0.240 Test Loss: 5.839 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0520846843719482
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.834 Vali Acc: 0.240 Test Loss: 5.834 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 1298453
model size : 5.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df64_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7221364974975586
Epoch: 1, Steps: 13 | Train Loss: 2.037 Vali Loss: 2.107 Vali Acc: 0.240 Test Loss: 2.107 Test Acc: 0.240
Validation loss decreased (inf --> -0.239979).  Saving model ...
Epoch: 2 cost time: 1.0650122165679932
Epoch: 2, Steps: 13 | Train Loss: 0.157 Vali Loss: 3.751 Vali Acc: 0.200 Test Loss: 3.751 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0344085693359375
Epoch: 3, Steps: 13 | Train Loss: 0.002 Vali Loss: 4.808 Vali Acc: 0.240 Test Loss: 4.808 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.122563362121582
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.116 Vali Acc: 0.100 Test Loss: 5.116 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.093876838684082
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.175 Vali Acc: 0.160 Test Loss: 5.175 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0401484966278076
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.091 Vali Acc: 0.180 Test Loss: 5.091 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9746274948120117
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.044 Vali Acc: 0.200 Test Loss: 5.044 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.012110710144043
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.050 Vali Acc: 0.200 Test Loss: 5.050 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9555096626281738
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.028 Vali Acc: 0.180 Test Loss: 5.028 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1119022369384766
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.048 Vali Acc: 0.180 Test Loss: 5.048 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.006312370300293
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.061 Vali Acc: 0.180 Test Loss: 5.061 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df64_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 1083461
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4123096466064453
Epoch: 1, Steps: 13 | Train Loss: 1.997 Vali Loss: 1.787 Vali Acc: 0.240 Test Loss: 1.787 Test Acc: 0.240
Validation loss decreased (inf --> -0.239982).  Saving model ...
Epoch: 2 cost time: 0.7639412879943848
Epoch: 2, Steps: 13 | Train Loss: 0.179 Vali Loss: 2.339 Vali Acc: 0.220 Test Loss: 2.339 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8826255798339844
Epoch: 3, Steps: 13 | Train Loss: 0.012 Vali Loss: 3.103 Vali Acc: 0.200 Test Loss: 3.103 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9221537113189697
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.405 Vali Acc: 0.240 Test Loss: 3.405 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.889228343963623
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.493 Vali Acc: 0.280 Test Loss: 3.493 Test Acc: 0.280
Validation loss decreased (-0.239982 --> -0.279965).  Saving model ...
Epoch: 6 cost time: 0.8535680770874023
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.498 Vali Acc: 0.280 Test Loss: 3.498 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.877673864364624
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.475 Vali Acc: 0.300 Test Loss: 3.475 Test Acc: 0.300
Validation loss decreased (-0.279965 --> -0.299965).  Saving model ...
Epoch: 8 cost time: 0.9468607902526855
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.475 Vali Acc: 0.300 Test Loss: 3.475 Test Acc: 0.300
Validation loss decreased (-0.299965 --> -0.299965).  Saving model ...
Epoch: 9 cost time: 0.8781640529632568
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.433 Vali Acc: 0.300 Test Loss: 3.433 Test Acc: 0.300
Validation loss decreased (-0.299965 --> -0.299966).  Saving model ...
Epoch: 10 cost time: 0.9312028884887695
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.440 Vali Acc: 0.300 Test Loss: 3.440 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1536023616790771
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.433 Vali Acc: 0.300 Test Loss: 3.433 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7827160358428955
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.429 Vali Acc: 0.300 Test Loss: 3.429 Test Acc: 0.300
Validation loss decreased (-0.299966 --> -0.299966).  Saving model ...
Epoch: 13 cost time: 0.9275195598602295
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.428 Vali Acc: 0.300 Test Loss: 3.428 Test Acc: 0.300
Validation loss decreased (-0.299966 --> -0.299966).  Saving model ...
Epoch: 14 cost time: 0.8626682758331299
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.431 Vali Acc: 0.300 Test Loss: 3.431 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8740661144256592
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.423 Vali Acc: 0.300 Test Loss: 3.423 Test Acc: 0.300
Validation loss decreased (-0.299966 --> -0.299966).  Saving model ...
Epoch: 16 cost time: 1.0077505111694336
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.426 Vali Acc: 0.260 Test Loss: 3.426 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8048975467681885
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.427 Vali Acc: 0.300 Test Loss: 3.427 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.835050106048584
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.427 Vali Acc: 0.260 Test Loss: 3.427 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8351082801818848
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.433 Vali Acc: 0.260 Test Loss: 3.433 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.803419828414917
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.430 Vali Acc: 0.280 Test Loss: 3.430 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8899548053741455
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.434 Vali Acc: 0.300 Test Loss: 3.434 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8660938739776611
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.427 Vali Acc: 0.280 Test Loss: 3.427 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8778729438781738
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.419 Vali Acc: 0.260 Test Loss: 3.419 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9071145057678223
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.430 Vali Acc: 0.260 Test Loss: 3.430 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8196489810943604
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.438 Vali Acc: 0.260 Test Loss: 3.438 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el2_dm16_nh4_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 760885
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.925852537155151
Epoch: 1, Steps: 25 | Train Loss: 90.198 Vali Loss: 107.335 Vali Acc: 0.180 Test Loss: 107.335 Test Acc: 0.180
Validation loss decreased (inf --> -0.178927).  Saving model ...
Epoch: 2 cost time: 7.369938611984253
Epoch: 2, Steps: 25 | Train Loss: 46.042 Vali Loss: 223.559 Vali Acc: 0.220 Test Loss: 223.559 Test Acc: 0.220
Validation loss decreased (-0.178927 --> -0.217764).  Saving model ...
Epoch: 3 cost time: 7.332123279571533
Epoch: 3, Steps: 25 | Train Loss: 31.311 Vali Loss: 267.110 Vali Acc: 0.160 Test Loss: 267.110 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.339571475982666
Epoch: 4, Steps: 25 | Train Loss: 25.205 Vali Loss: 456.273 Vali Acc: 0.160 Test Loss: 456.273 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.404676198959351
Epoch: 5, Steps: 25 | Train Loss: 39.342 Vali Loss: 790.214 Vali Acc: 0.200 Test Loss: 790.214 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.333964109420776
Epoch: 6, Steps: 25 | Train Loss: 18.567 Vali Loss: 422.568 Vali Acc: 0.200 Test Loss: 422.568 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.575303316116333
Epoch: 7, Steps: 25 | Train Loss: 1.806 Vali Loss: 387.710 Vali Acc: 0.260 Test Loss: 387.710 Test Acc: 0.260
Validation loss decreased (-0.217764 --> -0.256123).  Saving model ...
Epoch: 8 cost time: 7.457242488861084
Epoch: 8, Steps: 25 | Train Loss: 21.822 Vali Loss: 278.594 Vali Acc: 0.260 Test Loss: 278.594 Test Acc: 0.260
Validation loss decreased (-0.256123 --> -0.257214).  Saving model ...
Epoch: 9 cost time: 7.291330099105835
Epoch: 9, Steps: 25 | Train Loss: 21.076 Vali Loss: 322.738 Vali Acc: 0.240 Test Loss: 322.738 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.521531581878662
Epoch: 10, Steps: 25 | Train Loss: 5.658 Vali Loss: 315.624 Vali Acc: 0.260 Test Loss: 315.624 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.536625385284424
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 352.548 Vali Acc: 0.180 Test Loss: 352.548 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.524748802185059
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 366.159 Vali Acc: 0.140 Test Loss: 366.159 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.692229986190796
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 370.446 Vali Acc: 0.140 Test Loss: 370.446 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.65645432472229
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 373.245 Vali Acc: 0.160 Test Loss: 373.245 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.5563318729400635
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 368.486 Vali Acc: 0.140 Test Loss: 368.486 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.640124082565308
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 371.255 Vali Acc: 0.160 Test Loss: 371.255 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.612473249435425
Epoch: 17, Steps: 25 | Train Loss: 0.000 Vali Loss: 369.241 Vali Acc: 0.140 Test Loss: 369.241 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.5674755573272705
Epoch: 18, Steps: 25 | Train Loss: 0.000 Vali Loss: 371.210 Vali Acc: 0.160 Test Loss: 371.210 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 57807237
model size : 222.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.463603258132935
Epoch: 1, Steps: 13 | Train Loss: 12.423 Vali Loss: 38.207 Vali Acc: 0.160 Test Loss: 38.207 Test Acc: 0.160
Validation loss decreased (inf --> -0.159618).  Saving model ...
Epoch: 2 cost time: 3.7867298126220703
Epoch: 2, Steps: 13 | Train Loss: 8.407 Vali Loss: 101.385 Vali Acc: 0.080 Test Loss: 101.385 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.838236093521118
Epoch: 3, Steps: 13 | Train Loss: 6.415 Vali Loss: 208.233 Vali Acc: 0.200 Test Loss: 208.233 Test Acc: 0.200
Validation loss decreased (-0.159618 --> -0.197918).  Saving model ...
Epoch: 4 cost time: 3.931412935256958
Epoch: 4, Steps: 13 | Train Loss: 6.795 Vali Loss: 223.578 Vali Acc: 0.180 Test Loss: 223.578 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8110148906707764
Epoch: 5, Steps: 13 | Train Loss: 8.343 Vali Loss: 156.558 Vali Acc: 0.160 Test Loss: 156.558 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7206716537475586
Epoch: 6, Steps: 13 | Train Loss: 10.344 Vali Loss: 132.200 Vali Acc: 0.200 Test Loss: 132.200 Test Acc: 0.200
Validation loss decreased (-0.197918 --> -0.198678).  Saving model ...
Epoch: 7 cost time: 3.7048356533050537
Epoch: 7, Steps: 13 | Train Loss: 4.011 Vali Loss: 234.382 Vali Acc: 0.160 Test Loss: 234.382 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.816009759902954
Epoch: 8, Steps: 13 | Train Loss: 2.397 Vali Loss: 268.737 Vali Acc: 0.140 Test Loss: 268.737 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9319169521331787
Epoch: 9, Steps: 13 | Train Loss: 0.128 Vali Loss: 259.268 Vali Acc: 0.180 Test Loss: 259.268 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.988577365875244
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 260.365 Vali Acc: 0.180 Test Loss: 260.365 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.941380500793457
Epoch: 11, Steps: 13 | Train Loss: 1.303 Vali Loss: 261.709 Vali Acc: 0.140 Test Loss: 261.709 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.812098979949951
Epoch: 12, Steps: 13 | Train Loss: 2.423 Vali Loss: 274.346 Vali Acc: 0.120 Test Loss: 274.346 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.8013124465942383
Epoch: 13, Steps: 13 | Train Loss: 0.993 Vali Loss: 282.558 Vali Acc: 0.140 Test Loss: 282.558 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.752399444580078
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 316.113 Vali Acc: 0.160 Test Loss: 316.113 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.7594501972198486
Epoch: 15, Steps: 13 | Train Loss: 0.004 Vali Loss: 302.973 Vali Acc: 0.200 Test Loss: 302.973 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.987680435180664
Epoch: 16, Steps: 13 | Train Loss: 1.027 Vali Loss: 313.027 Vali Acc: 0.180 Test Loss: 313.027 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 32844933
model size : 127.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8062305450439453
Epoch: 1, Steps: 13 | Train Loss: 9.053 Vali Loss: 15.790 Vali Acc: 0.240 Test Loss: 15.790 Test Acc: 0.240
Validation loss decreased (inf --> -0.239842).  Saving model ...
Epoch: 2 cost time: 2.172584295272827
Epoch: 2, Steps: 13 | Train Loss: 7.458 Vali Loss: 58.326 Vali Acc: 0.200 Test Loss: 58.326 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.194688558578491
Epoch: 3, Steps: 13 | Train Loss: 2.100 Vali Loss: 59.127 Vali Acc: 0.060 Test Loss: 59.127 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2170042991638184
Epoch: 4, Steps: 13 | Train Loss: 0.935 Vali Loss: 81.982 Vali Acc: 0.180 Test Loss: 81.982 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.199462652206421
Epoch: 5, Steps: 13 | Train Loss: 0.552 Vali Loss: 102.861 Vali Acc: 0.140 Test Loss: 102.861 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.18106746673584
Epoch: 6, Steps: 13 | Train Loss: 1.266 Vali Loss: 170.224 Vali Acc: 0.200 Test Loss: 170.224 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.234408378601074
Epoch: 7, Steps: 13 | Train Loss: 8.798 Vali Loss: 170.567 Vali Acc: 0.200 Test Loss: 170.567 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.216348886489868
Epoch: 8, Steps: 13 | Train Loss: 4.490 Vali Loss: 95.319 Vali Acc: 0.180 Test Loss: 95.319 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.246091842651367
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 106.021 Vali Acc: 0.220 Test Loss: 106.021 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.409127950668335
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 143.580 Vali Acc: 0.160 Test Loss: 143.580 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.3064186573028564
Epoch: 11, Steps: 13 | Train Loss: 0.118 Vali Loss: 149.696 Vali Acc: 0.240 Test Loss: 149.696 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 20794629
model size : 81.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df256_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.47412371635437
Epoch: 1, Steps: 13 | Train Loss: 7.785 Vali Loss: 22.484 Vali Acc: 0.220 Test Loss: 22.484 Test Acc: 0.220
Validation loss decreased (inf --> -0.219775).  Saving model ...
Epoch: 2 cost time: 1.831660509109497
Epoch: 2, Steps: 13 | Train Loss: 2.393 Vali Loss: 61.184 Vali Acc: 0.180 Test Loss: 61.184 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.951869010925293
Epoch: 3, Steps: 13 | Train Loss: 1.723 Vali Loss: 82.565 Vali Acc: 0.200 Test Loss: 82.565 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9425079822540283
Epoch: 4, Steps: 13 | Train Loss: 0.515 Vali Loss: 111.461 Vali Acc: 0.220 Test Loss: 111.461 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.85575270652771
Epoch: 5, Steps: 13 | Train Loss: 3.923 Vali Loss: 77.493 Vali Acc: 0.180 Test Loss: 77.493 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8682236671447754
Epoch: 6, Steps: 13 | Train Loss: 1.916 Vali Loss: 91.305 Vali Acc: 0.260 Test Loss: 91.305 Test Acc: 0.260
Validation loss decreased (-0.219775 --> -0.259087).  Saving model ...
Epoch: 7 cost time: 2.0175974369049072
Epoch: 7, Steps: 13 | Train Loss: 2.726 Vali Loss: 95.006 Vali Acc: 0.200 Test Loss: 95.006 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8541710376739502
Epoch: 8, Steps: 13 | Train Loss: 0.461 Vali Loss: 85.741 Vali Acc: 0.180 Test Loss: 85.741 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9789280891418457
Epoch: 9, Steps: 13 | Train Loss: 0.397 Vali Loss: 133.109 Vali Acc: 0.220 Test Loss: 133.109 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9206624031066895
Epoch: 10, Steps: 13 | Train Loss: 9.128 Vali Loss: 134.601 Vali Acc: 0.120 Test Loss: 134.601 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9611427783966064
Epoch: 11, Steps: 13 | Train Loss: 17.961 Vali Loss: 184.674 Vali Acc: 0.160 Test Loss: 184.674 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8910424709320068
Epoch: 12, Steps: 13 | Train Loss: 5.530 Vali Loss: 227.940 Vali Acc: 0.140 Test Loss: 227.940 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9607739448547363
Epoch: 13, Steps: 13 | Train Loss: 2.190 Vali Loss: 177.188 Vali Acc: 0.120 Test Loss: 177.188 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.858837604522705
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 201.373 Vali Acc: 0.120 Test Loss: 201.373 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9128344058990479
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 212.059 Vali Acc: 0.200 Test Loss: 212.059 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.854412317276001
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 215.413 Vali Acc: 0.180 Test Loss: 215.413 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df256_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 16491397
model size : 65.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0892856121063232
Epoch: 1, Steps: 13 | Train Loss: 3.587 Vali Loss: 9.385 Vali Acc: 0.140 Test Loss: 9.385 Test Acc: 0.140
Validation loss decreased (inf --> -0.139906).  Saving model ...
Epoch: 2 cost time: 1.5352294445037842
Epoch: 2, Steps: 13 | Train Loss: 2.976 Vali Loss: 23.304 Vali Acc: 0.160 Test Loss: 23.304 Test Acc: 0.160
Validation loss decreased (-0.139906 --> -0.159767).  Saving model ...
Epoch: 3 cost time: 1.5095140933990479
Epoch: 3, Steps: 13 | Train Loss: 0.460 Vali Loss: 50.560 Vali Acc: 0.200 Test Loss: 50.560 Test Acc: 0.200
Validation loss decreased (-0.159767 --> -0.199494).  Saving model ...
Epoch: 4 cost time: 1.5302729606628418
Epoch: 4, Steps: 13 | Train Loss: 1.340 Vali Loss: 31.806 Vali Acc: 0.040 Test Loss: 31.806 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.555074691772461
Epoch: 5, Steps: 13 | Train Loss: 1.115 Vali Loss: 40.993 Vali Acc: 0.100 Test Loss: 40.993 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.54390287399292
Epoch: 6, Steps: 13 | Train Loss: 1.323 Vali Loss: 71.818 Vali Acc: 0.180 Test Loss: 71.818 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6293635368347168
Epoch: 7, Steps: 13 | Train Loss: 0.568 Vali Loss: 52.068 Vali Acc: 0.160 Test Loss: 52.068 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5501477718353271
Epoch: 8, Steps: 13 | Train Loss: 0.034 Vali Loss: 55.216 Vali Acc: 0.160 Test Loss: 55.216 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.563697338104248
Epoch: 9, Steps: 13 | Train Loss: 0.469 Vali Loss: 91.538 Vali Acc: 0.140 Test Loss: 91.538 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.500452995300293
Epoch: 10, Steps: 13 | Train Loss: 2.687 Vali Loss: 66.783 Vali Acc: 0.180 Test Loss: 66.783 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.576085090637207
Epoch: 11, Steps: 13 | Train Loss: 3.331 Vali Loss: 68.144 Vali Acc: 0.180 Test Loss: 68.144 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6194796562194824
Epoch: 12, Steps: 13 | Train Loss: 0.635 Vali Loss: 106.404 Vali Acc: 0.220 Test Loss: 106.404 Test Acc: 0.220
Validation loss decreased (-0.199494 --> -0.218936).  Saving model ...
Epoch: 13 cost time: 1.6192448139190674
Epoch: 13, Steps: 13 | Train Loss: 0.143 Vali Loss: 87.181 Vali Acc: 0.200 Test Loss: 87.181 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6414451599121094
Epoch: 14, Steps: 13 | Train Loss: 0.066 Vali Loss: 112.375 Vali Acc: 0.200 Test Loss: 112.375 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4360380172729492
Epoch: 15, Steps: 13 | Train Loss: 0.031 Vali Loss: 108.835 Vali Acc: 0.220 Test Loss: 108.835 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.51090407371521
Epoch: 16, Steps: 13 | Train Loss: 0.067 Vali Loss: 94.053 Vali Acc: 0.320 Test Loss: 94.053 Test Acc: 0.320
Validation loss decreased (-0.218936 --> -0.319059).  Saving model ...
Epoch: 17 cost time: 1.5438265800476074
Epoch: 17, Steps: 13 | Train Loss: 0.192 Vali Loss: 90.399 Vali Acc: 0.340 Test Loss: 90.399 Test Acc: 0.340
Validation loss decreased (-0.319059 --> -0.339096).  Saving model ...
Epoch: 18 cost time: 1.5615572929382324
Epoch: 18, Steps: 13 | Train Loss: 0.230 Vali Loss: 86.452 Vali Acc: 0.320 Test Loss: 86.452 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.509889841079712
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 117.818 Vali Acc: 0.160 Test Loss: 117.818 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6085810661315918
Epoch: 20, Steps: 13 | Train Loss: 0.569 Vali Loss: 97.253 Vali Acc: 0.300 Test Loss: 97.253 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6254370212554932
Epoch: 21, Steps: 13 | Train Loss: 0.017 Vali Loss: 104.533 Vali Acc: 0.240 Test Loss: 104.533 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.578132152557373
Epoch: 22, Steps: 13 | Train Loss: 0.266 Vali Loss: 125.779 Vali Acc: 0.220 Test Loss: 125.779 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5934369564056396
Epoch: 23, Steps: 13 | Train Loss: 1.547 Vali Loss: 114.410 Vali Acc: 0.220 Test Loss: 114.410 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5771136283874512
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 150.714 Vali Acc: 0.200 Test Loss: 150.714 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.51084566116333
Epoch: 25, Steps: 13 | Train Loss: 2.759 Vali Loss: 117.423 Vali Acc: 0.160 Test Loss: 117.423 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7971572875976562
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 119.551 Vali Acc: 0.240 Test Loss: 119.551 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.602231502532959
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 121.457 Vali Acc: 0.280 Test Loss: 121.457 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 10467589
model size : 42.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df256_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0136005878448486
Epoch: 1, Steps: 13 | Train Loss: 3.204 Vali Loss: 9.660 Vali Acc: 0.120 Test Loss: 9.660 Test Acc: 0.120
Validation loss decreased (inf --> -0.119903).  Saving model ...
Epoch: 2 cost time: 1.3309850692749023
Epoch: 2, Steps: 13 | Train Loss: 0.517 Vali Loss: 19.265 Vali Acc: 0.200 Test Loss: 19.265 Test Acc: 0.200
Validation loss decreased (-0.119903 --> -0.199807).  Saving model ...
Epoch: 3 cost time: 1.481048583984375
Epoch: 3, Steps: 13 | Train Loss: 0.005 Vali Loss: 29.665 Vali Acc: 0.200 Test Loss: 29.665 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4245977401733398
Epoch: 4, Steps: 13 | Train Loss: 0.771 Vali Loss: 37.115 Vali Acc: 0.180 Test Loss: 37.115 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3694593906402588
Epoch: 5, Steps: 13 | Train Loss: 0.345 Vali Loss: 45.805 Vali Acc: 0.220 Test Loss: 45.805 Test Acc: 0.220
Validation loss decreased (-0.199807 --> -0.219542).  Saving model ...
Epoch: 6 cost time: 1.458890676498413
Epoch: 6, Steps: 13 | Train Loss: 0.269 Vali Loss: 52.534 Vali Acc: 0.200 Test Loss: 52.534 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4541006088256836
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 59.968 Vali Acc: 0.180 Test Loss: 59.968 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3691956996917725
Epoch: 8, Steps: 13 | Train Loss: 0.093 Vali Loss: 42.912 Vali Acc: 0.160 Test Loss: 42.912 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3936104774475098
Epoch: 9, Steps: 13 | Train Loss: 1.475 Vali Loss: 57.461 Vali Acc: 0.160 Test Loss: 57.461 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4212546348571777
Epoch: 10, Steps: 13 | Train Loss: 0.766 Vali Loss: 81.400 Vali Acc: 0.180 Test Loss: 81.400 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3525381088256836
Epoch: 11, Steps: 13 | Train Loss: 2.632 Vali Loss: 81.724 Vali Acc: 0.200 Test Loss: 81.724 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2701358795166016
Epoch: 12, Steps: 13 | Train Loss: 3.002 Vali Loss: 89.946 Vali Acc: 0.160 Test Loss: 89.946 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3757596015930176
Epoch: 13, Steps: 13 | Train Loss: 2.629 Vali Loss: 94.908 Vali Acc: 0.200 Test Loss: 94.908 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3780543804168701
Epoch: 14, Steps: 13 | Train Loss: 2.074 Vali Loss: 86.654 Vali Acc: 0.240 Test Loss: 86.654 Test Acc: 0.240
Validation loss decreased (-0.219542 --> -0.239133).  Saving model ...
Epoch: 15 cost time: 1.369126796722412
Epoch: 15, Steps: 13 | Train Loss: 0.376 Vali Loss: 109.174 Vali Acc: 0.260 Test Loss: 109.174 Test Acc: 0.260
Validation loss decreased (-0.239133 --> -0.258908).  Saving model ...
Epoch: 16 cost time: 1.34645414352417
Epoch: 16, Steps: 13 | Train Loss: 0.120 Vali Loss: 133.103 Vali Acc: 0.200 Test Loss: 133.103 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3639006614685059
Epoch: 17, Steps: 13 | Train Loss: 0.454 Vali Loss: 138.530 Vali Acc: 0.220 Test Loss: 138.530 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.332728385925293
Epoch: 18, Steps: 13 | Train Loss: 0.098 Vali Loss: 139.480 Vali Acc: 0.180 Test Loss: 139.480 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.396397590637207
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 143.280 Vali Acc: 0.220 Test Loss: 143.280 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4815032482147217
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 142.575 Vali Acc: 0.220 Test Loss: 142.575 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4664289951324463
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 140.414 Vali Acc: 0.200 Test Loss: 140.414 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.338433027267456
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 140.785 Vali Acc: 0.200 Test Loss: 140.785 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3565750122070312
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 139.101 Vali Acc: 0.200 Test Loss: 139.101 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3648021221160889
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 140.565 Vali Acc: 0.200 Test Loss: 140.565 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3452179431915283
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 139.054 Vali Acc: 0.200 Test Loss: 139.054 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df256_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 8747653
model size : 35.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6138486862182617
Epoch: 1, Steps: 13 | Train Loss: 3.070 Vali Loss: 5.949 Vali Acc: 0.200 Test Loss: 5.949 Test Acc: 0.200
Validation loss decreased (inf --> -0.199941).  Saving model ...
Epoch: 2 cost time: 1.2323458194732666
Epoch: 2, Steps: 13 | Train Loss: 0.004 Vali Loss: 8.620 Vali Acc: 0.240 Test Loss: 8.620 Test Acc: 0.240
Validation loss decreased (-0.199941 --> -0.239914).  Saving model ...
Epoch: 3 cost time: 1.1112539768218994
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.981 Vali Acc: 0.280 Test Loss: 10.981 Test Acc: 0.280
Validation loss decreased (-0.239914 --> -0.279890).  Saving model ...
Epoch: 4 cost time: 1.2251007556915283
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.939 Vali Acc: 0.280 Test Loss: 11.939 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1464953422546387
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.245 Vali Acc: 0.280 Test Loss: 12.245 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1335499286651611
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.454 Vali Acc: 0.260 Test Loss: 12.454 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.162719964981079
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.423 Vali Acc: 0.260 Test Loss: 12.423 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1132960319519043
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.381 Vali Acc: 0.280 Test Loss: 12.381 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2198851108551025
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.384 Vali Acc: 0.280 Test Loss: 12.384 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.140418291091919
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.386 Vali Acc: 0.280 Test Loss: 12.386 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2250099182128906
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.384 Vali Acc: 0.280 Test Loss: 12.384 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1874620914459229
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.385 Vali Acc: 0.280 Test Loss: 12.385 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1988539695739746
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.389 Vali Acc: 0.260 Test Loss: 12.389 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 6167045
model size : 25.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.06197452545166
Epoch: 1, Steps: 25 | Train Loss: 82.081 Vali Loss: 287.791 Vali Acc: 0.200 Test Loss: 287.791 Test Acc: 0.200
Validation loss decreased (inf --> -0.197122).  Saving model ...
Epoch: 2 cost time: 6.715026140213013
Epoch: 2, Steps: 25 | Train Loss: 133.044 Vali Loss: 325.185 Vali Acc: 0.160 Test Loss: 325.185 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.837944984436035
Epoch: 3, Steps: 25 | Train Loss: 91.135 Vali Loss: 363.866 Vali Acc: 0.160 Test Loss: 363.866 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.74772834777832
Epoch: 4, Steps: 25 | Train Loss: 43.921 Vali Loss: 277.401 Vali Acc: 0.260 Test Loss: 277.401 Test Acc: 0.260
Validation loss decreased (-0.197122 --> -0.257226).  Saving model ...
Epoch: 5 cost time: 6.888071060180664
Epoch: 5, Steps: 25 | Train Loss: 11.981 Vali Loss: 523.129 Vali Acc: 0.120 Test Loss: 523.129 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.819613218307495
Epoch: 6, Steps: 25 | Train Loss: 9.404 Vali Loss: 522.118 Vali Acc: 0.180 Test Loss: 522.118 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.826717853546143
Epoch: 7, Steps: 25 | Train Loss: 21.592 Vali Loss: 457.342 Vali Acc: 0.160 Test Loss: 457.342 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.80432915687561
Epoch: 8, Steps: 25 | Train Loss: 1.870 Vali Loss: 480.730 Vali Acc: 0.220 Test Loss: 480.730 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.8137733936309814
Epoch: 9, Steps: 25 | Train Loss: 0.111 Vali Loss: 569.217 Vali Acc: 0.160 Test Loss: 569.217 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.7614099979400635
Epoch: 10, Steps: 25 | Train Loss: 2.059 Vali Loss: 480.709 Vali Acc: 0.220 Test Loss: 480.709 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.946531057357788
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 569.402 Vali Acc: 0.240 Test Loss: 569.402 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.827329397201538
Epoch: 12, Steps: 25 | Train Loss: 2.113 Vali Loss: 444.873 Vali Acc: 0.220 Test Loss: 444.873 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.981510639190674
Epoch: 13, Steps: 25 | Train Loss: 1.861 Vali Loss: 502.101 Vali Acc: 0.180 Test Loss: 502.101 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.833917617797852
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 633.588 Vali Acc: 0.140 Test Loss: 633.588 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 57774341
model size : 222.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.869226694107056
Epoch: 1, Steps: 13 | Train Loss: 15.073 Vali Loss: 26.243 Vali Acc: 0.220 Test Loss: 26.243 Test Acc: 0.220
Validation loss decreased (inf --> -0.219738).  Saving model ...
Epoch: 2 cost time: 3.388885498046875
Epoch: 2, Steps: 13 | Train Loss: 12.370 Vali Loss: 124.662 Vali Acc: 0.180 Test Loss: 124.662 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4159820079803467
Epoch: 3, Steps: 13 | Train Loss: 1.377 Vali Loss: 144.224 Vali Acc: 0.180 Test Loss: 144.224 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.37081241607666
Epoch: 4, Steps: 13 | Train Loss: 7.925 Vali Loss: 217.877 Vali Acc: 0.200 Test Loss: 217.877 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.49436354637146
Epoch: 5, Steps: 13 | Train Loss: 24.699 Vali Loss: 277.180 Vali Acc: 0.200 Test Loss: 277.180 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.374121904373169
Epoch: 6, Steps: 13 | Train Loss: 0.480 Vali Loss: 152.342 Vali Acc: 0.220 Test Loss: 152.342 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.449525833129883
Epoch: 7, Steps: 13 | Train Loss: 1.209 Vali Loss: 177.326 Vali Acc: 0.140 Test Loss: 177.326 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.385885000228882
Epoch: 8, Steps: 13 | Train Loss: 6.192 Vali Loss: 199.470 Vali Acc: 0.200 Test Loss: 199.470 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.41827130317688
Epoch: 9, Steps: 13 | Train Loss: 17.714 Vali Loss: 223.860 Vali Acc: 0.180 Test Loss: 223.860 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.4188034534454346
Epoch: 10, Steps: 13 | Train Loss: 4.807 Vali Loss: 174.573 Vali Acc: 0.160 Test Loss: 174.573 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.389925718307495
Epoch: 11, Steps: 13 | Train Loss: 0.568 Vali Loss: 221.616 Vali Acc: 0.200 Test Loss: 221.616 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 32812037
model size : 127.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4851770401000977
Epoch: 1, Steps: 13 | Train Loss: 10.460 Vali Loss: 31.754 Vali Acc: 0.220 Test Loss: 31.754 Test Acc: 0.220
Validation loss decreased (inf --> -0.219682).  Saving model ...
Epoch: 2 cost time: 1.9539847373962402
Epoch: 2, Steps: 13 | Train Loss: 10.712 Vali Loss: 61.144 Vali Acc: 0.120 Test Loss: 61.144 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.984006404876709
Epoch: 3, Steps: 13 | Train Loss: 5.773 Vali Loss: 87.369 Vali Acc: 0.080 Test Loss: 87.369 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9704508781433105
Epoch: 4, Steps: 13 | Train Loss: 7.703 Vali Loss: 115.005 Vali Acc: 0.220 Test Loss: 115.005 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.905996561050415
Epoch: 5, Steps: 13 | Train Loss: 0.005 Vali Loss: 115.966 Vali Acc: 0.200 Test Loss: 115.966 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9393789768218994
Epoch: 6, Steps: 13 | Train Loss: 0.409 Vali Loss: 104.506 Vali Acc: 0.220 Test Loss: 104.506 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.915670394897461
Epoch: 7, Steps: 13 | Train Loss: 3.794 Vali Loss: 151.566 Vali Acc: 0.120 Test Loss: 151.566 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9372680187225342
Epoch: 8, Steps: 13 | Train Loss: 3.679 Vali Loss: 166.577 Vali Acc: 0.200 Test Loss: 166.577 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9702842235565186
Epoch: 9, Steps: 13 | Train Loss: 2.688 Vali Loss: 268.074 Vali Acc: 0.220 Test Loss: 268.074 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8939414024353027
Epoch: 10, Steps: 13 | Train Loss: 29.471 Vali Loss: 171.787 Vali Acc: 0.180 Test Loss: 171.787 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9223606586456299
Epoch: 11, Steps: 13 | Train Loss: 5.200 Vali Loss: 200.022 Vali Acc: 0.160 Test Loss: 200.022 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 20761733
model size : 81.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df128_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1966681480407715
Epoch: 1, Steps: 13 | Train Loss: 4.837 Vali Loss: 22.598 Vali Acc: 0.080 Test Loss: 22.598 Test Acc: 0.080
Validation loss decreased (inf --> -0.079774).  Saving model ...
Epoch: 2 cost time: 1.7307701110839844
Epoch: 2, Steps: 13 | Train Loss: 3.187 Vali Loss: 43.565 Vali Acc: 0.200 Test Loss: 43.565 Test Acc: 0.200
Validation loss decreased (-0.079774 --> -0.199564).  Saving model ...
Epoch: 3 cost time: 1.6923809051513672
Epoch: 3, Steps: 13 | Train Loss: 1.354 Vali Loss: 49.780 Vali Acc: 0.180 Test Loss: 49.780 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7489686012268066
Epoch: 4, Steps: 13 | Train Loss: 2.723 Vali Loss: 108.647 Vali Acc: 0.220 Test Loss: 108.647 Test Acc: 0.220
Validation loss decreased (-0.199564 --> -0.218914).  Saving model ...
Epoch: 5 cost time: 1.7007637023925781
Epoch: 5, Steps: 13 | Train Loss: 2.555 Vali Loss: 74.589 Vali Acc: 0.140 Test Loss: 74.589 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7858471870422363
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 80.289 Vali Acc: 0.180 Test Loss: 80.289 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7554373741149902
Epoch: 7, Steps: 13 | Train Loss: 4.048 Vali Loss: 100.240 Vali Acc: 0.180 Test Loss: 100.240 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7473201751708984
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 104.095 Vali Acc: 0.240 Test Loss: 104.095 Test Acc: 0.240
Validation loss decreased (-0.218914 --> -0.238959).  Saving model ...
Epoch: 9 cost time: 1.7907063961029053
Epoch: 9, Steps: 13 | Train Loss: 1.841 Vali Loss: 125.651 Vali Acc: 0.160 Test Loss: 125.651 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7800464630126953
Epoch: 10, Steps: 13 | Train Loss: 2.303 Vali Loss: 103.204 Vali Acc: 0.240 Test Loss: 103.204 Test Acc: 0.240
Validation loss decreased (-0.238959 --> -0.238968).  Saving model ...
Epoch: 11 cost time: 1.7809114456176758
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 133.663 Vali Acc: 0.200 Test Loss: 133.663 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7252342700958252
Epoch: 12, Steps: 13 | Train Loss: 0.547 Vali Loss: 96.885 Vali Acc: 0.200 Test Loss: 96.885 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7450463771820068
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 131.458 Vali Acc: 0.200 Test Loss: 131.458 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7137372493743896
Epoch: 14, Steps: 13 | Train Loss: 1.870 Vali Loss: 210.239 Vali Acc: 0.120 Test Loss: 210.239 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7185735702514648
Epoch: 15, Steps: 13 | Train Loss: 10.298 Vali Loss: 197.227 Vali Acc: 0.160 Test Loss: 197.227 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7017803192138672
Epoch: 16, Steps: 13 | Train Loss: 13.837 Vali Loss: 184.689 Vali Acc: 0.140 Test Loss: 184.689 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6368374824523926
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 171.590 Vali Acc: 0.180 Test Loss: 171.590 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7054953575134277
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 181.588 Vali Acc: 0.140 Test Loss: 181.588 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.748905897140503
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 189.015 Vali Acc: 0.120 Test Loss: 189.015 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7607879638671875
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 190.172 Vali Acc: 0.100 Test Loss: 190.172 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df128_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 16458501
model size : 65.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.283153772354126
Epoch: 1, Steps: 13 | Train Loss: 3.552 Vali Loss: 8.727 Vali Acc: 0.140 Test Loss: 8.727 Test Acc: 0.140
Validation loss decreased (inf --> -0.139913).  Saving model ...
Epoch: 2 cost time: 1.4127566814422607
Epoch: 2, Steps: 13 | Train Loss: 0.486 Vali Loss: 30.533 Vali Acc: 0.120 Test Loss: 30.533 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.366887092590332
Epoch: 3, Steps: 13 | Train Loss: 0.809 Vali Loss: 40.402 Vali Acc: 0.140 Test Loss: 40.402 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4647958278656006
Epoch: 4, Steps: 13 | Train Loss: 0.819 Vali Loss: 46.640 Vali Acc: 0.120 Test Loss: 46.640 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3837358951568604
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 50.982 Vali Acc: 0.140 Test Loss: 50.982 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.384495496749878
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 51.800 Vali Acc: 0.140 Test Loss: 51.800 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.409620761871338
Epoch: 7, Steps: 13 | Train Loss: 0.023 Vali Loss: 56.187 Vali Acc: 0.140 Test Loss: 56.187 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4935779571533203
Epoch: 8, Steps: 13 | Train Loss: 0.112 Vali Loss: 62.410 Vali Acc: 0.200 Test Loss: 62.410 Test Acc: 0.200
Validation loss decreased (-0.139913 --> -0.199376).  Saving model ...
Epoch: 9 cost time: 1.4018518924713135
Epoch: 9, Steps: 13 | Train Loss: 4.906 Vali Loss: 86.374 Vali Acc: 0.140 Test Loss: 86.374 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4103291034698486
Epoch: 10, Steps: 13 | Train Loss: 6.613 Vali Loss: 73.965 Vali Acc: 0.140 Test Loss: 73.965 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4264934062957764
Epoch: 11, Steps: 13 | Train Loss: 1.334 Vali Loss: 105.415 Vali Acc: 0.200 Test Loss: 105.415 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.602590799331665
Epoch: 12, Steps: 13 | Train Loss: 5.692 Vali Loss: 98.495 Vali Acc: 0.120 Test Loss: 98.495 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.358769416809082
Epoch: 13, Steps: 13 | Train Loss: 4.930 Vali Loss: 102.916 Vali Acc: 0.280 Test Loss: 102.916 Test Acc: 0.280
Validation loss decreased (-0.199376 --> -0.278971).  Saving model ...
Epoch: 14 cost time: 1.4281103610992432
Epoch: 14, Steps: 13 | Train Loss: 1.714 Vali Loss: 152.373 Vali Acc: 0.200 Test Loss: 152.373 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.41670560836792
Epoch: 15, Steps: 13 | Train Loss: 1.299 Vali Loss: 135.986 Vali Acc: 0.160 Test Loss: 135.986 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.324174404144287
Epoch: 16, Steps: 13 | Train Loss: 0.787 Vali Loss: 142.031 Vali Acc: 0.180 Test Loss: 142.031 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3973991870880127
Epoch: 17, Steps: 13 | Train Loss: 1.954 Vali Loss: 143.554 Vali Acc: 0.220 Test Loss: 143.554 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3904647827148438
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 120.387 Vali Acc: 0.140 Test Loss: 120.387 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4167084693908691
Epoch: 19, Steps: 13 | Train Loss: 0.714 Vali Loss: 116.185 Vali Acc: 0.200 Test Loss: 116.185 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.378227949142456
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 122.687 Vali Acc: 0.240 Test Loss: 122.687 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4629309177398682
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 127.246 Vali Acc: 0.240 Test Loss: 127.246 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4842987060546875
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 128.310 Vali Acc: 0.240 Test Loss: 128.310 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.540992021560669
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 129.032 Vali Acc: 0.220 Test Loss: 129.032 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 10434693
model size : 42.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df128_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2088141441345215
Epoch: 1, Steps: 13 | Train Loss: 2.679 Vali Loss: 9.488 Vali Acc: 0.160 Test Loss: 9.488 Test Acc: 0.160
Validation loss decreased (inf --> -0.159905).  Saving model ...
Epoch: 2 cost time: 1.4871199131011963
Epoch: 2, Steps: 13 | Train Loss: 0.767 Vali Loss: 32.817 Vali Acc: 0.200 Test Loss: 32.817 Test Acc: 0.200
Validation loss decreased (-0.159905 --> -0.199672).  Saving model ...
Epoch: 3 cost time: 1.4251213073730469
Epoch: 3, Steps: 13 | Train Loss: 0.175 Vali Loss: 37.832 Vali Acc: 0.160 Test Loss: 37.832 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.318505048751831
Epoch: 4, Steps: 13 | Train Loss: 0.143 Vali Loss: 48.411 Vali Acc: 0.140 Test Loss: 48.411 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.439204216003418
Epoch: 5, Steps: 13 | Train Loss: 0.026 Vali Loss: 39.022 Vali Acc: 0.180 Test Loss: 39.022 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5621154308319092
Epoch: 6, Steps: 13 | Train Loss: 0.300 Vali Loss: 37.419 Vali Acc: 0.180 Test Loss: 37.419 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4761543273925781
Epoch: 7, Steps: 13 | Train Loss: 0.086 Vali Loss: 37.954 Vali Acc: 0.240 Test Loss: 37.954 Test Acc: 0.240
Validation loss decreased (-0.199672 --> -0.239620).  Saving model ...
Epoch: 8 cost time: 1.5609643459320068
Epoch: 8, Steps: 13 | Train Loss: 0.263 Vali Loss: 37.639 Vali Acc: 0.120 Test Loss: 37.639 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.455275058746338
Epoch: 9, Steps: 13 | Train Loss: 0.040 Vali Loss: 54.496 Vali Acc: 0.160 Test Loss: 54.496 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4764044284820557
Epoch: 10, Steps: 13 | Train Loss: 0.020 Vali Loss: 64.366 Vali Acc: 0.140 Test Loss: 64.366 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4378149509429932
Epoch: 11, Steps: 13 | Train Loss: 2.929 Vali Loss: 59.007 Vali Acc: 0.180 Test Loss: 59.007 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4222602844238281
Epoch: 12, Steps: 13 | Train Loss: 1.095 Vali Loss: 84.725 Vali Acc: 0.180 Test Loss: 84.725 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5095431804656982
Epoch: 13, Steps: 13 | Train Loss: 3.587 Vali Loss: 82.467 Vali Acc: 0.140 Test Loss: 82.467 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3831760883331299
Epoch: 14, Steps: 13 | Train Loss: 1.820 Vali Loss: 88.661 Vali Acc: 0.120 Test Loss: 88.661 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3552374839782715
Epoch: 15, Steps: 13 | Train Loss: 4.432 Vali Loss: 95.784 Vali Acc: 0.180 Test Loss: 95.784 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3733091354370117
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 103.221 Vali Acc: 0.200 Test Loss: 103.221 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.440206527709961
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 102.338 Vali Acc: 0.180 Test Loss: 102.338 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df128_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 8714757
model size : 35.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0542585849761963
Epoch: 1, Steps: 13 | Train Loss: 2.568 Vali Loss: 5.795 Vali Acc: 0.220 Test Loss: 5.795 Test Acc: 0.220
Validation loss decreased (inf --> -0.219942).  Saving model ...
Epoch: 2 cost time: 1.0878725051879883
Epoch: 2, Steps: 13 | Train Loss: 0.166 Vali Loss: 14.619 Vali Acc: 0.220 Test Loss: 14.619 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1776373386383057
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.747 Vali Acc: 0.220 Test Loss: 17.747 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1255028247833252
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 22.176 Vali Acc: 0.220 Test Loss: 22.176 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0874009132385254
Epoch: 5, Steps: 13 | Train Loss: 0.067 Vali Loss: 27.658 Vali Acc: 0.200 Test Loss: 27.658 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.044304609298706
Epoch: 6, Steps: 13 | Train Loss: 0.621 Vali Loss: 25.040 Vali Acc: 0.160 Test Loss: 25.040 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2534432411193848
Epoch: 7, Steps: 13 | Train Loss: 1.528 Vali Loss: 36.906 Vali Acc: 0.280 Test Loss: 36.906 Test Acc: 0.280
Validation loss decreased (-0.219942 --> -0.279631).  Saving model ...
Epoch: 8 cost time: 1.1011946201324463
Epoch: 8, Steps: 13 | Train Loss: 0.656 Vali Loss: 31.364 Vali Acc: 0.240 Test Loss: 31.364 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.106940507888794
Epoch: 9, Steps: 13 | Train Loss: 1.101 Vali Loss: 52.040 Vali Acc: 0.180 Test Loss: 52.040 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1050844192504883
Epoch: 10, Steps: 13 | Train Loss: 0.120 Vali Loss: 71.071 Vali Acc: 0.120 Test Loss: 71.071 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.117100715637207
Epoch: 11, Steps: 13 | Train Loss: 2.916 Vali Loss: 90.956 Vali Acc: 0.160 Test Loss: 90.956 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0615358352661133
Epoch: 12, Steps: 13 | Train Loss: 3.507 Vali Loss: 88.540 Vali Acc: 0.200 Test Loss: 88.540 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1404435634613037
Epoch: 13, Steps: 13 | Train Loss: 3.655 Vali Loss: 75.019 Vali Acc: 0.200 Test Loss: 75.019 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1615386009216309
Epoch: 14, Steps: 13 | Train Loss: 0.356 Vali Loss: 72.263 Vali Acc: 0.120 Test Loss: 72.263 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1758370399475098
Epoch: 15, Steps: 13 | Train Loss: 0.047 Vali Loss: 85.957 Vali Acc: 0.120 Test Loss: 85.957 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0788953304290771
Epoch: 16, Steps: 13 | Train Loss: 0.457 Vali Loss: 89.829 Vali Acc: 0.160 Test Loss: 89.829 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0931379795074463
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 113.408 Vali Acc: 0.120 Test Loss: 113.408 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 6134149
model size : 25.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.823585748672485
Epoch: 1, Steps: 25 | Train Loss: 65.800 Vali Loss: 96.198 Vali Acc: 0.160 Test Loss: 96.198 Test Acc: 0.160
Validation loss decreased (inf --> -0.159038).  Saving model ...
Epoch: 2 cost time: 6.366994380950928
Epoch: 2, Steps: 25 | Train Loss: 11.657 Vali Loss: 413.957 Vali Acc: 0.220 Test Loss: 413.957 Test Acc: 0.220
Validation loss decreased (-0.159038 --> -0.215860).  Saving model ...
Epoch: 3 cost time: 6.370508909225464
Epoch: 3, Steps: 25 | Train Loss: 12.483 Vali Loss: 269.816 Vali Acc: 0.200 Test Loss: 269.816 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.394861698150635
Epoch: 4, Steps: 25 | Train Loss: 36.064 Vali Loss: 334.596 Vali Acc: 0.140 Test Loss: 334.596 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.396186828613281
Epoch: 5, Steps: 25 | Train Loss: 95.174 Vali Loss: 531.036 Vali Acc: 0.180 Test Loss: 531.036 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.432149648666382
Epoch: 6, Steps: 25 | Train Loss: 9.613 Vali Loss: 470.381 Vali Acc: 0.140 Test Loss: 470.381 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.382224798202515
Epoch: 7, Steps: 25 | Train Loss: 8.193 Vali Loss: 630.136 Vali Acc: 0.160 Test Loss: 630.136 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.332257986068726
Epoch: 8, Steps: 25 | Train Loss: 32.189 Vali Loss: 526.818 Vali Acc: 0.220 Test Loss: 526.818 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.404635190963745
Epoch: 9, Steps: 25 | Train Loss: 0.000 Vali Loss: 651.357 Vali Acc: 0.220 Test Loss: 651.357 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.607072830200195
Epoch: 10, Steps: 25 | Train Loss: 0.000 Vali Loss: 589.322 Vali Acc: 0.240 Test Loss: 589.322 Test Acc: 0.240
Validation loss decreased (-0.215860 --> -0.234107).  Saving model ...
Epoch: 11 cost time: 6.4819653034210205
Epoch: 11, Steps: 25 | Train Loss: 2.366 Vali Loss: 600.933 Vali Acc: 0.260 Test Loss: 600.933 Test Acc: 0.260
Validation loss decreased (-0.234107 --> -0.253991).  Saving model ...
Epoch: 12 cost time: 6.497811794281006
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 736.273 Vali Acc: 0.220 Test Loss: 736.273 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.440211296081543
Epoch: 13, Steps: 25 | Train Loss: 4.947 Vali Loss: 640.665 Vali Acc: 0.160 Test Loss: 640.665 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.46785569190979
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 664.015 Vali Acc: 0.120 Test Loss: 664.015 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.450270414352417
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 666.259 Vali Acc: 0.120 Test Loss: 666.259 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.50704288482666
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 666.646 Vali Acc: 0.120 Test Loss: 666.646 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.597912073135376
Epoch: 17, Steps: 25 | Train Loss: 0.000 Vali Loss: 667.953 Vali Acc: 0.120 Test Loss: 667.953 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.553728342056274
Epoch: 18, Steps: 25 | Train Loss: 0.000 Vali Loss: 667.630 Vali Acc: 0.140 Test Loss: 667.630 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.638902425765991
Epoch: 19, Steps: 25 | Train Loss: 0.000 Vali Loss: 665.828 Vali Acc: 0.120 Test Loss: 665.828 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.554962158203125
Epoch: 20, Steps: 25 | Train Loss: 0.000 Vali Loss: 667.747 Vali Acc: 0.120 Test Loss: 667.747 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.5760416984558105
Epoch: 21, Steps: 25 | Train Loss: 0.000 Vali Loss: 667.865 Vali Acc: 0.120 Test Loss: 667.865 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 57757893
model size : 222.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.530712604522705
Epoch: 1, Steps: 13 | Train Loss: 15.131 Vali Loss: 43.786 Vali Acc: 0.140 Test Loss: 43.786 Test Acc: 0.140
Validation loss decreased (inf --> -0.139562).  Saving model ...
Epoch: 2 cost time: 3.1083033084869385
Epoch: 2, Steps: 13 | Train Loss: 7.267 Vali Loss: 102.779 Vali Acc: 0.140 Test Loss: 102.779 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0753488540649414
Epoch: 3, Steps: 13 | Train Loss: 13.652 Vali Loss: 172.483 Vali Acc: 0.160 Test Loss: 172.483 Test Acc: 0.160
Validation loss decreased (-0.139562 --> -0.158275).  Saving model ...
Epoch: 4 cost time: 3.1648805141448975
Epoch: 4, Steps: 13 | Train Loss: 11.293 Vali Loss: 148.052 Vali Acc: 0.240 Test Loss: 148.052 Test Acc: 0.240
Validation loss decreased (-0.158275 --> -0.238519).  Saving model ...
Epoch: 5 cost time: 3.1150200366973877
Epoch: 5, Steps: 13 | Train Loss: 23.395 Vali Loss: 119.582 Vali Acc: 0.260 Test Loss: 119.582 Test Acc: 0.260
Validation loss decreased (-0.238519 --> -0.258804).  Saving model ...
Epoch: 6 cost time: 3.1070709228515625
Epoch: 6, Steps: 13 | Train Loss: 1.144 Vali Loss: 157.932 Vali Acc: 0.160 Test Loss: 157.932 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.134638547897339
Epoch: 7, Steps: 13 | Train Loss: 8.387 Vali Loss: 197.797 Vali Acc: 0.160 Test Loss: 197.797 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.114424705505371
Epoch: 8, Steps: 13 | Train Loss: 13.891 Vali Loss: 186.245 Vali Acc: 0.220 Test Loss: 186.245 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.122515916824341
Epoch: 9, Steps: 13 | Train Loss: 0.799 Vali Loss: 223.910 Vali Acc: 0.180 Test Loss: 223.910 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.339761734008789
Epoch: 10, Steps: 13 | Train Loss: 2.888 Vali Loss: 366.042 Vali Acc: 0.180 Test Loss: 366.042 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.1413092613220215
Epoch: 11, Steps: 13 | Train Loss: 4.664 Vali Loss: 190.077 Vali Acc: 0.140 Test Loss: 190.077 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.0976011753082275
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 240.035 Vali Acc: 0.220 Test Loss: 240.035 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.1416964530944824
Epoch: 13, Steps: 13 | Train Loss: 0.663 Vali Loss: 199.285 Vali Acc: 0.160 Test Loss: 199.285 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.174997091293335
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 395.140 Vali Acc: 0.220 Test Loss: 395.140 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.1621201038360596
Epoch: 15, Steps: 13 | Train Loss: 1.347 Vali Loss: 336.825 Vali Acc: 0.160 Test Loss: 336.825 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 32795589
model size : 127.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2528743743896484
Epoch: 1, Steps: 13 | Train Loss: 9.473 Vali Loss: 22.174 Vali Acc: 0.200 Test Loss: 22.174 Test Acc: 0.200
Validation loss decreased (inf --> -0.199778).  Saving model ...
Epoch: 2 cost time: 2.0409069061279297
Epoch: 2, Steps: 13 | Train Loss: 3.559 Vali Loss: 59.222 Vali Acc: 0.180 Test Loss: 59.222 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9396932125091553
Epoch: 3, Steps: 13 | Train Loss: 0.384 Vali Loss: 44.730 Vali Acc: 0.160 Test Loss: 44.730 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8296890258789062
Epoch: 4, Steps: 13 | Train Loss: 0.381 Vali Loss: 71.835 Vali Acc: 0.200 Test Loss: 71.835 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.887317180633545
Epoch: 5, Steps: 13 | Train Loss: 0.430 Vali Loss: 141.222 Vali Acc: 0.200 Test Loss: 141.222 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8859586715698242
Epoch: 6, Steps: 13 | Train Loss: 4.987 Vali Loss: 128.612 Vali Acc: 0.220 Test Loss: 128.612 Test Acc: 0.220
Validation loss decreased (-0.199778 --> -0.218714).  Saving model ...
Epoch: 7 cost time: 1.983771562576294
Epoch: 7, Steps: 13 | Train Loss: 25.430 Vali Loss: 261.923 Vali Acc: 0.200 Test Loss: 261.923 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0895543098449707
Epoch: 8, Steps: 13 | Train Loss: 3.045 Vali Loss: 214.193 Vali Acc: 0.140 Test Loss: 214.193 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1759212017059326
Epoch: 9, Steps: 13 | Train Loss: 3.196 Vali Loss: 175.982 Vali Acc: 0.100 Test Loss: 175.982 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8464441299438477
Epoch: 10, Steps: 13 | Train Loss: 3.256 Vali Loss: 173.534 Vali Acc: 0.080 Test Loss: 173.534 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9674172401428223
Epoch: 11, Steps: 13 | Train Loss: 2.283 Vali Loss: 235.022 Vali Acc: 0.220 Test Loss: 235.022 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.891833782196045
Epoch: 12, Steps: 13 | Train Loss: 0.161 Vali Loss: 246.375 Vali Acc: 0.180 Test Loss: 246.375 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.122847318649292
Epoch: 13, Steps: 13 | Train Loss: 2.598 Vali Loss: 180.975 Vali Acc: 0.200 Test Loss: 180.975 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9771828651428223
Epoch: 14, Steps: 13 | Train Loss: 2.630 Vali Loss: 221.649 Vali Acc: 0.140 Test Loss: 221.649 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9862582683563232
Epoch: 15, Steps: 13 | Train Loss: 0.138 Vali Loss: 278.368 Vali Acc: 0.180 Test Loss: 278.368 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9952731132507324
Epoch: 16, Steps: 13 | Train Loss: 0.827 Vali Loss: 232.317 Vali Acc: 0.160 Test Loss: 232.317 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 20745285
model size : 81.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df64_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.415844678878784
Epoch: 1, Steps: 13 | Train Loss: 5.545 Vali Loss: 10.992 Vali Acc: 0.120 Test Loss: 10.992 Test Acc: 0.120
Validation loss decreased (inf --> -0.119890).  Saving model ...
Epoch: 2 cost time: 1.711977243423462
Epoch: 2, Steps: 13 | Train Loss: 1.069 Vali Loss: 31.296 Vali Acc: 0.160 Test Loss: 31.296 Test Acc: 0.160
Validation loss decreased (-0.119890 --> -0.159687).  Saving model ...
Epoch: 3 cost time: 1.7436745166778564
Epoch: 3, Steps: 13 | Train Loss: 1.552 Vali Loss: 51.740 Vali Acc: 0.140 Test Loss: 51.740 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6918585300445557
Epoch: 4, Steps: 13 | Train Loss: 2.862 Vali Loss: 63.557 Vali Acc: 0.080 Test Loss: 63.557 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6903259754180908
Epoch: 5, Steps: 13 | Train Loss: 0.449 Vali Loss: 104.400 Vali Acc: 0.200 Test Loss: 104.400 Test Acc: 0.200
Validation loss decreased (-0.159687 --> -0.198956).  Saving model ...
Epoch: 6 cost time: 1.7187199592590332
Epoch: 6, Steps: 13 | Train Loss: 2.006 Vali Loss: 90.273 Vali Acc: 0.200 Test Loss: 90.273 Test Acc: 0.200
Validation loss decreased (-0.198956 --> -0.199097).  Saving model ...
Epoch: 7 cost time: 1.6830987930297852
Epoch: 7, Steps: 13 | Train Loss: 1.298 Vali Loss: 85.643 Vali Acc: 0.200 Test Loss: 85.643 Test Acc: 0.200
Validation loss decreased (-0.199097 --> -0.199144).  Saving model ...
Epoch: 8 cost time: 1.7106642723083496
Epoch: 8, Steps: 13 | Train Loss: 3.103 Vali Loss: 133.318 Vali Acc: 0.240 Test Loss: 133.318 Test Acc: 0.240
Validation loss decreased (-0.199144 --> -0.238667).  Saving model ...
Epoch: 9 cost time: 1.7315659523010254
Epoch: 9, Steps: 13 | Train Loss: 0.535 Vali Loss: 143.139 Vali Acc: 0.140 Test Loss: 143.139 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6559200286865234
Epoch: 10, Steps: 13 | Train Loss: 4.612 Vali Loss: 178.520 Vali Acc: 0.140 Test Loss: 178.520 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7091188430786133
Epoch: 11, Steps: 13 | Train Loss: 2.488 Vali Loss: 180.503 Vali Acc: 0.080 Test Loss: 180.503 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7047250270843506
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 225.067 Vali Acc: 0.160 Test Loss: 225.067 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6575500965118408
Epoch: 13, Steps: 13 | Train Loss: 1.676 Vali Loss: 232.389 Vali Acc: 0.160 Test Loss: 232.389 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6828851699829102
Epoch: 14, Steps: 13 | Train Loss: 4.124 Vali Loss: 191.133 Vali Acc: 0.080 Test Loss: 191.133 Test Acc: 0.080
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.752068042755127
Epoch: 15, Steps: 13 | Train Loss: 1.660 Vali Loss: 212.088 Vali Acc: 0.200 Test Loss: 212.088 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6664893627166748
Epoch: 16, Steps: 13 | Train Loss: 2.507 Vali Loss: 254.062 Vali Acc: 0.120 Test Loss: 254.062 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7079017162322998
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 272.460 Vali Acc: 0.100 Test Loss: 272.460 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7653942108154297
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 284.949 Vali Acc: 0.100 Test Loss: 284.949 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df64_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 16442053
model size : 65.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8943159580230713
Epoch: 1, Steps: 13 | Train Loss: 4.344 Vali Loss: 15.190 Vali Acc: 0.140 Test Loss: 15.190 Test Acc: 0.140
Validation loss decreased (inf --> -0.139848).  Saving model ...
Epoch: 2 cost time: 1.4206080436706543
Epoch: 2, Steps: 13 | Train Loss: 0.036 Vali Loss: 29.010 Vali Acc: 0.180 Test Loss: 29.010 Test Acc: 0.180
Validation loss decreased (-0.139848 --> -0.179710).  Saving model ...
Epoch: 3 cost time: 1.473949670791626
Epoch: 3, Steps: 13 | Train Loss: 1.085 Vali Loss: 38.193 Vali Acc: 0.240 Test Loss: 38.193 Test Acc: 0.240
Validation loss decreased (-0.179710 --> -0.239618).  Saving model ...
Epoch: 4 cost time: 1.383021593093872
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 46.165 Vali Acc: 0.220 Test Loss: 46.165 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3371379375457764
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 44.391 Vali Acc: 0.240 Test Loss: 44.391 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3619489669799805
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 43.560 Vali Acc: 0.220 Test Loss: 43.560 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3575439453125
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 43.329 Vali Acc: 0.200 Test Loss: 43.329 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3756518363952637
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 43.199 Vali Acc: 0.200 Test Loss: 43.199 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4350717067718506
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 43.392 Vali Acc: 0.200 Test Loss: 43.392 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3673224449157715
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 43.392 Vali Acc: 0.200 Test Loss: 43.392 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.430823564529419
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 43.281 Vali Acc: 0.200 Test Loss: 43.281 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3839213848114014
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 43.258 Vali Acc: 0.200 Test Loss: 43.258 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5020594596862793
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 43.299 Vali Acc: 0.200 Test Loss: 43.299 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 10418245
model size : 42.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df64_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.008253574371338
Epoch: 1, Steps: 13 | Train Loss: 4.002 Vali Loss: 6.179 Vali Acc: 0.240 Test Loss: 6.179 Test Acc: 0.240
Validation loss decreased (inf --> -0.239938).  Saving model ...
Epoch: 2 cost time: 1.3378593921661377
Epoch: 2, Steps: 13 | Train Loss: 0.434 Vali Loss: 15.716 Vali Acc: 0.180 Test Loss: 15.716 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2926137447357178
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 28.896 Vali Acc: 0.180 Test Loss: 28.896 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4637727737426758
Epoch: 4, Steps: 13 | Train Loss: 0.002 Vali Loss: 32.423 Vali Acc: 0.180 Test Loss: 32.423 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3243958950042725
Epoch: 5, Steps: 13 | Train Loss: 0.853 Vali Loss: 29.669 Vali Acc: 0.240 Test Loss: 29.669 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3969008922576904
Epoch: 6, Steps: 13 | Train Loss: 1.273 Vali Loss: 38.778 Vali Acc: 0.140 Test Loss: 38.778 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4852845668792725
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.913 Vali Acc: 0.160 Test Loss: 52.913 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4630019664764404
Epoch: 8, Steps: 13 | Train Loss: 0.749 Vali Loss: 60.829 Vali Acc: 0.200 Test Loss: 60.829 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3186116218566895
Epoch: 9, Steps: 13 | Train Loss: 2.110 Vali Loss: 94.234 Vali Acc: 0.180 Test Loss: 94.234 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.366981029510498
Epoch: 10, Steps: 13 | Train Loss: 1.520 Vali Loss: 68.351 Vali Acc: 0.200 Test Loss: 68.351 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3963937759399414
Epoch: 11, Steps: 13 | Train Loss: 0.711 Vali Loss: 105.262 Vali Acc: 0.200 Test Loss: 105.262 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df64_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 8698309
model size : 35.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.610220193862915
Epoch: 1, Steps: 13 | Train Loss: 2.647 Vali Loss: 6.701 Vali Acc: 0.140 Test Loss: 6.701 Test Acc: 0.140
Validation loss decreased (inf --> -0.139933).  Saving model ...
Epoch: 2 cost time: 1.1672630310058594
Epoch: 2, Steps: 13 | Train Loss: 0.109 Vali Loss: 9.243 Vali Acc: 0.120 Test Loss: 9.243 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1652474403381348
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.179 Vali Acc: 0.160 Test Loss: 12.179 Test Acc: 0.160
Validation loss decreased (-0.139933 --> -0.159878).  Saving model ...
Epoch: 4 cost time: 1.0965609550476074
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.659 Vali Acc: 0.240 Test Loss: 14.659 Test Acc: 0.240
Validation loss decreased (-0.159878 --> -0.239853).  Saving model ...
Epoch: 5 cost time: 1.1538519859313965
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 15.885 Vali Acc: 0.220 Test Loss: 15.885 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0999293327331543
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.086 Vali Acc: 0.220 Test Loss: 16.086 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1922407150268555
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.068 Vali Acc: 0.240 Test Loss: 16.068 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.149357795715332
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.346 Vali Acc: 0.220 Test Loss: 16.346 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.132117748260498
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.142 Vali Acc: 0.220 Test Loss: 16.142 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1794559955596924
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.384 Vali Acc: 0.220 Test Loss: 16.384 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.159048080444336
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.285 Vali Acc: 0.220 Test Loss: 16.285 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1283941268920898
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.151 Vali Acc: 0.220 Test Loss: 16.151 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0914254188537598
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.090 Vali Acc: 0.220 Test Loss: 16.090 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9635629653930664
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.147 Vali Acc: 0.220 Test Loss: 16.147 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm128_nh16_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 6117701
model size : 25.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.994960069656372
Epoch: 1, Steps: 25 | Train Loss: 55.656 Vali Loss: 163.859 Vali Acc: 0.220 Test Loss: 163.859 Test Acc: 0.220
Validation loss decreased (inf --> -0.218361).  Saving model ...
Epoch: 2 cost time: 5.546401262283325
Epoch: 2, Steps: 25 | Train Loss: 18.356 Vali Loss: 165.927 Vali Acc: 0.200 Test Loss: 165.927 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.611838102340698
Epoch: 3, Steps: 25 | Train Loss: 5.005 Vali Loss: 165.389 Vali Acc: 0.180 Test Loss: 165.389 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.649376392364502
Epoch: 4, Steps: 25 | Train Loss: 49.036 Vali Loss: 214.513 Vali Acc: 0.220 Test Loss: 214.513 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.6811041831970215
Epoch: 5, Steps: 25 | Train Loss: 16.173 Vali Loss: 200.015 Vali Acc: 0.180 Test Loss: 200.015 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.730178594589233
Epoch: 6, Steps: 25 | Train Loss: 1.360 Vali Loss: 316.902 Vali Acc: 0.220 Test Loss: 316.902 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.768160104751587
Epoch: 7, Steps: 25 | Train Loss: 12.634 Vali Loss: 234.925 Vali Acc: 0.200 Test Loss: 234.925 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.740429401397705
Epoch: 8, Steps: 25 | Train Loss: 11.380 Vali Loss: 359.136 Vali Acc: 0.220 Test Loss: 359.136 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.627291202545166
Epoch: 9, Steps: 25 | Train Loss: 12.324 Vali Loss: 262.183 Vali Acc: 0.200 Test Loss: 262.183 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.837423801422119
Epoch: 10, Steps: 25 | Train Loss: 4.888 Vali Loss: 377.666 Vali Acc: 0.180 Test Loss: 377.666 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.769210338592529
Epoch: 11, Steps: 25 | Train Loss: 4.754 Vali Loss: 352.942 Vali Acc: 0.140 Test Loss: 352.942 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 28887365
model size : 111.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.2810046672821045
Epoch: 1, Steps: 13 | Train Loss: 6.414 Vali Loss: 23.582 Vali Acc: 0.200 Test Loss: 23.582 Test Acc: 0.200
Validation loss decreased (inf --> -0.199764).  Saving model ...
Epoch: 2 cost time: 2.693335771560669
Epoch: 2, Steps: 13 | Train Loss: 3.892 Vali Loss: 32.106 Vali Acc: 0.180 Test Loss: 32.106 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7685792446136475
Epoch: 3, Steps: 13 | Train Loss: 0.041 Vali Loss: 53.343 Vali Acc: 0.180 Test Loss: 53.343 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.722717046737671
Epoch: 4, Steps: 13 | Train Loss: 1.215 Vali Loss: 50.212 Vali Acc: 0.160 Test Loss: 50.212 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7621407508850098
Epoch: 5, Steps: 13 | Train Loss: 1.886 Vali Loss: 67.967 Vali Acc: 0.220 Test Loss: 67.967 Test Acc: 0.220
Validation loss decreased (-0.199764 --> -0.219320).  Saving model ...
Epoch: 6 cost time: 2.7017688751220703
Epoch: 6, Steps: 13 | Train Loss: 5.699 Vali Loss: 107.314 Vali Acc: 0.240 Test Loss: 107.314 Test Acc: 0.240
Validation loss decreased (-0.219320 --> -0.238927).  Saving model ...
Epoch: 7 cost time: 2.727294921875
Epoch: 7, Steps: 13 | Train Loss: 9.622 Vali Loss: 100.623 Vali Acc: 0.160 Test Loss: 100.623 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7927122116088867
Epoch: 8, Steps: 13 | Train Loss: 8.857 Vali Loss: 150.322 Vali Acc: 0.160 Test Loss: 150.322 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.774731397628784
Epoch: 9, Steps: 13 | Train Loss: 2.312 Vali Loss: 100.979 Vali Acc: 0.180 Test Loss: 100.979 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7689263820648193
Epoch: 10, Steps: 13 | Train Loss: 0.148 Vali Loss: 162.213 Vali Acc: 0.160 Test Loss: 162.213 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8442139625549316
Epoch: 11, Steps: 13 | Train Loss: 5.180 Vali Loss: 173.923 Vali Acc: 0.160 Test Loss: 173.923 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7990527153015137
Epoch: 12, Steps: 13 | Train Loss: 11.033 Vali Loss: 238.594 Vali Acc: 0.200 Test Loss: 238.594 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.93076491355896
Epoch: 13, Steps: 13 | Train Loss: 17.004 Vali Loss: 223.838 Vali Acc: 0.160 Test Loss: 223.838 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.835592746734619
Epoch: 14, Steps: 13 | Train Loss: 6.004 Vali Loss: 211.955 Vali Acc: 0.180 Test Loss: 211.955 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.85566782951355
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 170.104 Vali Acc: 0.220 Test Loss: 170.104 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.71152663230896
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 162.408 Vali Acc: 0.140 Test Loss: 162.408 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 16406213
model size : 63.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.214062213897705
Epoch: 1, Steps: 13 | Train Loss: 4.612 Vali Loss: 7.991 Vali Acc: 0.160 Test Loss: 7.991 Test Acc: 0.160
Validation loss decreased (inf --> -0.159920).  Saving model ...
Epoch: 2 cost time: 1.7366235256195068
Epoch: 2, Steps: 13 | Train Loss: 1.392 Vali Loss: 27.543 Vali Acc: 0.180 Test Loss: 27.543 Test Acc: 0.180
Validation loss decreased (-0.159920 --> -0.179725).  Saving model ...
Epoch: 3 cost time: 1.7349908351898193
Epoch: 3, Steps: 13 | Train Loss: 1.744 Vali Loss: 27.396 Vali Acc: 0.200 Test Loss: 27.396 Test Acc: 0.200
Validation loss decreased (-0.179725 --> -0.199726).  Saving model ...
Epoch: 4 cost time: 1.7542943954467773
Epoch: 4, Steps: 13 | Train Loss: 0.878 Vali Loss: 31.349 Vali Acc: 0.240 Test Loss: 31.349 Test Acc: 0.240
Validation loss decreased (-0.199726 --> -0.239687).  Saving model ...
Epoch: 5 cost time: 1.7163946628570557
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 39.374 Vali Acc: 0.140 Test Loss: 39.374 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.82118821144104
Epoch: 6, Steps: 13 | Train Loss: 0.018 Vali Loss: 27.507 Vali Acc: 0.300 Test Loss: 27.507 Test Acc: 0.300
Validation loss decreased (-0.239687 --> -0.299725).  Saving model ...
Epoch: 7 cost time: 1.8981354236602783
Epoch: 7, Steps: 13 | Train Loss: 0.844 Vali Loss: 36.864 Vali Acc: 0.180 Test Loss: 36.864 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.795506238937378
Epoch: 8, Steps: 13 | Train Loss: 0.432 Vali Loss: 60.337 Vali Acc: 0.180 Test Loss: 60.337 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8444647789001465
Epoch: 9, Steps: 13 | Train Loss: 3.361 Vali Loss: 112.407 Vali Acc: 0.160 Test Loss: 112.407 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7049334049224854
Epoch: 10, Steps: 13 | Train Loss: 15.912 Vali Loss: 86.801 Vali Acc: 0.180 Test Loss: 86.801 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7677760124206543
Epoch: 11, Steps: 13 | Train Loss: 7.582 Vali Loss: 98.561 Vali Acc: 0.180 Test Loss: 98.561 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8075716495513916
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 138.782 Vali Acc: 0.160 Test Loss: 138.782 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7133023738861084
Epoch: 13, Steps: 13 | Train Loss: 1.078 Vali Loss: 129.543 Vali Acc: 0.180 Test Loss: 129.543 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8708620071411133
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 132.076 Vali Acc: 0.120 Test Loss: 132.076 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.889711618423462
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 154.194 Vali Acc: 0.100 Test Loss: 154.194 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7396435737609863
Epoch: 16, Steps: 13 | Train Loss: 0.491 Vali Loss: 150.293 Vali Acc: 0.120 Test Loss: 150.293 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 10381061
model size : 40.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df256_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0476813316345215
Epoch: 1, Steps: 13 | Train Loss: 3.613 Vali Loss: 7.043 Vali Acc: 0.100 Test Loss: 7.043 Test Acc: 0.100
Validation loss decreased (inf --> -0.099930).  Saving model ...
Epoch: 2 cost time: 1.6016159057617188
Epoch: 2, Steps: 13 | Train Loss: 0.890 Vali Loss: 17.558 Vali Acc: 0.160 Test Loss: 17.558 Test Acc: 0.160
Validation loss decreased (-0.099930 --> -0.159824).  Saving model ...
Epoch: 3 cost time: 1.4697611331939697
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 47.908 Vali Acc: 0.240 Test Loss: 47.908 Test Acc: 0.240
Validation loss decreased (-0.159824 --> -0.239521).  Saving model ...
Epoch: 4 cost time: 1.523554801940918
Epoch: 4, Steps: 13 | Train Loss: 0.563 Vali Loss: 25.767 Vali Acc: 0.100 Test Loss: 25.767 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5926027297973633
Epoch: 5, Steps: 13 | Train Loss: 1.557 Vali Loss: 41.296 Vali Acc: 0.220 Test Loss: 41.296 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6122963428497314
Epoch: 6, Steps: 13 | Train Loss: 0.817 Vali Loss: 60.898 Vali Acc: 0.240 Test Loss: 60.898 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5020275115966797
Epoch: 7, Steps: 13 | Train Loss: 1.079 Vali Loss: 55.760 Vali Acc: 0.140 Test Loss: 55.760 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5026533603668213
Epoch: 8, Steps: 13 | Train Loss: 1.668 Vali Loss: 64.027 Vali Acc: 0.180 Test Loss: 64.027 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6337566375732422
Epoch: 9, Steps: 13 | Train Loss: 1.210 Vali Loss: 87.473 Vali Acc: 0.140 Test Loss: 87.473 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5314645767211914
Epoch: 10, Steps: 13 | Train Loss: 2.500 Vali Loss: 104.751 Vali Acc: 0.200 Test Loss: 104.751 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4818432331085205
Epoch: 11, Steps: 13 | Train Loss: 2.064 Vali Loss: 79.774 Vali Acc: 0.200 Test Loss: 79.774 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4471409320831299
Epoch: 12, Steps: 13 | Train Loss: 0.963 Vali Loss: 87.614 Vali Acc: 0.160 Test Loss: 87.614 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4937665462493896
Epoch: 13, Steps: 13 | Train Loss: 0.240 Vali Loss: 115.969 Vali Acc: 0.180 Test Loss: 115.969 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df256_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 8229445
model size : 32.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.838042974472046
Epoch: 1, Steps: 13 | Train Loss: 2.257 Vali Loss: 5.552 Vali Acc: 0.120 Test Loss: 5.552 Test Acc: 0.120
Validation loss decreased (inf --> -0.119944).  Saving model ...
Epoch: 2 cost time: 1.251314640045166
Epoch: 2, Steps: 13 | Train Loss: 0.403 Vali Loss: 15.915 Vali Acc: 0.200 Test Loss: 15.915 Test Acc: 0.200
Validation loss decreased (-0.119944 --> -0.199841).  Saving model ...
Epoch: 3 cost time: 1.1821846961975098
Epoch: 3, Steps: 13 | Train Loss: 0.001 Vali Loss: 16.082 Vali Acc: 0.180 Test Loss: 16.082 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1961183547973633
Epoch: 4, Steps: 13 | Train Loss: 0.094 Vali Loss: 24.634 Vali Acc: 0.200 Test Loss: 24.634 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.246945858001709
Epoch: 5, Steps: 13 | Train Loss: 0.250 Vali Loss: 21.844 Vali Acc: 0.140 Test Loss: 21.844 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2600858211517334
Epoch: 6, Steps: 13 | Train Loss: 0.002 Vali Loss: 37.192 Vali Acc: 0.140 Test Loss: 37.192 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.354435920715332
Epoch: 7, Steps: 13 | Train Loss: 0.317 Vali Loss: 35.676 Vali Acc: 0.180 Test Loss: 35.676 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2692148685455322
Epoch: 8, Steps: 13 | Train Loss: 0.848 Vali Loss: 42.238 Vali Acc: 0.180 Test Loss: 42.238 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4319841861724854
Epoch: 9, Steps: 13 | Train Loss: 2.655 Vali Loss: 54.787 Vali Acc: 0.180 Test Loss: 54.787 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3242459297180176
Epoch: 10, Steps: 13 | Train Loss: 2.112 Vali Loss: 38.202 Vali Acc: 0.260 Test Loss: 38.202 Test Acc: 0.260
Validation loss decreased (-0.199841 --> -0.259618).  Saving model ...
Epoch: 11 cost time: 1.218785047531128
Epoch: 11, Steps: 13 | Train Loss: 1.243 Vali Loss: 55.895 Vali Acc: 0.260 Test Loss: 55.895 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.259077787399292
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 51.568 Vali Acc: 0.160 Test Loss: 51.568 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.192765712738037
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 54.952 Vali Acc: 0.180 Test Loss: 54.952 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3076894283294678
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 56.076 Vali Acc: 0.160 Test Loss: 56.076 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1770226955413818
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 56.186 Vali Acc: 0.160 Test Loss: 56.186 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2190556526184082
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 56.162 Vali Acc: 0.140 Test Loss: 56.162 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2009499073028564
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 56.195 Vali Acc: 0.160 Test Loss: 56.195 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2762901782989502
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 56.093 Vali Acc: 0.160 Test Loss: 56.093 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2280817031860352
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 56.374 Vali Acc: 0.160 Test Loss: 56.374 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.311375379562378
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 56.378 Vali Acc: 0.160 Test Loss: 56.378 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 5217541
model size : 21.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df256_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7273807525634766
Epoch: 1, Steps: 13 | Train Loss: 2.444 Vali Loss: 3.883 Vali Acc: 0.200 Test Loss: 3.883 Test Acc: 0.200
Validation loss decreased (inf --> -0.199961).  Saving model ...
Epoch: 2 cost time: 1.240143060684204
Epoch: 2, Steps: 13 | Train Loss: 0.111 Vali Loss: 13.681 Vali Acc: 0.160 Test Loss: 13.681 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.117619276046753
Epoch: 3, Steps: 13 | Train Loss: 0.122 Vali Loss: 18.586 Vali Acc: 0.160 Test Loss: 18.586 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2266604900360107
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.909 Vali Acc: 0.200 Test Loss: 18.909 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1523339748382568
Epoch: 5, Steps: 13 | Train Loss: 0.001 Vali Loss: 19.270 Vali Acc: 0.180 Test Loss: 19.270 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1633803844451904
Epoch: 6, Steps: 13 | Train Loss: 0.427 Vali Loss: 17.818 Vali Acc: 0.100 Test Loss: 17.818 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1687700748443604
Epoch: 7, Steps: 13 | Train Loss: 0.117 Vali Loss: 20.755 Vali Acc: 0.140 Test Loss: 20.755 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.104231595993042
Epoch: 8, Steps: 13 | Train Loss: 0.330 Vali Loss: 25.647 Vali Acc: 0.160 Test Loss: 25.647 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1597113609313965
Epoch: 9, Steps: 13 | Train Loss: 1.293 Vali Loss: 32.328 Vali Acc: 0.200 Test Loss: 32.328 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0824072360992432
Epoch: 10, Steps: 13 | Train Loss: 3.040 Vali Loss: 46.198 Vali Acc: 0.200 Test Loss: 46.198 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.186528205871582
Epoch: 11, Steps: 13 | Train Loss: 4.996 Vali Loss: 36.045 Vali Acc: 0.220 Test Loss: 36.045 Test Acc: 0.220
Validation loss decreased (-0.199961 --> -0.219640).  Saving model ...
Epoch: 12 cost time: 1.0543773174285889
Epoch: 12, Steps: 13 | Train Loss: 0.046 Vali Loss: 41.464 Vali Acc: 0.180 Test Loss: 41.464 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2369585037231445
Epoch: 13, Steps: 13 | Train Loss: 0.115 Vali Loss: 59.825 Vali Acc: 0.200 Test Loss: 59.825 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1391689777374268
Epoch: 14, Steps: 13 | Train Loss: 0.007 Vali Loss: 55.876 Vali Acc: 0.140 Test Loss: 55.876 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1838345527648926
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 56.047 Vali Acc: 0.160 Test Loss: 56.047 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0615434646606445
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 56.414 Vali Acc: 0.140 Test Loss: 56.414 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1151235103607178
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 56.725 Vali Acc: 0.140 Test Loss: 56.725 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1857738494873047
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 56.911 Vali Acc: 0.140 Test Loss: 56.911 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1931073665618896
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 56.876 Vali Acc: 0.140 Test Loss: 56.876 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0594680309295654
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 57.352 Vali Acc: 0.140 Test Loss: 57.352 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.068809986114502
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 56.800 Vali Acc: 0.140 Test Loss: 56.800 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df256_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 4357573
model size : 17.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3490161895751953
Epoch: 1, Steps: 13 | Train Loss: 2.179 Vali Loss: 3.598 Vali Acc: 0.160 Test Loss: 3.598 Test Acc: 0.160
Validation loss decreased (inf --> -0.159964).  Saving model ...
Epoch: 2 cost time: 1.0109162330627441
Epoch: 2, Steps: 13 | Train Loss: 0.083 Vali Loss: 5.759 Vali Acc: 0.160 Test Loss: 5.759 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0508050918579102
Epoch: 3, Steps: 13 | Train Loss: 0.074 Vali Loss: 11.474 Vali Acc: 0.160 Test Loss: 11.474 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9695436954498291
Epoch: 4, Steps: 13 | Train Loss: 0.001 Vali Loss: 9.582 Vali Acc: 0.260 Test Loss: 9.582 Test Acc: 0.260
Validation loss decreased (-0.159964 --> -0.259904).  Saving model ...
Epoch: 5 cost time: 1.0512828826904297
Epoch: 5, Steps: 13 | Train Loss: 0.082 Vali Loss: 10.186 Vali Acc: 0.200 Test Loss: 10.186 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.184661865234375
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 13.561 Vali Acc: 0.240 Test Loss: 13.561 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9917166233062744
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.301 Vali Acc: 0.240 Test Loss: 14.301 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1073527336120605
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.352 Vali Acc: 0.240 Test Loss: 14.352 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0321741104125977
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.277 Vali Acc: 0.240 Test Loss: 14.277 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.08095383644104
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.165 Vali Acc: 0.240 Test Loss: 14.165 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.050900936126709
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.069 Vali Acc: 0.240 Test Loss: 14.069 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0190417766571045
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.186 Vali Acc: 0.240 Test Loss: 14.186 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9659981727600098
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.147 Vali Acc: 0.240 Test Loss: 14.147 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.136500597000122
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.095 Vali Acc: 0.240 Test Loss: 14.095 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 3067269
model size : 12.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.468835830688477
Epoch: 1, Steps: 25 | Train Loss: 34.601 Vali Loss: 82.468 Vali Acc: 0.120 Test Loss: 82.468 Test Acc: 0.120
Validation loss decreased (inf --> -0.119175).  Saving model ...
Epoch: 2 cost time: 5.019813060760498
Epoch: 2, Steps: 25 | Train Loss: 17.559 Vali Loss: 189.457 Vali Acc: 0.220 Test Loss: 189.457 Test Acc: 0.220
Validation loss decreased (-0.119175 --> -0.218105).  Saving model ...
Epoch: 3 cost time: 5.08965802192688
Epoch: 3, Steps: 25 | Train Loss: 8.514 Vali Loss: 158.344 Vali Acc: 0.200 Test Loss: 158.344 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.016582250595093
Epoch: 4, Steps: 25 | Train Loss: 42.611 Vali Loss: 287.232 Vali Acc: 0.160 Test Loss: 287.232 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.9950478076934814
Epoch: 5, Steps: 25 | Train Loss: 36.723 Vali Loss: 256.019 Vali Acc: 0.200 Test Loss: 256.019 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.041453123092651
Epoch: 6, Steps: 25 | Train Loss: 7.933 Vali Loss: 389.982 Vali Acc: 0.180 Test Loss: 389.982 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.107146501541138
Epoch: 7, Steps: 25 | Train Loss: 16.640 Vali Loss: 245.634 Vali Acc: 0.160 Test Loss: 245.634 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.056345224380493
Epoch: 8, Steps: 25 | Train Loss: 1.839 Vali Loss: 271.742 Vali Acc: 0.180 Test Loss: 271.742 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.9988532066345215
Epoch: 9, Steps: 25 | Train Loss: 5.349 Vali Loss: 365.510 Vali Acc: 0.260 Test Loss: 365.510 Test Acc: 0.260
Validation loss decreased (-0.218105 --> -0.256345).  Saving model ...
Epoch: 10 cost time: 5.088170289993286
Epoch: 10, Steps: 25 | Train Loss: 0.337 Vali Loss: 263.446 Vali Acc: 0.180 Test Loss: 263.446 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.288881301879883
Epoch: 11, Steps: 25 | Train Loss: 1.728 Vali Loss: 253.162 Vali Acc: 0.140 Test Loss: 253.162 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.991239786148071
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 299.779 Vali Acc: 0.280 Test Loss: 299.779 Test Acc: 0.280
Validation loss decreased (-0.256345 --> -0.277002).  Saving model ...
Epoch: 13 cost time: 5.011399269104004
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 324.928 Vali Acc: 0.240 Test Loss: 324.928 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.120042324066162
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 318.276 Vali Acc: 0.240 Test Loss: 318.276 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.149219036102295
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 314.384 Vali Acc: 0.260 Test Loss: 314.384 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.08676290512085
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 315.353 Vali Acc: 0.260 Test Loss: 315.353 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.178036451339722
Epoch: 17, Steps: 25 | Train Loss: 0.000 Vali Loss: 327.295 Vali Acc: 0.240 Test Loss: 327.295 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.040981769561768
Epoch: 18, Steps: 25 | Train Loss: 0.000 Vali Loss: 320.665 Vali Acc: 0.240 Test Loss: 320.665 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.185417890548706
Epoch: 19, Steps: 25 | Train Loss: 0.000 Vali Loss: 320.874 Vali Acc: 0.240 Test Loss: 320.874 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.186481952667236
Epoch: 20, Steps: 25 | Train Loss: 0.000 Vali Loss: 320.644 Vali Acc: 0.240 Test Loss: 320.644 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.218282222747803
Epoch: 21, Steps: 25 | Train Loss: 0.000 Vali Loss: 322.053 Vali Acc: 0.240 Test Loss: 322.053 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.135445833206177
Epoch: 22, Steps: 25 | Train Loss: 0.000 Vali Loss: 324.867 Vali Acc: 0.240 Test Loss: 324.867 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 28870853
model size : 111.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6144375801086426
Epoch: 1, Steps: 13 | Train Loss: 6.394 Vali Loss: 14.982 Vali Acc: 0.180 Test Loss: 14.982 Test Acc: 0.180
Validation loss decreased (inf --> -0.179850).  Saving model ...
Epoch: 2 cost time: 2.166670560836792
Epoch: 2, Steps: 13 | Train Loss: 3.948 Vali Loss: 53.797 Vali Acc: 0.140 Test Loss: 53.797 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2127151489257812
Epoch: 3, Steps: 13 | Train Loss: 9.030 Vali Loss: 121.091 Vali Acc: 0.160 Test Loss: 121.091 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.235426425933838
Epoch: 4, Steps: 13 | Train Loss: 9.845 Vali Loss: 123.462 Vali Acc: 0.240 Test Loss: 123.462 Test Acc: 0.240
Validation loss decreased (-0.179850 --> -0.238765).  Saving model ...
Epoch: 5 cost time: 2.2340738773345947
Epoch: 5, Steps: 13 | Train Loss: 2.154 Vali Loss: 130.163 Vali Acc: 0.200 Test Loss: 130.163 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.32037353515625
Epoch: 6, Steps: 13 | Train Loss: 10.080 Vali Loss: 88.262 Vali Acc: 0.180 Test Loss: 88.262 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2705345153808594
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 149.479 Vali Acc: 0.180 Test Loss: 149.479 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2751803398132324
Epoch: 8, Steps: 13 | Train Loss: 1.025 Vali Loss: 98.846 Vali Acc: 0.100 Test Loss: 98.846 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.24155330657959
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 94.158 Vali Acc: 0.120 Test Loss: 94.158 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.224165201187134
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 94.873 Vali Acc: 0.140 Test Loss: 94.873 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.3679275512695312
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 93.458 Vali Acc: 0.160 Test Loss: 93.458 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.329495429992676
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 93.264 Vali Acc: 0.160 Test Loss: 93.264 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.2841503620147705
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 93.244 Vali Acc: 0.160 Test Loss: 93.244 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.3231101036071777
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 93.313 Vali Acc: 0.140 Test Loss: 93.313 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 16389701
model size : 63.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1035890579223633
Epoch: 1, Steps: 13 | Train Loss: 4.405 Vali Loss: 8.255 Vali Acc: 0.140 Test Loss: 8.255 Test Acc: 0.140
Validation loss decreased (inf --> -0.139917).  Saving model ...
Epoch: 2 cost time: 1.4255034923553467
Epoch: 2, Steps: 13 | Train Loss: 0.664 Vali Loss: 31.492 Vali Acc: 0.180 Test Loss: 31.492 Test Acc: 0.180
Validation loss decreased (-0.139917 --> -0.179685).  Saving model ...
Epoch: 3 cost time: 1.4455933570861816
Epoch: 3, Steps: 13 | Train Loss: 0.097 Vali Loss: 30.310 Vali Acc: 0.200 Test Loss: 30.310 Test Acc: 0.200
Validation loss decreased (-0.179685 --> -0.199697).  Saving model ...
Epoch: 4 cost time: 1.6015071868896484
Epoch: 4, Steps: 13 | Train Loss: 0.498 Vali Loss: 41.140 Vali Acc: 0.140 Test Loss: 41.140 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5091683864593506
Epoch: 5, Steps: 13 | Train Loss: 3.459 Vali Loss: 34.336 Vali Acc: 0.220 Test Loss: 34.336 Test Acc: 0.220
Validation loss decreased (-0.199697 --> -0.219657).  Saving model ...
Epoch: 6 cost time: 1.4599056243896484
Epoch: 6, Steps: 13 | Train Loss: 2.101 Vali Loss: 64.897 Vali Acc: 0.140 Test Loss: 64.897 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4310777187347412
Epoch: 7, Steps: 13 | Train Loss: 3.016 Vali Loss: 92.961 Vali Acc: 0.140 Test Loss: 92.961 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6311357021331787
Epoch: 8, Steps: 13 | Train Loss: 0.446 Vali Loss: 73.743 Vali Acc: 0.120 Test Loss: 73.743 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5077197551727295
Epoch: 9, Steps: 13 | Train Loss: 7.357 Vali Loss: 96.637 Vali Acc: 0.100 Test Loss: 96.637 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4092521667480469
Epoch: 10, Steps: 13 | Train Loss: 5.298 Vali Loss: 131.688 Vali Acc: 0.140 Test Loss: 131.688 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.461089849472046
Epoch: 11, Steps: 13 | Train Loss: 7.982 Vali Loss: 108.081 Vali Acc: 0.180 Test Loss: 108.081 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4675178527832031
Epoch: 12, Steps: 13 | Train Loss: 6.595 Vali Loss: 168.896 Vali Acc: 0.200 Test Loss: 168.896 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.361889123916626
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 117.883 Vali Acc: 0.140 Test Loss: 117.883 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4440746307373047
Epoch: 14, Steps: 13 | Train Loss: 0.165 Vali Loss: 92.575 Vali Acc: 0.200 Test Loss: 92.575 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.402547836303711
Epoch: 15, Steps: 13 | Train Loss: 0.529 Vali Loss: 172.052 Vali Acc: 0.160 Test Loss: 172.052 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 10364549
model size : 40.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df128_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.752110719680786
Epoch: 1, Steps: 13 | Train Loss: 3.005 Vali Loss: 6.141 Vali Acc: 0.220 Test Loss: 6.141 Test Acc: 0.220
Validation loss decreased (inf --> -0.219939).  Saving model ...
Epoch: 2 cost time: 1.353527545928955
Epoch: 2, Steps: 13 | Train Loss: 0.386 Vali Loss: 15.465 Vali Acc: 0.160 Test Loss: 15.465 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.284092664718628
Epoch: 3, Steps: 13 | Train Loss: 0.524 Vali Loss: 22.360 Vali Acc: 0.160 Test Loss: 22.360 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3642029762268066
Epoch: 4, Steps: 13 | Train Loss: 2.289 Vali Loss: 33.565 Vali Acc: 0.140 Test Loss: 33.565 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.335115909576416
Epoch: 5, Steps: 13 | Train Loss: 3.409 Vali Loss: 40.677 Vali Acc: 0.140 Test Loss: 40.677 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3779513835906982
Epoch: 6, Steps: 13 | Train Loss: 0.068 Vali Loss: 57.261 Vali Acc: 0.200 Test Loss: 57.261 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4082682132720947
Epoch: 7, Steps: 13 | Train Loss: 0.638 Vali Loss: 47.492 Vali Acc: 0.140 Test Loss: 47.492 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.465848684310913
Epoch: 8, Steps: 13 | Train Loss: 0.466 Vali Loss: 47.234 Vali Acc: 0.160 Test Loss: 47.234 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3664047718048096
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 51.542 Vali Acc: 0.100 Test Loss: 51.542 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.339430332183838
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.569 Vali Acc: 0.120 Test Loss: 52.569 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3881266117095947
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.954 Vali Acc: 0.100 Test Loss: 52.954 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df128_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 8212933
model size : 32.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8930838108062744
Epoch: 1, Steps: 13 | Train Loss: 2.458 Vali Loss: 5.649 Vali Acc: 0.200 Test Loss: 5.649 Test Acc: 0.200
Validation loss decreased (inf --> -0.199944).  Saving model ...
Epoch: 2 cost time: 1.1884851455688477
Epoch: 2, Steps: 13 | Train Loss: 0.192 Vali Loss: 14.336 Vali Acc: 0.200 Test Loss: 14.336 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.142301321029663
Epoch: 3, Steps: 13 | Train Loss: 0.063 Vali Loss: 21.273 Vali Acc: 0.180 Test Loss: 21.273 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2300529479980469
Epoch: 4, Steps: 13 | Train Loss: 0.232 Vali Loss: 15.929 Vali Acc: 0.140 Test Loss: 15.929 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.059307336807251
Epoch: 5, Steps: 13 | Train Loss: 0.018 Vali Loss: 26.275 Vali Acc: 0.160 Test Loss: 26.275 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.114427089691162
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 27.604 Vali Acc: 0.080 Test Loss: 27.604 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.108661413192749
Epoch: 7, Steps: 13 | Train Loss: 0.098 Vali Loss: 27.874 Vali Acc: 0.180 Test Loss: 27.874 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1885974407196045
Epoch: 8, Steps: 13 | Train Loss: 1.216 Vali Loss: 38.874 Vali Acc: 0.200 Test Loss: 38.874 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.025071144104004
Epoch: 9, Steps: 13 | Train Loss: 3.793 Vali Loss: 50.492 Vali Acc: 0.300 Test Loss: 50.492 Test Acc: 0.300
Validation loss decreased (-0.199944 --> -0.299495).  Saving model ...
Epoch: 10 cost time: 1.1332542896270752
Epoch: 10, Steps: 13 | Train Loss: 1.332 Vali Loss: 46.571 Vali Acc: 0.220 Test Loss: 46.571 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.217069149017334
Epoch: 11, Steps: 13 | Train Loss: 1.979 Vali Loss: 60.310 Vali Acc: 0.200 Test Loss: 60.310 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.037571907043457
Epoch: 12, Steps: 13 | Train Loss: 1.301 Vali Loss: 40.871 Vali Acc: 0.280 Test Loss: 40.871 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1639678478240967
Epoch: 13, Steps: 13 | Train Loss: 1.020 Vali Loss: 52.381 Vali Acc: 0.160 Test Loss: 52.381 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2177538871765137
Epoch: 14, Steps: 13 | Train Loss: 0.033 Vali Loss: 65.068 Vali Acc: 0.160 Test Loss: 65.068 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1068017482757568
Epoch: 15, Steps: 13 | Train Loss: 0.424 Vali Loss: 71.588 Vali Acc: 0.200 Test Loss: 71.588 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.122333288192749
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 78.079 Vali Acc: 0.240 Test Loss: 78.079 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0501353740692139
Epoch: 17, Steps: 13 | Train Loss: 0.057 Vali Loss: 66.649 Vali Acc: 0.260 Test Loss: 66.649 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0891926288604736
Epoch: 18, Steps: 13 | Train Loss: 0.630 Vali Loss: 67.110 Vali Acc: 0.300 Test Loss: 67.110 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1905710697174072
Epoch: 19, Steps: 13 | Train Loss: 0.005 Vali Loss: 74.207 Vali Acc: 0.200 Test Loss: 74.207 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 5201029
model size : 21.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df128_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.728860378265381
Epoch: 1, Steps: 13 | Train Loss: 2.639 Vali Loss: 4.786 Vali Acc: 0.180 Test Loss: 4.786 Test Acc: 0.180
Validation loss decreased (inf --> -0.179952).  Saving model ...
Epoch: 2 cost time: 1.1004209518432617
Epoch: 2, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.340 Vali Acc: 0.140 Test Loss: 11.340 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.139859914779663
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.524 Vali Acc: 0.180 Test Loss: 10.524 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9854004383087158
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.529 Vali Acc: 0.200 Test Loss: 16.529 Test Acc: 0.200
Validation loss decreased (-0.179952 --> -0.199835).  Saving model ...
Epoch: 5 cost time: 0.9912152290344238
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.044 Vali Acc: 0.200 Test Loss: 18.044 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0653083324432373
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.084 Vali Acc: 0.200 Test Loss: 18.084 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.984734296798706
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.057 Vali Acc: 0.200 Test Loss: 18.057 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0151190757751465
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.002 Vali Acc: 0.200 Test Loss: 18.002 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0143203735351562
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.897 Vali Acc: 0.200 Test Loss: 17.897 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0828051567077637
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.981 Vali Acc: 0.200 Test Loss: 17.981 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9437448978424072
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.959 Vali Acc: 0.200 Test Loss: 17.959 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0734152793884277
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.878 Vali Acc: 0.200 Test Loss: 17.878 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1055035591125488
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.859 Vali Acc: 0.200 Test Loss: 17.859 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0165379047393799
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.942 Vali Acc: 0.200 Test Loss: 17.942 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df128_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 4341061
model size : 17.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3892948627471924
Epoch: 1, Steps: 13 | Train Loss: 2.358 Vali Loss: 3.144 Vali Acc: 0.180 Test Loss: 3.144 Test Acc: 0.180
Validation loss decreased (inf --> -0.179969).  Saving model ...
Epoch: 2 cost time: 0.9023833274841309
Epoch: 2, Steps: 13 | Train Loss: 0.056 Vali Loss: 6.371 Vali Acc: 0.180 Test Loss: 6.371 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8875899314880371
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.353 Vali Acc: 0.220 Test Loss: 9.353 Test Acc: 0.220
Validation loss decreased (-0.179969 --> -0.219906).  Saving model ...
Epoch: 4 cost time: 0.9680130481719971
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.488 Vali Acc: 0.200 Test Loss: 10.488 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8711395263671875
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.489 Vali Acc: 0.160 Test Loss: 9.489 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9017996788024902
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.265 Vali Acc: 0.140 Test Loss: 9.265 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8509447574615479
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.169 Vali Acc: 0.160 Test Loss: 9.169 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9916074275970459
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.178 Vali Acc: 0.160 Test Loss: 9.178 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0008361339569092
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.120 Vali Acc: 0.160 Test Loss: 9.120 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9712204933166504
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.117 Vali Acc: 0.160 Test Loss: 9.117 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0377113819122314
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.153 Vali Acc: 0.160 Test Loss: 9.153 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.986823558807373
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.081 Vali Acc: 0.160 Test Loss: 9.081 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0713310241699219
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.071 Vali Acc: 0.160 Test Loss: 9.071 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 3050757
model size : 12.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.2062952518463135
Epoch: 1, Steps: 25 | Train Loss: 53.308 Vali Loss: 68.359 Vali Acc: 0.180 Test Loss: 68.359 Test Acc: 0.180
Validation loss decreased (inf --> -0.179316).  Saving model ...
Epoch: 2 cost time: 4.882032155990601
Epoch: 2, Steps: 25 | Train Loss: 29.291 Vali Loss: 188.628 Vali Acc: 0.160 Test Loss: 188.628 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.841194152832031
Epoch: 3, Steps: 25 | Train Loss: 22.257 Vali Loss: 281.836 Vali Acc: 0.200 Test Loss: 281.836 Test Acc: 0.200
Validation loss decreased (-0.179316 --> -0.197182).  Saving model ...
Epoch: 4 cost time: 4.972304344177246
Epoch: 4, Steps: 25 | Train Loss: 3.086 Vali Loss: 202.561 Vali Acc: 0.180 Test Loss: 202.561 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.840442419052124
Epoch: 5, Steps: 25 | Train Loss: 5.174 Vali Loss: 188.088 Vali Acc: 0.200 Test Loss: 188.088 Test Acc: 0.200
Validation loss decreased (-0.197182 --> -0.198119).  Saving model ...
Epoch: 6 cost time: 4.869242429733276
Epoch: 6, Steps: 25 | Train Loss: 17.401 Vali Loss: 195.942 Vali Acc: 0.160 Test Loss: 195.942 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.949602365493774
Epoch: 7, Steps: 25 | Train Loss: 5.045 Vali Loss: 673.805 Vali Acc: 0.200 Test Loss: 673.805 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.918079614639282
Epoch: 8, Steps: 25 | Train Loss: 67.470 Vali Loss: 630.987 Vali Acc: 0.200 Test Loss: 630.987 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.89211630821228
Epoch: 9, Steps: 25 | Train Loss: 54.156 Vali Loss: 315.375 Vali Acc: 0.180 Test Loss: 315.375 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.89450216293335
Epoch: 10, Steps: 25 | Train Loss: 17.039 Vali Loss: 375.193 Vali Acc: 0.280 Test Loss: 375.193 Test Acc: 0.280
Validation loss decreased (-0.198119 --> -0.276248).  Saving model ...
Epoch: 11 cost time: 4.834801912307739
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 405.325 Vali Acc: 0.160 Test Loss: 405.325 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.969713926315308
Epoch: 12, Steps: 25 | Train Loss: 0.058 Vali Loss: 329.347 Vali Acc: 0.220 Test Loss: 329.347 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.9104063510894775
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 326.799 Vali Acc: 0.240 Test Loss: 326.799 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.029821395874023
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 326.991 Vali Acc: 0.240 Test Loss: 326.991 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.893318176269531
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 327.071 Vali Acc: 0.220 Test Loss: 327.071 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.939747095108032
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 327.500 Vali Acc: 0.220 Test Loss: 327.500 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.923315763473511
Epoch: 17, Steps: 25 | Train Loss: 0.000 Vali Loss: 327.346 Vali Acc: 0.220 Test Loss: 327.346 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.940121412277222
Epoch: 18, Steps: 25 | Train Loss: 0.000 Vali Loss: 328.327 Vali Acc: 0.220 Test Loss: 328.327 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.906729698181152
Epoch: 19, Steps: 25 | Train Loss: 0.000 Vali Loss: 327.411 Vali Acc: 0.240 Test Loss: 327.411 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.955166816711426
Epoch: 20, Steps: 25 | Train Loss: 0.000 Vali Loss: 327.277 Vali Acc: 0.220 Test Loss: 327.277 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 28862597
model size : 111.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8351054191589355
Epoch: 1, Steps: 13 | Train Loss: 5.798 Vali Loss: 20.220 Vali Acc: 0.140 Test Loss: 20.220 Test Acc: 0.140
Validation loss decreased (inf --> -0.139798).  Saving model ...
Epoch: 2 cost time: 2.095534563064575
Epoch: 2, Steps: 13 | Train Loss: 6.196 Vali Loss: 41.798 Vali Acc: 0.220 Test Loss: 41.798 Test Acc: 0.220
Validation loss decreased (-0.139798 --> -0.219582).  Saving model ...
Epoch: 3 cost time: 2.1578047275543213
Epoch: 3, Steps: 13 | Train Loss: 2.893 Vali Loss: 61.907 Vali Acc: 0.140 Test Loss: 61.907 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.039297103881836
Epoch: 4, Steps: 13 | Train Loss: 6.864 Vali Loss: 78.341 Vali Acc: 0.240 Test Loss: 78.341 Test Acc: 0.240
Validation loss decreased (-0.219582 --> -0.239217).  Saving model ...
Epoch: 5 cost time: 2.065700054168701
Epoch: 5, Steps: 13 | Train Loss: 6.236 Vali Loss: 113.869 Vali Acc: 0.160 Test Loss: 113.869 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0866010189056396
Epoch: 6, Steps: 13 | Train Loss: 5.734 Vali Loss: 89.607 Vali Acc: 0.160 Test Loss: 89.607 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0916483402252197
Epoch: 7, Steps: 13 | Train Loss: 1.020 Vali Loss: 138.162 Vali Acc: 0.180 Test Loss: 138.162 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1584699153900146
Epoch: 8, Steps: 13 | Train Loss: 2.584 Vali Loss: 160.117 Vali Acc: 0.160 Test Loss: 160.117 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1527676582336426
Epoch: 9, Steps: 13 | Train Loss: 0.949 Vali Loss: 94.280 Vali Acc: 0.200 Test Loss: 94.280 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0892598628997803
Epoch: 10, Steps: 13 | Train Loss: 2.617 Vali Loss: 158.176 Vali Acc: 0.120 Test Loss: 158.176 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1896677017211914
Epoch: 11, Steps: 13 | Train Loss: 8.242 Vali Loss: 234.772 Vali Acc: 0.200 Test Loss: 234.772 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.118320941925049
Epoch: 12, Steps: 13 | Train Loss: 7.901 Vali Loss: 189.643 Vali Acc: 0.120 Test Loss: 189.643 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.150994062423706
Epoch: 13, Steps: 13 | Train Loss: 12.178 Vali Loss: 224.663 Vali Acc: 0.180 Test Loss: 224.663 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.0506575107574463
Epoch: 14, Steps: 13 | Train Loss: 0.237 Vali Loss: 222.652 Vali Acc: 0.180 Test Loss: 222.652 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 16381445
model size : 63.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0394515991210938
Epoch: 1, Steps: 13 | Train Loss: 3.604 Vali Loss: 14.667 Vali Acc: 0.180 Test Loss: 14.667 Test Acc: 0.180
Validation loss decreased (inf --> -0.179853).  Saving model ...
Epoch: 2 cost time: 1.5097777843475342
Epoch: 2, Steps: 13 | Train Loss: 1.053 Vali Loss: 34.677 Vali Acc: 0.160 Test Loss: 34.677 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.432765245437622
Epoch: 3, Steps: 13 | Train Loss: 0.575 Vali Loss: 60.130 Vali Acc: 0.200 Test Loss: 60.130 Test Acc: 0.200
Validation loss decreased (-0.179853 --> -0.199399).  Saving model ...
Epoch: 4 cost time: 1.545154094696045
Epoch: 4, Steps: 13 | Train Loss: 0.032 Vali Loss: 51.675 Vali Acc: 0.160 Test Loss: 51.675 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.478635549545288
Epoch: 5, Steps: 13 | Train Loss: 0.693 Vali Loss: 49.393 Vali Acc: 0.120 Test Loss: 49.393 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5013494491577148
Epoch: 6, Steps: 13 | Train Loss: 2.266 Vali Loss: 93.778 Vali Acc: 0.220 Test Loss: 93.778 Test Acc: 0.220
Validation loss decreased (-0.199399 --> -0.219062).  Saving model ...
Epoch: 7 cost time: 1.4905736446380615
Epoch: 7, Steps: 13 | Train Loss: 4.119 Vali Loss: 95.811 Vali Acc: 0.100 Test Loss: 95.811 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5396604537963867
Epoch: 8, Steps: 13 | Train Loss: 4.236 Vali Loss: 91.294 Vali Acc: 0.200 Test Loss: 91.294 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4618380069732666
Epoch: 9, Steps: 13 | Train Loss: 7.750 Vali Loss: 110.869 Vali Acc: 0.220 Test Loss: 110.869 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4988903999328613
Epoch: 10, Steps: 13 | Train Loss: 11.812 Vali Loss: 108.687 Vali Acc: 0.200 Test Loss: 108.687 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4603545665740967
Epoch: 11, Steps: 13 | Train Loss: 2.840 Vali Loss: 125.683 Vali Acc: 0.200 Test Loss: 125.683 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4365229606628418
Epoch: 12, Steps: 13 | Train Loss: 2.508 Vali Loss: 126.942 Vali Acc: 0.160 Test Loss: 126.942 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6240448951721191
Epoch: 13, Steps: 13 | Train Loss: 1.090 Vali Loss: 129.508 Vali Acc: 0.200 Test Loss: 129.508 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.496445655822754
Epoch: 14, Steps: 13 | Train Loss: 1.373 Vali Loss: 137.365 Vali Acc: 0.200 Test Loss: 137.365 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5349328517913818
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 117.274 Vali Acc: 0.200 Test Loss: 117.274 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.513190507888794
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 128.534 Vali Acc: 0.220 Test Loss: 128.534 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 10356293
model size : 40.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df64_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8558402061462402
Epoch: 1, Steps: 13 | Train Loss: 2.586 Vali Loss: 14.435 Vali Acc: 0.200 Test Loss: 14.435 Test Acc: 0.200
Validation loss decreased (inf --> -0.199856).  Saving model ...
Epoch: 2 cost time: 1.3756585121154785
Epoch: 2, Steps: 13 | Train Loss: 1.102 Vali Loss: 22.522 Vali Acc: 0.160 Test Loss: 22.522 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2826642990112305
Epoch: 3, Steps: 13 | Train Loss: 0.025 Vali Loss: 37.350 Vali Acc: 0.200 Test Loss: 37.350 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3476924896240234
Epoch: 4, Steps: 13 | Train Loss: 1.227 Vali Loss: 41.370 Vali Acc: 0.140 Test Loss: 41.370 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.356708288192749
Epoch: 5, Steps: 13 | Train Loss: 0.028 Vali Loss: 49.755 Vali Acc: 0.160 Test Loss: 49.755 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3126919269561768
Epoch: 6, Steps: 13 | Train Loss: 0.084 Vali Loss: 46.384 Vali Acc: 0.160 Test Loss: 46.384 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3590240478515625
Epoch: 7, Steps: 13 | Train Loss: 0.214 Vali Loss: 46.089 Vali Acc: 0.140 Test Loss: 46.089 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4076793193817139
Epoch: 8, Steps: 13 | Train Loss: 3.117 Vali Loss: 56.144 Vali Acc: 0.200 Test Loss: 56.144 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4649488925933838
Epoch: 9, Steps: 13 | Train Loss: 2.119 Vali Loss: 65.611 Vali Acc: 0.200 Test Loss: 65.611 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3435781002044678
Epoch: 10, Steps: 13 | Train Loss: 3.366 Vali Loss: 68.828 Vali Acc: 0.140 Test Loss: 68.828 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3859920501708984
Epoch: 11, Steps: 13 | Train Loss: 2.235 Vali Loss: 87.341 Vali Acc: 0.140 Test Loss: 87.341 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df64_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 8204677
model size : 32.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.595087766647339
Epoch: 1, Steps: 13 | Train Loss: 2.699 Vali Loss: 4.692 Vali Acc: 0.100 Test Loss: 4.692 Test Acc: 0.100
Validation loss decreased (inf --> -0.099953).  Saving model ...
Epoch: 2 cost time: 1.2132861614227295
Epoch: 2, Steps: 13 | Train Loss: 0.175 Vali Loss: 11.266 Vali Acc: 0.140 Test Loss: 11.266 Test Acc: 0.140
Validation loss decreased (-0.099953 --> -0.139887).  Saving model ...
Epoch: 3 cost time: 1.0478942394256592
Epoch: 3, Steps: 13 | Train Loss: 0.053 Vali Loss: 20.438 Vali Acc: 0.080 Test Loss: 20.438 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1758062839508057
Epoch: 4, Steps: 13 | Train Loss: 0.118 Vali Loss: 18.534 Vali Acc: 0.220 Test Loss: 18.534 Test Acc: 0.220
Validation loss decreased (-0.139887 --> -0.219815).  Saving model ...
Epoch: 5 cost time: 1.1670804023742676
Epoch: 5, Steps: 13 | Train Loss: 0.190 Vali Loss: 36.134 Vali Acc: 0.180 Test Loss: 36.134 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1089868545532227
Epoch: 6, Steps: 13 | Train Loss: 0.891 Vali Loss: 29.708 Vali Acc: 0.140 Test Loss: 29.708 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1042900085449219
Epoch: 7, Steps: 13 | Train Loss: 0.535 Vali Loss: 32.242 Vali Acc: 0.160 Test Loss: 32.242 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2064170837402344
Epoch: 8, Steps: 13 | Train Loss: 0.252 Vali Loss: 28.164 Vali Acc: 0.220 Test Loss: 28.164 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1391148567199707
Epoch: 9, Steps: 13 | Train Loss: 0.104 Vali Loss: 39.442 Vali Acc: 0.180 Test Loss: 39.442 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1089589595794678
Epoch: 10, Steps: 13 | Train Loss: 0.270 Vali Loss: 38.594 Vali Acc: 0.220 Test Loss: 38.594 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.107879400253296
Epoch: 11, Steps: 13 | Train Loss: 0.476 Vali Loss: 42.699 Vali Acc: 0.220 Test Loss: 42.699 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.075709581375122
Epoch: 12, Steps: 13 | Train Loss: 0.069 Vali Loss: 50.681 Vali Acc: 0.160 Test Loss: 50.681 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0380065441131592
Epoch: 13, Steps: 13 | Train Loss: 0.603 Vali Loss: 54.624 Vali Acc: 0.200 Test Loss: 54.624 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.101405382156372
Epoch: 14, Steps: 13 | Train Loss: 0.415 Vali Loss: 49.892 Vali Acc: 0.220 Test Loss: 49.892 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 5192773
model size : 21.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df64_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5495967864990234
Epoch: 1, Steps: 13 | Train Loss: 2.398 Vali Loss: 5.111 Vali Acc: 0.200 Test Loss: 5.111 Test Acc: 0.200
Validation loss decreased (inf --> -0.199949).  Saving model ...
Epoch: 2 cost time: 1.043741226196289
Epoch: 2, Steps: 13 | Train Loss: 0.033 Vali Loss: 10.149 Vali Acc: 0.160 Test Loss: 10.149 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.087860107421875
Epoch: 3, Steps: 13 | Train Loss: 0.086 Vali Loss: 14.151 Vali Acc: 0.200 Test Loss: 14.151 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0039918422698975
Epoch: 4, Steps: 13 | Train Loss: 0.300 Vali Loss: 15.214 Vali Acc: 0.180 Test Loss: 15.214 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9875552654266357
Epoch: 5, Steps: 13 | Train Loss: 0.072 Vali Loss: 18.498 Vali Acc: 0.140 Test Loss: 18.498 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0639324188232422
Epoch: 6, Steps: 13 | Train Loss: 0.005 Vali Loss: 22.395 Vali Acc: 0.240 Test Loss: 22.395 Test Acc: 0.240
Validation loss decreased (-0.199949 --> -0.239776).  Saving model ...
Epoch: 7 cost time: 1.0889904499053955
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 29.290 Vali Acc: 0.240 Test Loss: 29.290 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0277447700500488
Epoch: 8, Steps: 13 | Train Loss: 0.727 Vali Loss: 24.356 Vali Acc: 0.200 Test Loss: 24.356 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1224944591522217
Epoch: 9, Steps: 13 | Train Loss: 0.632 Vali Loss: 36.862 Vali Acc: 0.240 Test Loss: 36.862 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1088082790374756
Epoch: 10, Steps: 13 | Train Loss: 0.440 Vali Loss: 41.115 Vali Acc: 0.180 Test Loss: 41.115 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.115041971206665
Epoch: 11, Steps: 13 | Train Loss: 5.682 Vali Loss: 39.940 Vali Acc: 0.240 Test Loss: 39.940 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0373332500457764
Epoch: 12, Steps: 13 | Train Loss: 3.048 Vali Loss: 51.323 Vali Acc: 0.180 Test Loss: 51.323 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9892349243164062
Epoch: 13, Steps: 13 | Train Loss: 1.531 Vali Loss: 62.158 Vali Acc: 0.260 Test Loss: 62.158 Test Acc: 0.260
Validation loss decreased (-0.239776 --> -0.259378).  Saving model ...
Epoch: 14 cost time: 1.035564661026001
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 64.194 Vali Acc: 0.160 Test Loss: 64.194 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.07877779006958
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 63.082 Vali Acc: 0.140 Test Loss: 63.082 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0236008167266846
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 64.763 Vali Acc: 0.160 Test Loss: 64.763 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9907224178314209
Epoch: 17, Steps: 13 | Train Loss: 0.328 Vali Loss: 64.793 Vali Acc: 0.160 Test Loss: 64.793 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0101394653320312
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 70.530 Vali Acc: 0.140 Test Loss: 70.530 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.056304931640625
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 73.641 Vali Acc: 0.100 Test Loss: 73.641 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.112779140472412
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 74.013 Vali Acc: 0.100 Test Loss: 74.013 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.017653465270996
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 74.047 Vali Acc: 0.100 Test Loss: 74.047 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.141535758972168
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 74.586 Vali Acc: 0.100 Test Loss: 74.586 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.015550136566162
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 74.518 Vali Acc: 0.100 Test Loss: 74.518 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df64_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 4332805
model size : 17.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4283976554870605
Epoch: 1, Steps: 13 | Train Loss: 2.195 Vali Loss: 3.108 Vali Acc: 0.200 Test Loss: 3.108 Test Acc: 0.200
Validation loss decreased (inf --> -0.199969).  Saving model ...
Epoch: 2 cost time: 0.8828377723693848
Epoch: 2, Steps: 13 | Train Loss: 0.008 Vali Loss: 7.004 Vali Acc: 0.160 Test Loss: 7.004 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9921097755432129
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.296 Vali Acc: 0.200 Test Loss: 9.296 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.873572826385498
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.389 Vali Acc: 0.200 Test Loss: 10.389 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9663496017456055
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.744 Vali Acc: 0.200 Test Loss: 10.744 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9619607925415039
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.864 Vali Acc: 0.200 Test Loss: 10.864 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.920539379119873
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.846 Vali Acc: 0.200 Test Loss: 10.846 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8999078273773193
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.875 Vali Acc: 0.200 Test Loss: 10.875 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.926734447479248
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.933 Vali Acc: 0.200 Test Loss: 10.933 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9745326042175293
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.952 Vali Acc: 0.200 Test Loss: 10.952 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9041316509246826
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.873 Vali Acc: 0.200 Test Loss: 10.873 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm64_nh16_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 3042501
model size : 12.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.097442388534546
Epoch: 1, Steps: 25 | Train Loss: 16.667 Vali Loss: 38.045 Vali Acc: 0.200 Test Loss: 38.045 Test Acc: 0.200
Validation loss decreased (inf --> -0.199620).  Saving model ...
Epoch: 2 cost time: 2.757270097732544
Epoch: 2, Steps: 25 | Train Loss: 12.256 Vali Loss: 65.787 Vali Acc: 0.180 Test Loss: 65.787 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.761815309524536
Epoch: 3, Steps: 25 | Train Loss: 6.015 Vali Loss: 145.401 Vali Acc: 0.180 Test Loss: 145.401 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5685136318206787
Epoch: 4, Steps: 25 | Train Loss: 7.986 Vali Loss: 92.919 Vali Acc: 0.140 Test Loss: 92.919 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.745871067047119
Epoch: 5, Steps: 25 | Train Loss: 3.584 Vali Loss: 87.209 Vali Acc: 0.160 Test Loss: 87.209 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.561352491378784
Epoch: 6, Steps: 25 | Train Loss: 7.647 Vali Loss: 172.069 Vali Acc: 0.200 Test Loss: 172.069 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7068533897399902
Epoch: 7, Steps: 25 | Train Loss: 7.699 Vali Loss: 182.794 Vali Acc: 0.220 Test Loss: 182.794 Test Acc: 0.220
Validation loss decreased (-0.199620 --> -0.218172).  Saving model ...
Epoch: 8 cost time: 2.673513412475586
Epoch: 8, Steps: 25 | Train Loss: 1.331 Vali Loss: 159.366 Vali Acc: 0.180 Test Loss: 159.366 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.808992862701416
Epoch: 9, Steps: 25 | Train Loss: 0.361 Vali Loss: 197.656 Vali Acc: 0.240 Test Loss: 197.656 Test Acc: 0.240
Validation loss decreased (-0.218172 --> -0.238023).  Saving model ...
Epoch: 10 cost time: 2.6697769165039062
Epoch: 10, Steps: 25 | Train Loss: 12.737 Vali Loss: 147.386 Vali Acc: 0.140 Test Loss: 147.386 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.714891195297241
Epoch: 11, Steps: 25 | Train Loss: 4.034 Vali Loss: 254.839 Vali Acc: 0.180 Test Loss: 254.839 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.729069709777832
Epoch: 12, Steps: 25 | Train Loss: 2.678 Vali Loss: 170.429 Vali Acc: 0.220 Test Loss: 170.429 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7154762744903564
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 181.164 Vali Acc: 0.160 Test Loss: 181.164 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6236884593963623
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 182.891 Vali Acc: 0.160 Test Loss: 182.891 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.592240333557129
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 184.035 Vali Acc: 0.160 Test Loss: 184.035 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5511903762817383
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 182.594 Vali Acc: 0.160 Test Loss: 182.594 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.6280860900878906
Epoch: 17, Steps: 25 | Train Loss: 0.000 Vali Loss: 183.768 Vali Acc: 0.160 Test Loss: 183.768 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.602694511413574
Epoch: 18, Steps: 25 | Train Loss: 0.000 Vali Loss: 183.533 Vali Acc: 0.160 Test Loss: 183.533 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.784477949142456
Epoch: 19, Steps: 25 | Train Loss: 0.000 Vali Loss: 183.230 Vali Acc: 0.160 Test Loss: 183.230 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 14439717
model size : 55.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2525570392608643
Epoch: 1, Steps: 13 | Train Loss: 7.407 Vali Loss: 13.156 Vali Acc: 0.200 Test Loss: 13.156 Test Acc: 0.200
Validation loss decreased (inf --> -0.199868).  Saving model ...
Epoch: 2 cost time: 1.6515743732452393
Epoch: 2, Steps: 13 | Train Loss: 2.668 Vali Loss: 32.182 Vali Acc: 0.160 Test Loss: 32.182 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6749320030212402
Epoch: 3, Steps: 13 | Train Loss: 1.486 Vali Loss: 45.200 Vali Acc: 0.200 Test Loss: 45.200 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5095272064208984
Epoch: 4, Steps: 13 | Train Loss: 0.387 Vali Loss: 45.287 Vali Acc: 0.140 Test Loss: 45.287 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6290397644042969
Epoch: 5, Steps: 13 | Train Loss: 1.035 Vali Loss: 74.235 Vali Acc: 0.160 Test Loss: 74.235 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7374811172485352
Epoch: 6, Steps: 13 | Train Loss: 12.398 Vali Loss: 72.987 Vali Acc: 0.140 Test Loss: 72.987 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6871416568756104
Epoch: 7, Steps: 13 | Train Loss: 2.420 Vali Loss: 44.585 Vali Acc: 0.160 Test Loss: 44.585 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.589202880859375
Epoch: 8, Steps: 13 | Train Loss: 2.051 Vali Loss: 55.949 Vali Acc: 0.180 Test Loss: 55.949 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6962785720825195
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 95.875 Vali Acc: 0.200 Test Loss: 95.875 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5606467723846436
Epoch: 10, Steps: 13 | Train Loss: 2.194 Vali Loss: 78.698 Vali Acc: 0.220 Test Loss: 78.698 Test Acc: 0.220
Validation loss decreased (-0.199868 --> -0.219213).  Saving model ...
Epoch: 11 cost time: 1.6419193744659424
Epoch: 11, Steps: 13 | Train Loss: 1.061 Vali Loss: 66.792 Vali Acc: 0.220 Test Loss: 66.792 Test Acc: 0.220
Validation loss decreased (-0.219213 --> -0.219332).  Saving model ...
Epoch: 12 cost time: 1.7881004810333252
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 117.097 Vali Acc: 0.240 Test Loss: 117.097 Test Acc: 0.240
Validation loss decreased (-0.219332 --> -0.238829).  Saving model ...
Epoch: 13 cost time: 1.7637922763824463
Epoch: 13, Steps: 13 | Train Loss: 1.556 Vali Loss: 140.005 Vali Acc: 0.220 Test Loss: 140.005 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7938215732574463
Epoch: 14, Steps: 13 | Train Loss: 1.740 Vali Loss: 91.452 Vali Acc: 0.180 Test Loss: 91.452 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6831059455871582
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 178.620 Vali Acc: 0.160 Test Loss: 178.620 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7067089080810547
Epoch: 16, Steps: 13 | Train Loss: 1.295 Vali Loss: 130.660 Vali Acc: 0.140 Test Loss: 130.660 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7604217529296875
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 106.526 Vali Acc: 0.220 Test Loss: 106.526 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7631480693817139
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 104.419 Vali Acc: 0.220 Test Loss: 104.419 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8831162452697754
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 104.136 Vali Acc: 0.220 Test Loss: 104.136 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7490935325622559
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 103.934 Vali Acc: 0.220 Test Loss: 103.934 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8462519645690918
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 103.842 Vali Acc: 0.220 Test Loss: 103.842 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7859768867492676
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 103.854 Vali Acc: 0.220 Test Loss: 103.854 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 8199141
model size : 31.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7900230884552
Epoch: 1, Steps: 13 | Train Loss: 3.844 Vali Loss: 4.143 Vali Acc: 0.220 Test Loss: 4.143 Test Acc: 0.220
Validation loss decreased (inf --> -0.219959).  Saving model ...
Epoch: 2 cost time: 1.2773816585540771
Epoch: 2, Steps: 13 | Train Loss: 0.166 Vali Loss: 7.488 Vali Acc: 0.160 Test Loss: 7.488 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3439667224884033
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.832 Vali Acc: 0.160 Test Loss: 12.832 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.377418041229248
Epoch: 4, Steps: 13 | Train Loss: 0.149 Vali Loss: 30.464 Vali Acc: 0.240 Test Loss: 30.464 Test Acc: 0.240
Validation loss decreased (-0.219959 --> -0.239695).  Saving model ...
Epoch: 5 cost time: 1.284383773803711
Epoch: 5, Steps: 13 | Train Loss: 3.439 Vali Loss: 30.850 Vali Acc: 0.140 Test Loss: 30.850 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.268984079360962
Epoch: 6, Steps: 13 | Train Loss: 2.098 Vali Loss: 41.094 Vali Acc: 0.280 Test Loss: 41.094 Test Acc: 0.280
Validation loss decreased (-0.239695 --> -0.279589).  Saving model ...
Epoch: 7 cost time: 1.3520348072052002
Epoch: 7, Steps: 13 | Train Loss: 3.884 Vali Loss: 58.308 Vali Acc: 0.160 Test Loss: 58.308 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2180609703063965
Epoch: 8, Steps: 13 | Train Loss: 3.179 Vali Loss: 53.784 Vali Acc: 0.220 Test Loss: 53.784 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2507519721984863
Epoch: 9, Steps: 13 | Train Loss: 1.580 Vali Loss: 54.980 Vali Acc: 0.240 Test Loss: 54.980 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.284987449645996
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 42.030 Vali Acc: 0.140 Test Loss: 42.030 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2169513702392578
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.131 Vali Acc: 0.160 Test Loss: 48.131 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2550008296966553
Epoch: 12, Steps: 13 | Train Loss: 0.008 Vali Loss: 53.363 Vali Acc: 0.140 Test Loss: 53.363 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2801721096038818
Epoch: 13, Steps: 13 | Train Loss: 0.570 Vali Loss: 58.206 Vali Acc: 0.240 Test Loss: 58.206 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1549580097198486
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 71.906 Vali Acc: 0.240 Test Loss: 71.906 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2568678855895996
Epoch: 15, Steps: 13 | Train Loss: 0.872 Vali Loss: 75.322 Vali Acc: 0.240 Test Loss: 75.322 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.245227336883545
Epoch: 16, Steps: 13 | Train Loss: 0.377 Vali Loss: 60.200 Vali Acc: 0.340 Test Loss: 60.200 Test Acc: 0.340
Validation loss decreased (-0.279589 --> -0.339398).  Saving model ...
Epoch: 17 cost time: 1.2174065113067627
Epoch: 17, Steps: 13 | Train Loss: 2.545 Vali Loss: 73.183 Vali Acc: 0.180 Test Loss: 73.183 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2607438564300537
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 94.938 Vali Acc: 0.160 Test Loss: 94.938 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.246138095855713
Epoch: 19, Steps: 13 | Train Loss: 0.239 Vali Loss: 80.480 Vali Acc: 0.200 Test Loss: 80.480 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3120503425598145
Epoch: 20, Steps: 13 | Train Loss: 1.093 Vali Loss: 71.082 Vali Acc: 0.240 Test Loss: 71.082 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.237318754196167
Epoch: 21, Steps: 13 | Train Loss: 0.046 Vali Loss: 90.254 Vali Acc: 0.200 Test Loss: 90.254 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2154021263122559
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 104.624 Vali Acc: 0.180 Test Loss: 104.624 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2201099395751953
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 108.417 Vali Acc: 0.180 Test Loss: 108.417 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2388684749603271
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 109.700 Vali Acc: 0.180 Test Loss: 109.700 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1871628761291504
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 110.192 Vali Acc: 0.180 Test Loss: 110.192 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.182419776916504
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 109.938 Vali Acc: 0.180 Test Loss: 109.938 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 5186565
model size : 20.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df256_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.846015453338623
Epoch: 1, Steps: 13 | Train Loss: 2.415 Vali Loss: 6.815 Vali Acc: 0.200 Test Loss: 6.815 Test Acc: 0.200
Validation loss decreased (inf --> -0.199932).  Saving model ...
Epoch: 2 cost time: 1.1415212154388428
Epoch: 2, Steps: 13 | Train Loss: 0.160 Vali Loss: 14.432 Vali Acc: 0.160 Test Loss: 14.432 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1787974834442139
Epoch: 3, Steps: 13 | Train Loss: 0.002 Vali Loss: 26.022 Vali Acc: 0.200 Test Loss: 26.022 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.111879587173462
Epoch: 4, Steps: 13 | Train Loss: 0.163 Vali Loss: 16.282 Vali Acc: 0.120 Test Loss: 16.282 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0008370876312256
Epoch: 5, Steps: 13 | Train Loss: 0.281 Vali Loss: 16.502 Vali Acc: 0.100 Test Loss: 16.502 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1491522789001465
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.337 Vali Acc: 0.120 Test Loss: 18.337 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1111416816711426
Epoch: 7, Steps: 13 | Train Loss: 0.001 Vali Loss: 21.391 Vali Acc: 0.200 Test Loss: 21.391 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2035770416259766
Epoch: 8, Steps: 13 | Train Loss: 0.525 Vali Loss: 25.540 Vali Acc: 0.180 Test Loss: 25.540 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1289563179016113
Epoch: 9, Steps: 13 | Train Loss: 0.645 Vali Loss: 24.321 Vali Acc: 0.160 Test Loss: 24.321 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1491360664367676
Epoch: 10, Steps: 13 | Train Loss: 0.162 Vali Loss: 56.330 Vali Acc: 0.180 Test Loss: 56.330 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.088874101638794
Epoch: 11, Steps: 13 | Train Loss: 1.624 Vali Loss: 31.637 Vali Acc: 0.180 Test Loss: 31.637 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df256_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 4110757
model size : 16.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.774390459060669
Epoch: 1, Steps: 13 | Train Loss: 1.897 Vali Loss: 5.297 Vali Acc: 0.200 Test Loss: 5.297 Test Acc: 0.200
Validation loss decreased (inf --> -0.199947).  Saving model ...
Epoch: 2 cost time: 0.951850175857544
Epoch: 2, Steps: 13 | Train Loss: 0.033 Vali Loss: 5.778 Vali Acc: 0.120 Test Loss: 5.778 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8468647003173828
Epoch: 3, Steps: 13 | Train Loss: 0.003 Vali Loss: 5.875 Vali Acc: 0.220 Test Loss: 5.875 Test Acc: 0.220
Validation loss decreased (-0.199947 --> -0.219941).  Saving model ...
Epoch: 4 cost time: 0.919567346572876
Epoch: 4, Steps: 13 | Train Loss: 0.269 Vali Loss: 12.536 Vali Acc: 0.200 Test Loss: 12.536 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9955158233642578
Epoch: 5, Steps: 13 | Train Loss: 0.088 Vali Loss: 12.846 Vali Acc: 0.120 Test Loss: 12.846 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0489351749420166
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 13.862 Vali Acc: 0.160 Test Loss: 13.862 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9627926349639893
Epoch: 7, Steps: 13 | Train Loss: 0.031 Vali Loss: 15.900 Vali Acc: 0.080 Test Loss: 15.900 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.023634433746338
Epoch: 8, Steps: 13 | Train Loss: 0.074 Vali Loss: 17.682 Vali Acc: 0.140 Test Loss: 17.682 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.022705078125
Epoch: 9, Steps: 13 | Train Loss: 1.224 Vali Loss: 17.021 Vali Acc: 0.180 Test Loss: 17.021 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.087430477142334
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.780 Vali Acc: 0.100 Test Loss: 16.780 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0092756748199463
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.129 Vali Acc: 0.120 Test Loss: 17.129 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9724164009094238
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 22.442 Vali Acc: 0.100 Test Loss: 22.442 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9796664714813232
Epoch: 13, Steps: 13 | Train Loss: 0.325 Vali Loss: 19.479 Vali Acc: 0.220 Test Loss: 19.479 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 2604805
model size : 10.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df256_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.561396837234497
Epoch: 1, Steps: 13 | Train Loss: 2.317 Vali Loss: 2.699 Vali Acc: 0.260 Test Loss: 2.699 Test Acc: 0.260
Validation loss decreased (inf --> -0.259973).  Saving model ...
Epoch: 2 cost time: 0.9032118320465088
Epoch: 2, Steps: 13 | Train Loss: 0.058 Vali Loss: 5.455 Vali Acc: 0.220 Test Loss: 5.455 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9672684669494629
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.746 Vali Acc: 0.140 Test Loss: 7.746 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8858261108398438
Epoch: 4, Steps: 13 | Train Loss: 0.004 Vali Loss: 7.821 Vali Acc: 0.140 Test Loss: 7.821 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8693068027496338
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.255 Vali Acc: 0.140 Test Loss: 10.255 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.816380500793457
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.253 Vali Acc: 0.160 Test Loss: 9.253 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8299481868743896
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.451 Vali Acc: 0.160 Test Loss: 9.451 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8328897953033447
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.499 Vali Acc: 0.180 Test Loss: 9.499 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8768410682678223
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.517 Vali Acc: 0.180 Test Loss: 9.517 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9144439697265625
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.559 Vali Acc: 0.160 Test Loss: 9.559 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9047386646270752
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.600 Vali Acc: 0.160 Test Loss: 9.600 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df256_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 2174821
model size : 8.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.534348726272583
Epoch: 1, Steps: 13 | Train Loss: 2.054 Vali Loss: 2.427 Vali Acc: 0.240 Test Loss: 2.427 Test Acc: 0.240
Validation loss decreased (inf --> -0.239976).  Saving model ...
Epoch: 2 cost time: 0.811821699142456
Epoch: 2, Steps: 13 | Train Loss: 0.027 Vali Loss: 5.714 Vali Acc: 0.160 Test Loss: 5.714 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9270284175872803
Epoch: 3, Steps: 13 | Train Loss: 0.011 Vali Loss: 5.199 Vali Acc: 0.120 Test Loss: 5.199 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9048135280609131
Epoch: 4, Steps: 13 | Train Loss: 0.009 Vali Loss: 5.436 Vali Acc: 0.200 Test Loss: 5.436 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8713562488555908
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.634 Vali Acc: 0.140 Test Loss: 6.634 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.95635986328125
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.272 Vali Acc: 0.140 Test Loss: 7.272 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8674235343933105
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.230 Vali Acc: 0.140 Test Loss: 7.230 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9327385425567627
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.238 Vali Acc: 0.140 Test Loss: 7.238 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9809300899505615
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.223 Vali Acc: 0.120 Test Loss: 7.223 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9886384010314941
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.083 Vali Acc: 0.120 Test Loss: 7.083 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.935955286026001
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.143 Vali Acc: 0.120 Test Loss: 7.143 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 1529669
model size : 6.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.188656568527222
Epoch: 1, Steps: 25 | Train Loss: 37.329 Vali Loss: 56.516 Vali Acc: 0.200 Test Loss: 56.516 Test Acc: 0.200
Validation loss decreased (inf --> -0.199435).  Saving model ...
Epoch: 2 cost time: 2.602997303009033
Epoch: 2, Steps: 25 | Train Loss: 18.818 Vali Loss: 82.937 Vali Acc: 0.180 Test Loss: 82.937 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.515230894088745
Epoch: 3, Steps: 25 | Train Loss: 6.331 Vali Loss: 116.208 Vali Acc: 0.200 Test Loss: 116.208 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6176159381866455
Epoch: 4, Steps: 25 | Train Loss: 2.746 Vali Loss: 106.876 Vali Acc: 0.180 Test Loss: 106.876 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.79343318939209
Epoch: 5, Steps: 25 | Train Loss: 5.475 Vali Loss: 141.001 Vali Acc: 0.180 Test Loss: 141.001 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6519992351531982
Epoch: 6, Steps: 25 | Train Loss: 5.662 Vali Loss: 184.310 Vali Acc: 0.240 Test Loss: 184.310 Test Acc: 0.240
Validation loss decreased (-0.199435 --> -0.238157).  Saving model ...
Epoch: 7 cost time: 2.5997445583343506
Epoch: 7, Steps: 25 | Train Loss: 5.334 Vali Loss: 155.819 Vali Acc: 0.180 Test Loss: 155.819 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5805344581604004
Epoch: 8, Steps: 25 | Train Loss: 9.118 Vali Loss: 181.470 Vali Acc: 0.160 Test Loss: 181.470 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.716576099395752
Epoch: 9, Steps: 25 | Train Loss: 3.617 Vali Loss: 209.508 Vali Acc: 0.220 Test Loss: 209.508 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7658064365386963
Epoch: 10, Steps: 25 | Train Loss: 0.000 Vali Loss: 206.721 Vali Acc: 0.220 Test Loss: 206.721 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.75828218460083
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 207.315 Vali Acc: 0.220 Test Loss: 207.315 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.75138258934021
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 205.393 Vali Acc: 0.220 Test Loss: 205.393 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.996225595474243
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 204.839 Vali Acc: 0.220 Test Loss: 204.839 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.736114025115967
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 204.054 Vali Acc: 0.220 Test Loss: 204.054 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.726127862930298
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 203.869 Vali Acc: 0.220 Test Loss: 203.869 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.6439192295074463
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 204.755 Vali Acc: 0.220 Test Loss: 204.755 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 14431397
model size : 55.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.352922201156616
Epoch: 1, Steps: 13 | Train Loss: 4.351 Vali Loss: 11.183 Vali Acc: 0.200 Test Loss: 11.183 Test Acc: 0.200
Validation loss decreased (inf --> -0.199888).  Saving model ...
Epoch: 2 cost time: 1.5655264854431152
Epoch: 2, Steps: 13 | Train Loss: 2.603 Vali Loss: 19.697 Vali Acc: 0.200 Test Loss: 19.697 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6345241069793701
Epoch: 3, Steps: 13 | Train Loss: 0.612 Vali Loss: 34.743 Vali Acc: 0.180 Test Loss: 34.743 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.625924825668335
Epoch: 4, Steps: 13 | Train Loss: 1.915 Vali Loss: 24.634 Vali Acc: 0.200 Test Loss: 24.634 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6206789016723633
Epoch: 5, Steps: 13 | Train Loss: 2.166 Vali Loss: 39.263 Vali Acc: 0.180 Test Loss: 39.263 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.582308053970337
Epoch: 6, Steps: 13 | Train Loss: 1.931 Vali Loss: 63.105 Vali Acc: 0.140 Test Loss: 63.105 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5650923252105713
Epoch: 7, Steps: 13 | Train Loss: 2.385 Vali Loss: 46.205 Vali Acc: 0.220 Test Loss: 46.205 Test Acc: 0.220
Validation loss decreased (-0.199888 --> -0.219538).  Saving model ...
Epoch: 8 cost time: 1.537431001663208
Epoch: 8, Steps: 13 | Train Loss: 0.886 Vali Loss: 87.612 Vali Acc: 0.160 Test Loss: 87.612 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5704047679901123
Epoch: 9, Steps: 13 | Train Loss: 5.322 Vali Loss: 110.503 Vali Acc: 0.240 Test Loss: 110.503 Test Acc: 0.240
Validation loss decreased (-0.219538 --> -0.238895).  Saving model ...
Epoch: 10 cost time: 1.5450477600097656
Epoch: 10, Steps: 13 | Train Loss: 4.458 Vali Loss: 97.952 Vali Acc: 0.180 Test Loss: 97.952 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.504028081893921
Epoch: 11, Steps: 13 | Train Loss: 10.712 Vali Loss: 112.040 Vali Acc: 0.220 Test Loss: 112.040 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6065599918365479
Epoch: 12, Steps: 13 | Train Loss: 1.402 Vali Loss: 129.307 Vali Acc: 0.200 Test Loss: 129.307 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6267871856689453
Epoch: 13, Steps: 13 | Train Loss: 0.499 Vali Loss: 84.036 Vali Acc: 0.120 Test Loss: 84.036 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6005911827087402
Epoch: 14, Steps: 13 | Train Loss: 0.647 Vali Loss: 104.269 Vali Acc: 0.180 Test Loss: 104.269 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5949857234954834
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 122.072 Vali Acc: 0.160 Test Loss: 122.072 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6043219566345215
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 128.363 Vali Acc: 0.160 Test Loss: 128.363 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4741549491882324
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 129.977 Vali Acc: 0.160 Test Loss: 129.977 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5548489093780518
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 130.028 Vali Acc: 0.160 Test Loss: 130.028 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5866663455963135
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 129.876 Vali Acc: 0.160 Test Loss: 129.876 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 8190821
model size : 31.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4790902137756348
Epoch: 1, Steps: 13 | Train Loss: 4.005 Vali Loss: 4.314 Vali Acc: 0.160 Test Loss: 4.314 Test Acc: 0.160
Validation loss decreased (inf --> -0.159957).  Saving model ...
Epoch: 2 cost time: 1.0122170448303223
Epoch: 2, Steps: 13 | Train Loss: 0.383 Vali Loss: 8.811 Vali Acc: 0.160 Test Loss: 8.811 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0627126693725586
Epoch: 3, Steps: 13 | Train Loss: 0.760 Vali Loss: 37.837 Vali Acc: 0.200 Test Loss: 37.837 Test Acc: 0.200
Validation loss decreased (-0.159957 --> -0.199622).  Saving model ...
Epoch: 4 cost time: 1.0904200077056885
Epoch: 4, Steps: 13 | Train Loss: 1.912 Vali Loss: 32.501 Vali Acc: 0.180 Test Loss: 32.501 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0652122497558594
Epoch: 5, Steps: 13 | Train Loss: 2.450 Vali Loss: 45.190 Vali Acc: 0.200 Test Loss: 45.190 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0687220096588135
Epoch: 6, Steps: 13 | Train Loss: 0.488 Vali Loss: 61.064 Vali Acc: 0.220 Test Loss: 61.064 Test Acc: 0.220
Validation loss decreased (-0.199622 --> -0.219389).  Saving model ...
Epoch: 7 cost time: 1.1290717124938965
Epoch: 7, Steps: 13 | Train Loss: 4.190 Vali Loss: 35.354 Vali Acc: 0.280 Test Loss: 35.354 Test Acc: 0.280
Validation loss decreased (-0.219389 --> -0.279646).  Saving model ...
Epoch: 8 cost time: 1.0913891792297363
Epoch: 8, Steps: 13 | Train Loss: 5.174 Vali Loss: 45.391 Vali Acc: 0.200 Test Loss: 45.391 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1564476490020752
Epoch: 9, Steps: 13 | Train Loss: 2.310 Vali Loss: 39.601 Vali Acc: 0.240 Test Loss: 39.601 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.114137887954712
Epoch: 10, Steps: 13 | Train Loss: 1.185 Vali Loss: 64.275 Vali Acc: 0.220 Test Loss: 64.275 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0917572975158691
Epoch: 11, Steps: 13 | Train Loss: 1.213 Vali Loss: 94.643 Vali Acc: 0.220 Test Loss: 94.643 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0997815132141113
Epoch: 12, Steps: 13 | Train Loss: 0.123 Vali Loss: 63.469 Vali Acc: 0.140 Test Loss: 63.469 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0610363483428955
Epoch: 13, Steps: 13 | Train Loss: 2.081 Vali Loss: 82.695 Vali Acc: 0.220 Test Loss: 82.695 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1397089958190918
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 91.882 Vali Acc: 0.200 Test Loss: 91.882 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.104522943496704
Epoch: 15, Steps: 13 | Train Loss: 1.843 Vali Loss: 94.469 Vali Acc: 0.200 Test Loss: 94.469 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1627449989318848
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 93.061 Vali Acc: 0.160 Test Loss: 93.061 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0323750972747803
Epoch: 17, Steps: 13 | Train Loss: 2.927 Vali Loss: 85.460 Vali Acc: 0.200 Test Loss: 85.460 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 5178245
model size : 20.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df128_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.46252179145813
Epoch: 1, Steps: 13 | Train Loss: 2.080 Vali Loss: 3.574 Vali Acc: 0.180 Test Loss: 3.574 Test Acc: 0.180
Validation loss decreased (inf --> -0.179964).  Saving model ...
Epoch: 2 cost time: 0.9475715160369873
Epoch: 2, Steps: 13 | Train Loss: 0.003 Vali Loss: 7.814 Vali Acc: 0.100 Test Loss: 7.814 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8897993564605713
Epoch: 3, Steps: 13 | Train Loss: 0.086 Vali Loss: 17.969 Vali Acc: 0.200 Test Loss: 17.969 Test Acc: 0.200
Validation loss decreased (-0.179964 --> -0.199820).  Saving model ...
Epoch: 4 cost time: 0.944739818572998
Epoch: 4, Steps: 13 | Train Loss: 0.090 Vali Loss: 12.276 Vali Acc: 0.140 Test Loss: 12.276 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9211900234222412
Epoch: 5, Steps: 13 | Train Loss: 0.030 Vali Loss: 33.976 Vali Acc: 0.120 Test Loss: 33.976 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9830915927886963
Epoch: 6, Steps: 13 | Train Loss: 1.318 Vali Loss: 19.524 Vali Acc: 0.160 Test Loss: 19.524 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9789109230041504
Epoch: 7, Steps: 13 | Train Loss: 0.540 Vali Loss: 33.980 Vali Acc: 0.200 Test Loss: 33.980 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0147795677185059
Epoch: 8, Steps: 13 | Train Loss: 1.381 Vali Loss: 28.754 Vali Acc: 0.200 Test Loss: 28.754 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0295133590698242
Epoch: 9, Steps: 13 | Train Loss: 0.484 Vali Loss: 34.353 Vali Acc: 0.220 Test Loss: 34.353 Test Acc: 0.220
Validation loss decreased (-0.199820 --> -0.219656).  Saving model ...
Epoch: 10 cost time: 0.95798659324646
Epoch: 10, Steps: 13 | Train Loss: 1.882 Vali Loss: 50.831 Vali Acc: 0.160 Test Loss: 50.831 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9958574771881104
Epoch: 11, Steps: 13 | Train Loss: 0.960 Vali Loss: 56.295 Vali Acc: 0.120 Test Loss: 56.295 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9482367038726807
Epoch: 12, Steps: 13 | Train Loss: 1.237 Vali Loss: 52.917 Vali Acc: 0.240 Test Loss: 52.917 Test Acc: 0.240
Validation loss decreased (-0.219656 --> -0.239471).  Saving model ...
Epoch: 13 cost time: 0.971078634262085
Epoch: 13, Steps: 13 | Train Loss: 1.524 Vali Loss: 66.138 Vali Acc: 0.180 Test Loss: 66.138 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0804417133331299
Epoch: 14, Steps: 13 | Train Loss: 0.017 Vali Loss: 58.531 Vali Acc: 0.160 Test Loss: 58.531 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.037719488143921
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 58.128 Vali Acc: 0.200 Test Loss: 58.128 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9998736381530762
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 71.751 Vali Acc: 0.140 Test Loss: 71.751 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0162858963012695
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 76.409 Vali Acc: 0.160 Test Loss: 76.409 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0601375102996826
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 78.020 Vali Acc: 0.160 Test Loss: 78.020 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9421522617340088
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 78.299 Vali Acc: 0.160 Test Loss: 78.299 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0447664260864258
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 77.974 Vali Acc: 0.160 Test Loss: 77.974 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.084157943725586
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 78.571 Vali Acc: 0.160 Test Loss: 78.571 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.050720453262329
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 78.088 Vali Acc: 0.160 Test Loss: 78.088 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df128_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 4102437
model size : 16.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5802974700927734
Epoch: 1, Steps: 13 | Train Loss: 2.042 Vali Loss: 2.813 Vali Acc: 0.160 Test Loss: 2.813 Test Acc: 0.160
Validation loss decreased (inf --> -0.159972).  Saving model ...
Epoch: 2 cost time: 0.9962468147277832
Epoch: 2, Steps: 13 | Train Loss: 0.007 Vali Loss: 8.670 Vali Acc: 0.160 Test Loss: 8.670 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9467408657073975
Epoch: 3, Steps: 13 | Train Loss: 0.016 Vali Loss: 9.276 Vali Acc: 0.180 Test Loss: 9.276 Test Acc: 0.180
Validation loss decreased (-0.159972 --> -0.179907).  Saving model ...
Epoch: 4 cost time: 0.9484391212463379
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.188 Vali Acc: 0.180 Test Loss: 10.188 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0082886219024658
Epoch: 5, Steps: 13 | Train Loss: 0.006 Vali Loss: 10.011 Vali Acc: 0.180 Test Loss: 10.011 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9009582996368408
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.113 Vali Acc: 0.220 Test Loss: 11.113 Test Acc: 0.220
Validation loss decreased (-0.179907 --> -0.219889).  Saving model ...
Epoch: 7 cost time: 0.9408600330352783
Epoch: 7, Steps: 13 | Train Loss: 0.037 Vali Loss: 14.577 Vali Acc: 0.200 Test Loss: 14.577 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9026689529418945
Epoch: 8, Steps: 13 | Train Loss: 0.108 Vali Loss: 13.313 Vali Acc: 0.240 Test Loss: 13.313 Test Acc: 0.240
Validation loss decreased (-0.219889 --> -0.239867).  Saving model ...
Epoch: 9 cost time: 0.9456734657287598
Epoch: 9, Steps: 13 | Train Loss: 0.422 Vali Loss: 15.140 Vali Acc: 0.260 Test Loss: 15.140 Test Acc: 0.260
Validation loss decreased (-0.239867 --> -0.259849).  Saving model ...
Epoch: 10 cost time: 0.9334568977355957
Epoch: 10, Steps: 13 | Train Loss: 0.612 Vali Loss: 19.081 Vali Acc: 0.200 Test Loss: 19.081 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8102924823760986
Epoch: 11, Steps: 13 | Train Loss: 0.887 Vali Loss: 29.185 Vali Acc: 0.180 Test Loss: 29.185 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9860622882843018
Epoch: 12, Steps: 13 | Train Loss: 0.237 Vali Loss: 39.488 Vali Acc: 0.200 Test Loss: 39.488 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8295779228210449
Epoch: 13, Steps: 13 | Train Loss: 0.235 Vali Loss: 43.903 Vali Acc: 0.140 Test Loss: 43.903 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8860349655151367
Epoch: 14, Steps: 13 | Train Loss: 2.482 Vali Loss: 32.456 Vali Acc: 0.260 Test Loss: 32.456 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9355568885803223
Epoch: 15, Steps: 13 | Train Loss: 0.783 Vali Loss: 40.008 Vali Acc: 0.160 Test Loss: 40.008 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9871234893798828
Epoch: 16, Steps: 13 | Train Loss: 0.459 Vali Loss: 34.173 Vali Acc: 0.140 Test Loss: 34.173 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9645402431488037
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 36.769 Vali Acc: 0.180 Test Loss: 36.769 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9747927188873291
Epoch: 18, Steps: 13 | Train Loss: 0.218 Vali Loss: 40.381 Vali Acc: 0.200 Test Loss: 40.381 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.050736665725708
Epoch: 19, Steps: 13 | Train Loss: 0.482 Vali Loss: 46.379 Vali Acc: 0.200 Test Loss: 46.379 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 2596485
model size : 10.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df128_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5835440158843994
Epoch: 1, Steps: 13 | Train Loss: 2.286 Vali Loss: 2.903 Vali Acc: 0.180 Test Loss: 2.903 Test Acc: 0.180
Validation loss decreased (inf --> -0.179971).  Saving model ...
Epoch: 2 cost time: 0.9288203716278076
Epoch: 2, Steps: 13 | Train Loss: 0.033 Vali Loss: 7.316 Vali Acc: 0.180 Test Loss: 7.316 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8035378456115723
Epoch: 3, Steps: 13 | Train Loss: 0.037 Vali Loss: 5.784 Vali Acc: 0.260 Test Loss: 5.784 Test Acc: 0.260
Validation loss decreased (-0.179971 --> -0.259942).  Saving model ...
Epoch: 4 cost time: 0.9544622898101807
Epoch: 4, Steps: 13 | Train Loss: 0.002 Vali Loss: 8.602 Vali Acc: 0.120 Test Loss: 8.602 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9605445861816406
Epoch: 5, Steps: 13 | Train Loss: 0.034 Vali Loss: 12.514 Vali Acc: 0.160 Test Loss: 12.514 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9720442295074463
Epoch: 6, Steps: 13 | Train Loss: 0.060 Vali Loss: 11.857 Vali Acc: 0.160 Test Loss: 11.857 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.067983627319336
Epoch: 7, Steps: 13 | Train Loss: 0.001 Vali Loss: 11.442 Vali Acc: 0.200 Test Loss: 11.442 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0275781154632568
Epoch: 8, Steps: 13 | Train Loss: 0.198 Vali Loss: 18.348 Vali Acc: 0.140 Test Loss: 18.348 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9561452865600586
Epoch: 9, Steps: 13 | Train Loss: 0.423 Vali Loss: 18.644 Vali Acc: 0.180 Test Loss: 18.644 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9980206489562988
Epoch: 10, Steps: 13 | Train Loss: 0.533 Vali Loss: 18.721 Vali Acc: 0.180 Test Loss: 18.721 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.969383955001831
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 19.224 Vali Acc: 0.180 Test Loss: 19.224 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9624342918395996
Epoch: 12, Steps: 13 | Train Loss: 0.231 Vali Loss: 24.653 Vali Acc: 0.160 Test Loss: 24.653 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9971723556518555
Epoch: 13, Steps: 13 | Train Loss: 0.064 Vali Loss: 17.347 Vali Acc: 0.220 Test Loss: 17.347 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df128_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 2166501
model size : 8.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4109840393066406
Epoch: 1, Steps: 13 | Train Loss: 1.855 Vali Loss: 2.086 Vali Acc: 0.160 Test Loss: 2.086 Test Acc: 0.160
Validation loss decreased (inf --> -0.159979).  Saving model ...
Epoch: 2 cost time: 0.8757262229919434
Epoch: 2, Steps: 13 | Train Loss: 0.061 Vali Loss: 3.680 Vali Acc: 0.300 Test Loss: 3.680 Test Acc: 0.300
Validation loss decreased (-0.159979 --> -0.299963).  Saving model ...
Epoch: 3 cost time: 0.9703946113586426
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.881 Vali Acc: 0.300 Test Loss: 3.881 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9626274108886719
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.150 Vali Acc: 0.300 Test Loss: 4.150 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9220702648162842
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.183 Vali Acc: 0.300 Test Loss: 4.183 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9048247337341309
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.174 Vali Acc: 0.300 Test Loss: 4.174 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0861608982086182
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.204 Vali Acc: 0.300 Test Loss: 4.204 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9345200061798096
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.192 Vali Acc: 0.300 Test Loss: 4.192 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8752048015594482
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.186 Vali Acc: 0.300 Test Loss: 4.186 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9327754974365234
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.192 Vali Acc: 0.320 Test Loss: 4.192 Test Acc: 0.320
Validation loss decreased (-0.299963 --> -0.319958).  Saving model ...
Epoch: 11 cost time: 0.9307951927185059
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.158 Vali Acc: 0.340 Test Loss: 4.158 Test Acc: 0.340
Validation loss decreased (-0.319958 --> -0.339958).  Saving model ...
Epoch: 12 cost time: 0.9846036434173584
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.161 Vali Acc: 0.340 Test Loss: 4.161 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8367047309875488
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.157 Vali Acc: 0.340 Test Loss: 4.157 Test Acc: 0.340
Validation loss decreased (-0.339958 --> -0.339958).  Saving model ...
Epoch: 14 cost time: 1.0135436058044434
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.166 Vali Acc: 0.360 Test Loss: 4.166 Test Acc: 0.360
Validation loss decreased (-0.339958 --> -0.359958).  Saving model ...
Epoch: 15 cost time: 0.9768192768096924
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.163 Vali Acc: 0.340 Test Loss: 4.163 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9861483573913574
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.143 Vali Acc: 0.320 Test Loss: 4.143 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0087578296661377
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.150 Vali Acc: 0.340 Test Loss: 4.150 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9570367336273193
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.145 Vali Acc: 0.320 Test Loss: 4.145 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9899754524230957
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.156 Vali Acc: 0.360 Test Loss: 4.156 Test Acc: 0.360
Validation loss decreased (-0.359958 --> -0.359958).  Saving model ...
Epoch: 20 cost time: 0.8284316062927246
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.143 Vali Acc: 0.320 Test Loss: 4.143 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.839982271194458
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.147 Vali Acc: 0.320 Test Loss: 4.147 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9039592742919922
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.128 Vali Acc: 0.320 Test Loss: 4.128 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9293889999389648
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.158 Vali Acc: 0.320 Test Loss: 4.158 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9033935070037842
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.137 Vali Acc: 0.320 Test Loss: 4.137 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9814395904541016
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.123 Vali Acc: 0.320 Test Loss: 4.123 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8504459857940674
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.121 Vali Acc: 0.320 Test Loss: 4.121 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8364298343658447
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.120 Vali Acc: 0.320 Test Loss: 4.120 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8915212154388428
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.125 Vali Acc: 0.320 Test Loss: 4.125 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8119502067565918
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.132 Vali Acc: 0.300 Test Loss: 4.132 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 1521349
model size : 6.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.207269906997681
Epoch: 1, Steps: 25 | Train Loss: 30.571 Vali Loss: 47.641 Vali Acc: 0.200 Test Loss: 47.641 Test Acc: 0.200
Validation loss decreased (inf --> -0.199524).  Saving model ...
Epoch: 2 cost time: 2.3541347980499268
Epoch: 2, Steps: 25 | Train Loss: 11.111 Vali Loss: 62.567 Vali Acc: 0.160 Test Loss: 62.567 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5022940635681152
Epoch: 3, Steps: 25 | Train Loss: 5.849 Vali Loss: 83.761 Vali Acc: 0.200 Test Loss: 83.761 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.545653820037842
Epoch: 4, Steps: 25 | Train Loss: 7.869 Vali Loss: 183.691 Vali Acc: 0.160 Test Loss: 183.691 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4746086597442627
Epoch: 5, Steps: 25 | Train Loss: 26.883 Vali Loss: 136.141 Vali Acc: 0.240 Test Loss: 136.141 Test Acc: 0.240
Validation loss decreased (-0.199524 --> -0.238639).  Saving model ...
Epoch: 6 cost time: 2.4809350967407227
Epoch: 6, Steps: 25 | Train Loss: 10.466 Vali Loss: 201.907 Vali Acc: 0.220 Test Loss: 201.907 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.368284225463867
Epoch: 7, Steps: 25 | Train Loss: 19.682 Vali Loss: 166.381 Vali Acc: 0.080 Test Loss: 166.381 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6710638999938965
Epoch: 8, Steps: 25 | Train Loss: 1.666 Vali Loss: 218.594 Vali Acc: 0.200 Test Loss: 218.594 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4582831859588623
Epoch: 9, Steps: 25 | Train Loss: 4.148 Vali Loss: 178.340 Vali Acc: 0.220 Test Loss: 178.340 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4721579551696777
Epoch: 10, Steps: 25 | Train Loss: 2.605 Vali Loss: 139.186 Vali Acc: 0.160 Test Loss: 139.186 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3737435340881348
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 157.982 Vali Acc: 0.180 Test Loss: 157.982 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.674924373626709
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 159.774 Vali Acc: 0.200 Test Loss: 159.774 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4297173023223877
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 159.877 Vali Acc: 0.200 Test Loss: 159.877 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4366302490234375
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 160.433 Vali Acc: 0.200 Test Loss: 160.433 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.521730422973633
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 160.127 Vali Acc: 0.200 Test Loss: 160.127 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 14427237
model size : 55.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.255122184753418
Epoch: 1, Steps: 13 | Train Loss: 6.619 Vali Loss: 6.917 Vali Acc: 0.200 Test Loss: 6.917 Test Acc: 0.200
Validation loss decreased (inf --> -0.199931).  Saving model ...
Epoch: 2 cost time: 1.4754209518432617
Epoch: 2, Steps: 13 | Train Loss: 1.582 Vali Loss: 26.010 Vali Acc: 0.200 Test Loss: 26.010 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4270884990692139
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 25.757 Vali Acc: 0.260 Test Loss: 25.757 Test Acc: 0.260
Validation loss decreased (-0.199931 --> -0.259742).  Saving model ...
Epoch: 4 cost time: 1.3774864673614502
Epoch: 4, Steps: 13 | Train Loss: 0.098 Vali Loss: 30.036 Vali Acc: 0.160 Test Loss: 30.036 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3906311988830566
Epoch: 5, Steps: 13 | Train Loss: 3.001 Vali Loss: 39.088 Vali Acc: 0.180 Test Loss: 39.088 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4275312423706055
Epoch: 6, Steps: 13 | Train Loss: 2.127 Vali Loss: 75.361 Vali Acc: 0.200 Test Loss: 75.361 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3339710235595703
Epoch: 7, Steps: 13 | Train Loss: 6.493 Vali Loss: 70.602 Vali Acc: 0.160 Test Loss: 70.602 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3342313766479492
Epoch: 8, Steps: 13 | Train Loss: 1.807 Vali Loss: 79.742 Vali Acc: 0.220 Test Loss: 79.742 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.328906774520874
Epoch: 9, Steps: 13 | Train Loss: 3.814 Vali Loss: 86.784 Vali Acc: 0.200 Test Loss: 86.784 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3386530876159668
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 64.541 Vali Acc: 0.160 Test Loss: 64.541 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.406665325164795
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 78.019 Vali Acc: 0.200 Test Loss: 78.019 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4404950141906738
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 85.162 Vali Acc: 0.180 Test Loss: 85.162 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4215171337127686
Epoch: 13, Steps: 13 | Train Loss: 0.886 Vali Loss: 95.088 Vali Acc: 0.160 Test Loss: 95.088 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 8186661
model size : 31.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.613821268081665
Epoch: 1, Steps: 13 | Train Loss: 2.567 Vali Loss: 10.911 Vali Acc: 0.200 Test Loss: 10.911 Test Acc: 0.200
Validation loss decreased (inf --> -0.199891).  Saving model ...
Epoch: 2 cost time: 1.2022366523742676
Epoch: 2, Steps: 13 | Train Loss: 0.455 Vali Loss: 14.268 Vali Acc: 0.220 Test Loss: 14.268 Test Acc: 0.220
Validation loss decreased (-0.199891 --> -0.219857).  Saving model ...
Epoch: 3 cost time: 1.1579883098602295
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.005 Vali Acc: 0.140 Test Loss: 16.005 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1745011806488037
Epoch: 4, Steps: 13 | Train Loss: 0.008 Vali Loss: 29.663 Vali Acc: 0.180 Test Loss: 29.663 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3216536045074463
Epoch: 5, Steps: 13 | Train Loss: 1.717 Vali Loss: 41.991 Vali Acc: 0.160 Test Loss: 41.991 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1820919513702393
Epoch: 6, Steps: 13 | Train Loss: 2.076 Vali Loss: 33.508 Vali Acc: 0.120 Test Loss: 33.508 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.064087152481079
Epoch: 7, Steps: 13 | Train Loss: 2.854 Vali Loss: 45.394 Vali Acc: 0.180 Test Loss: 45.394 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.035370111465454
Epoch: 8, Steps: 13 | Train Loss: 1.809 Vali Loss: 53.593 Vali Acc: 0.160 Test Loss: 53.593 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0988073348999023
Epoch: 9, Steps: 13 | Train Loss: 2.945 Vali Loss: 67.200 Vali Acc: 0.200 Test Loss: 67.200 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.053154706954956
Epoch: 10, Steps: 13 | Train Loss: 0.809 Vali Loss: 46.318 Vali Acc: 0.140 Test Loss: 46.318 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0866436958312988
Epoch: 11, Steps: 13 | Train Loss: 1.000 Vali Loss: 75.022 Vali Acc: 0.180 Test Loss: 75.022 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3263027667999268
Epoch: 12, Steps: 13 | Train Loss: 0.955 Vali Loss: 49.498 Vali Acc: 0.140 Test Loss: 49.498 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 5174085
model size : 20.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df64_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.059478521347046
Epoch: 1, Steps: 13 | Train Loss: 2.673 Vali Loss: 7.050 Vali Acc: 0.200 Test Loss: 7.050 Test Acc: 0.200
Validation loss decreased (inf --> -0.199929).  Saving model ...
Epoch: 2 cost time: 1.287961721420288
Epoch: 2, Steps: 13 | Train Loss: 0.706 Vali Loss: 19.266 Vali Acc: 0.200 Test Loss: 19.266 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.374727725982666
Epoch: 3, Steps: 13 | Train Loss: 0.735 Vali Loss: 16.921 Vali Acc: 0.200 Test Loss: 16.921 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1891796588897705
Epoch: 4, Steps: 13 | Train Loss: 0.627 Vali Loss: 16.388 Vali Acc: 0.140 Test Loss: 16.388 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2161531448364258
Epoch: 5, Steps: 13 | Train Loss: 0.148 Vali Loss: 21.434 Vali Acc: 0.100 Test Loss: 21.434 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3560400009155273
Epoch: 6, Steps: 13 | Train Loss: 0.416 Vali Loss: 21.406 Vali Acc: 0.140 Test Loss: 21.406 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.22977614402771
Epoch: 7, Steps: 13 | Train Loss: 0.020 Vali Loss: 33.069 Vali Acc: 0.180 Test Loss: 33.069 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.120220422744751
Epoch: 8, Steps: 13 | Train Loss: 0.872 Vali Loss: 33.682 Vali Acc: 0.140 Test Loss: 33.682 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1229217052459717
Epoch: 9, Steps: 13 | Train Loss: 1.109 Vali Loss: 38.502 Vali Acc: 0.140 Test Loss: 38.502 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.238673448562622
Epoch: 10, Steps: 13 | Train Loss: 0.175 Vali Loss: 45.025 Vali Acc: 0.100 Test Loss: 45.025 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0907533168792725
Epoch: 11, Steps: 13 | Train Loss: 2.111 Vali Loss: 42.118 Vali Acc: 0.140 Test Loss: 42.118 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df64_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 4098277
model size : 16.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6835639476776123
Epoch: 1, Steps: 13 | Train Loss: 2.167 Vali Loss: 3.266 Vali Acc: 0.180 Test Loss: 3.266 Test Acc: 0.180
Validation loss decreased (inf --> -0.179967).  Saving model ...
Epoch: 2 cost time: 0.956282377243042
Epoch: 2, Steps: 13 | Train Loss: 0.041 Vali Loss: 7.751 Vali Acc: 0.160 Test Loss: 7.751 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8902297019958496
Epoch: 3, Steps: 13 | Train Loss: 0.005 Vali Loss: 12.516 Vali Acc: 0.220 Test Loss: 12.516 Test Acc: 0.220
Validation loss decreased (-0.179967 --> -0.219875).  Saving model ...
Epoch: 4 cost time: 0.9253790378570557
Epoch: 4, Steps: 13 | Train Loss: 0.061 Vali Loss: 11.830 Vali Acc: 0.200 Test Loss: 11.830 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9822690486907959
Epoch: 5, Steps: 13 | Train Loss: 0.409 Vali Loss: 12.444 Vali Acc: 0.200 Test Loss: 12.444 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9652411937713623
Epoch: 6, Steps: 13 | Train Loss: 0.146 Vali Loss: 19.404 Vali Acc: 0.160 Test Loss: 19.404 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.05670166015625
Epoch: 7, Steps: 13 | Train Loss: 0.158 Vali Loss: 19.709 Vali Acc: 0.160 Test Loss: 19.709 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0842909812927246
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 21.450 Vali Acc: 0.160 Test Loss: 21.450 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0503830909729004
Epoch: 9, Steps: 13 | Train Loss: 0.016 Vali Loss: 26.318 Vali Acc: 0.160 Test Loss: 26.318 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8940021991729736
Epoch: 10, Steps: 13 | Train Loss: 0.587 Vali Loss: 45.614 Vali Acc: 0.160 Test Loss: 45.614 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.930732011795044
Epoch: 11, Steps: 13 | Train Loss: 0.171 Vali Loss: 33.701 Vali Acc: 0.160 Test Loss: 33.701 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0303192138671875
Epoch: 12, Steps: 13 | Train Loss: 0.486 Vali Loss: 51.461 Vali Acc: 0.200 Test Loss: 51.461 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8823182582855225
Epoch: 13, Steps: 13 | Train Loss: 0.491 Vali Loss: 44.634 Vali Acc: 0.140 Test Loss: 44.634 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 2592325
model size : 10.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df64_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.500951051712036
Epoch: 1, Steps: 13 | Train Loss: 2.661 Vali Loss: 2.185 Vali Acc: 0.180 Test Loss: 2.185 Test Acc: 0.180
Validation loss decreased (inf --> -0.179978).  Saving model ...
Epoch: 2 cost time: 0.8731884956359863
Epoch: 2, Steps: 13 | Train Loss: 0.027 Vali Loss: 4.733 Vali Acc: 0.240 Test Loss: 4.733 Test Acc: 0.240
Validation loss decreased (-0.179978 --> -0.239953).  Saving model ...
Epoch: 3 cost time: 0.7945964336395264
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.449 Vali Acc: 0.220 Test Loss: 7.449 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9225406646728516
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.734 Vali Acc: 0.220 Test Loss: 8.734 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9546620845794678
Epoch: 5, Steps: 13 | Train Loss: 0.009 Vali Loss: 11.859 Vali Acc: 0.240 Test Loss: 11.859 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9305601119995117
Epoch: 6, Steps: 13 | Train Loss: 0.815 Vali Loss: 12.804 Vali Acc: 0.180 Test Loss: 12.804 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9124472141265869
Epoch: 7, Steps: 13 | Train Loss: 0.714 Vali Loss: 14.999 Vali Acc: 0.240 Test Loss: 14.999 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9885509014129639
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.527 Vali Acc: 0.200 Test Loss: 19.527 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8657867908477783
Epoch: 9, Steps: 13 | Train Loss: 0.273 Vali Loss: 12.731 Vali Acc: 0.220 Test Loss: 12.731 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8528642654418945
Epoch: 10, Steps: 13 | Train Loss: 0.472 Vali Loss: 16.514 Vali Acc: 0.200 Test Loss: 16.514 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8516035079956055
Epoch: 11, Steps: 13 | Train Loss: 0.028 Vali Loss: 18.792 Vali Acc: 0.240 Test Loss: 18.792 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9103374481201172
Epoch: 12, Steps: 13 | Train Loss: 0.126 Vali Loss: 18.153 Vali Acc: 0.200 Test Loss: 18.153 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df64_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 2162341
model size : 8.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.35774564743042
Epoch: 1, Steps: 13 | Train Loss: 1.902 Vali Loss: 2.897 Vali Acc: 0.180 Test Loss: 2.897 Test Acc: 0.180
Validation loss decreased (inf --> -0.179971).  Saving model ...
Epoch: 2 cost time: 0.8128502368927002
Epoch: 2, Steps: 13 | Train Loss: 0.021 Vali Loss: 4.435 Vali Acc: 0.180 Test Loss: 4.435 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7163734436035156
Epoch: 3, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.427 Vali Acc: 0.180 Test Loss: 5.427 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7876288890838623
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.825 Vali Acc: 0.180 Test Loss: 5.825 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7698054313659668
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.911 Vali Acc: 0.160 Test Loss: 5.911 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.79245924949646
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.907 Vali Acc: 0.180 Test Loss: 5.907 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8741164207458496
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.895 Vali Acc: 0.180 Test Loss: 5.895 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7967588901519775
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.869 Vali Acc: 0.180 Test Loss: 5.869 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.713965654373169
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.856 Vali Acc: 0.160 Test Loss: 5.856 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8660590648651123
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.837 Vali Acc: 0.180 Test Loss: 5.837 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.791597843170166
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.815 Vali Acc: 0.180 Test Loss: 5.815 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm32_nh4_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.18
model parameter : 1517189
model size : 6.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df256_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.925063133239746
Epoch: 1, Steps: 25 | Train Loss: 11.821 Vali Loss: 19.041 Vali Acc: 0.200 Test Loss: 19.041 Test Acc: 0.200
Validation loss decreased (inf --> -0.199810).  Saving model ...
Epoch: 2 cost time: 2.262367010116577
Epoch: 2, Steps: 25 | Train Loss: 1.789 Vali Loss: 32.783 Vali Acc: 0.180 Test Loss: 32.783 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.35917592048645
Epoch: 3, Steps: 25 | Train Loss: 5.413 Vali Loss: 35.107 Vali Acc: 0.140 Test Loss: 35.107 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.26761531829834
Epoch: 4, Steps: 25 | Train Loss: 17.242 Vali Loss: 91.160 Vali Acc: 0.200 Test Loss: 91.160 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3845558166503906
Epoch: 5, Steps: 25 | Train Loss: 15.263 Vali Loss: 65.108 Vali Acc: 0.240 Test Loss: 65.108 Test Acc: 0.240
Validation loss decreased (-0.199810 --> -0.239349).  Saving model ...
Epoch: 6 cost time: 2.323103427886963
Epoch: 6, Steps: 25 | Train Loss: 5.527 Vali Loss: 84.960 Vali Acc: 0.200 Test Loss: 84.960 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.268644094467163
Epoch: 7, Steps: 25 | Train Loss: 1.024 Vali Loss: 102.399 Vali Acc: 0.180 Test Loss: 102.399 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3384218215942383
Epoch: 8, Steps: 25 | Train Loss: 7.616 Vali Loss: 107.777 Vali Acc: 0.240 Test Loss: 107.777 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3205273151397705
Epoch: 9, Steps: 25 | Train Loss: 0.719 Vali Loss: 124.207 Vali Acc: 0.220 Test Loss: 124.207 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.466695547103882
Epoch: 10, Steps: 25 | Train Loss: 3.348 Vali Loss: 191.349 Vali Acc: 0.200 Test Loss: 191.349 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.264068603515625
Epoch: 11, Steps: 25 | Train Loss: 6.390 Vali Loss: 126.744 Vali Acc: 0.220 Test Loss: 126.744 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3646187782287598
Epoch: 12, Steps: 25 | Train Loss: 2.658 Vali Loss: 75.149 Vali Acc: 0.160 Test Loss: 75.149 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3138811588287354
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 86.330 Vali Acc: 0.160 Test Loss: 86.330 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.409512519836426
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 87.611 Vali Acc: 0.140 Test Loss: 87.611 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.4778289794921875
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 87.671 Vali Acc: 0.140 Test Loss: 87.671 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df256_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 7218965
model size : 27.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df256_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.90218186378479
Epoch: 1, Steps: 13 | Train Loss: 2.404 Vali Loss: 6.424 Vali Acc: 0.200 Test Loss: 6.424 Test Acc: 0.200
Validation loss decreased (inf --> -0.199936).  Saving model ...
Epoch: 2 cost time: 1.3998923301696777
Epoch: 2, Steps: 13 | Train Loss: 0.441 Vali Loss: 13.479 Vali Acc: 0.200 Test Loss: 13.479 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3688459396362305
Epoch: 3, Steps: 13 | Train Loss: 1.670 Vali Loss: 17.417 Vali Acc: 0.200 Test Loss: 17.417 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4806699752807617
Epoch: 4, Steps: 13 | Train Loss: 0.573 Vali Loss: 18.640 Vali Acc: 0.200 Test Loss: 18.640 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5386784076690674
Epoch: 5, Steps: 13 | Train Loss: 0.045 Vali Loss: 20.876 Vali Acc: 0.200 Test Loss: 20.876 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4661352634429932
Epoch: 6, Steps: 13 | Train Loss: 0.999 Vali Loss: 31.843 Vali Acc: 0.160 Test Loss: 31.843 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5409128665924072
Epoch: 7, Steps: 13 | Train Loss: 2.361 Vali Loss: 35.513 Vali Acc: 0.220 Test Loss: 35.513 Test Acc: 0.220
Validation loss decreased (-0.199936 --> -0.219645).  Saving model ...
Epoch: 8 cost time: 1.5491681098937988
Epoch: 8, Steps: 13 | Train Loss: 2.848 Vali Loss: 38.389 Vali Acc: 0.260 Test Loss: 38.389 Test Acc: 0.260
Validation loss decreased (-0.219645 --> -0.259616).  Saving model ...
Epoch: 9 cost time: 1.5003108978271484
Epoch: 9, Steps: 13 | Train Loss: 0.813 Vali Loss: 31.570 Vali Acc: 0.200 Test Loss: 31.570 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4156553745269775
Epoch: 10, Steps: 13 | Train Loss: 0.815 Vali Loss: 32.113 Vali Acc: 0.220 Test Loss: 32.113 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4464690685272217
Epoch: 11, Steps: 13 | Train Loss: 0.226 Vali Loss: 38.136 Vali Acc: 0.220 Test Loss: 38.136 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.428776502609253
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 41.543 Vali Acc: 0.180 Test Loss: 41.543 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5251033306121826
Epoch: 13, Steps: 13 | Train Loss: 0.072 Vali Loss: 55.797 Vali Acc: 0.180 Test Loss: 55.797 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4431047439575195
Epoch: 14, Steps: 13 | Train Loss: 1.183 Vali Loss: 41.756 Vali Acc: 0.140 Test Loss: 41.756 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5365843772888184
Epoch: 15, Steps: 13 | Train Loss: 2.790 Vali Loss: 45.846 Vali Acc: 0.120 Test Loss: 45.846 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5004417896270752
Epoch: 16, Steps: 13 | Train Loss: 0.211 Vali Loss: 75.918 Vali Acc: 0.180 Test Loss: 75.918 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5250701904296875
Epoch: 17, Steps: 13 | Train Loss: 0.102 Vali Loss: 73.608 Vali Acc: 0.200 Test Loss: 73.608 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.418217420578003
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 108.073 Vali Acc: 0.200 Test Loss: 108.073 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df256_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 4098677
model size : 15.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6232259273529053
Epoch: 1, Steps: 13 | Train Loss: 3.015 Vali Loss: 3.712 Vali Acc: 0.240 Test Loss: 3.712 Test Acc: 0.240
Validation loss decreased (inf --> -0.239963).  Saving model ...
Epoch: 2 cost time: 1.078251838684082
Epoch: 2, Steps: 13 | Train Loss: 0.343 Vali Loss: 7.776 Vali Acc: 0.160 Test Loss: 7.776 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0945260524749756
Epoch: 3, Steps: 13 | Train Loss: 0.033 Vali Loss: 8.240 Vali Acc: 0.160 Test Loss: 8.240 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0902397632598877
Epoch: 4, Steps: 13 | Train Loss: 0.131 Vali Loss: 13.554 Vali Acc: 0.180 Test Loss: 13.554 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1781253814697266
Epoch: 5, Steps: 13 | Train Loss: 0.033 Vali Loss: 9.300 Vali Acc: 0.220 Test Loss: 9.300 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2494196891784668
Epoch: 6, Steps: 13 | Train Loss: 0.662 Vali Loss: 13.942 Vali Acc: 0.160 Test Loss: 13.942 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2019107341766357
Epoch: 7, Steps: 13 | Train Loss: 0.505 Vali Loss: 15.753 Vali Acc: 0.180 Test Loss: 15.753 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.210608720779419
Epoch: 8, Steps: 13 | Train Loss: 0.316 Vali Loss: 20.129 Vali Acc: 0.160 Test Loss: 20.129 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1253349781036377
Epoch: 9, Steps: 13 | Train Loss: 0.043 Vali Loss: 20.985 Vali Acc: 0.100 Test Loss: 20.985 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1263093948364258
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 19.587 Vali Acc: 0.120 Test Loss: 19.587 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2065072059631348
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.486 Vali Acc: 0.120 Test Loss: 18.486 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 2592389
model size : 10.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df256_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.730726957321167
Epoch: 1, Steps: 13 | Train Loss: 2.243 Vali Loss: 3.560 Vali Acc: 0.200 Test Loss: 3.560 Test Acc: 0.200
Validation loss decreased (inf --> -0.199964).  Saving model ...
Epoch: 2 cost time: 0.9612770080566406
Epoch: 2, Steps: 13 | Train Loss: 0.250 Vali Loss: 4.767 Vali Acc: 0.180 Test Loss: 4.767 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9283959865570068
Epoch: 3, Steps: 13 | Train Loss: 0.046 Vali Loss: 5.799 Vali Acc: 0.180 Test Loss: 5.799 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9813482761383057
Epoch: 4, Steps: 13 | Train Loss: 0.001 Vali Loss: 10.719 Vali Acc: 0.180 Test Loss: 10.719 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1204519271850586
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.902 Vali Acc: 0.160 Test Loss: 6.902 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0303118228912354
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.987 Vali Acc: 0.180 Test Loss: 9.987 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9669315814971924
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.461 Vali Acc: 0.140 Test Loss: 9.461 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0178396701812744
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.139 Vali Acc: 0.120 Test Loss: 9.139 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0132441520690918
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.063 Vali Acc: 0.120 Test Loss: 9.063 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0860390663146973
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.049 Vali Acc: 0.120 Test Loss: 9.049 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0330657958984375
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.017 Vali Acc: 0.120 Test Loss: 9.017 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df256_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 2054485
model size : 8.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5968620777130127
Epoch: 1, Steps: 13 | Train Loss: 1.916 Vali Loss: 2.212 Vali Acc: 0.220 Test Loss: 2.212 Test Acc: 0.220
Validation loss decreased (inf --> -0.219978).  Saving model ...
Epoch: 2 cost time: 1.0462217330932617
Epoch: 2, Steps: 13 | Train Loss: 0.127 Vali Loss: 4.379 Vali Acc: 0.260 Test Loss: 4.379 Test Acc: 0.260
Validation loss decreased (-0.219978 --> -0.259956).  Saving model ...
Epoch: 3 cost time: 1.1235620975494385
Epoch: 3, Steps: 13 | Train Loss: 0.037 Vali Loss: 4.804 Vali Acc: 0.120 Test Loss: 4.804 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.060502052307129
Epoch: 4, Steps: 13 | Train Loss: 0.256 Vali Loss: 6.443 Vali Acc: 0.180 Test Loss: 6.443 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0175323486328125
Epoch: 5, Steps: 13 | Train Loss: 0.003 Vali Loss: 7.404 Vali Acc: 0.180 Test Loss: 7.404 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0571930408477783
Epoch: 6, Steps: 13 | Train Loss: 0.015 Vali Loss: 8.092 Vali Acc: 0.160 Test Loss: 8.092 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0633633136749268
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.329 Vali Acc: 0.180 Test Loss: 9.329 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0352849960327148
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 8.577 Vali Acc: 0.240 Test Loss: 8.577 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0829193592071533
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.724 Vali Acc: 0.220 Test Loss: 10.724 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9857184886932373
Epoch: 10, Steps: 13 | Train Loss: 0.033 Vali Loss: 8.519 Vali Acc: 0.240 Test Loss: 8.519 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9872801303863525
Epoch: 11, Steps: 13 | Train Loss: 0.108 Vali Loss: 7.805 Vali Acc: 0.260 Test Loss: 7.805 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9285035133361816
Epoch: 12, Steps: 13 | Train Loss: 0.157 Vali Loss: 10.820 Vali Acc: 0.140 Test Loss: 10.820 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 1301509
model size : 5.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df256_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3585574626922607
Epoch: 1, Steps: 13 | Train Loss: 1.869 Vali Loss: 2.588 Vali Acc: 0.240 Test Loss: 2.588 Test Acc: 0.240
Validation loss decreased (inf --> -0.239974).  Saving model ...
Epoch: 2 cost time: 0.9093310832977295
Epoch: 2, Steps: 13 | Train Loss: 0.079 Vali Loss: 3.328 Vali Acc: 0.200 Test Loss: 3.328 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8042459487915039
Epoch: 3, Steps: 13 | Train Loss: 0.021 Vali Loss: 4.467 Vali Acc: 0.120 Test Loss: 4.467 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9986846446990967
Epoch: 4, Steps: 13 | Train Loss: 0.008 Vali Loss: 5.116 Vali Acc: 0.120 Test Loss: 5.116 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9629602432250977
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.129 Vali Acc: 0.220 Test Loss: 5.129 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9038078784942627
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.046 Vali Acc: 0.180 Test Loss: 6.046 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8929991722106934
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.080 Vali Acc: 0.180 Test Loss: 6.080 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9257559776306152
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.019 Vali Acc: 0.200 Test Loss: 6.019 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8146641254425049
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.956 Vali Acc: 0.200 Test Loss: 5.956 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9060120582580566
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.876 Vali Acc: 0.200 Test Loss: 5.876 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8797931671142578
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.852 Vali Acc: 0.200 Test Loss: 5.852 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df256_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 1086517
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.363600015640259
Epoch: 1, Steps: 13 | Train Loss: 1.744 Vali Loss: 1.873 Vali Acc: 0.260 Test Loss: 1.873 Test Acc: 0.260
Validation loss decreased (inf --> -0.259981).  Saving model ...
Epoch: 2 cost time: 0.8645992279052734
Epoch: 2, Steps: 13 | Train Loss: 0.073 Vali Loss: 2.717 Vali Acc: 0.200 Test Loss: 2.717 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7837865352630615
Epoch: 3, Steps: 13 | Train Loss: 0.002 Vali Loss: 3.366 Vali Acc: 0.160 Test Loss: 3.366 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8585968017578125
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.667 Vali Acc: 0.200 Test Loss: 3.667 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0174202919006348
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.797 Vali Acc: 0.200 Test Loss: 3.797 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8161115646362305
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.820 Vali Acc: 0.200 Test Loss: 3.820 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7452354431152344
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.808 Vali Acc: 0.200 Test Loss: 3.808 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7726519107818604
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.796 Vali Acc: 0.200 Test Loss: 3.796 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8092782497406006
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.792 Vali Acc: 0.180 Test Loss: 3.792 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9957540035247803
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.776 Vali Acc: 0.200 Test Loss: 3.776 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0218133926391602
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.760 Vali Acc: 0.200 Test Loss: 3.760 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 763941
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df128_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4192514419555664
Epoch: 1, Steps: 25 | Train Loss: 10.558 Vali Loss: 14.878 Vali Acc: 0.160 Test Loss: 14.878 Test Acc: 0.160
Validation loss decreased (inf --> -0.159851).  Saving model ...
Epoch: 2 cost time: 2.0503058433532715
Epoch: 2, Steps: 25 | Train Loss: 10.880 Vali Loss: 56.679 Vali Acc: 0.200 Test Loss: 56.679 Test Acc: 0.200
Validation loss decreased (-0.159851 --> -0.199433).  Saving model ...
Epoch: 3 cost time: 2.015517234802246
Epoch: 3, Steps: 25 | Train Loss: 10.749 Vali Loss: 31.859 Vali Acc: 0.180 Test Loss: 31.859 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.083902359008789
Epoch: 4, Steps: 25 | Train Loss: 1.059 Vali Loss: 60.888 Vali Acc: 0.160 Test Loss: 60.888 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.084550380706787
Epoch: 5, Steps: 25 | Train Loss: 2.171 Vali Loss: 69.076 Vali Acc: 0.220 Test Loss: 69.076 Test Acc: 0.220
Validation loss decreased (-0.199433 --> -0.219309).  Saving model ...
Epoch: 6 cost time: 1.958282232284546
Epoch: 6, Steps: 25 | Train Loss: 12.379 Vali Loss: 73.247 Vali Acc: 0.260 Test Loss: 73.247 Test Acc: 0.260
Validation loss decreased (-0.219309 --> -0.259268).  Saving model ...
Epoch: 7 cost time: 2.3144643306732178
Epoch: 7, Steps: 25 | Train Loss: 0.987 Vali Loss: 46.795 Vali Acc: 0.160 Test Loss: 46.795 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3316452503204346
Epoch: 8, Steps: 25 | Train Loss: 0.000 Vali Loss: 51.656 Vali Acc: 0.220 Test Loss: 51.656 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2550156116485596
Epoch: 9, Steps: 25 | Train Loss: 0.000 Vali Loss: 52.625 Vali Acc: 0.220 Test Loss: 52.625 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2255427837371826
Epoch: 10, Steps: 25 | Train Loss: 0.000 Vali Loss: 52.174 Vali Acc: 0.220 Test Loss: 52.174 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.176076889038086
Epoch: 11, Steps: 25 | Train Loss: 0.000 Vali Loss: 52.217 Vali Acc: 0.220 Test Loss: 52.217 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2331576347351074
Epoch: 12, Steps: 25 | Train Loss: 0.000 Vali Loss: 51.823 Vali Acc: 0.220 Test Loss: 51.823 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.247107982635498
Epoch: 13, Steps: 25 | Train Loss: 0.000 Vali Loss: 52.043 Vali Acc: 0.220 Test Loss: 52.043 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.455118179321289
Epoch: 14, Steps: 25 | Train Loss: 0.000 Vali Loss: 52.016 Vali Acc: 0.220 Test Loss: 52.016 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.248105764389038
Epoch: 15, Steps: 25 | Train Loss: 0.000 Vali Loss: 51.887 Vali Acc: 0.220 Test Loss: 51.887 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.2726478576660156
Epoch: 16, Steps: 25 | Train Loss: 0.000 Vali Loss: 51.825 Vali Acc: 0.220 Test Loss: 51.825 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df128_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 7214741
model size : 27.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df128_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.231663465499878
Epoch: 1, Steps: 13 | Train Loss: 2.840 Vali Loss: 8.606 Vali Acc: 0.160 Test Loss: 8.606 Test Acc: 0.160
Validation loss decreased (inf --> -0.159914).  Saving model ...
Epoch: 2 cost time: 1.458972454071045
Epoch: 2, Steps: 13 | Train Loss: 1.056 Vali Loss: 18.581 Vali Acc: 0.200 Test Loss: 18.581 Test Acc: 0.200
Validation loss decreased (-0.159914 --> -0.199814).  Saving model ...
Epoch: 3 cost time: 1.538081407546997
Epoch: 3, Steps: 13 | Train Loss: 2.511 Vali Loss: 25.887 Vali Acc: 0.180 Test Loss: 25.887 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4775974750518799
Epoch: 4, Steps: 13 | Train Loss: 0.541 Vali Loss: 38.727 Vali Acc: 0.200 Test Loss: 38.727 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4117817878723145
Epoch: 5, Steps: 13 | Train Loss: 2.979 Vali Loss: 39.853 Vali Acc: 0.180 Test Loss: 39.853 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4973680973052979
Epoch: 6, Steps: 13 | Train Loss: 2.100 Vali Loss: 57.513 Vali Acc: 0.180 Test Loss: 57.513 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4907853603363037
Epoch: 7, Steps: 13 | Train Loss: 3.093 Vali Loss: 31.521 Vali Acc: 0.200 Test Loss: 31.521 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5783212184906006
Epoch: 8, Steps: 13 | Train Loss: 0.781 Vali Loss: 31.078 Vali Acc: 0.180 Test Loss: 31.078 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7068355083465576
Epoch: 9, Steps: 13 | Train Loss: 1.338 Vali Loss: 42.891 Vali Acc: 0.180 Test Loss: 42.891 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6379928588867188
Epoch: 10, Steps: 13 | Train Loss: 1.035 Vali Loss: 46.040 Vali Acc: 0.200 Test Loss: 46.040 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.345266580581665
Epoch: 11, Steps: 13 | Train Loss: 0.447 Vali Loss: 40.730 Vali Acc: 0.180 Test Loss: 40.730 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5263209342956543
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 78.080 Vali Acc: 0.200 Test Loss: 78.080 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df128_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.2
model parameter : 4094453
model size : 15.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8368372917175293
Epoch: 1, Steps: 13 | Train Loss: 2.157 Vali Loss: 4.425 Vali Acc: 0.220 Test Loss: 4.425 Test Acc: 0.220
Validation loss decreased (inf --> -0.219956).  Saving model ...
Epoch: 2 cost time: 1.0947949886322021
Epoch: 2, Steps: 13 | Train Loss: 0.375 Vali Loss: 6.921 Vali Acc: 0.160 Test Loss: 6.921 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0972650051116943
Epoch: 3, Steps: 13 | Train Loss: 0.064 Vali Loss: 8.608 Vali Acc: 0.160 Test Loss: 8.608 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0933337211608887
Epoch: 4, Steps: 13 | Train Loss: 0.016 Vali Loss: 12.256 Vali Acc: 0.180 Test Loss: 12.256 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0929205417633057
Epoch: 5, Steps: 13 | Train Loss: 0.627 Vali Loss: 11.744 Vali Acc: 0.120 Test Loss: 11.744 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0285165309906006
Epoch: 6, Steps: 13 | Train Loss: 0.001 Vali Loss: 13.443 Vali Acc: 0.120 Test Loss: 13.443 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1188833713531494
Epoch: 7, Steps: 13 | Train Loss: 0.847 Vali Loss: 12.102 Vali Acc: 0.180 Test Loss: 12.102 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.105640172958374
Epoch: 8, Steps: 13 | Train Loss: 0.383 Vali Loss: 19.727 Vali Acc: 0.180 Test Loss: 19.727 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0638573169708252
Epoch: 9, Steps: 13 | Train Loss: 0.302 Vali Loss: 16.440 Vali Acc: 0.160 Test Loss: 16.440 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.096012830734253
Epoch: 10, Steps: 13 | Train Loss: 0.065 Vali Loss: 26.995 Vali Acc: 0.160 Test Loss: 26.995 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2091114521026611
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.817 Vali Acc: 0.140 Test Loss: 24.817 Test Acc: 0.140
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 2588165
model size : 10.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df128_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.572119951248169
Epoch: 1, Steps: 13 | Train Loss: 1.970 Vali Loss: 3.505 Vali Acc: 0.180 Test Loss: 3.505 Test Acc: 0.180
Validation loss decreased (inf --> -0.179965).  Saving model ...
Epoch: 2 cost time: 0.9589416980743408
Epoch: 2, Steps: 13 | Train Loss: 0.120 Vali Loss: 5.387 Vali Acc: 0.160 Test Loss: 5.387 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8964636325836182
Epoch: 3, Steps: 13 | Train Loss: 0.165 Vali Loss: 8.160 Vali Acc: 0.160 Test Loss: 8.160 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9093582630157471
Epoch: 4, Steps: 13 | Train Loss: 0.141 Vali Loss: 15.517 Vali Acc: 0.160 Test Loss: 15.517 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.959402322769165
Epoch: 5, Steps: 13 | Train Loss: 0.046 Vali Loss: 12.179 Vali Acc: 0.160 Test Loss: 12.179 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8894696235656738
Epoch: 6, Steps: 13 | Train Loss: 0.109 Vali Loss: 11.482 Vali Acc: 0.220 Test Loss: 11.482 Test Acc: 0.220
Validation loss decreased (-0.179965 --> -0.219885).  Saving model ...
Epoch: 7 cost time: 0.9165308475494385
Epoch: 7, Steps: 13 | Train Loss: 0.067 Vali Loss: 14.416 Vali Acc: 0.180 Test Loss: 14.416 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8766520023345947
Epoch: 8, Steps: 13 | Train Loss: 0.142 Vali Loss: 19.895 Vali Acc: 0.140 Test Loss: 19.895 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8970646858215332
Epoch: 9, Steps: 13 | Train Loss: 0.598 Vali Loss: 24.142 Vali Acc: 0.220 Test Loss: 24.142 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8802473545074463
Epoch: 10, Steps: 13 | Train Loss: 0.471 Vali Loss: 16.625 Vali Acc: 0.240 Test Loss: 16.625 Test Acc: 0.240
Validation loss decreased (-0.219885 --> -0.239834).  Saving model ...
Epoch: 11 cost time: 0.9129073619842529
Epoch: 11, Steps: 13 | Train Loss: 0.056 Vali Loss: 22.687 Vali Acc: 0.220 Test Loss: 22.687 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9201047420501709
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 18.306 Vali Acc: 0.200 Test Loss: 18.306 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8923656940460205
Epoch: 13, Steps: 13 | Train Loss: 0.083 Vali Loss: 19.704 Vali Acc: 0.180 Test Loss: 19.704 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9216549396514893
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.644 Vali Acc: 0.160 Test Loss: 23.644 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0387372970581055
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.044 Vali Acc: 0.160 Test Loss: 24.044 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9635207653045654
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.075 Vali Acc: 0.160 Test Loss: 24.075 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0747482776641846
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.991 Vali Acc: 0.160 Test Loss: 23.991 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9083356857299805
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.129 Vali Acc: 0.160 Test Loss: 24.129 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9945504665374756
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.097 Vali Acc: 0.160 Test Loss: 24.097 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0441539287567139
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.007 Vali Acc: 0.160 Test Loss: 24.007 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df128_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 2050261
model size : 8.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.523625373840332
Epoch: 1, Steps: 13 | Train Loss: 2.108 Vali Loss: 2.372 Vali Acc: 0.200 Test Loss: 2.372 Test Acc: 0.200
Validation loss decreased (inf --> -0.199976).  Saving model ...
Epoch: 2 cost time: 0.8582592010498047
Epoch: 2, Steps: 13 | Train Loss: 0.108 Vali Loss: 4.214 Vali Acc: 0.200 Test Loss: 4.214 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8520021438598633
Epoch: 3, Steps: 13 | Train Loss: 0.009 Vali Loss: 5.386 Vali Acc: 0.160 Test Loss: 5.386 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.811453104019165
Epoch: 4, Steps: 13 | Train Loss: 0.003 Vali Loss: 4.808 Vali Acc: 0.140 Test Loss: 4.808 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8884429931640625
Epoch: 5, Steps: 13 | Train Loss: 0.001 Vali Loss: 6.714 Vali Acc: 0.220 Test Loss: 6.714 Test Acc: 0.220
Validation loss decreased (-0.199976 --> -0.219933).  Saving model ...
Epoch: 6 cost time: 0.9510648250579834
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.802 Vali Acc: 0.140 Test Loss: 6.802 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8620719909667969
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.475 Vali Acc: 0.180 Test Loss: 6.475 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9923396110534668
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.456 Vali Acc: 0.200 Test Loss: 6.456 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9605708122253418
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.456 Vali Acc: 0.200 Test Loss: 6.456 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.046675443649292
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.424 Vali Acc: 0.220 Test Loss: 6.424 Test Acc: 0.220
Validation loss decreased (-0.219933 --> -0.219936).  Saving model ...
Epoch: 11 cost time: 0.998455286026001
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.371 Vali Acc: 0.220 Test Loss: 6.371 Test Acc: 0.220
Validation loss decreased (-0.219936 --> -0.219936).  Saving model ...
Epoch: 12 cost time: 1.0000412464141846
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.320 Vali Acc: 0.220 Test Loss: 6.320 Test Acc: 0.220
Validation loss decreased (-0.219936 --> -0.219937).  Saving model ...
Epoch: 13 cost time: 0.7715578079223633
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.311 Vali Acc: 0.220 Test Loss: 6.311 Test Acc: 0.220
Validation loss decreased (-0.219937 --> -0.219937).  Saving model ...
Epoch: 14 cost time: 0.8576102256774902
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.293 Vali Acc: 0.220 Test Loss: 6.293 Test Acc: 0.220
Validation loss decreased (-0.219937 --> -0.219937).  Saving model ...
Epoch: 15 cost time: 0.833690881729126
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.282 Vali Acc: 0.220 Test Loss: 6.282 Test Acc: 0.220
Validation loss decreased (-0.219937 --> -0.219937).  Saving model ...
Epoch: 16 cost time: 0.8916528224945068
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.255 Vali Acc: 0.220 Test Loss: 6.255 Test Acc: 0.220
Validation loss decreased (-0.219937 --> -0.219937).  Saving model ...
Epoch: 17 cost time: 0.9704196453094482
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.254 Vali Acc: 0.220 Test Loss: 6.254 Test Acc: 0.220
Validation loss decreased (-0.219937 --> -0.219937).  Saving model ...
Epoch: 18 cost time: 0.7411916255950928
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.213 Vali Acc: 0.220 Test Loss: 6.213 Test Acc: 0.220
Validation loss decreased (-0.219937 --> -0.219938).  Saving model ...
Epoch: 19 cost time: 0.8924503326416016
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.223 Vali Acc: 0.220 Test Loss: 6.223 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8248672485351562
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.218 Vali Acc: 0.220 Test Loss: 6.218 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0666043758392334
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.200 Vali Acc: 0.220 Test Loss: 6.200 Test Acc: 0.220
Validation loss decreased (-0.219938 --> -0.219938).  Saving model ...
Epoch: 22 cost time: 1.11100435256958
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.170 Vali Acc: 0.220 Test Loss: 6.170 Test Acc: 0.220
Validation loss decreased (-0.219938 --> -0.219938).  Saving model ...
Epoch: 23 cost time: 1.0258710384368896
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.162 Vali Acc: 0.200 Test Loss: 6.162 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2016170024871826
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.155 Vali Acc: 0.200 Test Loss: 6.155 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9422366619110107
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.154 Vali Acc: 0.200 Test Loss: 6.154 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9814901351928711
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.151 Vali Acc: 0.200 Test Loss: 6.151 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9551231861114502
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.140 Vali Acc: 0.200 Test Loss: 6.140 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1264736652374268
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.136 Vali Acc: 0.200 Test Loss: 6.136 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9706768989562988
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.128 Vali Acc: 0.200 Test Loss: 6.128 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0763258934020996
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.114 Vali Acc: 0.200 Test Loss: 6.114 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.000006914138794
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.114 Vali Acc: 0.220 Test Loss: 6.114 Test Acc: 0.220
Validation loss decreased (-0.219938 --> -0.219939).  Saving model ...
Epoch: 32 cost time: 0.849970817565918
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.105 Vali Acc: 0.220 Test Loss: 6.105 Test Acc: 0.220
Validation loss decreased (-0.219939 --> -0.219939).  Saving model ...
Epoch: 33 cost time: 1.021925449371338
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.099 Vali Acc: 0.220 Test Loss: 6.099 Test Acc: 0.220
Validation loss decreased (-0.219939 --> -0.219939).  Saving model ...
Epoch: 34 cost time: 1.1702325344085693
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.104 Vali Acc: 0.200 Test Loss: 6.104 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0076897144317627
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.084 Vali Acc: 0.220 Test Loss: 6.084 Test Acc: 0.220
Validation loss decreased (-0.219939 --> -0.219939).  Saving model ...
Epoch: 36 cost time: 1.1436946392059326
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.077 Vali Acc: 0.200 Test Loss: 6.077 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0373737812042236
Epoch: 37, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.064 Vali Acc: 0.220 Test Loss: 6.064 Test Acc: 0.220
Validation loss decreased (-0.219939 --> -0.219939).  Saving model ...
Epoch: 38 cost time: 1.0490562915802002
Epoch: 38, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.063 Vali Acc: 0.200 Test Loss: 6.063 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0442557334899902
Epoch: 39, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.060 Vali Acc: 0.220 Test Loss: 6.060 Test Acc: 0.220
Validation loss decreased (-0.219939 --> -0.219939).  Saving model ...
Epoch: 40 cost time: 0.9759092330932617
Epoch: 40, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.069 Vali Acc: 0.200 Test Loss: 6.069 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.995661735534668
Epoch: 41, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.057 Vali Acc: 0.200 Test Loss: 6.057 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0557804107666016
Epoch: 42, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.051 Vali Acc: 0.220 Test Loss: 6.051 Test Acc: 0.220
Validation loss decreased (-0.219939 --> -0.219939).  Saving model ...
Epoch: 43 cost time: 1.1161091327667236
Epoch: 43, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.050 Vali Acc: 0.220 Test Loss: 6.050 Test Acc: 0.220
Validation loss decreased (-0.219939 --> -0.219939).  Saving model ...
Epoch: 44 cost time: 1.0290284156799316
Epoch: 44, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.038 Vali Acc: 0.220 Test Loss: 6.038 Test Acc: 0.220
Validation loss decreased (-0.219939 --> -0.219940).  Saving model ...
Epoch: 45 cost time: 0.7974526882171631
Epoch: 45, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.036 Vali Acc: 0.200 Test Loss: 6.036 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.062058448791504
Epoch: 46, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.038 Vali Acc: 0.220 Test Loss: 6.038 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7991092205047607
Epoch: 47, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.026 Vali Acc: 0.200 Test Loss: 6.026 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8621582984924316
Epoch: 48, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.015 Vali Acc: 0.220 Test Loss: 6.015 Test Acc: 0.220
Validation loss decreased (-0.219940 --> -0.219940).  Saving model ...
Epoch: 49 cost time: 0.9333503246307373
Epoch: 49, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.022 Vali Acc: 0.220 Test Loss: 6.022 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9112212657928467
Epoch: 50, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.030 Vali Acc: 0.200 Test Loss: 6.030 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8253457546234131
Epoch: 51, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.021 Vali Acc: 0.200 Test Loss: 6.021 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8254556655883789
Epoch: 52, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.027 Vali Acc: 0.200 Test Loss: 6.027 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8347423076629639
Epoch: 53, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.011 Vali Acc: 0.200 Test Loss: 6.011 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.9014272689819336
Epoch: 54, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.999 Vali Acc: 0.200 Test Loss: 5.999 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.9646387100219727
Epoch: 55, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.988 Vali Acc: 0.220 Test Loss: 5.988 Test Acc: 0.220
Validation loss decreased (-0.219940 --> -0.219940).  Saving model ...
Epoch: 56 cost time: 0.9297363758087158
Epoch: 56, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.979 Vali Acc: 0.200 Test Loss: 5.979 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8770818710327148
Epoch: 57, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.995 Vali Acc: 0.220 Test Loss: 5.995 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.8368346691131592
Epoch: 58, Steps: 13 | Train Loss: 0.000 Vali Loss: 6.004 Vali Acc: 0.220 Test Loss: 6.004 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.8995473384857178
Epoch: 59, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.996 Vali Acc: 0.200 Test Loss: 5.996 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.9619119167327881
Epoch: 60, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.985 Vali Acc: 0.200 Test Loss: 5.985 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.7761242389678955
Epoch: 61, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.960 Vali Acc: 0.220 Test Loss: 5.960 Test Acc: 0.220
Validation loss decreased (-0.219940 --> -0.219940).  Saving model ...
Epoch: 62 cost time: 0.8444657325744629
Epoch: 62, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.978 Vali Acc: 0.200 Test Loss: 5.978 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.9636845588684082
Epoch: 63, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.963 Vali Acc: 0.200 Test Loss: 5.963 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.9693162441253662
Epoch: 64, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.969 Vali Acc: 0.200 Test Loss: 5.969 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.8560404777526855
Epoch: 65, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.960 Vali Acc: 0.200 Test Loss: 5.960 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.0284912586212158
Epoch: 66, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.949 Vali Acc: 0.220 Test Loss: 5.949 Test Acc: 0.220
Validation loss decreased (-0.219940 --> -0.219941).  Saving model ...
Epoch: 67 cost time: 0.975147008895874
Epoch: 67, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.939 Vali Acc: 0.220 Test Loss: 5.939 Test Acc: 0.220
Validation loss decreased (-0.219941 --> -0.219941).  Saving model ...
Epoch: 68 cost time: 0.9739866256713867
Epoch: 68, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.950 Vali Acc: 0.220 Test Loss: 5.950 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.7996795177459717
Epoch: 69, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.940 Vali Acc: 0.200 Test Loss: 5.940 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.8578522205352783
Epoch: 70, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.934 Vali Acc: 0.200 Test Loss: 5.934 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.8723366260528564
Epoch: 71, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.932 Vali Acc: 0.220 Test Loss: 5.932 Test Acc: 0.220
Validation loss decreased (-0.219941 --> -0.219941).  Saving model ...
Epoch: 72 cost time: 0.9756033420562744
Epoch: 72, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.938 Vali Acc: 0.220 Test Loss: 5.938 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.9107544422149658
Epoch: 73, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.943 Vali Acc: 0.200 Test Loss: 5.943 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.9743282794952393
Epoch: 74, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.942 Vali Acc: 0.200 Test Loss: 5.942 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.8105466365814209
Epoch: 75, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.917 Vali Acc: 0.200 Test Loss: 5.917 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.9361634254455566
Epoch: 76, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.920 Vali Acc: 0.200 Test Loss: 5.920 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.8135120868682861
Epoch: 77, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.924 Vali Acc: 0.200 Test Loss: 5.924 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.8572161197662354
Epoch: 78, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.927 Vali Acc: 0.200 Test Loss: 5.927 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.8791217803955078
Epoch: 79, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.920 Vali Acc: 0.200 Test Loss: 5.920 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.8475656509399414
Epoch: 80, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.916 Vali Acc: 0.200 Test Loss: 5.916 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 1.2219574451446533
Epoch: 81, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.926 Vali Acc: 0.200 Test Loss: 5.926 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 1297285
model size : 5.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df128_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5328385829925537
Epoch: 1, Steps: 13 | Train Loss: 1.893 Vali Loss: 2.122 Vali Acc: 0.180 Test Loss: 2.122 Test Acc: 0.180
Validation loss decreased (inf --> -0.179979).  Saving model ...
Epoch: 2 cost time: 0.8630843162536621
Epoch: 2, Steps: 13 | Train Loss: 0.055 Vali Loss: 3.520 Vali Acc: 0.180 Test Loss: 3.520 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8034415245056152
Epoch: 3, Steps: 13 | Train Loss: 0.023 Vali Loss: 3.456 Vali Acc: 0.120 Test Loss: 3.456 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.839087724685669
Epoch: 4, Steps: 13 | Train Loss: 0.001 Vali Loss: 4.453 Vali Acc: 0.240 Test Loss: 4.453 Test Acc: 0.240
Validation loss decreased (-0.179979 --> -0.239955).  Saving model ...
Epoch: 5 cost time: 1.0931804180145264
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.964 Vali Acc: 0.220 Test Loss: 4.964 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.867110013961792
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.297 Vali Acc: 0.200 Test Loss: 5.297 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8948979377746582
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.272 Vali Acc: 0.200 Test Loss: 5.272 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9381294250488281
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.226 Vali Acc: 0.200 Test Loss: 5.226 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8453831672668457
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.198 Vali Acc: 0.200 Test Loss: 5.198 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9487853050231934
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.161 Vali Acc: 0.200 Test Loss: 5.161 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0163967609405518
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.107 Vali Acc: 0.200 Test Loss: 5.107 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8506631851196289
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.091 Vali Acc: 0.200 Test Loss: 5.091 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9030921459197998
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.052 Vali Acc: 0.180 Test Loss: 5.052 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.138828992843628
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.012 Vali Acc: 0.180 Test Loss: 5.012 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df128_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 1082293
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.622307538986206
Epoch: 1, Steps: 13 | Train Loss: 1.854 Vali Loss: 2.035 Vali Acc: 0.140 Test Loss: 2.035 Test Acc: 0.140
Validation loss decreased (inf --> -0.139980).  Saving model ...
Epoch: 2 cost time: 0.9359433650970459
Epoch: 2, Steps: 13 | Train Loss: 0.203 Vali Loss: 2.622 Vali Acc: 0.240 Test Loss: 2.622 Test Acc: 0.240
Validation loss decreased (-0.139980 --> -0.239974).  Saving model ...
Epoch: 3 cost time: 0.7772865295410156
Epoch: 3, Steps: 13 | Train Loss: 0.022 Vali Loss: 3.608 Vali Acc: 0.200 Test Loss: 3.608 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9051706790924072
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.033 Vali Acc: 0.180 Test Loss: 4.033 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7543933391571045
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.290 Vali Acc: 0.180 Test Loss: 4.290 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8742632865905762
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.334 Vali Acc: 0.180 Test Loss: 4.334 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7225296497344971
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.320 Vali Acc: 0.180 Test Loss: 4.320 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9573476314544678
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.301 Vali Acc: 0.180 Test Loss: 4.301 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8832113742828369
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.279 Vali Acc: 0.180 Test Loss: 4.279 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8983449935913086
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.250 Vali Acc: 0.180 Test Loss: 4.250 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8361351490020752
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.246 Vali Acc: 0.180 Test Loss: 4.246 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8221383094787598
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.263 Vali Acc: 0.160 Test Loss: 4.263 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 759717
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df64_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.563126802444458
Epoch: 1, Steps: 25 | Train Loss: 15.683 Vali Loss: 29.285 Vali Acc: 0.220 Test Loss: 29.285 Test Acc: 0.220
Validation loss decreased (inf --> -0.219707).  Saving model ...
Epoch: 2 cost time: 2.1041066646575928
Epoch: 2, Steps: 25 | Train Loss: 5.155 Vali Loss: 27.189 Vali Acc: 0.240 Test Loss: 27.189 Test Acc: 0.240
Validation loss decreased (-0.219707 --> -0.239728).  Saving model ...
Epoch: 3 cost time: 2.023240566253662
Epoch: 3, Steps: 25 | Train Loss: 2.412 Vali Loss: 64.802 Vali Acc: 0.200 Test Loss: 64.802 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0144009590148926
Epoch: 4, Steps: 25 | Train Loss: 4.010 Vali Loss: 29.398 Vali Acc: 0.100 Test Loss: 29.398 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1250572204589844
Epoch: 5, Steps: 25 | Train Loss: 2.995 Vali Loss: 53.135 Vali Acc: 0.240 Test Loss: 53.135 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.063896894454956
Epoch: 6, Steps: 25 | Train Loss: 0.063 Vali Loss: 125.965 Vali Acc: 0.200 Test Loss: 125.965 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.066497564315796
Epoch: 7, Steps: 25 | Train Loss: 3.418 Vali Loss: 84.123 Vali Acc: 0.240 Test Loss: 84.123 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.971271276473999
Epoch: 8, Steps: 25 | Train Loss: 6.899 Vali Loss: 96.647 Vali Acc: 0.180 Test Loss: 96.647 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0595054626464844
Epoch: 9, Steps: 25 | Train Loss: 10.371 Vali Loss: 188.447 Vali Acc: 0.200 Test Loss: 188.447 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9625225067138672
Epoch: 10, Steps: 25 | Train Loss: 6.745 Vali Loss: 129.253 Vali Acc: 0.240 Test Loss: 129.253 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.023366689682007
Epoch: 11, Steps: 25 | Train Loss: 4.003 Vali Loss: 187.820 Vali Acc: 0.180 Test Loss: 187.820 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.941577434539795
Epoch: 12, Steps: 25 | Train Loss: 5.984 Vali Loss: 149.301 Vali Acc: 0.220 Test Loss: 149.301 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df64_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 7212629
model size : 27.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df64_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8135714530944824
Epoch: 1, Steps: 13 | Train Loss: 3.809 Vali Loss: 6.984 Vali Acc: 0.180 Test Loss: 6.984 Test Acc: 0.180
Validation loss decreased (inf --> -0.179930).  Saving model ...
Epoch: 2 cost time: 1.189955234527588
Epoch: 2, Steps: 13 | Train Loss: 0.593 Vali Loss: 7.244 Vali Acc: 0.200 Test Loss: 7.244 Test Acc: 0.200
Validation loss decreased (-0.179930 --> -0.199928).  Saving model ...
Epoch: 3 cost time: 1.2097880840301514
Epoch: 3, Steps: 13 | Train Loss: 0.392 Vali Loss: 16.146 Vali Acc: 0.240 Test Loss: 16.146 Test Acc: 0.240
Validation loss decreased (-0.199928 --> -0.239839).  Saving model ...
Epoch: 4 cost time: 1.1077406406402588
Epoch: 4, Steps: 13 | Train Loss: 0.453 Vali Loss: 18.824 Vali Acc: 0.220 Test Loss: 18.824 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.25856351852417
Epoch: 5, Steps: 13 | Train Loss: 2.180 Vali Loss: 30.899 Vali Acc: 0.200 Test Loss: 30.899 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1655824184417725
Epoch: 6, Steps: 13 | Train Loss: 0.875 Vali Loss: 23.673 Vali Acc: 0.200 Test Loss: 23.673 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1954610347747803
Epoch: 7, Steps: 13 | Train Loss: 0.027 Vali Loss: 22.840 Vali Acc: 0.140 Test Loss: 22.840 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2415978908538818
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.550 Vali Acc: 0.160 Test Loss: 23.550 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1914403438568115
Epoch: 9, Steps: 13 | Train Loss: 0.059 Vali Loss: 24.207 Vali Acc: 0.160 Test Loss: 24.207 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1508667469024658
Epoch: 10, Steps: 13 | Train Loss: 0.541 Vali Loss: 34.678 Vali Acc: 0.200 Test Loss: 34.678 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1140289306640625
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 35.950 Vali Acc: 0.200 Test Loss: 35.950 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3226330280303955
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 33.887 Vali Acc: 0.200 Test Loss: 33.887 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1693675518035889
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.493 Vali Acc: 0.180 Test Loss: 32.493 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df64_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 4092341
model size : 15.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7458975315093994
Epoch: 1, Steps: 13 | Train Loss: 2.436 Vali Loss: 3.308 Vali Acc: 0.180 Test Loss: 3.308 Test Acc: 0.180
Validation loss decreased (inf --> -0.179967).  Saving model ...
Epoch: 2 cost time: 1.185185194015503
Epoch: 2, Steps: 13 | Train Loss: 0.165 Vali Loss: 5.658 Vali Acc: 0.160 Test Loss: 5.658 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1766107082366943
Epoch: 3, Steps: 13 | Train Loss: 0.209 Vali Loss: 4.967 Vali Acc: 0.100 Test Loss: 4.967 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.053473949432373
Epoch: 4, Steps: 13 | Train Loss: 0.001 Vali Loss: 9.868 Vali Acc: 0.200 Test Loss: 9.868 Test Acc: 0.200
Validation loss decreased (-0.179967 --> -0.199901).  Saving model ...
Epoch: 5 cost time: 1.075711965560913
Epoch: 5, Steps: 13 | Train Loss: 0.001 Vali Loss: 17.350 Vali Acc: 0.160 Test Loss: 17.350 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2199373245239258
Epoch: 6, Steps: 13 | Train Loss: 0.174 Vali Loss: 17.424 Vali Acc: 0.160 Test Loss: 17.424 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2108759880065918
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.133 Vali Acc: 0.140 Test Loss: 17.133 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0100371837615967
Epoch: 8, Steps: 13 | Train Loss: 0.850 Vali Loss: 25.479 Vali Acc: 0.240 Test Loss: 25.479 Test Acc: 0.240
Validation loss decreased (-0.199901 --> -0.239745).  Saving model ...
Epoch: 9 cost time: 0.987877607345581
Epoch: 9, Steps: 13 | Train Loss: 0.433 Vali Loss: 18.517 Vali Acc: 0.220 Test Loss: 18.517 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0525007247924805
Epoch: 10, Steps: 13 | Train Loss: 0.463 Vali Loss: 22.909 Vali Acc: 0.200 Test Loss: 22.909 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0410945415496826
Epoch: 11, Steps: 13 | Train Loss: 1.352 Vali Loss: 40.683 Vali Acc: 0.200 Test Loss: 40.683 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.065918207168579
Epoch: 12, Steps: 13 | Train Loss: 2.424 Vali Loss: 33.631 Vali Acc: 0.180 Test Loss: 33.631 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1050944328308105
Epoch: 13, Steps: 13 | Train Loss: 1.217 Vali Loss: 46.383 Vali Acc: 0.180 Test Loss: 46.383 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0979514122009277
Epoch: 14, Steps: 13 | Train Loss: 0.731 Vali Loss: 41.395 Vali Acc: 0.240 Test Loss: 41.395 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.033961296081543
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 60.851 Vali Acc: 0.200 Test Loss: 60.851 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1780171394348145
Epoch: 16, Steps: 13 | Train Loss: 0.466 Vali Loss: 43.677 Vali Acc: 0.140 Test Loss: 43.677 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1549508571624756
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 34.079 Vali Acc: 0.140 Test Loss: 34.079 Test Acc: 0.140
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2243616580963135
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 36.010 Vali Acc: 0.160 Test Loss: 36.010 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 2586053
model size : 10.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df64_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5804009437561035
Epoch: 1, Steps: 13 | Train Loss: 2.277 Vali Loss: 3.479 Vali Acc: 0.180 Test Loss: 3.479 Test Acc: 0.180
Validation loss decreased (inf --> -0.179965).  Saving model ...
Epoch: 2 cost time: 1.00897216796875
Epoch: 2, Steps: 13 | Train Loss: 0.135 Vali Loss: 6.755 Vali Acc: 0.140 Test Loss: 6.755 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8489677906036377
Epoch: 3, Steps: 13 | Train Loss: 0.016 Vali Loss: 8.255 Vali Acc: 0.200 Test Loss: 8.255 Test Acc: 0.200
Validation loss decreased (-0.179965 --> -0.199917).  Saving model ...
Epoch: 4 cost time: 0.9938793182373047
Epoch: 4, Steps: 13 | Train Loss: 0.246 Vali Loss: 8.069 Vali Acc: 0.200 Test Loss: 8.069 Test Acc: 0.200
Validation loss decreased (-0.199917 --> -0.199919).  Saving model ...
Epoch: 5 cost time: 0.9816622734069824
Epoch: 5, Steps: 13 | Train Loss: 0.552 Vali Loss: 7.876 Vali Acc: 0.220 Test Loss: 7.876 Test Acc: 0.220
Validation loss decreased (-0.199919 --> -0.219921).  Saving model ...
Epoch: 6 cost time: 1.0088181495666504
Epoch: 6, Steps: 13 | Train Loss: 0.191 Vali Loss: 18.514 Vali Acc: 0.200 Test Loss: 18.514 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.085193157196045
Epoch: 7, Steps: 13 | Train Loss: 0.126 Vali Loss: 9.611 Vali Acc: 0.340 Test Loss: 9.611 Test Acc: 0.340
Validation loss decreased (-0.219921 --> -0.339904).  Saving model ...
Epoch: 8 cost time: 1.021831750869751
Epoch: 8, Steps: 13 | Train Loss: 0.455 Vali Loss: 17.598 Vali Acc: 0.160 Test Loss: 17.598 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8735201358795166
Epoch: 9, Steps: 13 | Train Loss: 0.424 Vali Loss: 20.580 Vali Acc: 0.260 Test Loss: 20.580 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0046610832214355
Epoch: 10, Steps: 13 | Train Loss: 1.629 Vali Loss: 18.466 Vali Acc: 0.260 Test Loss: 18.466 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1044509410858154
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 40.857 Vali Acc: 0.160 Test Loss: 40.857 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.949190616607666
Epoch: 12, Steps: 13 | Train Loss: 0.151 Vali Loss: 31.393 Vali Acc: 0.120 Test Loss: 31.393 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9507637023925781
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 27.991 Vali Acc: 0.180 Test Loss: 27.991 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9414150714874268
Epoch: 14, Steps: 13 | Train Loss: 0.021 Vali Loss: 23.450 Vali Acc: 0.260 Test Loss: 23.450 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.993643045425415
Epoch: 15, Steps: 13 | Train Loss: 0.056 Vali Loss: 22.165 Vali Acc: 0.220 Test Loss: 22.165 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8817267417907715
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 27.136 Vali Acc: 0.120 Test Loss: 27.136 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8927810192108154
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 28.458 Vali Acc: 0.160 Test Loss: 28.458 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df64_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 2048149
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.734189987182617
Epoch: 1, Steps: 13 | Train Loss: 2.092 Vali Loss: 2.611 Vali Acc: 0.160 Test Loss: 2.611 Test Acc: 0.160
Validation loss decreased (inf --> -0.159974).  Saving model ...
Epoch: 2 cost time: 0.9791276454925537
Epoch: 2, Steps: 13 | Train Loss: 0.317 Vali Loss: 5.540 Vali Acc: 0.180 Test Loss: 5.540 Test Acc: 0.180
Validation loss decreased (-0.159974 --> -0.179945).  Saving model ...
Epoch: 3 cost time: 0.9251365661621094
Epoch: 3, Steps: 13 | Train Loss: 0.069 Vali Loss: 5.789 Vali Acc: 0.200 Test Loss: 5.789 Test Acc: 0.200
Validation loss decreased (-0.179945 --> -0.199942).  Saving model ...
Epoch: 4 cost time: 1.0634942054748535
Epoch: 4, Steps: 13 | Train Loss: 0.093 Vali Loss: 5.850 Vali Acc: 0.220 Test Loss: 5.850 Test Acc: 0.220
Validation loss decreased (-0.199942 --> -0.219942).  Saving model ...
Epoch: 5 cost time: 0.9992427825927734
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.928 Vali Acc: 0.220 Test Loss: 10.928 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9288628101348877
Epoch: 6, Steps: 13 | Train Loss: 0.042 Vali Loss: 7.351 Vali Acc: 0.160 Test Loss: 7.351 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9027290344238281
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.953 Vali Acc: 0.220 Test Loss: 8.953 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1195955276489258
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.918 Vali Acc: 0.120 Test Loss: 8.918 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1051304340362549
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 11.927 Vali Acc: 0.220 Test Loss: 11.927 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0101473331451416
Epoch: 10, Steps: 13 | Train Loss: 0.152 Vali Loss: 9.714 Vali Acc: 0.180 Test Loss: 9.714 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.999293327331543
Epoch: 11, Steps: 13 | Train Loss: 0.094 Vali Loss: 20.097 Vali Acc: 0.220 Test Loss: 20.097 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1062586307525635
Epoch: 12, Steps: 13 | Train Loss: 0.855 Vali Loss: 20.825 Vali Acc: 0.180 Test Loss: 20.825 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0265371799468994
Epoch: 13, Steps: 13 | Train Loss: 0.275 Vali Loss: 17.203 Vali Acc: 0.100 Test Loss: 17.203 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9743292331695557
Epoch: 14, Steps: 13 | Train Loss: 0.324 Vali Loss: 23.543 Vali Acc: 0.160 Test Loss: 23.543 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 1295173
model size : 5.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df64_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.865410327911377
Epoch: 1, Steps: 13 | Train Loss: 2.032 Vali Loss: 1.882 Vali Acc: 0.240 Test Loss: 1.882 Test Acc: 0.240
Validation loss decreased (inf --> -0.239981).  Saving model ...
Epoch: 2 cost time: 0.974757194519043
Epoch: 2, Steps: 13 | Train Loss: 0.067 Vali Loss: 3.212 Vali Acc: 0.240 Test Loss: 3.212 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0437476634979248
Epoch: 3, Steps: 13 | Train Loss: 0.003 Vali Loss: 3.668 Vali Acc: 0.240 Test Loss: 3.668 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9651837348937988
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.957 Vali Acc: 0.200 Test Loss: 4.957 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0287058353424072
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.868 Vali Acc: 0.200 Test Loss: 4.868 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9838588237762451
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.755 Vali Acc: 0.200 Test Loss: 4.755 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8823151588439941
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.630 Vali Acc: 0.200 Test Loss: 4.630 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9205658435821533
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.495 Vali Acc: 0.180 Test Loss: 4.495 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8798441886901855
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.409 Vali Acc: 0.200 Test Loss: 4.409 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7815897464752197
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.368 Vali Acc: 0.220 Test Loss: 4.368 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8788235187530518
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.340 Vali Acc: 0.220 Test Loss: 4.340 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df64_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 1080181
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4206042289733887
Epoch: 1, Steps: 13 | Train Loss: 1.858 Vali Loss: 1.791 Vali Acc: 0.220 Test Loss: 1.791 Test Acc: 0.220
Validation loss decreased (inf --> -0.219982).  Saving model ...
Epoch: 2 cost time: 0.801098108291626
Epoch: 2, Steps: 13 | Train Loss: 0.089 Vali Loss: 2.278 Vali Acc: 0.180 Test Loss: 2.278 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7793071269989014
Epoch: 3, Steps: 13 | Train Loss: 0.001 Vali Loss: 3.256 Vali Acc: 0.200 Test Loss: 3.256 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7492966651916504
Epoch: 4, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.210 Vali Acc: 0.240 Test Loss: 3.210 Test Acc: 0.240
Validation loss decreased (-0.219982 --> -0.239968).  Saving model ...
Epoch: 5 cost time: 0.7818708419799805
Epoch: 5, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.140 Vali Acc: 0.240 Test Loss: 3.140 Test Acc: 0.240
Validation loss decreased (-0.239968 --> -0.239969).  Saving model ...
Epoch: 6 cost time: 0.7694442272186279
Epoch: 6, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.109 Vali Acc: 0.240 Test Loss: 3.109 Test Acc: 0.240
Validation loss decreased (-0.239969 --> -0.239969).  Saving model ...
Epoch: 7 cost time: 0.7662298679351807
Epoch: 7, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.054 Vali Acc: 0.260 Test Loss: 3.054 Test Acc: 0.260
Validation loss decreased (-0.239969 --> -0.259969).  Saving model ...
Epoch: 8 cost time: 0.6938469409942627
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.016 Vali Acc: 0.240 Test Loss: 3.016 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7813737392425537
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.008 Vali Acc: 0.240 Test Loss: 3.008 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.774299144744873
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.987 Vali Acc: 0.220 Test Loss: 2.987 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7429904937744141
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.966 Vali Acc: 0.220 Test Loss: 2.966 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.780057430267334
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.972 Vali Acc: 0.220 Test Loss: 2.972 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8058431148529053
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.976 Vali Acc: 0.220 Test Loss: 2.976 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.763350248336792
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.959 Vali Acc: 0.200 Test Loss: 2.959 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6769602298736572
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.947 Vali Acc: 0.200 Test Loss: 2.947 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7588522434234619
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.950 Vali Acc: 0.200 Test Loss: 2.950 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7696504592895508
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.947 Vali Acc: 0.200 Test Loss: 2.947 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_PatchTST_UEA_ftM_sl270_ll0_pl0_el1_dm16_nh4_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 757605
model size : 3.20MB
